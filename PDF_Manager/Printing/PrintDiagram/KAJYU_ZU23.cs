using System;
using System.Collections.Generic;
using System.Text;

namespace PDF_Manager.Printing.PrintDiagram
{
    //          荷重図
    class KAJYU_ZU23
    {
        /*
        private int SNAPmodeFF;
        private double MaxKuiRR;
        private double SenroModeZF;
        private double[,,] ZFXLine = new double[2, 10, 100];

        private double[,,] ZFXBane = new double[2, 10, 100];
        private double[,] ZFXMaX = new double[2, 10];
        private object FOLU;
        private object 荷重図test;
        //private 表示色
        private object 荷重TEXT位置;
        private float YMin杭無;
        private int PierSiCheck;
        private JDATA JD;
        //
        private int[] AngleDF1;
        private double A4Flag;
        private double[] CaseShiten
        //private ShitenMN()              //////// 支点の各点番号
        private double[] ShitenTX
        private double[] ShitenTY;
        private double[] ShitenTZ;
        private double[] Shiten_FLG;
        //private ErrorMessX               As ErrorMess
        private int PointChangeFlag;
        private int[] PointKuiFlag;
        private double BuzaiMax1;
        private double[] ZZBuzaiGroup;
        private double ZZBuzaiGroupMax;
        private double[] ZBuzaiLength;
        private double[] GFLAG
        private double[] KaSouFlag
        private double[] 一期施工Flag

        private double[] FBuzaiNumber1
        private double[] FBuzaiNumber2
        private double[] FBuzaiI
        private double[] FBuzaiJ
        private double[] FAngle
        private double[] ZFAngle

        //private mHONE As Integer //////////////////////////////////////////08/03/05
        private double[] ZBuzaiGroup;
        private double A3FLAG;
        private double FFKuiLengthMax;
        private double LeftKuibuzaiNumber;
        private double FFSunPouStartX1;
        private double FFSunPouStartX2;
        private double FFSunPouStartX3;
        private double GenZaiI;
        private double[] BuzaiBai;
        private double[] ZZBuzaiBai;
        private double[] WWBuzaiBai;
        private double[] GGBuzaiBai;
        private double MaxKuiOuTou;
        private double KuiLengthMax;
        private double [] BuzaiH;
        private double OuTouAtta;
        private double KuiNoG;
        private double[] KBANEMAX;
        private double F7MAX_R;
        private double[] F7OUTOU;
        private double[] F7BANE;
        private double[] F7ML1;
        private object[] F7ML2;
        private object[] F7ML3;
        private object[] F7ML;
        private double[] F7ML31;
        private double[] F7ML4;
        private double[] F7ML5;
        private double[] F7ML6;
        private double[] G_KuiDD = new double[10];
        private double OuTouHHH;
        private double[] G1_AA1;    // For( Gouiki
        private double[] G1_AA2;    // For( Gouiki
        private double[] G1_AA3;    // For( Gouiki
        private double[] G1_AA4;    // For( Gouiki
        private double[] G1_AA5;    // For( Gouiki
        private double[] G1_AA6;    // For( Gouiki
        private double[] G1_AA7;    // For( Gouiki
        private double[] G2_AA1;    // For( Gouiki
        private double[] G2_AA2;    // For( Gouiki
        private double[] G2_AA3;    // For( Gouiki
        private double[] G2_AA4;    // For( Gouiki
        private double[] G2_AA5;    // For( Gouiki
        private double[] G2_AA6;    // For( Gouiki
        private double[] G2_AA7;    // For( Gouiki
        private double[] G3_AA1;    // For( Gouiki
        private double[] G3_AA2;    // For( Gouiki
        private double[] G3_AA3;    // For( Gouiki
        private double[] G3_AA4;    // For( Gouiki
        private double[] G3_AA5;    // For( Gouiki
        private double[] G3_AA6;    // For( Gouiki
        private double[] G3_AA7;    // For( Gouiki
        private double[] G4_AA1;    // For( Gouiki
        private double[] G4_AA2;    // For( Gouiki
        private double[] G4_AA3;    // For( Gouiki
        private double[] G4_AA4;    // For( Gouiki
        private double[] G4_AA5;    // For( Gouiki
        private double[] G4_AA6;    // For( Gouiki
        private double[] G4_AA7;    // For( Gouiki
        private double[] G5_AA1;    // For( Gouiki
        private double[] G5_AA2;    // For( Gouiki
        private double[] G5_AA3;    // For( Gouiki
        private double[] G5_AA4;    // For( Gouiki
        private double[] G5_AA5;    // For( Gouiki
        private double[] G5_AA6;    // For( Gouiki
        private double[] G5_AA7;    // For( Gouiki
        private double[] G6_AA1;    // For( Gouiki
        private double[] G6_AA2;    // For( Gouiki
        private double[] G6_AA3;    // For( Gouiki
        private double[] G6_AA4;    // For( Gouiki
        private double[] G6_AA5;    // For( Gouiki
        private double[] G6_AA6;    // For( Gouiki
        private double[] G6_AA7;    // For( Gouiki
        private double[] G7_AA1;    // For( Gouiki
        private double[] G7_AA2;    // For( Gouiki
        private double[] G7_AA3;    // For( Gouiki
        private double[] G7_AA4;    // For( Gouiki
        private double[] G7_AA5;    // For( Gouiki
        private double[] G7_AA6;    // For( Gouiki
        private double[] G7_AA7;    // For( Gouiki
        private double[] G8_AA1;    // For( Gouiki
        private double[] G8_AA2;    // For( Gouiki
        private double[] G8_AA3;    // For( Gouiki
        private double[] G8_AA4;    // For( Gouiki
        private double[] G8_AA5;    // For( Gouiki
        private double[] G8_AA6;    // For( Gouiki
        private double[] G8_AA7;    // For( Gouiki
        private double[] G9_AA1;    // For( Gouiki
        private double[] G9_AA2;    // For( Gouiki
        private double[] G9_AA3;    // For( Gouiki
        private double[] G9_AA4;    // For( Gouiki
        private double[] G9_AA5;    // For( Gouiki
        private double[] G9_AA6;    // For( Gouiki
        private double[] G9_AA7;    // For( Gouiki
        private double[] G10_AA1;    // For( Gouiki
        private double[] G10_AA2;    // For( Gouiki
        private double[] G10_AA3;    // For( Gouiki
        private double[] G10_AA4;    // For( Gouiki
        private double[] G10_AA5;    // For( Gouiki
        private double[] G10_AA6;    // For( Gouiki
        private double[] G10_AA7;    // For( Gouiki
        private double[] ILineG;
        private double[] JLineG;
        private double[] ILineGX;
        private double[] JLineGX;
        private double[] N_KuiDD = new double[10];
        private double[] N1_BANE;     // Normal Frame
        private double[] N2_BANE;     // Normal Frame
        private double[] N3_BANE;     // Normal Frame
        private double[] N4_BANE;     // Normal Frame
        private double[] N5_BANE;     // Normal Frame
        private double[] N6_BANE;     // Normal Frame
        private double[] N7_BANE;     // Normal Frame
        private double[] N8_BANE;     // Normal Frame
        private double[] N9_BANE;     // Normal Frame
        private double[] N10_BANE;     // Normal Frame
        private double[] N1_AAA;     // Normal Frame
        private double[] N1_QOT8;     // Normal Frame
        private double[] N1_QOT9;     // Normal Frame
        private double[] N1_QOT;     // Normal Frame
        private double[] N1_QQH;     // Normal Frame
        private double[] N1_QQV;     // Normal Frame
        private double[] N1_QOT2;     // Normal Frame
        private double[] N1_QQH2;     // Normal Frame
        private double[] N1_QQV2;     // Normal Frame
        private double[] N2_AAA;     // Normal Frame
        private double[] N2_QOT8;     // Normal Frame
        private double[] N2_QOT9;     // Normal Frame
        private double[] N2_QOT;     // Normal Frame
        private double[] N2_QQH;     // Normal Frame
        private double[] N2_QQV;     // Normal Frame
        private double[] N2_QOT2;     // Normal Frame
        private double[] N2_QQH2;     // Normal Frame
        private double[] N2_QQV2;     // Normal Frame
        private double[] N3_AAA;     // Normal Frame
        private double[] N3_QOT8;     // Normal Frame
        private double[] N3_QOT9;     // Normal Frame
        private double[] N3_QOT;     // Normal Frame
        private double[] N3_QQH;     // Normal Frame
        private double[] N3_QQV;     // Normal Frame
        private double[] N3_QOT2;     // Normal Frame
        private double[] N3_QQH2;     // Normal Frame
        private double[] N3_QQV2;     // Normal Frame
        private double[] N4_AAA;     // Normal Frame
        private double[] N4_QOT8;     // Normal Frame
        private double[] N4_QOT9;     // Normal Frame
        private double[] N4_QOT;     // Normal Frame
        private double[] N4_QQH;     // Normal Frame
        private double[] N4_QQV;     // Normal Frame
        private double[] N4_QOT2;     // Normal Frame
        private double[] N4_QQH2;     // Normal Frame
        private double[] N4_QQV2;     // Normal Frame
        private double[] N5_AAA;     // Normal Frame
        private double[] N5_QOT8;     // Normal Frame
        private double[] N5_QOT9;     // Normal Frame
        private double[] N5_QOT;     // Normal Frame
        private double[] N5_QQH;     // Normal Frame
        private double[] N5_QQV;     // Normal Frame
        private double[] N5_QOT2;    // Normal Frame
        private double[] N5_QQH2;     // Normal Frame
        private double[] N5_QQV2;     // Normal Frame
        private double[] N6_AAA;     // Normal Frame
        private double[] N6_QOT8;     // Normal Frame
        private double[] N6_QOT9;     // Normal Frame
        private double[] N6_QOT;     // Normal Frame
        private double[] N6_QQH;     // Normal Frame
        private double[] N6_QQV;     // Normal Frame
        private double[] N6_QOT2;     // Normal Frame
        private double[] N6_QQH2;     // Normal Frame
        private double[] N6_QQV2;     // Normal Frame
        private double[] N7_AAA;     // Normal Frame
        private double[] N7_QOT8;     // Normal Frame
        private double[] N7_QOT9;     // Normal Frame
        private double[] N7_QOT;     // Normal Frame
        private double[] N7_QQH;     // Normal Frame
        private double[] N7_QQV;     // Normal Frame
        private double[] N7_QOT2;     // Normal Frame
        private double[] N7_QQH2;     // Normal Frame
        private double[] N7_QQV2;     // Normal Frame
        private double[] N8_AAA;     // Normal Frame
        private double[] N8_QOT8;     // Normal Frame
        private double[] N8_QOT9;     // Normal Frame
        private double[] N8_QOT;     // Normal Frame
        private double[] N8_QQH;     // Normal Frame
        private double[] N8_QQV;     // Normal Frame
        private double[] N8_QOT2;     // Normal Frame
        private double[] N8_QQH2;     // Normal Frame
        private double[] N8_QQV2;     // Normal Frame
        private double[] N9_AAA;     // Normal Frame
        private double[] N9_QOT8;     // Normal Frame
        private double[] N9_QOT9;     // Normal Frame
        private double[] N9_QOT;     // Normal Frame
        private double[] N9_QQH;     // Normal Frame
        private double[] N9_QQV;     // Normal Frame
        private double[] N9_QOT2;     // Normal Frame
        private double[] N9_QQH2;     // Normal Frame
        private double[] N9_QQV2;     // Normal Frame
        private double[] N10_AAA;     // Normal Frame
        private double[] N10_QOT8;     // Normal Frame
        private double[] N10_QOT9;     // Normal Frame
        private double[] N10_QOT;     // Normal Frame
        private double[] N10_QQH;     // Normal Frame
        private double[] N10_QQV;     // Normal Frame
        private double[] N10_QOT2;     // Normal Frame
        private double[] N10_QQH2;     // Normal Frame
        private double[] N10_QQV2;     // Normal Frame
        private double EqualKui;
        private double[] JJJ1;
        private double[] KBANE1_L;     // KuiBane
        private double[] KBANE1_KH;     // KuiBane
        private double[] KBANE1_KSV;     // KuiBane
        private double[] KBANE2_L;     // KuiBane
        private double[] KBANE2_KH;     // KuiBane
        private double[] KBANE2_KSV;     // KuiBane
        private double[] KBANE3_L;     // KuiBane
        private double[] KBANE3_KH;     // KuiBane
        private double[] KBANE3_KSV;     // KuiBane
        private double[] KBANE4_L;     // KuiBane
        private double[] KBANE4_KH;     // KuiBane
        private double[] KBANE4_KSV;     // KuiBane
        private double[] KBANE5_L;     // KuiBane
        private double[] KBANE5_KH;     // KuiBane
        private double[] KBANE5_KSV;     // KuiBane
        private double[] KBANE6_L;     // KuiBane
        private double[] KBANE6_KH;     // KuiBane
        private double[] KBANE6_KSV;     // KuiBane
        private double[] KBANE7_L;     // KuiBane
        private double[] KBANE7_KH;     // KuiBane
        private double[] KBANE7_KSV;     // KuiBane
        private double[] KBANE8_L;     // KuiBane
        private double[] KBANE8_KH;     // KuiBane
        private double[] KBANE8_KSV;     // KuiBane
        private double[] KBANE9_L;     // KuiBane
        private double[] KBANE9_KH;     // KuiBane
        private double[] KBANE9_KSV;     // KuiBane
        private double[] KBANE10_L;     // KuiBane
        private double[] KBANE10_KH;     // KuiBane
        private double[] KBANE10_KSV;     // KuiBane
        private int SouatrsuValuePrint;
        private int SouatrsuValuePrintA;
        private double[] OnajiIchi;
        private double[] OnajiIchiL1;
        private double[] OnajiIchiL2;
        private double[] OnajiIchiP1;
        private double[] OnajiIchiP2;
        private int OnajiIchiNum;
        private int ONajiFlag;
        private int ONajiKakuFlag;
        private int[] ONajiKaku;
        private float[] UseSettenNumber;
        private int[] ShitenFD;
        private int[] Shiten固定;
        //
        private double YajirushiSize;
        private double SunPouPenWidth;
        private double SunPouMojiSize1;
        private double SunPouMojiSize2;
        private double SunPouMojiSize3;
        private double SunPouStartX1;
        private double SunPouStartX2;
        private double SunPouStartX3;
        //
        private double MaxOuTouLen1;
        private double MaxOuTouLen2;
        private double MaxKuiOuTouLen;
        private double OutouStartX1;   // 地盤変位量の印字開始位置
        private double OutouStartX2;   // 水平バネの印字開始位置
        private double OutouStartX;
        private double OutouStartY;
        private double[] OutouKui1;
        private double[] OutouKui2;
        private double[] OutouKui3;
        private double[] OutouKui4;
        private double[] OutouKui5;
        private double[] OutouKui6;
        private double[] OutouKui7;
        private double[] OutouKui8;
        private double[] OutouKui9;
        private double[] OutouKui10;
        private double[] XOutouKui1;
        private double[] XOutouKui2;
        private double[] XOutouKui3;
        private double[] XOutouKui4;
        private double[] XOutouKui5;
        private double[] XOutouKui6;
        private double[] XOutouKui7;
        private double[] XOutouKui8;
        private double[] XOutouKui9;
        private double[] XOutouKui10;
        private double XKui1;
        private double XKui2;
        private double XKui3;
        private double XKui4;
        private double XKui5;
        private double XKui6;
        private double XKui7;
        private double XKui8;
        private double XKui9;
        private double XKui10;
        private double CheckIn1;
        private double HoneKaki;
        private double KuiToKui;
        private double[] KuiBuzaiX;
        private double[] KuiBuzaiY;
        private int BuzaiGAri;
        private double Atta寸法;
        private double AttaG;
        private double[] WAWAWA;
        private double[] WAXX;
        private double[] WAYY;
        private double[] ITAN1;
        private double[] JTAN1;
        private double[] YYYY1;
        private double[] YYYY2;
        private double[] XXXX1;
        private double[] XXXX2;
        private double[] ZYYYY1;
        private double[] ZYYYY2;
        private double[] ZXXXX1;
        private double[] ZXXXX2;
        private double HHXX1;
        private double HHYY1;
        private double HHXX2;
        private double HHYY2;
        private double ANSANG;
        private double CCCC;
        private double SSSS;
        private double MAXBU1;
        private double[] iiii
        private double[] JJJJ
        */
        private float Twip;
        /*
        private double π;
        private float Pen幅;
        private float 枠横幅;
        private float 枠縦幅;
        private float 図横幅;
        private float 図縦幅;
        private float J_SCALE;
        private float LLX;
        private float LLY;
        private float CENTER_X;
        private float CENTER_Y;
        private float 杭図倍率;
        private float 節点番号Fontsize;
        private float 部材番号Fontsize;
        private float 節点荷重Fontsize;
        private float 部材荷重Fontsize;
        private float 荷重寸法Fontsize;
        private float Pen色;
        private float 枠Pen色;
        private float 節点Pen色;
        private float 部材Pen色;
        private float 節点荷重Pen色;
        private float 部材荷重Pen色;
        private float 部材荷重寸法Pen色;
        private float 枠Pen幅;
        private float 節点荷重Pen幅;
        private float 部材Pen幅;
        private float 部材荷重Pen幅;
        private float 部材荷重矢Pen幅;
        private float 部材荷重寸法Pen幅;
        private float 左開き;
        private float 上開き;
        private int 集中有無;
        */
        private float 図X_SCALE;
        private float 図Y_SCALE;
        /*
        private int Jn_max;
        private float JX_max;
        private float JX_min;
        private float JY_max;
        private float JY_min;
        private float YY_基礎;              //////08/08/21
        private float[] XXYY = new float[4]; //////13/-4/19
        //
        private float YU_max; ////////////////////////////////////// 骨組のY軸最大 05/04/17
        private float YY_max; ////////////////////////////////////// 骨組のY軸最大 05/04/17
        private float YY_min; ////////////////////////////////////// 骨組のY軸最小 05/04/25
        */
        private float 図_X0;
        private float 図_Y0;
        /*
        private float[] 節X;
        private float[] 節Y;
        private float[] 節X0;
        private float[] 節Y0;
        private float[] 節点部材数; //配列の宣言だけをしておく
        private int 部材_max;
        private string[] 部材名;
        private int[] 部I;
        private int[] 部J;
        private float[] 数部材;
        private int 部材荷重数max;
        private int 節点荷重数max;
        private int[] Case_部材荷重数;
        private int[] Case_節点荷重数;
        private int[,] 部材荷重番号 = new int[500, 3000];
        private int[,] 節点荷重番号 = new int[500, 3000];

        private float[] 節点部材角度; //配列の宣言だけをしておく
        private int 荷重case_max;
        private int[] 実荷重NO;
        private int[] 逆実荷重NO; ////////09/02/09
        private string[] 荷重記号;
        private string[] 荷重名称;
        //var 荷重S(2000)                 As Single
        //var 荷重E(2000)                 As Single
        //var 正荷重N(2000)               As Single
        //var 負荷重N(2000)               As Single
        private float[] 部材正荷重数;
        private float[] 部材負荷重数;
        private float 荷重図上盛上げ初期値;
        private float 荷重図下盛上げ初期値;
        private float[] 荷重図盛上げpit = new float[2];
        private float 節点荷重Scale;
        private float 部材荷重Scale;
        private float 集中荷重Scale;
        private float 節点荷重初期値;
        private float 部材荷重初期値;
        private float 集中荷重初期値;
        private float 節点荷重長さmax;
        private float 部材荷重長さmax;
        private float 集中荷重長さmax;
        private float 節点M荷重長さmax;
        private float 部材M荷重長さmax;
        private float 節点荷重角度;
        private float 固定節点M荷重長さ;
        private float 固定部材M荷重長さ;
        private float 固定部材PURE1荷重長さ;
        private float 固定部材PURE2荷重長さ;
        private float[] 荷重寸法線位置 = new float[2];
        private float 荷重寸法補助線;
        private float 部材荷重矢長さmin;
        private float BP荷重MAX;
        private float BU荷重MAX;
        private float 荷重文字Fontsize;
        private float 荷重文字pit;
        private float 荷重座標Y初期値;
        private float 荷重座標X;
        private float 荷重座標Y;
        private float XXMAX;
        private float XEAKI;
        private float YYMAX;
        private float ZZMAX;
        private float[] BUZAIMEI; //配列の宣言だけをしておく
        private float[] SETTENNO; //配列の宣言だけをしておく
        private float SPMORIA;
        private int FR橋脚;
        private int RR橋脚;
        private int sYscale;
        private float sNN;
        private int NKUI;
        private float UEHOSEI;
        private int STC;
        private int ETC;
        private float[] 部材方向;
        private int[] 部材GRP;
        private float 分布補正;
        private float hosei;
        private float KUIAKI;
        private int SS部材;
        private int EE部材;
        private int Foot_Flg; //直接基礎 0 ----ﾌｰﾁﾝｸﾞなし
        private float 荷重文字サイズ;
        private int 水平垂直;
        private string W分布荷重;
        private float[] M荷重 = new float[2];
        private float N段数;
        private int k杭数;
        private float k杭長;
        private float F杭長;
        private float 上空き;
        private struct MDATA {
            public int Case;
            public int S;
            public int E;
            public int MARK;
            public string LDir;
            public float L1;
            public float L2;
            public float P1;
            public float P2;
        }
        private MDATA Md = new MDATA();

        private struct JDATA {
            public int Case;
            public int JN;
            public float fX;
            public float fY;
            public float M;
        }

        //private JD                       As JDATA
        private double Sqrt2 = 1.414214; //1.4142135623731
        //kit 2000/03/15
        private struct typ荷重図フォーマット {
            public int int用紙サイズ;   //0-A4 1-A3 2-B4 3-B5
            public int int用紙方向;     //0-縦 1-横
            public int intレイアウト;   //0-上下 1-左右 2-シングル
            public int[] int作図指定 = new int[1];  //0-図枠あり 1-図枠無し
            public float sng骨組軸線スケール縦;
            public float sng骨組軸線スケール横;
            public float sng骨組位置補正X;
            public float sng骨組位置補正Yl;
            public float sng荷重軸線スケール縦;
            public float sng荷重軸線スケール横;
            public float sng荷重位置補正X;
            public float sng荷重位置補正Y;
            public float sng荷重スケール分布荷重;
            public float sng荷重スケール集中荷重;
            public float sng荷重スケールモーメント半径;
            public float sng荷重スケール節点荷重;
            public float sng荷重スケール節点モーメント;
            public float sng文字サイズ;
            public int int文字フォント;  //0-MS明朝 1-MSゴシック
        }
        private typ荷重図フォーマット 荷重図フォーマット = new typ荷重図フォーマット();
        private float e天端;
        //kit 2000/03/15
        private struct  typ部材縮小率{
            public int intIdx;
            public int int部材番号;
            public string str部材名
            public int int骨組縮小率;
            public int int荷重縮小率;
        }
        //部材縮小率を格納（添え字は0オリジンで入力グリッドの上から順番に入る）
        private typ部材縮小率[] 部材縮小率;
        private long lng部材数; //部材縮小率のデータ個数。this.部材縮小率（lng部材数 - 1）
        private int iKozo;
        private int S新耐震;
        private float 柱剛域長;
        private bool gOut部材番号;
        //var YMin杭無                   As Single
        private float csngMmToPoint = 2.835;   //1論理mm = 2.835points
        private float csngNull = 99999;
        private float csngLogic1mmByTwips = 56.7;  //1論理mm = 56.7twips
        private float csngLogic1mByTwips = 56700;  //1論理メートル = 56700twips
        private float csngClipMargin = 170.1;  // 3mm * 56.7twipts
        private float SouatsuHajimePenWidth = 12;
        private float SouatsuAidaPenWidth = 12;
        private float SouatsuMojiHight = 6;
        //private Const KuiMaxLen = 200
        private float KuiMaxLen; ////////////08/09/03
        private double OuTouBai = 56.7;
        private double KuiAtsu = 2.5 * 56.7;
        private double Teisuu1 = 80 * 56.7;
        private double Teisuu2 = -7.5 * 56.7;
        private double Teisuu3 = -8.5 * 56.7;
        private double Teisuu4 = 27 * 56.7;
        private double Teisuu5 = 20 * 56.7;
        private double Faa;
        private double SyitaX = 5 * 56.7;
        private double SyitaY = 5 * 56.7;
        private double SyitaX1 = 4 * 56.7;
        private double SyitaY1 = 4 * 56.7;
        private double GraphTitleMojiSize= 7.5;
        private double JibanYoko = 0.8;
        private double NoKaikin = 0;   // 荷重図の３段書き、４段書き対応版のプログラム機能を有効にしない場合は１
        private double NoKaikin1 = 1;   // 荷重図の３段書き、４段書き対応版のプログラム機能を有効にしない場合は１
        private float[] 節点荷重段数;
        private float 垂直左右;     // 軸線寸法と支点マークを右に表示＝０
        private float[] 垂直寸法位置補正 = new float[2];  // 05/01/29
        private float[] NoJtan;
        private double GouikibuzaiIgaiNoSunpou = 1;     // 剛域部材を含まない間のすぽうは書かない（１）
        private bool g連続Mod;
        private float 横余裕;
        private float 横補正;
        private int[] 上層Buzai; ////////////05/02/07
        private float[] z上層両X座標 = new float[2];  ////////10/10/13
        private float[] 上層斜めBuzaiV; ////////14/12/13
        private int MQM; ////////////////////////////////////05/02/07
        private int[] JJM;
        private int 垂直中央;
        private float[] Mark2離れ = new float[2]; ////////05/02/26
        private float[] 柱間離れ = new float[2]; //////////05/02/26
        private float[] 寸法左右 = new float[2]; //////////05/05/28   Case1左右の寸法FLG
        private int シングルCASE;
        private int ggg荷重段数;
        private float KAJYUstrEND;
        private float X_kajyu位置; //////////08/007/06
        private float Y_kajyu位置;
        private float 垂直補正高; ////////////////06/02/28
        private bool M杭mod;
        private double[] FG3 = new double[1000]; ////06/04/04
        private double[] FG4 = new double[1000];
        private float 横スケール;
        private float 縦スケール;
        //var g前寸法 As String ////////////////////////////////////////////////////////////////////07/01/17
        private float g荷重連寸法補正; ////////////////等分布 07/01/17
        private float g荷重連寸法回数; ////////////////等分布 07/01/17
        private int FLG記号;
        private string strUN; //////////07/05/13
        private float 前PRESUT; ////////07/08/04
        private object NAME1;
        private object OF1;
        private double[] 斜比; ////////07/12/31
        private int g背割れ; //////08/06/24
        //var g骨組図背割れ() As Integer
        private float[] g荷重図背割れ; //////08/06/24
        private int[] wRR; ////////08/06/24
        private int[] w節RR; ////////08/08/21
        private int[] Flg_PRESTRES = new int[2]; //////08/06/24
        private float[,] s連行前 = new float[2, 2];
        private float[,] s連行後 = new float[2, 2];
        private float[] s連行前節点 = new float[2]; ////////09/10/20
        private float[] s連行後節点 = new float[2];
        private bool g角度一連; ////////////////09/10/20
        private float[] d垂直 = new float[2]; ////////////////09/10/22
        private int g荷重表記縦; //////08/10/29
        private float g荷重表記高; ////////08/10/29
        private float g荷重表記高5; //////////////////////////09/11/13
        private float[] DDAN; //////////////////08/11/039
        private int[] 水平BUZAI; //////08/11/06
        private int[] 水平BUZAIM; //////////17/11/21
        private int y水平CUNT; ////////////////////////////////08/11/13
        private int[] 下層BUZAI; //////08/11/06
        private int y最低CUNT; ////////////////////////////////08/11/13
        private float[] g柱X座標; //////08/11/066
        private int g柱本数;
        private int[] g柱I_X = new int[2]; //////10/11/033
        private float[] g節点水平荷重座標; //////////14/11/15
        private float[] 増分; ////////08/11/23
        private int[] GGGGG; ////////09/10/14
        private int BuzaiFF; ////////09/10/14
        private float 水平部材最下端; ////////////////09/10/14
        private int 下床文字表示; //////09/12/03
        private float 座標Y調整; //////////////////10/01/24
        private int[] Mark6荷重数; ////////10/02/07
        private int N風圧; //////10/03/07
        private bool アーチBOX; //////10/03/27
        private float[] XY集中 = new float[2]; //////11/12/16
        private int KUIDAN; ////////12/02/15
        private string LLL789; ////////13/04/04
        private bool 階段Mod; //////13/04/08
        private bool FLG柱軸重; //////13/04/08
        private float 階段水平部材最上端; //////13/04/08
        private float g段上げ; //////13/04/13
        private float s荷重位置; //////13/04/20
        private int FLG_側圧9; //////13/04/08
        //var s荷重側圧位置1 As Single //////13/04/20
        //var s荷重側圧位置2 As Single //////13/04/20
        private float[] s各側圧位置 = new float[50, 2];
        private int s側圧数;
        private float 水平部材最上端; ////////13/04/177
        private float[] H水平 = new float[2]; //////13/04/24
        private float[] V鉛直 = new float[2];
        private bool FLG_列車_衝撃; //////13/04/25
        private bool FLG_柱軸重; //////13/06/03
        private int 現CASE;
        private double[] LLLLL;
        private string str前前Num;
        private float sgl前前Num;
        private double FLG車両ZU;
        private int NUM車両ZU;
        private double 前の値;
        private float[,] y1層厚 = new float[10, 30]; //////14/08/21
        private float Mark5前位置;
        private int Now荷重max1; //////部材荷重数
        private int Now荷重max2; //////節点荷重数
        //
        private float yyHH1; //////14/11/19
        private float yyHH2;
        private int FLG7777;
        private float y等分布高;
        private float x側壁;
        private float[] m左側壁Grp;
        private float[] m右側壁Grp;
        private float[] 前前DXY = new float[2];
        private string tr前Num;
        private string str後Num; ////////14/12/22
        private float[] 前RXY; //////15/01/08
        private int FLG側圧あり;
        private int FLG_WmWs; //////15/01/0
        private bool[] FLG_左右接点 = new bool[3];
        private bool FLG_Ugata;
        //


        private double GibanHeniX1;      ' 地盤変位量と水平バネを印字


        public void InitKAjuuZ(){
            //
            this.FBuzaiNumber1 = new double[1000];
            this.FBuzaiNumber2 = new double[1000];
            this.FBuzaiI = new double[1000];
            this.FBuzaiJ = new double[1000];
        //    this.FShitenX(1000)
        //    this.FShitenY(1000)
            this.FAngle = new double[1000];
            this.ZFAngle = new double[1000];
            this.WAWAWA= new double[1000];
            this.WAXX = new double[2000];
            this.WAYY = new double[2000];
            this.ITAN1= new double[1000];
            this.JTAN1= new double[1000];
            this.YYYY1= new double[1000];
            this.YYYY2= new double[1000];
            this.XXXX1= new double[1000];
            this.XXXX2= new double[1000];
            this.ZYYYY1= new double[1000];
            this.ZYYYY2= new double[1000];
            this.ZXXXX1= new double[1000];
            this.ZXXXX2= new double[1000];
            this.iiii= new double[1000];
            this.JJJJ= new double[1000];
            this.NoJtan= new float[1000];
            //
        }
    */

        /*  private void 支点Mark(int CaseNumber) { //////支点マーク 09/09/28
                  //
                  double i;
                  double[] TX;
                  double[] TY;
                  double[] TZ;
                  double X1;
                  double y1;
                  double Hx;
                  double Hy;
                  double Hz;
                  double Bai;
                  double X0;
                  double Y0;
                  double X2;
                  double Y2;
                  double CC;
                  double SS;
                  double AA;
                  double AA1;
                  int gCase;
                  int YAR;
                  //
                  if ( CaseNumber > 0 ) {
                      gCase = CaseNumber
                      if ( FLG車両ZU = True ) { ////////17/02/01
                          gCase = 1;
                      }
                  } else {
                      gCase = 1;  ////////////////////// nagase
                  }
                  YAR = 0;
                  Bai = max((0.05 / max(図X_SCALE, 図Y_SCALE)), 7.5); ////////7.5 ////////07/12/07
                  Bai = min(Bai, 12); ////////07/12/29
                  TX = new double[Jn_max];
                  TY = new double[Jn_max];
                  TZ = new double[Jn_max];
                  this.Shiten_FLG = new double[Jn_max]; //////14/05/04
                  this.SET_ShiTenData(gCase, TX, TY, TZ);
                  //
                  if ( BuzaiばねMark = 1 ) return;
                  //
                  With frmPrint.vsPrt1
                      //.PenColor = .BLACK // QBColor(部材Pen色)
                      .PenWidth = 部材Pen幅 - 12
                      For( i = 1 To ShiMax
                          AA = ShitenFD(i)
                          if ( 垂直左右 < 0 $$ ShitenFD(i) = 90 ) { //////////////////04/07/20
                              AA = 270
                          }
                          Hx = SMAX(TX(i), 0)
                          Hy = SMAX(TY(i), 0)
                          Hz = SMAX(TZ(i), 0)
                          if ( TX(i) + TY(i) + TZ(i) > 0 ) {
                              Shiten_FLG(i) = 1 //////14/05/04
                          }
                          if ( AA > -360 ) {
                              CC = Cos(DisAng1(HvoX(AA, i))) ////////////こちらに移動 08/04/25
                              SS = Sin(DisAng1(HvoY(AA, i)))
                              if ( Hx = 1 $$ Hy = 1 $$ Hz = 0 ) {
              //                    CC = Cos(DisAng1(HvoX(AA, i)))
              //                    SS = Sin(DisAng1(HvoY(AA, i)))
                                  if ( SS = 0 ) {
                                      CC = Abs(CC)
                                  }
              //                if ( Hx = 1 $$ Hy = 1 $$ Hz = 0 ) {
                                  Select Case AA
                                  Case 90
                                      X0 = HEN_X(節X(i)) + 0.35 * 56.7
                                      Y0 = HEN_Y(節Y(i))
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                  Case 270
                                      X0 = HEN_X(節X(i)) - 0.35 * 56.7
                                      Y0 = HEN_Y(節Y(i))
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                 Case 0
                                      X0 = HEN_X(節X(i))
                                      Y0 = HEN_Y(節Y(i)) + 0.35 * 56.7
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                  Case 180
                                      X0 = HEN_X(節X(i))
                                      Y0 = HEN_Y(節Y(i)) - 0.35 * 56.7
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                  Case } else {
                                  End Select
                              }
                              if ( (Hx = 0 $$ Hy >= 1 $$ Hz = 0) Or(Hx >= 1 $$ Hy = 0 $$ Hz = 0) ) {
                                 If(Hx = 0 $$ Hy >= 1 $$ Hz = 0) ) {
                                    AA = 0 ////////////////////////////////////////////// 04/08/27 nagase
                                  }
                                  If(Hx >= 1 $$ Hy = 0 $$ Hz = 0) ) {
                                     If(JX_max + JX_min) / 2 < 節X(i) ) { //節X(部I(i)) ) { //////////06/02/23
                                      AA = 90 ////////////////////////////////////////////// 05/02/25 nagase
                                      } else {
                                      AA = 270 //////////////// ////////////////////////// 05/02/25 nagase
                                      }
                                  }
                                  Select Case AA
                                  Case 90
                                      X0 = HEN_X(節X(i)) + 0.35 * 56.7
                                      Y0 = HEN_Y(節Y(i))
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(13 * Bai, -7 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(13 * Bai, -7 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(13 * Bai, 7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(13 * Bai, 7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                  Case 270
                                      X0 = HEN_X(節X(i)) - 0.35 * 56.7
                                      Y0 = HEN_Y(節Y(i))
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-13 * Bai, -7 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-13 * Bai, -7 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-13 * Bai, 7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-13 * Bai, 7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                  Case 0
                                      X0 = HEN_X(節X(i))
                                      Y0 = HEN_Y(節Y(i)) + 0.35 * 56.7
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-7 * Bai, 13 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-7 * Bai, 13 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(7 * Bai, 13 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(7 * Bai, 13 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                  Case 180
                                      X0 = HEN_X(節X(i))
                                      Y0 = HEN_Y(節Y(i)) - 0.35 * 56.7
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-7 * Bai, -13 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-7 * Bai, -13 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(7 * Bai, -13 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(7 * Bai, -13 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                  Case } else {
                                  End Select
                              }
                              if ( Hx = 1 $$ Hy = 1 $$ Hz = 1 ) { ////////////////////////////////////// 固定
                                  AA = Shiten固定(i)
                                  CC = Cos(DisAng1(HvoX(AA, i)))
                                  SS = Sin(DisAng1(HvoY(AA, i)))
                                  Select Case AA
                                  Case 90
                                      X0 = HEN_X(節X(i))
                                      Y0 = HEN_Y(節Y(i))
                                      X1 = X0 + Xvo(0, -12 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, -12 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(0, 10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(0, 10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(0, 0 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(10 * Bai, -4 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(10 * Bai, -4 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(0, (-0 + 6) * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, (-0 + 6) * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(10 * Bai, -(4 - 6) * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(10 * Bai, -(4 - 6) * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(0, (0 - 6) * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, (0 - 6) * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(10 * Bai, -(4 + 6) * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(10 * Bai, -(4 + 6) * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                  Case 270
                                      X0 = HEN_X(節X(i))
                                      Y0 = HEN_Y(節Y(i))
                                      X1 = X0 + Xvo(0, -12 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, -12 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(0, 10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(0, 10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(0, -2 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, -2 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-10 * Bai, 3 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-10 * Bai, 3 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(0, (-2 + 6) * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, (-2 + 6) * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-10 * Bai, (3 + 6) * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-10 * Bai, (3 + 6) * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(0, (-2 - 6) * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, (-2 - 6) * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-10 * Bai, (3 - 6) * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-10 * Bai, (3 - 6) * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                  Case 0
                                      X0 = HEN_X(節X(i))
                                      Y0 = HEN_Y(節Y(i))
                                      X1 = X0 + Xvo(-10 * Bai, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-10 * Bai, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(10 * Bai, 0, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(10 * Bai, 0, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(0 * Bai, 0, CC, SS, AA, i) // - 2 * Bai
                                      y1 = Y0 + Yvo(0 * Bai, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-5 * Bai, 10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-5 * Bai, 10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo((0 + 6) * Bai, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo((0 + 6) * Bai, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo((-5 + 6) * Bai, 10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo((-5 + 6) * Bai, 10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo((0 - 6) * Bai, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo((0 - 6) * Bai, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo((-5 - 6) * Bai, 10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo((-5 - 6) * Bai, 10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                  Case 180
                                      X0 = HEN_X(節X(i))
                                      Y0 = HEN_Y(節Y(i))
                                      X1 = X0 + Xvo(-10 * Bai, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-10 * Bai, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(10 * Bai, 0, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(10 * Bai, 0, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-2 * Bai, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-2 * Bai, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(3 * Bai, -10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(3 * Bai, -10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo((-2 + 6) * Bai, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo((-2 + 6) * Bai, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo((3 + 6) * Bai, -10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo((3 + 6) * Bai, -10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo((-2 - 6) * Bai, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo((-2 - 6) * Bai, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo((3 - 6) * Bai, -10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo((3 - 6) * Bai, -10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                  Case } else {
                                  End Select
                              }
                              if ( Hx > 1 $$ Hy = 0 $$ Hy = 0 ) {
                                      if ( AA = 90 ) {
                                          X0 = X0 + 1.8 * Bai
                                      } else {if ( AA = 270 ) {
                                          X0 = X0 - 34.5 * Bai
                                      }
                                      X1 = X0 + Xvo(13 * Bai, -6 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(13 * Bai, -6 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(13 * Bai, 6 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(13 * Bai, 6 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(13 * Bai, 6 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(13 * Bai, 6 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(16 * Bai, -6 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(16 * Bai, -6 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(16 * Bai, -6 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(16 * Bai, -6 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(16 * Bai, 6 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(16 * Bai, 6 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(16 * Bai, 6 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(16 * Bai, 6 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(19 * Bai, -6 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(19 * Bai, -6 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(19 * Bai, -6 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(19 * Bai, -6 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(19 * Bai, 6 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(19 * Bai, 6 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                              }
              //                if ( Hx > -1 $$ Hy != 0 $$ Hy != 1 $$ Hz = 0 ) { YAR = 1 ////////////// ばねマーク
                              if ( Hx > -1 $$ Hy != 0 $$ Hy != 1 ) { YAR = 1 ////////////// ばねマーク
                          }
                      }
                   End With

              //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// 05/03/15
                   if ( YAR = 1 ) {
                   With frmPrint.vsPrt1
                      .PenWidth = 4 //部材Pen幅 - 12
                      if ( CreateDxfFlag = 1 ) {
                          this.PLOTPEN(CSng(.PenWidth))
                      }
                      For( i = 1 To ShiMax
                          AA = ShitenFD(i)
                          if ( 垂直左右< 0 $$ ShitenFD(i) = 90 ) { //////////////////04/07/20
                              AA = 270
                          }
                          Hx = TX(i)
                          Hy = TY(i)
                          Hz = TZ(i)
                          if ( AA > -360 ) {
                              CC = Cos(DisAng1(HvoX(AA, i)))
                              SS = Sin(DisAng1(HvoY(AA, i)))
                              if ( (Hx > -1 $$ Hy != 0 $$ Hy != 1) ) { ////////////// ばねマーク
                                  Select Case AA
                                  Case 90
                                      X0 = HEN_X(節X(i)) + 0.35 * 56.7
                                      Y0 = HEN_Y(節Y(i))
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(13 * Bai, -7 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(13 * Bai, -7 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(13 * Bai, 7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(13 * Bai, 7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(13 * Bai, 7 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(13 * Bai, 7 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(16 * Bai, -7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(16 * Bai, -7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(16 * Bai, -7 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(16 * Bai, -7 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(16 * Bai, 7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(16 * Bai, 7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(16 * Bai, 7 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(16 * Bai, 7 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(19 * Bai, -7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(19 * Bai, -7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(19 * Bai, -7 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(19 * Bai, -7 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(19 * Bai, 7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(19 * Bai, 7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                  Case 270
                                      X0 = HEN_X(節X(i)) - 0.35 * 56.7
                                      Y0 = HEN_Y(節Y(i))
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-10 * Bai, -7 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-10 * Bai, 7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-13 * Bai, -7 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-13 * Bai, -7 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-13 * Bai, 7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-13 * Bai, 7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-13 * Bai, 7 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-13 * Bai, 7 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-16 * Bai, -7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-16 * Bai, -7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-16 * Bai, -7 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-16 * Bai, -7 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-16 * Bai, 7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-16 * Bai, 7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-16 * Bai, 7 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-16 * Bai, 7 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-19 * Bai, -7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-19 * Bai, -7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-19 * Bai, -7 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-19 * Bai, -7 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-19 * Bai, 7 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-19 * Bai, 7 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                  Case 0
                                      X0 = HEN_X(節X(i))
                                      Y0 = HEN_Y(節Y(i)) + 0.35 * 56.7
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i) ////////////////////////////////支点マーク
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(7 * Bai, 10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2 //////////////////支点マーク
                                      X1 = X0 + Xvo(-7 * Bai, 13 * Bai, CC, SS, AA, i) ////////鉛直バネマーク
                                      y1 = Y0 + Yvo(-7 * Bai, 13 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(7 * Bai, 13 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(7 * Bai, 13 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(7 * Bai, 13 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(7 * Bai, 13 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-7 * Bai, 16 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-7 * Bai, 16 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-7 * Bai, 16 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-7 * Bai, 16 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(7 * Bai, 16 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(7 * Bai, 16 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(7 * Bai, 16 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(7 * Bai, 16 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-7 * Bai, 19 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-7 * Bai, 19 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-7 * Bai, 19 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-7 * Bai, 19 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(7 * Bai, 19 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(7 * Bai, 19 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2 ////////////////////鉛直バネマーク
                                  Case 180
                                      X0 = HEN_X(節X(i))
                                      Y0 = HEN_Y(節Y(i)) - 0.35 * 56.7
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                                      X2 = X0 + Xvo(7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(7 * Bai, -10 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-7 * Bai, -13 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-7 * Bai, -13 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(7 * Bai, -13 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(7 * Bai, -13 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(7 * Bai, -13 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(7 * Bai, -13 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-7 * Bai, -16 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-7 * Bai, -16 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-7 * Bai, -16 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-7 * Bai, -16 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(7 * Bai, -16 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(7 * Bai, -16 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(7 * Bai, -16 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(7 * Bai, -16 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(-7 * Bai, -19 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(-7 * Bai, -19 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                      X1 = X0 + Xvo(-7 * Bai, -19 * Bai, CC, SS, AA, i)
                                      y1 = Y0 + Yvo(-7 * Bai, -19 * Bai, CC, SS, AA, i)
                                      X2 = X0 + Xvo(7 * Bai, -19 * Bai, CC, SS, AA, i)
                                      Y2 = Y0 + Yvo(7 * Bai, -19 * Bai, CC, SS, AA, i)
                                      DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                                  Case } else {
                                  End Select
                              }
                          }
                      }
                  End With
                  }
                  //
              }
       */

        /*    private void 分布ばねMark(BUZA As Integer, CASN As Integer) //////分布ばねマーク 10/01/22////////まだです
        double var i
        double var j
        var N       As Integer
        double var X1
        double var y1
        double var Hx
        double var Hy
        double var Hz
        double var Bai
        double var X0
        double var Y0
        double var X2
        double var Y2
        double var CC
        double var SS
        double var AA
        double var AA1
        double var LL
        var gCase As Integer
        var YAR As Integer
        var K1 As Integer, K2 As Integer
        var KU As Long
        var Pich As Single
        double var gPenWidth
        var max_横 As Integer
        var GRUP0 As Integer
        var mGROP() As Integer
        var BUZ1 As Integer, BUZ2 As Integer
        var NUM As Integer, BANENUM As Integer
        //
        if ( BuzaiばねMark = 1 ) { return;
        //    K1 = 0
        //        if ( BB_Bane(i, 0) = BUZA ) {
        //            K1 = i
        //            Exit For
        //        }
        //        if ( BB_Bane(i, 0) = 0 ) {
        //            Exit For
        //        }
        //    if ( K1 = 0 ) { return;
        if ( CASN< 0 ) {
            max_横 = 0
            For( i = 1 To BB_Bane(0, 0)
                N = 0
                For( K1 = 1 To 16
                    if ( BB_Bane(i, K1) = 0 ) { Exit For
                    N = N + 1
                }1
                max_横 = max(max_横, N)
            }
            if ( max_横 = 0 ) { return;
            K2 = 1
            For( i = 1 To BB_Bane(0, 0)
                For( K1 = 1 To max_横
                    if ( BB_Bane(i, K1) = 0 ) {
                        K2 = 0
                        Exit For
                    }
                }1
                if ( K2 = 0 ) { Exit For
            }
            if ( K2 = 0 ) { return;
            KU = UU_Bane(1, 1)
        } else {
        //        BANENUM = CC_Bane(現CASE)
        //        if ( BB_Bane(K1, K2) = 0 ) { return;
        //        KU = UU_Bane(K1, K2)
        }


        Bai = max((0.05 / max(図X_SCALE, 図Y_SCALE)), 7.5)
        Bai = min(Bai, 12)


        this.mGROP(部材_max, 4)
        //    Erase mGROP
        //    For( i = 1 To BB_Bane(0, 0)
        //        mGROP(GRUP0, 1) = 0
        //        mGROP(GRUP0, 2) = 0
        //        mGROP(GRUP0, 3) = 0
        //    }
        if ( CASN< 0 ) {
            BUZA = BB_Bane(1, 0)
            GRUP0 = 1
            mGROP(GRUP0, 1) = BUZA
            mGROP(GRUP0, 2) = BUZA
            mGROP(GRUP0, 3) = Sgn(KU)
            For( i = 2 To BB_Bane(0, 0)
                if ( 部J(BUZA) = 部I(BB_Bane(i, 0)) ) {
                    mGROP(GRUP0, 2) = BB_Bane(i, 0)
                    BUZA = BB_Bane(i, 0)
                } else {
                    BUZA = BB_Bane(i, 0)
                    GRUP0 = GRUP0 + 1
                    mGROP(GRUP0, 1) = BUZA
                    mGROP(GRUP0, 2) = BUZA
                    mGROP(GRUP0, 3) = Sgn(KU)
                }
            }
        } else {
            For( i = 1 To 部材_max //////BB_Bane(0, 0) //////17/02/28
                BUZA = i ////////BB_Bane(i, 0)
                X1 = 節X(部I(BUZA))
                y1 = 節Y(部I(BUZA))
                X2 = 節X(部J(BUZA))
                Y2 = 節Y(部J(BUZA))
                if ( X1 = X2 ) {
                    mGROP(BUZA, 4) = 2
                } else {
                    mGROP(BUZA, 4) = 1
                }
            }
            GRUP0 = 0
            BUZA = 0
            K2 = CC_Bane(現CASE)
            For( i = 1 To BB_Bane(0, 0)
                if ( BB_Bane(i, K2) = 0 ) {
                    //2019/12/04 #3 sasa コメントアウト -------------------------------------
        //                if ( GRUP0 > 0 $$ 部J(mGROP(GRUP0, 1)) = 部I(BB_Bane(i, 0)) ) {
        //                    BUZA = BB_Bane(i, 0)
        //                    GRUP0 = GRUP0 + 1
        //                    mGROP(GRUP0, 1) = BUZA
        //                    mGROP(GRUP0, 2) = BUZA
        //                    mGROP(GRUP0, 3) = Sgn(UU_Bane(i, K2))
        //                }
                    //-----------------------------------------------------------------------
                } else {
                    if ( GRUP0 = 0 $$ 部J(mGROP(GRUP0, 1)) = 部I(BB_Bane(i, 0)) ) {
                        BUZA = BB_Bane(i, 0)
                        GRUP0 = GRUP0 + 1
                        mGROP(GRUP0, 1) = BUZA
                        mGROP(GRUP0, 2) = BUZA
                        mGROP(GRUP0, 3) = Sgn(UU_Bane(i, K2))
                    } else {
                        if ( 部J(BUZA) = 部I(BB_Bane(i, 0)) $$ mGROP(BUZA, 4) = mGROP(BB_Bane(i, 0), 4) ) {
                            BUZA = BB_Bane(i, 0)
                            mGROP(GRUP0, 2) = BUZA
                        } else {
                            BUZA = BB_Bane(i, 0)
                            GRUP0 = GRUP0 + 1
                            mGROP(GRUP0, 1) = BUZA
                            mGROP(GRUP0, 2) = BUZA
                            mGROP(GRUP0, 3) = Sgn(UU_Bane(i, K2))
                        }
                    }
                }
            }
        }
        ////////////////////////////////////////////////////////////////////////////////
        For( NUM = 1 To GRUP0
            BUZ1 = mGROP(NUM, 1)
            BUZ2 = mGROP(NUM, 2)
            KU = mGROP(NUM, 3)
            X1 = HEN_X(節X(部I(BUZ1)))
            y1 = HEN_Y(節Y(部I(BUZ1)))
            X2 = HEN_X(節X(部J(BUZ2)))
            Y2 = HEN_Y(節Y(部J(BUZ2)))
            if ( X1 = X2 ) { //////垂直部材
                CC = 1: SS = 0
                If(JX_max + JX_min) / 2 < 節X(部I(BUZ1)) ) { ////////Abs(節X(部I(BUZ1)) - 節X(部J(BUZ2))) ) {
                   AA = 90
                } else {
                    AA = 270
                }
            } else {if ( y1 = Y2 ) { //////水平部材
                CC = 1: SS = 0: AA = 0
                X1 = X1 + 150
                y1 = y1 - 1.05 * 56.7
                X2 = X2 - 150
                Y2 = Y2 - 1.05 * 56.7
            }
            LL = Sqr((X1 - X2) ^ 2 + (y1 - Y2) ^ 2)
            if ( LL <= 2 ) { return; ////////if ( LL< 50 ) { return;
            N = -Int(-LL / 200)
            Pich = LL / N
            gPenWidth = frmPrint.vsPrt1.PenWidth
            frmPrint.vsPrt1.PenWidth = 3 //部材Pen幅
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( AA = 0 ) { //////////水平部材
                if ( N = 1 ) {
                X0 = X1 - Pich / 0.5
                } else {
                X0 = X1 - Pich / 1 ////////IIf(N = 1, 0.8, 1)
                }
                Y0 = y1
                For( i = 1 To N + IIf(N = 1, 0, 1)
                    frmPrint.vsPrt1.PenWidth = 3
                    X0 = X0 + Pich
                        X1 = X0 + Xvo(-3 * Bai, 13 * Bai, CC, SS, AA, i)
                        y1 = Y0 + Yvo(-3 * Bai, 13 * Bai, CC, SS, AA, i)
                        X2 = X0 + Xvo(3 * Bai, 13 * Bai, CC, SS, AA, i)
                        Y2 = Y0 + Yvo(3 * Bai, 13 * Bai, CC, SS, AA, i)
                        DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                        X1 = X0 + Xvo(3 * Bai, 13 * Bai, CC, SS, AA, i)
                        y1 = Y0 + Yvo(3 * Bai, 13 * Bai, CC, SS, AA, i)
                        X2 = X0 + Xvo(-3 * Bai, 16 * Bai, CC, SS, AA, i)
                        Y2 = Y0 + Yvo(-3 * Bai, 16 * Bai, CC, SS, AA, i)
                        DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                        X1 = X0 + Xvo(-3 * Bai, 16 * Bai, CC, SS, AA, i)
                        y1 = Y0 + Yvo(-3 * Bai, 16 * Bai, CC, SS, AA, i)
                        X2 = X0 + Xvo(3 * Bai, 16 * Bai, CC, SS, AA, i)
                        Y2 = Y0 + Yvo(3 * Bai, 16 * Bai, CC, SS, AA, i)
                        DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                        X1 = X0 + Xvo(3 * Bai, 16 * Bai, CC, SS, AA, i)
                        y1 = Y0 + Yvo(3 * Bai, 16 * Bai, CC, SS, AA, i)
                        X2 = X0 + Xvo(-3 * Bai, 19 * Bai, CC, SS, AA, i)
                        Y2 = Y0 + Yvo(-3 * Bai, 19 * Bai, CC, SS, AA, i)
                        DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                        X1 = X0 + Xvo(-3 * Bai, 19 * Bai, CC, SS, AA, i)
                        y1 = Y0 + Yvo(-3 * Bai, 19 * Bai, CC, SS, AA, i)
                        X2 = X0 + Xvo(3 * Bai, 19 * Bai, CC, SS, AA, i)
                        Y2 = Y0 + Yvo(3 * Bai, 19 * Bai, CC, SS, AA, i)
                        DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                        //Ku
                        if ( KU != 0 ) {
                            frmPrint.vsPrt1.PenWidth = 2
                            K1 = -8 * Bai
                            K2 = 14 * Bai
                            X1 = X0 + Xvo(13 * Bai, -2 * Bai, CC, SS, AA, i)
                            y1 = Y0 + Yvo(13 * Bai, -2 * Bai, CC, SS, AA, i)
                            X2 = X0 + Xvo(13 * Bai, 2 * Bai, CC, SS, AA, i)
                            Y2 = Y0 + Yvo(13 * Bai, 2 * Bai, CC, SS, AA, i)
                            DrawLinePrt frmPrint.vsPrt1, X1 + K1, y1 + K2, X2 + K1, Y2 + K2
                            X1 = X0 + Xvo(13 * Bai, 2 * Bai, CC, SS, AA, i)
                            y1 = Y0 + Yvo(13 * Bai, 2 * Bai, CC, SS, AA, i)
                            X2 = X0 + Xvo(16 * Bai, -2 * Bai, CC, SS, AA, i)
                            Y2 = Y0 + Yvo(16 * Bai, -2 * Bai, CC, SS, AA, i)
                            DrawLinePrt frmPrint.vsPrt1, X1 + K1, y1 + K2, X2 + K1, Y2 + K2
                            X1 = X0 + Xvo(16 * Bai, -2 * Bai, CC, SS, AA, i)
                            y1 = Y0 + Yvo(16 * Bai, -2 * Bai, CC, SS, AA, i)
                            X2 = X0 + Xvo(16 * Bai, 2 * Bai, CC, SS, AA, i)
                            Y2 = Y0 + Yvo(16 * Bai, 2 * Bai, CC, SS, AA, i)
                            DrawLinePrt frmPrint.vsPrt1, X1 + K1, y1 + K2, X2 + K1, Y2 + K2
                            X1 = X0 + Xvo(16 * Bai, 2 * Bai, CC, SS, AA, i)
                            y1 = Y0 + Yvo(16 * Bai, 2 * Bai, CC, SS, AA, i)
                            X2 = X0 + Xvo(19 * Bai, -2 * Bai, CC, SS, AA, i)
                            Y2 = Y0 + Yvo(19 * Bai, -2 * Bai, CC, SS, AA, i)
                            DrawLinePrt frmPrint.vsPrt1, X1 + K1, y1 + K2, X2 + K1, Y2 + K2
                            X1 = X0 + Xvo(19 * Bai, -2 * Bai, CC, SS, AA, i)
                            y1 = Y0 + Yvo(19 * Bai, -2 * Bai, CC, SS, AA, i)
                            X2 = X0 + Xvo(19 * Bai, 2 * Bai, CC, SS, AA, i)
                            Y2 = Y0 + Yvo(19 * Bai, 2 * Bai, CC, SS, AA, i)
                            DrawLinePrt frmPrint.vsPrt1, X1 + K1, y1 + K2, X2 + K1, Y2 + K2
                        }
                }
            } else { ////////////////////////////////////////////////////////////////////////鉛直部材
                if ( AA = 270 ) { //////左側
                    X0 = X1 - 28 * Bai
                    K1 = 18 * Bai
                    K2 = -8 * Bai
                } else {
                    X0 = X1 - 70 + 30
                    K1 = 14 * Bai
                    K2 = -8 * Bai
                }
                Y0 = y1 - Pich / 2
                For( i = 1 To N // + 1
                    frmPrint.vsPrt1.PenWidth = 3
                    Y0 = Y0 + Pich
                        X1 = X0 + Xvo(13 * Bai, -3 * Bai, CC, SS, AA, i)
                        y1 = Y0 + Yvo(13 * Bai, -3 * Bai, CC, SS, AA, i)
                        X2 = X0 + Xvo(13 * Bai, 3 * Bai, CC, SS, AA, i)
                        Y2 = Y0 + Yvo(13 * Bai, 3 * Bai, CC, SS, AA, i)
                        DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                        X1 = X0 + Xvo(13 * Bai, 3 * Bai, CC, SS, AA, i)
                        y1 = Y0 + Yvo(13 * Bai, 3 * Bai, CC, SS, AA, i)
                        X2 = X0 + Xvo(16 * Bai, -3 * Bai, CC, SS, AA, i)
                        Y2 = Y0 + Yvo(16 * Bai, -3 * Bai, CC, SS, AA, i)
                        DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                        X1 = X0 + Xvo(16 * Bai, -3 * Bai, CC, SS, AA, i)
                        y1 = Y0 + Yvo(16 * Bai, -3 * Bai, CC, SS, AA, i)
                        X2 = X0 + Xvo(16 * Bai, 3 * Bai, CC, SS, AA, i)
                        Y2 = Y0 + Yvo(16 * Bai, 3 * Bai, CC, SS, AA, i)
                        DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                        X1 = X0 + Xvo(16 * Bai, 3 * Bai, CC, SS, AA, i)
                        y1 = Y0 + Yvo(16 * Bai, 3 * Bai, CC, SS, AA, i)
                        X2 = X0 + Xvo(19 * Bai, -3 * Bai, CC, SS, AA, i)
                        Y2 = Y0 + Yvo(19 * Bai, -3 * Bai, CC, SS, AA, i)
                        DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                        X1 = X0 + Xvo(19 * Bai, -3 * Bai, CC, SS, AA, i)
                        y1 = Y0 + Yvo(19 * Bai, -3 * Bai, CC, SS, AA, i)
                        X2 = X0 + Xvo(19 * Bai, 3 * Bai, CC, SS, AA, i)
                        Y2 = Y0 + Yvo(19 * Bai, 3 * Bai, CC, SS, AA, i)
                        DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                    if ( KU!= 0 ) {
                        frmPrint.vsPrt1.PenWidth = 2
                        X1 = X0 + Xvo(-2 * Bai, 13 * Bai, CC, SS, AA, i)
                        y1 = Y0 + Yvo(-2 * Bai, 13 * Bai, CC, SS, AA, i)
                        X2 = X0 + Xvo(2 * Bai, 13 * Bai, CC, SS, AA, i)
                        Y2 = Y0 + Yvo(2 * Bai, 13 * Bai, CC, SS, AA, i)
                        DrawLinePrt frmPrint.vsPrt1, X1 + K1, y1 + K2, X2 + K1, Y2 + K2
                        X1 = X0 + Xvo(2 * Bai, 13 * Bai, CC, SS, AA, i)
                        y1 = Y0 + Yvo(2 * Bai, 13 * Bai, CC, SS, AA, i)
                        X2 = X0 + Xvo(-2 * Bai, 16 * Bai, CC, SS, AA, i)
                        Y2 = Y0 + Yvo(-2 * Bai, 16 * Bai, CC, SS, AA, i)
                        DrawLinePrt frmPrint.vsPrt1, X1 + K1, y1 + K2, X2 + K1, Y2 + K2
                        X1 = X0 + Xvo(-2 * Bai, 16 * Bai, CC, SS, AA, i)
                        y1 = Y0 + Yvo(-2 * Bai, 16 * Bai, CC, SS, AA, i)
                        X2 = X0 + Xvo(2 * Bai, 16 * Bai, CC, SS, AA, i)
                        Y2 = Y0 + Yvo(2 * Bai, 16 * Bai, CC, SS, AA, i)
                        DrawLinePrt frmPrint.vsPrt1, X1 + K1, y1 + K2, X2 + K1, Y2 + K2
                        X1 = X0 + Xvo(2 * Bai, 16 * Bai, CC, SS, AA, i)
                        y1 = Y0 + Yvo(2 * Bai, 16 * Bai, CC, SS, AA, i)
                        X2 = X0 + Xvo(-2 * Bai, 19 * Bai, CC, SS, AA, i)
                        Y2 = Y0 + Yvo(-2 * Bai, 19 * Bai, CC, SS, AA, i)
                        DrawLinePrt frmPrint.vsPrt1, X1 + K1, y1 + K2, X2 + K1, Y2 + K2
                        X1 = X0 + Xvo(-2 * Bai, 19 * Bai, CC, SS, AA, i)
                        y1 = Y0 + Yvo(-2 * Bai, 19 * Bai, CC, SS, AA, i)
                        X2 = X0 + Xvo(2 * Bai, 19 * Bai, CC, SS, AA, i)
                        Y2 = Y0 + Yvo(2 * Bai, 19 * Bai, CC, SS, AA, i)
                        DrawLinePrt frmPrint.vsPrt1, X1 + K1, y1 + K2, X2 + K1, Y2 + K2
                    }
                }
            }
        Next NUM
        frmPrint.vsPrt1.PenWidth = gPenWidth
        }
        */

        /*private double HvoX(double AA, double JJ){
            //
            double i;
            double[] HH = new double[1000];
            double[] ii = new double[1000];
            double HC;
            double XX;
            double YY;
            double GG;
            double[] AB = new double[4];
            double[] KK = new double[1000];
            double K1;
            //
            for( i=0; t<1000; i++){
                HH[i] = -9000000000#;
                ii[i] = -9000000000#;
            }
            HC = 0;
            for( i=0; i<部材_max; i++){
                if ( ZZBuzaiBai[i] != 0 ) {
                    if ( FBuzaiI[i] = JJ || FBuzaiJ[i] = JJ ) {
                        HC = HC + 1;
                        HH[HC] = i;
                        if ( FBuzaiI[i] = JJ ) {
                            ii[HC] = 1;
                        }
                        if ( FBuzaiJ[i] = JJ ) {
                            ii[HC] = -1;
                        }
                    }
                }
            }
            if ( HC <= 1 ) {
                if ( HC = 1 ) {
                    if ( AngleDF1[HH[HC]] != 0 $$ AngleDF1[HH[HC]] != 90 $$ AngleDF1[HH[HC]] != 180 $$ AngleDF1[HH(HC]] != 270 ] {
                        if ( AngleDF1[HH[HC]] > AA ] {
                            if ( ii(HC) = 1 ) {
                                HvoX = AngleDF1[HH[HC]] - AA - 90
                                Exit Function
                            } else {
                                HvoX = XXMMin(CDbl(AngleDF1[HH[HC]]] + 90]
                                Exit Function
                            }
                        }
                    } else {
                    }
                }
                HvoX = 0
                Exit Function
            } else {
                AB(1) = 0
                AB(2) = 0
                AB(3) = 0
                AB(4) = 0
                K1 = 0
                For( i = 1 To HC
                    GG = HH[i]
                    if ( ii(GG) = 1 ) {
                        if ( AngleDF1[GG] = 0 ] {
                            AB(1) = 1
                        }
                        if ( AngleDF1[GG] = 90 ] {
                            AB(2) = 1
                        }
                        if ( AngleDF1[GG] = 180 ] {
                            AB(3) = 1
                        }
                        if ( AngleDF1[GG] = 270 ] {
                            AB(4) = 1
                        }
                    } else {
                        if ( AngleDF1[GG] = 0 ] {
                            AB(3) = 1
                        }
                        if ( AngleDF1[GG] = 90 ] {
                            AB(4) = 1
                        }
                        if ( AngleDF1[GG] = 180 ] {
                            AB(1) = 1
                        }
                        if ( AngleDF1[GG] = 270 ] {
                            AB(2) = 1
                        }
                    }
                    if ( AngleDF1[GG] = 0 || AngleDF1[GG] = 90 || AngleDF1[GG] = 180 || AngleDF1[GG] = 270 ] {
                    } else {
            //                K1 = K1 + 1
            //                KK(K1) = AngleDF1[GG]//////09/09/28
                    }
                }
                if ( K1 = 0 ) {
                    HvoX = 0
                } else {
                    Select Case AA
                    Case 0
                        HvoX = KK(1)
                    Case 90
                        HvoX = KK(1) - 90
                    Case 180
                        HvoX = KK(1) - 180
                    Case 270
                        HvoX = KK(1) - 270
                    Case } else {
                    End Select
                }
            }
            //
        }
        */

        /* private double HvoY(double AA , double JJ) {
        //
        double var i
        double var HH[1000]
        double var ii(1000)
        double var HC
        double var XX
        double var YY
        double var GG
        double var AB(4)
        double var KK(1000)
        double var K1
        //
        For( i = 1 To 1000
            HH[i] = -9000000000#
            ii(i) = -9000000000#
        }
        HC = 0
        For( i = 1 To 部材_max
            if ( ZZBuzaiBai(i) != 0 ) {
            if ( FBuzaiI(i) = JJ || FBuzaiJ(i) = JJ ) {
                HC = HC + 1
                HH[HC] = i
                if ( FBuzaiI(i) = JJ ) {
                    ii(HC) = 1
                }
                if ( FBuzaiJ(i) = JJ ) {
                    ii(HC) = -1
                }
            }
            }
        }
        if ( HC <= 1 ) {
            if ( HC = 1 ) {
                if ( AngleDF1[HH[HC]] != 0 $$ AngleDF1[HH[HC]] != 90 $$ AngleDF1[HH[HC]] != 180 $$ AngleDF1[HH(HC]] != 270 ] {
                    if ( AngleDF1[HH[HC]] > AA ] {
                        if ( ii(HC) = 1 ) {
                            HvoY = AngleDF1[HH[HC]] - AA - 90
                            Exit Function
                        } else {
                            HvoY = XXMMin(CDbl(AngleDF1[HH[HC]]] + 90]
                            Exit Function
                        }
                    }
                } else {
                }
            }
            HvoY = 0
            Exit Function
        } else {
            AB(1) = 0
            AB(2) = 0
            AB(3) = 0
            AB(4) = 0
            K1 = 0
            For( i = 1 To HC
                GG = HH[i]
                if ( ii(GG) = 1 ) {
                    if ( AngleDF1[GG] = 0 ] {
                        AB(1) = 1
                    }
                    if ( AngleDF1[GG] = 90 ] {
                        AB(2) = 1
                    }
                    if ( AngleDF1[GG] = 180 ] {
                        AB(3) = 1
                    }
                    if ( AngleDF1[GG] = 270 ] {
                        AB(4) = 1
                    }
                } else {
                    if ( AngleDF1[GG] = 0 ] {
                        AB(3) = 1
                    }
                    if ( AngleDF1[GG] = 90 ] {
                        AB(4) = 1
                    }
                    if ( AngleDF1[GG] = 180 ] {
                        AB(1) = 1
                    }
                    if ( AngleDF1[GG] = 270 ] {
                        AB(2) = 1
                    }
                }
                if ( AngleDF1[GG] = 90 || AngleDF1[GG] = 180 || AngleDF1[GG] = 270 ] { //////////07/12/07
        //            if ( AngleDF1[GG] = 0 || AngleDF1[GG] = 90 || AngleDF1[GG] = 180 || AngleDF1[GG] = 270 ] {
                } else {
        //                K1 = K1 + 1
        //                KK(K1) = AngleDF1[GG]////////09/09/28
                }
            }
            if ( K1 = 0 ) {
                HvoY = 0
            } else {
                Select Case AA
                Case 0
                    HvoY = KK(1)
                Case 90
                    HvoY = KK(1) - 90
                Case 180
                    HvoY = KK(1) - 180
                Case 270
                    HvoY = KK(1) - 270
                Case } else {
                End Select
            }
        }
        //
        }
        */

        /* private double XXMMin(double AAA) {
    //
    if ( AAA > 360 ) {
        return AAA - 360;
    } else {
        return AAA;
    }
    //
}

private double Xvo(double X, double Y, double CC, double SS, double AA, double i) {
    //
    return X * CC + Y * SS;
    //
}

private double Yvo(double X, double Y, double CC, double SS, double AA, double i) {
    //
    return -X* SS + Y* CC;
    //
}

private void SET_ShiTenData(int CASEn, double[] TX, double[] TY, double[] TZ()){
    //
    int Y;
    int i;
    //
    if ( this.CaseShiten(CASEn) < 0 ) {
        Y = 1
    } else {
        Y = this.CaseShiten(CASEn);
    }
    for( var i=0; i<this.Jn_max; i++){
        TX[i] = this.ShitenTX(i, Y);
        TY[i] = this.ShitenTY(i, Y);
        TZ[i] = this.ShitenTZ(i, Y);
    }
    //
}

        */

        //public void K荷重図INIT_23(Taiisin As Integer)   //橋脚からのキック
        //    //    FR橋脚 = 2    // FR橋脚 = 1 : フレーム   FR橋脚 = 2 : 橋脚
        //    //
        //    S新耐震 = Taiisin
        //    FOLU = gstrFrmDir
        //    this.K荷重図INIT_Frame(gstrFrmDir & "16.txt", gstrFrmDir & "17.txt", 2)
        //    if ( Taiisin = 0 ) {
        //        gOut部材番号 = False
        //    }
        //    FR橋脚 = 2
        //    RR橋脚 = 2
        //    this.ファイル変換
        //    //
        //}

        /* public void K荷重図(int CASN, bool bTitle, int Ft_Flg, string strAAA) { //KAJYUU_ZU2
            //
            // double F7R;
            // var NAME1
            // var OF1
            // double i;
            // double j;
            // double k;
            // double ZFXRetsu;
            // string strTitle;
            // double A3XIdou = 40;
            // double A3YIdou = 30;
            // //
            // this.FLG車両ZU = false;
            // if ( CASN > 0 ) {
            //     this.NUM車両ZU = CASN;
            //     this.FLG車両ZU = true;
            //     CASN = 0;
            // }
            // if ( this.SNAPmodeFF = 1 ) {
            //     if ( CASN >= 0 ) {
            //         for( var k=0; k<10;k++){
            //             ZFXRetsu = k;
            //             for( var i=100; i>0; i--){
            //                 if ( i > 0 ) {
            //                     for( var j=0; j<i-1; j++){
            //                         this.ZFXLine[this.SenroModeZF, ZFXRetsu, i] = this.ZFXLine[this.SenroModeZF, ZFXRetsu, i] + this.ZFXLine[SenroModeZF, ZFXRetsu, j];
            //                     }
            //                 }
            //             }
            //         }
            //     }
            // }
            // this.Foot_Flg = Ft_Flg;
            // strTitle = strAAA;
            // var OutouCase1 = 0;
            // var OutouCase2 = 0;
            // var OutouCase3 = 0;
            // var OutouCase4 = 0;
            // var OutouCase5 = 0;
            // var OutouCase6 = 0;
            // var OutouCase7 = 0;
            // var OutouCase8 = 0;
            // this.SunPouMojiSize1 = 6
            // this.SunPouMojiSize2 = 6
            // this.SunPouMojiSize3 = 6
            // if ( this.GibanHeniX1 = 1 ) {     // 応答変位量の印字のみ
            //     SunPouStartX1 = -25 * OuTouBai
            //     SunPouStartX2 = -20 * OuTouBai
            //     SunPouStartX3 = -15 * OuTouBai
            //     MaxKuiOuTou = 50 * 56.7 / 2 // 杭の応答変位図時の最大値を５０mmで書く
            // } else {
            //     SunPouStartX1 = -16 * OuTouBai
            //     SunPouStartX2 = -11 * OuTouBai
            //     SunPouStartX3 = -6 * OuTouBai
            //     MaxKuiOuTou = 35 * 56.7  // 杭の応答変位図時の最大値を５０mmで書く
            // }
            // SunPouPenWidth = 10
            // YajirushiSize = 4 * OuTouBai
            // Select Case OutouHeniSuuchiX1
            // Case 1
            //     SouatrsuValuePrint = 0
            // Case 2
            //     SouatrsuValuePrint = 1
            // Case } else {
            //     SouatrsuValuePrint = 0
            // End Select
            // Select Case OutouHeniSuuchiX2
            // Case 1
            //     SouatrsuValuePrintA = 0
            // Case 2
            //     SouatrsuValuePrintA = 1
            // Case 3
            //     SouatrsuValuePrintA = 2
            // Case } else {
            //     SouatrsuValuePrintA = 2
            // End Select
            // if ( GibanHeniX1 = 1 ) {     // 応答変位量の印字のみ
            //     if ( A3FLAG = 0 ) {
            //         OutouStartX = 90 * OuTouBai
            //         OutouStartY = 60 * OuTouBai
            //     } else {
            //         OutouStartX = (A3XIdou + 90) * OuTouBai
            //         OutouStartY = (A3YIdou + 60) * OuTouBai
            //     }
            // } else {
            //     if ( A3FLAG = 0 ) {
            //         OutouStartX1 = 40 * OuTouBai
            //         OutouStartX2 = 90 * OuTouBai
            //         OutouStartX = 140 * OuTouBai
            //         OutouStartY = 60 * OuTouBai
            //     } else {
            //         OutouStartX1 = (A3XIdou + 40) * OuTouBai
            //         OutouStartX2 = (A3XIdou + 90) * OuTouBai
            //         OutouStartX = (A3XIdou + 140) * OuTouBai
            //         OutouStartY = (A3YIdou + 60) * OuTouBai
            //     }
            // }
            // EqualKui = 0
            // this.Reset_KajuuZu
            // this.RESET_OUTOU_Normal
            this.READ_XY    // 節点データを読む
            this.READ_BUZ(CASN, bTitle) // 部材データを読む
            this.部材DATA整理   // 部材の角度を計算しておく
            // F7R = 0
            // this.RESET_07 // 配列をリセットしているようだ

            // 荷重データを読む
            this.FRUD06_BBB(F7MAX_R, F7ML1(), F7ML2(), F7ML3(), F7ML(), F7ML31(), F7ML4(), F7ML5(), F7ML6(), F7R)

            // this.ReadData147 // 杭のばね情報を読む
            // this.KuiDataSet_N
            // this.RESET_07_1
            // if ( FR橋脚 = 2 $$ CASN = 0 ) {
            //     CASN = 9999
            // }
            // if ( CASN >= 0 ) {
            //     this.READ_Kajyu
            //     this.変換_K_Jitubuzai
            // }
            //    this.SUBP100(CASN, bTitle)
            //    this.RESET_OUTOU_Normal
            //    this.RESET_07
            //    this.RESET_07_2
            //
        }*/

        /* public void K荷重図INIT_Frame(ByRef fname1 As String, ByRef fname2 As String, Optional fKozo As Integer)
        //
        var MaxI                    As Integer
        var fNum                    As Integer
        var str                     As String
        var Pos                     As Integer
        var i                       As Long
        var j                       As Long
        double var RRR
        double var OT1
        double var OT2
        double var OT3
        double var OT4
        double var OT5
        double var OT6
        double var OT7
        double var OT8
        double var OT9
        double var OT10
        var strTitle As String
        //
        π = 3.141592
        Twip = 56.7 //csngLogic1mmByTwips
        this.FlagParameterFILEXXX2(1, OT1, OT2, OT3, OT4, OT5, OT6, OT7, OT8, OT9, OT10, RRR)
        SuiheiBaneEqual = OT1
        iKozo = fKozo
        //    iKozo = 1 //高架橋
        //    iKozo = 2 //橋 脚
        //    iKozo = 3 //カルバートボックス
        strTitle = ""
        if ( iKozo = 2 ) {
          FR橋脚 = 2
          RR橋脚 = 1
        } else {
          FR橋脚 = 1
          RR橋脚 = 1
        }
        gOut部材番号 = True
        // リスト以外のControlへのロード
        fNum = FreeFile
        if ( Dir(fname1) = "" ) {
            return;    //   *** return;
        }


        Open fname1 For( Input As #fNum
        Line Input #fNum, str
        if ( CInt(str) = 0 ) {
            Close
            return;    //   *** return;
        }

        // 作図ケース
        Line Input #fNum, str
        Pos = InStr(str, vbTab)
        str = Mid(str, Pos + 1)
        For( i = 0 To 0
            Pos = InStr(str, vbTab)
            //骨組図チェックのデータが存在しないときは自動的に０にする
            if ( Pos = 0 ) {
                荷重図フォーマット.int作図指定(0) = CInt(str)
                str = ""
            } else {
                荷重図フォーマット.int作図指定(0) = CInt(Left(str, Pos - 1))
            }
            str = Mid(str, Pos + 1)
        }

        // ペーパサイズ
        Line Input #fNum, str
        Pos = InStr(str, vbTab)
        str = Mid(str, Pos + 1)
        荷重図フォーマット.int用紙サイズ = CInt(str)

        // 書式１
        Line Input #fNum, str
        Pos = InStr(str, vbTab)
        str = Mid(str, Pos + 1)
        荷重図フォーマット.int用紙方向 = CInt(str)

        // 書式２
        Line Input #fNum, str
        Pos = InStr(str, vbTab)
        str = Mid(str, Pos + 1)
        荷重図フォーマット.intレイアウト = CInt(str)

        // 骨組図
        // 軸線スケール
        Line Input #fNum, str
        Pos = InStr(str, vbTab)


        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        //自動ならcsngNullが入る
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
        荷重図フォーマット.sng骨組軸線スケール縦 = CSng(Left(str, Pos - 1))
        } else {
        荷重図フォーマット.sng骨組軸線スケール縦 = csngNull
        }

        if ( 荷重図フォーマット.sng骨組軸線スケール縦 = 0 ) { 荷重図フォーマット.sng骨組軸線スケール縦 = csngNull


        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
        荷重図フォーマット.sng骨組軸線スケール横 = CSng(Left(str, Pos - 1))
        } else {
        荷重図フォーマット.sng骨組軸線スケール横 = csngNull
        }

        if ( 荷重図フォーマット.sng骨組軸線スケール横 = 0 ) { 荷重図フォーマット.sng骨組軸線スケール横 = csngNull

        // 位置補正
        Line Input #fNum, str
        Pos = InStr(str, vbTab)


        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
        荷重図フォーマット.sng骨組位置補正X = CSng(Left(str, Pos - 1))
        } else {
        荷重図フォーマット.sng骨組位置補正X = csngNull
        }

        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
        荷重図フォーマット.sng骨組位置補正Y = CSng(Left(str, Pos - 1))
        } else {
        荷重図フォーマット.sng骨組位置補正Y = csngNull
        }

        //--------------------------------------------

        // 荷重図
        // 軸線スケール
        Line Input #fNum, str
        Pos = InStr(str, vbTab)


        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        //自動ならcsngNullが入る
        if ( IsNumeric(Left(str, Pos - 1)) = True ) { 荷重図フォーマット.sng荷重軸線スケール縦 = CSng(Left(str, Pos - 1)) } else { 荷重図フォーマット.sng荷重軸線スケール縦 = csngNull
        if ( 荷重図フォーマット.sng荷重軸線スケール縦 = 0 ) { 荷重図フォーマット.sng荷重軸線スケール縦 = csngNull


        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) { 荷重図フォーマット.sng荷重軸線スケール横 = CSng(Left(str, Pos - 1)) } else { 荷重図フォーマット.sng荷重軸線スケール横 = csngNull
        if ( 荷重図フォーマット.sng荷重軸線スケール横 = 0 ) { 荷重図フォーマット.sng荷重軸線スケール横 = csngNull


        // 位置補正
        Line Input #fNum, str
        Pos = InStr(str, vbTab)


        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) { 荷重図フォーマット.sng荷重位置補正X = CSng(Left(str, Pos - 1)) } else { 荷重図フォーマット.sng荷重位置補正X = csngNull

        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) { 荷重図フォーマット.sng荷重位置補正Y = CSng(Left(str, Pos - 1)) } else { 荷重図フォーマット.sng荷重位置補正Y = csngNull


        // sng荷重スケール
        Line Input #fNum, str
        Pos = InStr(str, vbTab)


        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
        荷重図フォーマット.sng荷重スケール分布荷重 = CSng(Left(str, Pos - 1))
        } else {
        荷重図フォーマット.sng荷重スケール分布荷重 = csngNull
        }

        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
        荷重図フォーマット.sng荷重スケール集中荷重 = CSng(Left(str, Pos - 1))
        } else {
        荷重図フォーマット.sng荷重スケール集中荷重 = csngNull
        }

        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
        荷重図フォーマット.sng荷重スケールモーメント半径 = CSng(Left(str, Pos - 1))
        } else {
        荷重図フォーマット.sng荷重スケールモーメント半径 = csngNull
        }

        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
        荷重図フォーマット.sng荷重スケール節点荷重 = CSng(Left(str, Pos - 1))
        } else {
        荷重図フォーマット.sng荷重スケール節点荷重 = csngNull
        }

        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
        荷重図フォーマット.sng荷重スケール節点モーメント = CSng(Left(str, Pos - 1))
        } else {
        荷重図フォーマット.sng荷重スケール節点モーメント = csngNull
        }

        Line Input #fNum, str
        Pos = InStr(str, vbTab)
        str = Mid(str, Pos + 2)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
          荷重文字サイズ = CSng(str) * Twip / 15 //csngMmToPoint
          if ( 荷重文字サイズ = 0 ) { 荷重文字サイズ = 9 //////////////14/11/177
        } else {
        //      荷重図フォーマット.sng文字サイズ = csngNull
          荷重文字サイズ = 9
        }
        Line Input #fNum, str
        Pos = InStr(str, vbTab)
        str = Mid(str, Pos + 1)
        荷重図フォーマット.int文字フォント = CInt(str)
        //
        Close

        // リストへのロード(%の部分のみ）
        fNum = FreeFile

        if ( Dir(fname2) = "" ) {
            return;
        }

        Open fname2 For( Input As #fNum
        Line Input #fNum, str
        lng部材数 = CLng(str)

        if ( lng部材数 > 0 ) {
            this.部材縮小率(lng部材数 - 1)
            this.BuzaiBai(lng部材数)
            this.ZZBuzaiBai(lng部材数)
            For( i = 0 To lng部材数 - 1
                Line Input #fNum, str
                For( j = 0 To 4
                    Pos = InStr(str, vbTab)
                    Select Case j
                    Case 0
                        部材縮小率(i).intIdx = val(Left(str, Pos - 1))
                    Case 1
                        部材縮小率(i).int部材番号 = val(Left(str, Pos - 1))
                    Case 2
                        部材縮小率(i).str部材名 = Left(str, Pos - 1)
                    Case 3
                        部材縮小率(i).int骨組縮小率 = val(Left(str, Pos - 1))
                    Case 4
                        部材縮小率(i).int荷重縮小率 = val(Left(str, Pos - 1))
                        ZZBuzaiBai(i + 1) = val(Left(str, Pos - 1)) / 100
                        BuzaiBai(i + 1) = 1 // val(Left(str, pos - 1)) / 100
                    End Select
                    str = Mid(str, Pos + 1)
                }
            }
        }


        Close

        //表示色 = ""


        FOLU = gstrFrmDir

        Select Case 荷重図フォーマット.int用紙サイズ //   0-A4 1-A3 2-B4 3-B5
        Case 0 //0-A4
            Select Case 荷重図フォーマット.int用紙方向
            Case 1 //横
                左開き = 10:  上開き = 18   //mm
                枠横幅 = 260: 枠縦幅 = 176  //mm
                図横幅 = 190: 図縦幅 = 110  //mm
            Case } else { //縦
                左開き = 18:  上開き = 18 //18   //mm
                枠横幅 = 176: 枠縦幅 = 260  //mm
                図横幅 = 120: 図縦幅 = 160  //mm
            End Select
         Case 1 //0-A3
            Select Case 荷重図フォーマット.int用紙方向
            Case 1 //横
                左開き = 23:  上開き = 23   //mm
                枠横幅 = Round(265 * Sqr(2), 0): 枠縦幅 = Round(178 * Sqr(2), 0) //mm
                図横幅 = Round(224 * Sqr(2), 0): 図縦幅 = Round(110 * Sqr(2), 0) //mm
            Case } else { //縦
                左開き = 24:  上開き = 23   //mm
                枠横幅 = Round(176 * Sqr(2), 0): 枠縦幅 = Round(265 * Sqr(2), 0) //mm
                図横幅 = Round(120 * Sqr(2), 0): 図縦幅 = Round(180 * Sqr(2), 0) //mm
            End Select
        End Select
        //    if ( FR橋脚 = 2 ) { 枠横幅 = 枠横幅 * 0.5 //0.4

        //    Select Case 表示色
        //    Case "黒"
            枠Pen色 = 0
            部材Pen色 = 0
            節点荷重Pen色 = 0
            部材荷重Pen色 = 0
            部材荷重寸法Pen色 = 0
            節点Pen色 = 0
        //    Case } else {
        //        枠Pen色 = 0           //黒
        //        部材Pen色 = 12        //明るい赤
        //        節点荷重Pen色 = 3     //ｼｱﾝ
        //        部材荷重Pen色 = 1     //青
        //        部材荷重寸法Pen色 = 1 //青
        //        節点Pen色 = 0         //黒
        //    End Select

        //------------------------------------------------------------------------------
        枠Pen幅 = 20
        //------------------------------------------------------------------------------
        節点番号Fontsize = 6      // ﾎﾟｲﾝﾄ
        //------------------------------------------------------------------------------
        部材番号Fontsize = 6
        部材Pen幅 = 20
        Pen幅 = 6 //軸方向分布荷重
        //------------------------------------------------------------------------------
        // 節点荷重
        //------------------------------------------------------------------------------
        //    節点荷重Fontsize = 9 //8
        節点荷重Pen幅 = 16


        節点荷重Scale = Twip / 4 //3 //5  //節点荷重Scale  Twip/n   n が大きくなると図が小さくなる


        節点荷重角度 = 10         //部材が有る場合の節点荷重角度  ﾄﾞ
        節点荷重初期値 = 8        //節点荷重図大きさの初期値  mm             = csngNull


        if ( 荷重図フォーマット.sng荷重スケール節点荷重<csngNull ) {
           節点荷重長さmax = 荷重図フォーマット.sng荷重スケール節点荷重
        } else {
           節点荷重長さmax = 12        //節点荷重図化最大長さ  mm
        }
        if ( 荷重図フォーマット.sng荷重スケール節点モーメント<csngNull ) {
           節点M荷重長さmax = 荷重図フォーマット.sng荷重スケール節点モーメント
        } else {
           if ( FR橋脚 = 1 ) {
           節点M荷重長さmax = 4.2    //節点M荷重図化最大長さ  mm
           } else {
           節点M荷重長さmax = 4.2
           }
        }
        //------------------------------------------------------------------------------
        // 部材荷重
        //------------------------------------------------------------------------------
        部材荷重Pen幅 = 10
        部材荷重矢Pen幅 = 0
        部材荷重寸法Pen幅 = 5


        荷重図上盛上げ初期値 = 1.2 //mm
        荷重図下盛上げ初期値 = 3   //mm
        荷重図盛上げpit(1) = 20 //18 部材荷重     //mm
        荷重図盛上げpit(2) = 17 //16 //集中荷重
        荷重寸法線位置(1) = 荷重図盛上げpit(1) - 5   //mm
        荷重寸法線位置(2) = 荷重図盛上げpit(2) - 5   //mm
        荷重寸法補助線 = 3.5 //5                     //mm
        部材荷重矢長さmin = 0.8               //mm


        部材荷重Scale = Twip / 7 //5              //部材荷重Scale Twip/n n が大きくなると図が小さくなる
        集中荷重Scale = Twip / 7 //5              //部材荷重Scale Twip/n n が大きくなると図が小さくなる

        部材荷重初期値 = 3                    //部材荷重図大きさの初期値  mm
        集中荷重初期値 = 6                    //部材荷重図大きさの初期値  mm

        if ( FR橋脚 = 2 ) {
            荷重図盛上げpit(1) = 22
            荷重図盛上げpit(2) = 18
            荷重寸法線位置(1) = 荷重図盛上げpit(1) - 8 //  mm
            荷重寸法線位置(2) = 荷重図盛上げpit(2) - 6.5 //mm
            荷重文字サイズ = 9
        }


        if ( 荷重図フォーマット.sng荷重スケール分布荷重<csngNull ) {
           部材荷重長さmax = 荷重図フォーマット.sng荷重スケール分布荷重
        } else {
           部材荷重長さmax = 荷重寸法線位置(2) - 8 //6  //部材荷重図化最大長さ mm 10/10
        }
        if ( 荷重図フォーマット.sng荷重スケール集中荷重<csngNull ) {
           集中荷重長さmax = 荷重図フォーマット.sng荷重スケール集中荷重
        } else {
           集中荷重長さmax = 荷重寸法線位置(1) + 15 //5 //2  //集中荷重図化最大長さ  mm
        }
        if ( 荷重図フォーマット.sng荷重スケールモーメント半径<csngNull ) {
            部材M荷重長さmax = 荷重図フォーマット.sng荷重スケールモーメント半径
        } else {
            if ( FR橋脚 = 1 ) {
                部材M荷重長さmax = 4 //4.6   //部材M荷重図化最大長さ mm
            } else {
                部材M荷重長さmax = 4
            }
        }


        固定部材M荷重長さ = 5                 //固定部材M荷重図化長さ  mm
        固定部材PURE1荷重長さ = 5             //固定部材ﾌﾟﾚｽﾄﾚｽﾄ1荷重図化長さ  mm
        固定部材PURE2荷重長さ = 5             //固定部材ﾌﾟﾚｽﾄﾚｽﾄ1荷重図化長さ  mm
        //------------------------------------------------------------------------------
        荷重文字Fontsize = 8
        荷重文字pit = 2.5           //mm


        Select Case 荷重TEXT位置
        Case "左"
            荷重座標X = 25          //mm
        Case "右"
            荷重座標X = 140         //mm
        Case } else {
            荷重座標X = 0
        End Select
        荷重座標Y初期値 = 30        //mm

        //    if ( FR橋脚 = 1 ) {
        //        節点荷重Fontsize = 8 //7
        //        部材荷重Fontsize = 8 //7
        //        荷重文字Fontsize = 8 //7
        //        荷重寸法Fontsize = 8 //7
        //    } else { //                    FR橋脚 = 2
        //        節点荷重Fontsize = 8.5 //8
        //        部材荷重Fontsize = 8.5 //8
        //        荷重文字Fontsize = 8.5 //8
        //        荷重寸法Fontsize = 8
        //    }
        //
            節点荷重Fontsize = max((荷重文字サイズ * 0.8), 8.5) //////14/11/177
            部材荷重Fontsize = max((荷重文字サイズ * 0.8), 8.5)
            荷重文字Fontsize = max((荷重文字サイズ * 0.8), 8.5)
            荷重寸法Fontsize = max((荷重文字サイズ * 0.8), 8.5)
            部材番号Fontsize = max((荷重文字サイズ * 0.6), 6)


            節点番号Fontsize = max((荷重文字サイズ * 0.6), 6)
            部材番号Fontsize = max((荷重文字サイズ * 0.6), 6)
        //
        sYscale = 1
        //
        }
        */


        //kit 2000/03/15
        //winFrameで用いるためのインターフェース
        //fname1に荷重図ファイル1（書式設定）、fname1に荷重図ファイル2（部材縮小率）のファイル名を渡す
        /* public void K荷重図INIT_Frame_23(ByRef fname1 As String, ByRef fname2 As String, Optional fKozo As Integer)
        //
        var MaxI                    As Integer
        var fNum                    As Integer
        var str                     As String
        var Pos                     As Integer
        var i                       As Long
        var j                       As Long
        double var RRR
        double var OT1
        double var OT2
        double var OT3
        double var OT4
        double var OT5
        double var OT6
        double var OT7
        double var OT8
        double var OT9
        double var OT10
        var TEMP1
        //    var NAME1
        //    var OF1
        //
        NAME1 = "plot2"
        OF1 = strTmpDir & "fmplot1.plt"
        strUN = ""
        FLG記号 = 1 //////////////FLG記号=0:記号なし
        if ( FLG記号 = 1 ) {
            if ( fMainForm.SICheck = True ) { //SI単位チェック
                strUN = "kN"
            } else {
                strUN = "tf"
            }
        }
        TEMP1 = DXFParameterString(1)
        if ( TEMP1 != "" ) { //////////////////////////////////////////////////////////////////////////////////// nagase
            DXFPRINTMODE = val(Mid(TEMP1, 4, Len(TEMP1) - 4 + 1))
            CreateDxfFlag = DXFPRINTMODE
            TEMP1 = DXFParameterString(2)
            DXFDIRECTORY = Mid(TEMP1, 4, Len(TEMP1) - 4 + 1)
            if ( Mid(DXFDIRECTORY, Len(DXFDIRECTORY), 1) != "\" ) {
               DXFDIRECTORY = DXFDIRECTORY & "\"
            }
            TEMP1 = DXFParameterString(3)
            DXFRETSU = Mid(TEMP1, 4, Len(TEMP1) - 4 + 1) //////////////////列数
            TEMP1 = DXFParameterString(4)
            DXFDANSUU = Mid(TEMP1, 4, Len(TEMP1) - 4 + 1)
            TEMP1 = DXFParameterString(5)
            DXFMODE = Mid(TEMP1, 4, Len(TEMP1) - 4 + 1)
            TEMP1 = DXFParameterString(6)
            CADFLAG1 = Mid(TEMP1, 4, Len(TEMP1) - 4 + 1)
            if ( DXFRETSU > 0 $$ DXFRETSU< 11 ) {
            } else {
                DXFRETSU = 1
            }
            if ( DXFDANSUU > 0 $$ DXFDANSUU < 11 ) {
            } else {
                DXFDANSUU = 1
            }
            if ( DXFDANSUU = 1 $$ DXFRETSU = 1 ) {
                DXFMODE = 0
            } else {
                if ( (DXFDANSUU = 2 $$ DXFRETSU = 1) Or(DXFDANSUU = 1 $$ DXFRETSU = 2) ) {
                   DXFMODE = 0
                } else {
                    DXFMODE = 1
                }
            }
            this.FlagParameterFILEXXX3(1, OT1, OT2, OT3, OT4, OT5, OT6, OT7, OT8, OT9, OT10, RRR)
            OndoHenkaHyoujiFlag = OT1
            OndoHenkaHyoujiYajirusiFlag = OT2
            NoBuzaiKajuuJuuhukuFlag = OT3
            if ( OndoHenkaHyoujiFlag = 1 ) {
                OndoHenkaHyoujiYajirusiFlag = 0
            }
        } ////////////////////////////////////////////////////////////////////////////////////////////////////// nagase


        this.FlagParameterFILEXXX2(1, OT1, OT2, OT3, OT4, OT5, OT6, OT7, OT8, OT9, OT10, RRR)
        SuiheiBaneEqual = OT1
        π = 3.141592
        Twip = 56.7 //csngLogic1mmByTwips

        iKozo = fKozo
        //////    iKozo = 1 //高架橋
        //////    iKozo = 2 //橋 脚
        //////    iKozo = 3 //カルバートボックス
        //////    iKozo = 4 //カルバートボックス
        g連続Mod = False
        if ( iKozo = 4 ) {
            g連続Mod = True ////////////////////連続梁  06/01/29
            iKozo = 3
        }
        if ( iKozo = 2 ) {
            FR橋脚 = 2
            RR橋脚 = 2
        } else {
            FR橋脚 = 1
            RR橋脚 = 1
        }
        gOut部材番号 = True
        // リスト以外のControlへのロード
        fNum = FreeFile
        if ( Dir(fname1) = "" ) {
            return;    //   *** return;
        }
        Open fname1 For( Input As #fNum
        Line Input #fNum, str
        if ( CInt(str) = 0 ) {
            Close
            return;    //   *** return;
        }
        // 作図ケース
        Line Input #fNum, str
        Pos = InStr(str, vbTab)
        str = Mid(str, Pos + 1)
        For( i = 0 To 0
            Pos = InStr(str, vbTab)
            //骨組図チェックのデータが存在しないときは自動的に０にする
            if ( Pos = 0 ) {
                荷重図フォーマット.int作図指定(0) = CInt(str)
                str = ""
            } else {
                荷重図フォーマット.int作図指定(0) = CInt(Left(str, Pos - 1))
            }
            str = Mid(str, Pos + 1)
        }
        // ペーパサイズ
        Line Input #fNum, str
        Pos = InStr(str, vbTab)
        str = Mid(str, Pos + 1)
        荷重図フォーマット.int用紙サイズ = CInt(str)
        DXFPaperSize = CInt(str)
        // 書式１
        Line Input #fNum, str
        Pos = InStr(str, vbTab)
        str = Mid(str, Pos + 1)
        荷重図フォーマット.int用紙方向 = CInt(str)
        // 書式２
        Line Input #fNum, str
        Pos = InStr(str, vbTab)
        str = Mid(str, Pos + 1)
        荷重図フォーマット.intレイアウト = CInt(Int(val(str))) + 1 //////////////09/11/30
        if ( 荷重図フォーマット.intレイアウト = 1 ) { ////////////////////////////////09/11/30
            シングルCASE = 0
        } else {
            シングルCASE = (val(str) - Int(val(str))) * 10 ////////// 05/03/25
        }

        // 骨組図
        // 軸線スケール
        Line Input #fNum, str
        Pos = InStr(str, vbTab)
        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        //自動ならcsngNullが入る
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
            荷重図フォーマット.sng骨組軸線スケール縦 = CSng(Left(str, Pos - 1))
        } else {
            荷重図フォーマット.sng骨組軸線スケール縦 = csngNull
        }
        if ( 荷重図フォーマット.sng骨組軸線スケール縦 = 0 ) {
            荷重図フォーマット.sng骨組軸線スケール縦 = csngNull
        }
        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
            荷重図フォーマット.sng骨組軸線スケール横 = CSng(Left(str, Pos - 1))
        } else {
            荷重図フォーマット.sng骨組軸線スケール横 = csngNull
        }
        if ( 荷重図フォーマット.sng骨組軸線スケール横 = 0 ) {
            荷重図フォーマット.sng骨組軸線スケール横 = csngNull
        }
        // 位置補正
        Line Input #fNum, str
        Pos = InStr(str, vbTab)
        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
            荷重図フォーマット.sng骨組位置補正X = CSng(Left(str, Pos - 1))
        } else {
            荷重図フォーマット.sng骨組位置補正X = csngNull
        }
        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
            荷重図フォーマット.sng骨組位置補正Y = CSng(Left(str, Pos - 1))
        } else {
            荷重図フォーマット.sng骨組位置補正Y = csngNull
        }
        //--------------------------------------------
        // 荷重図
        // 軸線スケール
        Line Input #fNum, str
        Pos = InStr(str, vbTab)
        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        //自動ならcsngNullが入る
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
            荷重図フォーマット.sng荷重軸線スケール縦 = CSng(Left(str, Pos - 1))
        } else {
            荷重図フォーマット.sng荷重軸線スケール縦 = csngNull
        }
        if ( 荷重図フォーマット.sng荷重軸線スケール縦 = 0 ) {
            荷重図フォーマット.sng荷重軸線スケール縦 = csngNull
        }
        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
            荷重図フォーマット.sng荷重軸線スケール横 = CSng(Left(str, Pos - 1))
        } else {
            荷重図フォーマット.sng荷重軸線スケール横 = csngNull
        }
        if ( 荷重図フォーマット.sng荷重軸線スケール横 = 0 ) {
            荷重図フォーマット.sng荷重軸線スケール横 = csngNull
        }
        // 位置補正
        Line Input #fNum, str
        Pos = InStr(str, vbTab)
        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
            荷重図フォーマット.sng荷重位置補正X = CSng(Left(str, Pos - 1))
        } else {
            荷重図フォーマット.sng荷重位置補正X = csngNull
        }
        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
            荷重図フォーマット.sng荷重位置補正Y = CSng(Left(str, Pos - 1))
        } else {
            荷重図フォーマット.sng荷重位置補正Y = csngNull
        }
        // sng荷重スケール
        Line Input #fNum, str
        Pos = InStr(str, vbTab)
        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
            荷重図フォーマット.sng荷重スケール分布荷重 = CSng(Left(str, Pos - 1))
        } else {
            荷重図フォーマット.sng荷重スケール分布荷重 = csngNull
        }
        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
            荷重図フォーマット.sng荷重スケール集中荷重 = CSng(Left(str, Pos - 1))
        } else {
            荷重図フォーマット.sng荷重スケール集中荷重 = csngNull
        }
        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
            荷重図フォーマット.sng荷重スケールモーメント半径 = CSng(Left(str, Pos - 1))
        } else {
            荷重図フォーマット.sng荷重スケールモーメント半径 = csngNull
        }
        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
            荷重図フォーマット.sng荷重スケール節点荷重 = CSng(Left(str, Pos - 1))
        } else {
            荷重図フォーマット.sng荷重スケール節点荷重 = csngNull
        }
        str = Mid(str, Pos + 1)
        Pos = InStr(str, vbTab)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
            荷重図フォーマット.sng荷重スケール節点モーメント = CSng(Left(str, Pos - 1))
        } else {
            荷重図フォーマット.sng荷重スケール節点モーメント = csngNull
        }
        Line Input #fNum, str
        Pos = InStr(str, vbTab)
        str = Mid(str, Pos + 2)
        if ( IsNumeric(Left(str, Pos - 1)) = True ) {
            荷重文字サイズ = CSng(str) * Twip / 15 //csngMmToPoint
            if ( 荷重文字サイズ = 0 ) {
                荷重文字サイズ = 9 //////////////14/11/177
            }
        } else {
            荷重文字サイズ = 9
        }
        Line Input #fNum, str
        Pos = InStr(str, vbTab)
        str = Mid(str, Pos + 1)
        荷重図フォーマット.int文字フォント = CInt(str)
        //
        Close
        // リストへのロード(%の部分のみ）
        fNum = FreeFile
        if ( Dir(fname2) = "" ) {
            return;
        }
        Open fname2 For( Input As #fNum
        Line Input #fNum, str
        lng部材数 = CLng(str)
        this.BuzaiBai(lng部材数 + 1)
        this.ZZBuzaiBai(lng部材数 + 1)
        this.WWBuzaiBai(lng部材数 + 1)
        this.GGBuzaiBai(lng部材数 + 1) ////////////08/06/24
        this.部材縮小率(lng部材数)
        this.一期施工Flag(lng部材数 + 1)
        MaxI = 0
        if ( lng部材数 > 0 ) {
            For( i = 0 To lng部材数 - 1
                Line Input #fNum, str
                For( j = 0 To 4
                    Pos = InStr(str, vbTab)
                    Select Case j
                    Case 0
                        部材縮小率(i).intIdx = val(Left(str, Pos - 1))
                    Case 1
                        部材縮小率(i).int部材番号 = val(Left(str, Pos - 1))
                    Case 2
                        部材縮小率(i).str部材名 = Left(str, Pos - 1)
                    Case 3
                        部材縮小率(i).int骨組縮小率 = val(Left(str, Pos - 1))
                    Case 4
                        部材縮小率(i).int荷重縮小率 = val(Left(str, Pos - 1))
        //                    ZZBuzaiBai(i + 1) = val(Left(str, pos - 1)) / 100
                        BuzaiBai(i + 1) = 1
                        MaxI = MaxI + 1
                        if ( 部材縮小率(i).int荷重縮小率 > 10 And(部材縮小率(i).int荷重縮小率 - _
                                            Int(部材縮小率(i).int荷重縮小率 / 10) * 10) = 1 ) {
                            一期施工Flag(i + 1) = 1 //////09/03/13
                            部材縮小率(i).int荷重縮小率 = Int(部材縮小率(i).int荷重縮小率 / 10) * 10
                        } else {
                            一期施工Flag(i + 1) = 0
                        }


                    End Select
                    str = Mid(str, Pos + 1)
                }
            }
        }
        Close
        For( i = 1 To MaxI
            if ( MaxI!= 1 ) {
                PointChangeFlag = 1
                Exit For
            }
        }
        //表示色 = ""
        FOLU = gstrFrmDir
        Select Case 荷重図フォーマット.int用紙サイズ //   0-A4 1-A3 2-B4 3-B5
        Case 0 //0-A4
            A4Flag = 1
            A3FLAG = 0
            Select Case 荷重図フォーマット.int用紙方向
            Case 1 //横
                左開き = 10
                上開き = 18   //mm
                枠横幅 = 260
                枠縦幅 = 176  //mm
                図横幅 = 190
                図縦幅 = 110  //mm
            Case } else { //縦
                左開き = 18
                上開き = 18 //18   //mm
                枠横幅 = 176
                枠縦幅 = 260  //mm
                図横幅 = 120
                図縦幅 = 160  //mm
            End Select
        Case 1 //0-A3
            A4Flag = 0
            A3FLAG = 1
            Select Case 荷重図フォーマット.int用紙方向
            Case 1 //横
                左開き = 23
                上開き = 23   //mm
                枠横幅 = Round(265 * Sqr(2), 0)
                枠縦幅 = Round(178 * Sqr(2), 0) //mm
                図横幅 = Round(224 * Sqr(2), 0)
                図縦幅 = Round(110 * Sqr(2), 0) //mm
            Case } else { //縦
                左開き = 24
                上開き = 23   //mm
                枠横幅 = Round(176 * Sqr(2), 0)
                枠縦幅 = Round(265 * Sqr(2), 0) //mm
                図横幅 = Round(120 * Sqr(2), 0)
                図縦幅 = Round(180 * Sqr(2), 0) //mm
            End Select
        End Select
        //    Select Case 表示色
        //    Case "黒"
            枠Pen色 = 0
            部材Pen色 = 0
            節点荷重Pen色 = 0
            部材荷重Pen色 = 0
            部材荷重寸法Pen色 = 0
            節点Pen色 = 0
        //    Case } else {
        //        枠Pen色 = 0           //黒
        //        部材Pen色 = 12        //明るい赤
        //        節点荷重Pen色 = 3     //ｼｱﾝ
        //        部材荷重Pen色 = 1     //青
        //        部材荷重寸法Pen色 = 1 //青
        //        節点Pen色 = 0         //黒
        //    End Select
        //------------------------------------------------------------------------------
        枠Pen幅 = 20
        //------------------------------------------------------------------------------
        節点番号Fontsize = 6      // ﾎﾟｲﾝﾄ
        //------------------------------------------------------------------------------
        部材番号Fontsize = 6
        部材Pen幅 = 20
        Pen幅 = 6 //軸方向分布荷重
        //------------------------------------------------------------------------------
        // 節点荷重
        //------------------------------------------------------------------------------
        節点荷重Pen幅 = 16
        節点荷重Scale = Twip / 4 //3 //5  //節点荷重Scale  Twip/n   n が大きくなると図が小さくなる
        節点荷重角度 = 10         //部材が有る場合の節点荷重角度  ﾄﾞ
        節点荷重初期値 = 8        //節点荷重図大きさの初期値  mm             = csngNull
        if ( 荷重図フォーマット.sng荷重スケール節点荷重<csngNull ) {
            節点荷重長さmax = 荷重図フォーマット.sng荷重スケール節点荷重
        } else {
            節点荷重長さmax = 12        //節点荷重図化最大長さ  mm
        }
        if ( 荷重図フォーマット.sng荷重スケール節点モーメント<csngNull ) {
            節点M荷重長さmax = 荷重図フォーマット.sng荷重スケール節点モーメント
        } else {
            if ( FR橋脚 = 1 ) {
                節点M荷重長さmax = 4.2 - 0.4 ////////07/01/078    //節点M荷重図化最大長さ  mm
            } else {
                節点M荷重長さmax = 4.2
            }
        }
        //------------------------------------------------------------------------------
        // 部材荷重
        //------------------------------------------------------------------------------
        部材荷重Pen幅 = 12
        部材荷重矢Pen幅 = 2
        部材荷重寸法Pen幅 = 8 //////09/09/16
        //    荷重図上盛上げ初期値 = 1.2 //mm
        if ( gbolBuZai = 0 ) {
            荷重図上盛上げ初期値 = 1.2 * 2 //mm  08/02/04
        } else {
            荷重図上盛上げ初期値 = 1.5 //mm
        }
        荷重図下盛上げ初期値 = 2.4   //3mm  08/02/04
        荷重図盛上げpit(1) = 20 //18 部材荷重     //mm
        荷重図盛上げpit(2) = 17 //16 //集中荷重
        荷重寸法線位置(1) = 荷重図盛上げpit(1) - 5   //mm
        荷重寸法線位置(2) = 荷重図盛上げpit(2) - 5   //mm
        荷重寸法補助線 = 3.5 //5                     //mm
        部材荷重矢長さmin = 0.8               //mm
        部材荷重Scale = Twip / 7 //5              //部材荷重Scale Twip/n n が大きくなると図が小さくなる
        集中荷重Scale = Twip / 7 //5              //部材荷重Scale Twip/n n が大きくなると図が小さくなる
        部材荷重初期値 = 3                    //部材荷重図大きさの初期値  mm
        集中荷重初期値 = 6                    //部材荷重図大きさの初期値  mm
        if ( FR橋脚 = 2 ) {
            荷重図盛上げpit(1) = 22 - 2 //////////////06/02/22
            荷重図盛上げpit(2) = 18
            荷重寸法線位置(1) = 荷重図盛上げpit(1) - 8 //  mm
            荷重寸法線位置(2) = 荷重図盛上げpit(2) - 6.5 //mm
            荷重文字サイズ = 9
        }
        if ( 荷重図フォーマット.sng荷重スケール分布荷重<csngNull ) {
            部材荷重長さmax = 荷重図フォーマット.sng荷重スケール分布荷重
        } else {
            部材荷重長さmax = 荷重寸法線位置(2) - 8 //6  //部材荷重図化最大長さ mm 10/10
        }
        if ( 荷重図フォーマット.sng荷重スケール集中荷重<csngNull ) {
            集中荷重長さmax = 荷重図フォーマット.sng荷重スケール集中荷重
        } else {
            集中荷重長さmax = 荷重寸法線位置(1) + 15 //5 //2  //集中荷重図化最大長さ  mm
        }
        if ( 荷重図フォーマット.sng荷重スケールモーメント半径<csngNull ) {
            部材M荷重長さmax = 荷重図フォーマット.sng荷重スケールモーメント半径
        } else {
            if ( FR橋脚 = 1 ) {
                部材M荷重長さmax = 4 - 0.4 //4.6   //部材M荷重図化最大長さ mm
            } else {
                部材M荷重長さmax = 4
            }
        }
        固定部材M荷重長さ = 5 - 0.4 ////////07/01/078                //固定部材M荷重図化長さ  mm
        固定部材PURE1荷重長さ = 5             //固定部材ﾌﾟﾚｽﾄﾚｽﾄ1荷重図化長さ  mm
        固定部材PURE2荷重長さ = 5             //固定部材ﾌﾟﾚｽﾄﾚｽﾄ1荷重図化長さ  mm
        //------------------------------------------------------------------------------
        荷重文字Fontsize = 8
        荷重文字pit = 2.5           //mm
        Select Case 荷重TEXT位置
        Case "左"
            荷重座標X = 25          //mm
        Case "右"
            荷重座標X = 140         //mm
        Case } else {
            荷重座標X = 0
        End Select
        荷重座標Y初期値 = 30        //mm
        //    if ( FR橋脚 = 1 ) {
        //        節点荷重Fontsize = 8 //7//////09/11/06
        //        部材荷重Fontsize = 8 //7
        //        荷重文字Fontsize = 8 //7
        //        荷重寸法Fontsize = 8 //7
        //    } else { //                    FR橋脚 = 2
        //        節点荷重Fontsize = max(荷重文字サイズ, 8.5) //8//////09/11/06
        //        部材荷重Fontsize = 8.5 //8
        //        荷重文字Fontsize = max(荷重文字サイズ, 8.5) //8
        //        荷重寸法Fontsize = 8
        //    }
        //
            節点荷重Fontsize = max((荷重文字サイズ * 0.8), 8.5) //////14/11/177
            部材荷重Fontsize = max((荷重文字サイズ * 0.8), 8.5)
            荷重文字Fontsize = max((荷重文字サイズ * 0.8), 8.5)
            荷重寸法Fontsize = max((荷重文字サイズ * 0.8), 8.5)


            節点番号Fontsize = max((荷重文字サイズ * 0.6), 6)
            部材番号Fontsize = max((荷重文字サイズ * 0.6), 6)
        //
        sYscale = 1
        mHONE = 0
        //
        }
        */

        public void K荷重図_23(int CASN, bool bTitle, int Ft_Flg)
        { ////////, Optional g初期 As Integer = 0) //KAJYUU_ZU2

            /*
             double var F7R
             //    var NAME1
             //    var OF1
             var filename
             var y1 As vsFlexArray
             double var Y2
             double var Y3
             //
             double Const A3XIdou               = 40
             double Const A3YIdou               = 30
             //
             FLG車両ZU = False
             if ( CASN > 0 ) {
                 NUM車両ZU = CASN
                 FLG車両ZU = True
                 CASN = 0
             }
             NAME1 = "plot2"
             OF1 = strTmpDir & "fmplot1.plt"
             SuiheiBBFlag = 0
             if ( CreateDxfFlag = 1 $$ CASN< 0 ) { mHONE = -1 //////////////////////08/03/05
             if ( CreateDxfFlag = 1 ) { ////////And g初期 = 0 ) { ////////And CASN < 0 ) {
                 this.DXFInit
                 frmPrint.Text1.Text = "骨組図のＤＸＦファイル作成中"
             //        this.PLOT00(1, NAME1, OF1)
             //    }
             //    if ( CreateDxfFlag = 1 ) { //////And CASN >= 0 ) {
                 this.PLOT00(1, NAME1, OF1)
             }
             //    if ( CASN < 0 ) {
             //        NoErrorFlag1 = 0
             //    } else {
                 ////////////////////////////////////////////////////////////////////06/03/07
                 Y2 = 200
                 filename = QNAME222(Y2)
                 this.EXX(Y3)        ////////////////////杭データの層厚の数
                 if ( Y3 = 0 ) { //////Or 部材_max < 3 ) { //////////06/05/24 08/11/29
                     M杭mod = False
                 } else {
                     M杭mod = True
                 }
                 ////////////////////////////////////////////////////////////////////06/03/07
             //    }
             if ( CASN< 0 ) {
                 NoErrorFlag1 = 0
             }
             if ( NoErrorFlag1 = 1 ) {
                 return;
             }
             if ( AskSettenData() = 0 ) {
                 NoErrorFlag1 = 1
                 MsgBox "格点データが入力されていません"
                 return;
             } else {
                 if ( AskBuzaiData() = 0 ) {
                     NoErrorFlag1 = 1
                     MsgBox "部材データが入力されていません"
                     return;
                 }
             }
             //
             寸法左右(1) = 0: 寸法左右(2) = 0
             //
             OutouCase1 = 0
             OutouCase2 = 0
             OutouCase3 = 0
             OutouCase4 = 0
             OutouCase5 = 0
             OutouCase6 = 0
             OutouCase7 = 0
             OutouCase8 = 0
             SunPouMojiSize1 = 6
             SunPouMojiSize2 = 6
             SunPouMojiSize3 = 6
             if ( GibanHeniX1 = 1 ) {     // 応答変位量の印字のみ
                 SunPouStartX1 = -25 * OuTouBai
                 SunPouStartX2 = -20 * OuTouBai
                 SunPouStartX3 = -15 * OuTouBai
                 MaxKuiOuTou = 50 * 56.7  // 杭の応答変位図時の最大値を５０mmで書く
             } else {
                 SunPouStartX1 = -16 * OuTouBai
                 SunPouStartX2 = -11 * OuTouBai
                 SunPouStartX3 = -6 * OuTouBai
                 MaxKuiOuTou = 35 * 56.7  // 杭の応答変位図時の最大値を５０mmで書く
             }
             SunPouPenWidth = 10
             YajirushiSize = 4 * OuTouBai
             Select Case OutouHeniSuuchiX1
             Case 1
                 SouatrsuValuePrint = 0
             Case 2
                 SouatrsuValuePrint = 1
             Case } else {
                 SouatrsuValuePrint = 0
             End Select
             Select Case OutouHeniSuuchiX2
             Case 1
                 SouatrsuValuePrintA = 0
             Case 2
                 SouatrsuValuePrintA = 1
             Case 3
                 SouatrsuValuePrintA = 2
             Case } else {
                 SouatrsuValuePrintA = 2
             End Select
             if ( GibanHeniX1 = 1 ) {     // 応答変位量の印字のみ
                 if ( A3FLAG = 0 ) {
                     OutouStartX = 90 * OuTouBai
                     OutouStartY = 60 * OuTouBai
                 } else {
                     OutouStartX = (A3XIdou + 90) * OuTouBai
                     OutouStartY = (A3YIdou + 60) * OuTouBai
                 }
             } else {
                 if ( A3FLAG = 0 ) {
                     OutouStartX1 = 40 * OuTouBai
                     OutouStartX2 = 90 * OuTouBai
                     OutouStartX = 140 * OuTouBai
                     OutouStartY = 60 * OuTouBai
                 } else {
                     OutouStartX1 = (A3XIdou + 40) * OuTouBai
                     OutouStartX2 = (A3XIdou + 90) * OuTouBai
                     OutouStartX = (A3XIdou + 140) * OuTouBai
                     OutouStartY = (A3YIdou + 60) * OuTouBai
                 }
             }
             var FLG_555 As Integer, M As Integer, i As Integer
                         this.READ_XY //////////////////////////////////////07/04/09
             //===========================================10/01/30
             if ( 座標Y調整!= 0 ) { //////////////10/01/30
                 FLG_555 = 0
                 For( M = 部材_max To 1 Step -1
                     if ( InStr(部材名(M), "杭") != 0 ) {
                         FLG_555 = 1
                         Exit For
                     }
                 Next M
                 if ( FLG_555 = 0 ) {
                     For( i = 1 To Jn_max
                         節Y(i) = Round(節Y(i) + 座標Y調整, 3)
                         節Y0(i) = Round(節Y0(i) + 座標Y調整, 3)
                     }
                 } else {
                     座標Y調整 = 0
                 }
             }
             //===========================================10/01/30
                         this.READ_BUZ(CASN, bTitle)
                         this.部材DATA整理
             EqualKui = 0
             AttaG = 0
             Atta寸法 = 0
             //    if ( gouikidddd = 1 ) { //////////////////////////////////////////////////////////////////////////// 05/05/21
             this.SETBuzaiDtataInGouikiData(1, CASN) //////// AttaG = 1が得られる
             //    }
             this.Reset_KajuuZu
             if ( k杭数 > 0 ) { //////////09/09/29
             if ( gouikidddd = 1 $$ AttaG = 1 ) { //////////////////////// 05/05/21
                 this.RESET_OUTOU_Gouiki
             } else {
                 this.RESET_OUTOU_Normal
             }
             }
             ////////////////////////////////////////
             Foot_Flg = Ft_Flg
            */

            this.READ_XY(); //////////////////////////////////////////07/04/09 コメントにした 07/09/03 やめた

            /*
             //===========================================10/01/30
             if ( 座標Y調整!= 0 ) { //////////////10/01/30
                 FLG_555 = 0
                 For( M = 部材_max To 1 Step -1
                     if ( InStr(部材名(M), "杭") != 0 ) {
                         FLG_555 = 1
                         Exit For
                     }
                 Next M
                 if ( FLG_555 = 0 ) {
                     For( i = 1 To Jn_max
                         節Y(i) = Round(節Y(i) + 座標Y調整, 3)
                         節Y0(i) = Round(節Y0(i) + 座標Y調整, 3)
                     }
                 } else {
                     座標Y調整 = 0
                 }
             }
             //===========================================10/01/30
            */


            this.READ_BUZ(CASN, bTitle);
            this.部材DATA整理();

            // F7R = 0
            // this.RESET_07

            // this.FRUD06_BBB(F7MAX_R, F7ML1(), F7ML2(), F7ML3(), F7ML(), F7ML31(), F7ML4(), F7ML5(), F7ML6(), F7R);

            /*
             this.ReadData147
             if ( CASN >= 0 ) { //////And NKUI > 0 ) { //////05/05/23//////08/08/31
             if ( k杭数 > 0 ) { //////////09/09/29
                 if ( gouikidddd = 1 $$ AttaG = 1 ) {
             //            this.SETBuzaiDtataInGouikiData ////////////06/04/05
                     this.KuiDataSet_G
                 } else {
                     this.KuiDataSet_N
                 }
             }
             }
             this.RESET_07_1
             if ( FR橋脚 = 2 $$ CASN = 0 ) {
                 CASN = 9999
             }
             if ( CASN >= 0 ) {
                 this.READ_Kajyu
                 this.変換_K_Jitubuzai
             } else {
                 垂直左右 = 0 //////////////////////////04
             }
             垂直寸法位置補正(1) = 0: 垂直寸法位置補正(2) = 0 //////////// 05/01/29
             if ( CASN< 0 ) {
                 FLG_Ugata = False
             }
             //
             //
             //    var Jw As Integer, M As Integer, i As Integer
             this.wRR(Jn_max) ////////08/06/24
             this.w節RR(Jn_max) ////////////////////////08/08/21
                this.s連行前(荷重case_max, 2, 2)
                this.s連行後(荷重case_max, 2, 2)
            */

            this.A作図開始(CASN, bTitle);

            /*
                     //
             if ( gouikidddd = 1 $$ AttaG = 1 ) {
                 this.RESET_OUTOU_Gouiki
             } else {
                 this.RESET_OUTOU_Normal
             }
             this.RESET_07
             this.RESET_07_2
             if ( CreateDxfFlag = 1 ) { //////////And CASN >= 0 ) { ////////////08/02/05
                 this.PLOT00(2, NAME1, OF1)
                 frmPrint.Text1.Text = ""
             }
             if ( CreateDxfFlag = 1 ) { ////////And CASN >= 0 ) { ////////////08/02/05
                 frmPrint.Text1.Text = "DXFファイルマージ処理"
                 this.FMFILEEND
                 frmPrint.Text1.Text = ""
             }
             //
            */
        }

        /* private string Repeat(string STRF, int Param){
            //
            var temp                    As String
            var KANAZ                   As Integer
            //
            var temp = "";
            if ( Param > 0 ) {
                For( KANAZ = 1 To Param
                    temp = temp & STRF
                }ANAZ
            }
            Repeat = temp
            //
        }

        private Function CON_Y(GG As Double)
        //
        CON_Y = GG* OuTouBai * 0.4
        //
        }

        private Function CON_X(GG As Double)
        //
        CON_X = GG* OuTouBai * 0.35
        //
        }

        private Function CON_X1(GG As Double)
        //
        CON_X1 = GG* OuTouBai * 0.35
        //
        }

        private Function CON_X2(GG As Double)
        //
        CON_X2 = GG* OuTouBai * 0.35
        //
        }

        public void SETBuzaiDtata()
        //
        double var i
        //
        For( i = 1 To 部材_max
            if ( ZZBuzaiBai(i) != 0 ) {
            XXXX1(i) = 節X(部I(i))
            YYYY1(i) = 節Y(部I(i))
            XXXX2(i) = 節X(部J(i))
            YYYY2(i) = 節Y(部J(i))
            }
        }
        //
        }
        */

        //節点データを読み込む
        public void READ_XY()
        {

            /*/
            var XS(50)
            var X(50)                   As Single
            var FN1
            var D
            var DA
            var er1
            var i                       As Integer
            var N                       As Integer
            var fno                     As Integer
            double var R
            double var MAX_R
            var Y51 As Single, Y52 As Single //////////////////10/01/24
            //
            fno = FreeFile
            FN1 = FOLU & "1.txt"
            Open FN1 For( Input As #fno
            Input #fno, D
            Jn_max = val(D)
            this.節X(Jn_max)
            this.節Y(Jn_max)
            this.節X0(Jn_max)
            this.節Y0(Jn_max)
            this.節点部材数(Jn_max) //Revarによって中身を初期化する。Jn_max 部材_max
            this.HighYyy(Jn_max)
            this.HighXxx(Jn_max)
            For( i = 1 To Jn_max
                HighXxx(i) = -9999
                HighYyy(i) = -9999
            }
            HighZMax = -9999: Y51 = -9999 //////10/01/24
            HighZMin = 9999: Y52 = 9999 //////////10/01/24
            //    X222 = 9999
            座標Y調整 = 0 //////////10/01/24
            For( i = 1 To Jn_max
            //        Input #fno, DA
                Line Input #fno, DA ////////// 04/10/18
                this.D_data(Chr(9), DA, XS(), X(), N, er1)
                節X(i) = X(2)
                節Y(i) = X(3)
                HighXxx(i) = X(2)
                if ( HighZMax < X(2) ) {
                    HighZMax = X(2)
                }
                if ( HighZMin > X(2) ) {
                    HighZMin = X(2)
                }
                HighYyy(i) = X(3)
                節X0(i) = X(2)
                節Y0(i) = X(3)
                if ( Y51 < X(3) ) { //////10/01/24
                    Y51 = X(3)
                }
                if ( Y52 > X(3) ) { //////10/01/24
                    Y52 = X(3)
                }
            //        if ( X222 > X(2) ) {
            //            X222 = X(2)
            //        }
            }
            if ( Y51 <= 0 $$ Y52 <= 0 ) { //////////10/01/24//////10/01/30
            //        座標Y調整 = -Y52 / 1.5 //////2 //////////10/01/24
                For( i = 1 To Jn_max
                    節Y(i) = 節Y(i) - Y52
                    節Y0(i) = 節Y0(i) - Y52
                }
            }
            //    if ( X222 > 10 $$ (HighZMax - HighZMin) > 30 ) {
            //        For( I = 1 To Jn_max
            //            節X0(I) = 節X0(I) - X222
            //        }
            //        HighZMin = HighZMin - X222
            //        HighZMax = HighZMax - X222
            //    }
            HighZMin = Round(HighZMin, 3)
            HighZMax = Round(HighZMax, 3)
            Close #fno
            this.ShitenRead
            this.FRUD06DF(MAX_R, CaseShiten(), R)
            this.ShitenFD(Jn_max)
            this.Shiten固定(Jn_max)
            ShiMax = Jn_max
            //
            }

            private void ShitenRead()
            //
            double var i
            double var j
            double var MAX_R
            double var BI()
            double var TX()
            double var TY()
            double var TZ()
            double var R
            double var Atta
            //
            this.ShitenRR(MAX_R, BI(), TX(), TY(), TZ(), R)
            //    this.ShitenMN(Jn_max)
            this.ShitenTX(Jn_max, 16)
            this.ShitenTY(Jn_max, 16)
            this.ShitenTZ(Jn_max, 16)
            For( i = 1 To Jn_max
            //        ShitenMN(i) = 0
                For( j = 1 To 16
                    ShitenTX(i, j) = -9000000000#
                    ShitenTY(i, j) = -9000000000#
                    ShitenTZ(i, j) = -9000000000#
                }
            }
            if ( MAX_R = 0 ) {
                return;
            }
            For( i = 1 To Jn_max
                Atta = 0
                For( j = 1 To MAX_R
                    if ( BI(j) = i ) {
                        Atta = j
                        Exit For
                    }
                }
                if ( Atta > 0 ) {
                    For( j = 1 To 16
                        ShitenTX(i, j) = TX(Atta, j)
                        ShitenTY(i, j) = TY(Atta, j)
                        ShitenTZ(i, j) = TZ(Atta, j)
                    }
                }
            }
            */
        }


        /* private void FRUD06DF(MAX_R As Double, ML31() As Double, R)
        //
        double var D
        var filename
        double var ML1()
        var ML2()
        var ML3()
        var ML()
        double var ML4()
        double var ML5()
        double var ML6()
        var fno                     As Integer
        double var MX
        double var i
        var TEMPXXX
        //
        D = 6
        R = 0
        filename = FOLU & "Kajyu.txt"
        On Error GoTo NG1
            fno = FreeFile
            Open filename For( Input As fno
            Input #fno, MX
            MAX_R = MX
            this.ML1(MX)
            this.ML2(MX)
            this.ML3(MX)
            this.ML(MX)
            this.ML4(MX)
            this.ML5(MX)
            this.ML6(MX)
            this.ML31(MX)
            For( i = 1 To MAX_R
                Line Input #fno, TEMPXXX
                this.GetNumF(TEMPXXX, ML1(i))
                this.GetStrF(TEMPXXX, ML2(i))
                this.GetStrF(TEMPXXX, ML3(i))
                this.GetStrF(TEMPXXX, ML(i))
                this.GetNumF(TEMPXXX, ML31(i))
                this.GetNumF(TEMPXXX, ML4(i))
                this.GetNumF(TEMPXXX, ML5(i))
                this.GetNumF(TEMPXXX, ML6(i))
            }
            R = 1
            Close fno
            return;
        NG1:
        Close fno
        //
        }
        */

        // 部材データを読み込む
        public void READ_BUZ(int CASN, bool bTitle)
        {

            /*/
            var Setsugou(4)             As Integer
            var XS(50)
            var X(50)                   As Single
            var FN1
            var D
            var DA
            var er1
            var i                       As Integer
            var j                       As Integer
            var N                       As Integer
            var M                       As Integer
            var i1                      As Integer
            var I2                      As Integer
            var LLL
            var X1
            var y1
            var X2
            var Y2
            var X3
            var Y3
            var ii                      As Integer
            var LX
            var LY
            var LL
            var Xmax
            var Xmin
            var Ymax
            var Ymin
            var ZMAX
            var ZMIN
            var LX0                     As Single
            var h
            var YEAKI                   As Single
            var UEAKI                   As Single
            var fno                     As Integer
            var JJ()                    As Integer
            var JM()                    As Integer
            var LX1                     As Single
            var LX2                     As Single
            var LY1                     As Single
            var LY2                     As Single
            var TH1                     As Single
            var TH2                     As Single
            var KOBI                    As Single
            var GRP                     As Integer
            var Y11                     As Single
            var Y12                     As Single
            var Y13                     As Single
            var SSS                     As Integer
            double var Atta
            double var J_MaxB1
            double var J_MinB1
            double var J_MAXB
            double var J_MINB
            double var SSSX()
            double var SSSY()
            double var SSSMaX
            double var HaJiMeX
            double var HaJiMeY
            double var JOUHOUH()
            double var KAHOUH()
            double var III1
            double var III2
            double var Check1()
            double var Check2()
            double var FDFD
            double var ZZX1
            double var ZZX2
            double var ZZY1
            double var ZZY2
            double //    var LLLLL()
            var Check121()              As Integer
            var GCounter                As Integer
            var ACounter                As Integer
            var MCounter                As Integer
            var MaeBuzai()              As Integer
            var AtoBuzai()              As Integer
            var Hajime11                As Integer
            var Atta11                  As Integer
            var EndFlag                 As Integer
            var JJ1                     As Integer
            var JJ2                     As Integer
            var KuiFD(1000)             As Integer
            var KuiFD1(1000)            As Integer
            var KanazMax                As Integer
            var VxCount                 As Integer
            var Vxvar()                 As Integer
            var AngleDF()               As Integer
            var str5Num   As String
            var K水平部材高 As Single ////////08/11/17
            K水平部材高 = -9999
            //
            階段Mod = False //////13/04/08
            アーチBOX = False //////10/03/27
            横スケール = 0: 縦スケール = 0
            if ( CASN < 0 ) {
                if ( 荷重図フォーマット.sng骨組軸線スケール横 < csngNull ) { 横スケール = 荷重図フォーマット.sng骨組軸線スケール横 / 1000
                if ( 荷重図フォーマット.sng骨組軸線スケール縦 < csngNull ) { 縦スケール = 荷重図フォーマット.sng骨組軸線スケール縦 / 1000
            } else {
                if ( 荷重図フォーマット.sng荷重軸線スケール横 < csngNull ) { 横スケール = 荷重図フォーマット.sng荷重軸線スケール横 / 1000
                if ( 荷重図フォーマット.sng荷重軸線スケール縦 < csngNull ) { 縦スケール = 荷重図フォーマット.sng荷重軸線スケール縦 / 1000
            }
            //
            For( i = 1 To 1000
                NoJtan(i) = 0
                FBuzaiI(i) = -9000000000#
                FBuzaiJ(i) = -9000000000#
            //        FShitenX(i) = -9000000000#
            //        FShitenY(i) = -9000000000#
                FAngle(i) = -9000000000#
                ZFAngle(i) = -9000000000#
            }
            this.UseSettenNumber(Jn_max)
            For( i = 1 To Jn_max
            //        FShitenX(i) = 節X(i1)
            //        FShitenY(i) = 節Y(i1)
                UseSettenNumber(i) = 0
            }
            fno = FreeFile
            FN1 = FOLU & "Buzai.txt"
            Open FN1 For( Input As #fno
            Input #fno, D
            部材_max = val(D)
            this.JJ(Jn_max, 部材_max)
            this.JM(Jn_max, 部材_max)
            this.部材名(部材_max)
            this.部I(部材_max)
            this.部J(部材_max)
            this.数部材(部材_max)
            this.部材方向(部材_max)
            this.部材GRP(部材_max)
            this.LLLLL(部材_max)
            this.PointKuiFlag(部材_max)
            this.斜比(部材_max, 2) //////////////////////07/12/31
            GRP = 0
            this.SuiheiI(部材_max)
            this.SUIHEIJ(部材_max)
            SuiheiMax = 0
            this.SuityokuI(部材_max)
            this.SuityokuJ(部材_max)
            SuityokuMax = 0
            this.KaSouFlag(部材_max)
            this.SuiHeiIIX(部材_max)
            this.SuiHeiJJX(部材_max)
            this.SuiHeiAngX(部材_max)
            SuiHeiCountX = 部材_max
            this.AngleDF(部材_max)
            this.AngleDF1[部材_max]
            this.上層Buzai(部材_max) //////////////05/02/07
            this.下層BUZAI(部材_max, 3) ////////08/11/06
            this.上層斜めBuzaiV(部材_max) //////14/12/13
            this.g柱X座標(部材_max, 3) ////////08/11/06////////09/10/29
            //
            this.m左側壁Grp(部材_max)
            this.m右側壁Grp(部材_max)

            var KUI数 As Integer: KUI数 = 0
            var y最低 As Single: y最低 = 99999
            ////////////////////////////
            y最低CUNT = 0

            var Naname As Single, LL_Naname As Single, LL_Naname2 As Single //////13/04/08
            Naname = 0: LL_Naname = 0: LL_Naname2 = 0

            For( M = 1 To 部材_max
            //        Input #fno, DA
                Line Input #fno, DA ////////// 04/10/18
                this.D_data(Chr(9), DA, XS(), X(), N, er1)
                部I(M) = X(2)
                部J(M) = X(3)
                KuiFD1(X(2)) = KuiFD1(X(2)) + 1
                KuiFD1(X(3)) = KuiFD1(X(3)) + 1
                FBuzaiI(M) = X(2)
                FBuzaiJ(M) = X(3)
                if ( Mid(Trim(XS(5)), 1, 1) = "杭" ) {
                    if ( Len(Trim(XS(5))) > 1 ) {
                        str5Num = Mid(Trim(XS(5)), 2, Len(Trim(XS(5))))
                        if ( 杭SVal(str5Num) = 0 ) {
                            XS(5) = str5Num
                        }
                    }
                    KUI数 = KUI数 + 1 //////14/09/10
                }
                部材名(M) = XS(5)
            //        if ( Mid(Trim(XS(5)), 1, 2) != "仮想" ) {
                if ( InStr(XS(5), "仮想") != 0 ) { //////////08/09/22
                    KaSouFlag(M) = 0.1
                } else {
                    KaSouFlag(M) = 0 //////////08/09/22
                }
            //        if ( Mid(Trim(XS(5)), 1, 1) != "杭" || Not M杭mod ) {
                if ( InStr(XS(5), "杭") = 1 || Not M杭mod ) { //////////08/09/22
                    PointKuiFlag(M) = 0
                } else {
                    KuiFD(M) = 1
                    PointKuiFlag(M) = 1
                }
                数部材(M) = IIf(X(6) = 0, 1, X(6))
                //
                ZZX2 = 節X(部J(M))
                ZZX1 = 節X(部I(M))
                ZZY2 = 節Y(部J(M))
                ZZY1 = 節Y(部I(M))
                下層BUZAI(M, 1) = 0 //////08/11/06
                下層BUZAI(M, 2) = 0
                下層BUZAI(M, 3) = 0
                if ( ZZX1 != ZZX2 ) {
                    if ( y最低 > ZZY1 ) { y最低 = ZZY1 //////08/11/06
                    if ( y最低 > ZZY2 ) { y最低 = ZZY2
                }
                LLLLL(M) = Sqr((ZZX1 - ZZX2) * (ZZX1 - ZZX2) + (ZZY1 - ZZY2) * (ZZY1 - ZZY2))
                if ( LLLLL(M) < 0.15 ) {
                    UseSettenNumber(部I(M)) = 0.1
                    UseSettenNumber(部J(M)) = 0.1
                } else {if ( LLLLL(M) < 0.35 ) {
                    UseSettenNumber(部I(M)) = 0.5
                    UseSettenNumber(部J(M)) = 0.5
                } else {
                    UseSettenNumber(部I(M)) = 1
                    UseSettenNumber(部J(M)) = 1
                }
                if ( (ZZX1 = ZZX2) || (ZZY1 = ZZY2) ) { //////////07/12/31
                    斜比(M, 1) = 1: 斜比(M, 2) = 1
                } else {
                    斜比(M, 1) = Abs(ZZX1 - ZZX2) / LLLLL(M)
                    斜比(M, 2) = Abs(ZZY1 - ZZY2) / LLLLL(M)
                }
                部材方向(M) = ATAN2(節X(部J(M)) - 節X(部I(M)), 節Y(部J(M)) - 節Y(部I(M)))
                SuiHeiIIX(M) = X(2)
                SuiHeiJJX(M) = X(3)
                SuiHeiAngX(M) = 部材方向(M)
                if ( 部材方向(M) < 5 $$ (部材方向(M) > -5 || 部材方向(M) > 355) $$ SuiheiBBFlag = 0 ) {
                    SuiheiBBFlag = 0
                } else {
                    SuiheiBBFlag = 1
                }
                Select Case 部材方向(M)
                Case Is < 0
                    AngleDF(M) = 0
                    AngleDF1[M] = AngleDF(M]
                Case Is < 5
                    AngleDF(M) = 0
                    部材方向(M) = 0
                    ZFAngle(M) = 0
                    AngleDF1[M] = AngleDF(M]
                Case Is < 90 //////////////////////////////////////////09/10/14
                        AngleDF(M) = 90
                        AngleDF1[M] = 0 // -部材方向(M] / 10
                Case Is < 175
                    if ( 部材方向(M) >= 85 $$ 部材方向(M) <= 95 ) {
                        ZFAngle(M) = 90
                        AngleDF(M) = 90
                        AngleDF1[M] = AngleDF(M]
                    } else {
                        AngleDF1[M] = 部材方向(M]
                    }
                Case Is <= 185
                    部材方向(M) = 180
                    AngleDF(M) = 180
                    ZFAngle(M) = 0
                    AngleDF1[M] = AngleDF(M]
                Case Is < 355
                    if ( 部材方向(M) >= 275 $$ 部材方向(M) < 360 ) { ////////09/10/14
                        AngleDF(M) = 270
                        AngleDF1[M] = 0
                    } else {if ( 部材方向(M) >= 265 $$ 部材方向(M) <= 275 ) {
                        ZFAngle(M) = 90
                        AngleDF(M) = 270
                        AngleDF1[M] = 270
                    } else {
                        AngleDF(M) = 270
                        AngleDF1[M] = 部材方向(M]
                    }
                Case } else {
                    部材方向(M) = 0
                    AngleDF1[M] = 0
                End Select
                if ( ZFAngle(M) = 0 ) {
                    SuiheiMax = SuiheiMax + 1
                    SuiheiI(SuiheiMax) = 部I(M)
                    SUIHEIJ(SuiheiMax) = 部J(M)
                }
                if ( ZFAngle(M) = 90 ) {
                    SuityokuMax = SuityokuMax + 1
                    SuityokuI(SuityokuMax) = 部I(M)
                    SuityokuJ(SuityokuMax) = 部J(M)
                }
                FAngle(M) = 部材方向(M)
                節点部材数(部I(M)) = 節点部材数(部I(M)) + 1
                節点部材数(部J(M)) = 節点部材数(部J(M)) + 1
                JJ(部I(M), 節点部材数(部I(M))) = 部J(M)
                JJ(部J(M), 節点部材数(部J(M))) = 部I(M)
                JM(部I(M), 節点部材数(部I(M))) = M
                JM(部J(M), 節点部材数(部J(M))) = M
                if ( Abs(ZZX2 - ZZX1) > 0.01 ) {
                    LL_Naname2 = LL_Naname2 + Abs(ZZX2 - ZZX1)
                    if ( (Abs(ZZY1 - ZZY2) / Abs(ZZX2 - ZZX1)) > 0.3 ) { //////13/04/08
                        LL_Naname = LL_Naname + Abs(ZZX2 - ZZX1)
                        Naname = Naname + Abs(ZZY1 - ZZY2)
                    }
                }
            Next M
            //14/09/10////////////////////////////15/04/25 コメントにした
            //    if ( CASN >= 0 $$ KUI数 = 1 $$ InStr(部材名(部材_max), "杭") = 1 ) {
            //        部材名(部材_max) = "側壁"
            //    }
            //
            if ( LL_Naname != 0 ) { ////////13/04/12
                if ( (Naname / LL_Naname) > 0.3 $$ (LL_Naname / LL_Naname2) > 0.5 ) { //////13/04/08
                    階段Mod = True //////13/04/08
                    iKozo = 3
                }
            }
            //    Next
            var AQ1 As Integer, AQ2 As Integer, F1 As Integer, F2 As Integer
            this.JJM(Jn_max)
            g背割れ = 0
            this.g荷重図背割れ(部材_max) ////////08/06/24
            For( M = 1 To 部材_max
                上層Buzai(M) = 0
                上層斜めBuzaiV(M) = 0 //////14/12/13
                g荷重図背割れ(M) = 部材縮小率(M - 1).int荷重縮小率 / 100 ////////08/06/24
                if ( g荷重図背割れ(M) = 1 / 100 || g荷重図背割れ(M) = 2 / 100 ) {
                    g背割れ = 1
                }
                if ( CASN < 0 ) {
                    ZZBuzaiBai(M) = 部材縮小率(M - 1).int骨組縮小率 / 100
                } else {
                    ZZBuzaiBai(M) = 部材縮小率(M - 1).int荷重縮小率 / 100
                }
                if ( g荷重図背割れ(M) = 1 / 100 || g荷重図背割れ(M) = 2 / 100 ) { ////////08/06/24
                    ZZBuzaiBai(M) = 1
                }
            //08/11/14
            //        if ( g荷重図背割れ(M) = 1 / 100 || g荷重図背割れ(M) = 2 / 100 ) { ////////保守対象外 08/11/14
            //            g背割れ = 0
            //            g荷重図背割れ(M) = 1
            //            ZZBuzaiBai(M) = 1
            //        }
                //
                if ( AngleDF1[M] < 5 $$ AngleDF1[M] > 355 ] {
                    AngleDF1[M] = 0
                }
                if ( AngleDF1[M] < 95 $$ AngleDF1[M] > 85 ] {
                    AngleDF1[M] = 90
                }
                if ( AngleDF1[M] < 185 $$ AngleDF1[M] > 175 ] {
                    AngleDF1[M] = 180
                }
                if ( AngleDF1[M] < 275 $$ AngleDF1[M] > 265 ] {
                    AngleDF1[M] = 270
                }
            ////////////////////////////////////////////////////////////////////////////////05/02/07
                    if ( ZZBuzaiBai(M) = 0 ) {
                        JJM(部I(M)) = 0
                        JJM(部J(M)) = 0
                    } else {
                        JJM(部I(M)) = 1
                        JJM(部J(M)) = 1
                    }
            ////////////////////////////////////////////////////////////////////////////////05/02/07
            Next M
            //
            //    if ( gMB1 + gMB2 != 0 ) {
            //        g背割れ = 1
            //        if ( gMB1 * gMB2 = 0 ) {
            //            if ( gMB1 = 0 ) {
            //                For( M = 1 To 部材_max
            //                    if ( g荷重図背割れ(M) = 1 || g荷重図背割れ(M) = 2 ) {
            //                        g骨組図背割れ(M) = g荷重図背割れ(M)
            //                    }
            //                Next M
            //            } else {
            //                For( M = 1 To 部材_max
            //                    if ( g骨組図背割れ(M) = 1 || g骨組図背割れ(M) = 2 ) {
            //                        g荷重図背割れ(M) = g骨組図背割れ(M)
            //                    }
            //                Next M
            //            }
            //        }
            //    }
            //
            this.水平BUZAI(部材_max + 1)
            this.水平BUZAIM(部材_max + 1) //////17/11/21

            var X監視 As Single
            X監視 = -9999
            y水平CUNT = 0

            //var 水平部材最上端 As Single ////////13/04/08
            var mm杭長 As Single, ZZYY As Single
            mm杭長 = 0: ZZYY = 9999
            階段水平部材最上端 = -99999
            水平部材最上端 = -99999
            水平部材最下端 = 99999 //////////09/10/14
            For( M = 1 To 部材_max
                if ( KuiFD(M) = 1 ) {
                    if ( KuiFD1(FBuzaiJ(M)) > 1 ) {
                    } else {
                         NoJtan(M) = 1
                    }
                }
            //////////////////////////////////////////////////////////////08/11/06
                ZZX2 = 節X(部J(M))
                ZZX1 = 節X(部I(M))
                ZZY2 = 節Y(部J(M))
                ZZY1 = 節Y(部I(M))
                if ( ZZX1 != ZZX2 ) {
                    if ( ZZX1 > X監視 ) { //////15?12/01
                        X監視 = ZZX1
                        y水平CUNT = y水平CUNT + 1
                        水平BUZAI(y水平CUNT) = 部I(M)
                        水平BUZAI(y水平CUNT + 1) = 部J(M)
                    }
                if ( (Abs(ZZY1 - ZZY2) / Abs(ZZX1 - ZZX2)) < 0.4 ) { //////15/07/15
                    if ( y最低 + 1 > ZZY1 || y最低 + 1 > ZZY2 || InStr(部材名(M), "下床") != 0 || InStr(部材名(M), "底版") != 0 ) {
                        y最低CUNT = y最低CUNT + 1
                        下層BUZAI(y最低CUNT, 1) = M
                        下層BUZAI(y最低CUNT, 2) = 部I(M)
                        下層BUZAI(y最低CUNT, 3) = 部J(M)
                    }
                    水平部材最下端 = min(水平部材最下端, ZZY1)
                    水平部材最下端 = min(水平部材最下端, ZZY2)
                    if ( 水平部材最下端 = ZZY1 $$ Not (InStr(部材名(M), "下床") != 0 || InStr(部材名(M), "底版") != 0) ) { //////15/03/23
                        if ( InStr(部材名(M), "上") != 0 || InStr(部材名(M), "中層") != 0 ) {
                            ZZYY = ZZY1
                        }
                    }
                    //
                    水平部材最上端 = max(水平部材最上端, ZZY1) //////////10/01/18
                    水平部材最上端 = max(水平部材最上端, ZZY2) //////////10/01/18
                    水平BUZAIM(y水平CUNT) = M

                    if ( (階段Mod = True $$ Abs(ZZY1 - ZZY2) < 0.3) ) { //////13/04/08
                        階段水平部材最上端 = max(階段水平部材最上端, ZZY1)
                        階段水平部材最上端 = max(階段水平部材最上端, ZZY2)
                    }
                }
                }
                if ( InStr(部材名(M), "杭") != 0 ) {
                    mm杭長 = max(mm杭長, ZZY1 - ZZY2)
                }
            //        if ( 水平部材最上端 = 水平部材最下端 ) { //////16/10/17
            //            if ( iKozo = 1 ) {
            //                水平部材最下端 = 水平部材最下端 - 10
            //            } else {
            //                水平部材最上端 = 水平部材最上端 + 10
            //            }
            //        }
            //        }////09/11/22コメントにした
            //////////////////////////////////////////////////////////////08/11/06
            F1 = 0: F2 = 0
                    For( i = 1 To 部材_max
                        if ( i != M ) {
                            if ( 部I(M) = 部I(i) || 部I(M) = 部J(i) ) {
                                F1 = F1 + 1
                                AQ1 = i
                            }
                            if ( 部J(M) = 部I(i) || 部J(M) = 部J(i) ) {
                                F2 = F2 + 1
                                AQ2 = i
                            }
                        }
                    }
                    if ( ZZBuzaiBai(M) != 0 ) { ////////09/07/30
            //            if ( CASN >= 0 ) { //////////////// 05/04/01
                        if ( F1 = 1 ) {
            //                    if ( cmnBLen(uBuzai(AQ1 - 1).intItan, uBuzai(AQ1 - 1).intJtan) < 0.35 ) {
                            if ( InStr(部材名(M), "剛") != 0 ) {
                                JJM(部I(M)) = 2 //////// 剛域
                            }
                            if ( Abs(部材方向(M) - 部材方向(AQ1)) < 5 ) {
                                JJM(部I(M)) = 2 //////// 接続部材が１
                            } else {
                                JJM(部I(M)) = 3 //////// 接続部材が１
                            }
                        }
                        if ( F2 = 1 ) {
            //                    if ( cmnBLen(uBuzai(AQ2 - 1).intItan, uBuzai(AQ2 - 1).intJtan) < 0.35 ) {
            //                    JJM(部J(M)) = 2 //////// 剛域
            //                    }
                            if ( Abs(部材方向(M) - 部材方向(AQ2)) < 5 ) {
                                JJM(部J(M)) = 2 //////// 接続部材が１
                            } else {
                                JJM(部J(M)) = 3 //////// 接続部材が１
                            }
                        }
                        if ( F1 = 0 ) { JJM(部I(M)) = 9 //////// 端点
                        if ( F2 = 0 ) { JJM(部J(M)) = 9 //////// 端点
                    }
            Next M
            下層BUZAI(0, 0) = y最低CUNT ////////14/06/16
            if ( 水平部材最上端 != 水平部材最下端 ) { //////10/01/18
                if ( (FR橋脚 = 2 || iKozo = 2 || (iKozo = 3 $$ 部材_max > 20)) ) { ////////17/07/31
                    FR橋脚 = 1
                    iKozo = 1
                }
            }
            //////////////////////////////////////////////////////
            var m柱中 As Single: m柱中 = 9999
            var KL7 As Single, KM7 As Integer //////09/12/03
            KL7 = -99999
            g柱本数 = 0
            For( M = 1 To 部材_max
                ZZX2 = 節X(部J(M))
                ZZX1 = 節X(部I(M))
                ZZY2 = 節Y(部J(M))
                ZZY1 = 節Y(部I(M))
                g柱X座標(M, 1) = -99999
            //        if ( ZZX1 = ZZX2 $$ Mid(Trim(部材名(M)), 1, 1) != "杭" $$ _
            //                        (ZZY1 > y最低 || ZZY2 > y最低) ) { //////08/11/066
                if ( Abs(ZZX1 - ZZX2) < 0.001 $$ (ZZY1 >= y最低 || ZZY2 >= y最低) ) { //
                if ( (InStr(部材名(M), "柱") != 0 || _
                    InStr(部材名(M), "体") != 0 || _
                    InStr(部材名(M), "壁") != 0) || _
                    (Abs(ZZY1 - 水平部材最上端) < 0.5 $$ Abs(ZZY1 - ZZY2) > 0.5) || _
                    iKozo = 3 ) { ////////13/12/10
                    j = 0
                    if ( g柱本数 > 0 ) { ////////09/12/03
                        For( i = 1 To g柱本数
                            if ( g柱X座標(i, 1) = Round(ZZX1, 3) ) {
                                j = 1
                                Exit For
                            }
                        }
                    }
                    if ( j = 0 ) {
                        g柱本数 = g柱本数 + 1
                        g柱X座標(g柱本数, 1) = Round(ZZX1, 3) ////////09/12/03
                        g柱X座標(g柱本数, 2) = 部I(M)
                        g柱X座標(g柱本数, 3) = ZZY2 ////////////09/10/29
                    }
                    if ( g柱X座標(g柱本数, 1) > KL7 ) { ////////09/12/03
                        KL7 = g柱X座標(g柱本数, 1)
                        KM7 = g柱本数
                    }
                    m柱中 = min(m柱中, (ZZY1 - ZZY2) / 2)
                }
                }
            Next M

            if ( g柱X座標(g柱本数, 1) != KL7 ) { ////////09/12/03
                g柱本数 = g柱本数 + 1
                g柱X座標(g柱本数, 1) = g柱X座標(KM7, 1)
                g柱X座標(g柱本数, 2) = g柱X座標(KM7, 2)
                g柱X座標(g柱本数, 3) = g柱X座標(KM7, 3)
            }

            if ( 水平部材最下端 != 99999 $$ 水平部材最下端 = ZZYY $$ 水平部材最下端 > m柱中 ) { //////15/03/23
                水平部材最下端 = 99999
                For( M = 1 To y最低CUNT
                    下層BUZAI(M, 1) = 0
                    下層BUZAI(M, 2) = 0
                    下層BUZAI(M, 3) = 0
                Next M
                下層BUZAI(0, 0) = 0
                y最低CUNT = 0
            //    y最低 = 99999
            }
            ////////////////////////////////////////////////////////////08/11/18
            var KXX1 As Single, KXX2 As Single
            KXX1 = 99999: KXX2 = -99999
            m左側壁Grp(0) = 0
            m右側壁Grp(0) = 0
            For( M = 1 To 部材_max
                ZZX2 = 節X(部J(M))
                ZZX1 = 節X(部I(M))
                ZZY2 = 節Y(部J(M))
                ZZY1 = 節Y(部I(M))
                if ( ZZX1 = ZZX2 ) {
                    if ( KXX1 > ZZX1 ) {
                        KXX1 = ZZX1
                    }
                    if ( KXX2 < ZZX1 ) {
                        KXX2 = ZZX1
                    }
                }
            Next M

            if ( KXX1 != 99999 || KXX2 != -99999 ) {
                For( M = 1 To 部材_max
                    ZZX2 = 節X(部J(M))
                    ZZX1 = 節X(部I(M))
                    ZZY2 = 節Y(部J(M))
                    ZZY1 = 節Y(部I(M))
                    if ( ZZX1 = ZZX2 ) {
                        if ( KXX1 = ZZX1 ) {
                            m左側壁Grp(0) = m左側壁Grp(0) + 1
                            m左側壁Grp(m左側壁Grp(0)) = M
                        }
                        if ( KXX2 = ZZX1 ) {
                            m右側壁Grp(0) = m右側壁Grp(0) + 1
                            m右側壁Grp(m右側壁Grp(0)) = M
                        }
                    }
                Next M
            }
            //MsgBox AngleDF(33)
            // this.ShitenFD(Jn_max)
            KanazMax = 部材_max
            For( i = 1 To Jn_max
                VxCount = 0
                this.Vxvar(KanazMax)
                For( j = 1 To KanazMax
                    Vxvar(j) = 0
                }
                For( j = 1 To KanazMax
                    if ( i = FBuzaiI(j) || i = FBuzaiJ(j) ) {
                        VxCount = VxCount + 1
                        Vxvar(VxCount) = j
                    }
                }
                Setsugou(1) = 0
                Setsugou(2) = 0
                Setsugou(3) = 0
                Setsugou(4) = 0
                if ( VxCount = 0 ) {
                } else {
                    if ( VxCount = 1 $$ Mid(部材名(Vxvar(VxCount)), 1, 1) = "杭" $$ M杭mod ) {
                        ShitenFD(i) = -9000
                        Shiten固定(i) = -9000
                    } else {
                        For( j = 1 To VxCount
                            if ( i = FBuzaiJ(Vxvar(j)) ) {
                                Select Case AngleDF(Vxvar(j))
                                Case 0
                                    Setsugou(3) = 1
                                Case 90
                                    Setsugou(4) = 1
                                Case 180
                                    Setsugou(1) = 1
                                Case 270
                                    Setsugou(2) = 1
                                Case } else {
                                    Setsugou(1) = 1
                                End Select
                            }
                            if ( i = FBuzaiI(Vxvar(j)) ) {
                                Select Case AngleDF(Vxvar(j))
                                Case 0
                                    Setsugou(1) = 1
                                Case 90
                                    Setsugou(2) = 1
                                Case 180
                                    Setsugou(3) = 1
                                Case 270
                                    Setsugou(4) = 1
                                Case } else {
                                    Setsugou(1) = 1
                                End Select
                            }
                        }
                        if ( Setsugou(1) = 1 $$ Setsugou(3) = 0 $$ Setsugou(2) = 0 $$ Setsugou(4) = 0 ) {
                            ShitenFD(i) = 0
                            Shiten固定(i) = 90
                        }
                        if ( Setsugou(1) = 1 $$ Setsugou(3) = 1 $$ Setsugou(2) = 0 $$ Setsugou(4) = 0 ) {
                            ShitenFD(i) = 0
                        }
                        if ( Setsugou(1) = 1 $$ Setsugou(3) = 1 $$ Setsugou(2) = 0 $$ Setsugou(4) = 1 ) {
                            ShitenFD(i) = 180
                        }
                        if ( Setsugou(1) = 1 $$ Setsugou(3) = 0 $$ Setsugou(2) = 0 $$ Setsugou(4) = 1 ) {
                            ShitenFD(i) = 180
                        }
                        if ( Setsugou(1) = 1 $$ Setsugou(3) = 0 $$ Setsugou(2) = 1 $$ Setsugou(4) = 0 ) {
                            ShitenFD(i) = 0
                        }
                        if ( Setsugou(1) = 0 $$ Setsugou(3) = 0 $$ Setsugou(2) = 1 $$ Setsugou(4) = 1 ) {
                            ShitenFD(i) = 0 ////////13/04/08////////90
                        }
                        if ( Setsugou(1) = 1 $$ Setsugou(3) = 0 $$ Setsugou(2) = 1 $$ Setsugou(4) = 1 ) {
                            ShitenFD(i) = 270
                        }
                        if ( Setsugou(1) = 0 $$ Setsugou(3) = 1 $$ Setsugou(2) = 1 $$ Setsugou(4) = 1 ) {
                            ShitenFD(i) = 90
                        }
                        if ( Setsugou(1) = 0 $$ Setsugou(3) = 0 $$ Setsugou(2) = 0 $$ Setsugou(4) = 1 ) {
                            ShitenFD(i) = 90
                        }
                        if ( Setsugou(1) = 0 $$ Setsugou(3) = 0 $$ Setsugou(2) = 1 $$ Setsugou(4) = 0 ) {
                            ShitenFD(i) = 0 //90 ////////////////05/02/06 nagase
                        }
                        if ( Setsugou(1) = 1 $$ Setsugou(3) = 0 $$ Setsugou(2) = 0 $$ Setsugou(4) = 0 ) { //水平　左
                            Shiten固定(i) = 270
                        }
                        if ( Setsugou(1) = 0 $$ Setsugou(3) = 1 $$ Setsugou(2) = 0 $$ Setsugou(4) = 0 ) { //水平　右
                            Shiten固定(i) = 90
                        }
                        if ( Setsugou(2) = 1 $$ Setsugou(4) = 0 $$ Setsugou(1) = 0 $$ Setsugou(3) = 0 ) { //垂直　上
                            Shiten固定(i) = 0
                        }
                        if ( Setsugou(3) = 0 $$ Setsugou(4) = 1 $$ Setsugou(1) = 0 $$ Setsugou(3) = 0 ) {  //垂直　下
                            Shiten固定(i) = 180
                        }

                    }
                }
            }
            //
            SSSMaX = UBound(節X(), 1)
            this.SSSX(UBound(節X(), 1))
            this.SSSY(UBound(節Y(), 1))
            AsdFFMax1 = 0
            AsdFFMax3 = 0
            For( M = 1 To 2000
                AsdFF1(M) = -9000000000#
                AsdFF3(M) = -9000000000#
            Next M
            For( M = 1 To SSSMaX
                SSSX(M) = 節X(M)
                SSSY(M) = 節Y(M)
            Next M
            J_MaxB1 = -9000000000#
            J_MinB1 = 9000000000#
            For( M = 1 To 部材_max
                if ( ZFAngle(M) = 0 || ZFAngle(M) = 180 ) {
                    if ( J_MaxB1 < SSSY(FBuzaiI(M)) || J_MaxB1 < SSSY(FBuzaiJ(M)) ) {
                        J_MAXB = M
                        if ( J_MaxB1 < SSSY(FBuzaiI(M)) ) {
                            J_MaxB1 = SSSY(FBuzaiI(M))
                        } else {
                            if ( J_MaxB1 < SSSY(FBuzaiJ(M)) ) {
                                J_MaxB1 = SSSY(FBuzaiJ(M))
                            }
                        }
                    }
                    if ( J_MinB1 > SSSY(FBuzaiI(M)) || J_MinB1 > SSSY(FBuzaiJ(M)) ) {
                        J_MINB = M
                        if ( J_MinB1 > SSSY(FBuzaiI(M)) ) {
                            J_MinB1 = SSSY(FBuzaiI(M))
                        } else {
                            if ( J_MinB1 > SSSY(FBuzaiJ(M)) ) {
                                J_MinB1 = SSSY(FBuzaiJ(M))
                            }
                        }
                    }
                }
            Next M
            //
            if ( NoKaikin1 = 1 ) {
                AsdFFMaxFlag1 = 0
                AsdFFMaxFlag3 = 0
                if ( M = 0 ) { //J_MINB = J_MAXB ) {
                    AsdFFMaxFlag1 = 0
                    AsdFFMaxFlag3 = 0
                } else {
                    III1 = 0
                    this.Check1(部材_max)
                    this.Check2(部材_max)
                    this.JOUHOUH(部材_max)
                    this.KAHOUH(部材_max)
                    For( M = 1 To 部材_max
                        Check1(M) = -9000000000#
                        Check2(M) = -9000000000#
                        JOUHOUH(M) = -9000000000#
                        KAHOUH(M) = -9000000000#
                    Next M
                    HaJiMeX = SSSX(FBuzaiI(J_MAXB))
                    HaJiMeY = SSSY(FBuzaiI(J_MAXB))
                    III1 = III1 + 1
                    JOUHOUH(III1) = J_MAXB
                    Check1(J_MAXB) = 1
                    Do
                        Atta = 0
                        For( M = 1 To 部材_max
                            if ( (ZFAngle(M) = 0 || ZFAngle(M) = 180) $$ Check1(M) <= 0 ) {
                                if ( HaJiMeX = SSSX(FBuzaiJ(M)) $$ HaJiMeY = SSSY(FBuzaiJ(M)) ) {
                                    Atta = M
                                    Exit For
                                }
                            }
                        Next M
                        if ( Atta = 0 ) {
                            Exit Do
                        }
                        Check1(Atta) = 1
                        III1 = III1 + 1
                        JOUHOUH(III1) = Atta
                        HaJiMeX = SSSX(FBuzaiI(Atta))
                        HaJiMeY = SSSY(FBuzaiI(Atta))
                    Loop
                    HaJiMeX = SSSX(FBuzaiJ(J_MAXB))
                    HaJiMeY = SSSY(FBuzaiJ(J_MAXB))
                    Do
                        Atta = 0
                        For( M = 1 To 部材_max
                            if ( (ZFAngle(M) = 0 || ZFAngle(M) = 180) $$ Check1(M) <= 0 ) {
                                if ( HaJiMeX = SSSX(FBuzaiI(M)) $$ HaJiMeY = SSSY(FBuzaiI(M)) ) {
                                    Atta = M
                                    Exit For
                                }
                            }
                        Next M
                        if ( Atta = 0 ) {
                            Exit Do
                        }
                        Check1(Atta) = 1
                        III1 = III1 + 1
                        JOUHOUH(III1) = Atta
                        HaJiMeX = SSSX(FBuzaiJ(Atta))
                        HaJiMeY = SSSY(FBuzaiJ(Atta))
                    Loop
                    HaJiMeX = SSSX(FBuzaiI(J_MINB))
                    HaJiMeY = SSSY(FBuzaiI(J_MINB))
                    III2 = III2 + 1
                    KAHOUH(III2) = J_MINB
                    Check2(J_MINB) = 1
                    Do
                        Atta = 0
                        For( M = 1 To 部材_max
                            if ( (ZFAngle(M) = 0 || ZFAngle(M) = 180) $$ Check2(M) <= 0 ) {
                                if ( HaJiMeX = SSSX(FBuzaiJ(M)) $$ HaJiMeY = SSSY(FBuzaiJ(M)) ) {
                                    Atta = M
                                    Exit For
                                }
                            }
                        Next M
                        if ( Atta = 0 ) {
                            Exit Do
                        }
                        Check2(Atta) = 1
                        III2 = III2 + 1
                        KAHOUH(III2) = Atta
                        HaJiMeX = SSSX(FBuzaiI(Atta))
                        HaJiMeY = SSSY(FBuzaiI(Atta))
                    Loop
                    HaJiMeX = SSSX(FBuzaiJ(J_MINB))
                    HaJiMeY = SSSY(FBuzaiJ(J_MINB))
                    Do
                        Atta = 0
                        For( M = 1 To 部材_max
                            if ( (ZFAngle(M) = 0 || ZFAngle(M) = 180) $$ Check2(M) <= 0 ) {
                                if ( HaJiMeX = SSSX(FBuzaiI(M)) $$ HaJiMeY = SSSY(FBuzaiI(M)) ) {
                                    Atta = M
                                    Exit For
                                }
                            }
                        Next M
                        if ( Atta = 0 ) {
                            Exit Do
                        }
                        Check2(Atta) = 1
                        III2 = III2 + 1
                        KAHOUH(III2) = Atta
                        HaJiMeX = SSSX(FBuzaiJ(Atta))
                        HaJiMeY = SSSY(FBuzaiJ(Atta))
                    Loop
                    if ( III1 > 1 ) {
                        AsdFFMaxFlag1 = 1
                        For( M = 1 To III1
                            AsdFFMax1 = AsdFFMax1 + 1
                            AsdFF1(AsdFFMax1) = FBuzaiI(JOUHOUH(M))
                            AsdFFMax1 = AsdFFMax1 + 1
                            AsdFF1(AsdFFMax1) = FBuzaiJ(JOUHOUH(M))
                        Next M
                        For( i = 1 To AsdFFMax1
                            FDFD = AsdFF1(i)
                            For( j = 1 To SSSMaX
                                if ( FDFD != j ) {
                                    if ( SSSX(FDFD) = SSSX(j) $$ SSSY(FDFD) < SSSY(j) ) {
                                        AsdFF1(i) = j
                                        FDFD = j
                                    }
                                }
                            }
                        }
                    } else {
                        AsdFFMaxFlag1 = 0
                    }
                    if ( III2 > 1 ) {
                        AsdFFMaxFlag3 = 1
                        For( M = 1 To III2
                            AsdFFMax3 = AsdFFMax3 + 1
                            AsdFF3(AsdFFMax3) = FBuzaiI(KAHOUH(M))
                            AsdFFMax3 = AsdFFMax3 + 1
                            AsdFF3(AsdFFMax3) = FBuzaiJ(KAHOUH(M))
                        Next M
                        For( i = 1 To AsdFFMax3
                            FDFD = AsdFF3(i)
                            For( j = 1 To SSSMaX
                                if ( FDFD != j ) {
                                    if ( SSSX(FDFD) = SSSX(j) $$ SSSY(FDFD) > SSSY(j) ) {
                                        AsdFF3(i) = j
                                        FDFD = j
                                    }
                                }
                            }
                        }
                    } else {
                        AsdFFMaxFlag3 = 0
                    }
                }
            }
            //
            if ( NoBuzaiKajuuJuuhukuFlag = 0 ) {
                BuzaiMax1 = 部材_max
                this.Check121(BuzaiMax1)
                this.MaeBuzai(BuzaiMax1)
                this.AtoBuzai(BuzaiMax1)
                this.ZBuzaiLength(BuzaiMax1)
                For( M = 1 To BuzaiMax1
                    ZBuzaiLength(M) = RoundS(LLLLL(M), 3)
                    Check121(M) = 0
                    MaeBuzai(M) = 0
                    AtoBuzai(M) = 0
                Next M
                this.ZZBuzaiGroup(BuzaiMax1, BuzaiMax1)
                For( i = 1 To BuzaiMax1
                    For( j = 1 To BuzaiMax1
                        ZZBuzaiGroup(i, j) = 0
                    }
                }
                EndFlag = 0
                GCounter = 0
                Do
                    For( M = 1 To BuzaiMax1
                        MaeBuzai(M) = 0
                        AtoBuzai(M) = 0
                    Next M
                    if ( GCounter = 0 ) {
                        j = BuzaiMax1
                    } else {
                        j = 0
                        For( i = BuzaiMax1 To 1 Step -1
                            if ( Check121(i) = 0 ) {
                                j = i
                                Exit For
                            }
                        }
                        if ( j = 0 ) {
                            Exit Do
                        }
                    }
                    GCounter = GCounter + 1
                    Check121(j) = 1
                    Hajime11 = FBuzaiI(j)
                    JJ1 = j
                    MCounter = 0
                    ACounter = 0
                    Do
                        Atta11 = 0
                        For( i = 1 To BuzaiMax1
                            if ( i != JJ1 $$ Check121(i) = 0 $$ ZFAngle(i) = ZFAngle(JJ1) $$ Hajime11 = FBuzaiJ(i) ) {
                                Atta11 = i
                                Exit For
                            }
                        }
                        if ( Atta11 = 0 ) {
                            Exit Do
                        }
                        MCounter = MCounter + 1
                        Check121(Atta11) = 1
                        MaeBuzai(MCounter) = Atta11
                        Hajime11 = FBuzaiI(Atta11)
                        JJ1 = Atta11
                    Loop
                    JJ1 = j
                    Hajime11 = FBuzaiJ(j)
                    Do
                        Atta11 = 0
                        For( i = 1 To BuzaiMax1
                            if ( i != JJ1 $$ Check121(i) = 0 $$ ZFAngle(i) = ZFAngle(JJ1) $$ Hajime11 = FBuzaiI(i) ) {
                                Atta11 = i
                                Exit For
                            }
                        }
                        if ( Atta11 = 0 ) {
                            Exit Do
                        }
                        ACounter = ACounter + 1
                        Check121(Atta11) = 1
                        AtoBuzai(ACounter) = Atta11
                        Hajime11 = FBuzaiJ(Atta11)
                        JJ1 = Atta11
                    Loop
                    i = 0
                    For( M = MCounter To 1 Step -1
                        i = i + 1
                        ZZBuzaiGroup(GCounter, i) = MaeBuzai(M)
                    Next M
                    i = i + 1
                    ZZBuzaiGroup(GCounter, i) = j
                    For( M = 1 To ACounter
                        i = i + 1
                        ZZBuzaiGroup(GCounter, i) = AtoBuzai(M)
                    Next M
                Loop
                ZZBuzaiGroupMax = GCounter
            }
            //
            For( M = 1 To 部材_max
                i = 部I(M)
                j = 節点部材数(部I(M))
                Do While j > 0
                    if ( JM(i, j) != M ) {
                        if ( 部材方向(JM(i, j)) = 部材方向(M) ) {
                            if ( 部材GRP(JM(i, j)) > 0 ) {
                                部材GRP(M) = 部材GRP(JM(i, j))
                                Exit Do
                            }
                        }
                    }
                    j = j - 1
                Loop
                if ( j = 0 ) {
                    i = 部J(M)
                    j = 節点部材数(部J(M))
                    Do While j > 0
                        if ( JM(i, j) != M ) {
                            if ( 部材方向(JM(i, j)) = 部材方向(M) ) {
                                if ( 部材GRP(JM(i, j)) > 0 ) {
                                    部材GRP(M) = 部材GRP(JM(i, j))
                                    Exit Do
                                }
                            }
                        }
                        j = j - 1
                    Loop
                }
                if ( j = 0 ) {
                    GRP = GRP + 1
                    部材GRP(M) = GRP
                }
            Next
            For( i = 1 To Jn_max
                Select Case 節点部材数(i)
                Case 1
                Case 2
                    TH1 = 部材方向(JM(i, 1))
                    TH2 = 部材方向(JM(i, 2))
                    if ( TH1 = TH2 ) {
                        節点部材数(i) = 999
                    }
                Case } else {
                End Select
            }
            Close #fno
            //////////////////////////////////////////////////07/12/13
            //    if ( CASN >= 0 ) {
                Ymax = 99999
                Ymin = 99999
                NKUI = 0
                k杭長 = 0
                For( i = 1 To 部材_max
                    i1 = 部I(i)
                    I2 = 部J(i)
                    X1 = 節X(i1)
                    y1 = 節Y(i1)
                    X2 = 節X(I2)
                    Y2 = 節Y(I2)
                    if ( InStr(部材名(i), "杭") = 1 ) {
                        NKUI = NKUI + 1
                        if ( Ymin > y1 ) {
                            Ymin = y1
                        }
                        if ( Ymin > Y2 ) {
                            Ymin = Y2
                        }
                        if ( k杭長 < (y1 - Y2) ) {
                            k杭長 = (y1 - Y2)
                        }
                    } else {
                        if ( Ymax > y1 ) {
                            Ymax = y1
                        }
                        if ( Ymax > Y2 ) {
                            Ymax = Y2
                        }
                    }
                }
            //        if ( Xmax = Xmin ) { ////////08/01/07 ////////08/06/24 コメントにした
            //            FR橋脚 = 1
            //            RR橋脚 = 1
            //        }
                if ( NKUI > 0 $$ Ymin >= 0 ) {
                    For( i = 1 To Jn_max
                        節Y(i) = 節Y(i) - k杭長
                        節Y0(i) = 節Y0(i) - k杭長
                    }
                    HighZMax = HighZMax - k杭長
                    HighZMin = HighZMin - k杭長
                    if ( y最低 != 99999 ) { y最低 = y最低 - k杭長 //////////10/01/03
                    水平部材最下端 = 水平部材最下端 - k杭長 //////////10/01/03
                    if ( g柱本数 > 0 ) {
                        For( i = 1 To g柱本数
                            g柱X座標(i, 3) = g柱X座標(i, 3) - k杭長 //////////10/01/03
                        }
                    }
                } else {if ( NKUI = 0 $$ Ymax < 0 $$ CASN >= 0 ) {
                    For( i = 1 To Jn_max
                        節Y(i) = 節Y(i) - Ymax
                        節Y0(i) = 節Y0(i) - Ymax
                    }
                    HighZMax = HighZMax - Ymax
                    HighZMin = HighZMin - Ymax
                    if ( y最低 != 99999 ) { y最低 = y最低 - Ymax //////////10/01/03
                    水平部材最下端 = 水平部材最下端 - Ymax //////////10/01/03
                    if ( g柱本数 > 0 ) {
                        For( i = 1 To g柱本数
                            g柱X座標(i, 3) = g柱X座標(i, 3) - Ymax //////////10/01/03
                        }
                    }
                }
            //    }
            //////////////////////////////////////////////////07/12/13 end
            ////////////////////////////////////////////////////////////////////////////////////////05/05/03
            Xmax = -99999
            Xmin = 99999
            Ymax = -99999
            Ymin = 99999
            ZMAX = -99999
            ZMIN = 99999
            YMin杭無 = 99999
            NKUI = 0
            j = 0
            k杭数 = 0
            g柱I_X(1) = 0: g柱I_X(2) = 0 //////10/11/033
            For( i = 1 To 部材_max
                i1 = 部I(i)
                I2 = 部J(i)
                X1 = 節X(i1)
                y1 = 節Y(i1)
                X2 = 節X(I2)
                Y2 = 節Y(I2)
                if ( Xmax < X1 ) {
                    Xmax = X1
                    g柱I_X(2) = i1 //////10/11/033
                }
                if ( Xmax < X2 ) {
                    Xmax = X2
                    g柱I_X(2) = I2 //////10/11/033
                }
                if ( Xmin > X1 ) {
                    Xmin = X1
                    g柱I_X(1) = i1 //////10/11/033
                }
                if ( Xmin > X2 ) {
                    Xmin = X2
                    g柱I_X(1) = I2 //////10/11/033
                }
                    if ( Ymax < y1 ) {
                        Ymax = y1
                    }
                    if ( Ymax < Y2 ) {
                        Ymax = Y2
                    }
                    if ( Ymin > y1 ) {
                        Ymin = y1
                    }
                    if ( Ymin > Y2 ) {
                        Ymin = Y2
                    }
                    if ( InStr(部材名(i), "杭") = 0 || Not M杭mod || 部材_max = 1 ) { //////09/12/09
                        if ( ZMAX < y1 ) {
                            ZMAX = y1
                        }
                        if ( ZMAX < Y2 ) {
                            ZMAX = Y2
                        }
                        if ( ZMIN > y1 ) {
                            ZMIN = y1
                        }
                        if ( ZMIN > Y2 ) {
                            ZMIN = Y2
                        }
                    }
                    if ( InStr(部材名(i), "杭") = 1 ) {
                        NKUI = NKUI + 1
                        if ( 数部材(i) >= 1 ) {
                            k杭数 = 1
                        }
                        if ( ZZBuzaiBai(i) = 1 ) {
                            j = j + 1
                        }

                    }
            }
            if ( CASN >= 0 $$ NKUI = j $$ 荷重図フォーマット.int用紙方向 = 0 $$ 荷重図フォーマット.intレイアウト != 0 ) { //////////////07/04/24
                XXMAX = 0
                For( i = 1 To 部材_max
                    if ( InStr(部材名(i), "杭") = 1 $$ 節点部材数(部J(i)) = 1 ) { ////////07/12/15  $$ 節点部材数(部J(i)) = 1 ) {
                        if ( XXMAX = 0 ) {
                            XXMAX = LLLLL(i)
                        } else {
                            if ( Abs(XXMAX - LLLLL(i)) > 0.001 ) {
                                XXMAX = -999
                                Exit For
                            }
                        }
                    }
                }
                if ( XXMAX != -999 ) {
                    For( i = 1 To 部材_max
                        if ( InStr(部材名(i), "杭") = 1 $$ 節点部材数(部J(i)) = 1 ) {
                            ZZBuzaiBai(i) = Round(max(((Abs(ZMAX) / LLLLL(i)) ^ 0.6), 0.55), 2) ////////14/07/17   Abs(ZMAX)
                        }
                    }
                }
            }
            if ( Xmax = Xmin ) { //////////08/06/24
                FR橋脚 = 1
                RR橋脚 = 1
            }
            XXMAX = max(Abs(Xmax - Xmin), 0.01)
            if ( ZMAX = -99999 || ZMIN = 99999 ) {
                YYMAX = 0
            } else {
                YYMAX = max(Abs(ZMAX - ZMIN), 0.01)
            }
            ZZMAX = max(Abs(Ymax - Ymin), 0.01)
            h = (Ymax - Ymin) - YYMAX
            if ( NKUI > 0 $$ YYMAX > 0 ) {
                if ( CASN < 0 ) {
            //            if ( j != 0 $$ (h / YYMAX) > 2.3 ) {
            //                For( i = 1 To 部材_max
            //                    if ( InStr(部材名(i), "杭") = 1 $$ ZZBuzaiBai(i) = 1 ) {
            //                        if ( (XXMAX / ZZMAX) < 1 ) {
            //                            if ( (YYMAX / h) < 0.25 ) {
            //                            ZZBuzaiBai(i) = Round((YYMAX / h) ^ 0.65, 2)
            //                            } else {
            //                            ZZBuzaiBai(i) = Round((YYMAX / h) ^ 0.25, 2)
            //                            }
            //                        }
            //                    }
            //                }
            //            }
                } else {
                     //////////////////////////////杭長の自動調整    06/03/27
                    if ( Not (荷重図フォーマット.int用紙方向 = 0 $$ _
                            荷重図フォーマット.intレイアウト = 1) || (h / YYMAX) > 2.2 ) { ////////08/06/16
                    if ( h != 0 $$ (XXMAX / ZZMAX) < 2 $$ XXMAX > 0 ) { //////////////////////////////////////////////////////////07/11/07
                        if ( (h / YYMAX) > 2 ) {
                            if ( 荷重図フォーマット.int用紙方向 = 1 ) {
            //                    h = YYMAX * 1.7
                            } else {
                            h = YYMAX * 1.7 ////////////////////////////////////////////////////////////////////07/11/07
                            }
                        }
                        For( i = 1 To 部材_max
                            if ( InStr(部材名(i), "杭") = 1 $$ ZZBuzaiBai(i) = 1 $$ M杭mod $$ 節点部材数(部J(i)) = 1 ) { ////////07/12/15  $$ 節点部材数(部J(i)) = 1 ) {
                                if ( FR橋脚 = 2 ) {
                                    ZZBuzaiBai(i) = Round((YYMAX / h), 2)
                                } else {
                                    ZZBuzaiBai(i) = Round((YYMAX / h) ^ 0.85, 2)
                                }
                            }
                        }
                    }
                    } ////////08/06/16
                }
            }
            ////////////////////////////////////////////////////////////////////////////////////////05/05/03
            double var CCCC ////////////06/04/05
            double var SSSS
            double var ANSANG
            var K5 As Integer //////////////////08/11/23
            K5 = 0
            this.増分Y(Jn_max) //////////08/11/23
            //@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ 杭図倍率
            For( i = 1 To Jn_max
                増分Y(i) = 0 //////////08/11/23
            }
            垂直中央 = 0
            杭図倍率 = 1
            XXMAX = 1
            Xmax = -99999
            Xmin = 99999
            Ymax = -99999
            Ymin = 99999
            ZMAX = -99999
            ZMIN = 99999
            YMin杭無 = 99999
            NKUI = 0
            j = 0
            k杭数 = 0
            For( i = 1 To 部材_max
                i1 = 部I(i)
                I2 = 部J(i)
                X1 = 節X(i1)
                y1 = 節Y(i1)
                X2 = 節X(I2)
                Y2 = 節Y(I2)
                LY = Y2 - y1 //////////08/02/07
                //
            //        if ( InStr(部材名(i), "杭") = 1 $$ M杭mod ) { //////////////////////////////05/03/13
                    if ( ZZBuzaiBai(i) != 1 ) {
            //                LY = Y2 - y1
                        if ( 節点部材数(I2) = 1 ) {
                            節Y(I2) = y1 + ZZBuzaiBai(i) * LY
                            Y2 = 節Y(I2)
                        } else {
                            節Y(i1) = Y2 - ZZBuzaiBai(i) * LY
                            増分Y(i1) = 節Y(i1) - y1 ////////08/11/23
                            K5 = 1
                            y1 = 節Y(i1)
                        }
                    }
                    if ( X1 = X2 $$ 節点部材数(I2) = 1 $$ Abs(LY) <= 0.1 $$ LY < 0 ) { //////////08/02/07
                        節Y(I2) = y1 - Round(YYMAX / 30, 2)
                    }
            //        } ////////////////////////////////////////////////////////////////////////////////////////05/03/13 ZZBuzaiBai(i) * LY * 100 + YYMAX
                if ( Xmax < X1 ) {
                    Xmax = X1
                }
                if ( Xmax < X2 ) {
                    Xmax = X2
                }
                if ( Xmin > X1 ) {
                    Xmin = X1
                }
                if ( Xmin > X2 ) {
                    Xmin = X2
                }
                if ( (FR橋脚 = 2 $$ InStr(部材名(i), "剛") != 0 $$ InStr(部材名(i), "柱") != 0) ) {
                    j = 5
                } else {
                    if ( Ymax < y1 ) {
                        Ymax = y1
                    }
                    if ( Ymax < Y2 ) {
                        Ymax = Y2
                    }
                    if ( Ymin > y1 ) {
                        Ymin = y1
                    }
                    if ( Ymin > Y2 ) {
                        Ymin = Y2
                    }
                    if ( InStr(部材名(i), "杭") = 0 || Not M杭mod || 部材_max = 1 ) { //////09/12/09
                        if ( ZMAX < y1 ) {
                            ZMAX = y1
                        }
                        if ( ZMAX < Y2 ) {
                            ZMAX = Y2
                        }
                        if ( ZMIN > y1 ) {
                            ZMIN = y1
                        }
                        if ( ZMIN > Y2 ) {
                            ZMIN = Y2
                        }
                            YMin杭無 = min(YMin杭無, y1)
                            YMin杭無 = min(YMin杭無, Y2)
                    }
                    if ( InStr(部材名(i), "杭") = 1 ) {
                        NKUI = NKUI + 1
                        if ( 数部材(i) >= 1 ) {
                            k杭数 = 1
                        }
                    }
                }
            //        }
            }
            //////
            if ( K5 = 1 ) { //////////////////08/11/23
                For( i = 1 To Jn_max
                    if ( 増分Y(i) != 0 ) {
                        For( K5 = 1 To 部材_max
                            i1 = 部I(K5)
                            I2 = 部J(K5)
                            X1 = 節X(i1)
                            y1 = 節Y(i1)
                            X2 = 節X(I2)
                            Y2 = 節Y(I2)
                            if ( i = i1 $$ Abs(X1 - X2) > 0 $$ 増分Y(I2) = 0 ) {
                                節Y(I2) = 節Y(I2) + 増分Y(i)
                                増分Y(I2) = 増分Y(i)
                            }
                        }5
                        For( K5 = 1 To 部材_max
                            i1 = 部I(K5)
                            I2 = 部J(K5)
                            X1 = 節X(i1)
                            y1 = 節Y(i1)
                            X2 = 節X(I2)
                            Y2 = 節Y(I2)
                            if ( i = I2 $$ Abs(X1 - X2) > 0 $$ 増分Y(i1) = 0 ) {
                                節Y(i1) = 節Y(i1) + 増分Y(i)
                                増分Y(i1) = 増分Y(i)
                            }
                        }5
                    }
                }
            } //////////////////08/11/23
            //
            if ( (iKozo = 3 $$ NKUI != 0) || Xmax = Xmin ) {   ////////////06/05/17
                iKozo = 1
            }
            //
            For( i = 1 To 部材_max ////////////////////////06/04/04
                i1 = 部I(i)
                I2 = 部J(i)
                X1 = 節X(i1)
                y1 = 節Y(i1)
                X2 = 節X(I2)
                Y2 = 節Y(I2)
                if ( FG3(i) > 0 ) {
                    this.LINEOUTCRT3(X1 + 500, y1 + 500, X2 + 500, Y2 + 500, ANSANG)
                    if ( X1 > X2 $$ y1 > Y2 ) {
                        if ( ANSANG < 0 ) {
                            ANSANG = 360 + ANSANG
                        }
                        if ( ANSANG > 270 ) {
                            ANSANG = 270 - (ANSANG - 270)
                        }
                    }
                    CCCC = Cos(DisAng1(ANSANG))
                    SSSS = Sin(DisAng1(ANSANG))
                    ZXXXX1(i) = RoundS(X1 + FG3(i) * CCCC, 3)
                    ZYYYY1(i) = RoundS(y1 + FG3(i) * SSSS, 3)
                }
                if ( FG4(i) > 0 ) {
                    this.LINEOUTCRT3(X1 + 500, y1 + 500, X2 + 500, Y2 + 500, ANSANG)
                    ANSANG = ANSANG + 180
                    if ( ANSANG >= 360 ) {
                        ANSANG = ANSANG - 360
                    }
                    if ( X1 > X2 $$ y1 > Y2 ) {
                        if ( ANSANG < 0 ) {
                            ANSANG = 360 + ANSANG
                        }
                        if ( ANSANG > 90 $$ ANSANG < 180 ) {
                            ANSANG = 90 - (ANSANG - 90)
                        }
                    }
                    CCCC = Cos(DisAng1(ANSANG))
                    SSSS = Sin(DisAng1(ANSANG))
                    ZXXXX2(i) = RoundS(X2 + FG4(i) * CCCC, 3)
                    ZYYYY2(i) = RoundS(Y2 + FG4(i) * SSSS, 3)
                }
            //        LY = Y2 - y1
            //        if ( 節点部材数(I2) = 1 ) {
            //            if ( FG3(I) > 0 ) {
            //            ZYYYY1(I) = y1 + (LY + FG3(I) * ZZBuzaiBai(I) * Sgn(LY ^ 2))////////06/08/21 コメントにした
            //            }
            //            if ( FG4(I) > 0 ) {
            //            ZYYYY2(I) = y1 + (LY + FG4(I) * ZZBuzaiBai(I) * Sgn(LY ^ 2))
            //            }
            //        } else {
            //            if ( FG3(I) > 0 ) {
            //            ZYYYY1(I) = Y2 - (LY + FG3(I) * ZZBuzaiBai(I) * Sgn(LY ^ 2))
            //            }
            //            if ( FG4(I) > 0 ) {
            //            ZYYYY2(I) = Y2 + (FG4(I) * ZZBuzaiBai(I) * Sgn(LY ^ 2))
            //            }
            //        }
            }

            if ( k杭数 = 0 $$ iKozo = 3 ) {
                垂直補正高 = Ymin
            } else {
                垂直補正高 = 0
            }
            if ( j != 0 ) {
               Ymax = Ymax + Round(max(節Y(1) - Ymax, 0) * 0.3, 2)
            }
            if ( ZMAX = -99999 ) {
                ZMAX = 0
            }
            if ( ZMIN = 99999 ) {
                ZMIN = 0
            }
            XXMAX = max(Abs(Xmax - Xmin), 0.01)
            YYMAX = max(Abs(ZMAX - ZMIN), 0.01)
            ZZMAX = max(Abs(Ymax - Ymin), 0.01)
            ////////////////////////////////////////////////////////////////////////////////////////////////// 05/01/31
            if ( XXMAX != 0 $$ FR橋脚 != 2 ) {
                if ( (YYMAX / XXMAX) <= 0.1 $$ NKUI = 0 $$ YYMAX < 2 ) { ////////////12/12/12
                    g連続Mod = True ////////////////////連続梁
                    iKozo = 3 ////////////////////////////////////////////////////////////////07/05/13
                } else {
                    g連続Mod = False
                }
            }

            杭図倍率 = 1
            h = (Ymax - Ymin) - (ZMAX - ZMIN)
            if ( h > 0 ) {
                Select Case CASN
                Case Is < 0 // 骨組図
                    杭図倍率 = 1
                Case Is = 0
                    杭図倍率 = h / max(XXMAX, ZMAX - ZMIN)
                    if ( 杭図倍率 > 1 ) {
                        杭図倍率 = 1
                    }
                Case } else {
                    杭図倍率 = h * 0.8 / max(XXMAX, ZMAX - ZMIN)
                    if ( 杭図倍率 > 0.8 ) {
                        杭図倍率 = 0.8
                    }
                End Select

            }
            //
            if ( CASN < 0 ) {
                if ( FR橋脚 != 2 ) { XEAKI = 0
            } else {
                if ( NoKaikin = 1 ) {
                    if ( 荷重図フォーマット.intレイアウト = 1 ) { //   シングル
                        if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                            XEAKI = Abs(Ymax - Ymin) / 10 //10
                        } else {
                            XEAKI = Abs(Ymax - Ymin) / 10 //12
                        }
                    } else {
                        if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                            XEAKI = Abs(Ymax - Ymin) / 10 //12
                        } else {
                            XEAKI = Abs(Ymax - Ymin) / 10 //15
                        }
                    }
                } else {    // 荷重図の３段書き、４段書き対応版のプログラムソース
                    if ( 荷重図フォーマット.intレイアウト = 1 ) { //   シングル
                        if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                            XEAKI = Abs(Ymax - Ymin) / 10 //10
                        } else {
                            XEAKI = Abs(Ymax - Ymin) / 10 //12
                        }
                    } else {
                        if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                            XEAKI = Abs(Ymax - Ymin) / 10 //12
                        } else {
                            XEAKI = Abs(Ymax - Ymin) / 10 //15
                        }
                    }
                }
            }
            //
            var N99 As Integer //////12/12/15
            N99 = 0
            var L99 As Single //////09/12/25
            L99 = 0
            JX_max = -99999
            JX_min = 99999
            JY_max = -99999: YY_max = -99999: YU_max = -99999
            YY_min = 99999: YY_基礎 = 99999 //////08/08/21
            JY_min = 99999
            XXYY(1) = -999999
            XXYY(2) = 999999
            XXYY(3) = -999999
            XXYY(4) = 999999
            柱間離れ(1) = 99999 //////////// Min
            柱間離れ(2) = -99999 ////////// Max
            d垂直(1) = 99999 ////////////////09/10/22
            d垂直(2) = -99999
            UEHOSEI = 0
            KUIAKI = 0
            k杭長 = 0
            F杭長 = 0
            For( i = 1 To 部材_max
                if ( ZZBuzaiBai(i) != 0 ) {
                i1 = 部I(i)
                I2 = 部J(i)
                X1 = 節X(i1)
                y1 = 節Y(i1)
                X2 = 節X(I2)
                Y2 = 節Y(I2)
                LX = X2 - X1
                LY = Y2 - y1
                LL = Sqr(LX ^ 2 + LY ^ 2)
                L99 = max(L99, LL) ////////////////09/12/25
                //
                if ( (y1 + Y2) / 2 = 水平部材最上端 ) { //////12/12/15  if ( 水平部材最上端 != 水平部材最下端 ) { //////10/01/18
                    N99 = N99 + 1
                }
                UEAKI = 0
                杭図倍率 = 1
                if ( CASN < 0 ) {
                    杭図倍率 = ZZBuzaiBai(i)
                } else {
            //            if ( RR橋脚 = 2 $$ InStr(部材名(i), "杭") = 0 || Not M杭mod ) { //////////06/03/08
            //                杭図倍率 = 1
            //            } else {
            //                if ( RR橋脚 = 2 ) {
            //                   杭図倍率 = ZZBuzaiBai(i)
            //                } else {
            //                    杭図倍率 = ZZBuzaiBai(i)
            //                }
            //            }
                    杭図倍率 = ZZBuzaiBai(i)
                }
                if ( InStr(部材名(i), "杭") = 1 $$ M杭mod ) {
                   if ( 杭図倍率 != 0 ) { F杭長 = max(F杭長, (節Y(i1) - 節Y(I2)) / 杭図倍率) //////////05/02/23
                }
                KOBI = 0
                if ( X1 = X2 ) {
                    KOBI = 1
                } else {
                    KOBI = Abs((y1 - Y2) / (X1 - X2))
                    if ( KOBI < 0.1 ) {
                        KOBI = 0
                    }
                }
                UEAKI = (1 - Sgn(KOBI)) * XEAKI * 1 //0.55 //(1.3 - 杭図倍率) ^ 0.5
                if ( UEHOSEI < UEAKI ) {
                    UEHOSEI = UEAKI
                }
            //        if ( 杭図倍率 != 1 ) {
            //            if ( 節点部材数(i2) = 1 ) {
            //                節X(i2) = X1 + 杭図倍率 * LX
            //                節Y(i2) = y1 + 杭図倍率 * LY
            //            } else {
            //                if ( 節点部材数(i1) = 1 ) {
            //                    節X(i1) = X2 - 杭図倍率 * LX
            //                    節Y(i1) = Y2 - 杭図倍率 * LY
            //                }
            //            }
            //        }
                if ( InStr(部材名(i), "杭") = 1 $$ M杭mod ) {
                    if ( X1 != X2 ) {
                       UEAKI = XXMAX / 10
                    }
                }
                LLX = 0
                LLY = 0
                if ( KOBI != 0 ) {
            //            if ( CASN < 0 ) { ////////////////////////// 05/02/26
            //            LLX = KOBI * min(max(Abs(Xmax - Xmin), Abs(Ymax - Ymin)) / 5, 10) ////////// 05/01/29
            //            } else {
            //            LLY = KOBI * min(Abs(Xmax - Xmin) / 5, 5) ////////// 05/01/29
            //    水平部材最上端 = -99999
            //    水平部材最下端 = 99999 //////////09/10/14
                    if ( KUI数 > 0 $$ CASN < 0 ) {
                        LLX = max(LL / 5, min(Abs(Ymax - Ymin - mm杭長) / 2, 5))
                    } else {
                        LLX = max(LL / 5, min(Abs(Ymax - Ymin) / 5, 5))  ////////// 05/05/05
                    }
            //            }
                        if ( (X1 = X2 $$ (InStr(部材名(i), "柱") != 0 || _
                            InStr(部材名(i), "体") != 0) || _
                            InStr(部材名(i), "側壁") != 0 || _
                            InStr(部材名(i), "縦") != 0) $$ LL > 0.1 _
                        ) { ////////10/01/14

                          柱間離れ(1) = min(柱間離れ(1), (X1 + X2) / 2) //////////// Min
                          柱間離れ(2) = max(柱間離れ(2), (X1 + X2) / 2) //////////// Max
                        }
                        if ( (X1 = X2 $$ InStr(部材名(i), "杭") != 0) ) { //////09/10/22
                          d垂直(1) = min(d垂直(1), (X1 + X2) / 2) //////////// Min
                          d垂直(2) = max(d垂直(2), (X1 + X2) / 2) //////////// Max
                        }
            //          if ( Abs(y1 - Y2) > 0 ) { //////09/10/20
            //                if ( (Abs(X1 - X2) / Abs(y1 - Y2) > 0.6) || (X1 = X2 $$ InStr(部材名(i), "柱") != 0) ) {
            //                  柱間離れ(1) = min(柱間離れ(1), (X1 + X2) / 2) //////////// Min
            //                  柱間離れ(2) = max(柱間離れ(2), (X1 + X2) / 2) //////////// Max
            //                }
            //          }
                } else {
            //            LLX = min(Abs(Ymax - Ymin) / 5, 5) ////////// 05/01/29
                    LLY = max(LL / 5, min(Abs(Xmax - Xmin) / 10, 3))  ////////// 05/05/05
                    if ( LLY > 3 ) { LLY = 3 //////08/01/21
                }
                //
                if ( JX_max < 節X(i1) + LLX ) { JX_max = 節X(i1) + LLX
                if ( XXYY(1) < 節X(i1) ) { XXYY(1) = 節X(i1)
                //
                if ( JX_min > 節X(i1) - LLX ) { JX_min = 節X(i1) - LLX
                if ( XXYY(2) > 節X(i1) ) { XXYY(2) = 節X(i1)
                //
                if ( JX_max < 節X(I2) + LLX ) { JX_max = 節X(I2) + LLX
                if ( XXYY(1) < 節X(I2) ) { XXYY(1) = 節X(I2)
                //
                if ( JX_min > 節X(I2) - LLX ) { JX_min = 節X(I2) - LLX
                if ( XXYY(2) > 節X(I2) ) { XXYY(2) = 節X(I2)
                //
                if ( X1 = X2 ) { ////////14/09/27
                    if ( XXYY(3) < 節X(i1) ) { XXYY(3) = 節X(i1)
                    if ( XXYY(4) > 節X(i1) ) { XXYY(4) = 節X(i1)
                }

                if ( (FR橋脚 = 2 $$ InStr(部材名(i), "剛") $$ InStr(部材名(i), "柱")) ) {
                } else {
            //            if ( JY_max < 節Y(i1) + UEAKI ) { ////////// 05/05/05
            //                JY_max = 節Y(i1) + UEAKI
            //            }
            //            if ( JY_min > 節Y(i1) - UEAKI * 1.2 ) {
            //                JY_min = 節Y(i1) - UEAKI * 1.2
            //            }
            //            if ( JY_max < 節Y(i2) + UEAKI ) {
            //                JY_max = 節Y(i2) + UEAKI
            //            }
            //            if ( JY_min > 節Y(i2) - UEAKI * 1.2 ) {
            //                JY_min = 節Y(i2) - UEAKI * 1.2
            //            }
                if ( g連続Mod ) { //////////////// 05/05/05
                    LLY = 0
                }
                    if ( JY_max < 節Y(i1) + LLY ) { ////////// 05/05/05
                        JY_max = 節Y(i1) + LLY
                    }
                    if ( JY_min > 節Y(i1) - LLY ) {
                        JY_min = 節Y(i1) - LLY
                    }
                    if ( JY_max < 節Y(I2) + LLY ) {
                        JY_max = 節Y(I2) + LLY
                    }
                    if ( JY_min > 節Y(I2) - LLY ) {
                        JY_min = 節Y(I2) - LLY
                    }
                }
                if ( InStr(部材名(i), "杭") = 1 $$ M杭mod ) {
                    if ( 杭図倍率 != 0 ) { k杭長 = max(k杭長, (節Y(i1) - 節Y(I2))) // / 杭図倍率 //////////05/02/23
                }
                }
                if ( X1 = X2 ) {
                    if ( (X1 < Xmin + Abs(Xmax - Xmin) / 2 - Abs(Xmax - Xmin) / 12) || (X1 > Xmin + Abs(Xmax - Xmin) / 2 + Abs(Xmax - Xmin) / 12) ) {
                    } else {
                        垂直中央 = 1
                    }
                }
                if ( YU_max < 節Y(i1) ) { YU_max = 節Y(i1)
                if ( YU_max < 節Y(I2) ) { YU_max = 節Y(I2)
                if ( 節X(i1) != 節X(I2) ) {
                    if ( YY_max < 節Y(i1) ) { YY_max = 節Y(i1)
                    if ( YY_max < 節Y(I2) ) { YY_max = 節Y(I2)
                    if ( YY_基礎 > 節Y(I2) ) { YY_基礎 = 節Y(I2) ////////08/08/21 最下端の水平部材
                    K水平部材高 = max(K水平部材高, 節Y(i1)) ////////////08/11/17
                    K水平部材高 = max(K水平部材高, 節Y(I2))
                }
                if ( InStr(部材名(i), "杭") = 0 || Not M杭mod || 部材_max = 1 ) { //////09/12/09
                    if ( YY_min > 節Y(i1) ) { YY_min = 節Y(i1)
                    if ( YY_min > 節Y(I2) ) { YY_min = 節Y(I2)
                }
            }

            if ( 柱間離れ(1) = 99999 ) { 柱間離れ(1) = 0 //d垂直(1) ////////13/04/01
            if ( 柱間離れ(2) = -99999 ) { 柱間離れ(2) = 0 //d垂直(2) - 1
            var 部材総延長 As Single //////10/03/27
            部材総延長 = 0
            if ( Not g連続Mod $$ iKozo = 3 $$ CASN >= 0 ) { ////////09/12/25
                For( i = 1 To 部材_max
                    if ( ZZBuzaiBai(i) != 0 ) {
                        i1 = 部I(i)
                        I2 = 部J(i)
                        X1 = 節X(i1)
                        y1 = 節Y(i1)
                        X2 = 節X(I2)
                        Y2 = 節Y(I2)
                        LX = X2 - X1
                        LY = Y2 - y1
                        LL = Sqr(LX ^ 2 + LY ^ 2)
                        部材総延長 = 部材総延長 + LL //////10/03/27
                        KOBI = 0
                        if ( X1 = X2 ) {
                            KOBI = 1
                        } else {
                            KOBI = Abs((y1 - Y2) / (X1 - X2))
                            if ( KOBI < 0.1 ) {
                                KOBI = 0
                            }
                        }
                        LLX = 0
                        LLY = 0
                        if ( KOBI = 0 ) {
                            LLX = max(L99 / 4, min(Abs(Xmax - Xmin) / 5, 5))
                        } else {
                            LLX = max(L99 / 4, min(Abs(Ymax - Ymin) / 5, 5))
                        }
                        if ( JX_max < 節X(i1) + LLX ) { JX_max = 節X(i1) + LLX
                        if ( JX_min > 節X(i1) - LLX ) { JX_min = 節X(i1) - LLX
                    }
                }
            } ////////09/12/25
            //
            if ( d垂直(1) = 99999 ) { ////////////////09/10/22
                if ( 柱間離れ(1) = 99999 ) {
                    d垂直(1) = JX_min
                    d垂直(2) = JX_max
                } else {
                    d垂直(1) = 柱間離れ(1)
                    d垂直(2) = 柱間離れ(2)
                }
            }
            if ( d垂直(1) > 柱間離れ(1) ) { d垂直(1) = 柱間離れ(1)
            if ( d垂直(2) < 柱間離れ(2) ) { d垂直(2) = 柱間離れ(2)
            ////////////////////////////////////////////////////////////////////////////////////////////////// 05/01/31
            if ( iKozo = 2 $$ YY_max * 0.9 < K水平部材高 ) {
                if ( YY_max - K水平部材高 > 0.1 ) { //////09/02/20
                    iKozo = 1
                    FR橋脚 = 1
                    RR橋脚 = 1
                } else {
            //            iKozo = 1
            //            FR橋脚 = 1
                    if ( NKUI = 0 ) { RR橋脚 = 1 //////09/02/20
                }
            }
            if ( (JX_max - JX_min) != 0 $$ iKozo != 1 ) { ////////09/03/25//////And FR橋脚 != 2 $$ iKozo != 1 ) {
                if ( Abs(JY_max - JY_min) / Abs(JX_max - JX_min) <= 0.1 ) {
                    g連続Mod = True ////////////////////連続梁
                    iKozo = 3 ////////////////////////////////////////////////////////////////07/05/13
                    JX_max = XXYY(1) * 1.05
                    JX_min = XXYY(2) - XXYY(1) * 0.05
                }
                if ( 荷重文字サイズ > 8.4 ) { //////////// 05/02/16
                    荷重文字サイズ = 8.4
                }
            }
            //            if ( g連続Mod = False $$ iKozo = 1 $$ NKUI = 0 $$ Abs(YY_max - YY_min) > 2 ) {
            ////                iKozo = 3 //////////////// 05/05/28
            //            }
            //            if ( g連続Mod = False $$ iKozo = 3 $$ NKUI = 0 $$ Abs(YY_max - YY_min) <= 1.5 ) {
            ////                iKozo = 1 //////////////// 05/05/30
            //            }
            //////13/10/15
            //////    if ( FR橋脚 = 1 $$ g連続Mod = False $$ iKozo = 1 $$ NKUI = 0 $$ y最低CUNT = N99 ) { //////12/12/15
            //////        iKozo = 3
            //////    }
            //
            柱剛域長 = IIf(FR橋脚 = 2, 節Y(1) - JY_max, 0)
            YMin杭無 = max((JY_max - YMin杭無) / 1.5, 0.5) ////////IIf(階段Mod, 1, 1.5), 0.5) ////////13/04/08//////構造寸法表示ギャップ 04/04/28 nagase
            //    YMin杭無 = max((YY_max - YY_min) / 2, 0.5)
            //////////////////////////////////////////////////////////////////// 05/02/07
            var Da1() As Integer
            var NN1                     As Integer
            if ( CASN >= 0 ) {
                 this.Da1(Jn_max)
                 JouhouSunpouCalcFlag = 1
            //         this.varPointSelect_Kairyou(1, Jn_max, 節X0(), 節Y0(), 部材_max, 部I(), 部J(), NN1, Da1(), ZZBuzaiBai(), YMin杭無, 1, iKozo)
            //         MQM = 0
            //         For( i = 1 To NN1 - 1
            //             M = 0
            //             Do
            //                 M = M + 1
            //                 if ( M > 部材_max ) { Exit Do
            //                 if ( 部I(M) = Da1(i) $$ 部J(M) = Da1(i + 1) ) {
            //                     MQM = MQM + 1
            //                     上層Buzai(MQM) = M
            //                     Exit Do
            //                 }
            //             Loop
            //        Next
            var Y5_max                  As Single
            var Y5_min                  As Single
                Y5_max = -9999
                Y5_min = 9999
                z上層両X座標(1) = 9999 ////////10/10/13
                z上層両X座標(2) = -9999
                MQM = 0
                    For( i = 1 To 部材_max //////////////////////////////////////// 08/01/04
                        if ( 節X0(部I(i)) != 節X0(部J(i)) ) {
                            if ( Y5_max < 節Y0(部I(i)) ) { Y5_max = 節Y0(部I(i))
                            if ( Y5_min > 節Y0(部I(i)) ) { Y5_min = 節Y0(部I(i))
                            if ( Y5_max < 節Y0(部J(i)) ) { Y5_max = 節Y0(部J(i))
                            if ( Y5_min > 節Y0(部J(i)) ) { Y5_min = 節Y0(部J(i))
                        }
                    Next

                    For( i = 1 To 部材_max
                        if ( 節X0(部I(i)) != 節X0(部J(i)) $$ Y5_max - (Y5_max - Y5_min) / 4 <= 節Y0(部I(i)) ) { ////////14/12/13
            //                if ( 節X0(部I(i)) != 節X0(部J(i)) $$ Y5_max - (Y5_max - Y5_min) / 10 <= 節Y0(部I(i)) ) {
                            MQM = MQM + 1
                            上層Buzai(MQM) = i
                            z上層両X座標(1) = min(z上層両X座標(1), 節X0(部I(i))) ////////10/10/13
                            z上層両X座標(2) = max(z上層両X座標(2), 節X0(部J(i)))
                            //
                            上層斜めBuzaiV(i) = Y5_max - max(節Y0(部I(i)), 節Y0(部J(i))) ////////14/12/13
                        }
                    Next
                    For( i = 1 To MQM ////////////09/10/28
                        if ( 上層Buzai(i) = 下層BUZAI(i, 1) ) {
                             下層BUZAI(i, 1) = 0
                        }
                    }
            }
            //////////////////////////////////////////////////////////////////// 05/02/07
            Y13 = 0
            上空き = 0
            if ( 横スケール != 0 ) {
                JX_max = XXYY(1)
                JX_min = XXYY(2)
            }
            if ( g連続Mod ) {
                if ( 荷重図フォーマット.int用紙サイズ = 1 $$ 荷重図フォーマット.int用紙方向 = 1 ) { //// A3 の 横
            //            LLX = LLX * 1.3
                } else {
            //            LLX = LLX * 1.1
                }
            }
            LLX = JX_max - JX_min
            LLY = JY_max - JY_min + Y13 + 柱剛域長
            if ( Not g連続Mod $$ iKozo = 3 $$ JY_max != JY_min $$ 部材_max > 30 $$ CASN >= 0 ) { //////13/04/23
                LLY = YY_max - YY_min + (JY_max - YY_max)
            }
            //
            if ( (XXYY(1) - XXYY(2)) != 0 $$ Not (柱間離れ(1) + 柱間離れ(2) = 0) ) { //////10/02/08////////////13/04/08
                if ( Abs(柱間離れ(1)) != 99999 $$ 柱間離れ(1) >= XXYY(2) ) {
                    if ( ((柱間離れ(1) - JX_min) / (XXYY(1) - XXYY(2))) > 0.3 ) {
            //            LLX = LLX - max((柱間離れ(1) - XXYY(2)) / 2.5, 0)//////13/04/08
                    } else {
                    LLX = LLX + max((柱間離れ(1) - XXYY(2)) / 2.5, 0)
                    }
                }
                if ( (Abs(柱間離れ(2)) != 99999 $$ 柱間離れ(2)) <= XXYY(1) ) {
                    if ( ((XXYY(1) - 柱間離れ(2)) / (XXYY(1) - XXYY(2))) > 0.3 ) {
            //                LLX = LLX - max((XXYY(1) - 柱間離れ(2)) / 2.5, 0)//////13/04/08
                    } else {
                        LLX = LLX + max((XXYY(1) - 柱間離れ(2)) / 2.5, 0) //////13/04/08
                    }
                }
            }
            //////////////////////////////////////////////////17/08/14
            if ( (Abs(柱間離れ(1) - 柱間離れ(2)) < 0.001 $$ Abs(水平部材最上端 - 水平部材最下端) < 0.001 $$ YY_max * 0.9 < 水平部材最下端) ) {
            //        水平部材最下端 = 99999
            }
            if ( (Abs(柱間離れ(1) - 柱間離れ(2)) < 0.001 $$ Abs(水平部材最上端 - 水平部材最下端) < 0.001 _
                               $$ JY_max * 0.9 > 水平部材最下端) ) {
                iKozo = 2 ////////////////////////17/03/12
                FR橋脚 = 2
                RR橋脚 = 2
                水平部材最上端 = -99999 //////////17/08/14
            } else {
                if ( g連続Mod = False ) {
                    iKozo = 1 ////////////////////////17/08/14
                    FR橋脚 = 1
                    RR橋脚 = 1
                }
            }
            //
            if ( g背割れ = 1 ) {
                LLX = LLX * 1.8
            }
            XXMAX = LLX
            ZZMAX = LLY
            UEAKI = 0
            if ( CASN < 0 ) { //////////////////////////////////縮尺セット
                if ( 横スケール != 0 ) {
                    図X_SCALE = 横スケール: UEAKI = 1
                } else {
                    図X_SCALE = LLX / 図横幅 * IIf(g連続Mod, 0.85, 1)   ////////// 05/01/29
                    if ( iKozo = 2 ) {
                        図X_SCALE = LLX / 図横幅 * 1.4
                    }
                    if ( Not g連続Mod $$ iKozo = 3 $$ JY_max != JY_min ) {
                        図X_SCALE = 図X_SCALE * 0.9 //////12/12/15//////// * 1.15 //////////////////05/03/04
                        if ( 部材_max < 6 $$ ((JY_max - JY_min) / (JX_max - JX_min)) > 0.5 ) { //////13/08/08
                            図X_SCALE = 図X_SCALE * 1.3 //////13/08/08
                        }
            //            } else {if ( g連続Mod ) {
            //                図X_SCALE = 図X_SCALE * 0.9
                    }
                }
                if ( 縦スケール != 0 ) {
                    図Y_SCALE = 縦スケール: UEAKI = UEAKI + 2
                } else {
                    図Y_SCALE = LLY / 図縦幅 * 1.25
                    if ( iKozo = 3 $$ 階段Mod = False $$ NKUI = 0 $$ (水平部材最上端 - 水平部材最下端) < LLY ) {
                        図Y_SCALE = (((水平部材最上端 - 水平部材最下端) + LLY * 4) / 5) / 図縦幅 ////////13/04/18
                    }
                    if ( FR橋脚 = 2 ) {
                        if ( NKUI = 0 ) {
                        図Y_SCALE = 図Y_SCALE * 1.35 //1.5
                        } else {
                        図Y_SCALE = 図Y_SCALE * 0.8
                        }
                    } else {
                        if ( 荷重図フォーマット.int用紙方向 = 1 $$ 荷重図フォーマット.int用紙サイズ = 1 $$ 横スケール = 0 ) { //And iKozo = 1 ) {
                            図X_SCALE = 図X_SCALE * 1.2 ////// A3
                        }
                    }
                }
                if ( 図X_SCALE = 0 ) {
                    図X_SCALE = 図Y_SCALE
                }
                if ( 図Y_SCALE = 0 ) {
                    図Y_SCALE = 図X_SCALE
                }
                if ( Not g連続Mod $$ iKozo = 3 $$ JY_max != JY_min ) {
                    if ( 図X_SCALE < 図Y_SCALE ) {
                        if ( 横スケール = 0 ) { 図X_SCALE = 図Y_SCALE
                    } else {
                        if ( 縦スケール = 0 ) { 図Y_SCALE = 図X_SCALE
                    }
                    if ( 横スケール + 縦スケール = 0 $$ NKUI = 0 $$ 部材_max > 40 $$ g柱本数 < 2 ) { //////10/03/07 多分ｱｰﾁ
                        図X_SCALE = 図X_SCALE * 0.95
                        図Y_SCALE = 図Y_SCALE * 0.95
                    }
                }
            } else {
                if ( 部材_max < 3 ) { ////////////////////06/05/24
                    k杭長 = 0
                    F杭長 = 0
                }
                if ( 横スケール != 0 ) {
                   図X_SCALE = 横スケール: UEAKI = 1
                } else {
                    if ( (g連続Mod = False $$ iKozo = 3 $$ JY_max != JY_min $$ 部材_max > 40 $$ CASN >= 0) ) { //////13/04/24
                        図X_SCALE = LLX / 図横幅 * 0.8
                    } else {
                        図X_SCALE = LLX / 図横幅 * IIf(g連続Mod || 階段Mod, 0.85, IIf(iKozo = 1, 0.85, 1))
                        if ( FR橋脚 = 2 || iKozo = 2 ) { //////// 09/03/25
            //                     if ( CASN = 0 ) {
            //                        図X_SCALE = 図X_SCALE * 1.2 //////1.35
            //                     } else {
            //                        図X_SCALE = 図X_SCALE * 1.2
            //                     }
                             図X_SCALE = LLX / 図横幅 * 1.4
                        } else {
                            if ( 荷重図フォーマット.int用紙方向 = 1 $$ 荷重図フォーマット.int用紙サイズ = 1 ) { //And iKozo = 1 ) {
                                図X_SCALE = 図X_SCALE * IIf(g連続Mod, 1.35, 1.2) ////// A3  13/04/08
                            }
                        }
                        if ( Not g連続Mod $$ iKozo = 3 $$ JY_max != JY_min ) {
                            if ( 柱間離れ(1) = XXYY(2) $$ 柱間離れ(2) = XXYY(1) ) { //////09/12/25 張り出しがなければ
                            if ( Not (g連続Mod = False $$ iKozo = 3 $$ JY_max != JY_min $$ 部材_max > 30 $$ CASN >= 0) ) { //////13/04/23
                                図X_SCALE = 図X_SCALE * 0.9 //////1.15 //////////////////05/03/04  08/09/15//////09/12/25
                            }
                            }
                            UEHOSEI = UEHOSEI / 2 //////////08/09/15
                        } else {if ( g連続Mod ) {
            //                    図X_SCALE = 図X_SCALE * 0.9
                        }
                    }
                }
                //
                if ( 縦スケール != 0 ) {
                    図Y_SCALE = 縦スケール: UEAKI = UEAKI + 2
                } else {
                    if ( (g連続Mod = False $$ iKozo = 3 $$ JY_max != JY_min $$ 部材_max > 40 $$ CASN >= 0) ) { //////13/04/24
                        図Y_SCALE = LLY / 図縦幅 * 0.8
                        if ( iKozo = 3 $$ 階段Mod = False $$ NKUI = 0 $$ (水平部材最上端 - 水平部材最下端) < LLY ) {
                            図Y_SCALE = (((水平部材最上端 - 水平部材最下端) + LLY * 4) / 5) / 図縦幅
                        }
                    } else {
                        if ( FR橋脚 = 1 || FR橋脚 != 1 ) { ////////////////////09/03/25
                            if ( Xmax = Xmin ) { //////////////////08/01/07
                                図Y_SCALE = LLY / min((図縦幅 - UEHOSEI), (図縦幅 / 1.8)) ////////08/01/07
                            } else {
                                図Y_SCALE = LLY / (図縦幅 - UEHOSEI)
                            }
                            if ( iKozo = 3 $$ 階段Mod = False $$ NKUI = 0 $$ (水平部材最上端 - 水平部材最下端) < LLY ) {
                                図Y_SCALE = (((水平部材最上端 - 水平部材最下端) + LLY * 3) / 4) / 図縦幅 // * 1.2 ////////13/04/18
                            }
                            if ( (荷重図フォーマット.int用紙方向 = 1) ) { // $$ 荷重図フォーマット.intレイアウト = 0) ) {
                            if ( Not (g連続Mod = False $$ iKozo = 3 $$ JY_max != JY_min $$ 部材_max > 30 $$ CASN >= 0) ) { //////13/04/23
                                図Y_SCALE = 図Y_SCALE * 1.3
                            }
                            }
                        } else {
                            図Y_SCALE = (LLY - 柱剛域長 * 0.1) / (図縦幅 - UEHOSEI)
                            if ( CASN > 0 ) {
                                図Y_SCALE = 図Y_SCALE * 1.2
                            } else {
            //                    図Y_SCALE = 図Y_SCALE * 1.15
                                if ( RR橋脚 = 2 ) { //////////////////////////////////09/02/20
                                    図Y_SCALE = 図Y_SCALE * 1.15
                                }
                            }
                            if ( NKUI = 0 ) {
                                図Y_SCALE = 図Y_SCALE * 1.15
                            }
                        }
                    }
            //////09/03/25
                    if ( (FR橋脚 = 1 || FR橋脚 != 1) $$ 部材_max > 16 $$ NKUI = 0 $$ iKozo != 3 ) { ////////// 05/01/29 <  08/09/15iKozo != 3
                        if ( 縦スケール = 0 ) { 図Y_SCALE = 図Y_SCALE * 1.15
                    }
                    if ( FR橋脚 = 2 ) { ////////09/03/25
            //                if ( NKUI = 0 ) {
            //                    if ( 縦スケール = 0 $$ RR橋脚 = 2 ) { 図Y_SCALE = 図Y_SCALE * 1.5 ////////09/02/20 $$ RR橋脚 = 2
            //                } else {
            //                    if ( 縦スケール = 0 ) { 図Y_SCALE = 図Y_SCALE * 1#
            //                }
                    }
                    if ( 荷重図フォーマット.int用紙方向 = 1 $$ 荷重図フォーマット.int用紙サイズ = 1 $$ iKozo = 1 ) {
                        if ( 横スケール = 0 ) { 図X_SCALE = 図X_SCALE * 1.2 ////// A3
                    }
                }
                if ( 図X_SCALE = 0 ) {
                    図X_SCALE = 図Y_SCALE
                }
                if ( 図Y_SCALE = 0 ) {
                    図Y_SCALE = 図X_SCALE
                }
                if ( Not g連続Mod $$ iKozo = 3 $$ JY_max != JY_min ) { //////10/03/07
            //            if ( 横スケール + 縦スケール = 0 $$ NKUI = 0 $$ 部材_max > 40 $$ g柱本数 < 2 ) { //////10/03/07 多分ｱｰﾁ
            //                図X_SCALE = 図X_SCALE * 1.12
            //                図Y_SCALE = 図Y_SCALE * 1.12
            //            }
                //////10/03/07 多分ｱｰﾁ
                    if ( 部材_max > 20 $$ g柱本数 < 5 $$ 部材総延長 > 0 $$ (部材総延長 / 部材_max) < 1.8 ) {   //////10/03/27////13/04/08
                        アーチBOX = True //////10/03/27
                        図X_SCALE = 図X_SCALE * 1.12
                        図Y_SCALE = 図Y_SCALE * 1.12
                        階段Mod = False //////13/04/08
                    }
                }
            }
            //    UEAKI = 0
            //    if ( CASN < 0 ) {
            //        if ( 縦スケール != 0 ) {
            ////            UEAKI = 1
            //        } else {
            //            if ( 図X_SCALE = 0 ) {
            //                図X_SCALE = 図Y_SCALE
            //            }
            //        }
            //    } else {
            //        if ( 縦スケール != 0 ) {
            ////            UEAKI = 1
            //        } else {
            //            if ( 図Y_SCALE = 0 ) {
            //                図Y_SCALE = 図X_SCALE
            //            }
            //        }
            //    }
            if ( 図X_SCALE = 0 ) {
                図X_SCALE = 1
            }
            if ( 図Y_SCALE = 0 ) {
                図Y_SCALE = 1
            }
            //    if ( NKUI = 0 || iKozo = 3 ) { //////// 04/12/07
                if ( Not g連続Mod $$ ((図X_SCALE / 図Y_SCALE) > 1.5 || (図Y_SCALE / 図X_SCALE) > 1.5) ) {
                    Select Case UEAKI
                        Case 0
                                if ( 図X_SCALE < 図Y_SCALE ) { //////////    05/06/02
                                    if ( 横スケール = 0 ) {
                                        図X_SCALE = 図Y_SCALE / ((図Y_SCALE / 図X_SCALE) ^ 0.8) //////// / 1.5    05/06/02
                                    }
                                } else {
                                    if ( 縦スケール = 0 ) {
                                        if ( CASN >= 0 $$ iKozo = 3 ) { //////And (荷重図フォーマット.intレイアウト = 2 || 階段Mod) ) {
                                            図Y_SCALE = 図X_SCALE / ((図X_SCALE / 図Y_SCALE) ^ 0.4)
                                        } else {
                                            図Y_SCALE = 図X_SCALE / ((図X_SCALE / 図Y_SCALE) ^ 0.8)
                                        }
                                        if ( (図X_SCALE / 図Y_SCALE) > 1.5 $$ 部材_max < 3 ) { ////////////07/10/27
                                            図Y_SCALE = 図X_SCALE / 1.2
                                        }
                                    }
                                }
                        Case 1
                                if ( 図X_SCALE > 図Y_SCALE ) {
                                    if ( 縦スケール = 0 ) { 図Y_SCALE = 図X_SCALE / ((図X_SCALE / 図Y_SCALE) ^ 0.8)
                                }
                        Case 2
                                if ( 図X_SCALE < 図Y_SCALE ) {
                                    if ( 横スケール = 0 ) { 図X_SCALE = 図Y_SCALE / ((図Y_SCALE / 図X_SCALE) ^ 0.8)
                                }
                        Case } else {
                    End Select
                }
            if ( 横スケール = 0 $$ 縦スケール = 0 $$ iKozo != 3 ) { ////////////08/04/28
            if ( Not g連続Mod $$ h != 0 ) { ////////05/05/18
                if ( ((iKozo = 1 || iKozo = 2) $$ CASN >= 0 $$ NKUI != 0 $$ (YYMAX / h) > 0.5 $$ _
                             荷重図フォーマット.int用紙方向 = 0) ) { ////// $$ 荷重図フォーマット.intレイアウト = 1) ) {
                   if ( 荷重図フォーマット.intレイアウト = 2 ) { //////////07/11/03
                        図Y_SCALE = 図Y_SCALE * 1.1
                   } else {
                        図Y_SCALE = 図Y_SCALE * 1.1
                   }
                } else {
                   if ( iKozo = 3 $$ NKUI = 0 $$ 部材_max < 5 ) { ////////////// 05/05/27
                        図X_SCALE = 図X_SCALE * 1.2
                        図Y_SCALE = 図Y_SCALE * 1.2
                   }
                }
            } else {
                if ( iKozo = 3 $$ NKUI = 0 ) { ////////////// 05/05/27
                     図X_SCALE = 図X_SCALE * 1.15
                     図Y_SCALE = 図Y_SCALE * 1.15
                } else {if ( iKozo = 1 $$ 部材_max <= 6 $$ NKUI = 0 $$ Ymax != Ymin $$ Xmax != Xmin ) {  ////////////// 06/03/31
                     図X_SCALE = 図X_SCALE * 1.25
                     図Y_SCALE = 図Y_SCALE * 1.25
                }
            }
            } else {if ( iKozo = 3 $$ 図X_SCALE != 図Y_SCALE $$ 横スケール = 0 $$ 縦スケール = 0 ) { ////////////08/04/28
            if ( 図X_SCALE < 図Y_SCALE ) {
                図X_SCALE = 図Y_SCALE
            } else {
                if ( (荷重図フォーマット.intレイアウト = 3) ) {
                    図Y_SCALE = 図X_SCALE / 1.2
                } else {if ( (荷重図フォーマット.intレイアウト = 4) ) {
                    図Y_SCALE = 図X_SCALE
                }
            }
            }
            if ( CASN >= 0 $$ 横スケール = 0 $$ 縦スケール = 0 $$ _
            荷重図フォーマット.int用紙サイズ = 1 $$ iKozo = 3 ) { ////////08/09/15 $$ 部材_max > 30
            図X_SCALE = 図X_SCALE / 1.15
            図Y_SCALE = 図Y_SCALE / 1.15
            }
            if ( (JX_max - JX_min) > 0 ) {
            if ( CASN < 0 $$ 横スケール = 0 $$ 縦スケール = 0 $$ ((JY_max - JY_min) / (JX_max - JX_min)) > 2 ) {
                図X_SCALE = 図X_SCALE / 1.25
                図Y_SCALE = 図Y_SCALE / 1.25
            }
            }
            //     }
            //        if ( (JY_min = JY_max) ) {
            //            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
            //            図Y_SCALE = 0.0033
            //            } else {
            //            図Y_SCALE = 0.002
            //            }
            //        }

            SSS = CASN
            if ( RR橋脚 = 2 $$ CASN = 0 $$ NKUI = 0 ) {
                SSS = -1
            }
            Select Case SSS
            Case Is < 0 //－－－－－－－－ 骨組図
            //        if ( 荷重図フォーマット.sng骨組位置補正X = csngNull ) {
                    if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                        XEAKI = -10
                    } else {
                        XEAKI = 3 - 4
                    }
            //        } else {
            //            XEAKI = 荷重図フォーマット.sng骨組位置補正X
            //        }
            //        if ( 荷重図フォーマット.sng骨組位置補正Y = csngNull ) {
                    if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                        YEAKI = 5
                        if ( FR橋脚 = 2 ) {
                            YEAKI = YEAKI / 2
                        }
                    } else {
                        YEAKI = 0
                    }
            //        } else {
            //           YEAKI = -荷重図フォーマット.sng骨組位置補正Y
            //           UEHOSEI = 0
            //        }
                if ( RR橋脚 = 2 ) {
            //            図X_SCALE = 図X_SCALE * 1.2
            //            図Y_SCALE = 図Y_SCALE * 1.2
                }
                if ( NKUI = 0 $$ iKozo != 3 ) {
                    UEAKI = 図Y_SCALE / 図X_SCALE
                    if ( 図X_SCALE / 図Y_SCALE > 1.5 || 図Y_SCALE / 図X_SCALE > 1.5 ) {
                        if ( 図X_SCALE < 図Y_SCALE ) {
                            if ( 横スケール = 0 ) { 図X_SCALE = 図X_SCALE * Sqr(UEAKI)
                        } else {
                            if ( 縦スケール = 0 ) { 図Y_SCALE = 図Y_SCALE * Sqr(1 / UEAKI)
                        }
                    }
                }
                if ( RR橋脚 = 2 $$ CASN = 0 $$ NKUI = 0 $$ iKozo != 3 ) { //////////////////02/08/22
                    if ( LLY = 0 ) { LLY = 1 ////////////// 20/01/10 FarameG荷重図について #6 sasa
                    CENTER_Y = (枠縦幅 - 40) / (LLY / 図Y_SCALE)
                    if ( CENTER_Y > 1.6 ) {
                       if ( 縦スケール = 0 ) { 図Y_SCALE = 図Y_SCALE / CENTER_Y ^ 0.5
                    }
                    if ( 縦スケール = 0 ) { 図Y_SCALE = 図Y_SCALE * 1.2
                }
            Case Is = 0 //－－－－－－－－ 荷重図連続出力
                if ( 荷重図フォーマット.sng荷重位置補正X = csngNull ) {
                   XEAKI = 2
                } else {
                   XEAKI = 荷重図フォーマット.sng荷重位置補正X
                }
            //        if ( 荷重図フォーマット.sng荷重位置補正Y = csngNull ) {
                    if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                        YEAKI = 8
                    } else {
                        YEAKI = 5 //-3
            //                if ( NKUI != 0 $$ iKozo = 1 ) { YEAKI = 0
                    }
                    if ( RR橋脚 = 2 ) {
                        YEAKI = YEAKI / 2
                    }
                    if ( NKUI = 0 ) { //////////////// 11/28
                        YEAKI = YEAKI / 2
                    }
            //        } else {
            //            YEAKI = -荷重図フォーマット.sng荷重位置補正Y
            //            UEHOSEI = 0
            //        }
                if ( RR橋脚 = 2 ) { ////////09/03/25
                    UEHOSEI = -5
            //            if ( NKUI = 0 $$ iKozo != 3 ) { ////////09/03/25
                        図X_SCALE = 図X_SCALE * 0.8
                        図Y_SCALE = 図Y_SCALE * 1.05
                        CENTER_Y = 枠縦幅 - 40 - (LLY / 図Y_SCALE)
            //            }
                }
            Case } else { //－－－－－－－－ 荷重図指定出力
            //        if ( 荷重図フォーマット.sng荷重位置補正X = csngNull ) {
                    XEAKI = 3
            //        } else {
            //            XEAKI = -荷重図フォーマット.sng荷重位置補正X
            //        }
            //        if ( 荷重図フォーマット.sng荷重位置補正Y = csngNull ) {
                    YEAKI = -10 //-5
            //        } else {
            //            YEAKI = -荷重図フォーマット.sng荷重位置補正Y
            //            UEHOSEI = 0
            //        }
                if ( iKozo != 3 ) {
                    if ( 横スケール = 0 ) { 図X_SCALE = 図X_SCALE * 1.2
                    if ( 縦スケール = 0 ) { 図Y_SCALE = 図Y_SCALE * 1.4
                }
            End Select
            if ( 図X_SCALE = 0 ) {
                図X_SCALE = 図Y_SCALE
            }
            if ( 図Y_SCALE = 0 ) {
                図Y_SCALE = 図X_SCALE
            }
            if ( Not g連続Mod $$ iKozo = 3 $$ ((図X_SCALE / 図Y_SCALE) > 20 || (図Y_SCALE / 図X_SCALE) > 20) ) {
                if ( 横スケール = 0 ) { 図X_SCALE = max(図X_SCALE, 図Y_SCALE)
                if ( 縦スケール = 0 ) { 図Y_SCALE = max(図X_SCALE, 図Y_SCALE)
            }
            if ( g連続Mod $$ iKozo = 3 $$ Xmax = Xmin ) {
                if ( 横スケール = 0 ) { 図X_SCALE = max(図X_SCALE, 図Y_SCALE)
            }
            //////////////////////////////////////
            if ( CASN >= 0 $$ 荷重図フォーマット.intレイアウト = 2 ) { ////////////2段書き
            if ( (Not g連続Mod $$ iKozo = 3 $$ NKUI = 0) ) {  ////////////06/03/07
                if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
            //            if ( 横スケール = 0 ) { 図X_SCALE = max(図X_SCALE, 図Y_SCALE)
            //            if ( 縦スケール = 0 ) { 図Y_SCALE = max(図X_SCALE, 図Y_SCALE)
                } else {
                    if ( 横スケール = 0 ) { 図X_SCALE = (図X_SCALE + 図Y_SCALE) / 2
                    if ( 縦スケール = 0 ) { 図Y_SCALE = (図X_SCALE + 図Y_SCALE) / 2
                }
            }
            }

            //////////////////////////////////////
            if ( NKUI != 0 ) {
            //        if ( 荷重図フォーマット.intレイアウト = 0 ) {  ////////////ｼﾝｸﾞﾙ//////////////04/07/06
            //        KUIAKI = (JY_max - JY_min) / (図Y_SCALE * 10) / 2 * IIf(KUIAKI = 0, 1.5, 1)
            //        } else {
            //        KUIAKI = (JY_max - JY_min) / (図Y_SCALE * 10) / 20
            //        }
                if ( Abs(JY_max / JY_min) < 0.2 ) { //////10/01/30
                    KUIAKI = (JY_max - JY_min) / (図Y_SCALE * 10) / 3 * IIf(KUIAKI = 0, 2, 1) //////07/11/03
                } else {
                    KUIAKI = (JY_max - JY_min) / (図Y_SCALE * 10) / 2 * IIf(KUIAKI = 0, 2, 1) //////07/11/03
                }
                gOut部材番号 = True
            } else {
            //        KUIAKI = k杭長 * 2.5 //////////////////////////// 02/09/05    05/03/13
                if ( 荷重図フォーマット.int用紙方向 = 1 $$ KUIAKI = 0 ) {
                    if ( (JY_max - JY_min) > 1 || g連続Mod ) {
                        KUIAKI = (図縦幅 / 40)
                    } else {
                        KUIAKI = (図縦幅 / 200)
                    }
                    if ( CASN >= 0 $$ Not g連続Mod ) {
                        KUIAKI = (図縦幅 / 80)
                    }
                }
            }
            ////////////////////////////////////////////////////////////// 05/01/29
            if ( g連続Mod $$ iKozo = 3 $$ Xmax = Xmin ) {
                CENTER_X = (-図横幅) / 16
            } else {
                CENTER_X = JX_max - (JX_max - JX_min) / 2
            }
            if ( (JY_max - JY_min) != 0 ) { ////////////////////////////// 06/02/04
            if ( CASN < 0 ) {
                if ( g連続Mod ) {
                    if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                    CENTER_X = CENTER_X - 図横幅 / 800
                    } else {
                    CENTER_X = CENTER_X - 図横幅 / 100
                    }
                } else {
                if ( iKozo != 3 ) { ////////16/03/19
                    CENTER_X = CENTER_X - 図横幅 / 800
                    }
                }
            } else {
                if ( g連続Mod ) {
                    CENTER_X = CENTER_X + 図横幅 / 200 //150
                }
            }
            }
            //    if ( XXYY(1) + XXYY(2) != 0 ) { //// 05/01/29
            //////////        JX_max = XXYY(1)
            //////////        JX_min = XXYY(2)
            //    }
            if ( g連続Mod ) { //////////////// 05/01/31
                Select Case 荷重図フォーマット.intレイアウト - 1 ////////09/11/30
                    Case 2: LX = -3 //////////// シングル
                    Case 3, 5: LX = 4.3 // Case1=シングル その他を３段書き05/01/31
                    Case 4: LX = 4.5
                    Case } else {: LX = 4 //////////////////// 0=２段書き   2=シングル
                End Select
                if ( CASN < 0 ) { LX = -10
            //                if ( 荷重図フォーマット.intレイアウト = 0 ) {
            //                    EE = 2
            //                }
            //                if ( 荷重図フォーマット.intレイアウト = 1 ) {
            //                    EE = 3
            //                }
            //                if ( 荷重図フォーマット.intレイアウト = 3 ) {    // 荷重図を３段書きする場合
            //                    EE = 4
            //                }
            //                if ( 荷重図フォーマット.intレイアウト = 4 ) {    // 荷重図を４段書きする場合
            //                    EE = 5
            //                }
            //                if ( 荷重図フォーマット.intレイアウト = 5 ) {    // Case1=シングル その他を３段書き05/01/31
            //                    EE = 6
            //                }
                CENTER_Y = (JY_max + JY_min) / 2 + 図縦幅 * 図Y_SCALE / LX //4.5
            } else {
            //        if ( (g連続Mod = False $$ iKozo = 3 $$ NKUI = 0 $$ (JY_max + JY_min) < 0) ) {
            //            CENTER_Y = JY_max - (JY_max - JY_min) / 2 _
            //                    + KUIAKI / 4 - max(図縦幅 * 図Y_SCALE - (JY_max - JY_min), 0) / 5 - (JY_max + JY_min) * 100
            //        } else {
            //            CENTER_Y = JY_max - (JY_max - JY_min) / 2 _
            //                    + KUIAKI / 4 - max(図縦幅 * 図Y_SCALE - (JY_max - JY_min), 0) / 5 _
            //                    + IIf(FR橋脚 = 2, 集中荷重長さmax * 図Y_SCALE / 3, 0)
            //
                    CENTER_Y = JY_max - (JY_max - JY_min) / 2 + IIf(NKUI = 0, 0, (JY_max - JY_min) / 30) //////15/01/03
            }
                if ( 荷重図フォーマット.int用紙方向 = 1 ) { //横｡
                    CENTER_Y = CENTER_Y + (図縦幅 * 図Y_SCALE - (JY_max - JY_min) * 0.8) / IIf(荷重図フォーマット.intレイアウト = 1, 3, 5)
                } else {
                    CENTER_Y = CENTER_Y + (図縦幅 * 図Y_SCALE - (JY_max - JY_min) * 0.8) / IIf(荷重図フォーマット.intレイアウト = 1, 4, 6)
                }
            //    荷重図フォーマット.int用紙方向=1 横｡
            if ( Foot_Flg < 0 ) {
                CENTER_Y = CENTER_Y - (LLY / 図Y_SCALE) / 50 ////////////////////////////////02/08/30
            }

            if ( RR橋脚 = 2 ) {
                if ( CASN = 0 ) {
                }
                if ( NKUI = 0 ) {
                    CENTER_Y = CENTER_Y + Round(柱剛域長 * 0.05, 2)
                }
            }
            if ( RR橋脚 = 2 $$ CASN > 0 ) {
                if ( JY_max - JY_min > 0 ) {
                    CENTER_Y = CENTER_Y - (JY_max - JY_min) / 2.8 + 2.5 //2.5 + 3 //図縦幅 / 80 //20
                } else {
                    CENTER_Y = CENTER_Y - (JY_max - JY_min) / 2.2 + 2.5 //2.5 + 3 //図縦幅 / 80 //20
                }
            }
            if ( k杭長 != 0 ) {
            //        if ( RR橋脚 = 2 $$ k杭長 / YYMAX > 0.3 ) {
            //            CENTER_Y = CENTER_Y + (k杭長 / YYMAX) ^ 1.5 / 図Y_SCALE / 10 * 2 //02/05/08
            //        }
            }
            if ( RR橋脚 = 2 $$ CASN < 0 $$ NKUI = 0 $$ iKozo != 3 ) {  //////////////////////////02/08/22
               CENTER_Y = CENTER_Y - max(Ymax / 2.5, 2.5) //min(Ymax / 2, 2.5)
            }
            if ( Xmax = Xmin $$ CASN >= 0 $$ 縦スケール = 0 ) {
                図Y_SCALE = (LLY / 図縦幅) * 0.9
                図X_SCALE = 図Y_SCALE
                CENTER_Y = 0
            }
            if ( Xmax = Xmin $$ CASN < 0 ) { //////14/09/16
                CENTER_Y = 0
            }
            //    if ( Ymax = Ymin $$ CASN >= 0 $$ 荷重図フォーマット.intレイアウト = 0 ) {  //////////////////////////04/07/06
            //       CENTER_Y = CENTER_Y + 枠縦幅 * 図Y_SCALE / 3
            //    }
            UEHOSEI = 0
            //<<<<< 図形中心位置計算 >>>>>
            //    図_X0 = (左開き + max((枠横幅 / 2 - CENTER_X / 図X_SCALE), 0)) * Twip ////////05/05/02
            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                図_X0 = (左開き + max((枠横幅 / 2 - CENTER_X / 図X_SCALE), 0) - max(JX_min, 0) / 図X_SCALE / 3) * Twip ////////06/02/13
            } else {
                if ( CASN < 0 ) {
                    if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                    図_X0 = (左開き + max((枠横幅 / 2 - CENTER_X / 図X_SCALE), 0) - max(JX_min, 0) / 図X_SCALE / 2) * Twip ////////06/02/13
                    } else {
                    図_X0 = (左開き + max((枠横幅 / 2 - CENTER_X / 図X_SCALE), 0) - max(JX_min, 0) / 図X_SCALE / 50) * Twip ////////06/02/13
                    }
                } else {
                    図_X0 = (左開き + max((枠横幅 / 2 - CENTER_X / 図X_SCALE), 0) - max(JX_min, 0) / 図X_SCALE / 1.5) * Twip ////////06/02/13
                }
            }
            // CENTER_Y = 1.6474
            図_Y0 = (上開き + 枠縦幅 / 2 + CENTER_Y / 図Y_SCALE + YEAKI) * Twip
                    if ( CASN < 0 $$ iKozo = 3 $$ 階段Mod = False $$ NKUI = 0 $$ (JY_max - 水平部材最上端) > 4 ) {
                        図_Y0 = 図_Y0 + ((JY_max - 水平部材最上端) / 3 / 図Y_SCALE) * Twip ////////13/04/18
                    }

            if ( (g連続Mod $$ 荷重図フォーマット.int用紙方向 = 1) ) { //////////////////////////////////05/05/15
            if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                if ( CASN < 0 ) {
                    図_X0 = 図_X0 + 2 * Twip ////////- (10 - 3) * Twip
                } else {
                    図_X0 = 図_X0 + 2 * Twip ////////+ (20 - 3) * Twip
                }
            } else {
                if ( CASN < 0 ) {
                    図_X0 = 図_X0 //////////+ (45 - 3) * Twip
                } else {
                    図_X0 = 図_X0 - 3 * Twip //+ (30 - 3) * Twip
                }
            }
            }
            if ( Foot_Flg = 0 $$ RR橋脚 = 2 ) {
                図_Y0 = 図_Y0 + 20 * Twip
            }
            if ( iKozo = 1 $$ 荷重図フォーマット.int用紙方向 = 0 $$ CASN >= 0 $$ F杭長 > 0 ) { //////14/11/18
                if ( (k杭長 / F杭長) < 0.3 ) {
                    図_Y0 = 図_Y0 - 20 * Twip
                }
            }
            //twipsに変換
            図X_SCALE = Round(図X_SCALE / Twip, 10)
            図Y_SCALE = Round(図Y_SCALE / Twip, 10)
            if ( 図X_SCALE = 0 ) {
                図X_SCALE = 0.00000001  //0除算になってしまうため
            }
            if ( 図Y_SCALE = 0 ) {
                図Y_SCALE = 0.00000001
            }
            ////////////////////////////////////////////////////////////05/02/05
                JX_max = XXYY(1) ////// 05/05/05
                JX_min = XXYY(2)

            横余裕 = (図横幅 - (JY_max - JY_min) / 図X_SCALE / Twip)
            横補正 = 0
            if ( (g連続Mod $$ iKozo = 3 $$ JY_max != JY_min) ) { //And JX_max * JX_min <= 0 ) {
                if ( CASN >= 0 ) {
                    横補正 = max((図横幅 - ((JX_max - JX_min) / 図X_SCALE / Twip) * 0.8), 0) * Twip / 2
                    横補正 = min(横補正, 500)
                }

                    if ( JX_max * JX_min > 0 ) {
                        横補正 = 横補正 - (JX_min / 図X_SCALE / Twip * 10)
                    } else {
            //                if ( 荷重図フォーマット.intレイアウト = 1 ) {////////////09/02/12 コメントにした
            //                    if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
            //                        横補正 = 横補正 - 2800 - 550
            //                    } else {
            //                        横補正 = 横補正 - 7000
            //                    }
            //                }
                        GoTo FGFG
                    }
            //        }
                if ( 荷重図フォーマット.intレイアウト = 1 $$ CASN >= 0 ) {
                    if ( CASN < 0 ) {
                        if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                            横補正 = 横補正 + 800
                        } else {
                            横補正 = 横補正 + 2200
                        }
                    } else {
                        if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                            if ( 横補正 > 500 ) { 横補正 = 横補正 - 800
                        } else {
                            if ( 横補正 > 500 ) {
                                if ( 横補正 != 500 ) {
                                    横補正 = 横補正 - 1500
                                } else {
                                    横補正 = 横補正 - 600
                                }
                            }
                        }
                    }
                }
            } else {if ( (JX_max = JX_min $$ CASN < 0) ) {  ////////////////////////////08/01/07
                if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                    if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                    横補正 = -1000
                    } else {
                    横補正 = -2000
                    }
                } else {
                    if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                    横補正 = -1200
                    } else {
                    横補正 = -4000
                    }
                }
                iKozo = 1
            }
            FGFG:
            //部材番号の出力
            this.BUZAIMEI(部材_max)
            this.SETTENNO(Jn_max)

            For( i = 1 To 部材_max
                if ( ZZBuzaiBai(i) != 0 ) {
                i1 = 部I(i)
                I2 = 部J(i)
                X1 = 節X(i1)
                y1 = 節Y(i1)
                X2 = 節X(I2)
                Y2 = 節Y(I2)
                LX = (X2 - X1) / 図X_SCALE
                LY = (Y2 - y1) / 図Y_SCALE
                LL = Sqr(LX ^ 2 + LY ^ 2)
                LX0 = LX
                if ( LL > 部材番号Fontsize * 50 ) {
                    BUZAIMEI(i) = 1
                } else {
                    BUZAIMEI(i) = 0
                }
                if ( SETTENNO(i1) < 9 ) {
                    if ( 節点部材数(i1) != 999 ) {
                        SETTENNO(i1) = 1
                    } else {
                        ii = 0
                        Do
                            ii = ii + 1
                            if ( ii > 部材_max ) {
                                Exit Do
                            }
                            if ( i1 = 部J(ii) ) {
                                X1 = 節X(部I(ii))
                                y1 = 節Y(部I(ii))
                                X2 = 節X(部J(ii))
                                Y2 = 節Y(部J(ii))
                                LX = (X2 - X1) / 図X_SCALE
                                LY = (Y2 - y1) / 図Y_SCALE
                                if ( Sqr(LX ^ 2 + LY ^ 2) > 節点番号Fontsize * 20.5 $$ SETTENNO(i1) != -1 ) {
                                    SETTENNO(i1) = 1
                                } else {
                                    if ( LX != 0 ) {
                                        SETTENNO(i1) = -1
                                    } else {
                                        SETTENNO(i1) = 0
                                    }
                                }
                                Exit Do
                            }
                        Loop
                    }
                }
                if ( SETTENNO(I2) < 9 ) {
                    if ( 節点部材数(I2) != 999 ) {
                        SETTENNO(I2) = 1
                    } else {
                    if ( LX0 = 0 $$ LL > 節点番号Fontsize * 50.5 ) {
                        ii = 0
                        Do
                            ii = ii + 1
                            if ( ii > 部材_max ) {
                                Exit Do
                            }
                            if ( I2 = 部I(ii) ) {
                                X1 = 節X(部I(ii))
                                y1 = 節Y(部I(ii))
                                X2 = 節X(部J(ii))
                                Y2 = 節Y(部J(ii))
                                LX = (X2 - X1) / 図X_SCALE
                                LY = (Y2 - y1) / 図Y_SCALE
                                if ( Sqr(LX ^ 2 + LY ^ 2) > 節点番号Fontsize * 20.5 ) {
                                    SETTENNO(I2) = 1
                                } else {
                                    if ( LX != 0 ) {
                                        SETTENNO(I2) = -1
                                    } else {
                                        SETTENNO(I2) = SETTENNO(I2) + 9
                                    }
                                }
                                Exit Do
                            }
                        Loop
                      }
                    }
                }
                }
            }
            //*/

        }

        /* private Function ATAN2(X As Single, Y As Single) As Single
        //
        Const PI = 3.14159265358979
        var th                      As Single
        //
        if ( Abs(X) >= Abs(Y) ) {
            if ( X > 0 ) {
                if ( Y > 0 ) {
                    th = Atn(Y / X)
                } else {
                    th = Atn(Y / X) + 2 * PI
                }
            } else {
                if ( X = 0 ) {
                    th = PI
                } else {
                    th = Atn(Y / X) + PI
                }
            }
        } else {
            if ( Y > 0 ) {
                th = Atn(-X / Y) + PI / 2
            } else {
                if ( Y = 0 ) {
                    th = PI * 3 / 2
                } else {
                    th = Atn(-X / Y) + PI * 3 / 2
                }
            }

        }

        th = Int(th * 1800 / PI + 0.5) / 10
        if ( th = 360 ) {
            th = 0
        }
        ATAN2 = th
        /
        }*/

        private void READ_Kajyu()
        {
            /*/
            var XS(50)
            var X(50)                   As Single
            var FN1
            var D
            var DA
            var i                       As Integer
            var N                       As Integer
            var er1
            var fno                     As Integer
            //
            fno = FreeFile
            FN1 = FOLU & "Kajyu.txt"
            Open FN1 For( Input As #fno
            Input #fno, D
            荷重case_max = val(D)
            this.実荷重NO(荷重case_max)
            this.逆実荷重NO(300) ////////////////////09/02/09
            this.荷重記号(荷重case_max)
            this.荷重名称(荷重case_max)
            For( i = 1 To 荷重case_max
            //        Input #fno, DA
                Line Input #fno, DA ////////// 04/10/18
                this.D_data(Chr(9), DA, XS(), X(), N, er1)
                実荷重NO(i) = X(2)
                逆実荷重NO(X(2)) = i ////////09/02/09
                荷重記号(i) = XS(3)
                荷重名称(i) = XS(4)
            }
            Close #fno
            /*/
        }

        private void BU荷重CALC(int 描画荷重case)
        {
            /*/
            var XS(50)
            var X(50)                   As Single
            var FN1
            var D
            var DA
            var i                       As Integer
            var N                       As Integer
            var er1
            var ret
            var S部材                   As Integer
            var E部材                   As Integer
            var 荷重max                 As Integer
            var 荷重CASE                As Integer
            var 荷重mark                As Integer
            var 荷重_L1
            var 荷重_L2
            var 荷重_P1                 As Single
            var 荷重_P2
            var 荷重方向
            var 節点J                   As Integer
            var 荷重_FX
            var 荷重_FY
            var 荷重_M
            var ii                      As Integer
            var 節点S                   As Integer
            var 節点E                   As Integer
            var 荷重数                  As Integer
            var 荷重図開き
            var 図モード
            var 寸法値記入
            var 前寸法値記入
            var 前節点S                 As Integer
            var 前節点E                 As Integer
            var 荷重種類
            var 前荷重種類
            var 荷重_L_END
            var 前荷重mark
            var 前荷重_L1
            var 前荷重_L2
            var 前荷重_P1
            var 前荷重_P2
            var 前荷重符号
            var 荷重符号
            var 連続荷重数               As Integer
            var II2                     As Integer
            var 部材1                   As Integer
            var 部材2                   As Integer
            var fno                     As Integer
            var BU荷重MIN  As Single
            var yKASOU荷重 As Single //////08/11/06
            var M As Integer, Atta As Integer
            yKASOU荷重 = 0
            //
            fno = FreeFile
            FN1 = FOLU & "K_Jitubuzai.txt"
            if ( FLG車両ZU = False ) {
                Open FN1 For( Input As #fno
                Input #fno, D
                荷重max = val(D)
            } else {
                荷重max = Num車両KKK
            }
            BP荷重MAX = 0
            BU荷重MIN = 9999
            BU荷重MAX = 0
            STC = 0
            ETC = 0
            var VVV As Single
            VVV = 0
            For( i = 1 To 荷重max
                if ( FLG車両ZU = False ) {
                    if ( EOF(fno) ) {
                        Exit For
                    }
                    Line Input #fno, DA ////////// 04/10/18
                } else {
                    DA = str車両KKK(i)
                }
                this.D_data(Chr(9), DA, XS(), X(), N, er1)
                if ( 描画荷重case = X(1) ) {
                    荷重CASE = X(1)
                    S部材 = X(2)
                    if ( X(3) = 0 $$ X(2) > 0 ) {
                        X(3) = -X(2)
                    }
                    E部材 = X(3)
                    荷重mark = X(4)
                    荷重_L1 = Round(X(5), 3)
                    荷重_L2 = Round(X(6), 3)
                    荷重_P1 = Round(X(7) * 数部材(S部材), 3)
                    荷重_P2 = Round(X(8) * 数部材(S部材), 3)
                    荷重方向 = XS(9)
                    節点J = X(10)
                    荷重_FX = X(11)
                    荷重_FY = X(12)
                    荷重_M = X(13)
                    if ( STC = 0 ) {
                        STC = i
                    }
                    ETC = i
                    if ( 荷重mark > 0 ) {
                        if ( S部材 < 1 ) {
                            S部材 = 1
                        }
                        if ( E部材 = 0 ) {
                            E部材 = S部材
                        }
                        II2 = E部材
                        if ( II2 < 0 ) {
                            II2 = S部材
                        }
            //////08/11/06
                Atta = 0
                if ( 下層BUZAI(1, 1) != 0 ) {
                    For( M = 1 To 部材_max
                        if ( 下層BUZAI(M, 1) = 0 ) { Exit For
                        if ( 下層BUZAI(M, 1) >= S部材 $$ 下層BUZAI(M, 1) <= Abs(E部材) ) {
                            Atta = 1
                            Exit For
                        }
                    Next M
                }
            //////08/11/06
                        For( ii = 1 To 1 //////////////////////S部材 To II2//////////08/11/06
                            Select Case 荷重mark
                            Case 1
                                if ( BP荷重MAX < Abs(荷重_P1) ) {
                                    BP荷重MAX = Abs(荷重_P1)
                                }
                                if ( BP荷重MAX < Abs(荷重_P2) ) {
                                    BP荷重MAX = Abs(荷重_P2)
                                }
                            Case 5
                                if ( BP荷重MAX < Abs(荷重_P1) ) {
                                    BP荷重MAX = Abs(荷重_P1)
                                }
                                if ( BP荷重MAX < Abs(荷重_P2) ) {
                                    BP荷重MAX = Abs(荷重_P2)
                                }
                            Case 2
                                if ( Atta = 0 ) { //////////////////////////////////////////////////08/11/06
                                    if ( BU荷重MAX < Abs(荷重_P1) ) {
                                        BU荷重MAX = Abs(荷重_P1)
                                    }
                                    if ( BU荷重MAX < Abs(荷重_P2) ) {
                                        BU荷重MAX = Abs(荷重_P2)
                                    }
                                    if ( BU荷重MIN > Abs(荷重_P1) ) {
                                        BU荷重MIN = Abs(荷重_P1)
                                    }
                                    if ( BU荷重MIN > Abs(荷重_P2) ) {
                                        BU荷重MIN = Abs(荷重_P2)
                                    }
                           if ( 荷重_P1 = 荷重_P2 $$ 節X(部I(S部材)) = 節X(部J(S部材)) $$ 節X(部I(Abs(E部材))) = 節X(部J(Abs(E部材))) ) {
                            VVV = 0.1
                           } else {
                                VVV = VVV + 1
                           }

                                } else {
                                    if ( yKASOU荷重 < Abs(荷重_P1) ) {
                                        yKASOU荷重 = Abs(荷重_P1)
                                    }
                                    if ( yKASOU荷重 < Abs(荷重_P2) ) {
                                        yKASOU荷重 = Abs(荷重_P2)
                                    }
                                }
                            Case 3, 4
                                if ( Atta = 0 ) { //////////////////////////////////////////////////08/11/06
                                    if ( BU荷重MAX < Abs(荷重_P1) ) { //// * 0.8 ) {
                                        BU荷重MAX = Abs(荷重_P1) // * 0.8
                                    }
                                    if ( BU荷重MAX < Abs(荷重_P2) ) { //// * 0.8 ) {
                                        BU荷重MAX = Abs(荷重_P2) // * 0.8
                                    }
                                } else {
                                    if ( yKASOU荷重 < Abs(荷重_P1) ) {
                                        yKASOU荷重 = Abs(荷重_P1)
                                    }
                                    if ( yKASOU荷重 < Abs(荷重_P2) ) {
                                        yKASOU荷重 = Abs(荷重_P2)
                                    }
                                }
            //                    Case 4
            //                        if ( BU荷重MAX < Abs(荷重_P1) ) {
            //                            BU荷重MAX = Abs(荷重_P1)
            //                        }
            //                        if ( BU荷重MAX < Abs(荷重_P2) ) {
            //                            BU荷重MAX = Abs(荷重_P2)
            //                        }
                            End Select
                       }i
                   }
                 }
            }
            Close #fno
            ////////////////////////////////////////////009/02/20
            var Dummy As Single
            Dummy = BU荷重MAX //////09/09/08
            if ( BU荷重MAX = 0 ) {
                if ( yKASOU荷重 = 0 ) {
                     BU荷重MAX = 10
                } else {
                     BU荷重MAX = yKASOU荷重
                }
            }
            ////////////////////////////////////////////009/02/20
            if ( BU荷重MAX >= yKASOU荷重 ) { //////////14/12/14
            yKASOU荷重 = BU荷重MAX
            } else {
            //    BU荷重MAX = BU荷重MAX + 0.0001
            if ( (yKASOU荷重 / BU荷重MAX) < 1.5 ) { //////15/02/02
                BU荷重MAX = BU荷重MAX + 0.0001
                if ( yKASOU荷重 > BU荷重MAX ) {
                    BU荷重MAX = yKASOU荷重 * 1.05
                }
                GoTo GRF_
            }
            }
            if ( yKASOU荷重 != 0 ) {
                if ( (yKASOU荷重 / BU荷重MAX) < 1.2 ) {
                    BU荷重MAX = min(BU荷重MAX, yKASOU荷重)
                } else {if ( (yKASOU荷重 / BU荷重MAX) < 2.2 ) {
                    BU荷重MAX = Round(BU荷重MAX * (yKASOU荷重 / BU荷重MAX) / 1.5, 2) //////Round((BU荷重MAX + yKASOU荷重) / 2 * 0.9, 2)
            //            BU荷重MAX = Round(min(BU荷重MAX, yKASOU荷重) * 1.5, 2)
                } else {if ( (yKASOU荷重 / BU荷重MAX) < 2.8 ) {
                    BU荷重MAX = Round((BU荷重MAX + yKASOU荷重) / 2, 2)
                } else {if ( yKASOU荷重 / BU荷重MAX < 5 ) {
            //            BU荷重MAX = Round((BU荷重MAX ^ 2 + yKASOU荷重 ^ 2) ^ 0.5 / 2, 2)
                    BU荷重MAX = Round(max(BU荷重MAX, yKASOU荷重) * 0.8, 2) ////09/01/28 //////15/02/02  * 0.7
                } else {
            //            BU荷重MAX = Round((BU荷重MAX ^ 2 + yKASOU荷重 ^ 2) ^ 0.5 / 1.6, 2)
            //            BU荷重MAX = Round(max(BU荷重MAX, yKASOU荷重) * 0.8, 2) ////09/01/28
                    BU荷重MAX = Round(max(BU荷重MAX, yKASOU荷重 / 1.5), 2) ////14/11/25
                }
            //        if ( iKozo = 1 ) { //////09/09/08
            //            BU荷重MAX = Round(max(Dummy, yKASOU荷重), 2)
            //        }
                if ( (図Y_SCALE) > 0.007 $$ (JX_max - JX_min) > 70 ) { //////09/09/25
                    Dummy = (1 / (図Y_SCALE * 10) ^ 0.1)
                    BU荷重MAX = Round(BU荷重MAX * Dummy, 2)
                    BU荷重MIN = Round(BU荷重MIN * Dummy, 2)
                }
            }
            if ( BU荷重MAX != BU荷重MIN ) {
                BU荷重MAX = BU荷重MAX + 0.0001 ////////08/11/06
            }
            if ( FLG車両ZU $$ BU荷重MIN != 0 ) {
                BU荷重MAX = max((BU荷重MAX - BU荷重MIN), BU荷重MIN * 1.2) ////////14/10/18
            }
            if ( VVV = 0.1 ) {
                BU荷重MAX = BU荷重MAX * 1.5 ////////////////垂直部材の等分布 17/06/19
            }
            //
            GRF_: //////14/12/14
            */
        }

        public void READ_K_Jitubuzai(int 描画荷重case, float[] DANS, int FlgDANS = 0, int FlgCASU = 0)
        {
            /*/
            var NNNNN                   As Integer
            var XS(50)
            var X(50)                   As Single
            var NC5                     As Integer
            var FN1
            var D
            var DA
            var FFGG                    As Integer
            var 間隔                    As Single
            var LLL                     As Single
            var i                       As Integer
            var N                       As Integer
            var er1
            var ret
            var S部材                   As Integer
            var E部材                   As Integer
            var 荷重max                 As Integer
            var 荷重CASE                As Integer
            var 荷重mark                As Integer
            var 荷重_L1
            var 荷重_L2
            var 荷重_P1                 As Single
            var 荷重_P2                 As Single
            var 荷重方向
            var 節点J                   As Integer
            var 荷重_FX
            var 荷重_FY
            var 荷重_M
            var ii                      As Integer
            var 節点S                   As Integer
            var 節点E                   As Integer
            var 荷重数                  As Integer
            var 荷重図開き
            var 図モード
            var 寸法値記入
            var 前寸法値記入
            var 前節点S                 As Integer
            var 前節点E                 As Integer
            var 荷重種類
            var 前荷重種類
            var 前荷重mark
            var 前荷重_L1
            var 前荷重_L2
            var 前荷重_P1
            var 前荷重_P2
            var 前荷重方向
            var 前荷重符号
            var 前hosei
            var 荷重符号
            var 連続荷重数              As Integer
            var 連続荷重mark()
            var 連続荷重_L1()
            var 連続荷重_L2()
            var 連続荷重_P1() ////////08/07/08
            var 連続荷重_P2()
            //////////////////////////////06/12/12
            var y節点S                 As Integer
            var y節点E                 As Integer
            var y連続荷重_L1(300)
            var y連続荷重_L2(300)
            //    var yBuzaiFF ////////////////////////10/03/07  12/12/15
            var 前BuzaiFF
            var yGGGGG()
            //////////////////////////////06/12/12
            var II2                     As Integer
            var 部材1                   As Integer
            var 部材2                   As Integer
            var fno                     As Integer
            var X1                      As Single
            var y1                      As Single
            var X2                      As Single
            var Y2                      As Single
            var X_STA                   As Single
            var Y_STA                   As Single
            var X_END                   As Single
            var Y_END                   As Single
            var 荷重_L_STAX
            var 荷重_L_STAY
            var 荷重_L_ENDX
            var 荷重_L_ENDY
            var OCounter(100)           As Integer
            var zX_ST                   As Single
            var zX_EN                   As Single
            var 荷重向                  As Single
            var k                       As Integer
            var k9                      As Integer
            var strA                    As String
            var FlgKAZU                 As Integer
            double var DDD1(100)
            double var StartB1
            double var EndB1
            double var RenZoku
            double var BMMax
            double var KanazII
            double var MinusFlag
            double var Acc
            double var JI1()
            double var JI2()
            double var JI3()
            double var JI4()
            double var ChangeFlag()
            double var SAFlag()
            double var Atta1
            var j                       As Integer
            double var MAXREN
            double var Df
            var LL As Single, L8 As Single, L9 As Single //////////////05/02/27
            var N1 As Integer, N2 As Integer, N3 As Integer, N4 As Integer ////////09/10/14
            var strLL As String ////////////////////////////////////////////////////////////////05/02/27
            double var AAA(3)
            //    var DDAN(1000) As Single ////////////08/11/039
            var RRR As Integer
            var WWW As Integer
            var rFlg As Integer
            var g節点M As Integer //////////07/05/14
            var 前BUZA1 As Single, 前BUZA2 As Single ////////////07/11/079
            var g桁数 As Integer
            var gW1 As Single, gW2 As Single, gW3 As Single, gW4 As Single
            var gRuP(100, 3) As Single //////Integer 09/08/20
            var J8CUNT As Integer, CUNT As Integer, CUNT8 As Integer, reed As Single ////////08/11/06
            var gRuPF(100, 10, 6) As Single
            var HHg As Single, Atta As Integer, M As Integer ////////08/11/13
            //
            var 連番 As Integer, gP11 As Integer ////////09/02/13
            var 勾配 As Single, 勾配2 As Single, N5 As Integer, M5 As Integer ////////09/02/13
            var Pt1 As Integer, Pt2 As Integer ////////09/02/13
            var BuzaiMM As Integer ////////09/10/14
            var yP88 As Single //////10/01/188
            yP88 = 0
            //
            //    var Now荷重max1                As Integer //////部材荷重数
            //    var Now荷重max2                As Integer //////節点荷重数
            var m荷重CASE()                As Integer
            var mS部材()                   As Long
            var mE部材()                   As Long
            var m荷重mark()                As Integer
            var m荷重_L1()                 As Single
            var m荷重_L2()                 As Single
            var m荷重_P1()                 As Single
            var m荷重_P2()                 As Single
            var m荷重方向()
            var m距離符号()
            var m節点J()                   As Integer
            var m荷重_FX()                 As Single
            var m荷重_FY()                 As Single
            var m荷重_M()                  As Single
            var NNN As Integer

            var g荷重_L1()                 As Single
            var g荷重_L2()                 As Single
            var g荷重_P1()                 As Single
            var g荷重_P2()                 As Single
            var g荷重方向()
            var g距離符号()

            Now荷重max1 = 0
            Now荷重max2 = 0
            //
            前前DXY(1) = 0
            前前DXY(2) = 0
            For( i = 1 To 100
                gRuP(i, 1) = 0
                gRuP(i, 2) = 0
                gRuP(i, 3) = 0
            }
            g節点M = 0
            WWW = 0
            BuzaiFF = 0 ////////13/04/07
            str前前Num = ""
            sgl前前Num = 0
            //
            str前Num = "" ////////14/12/22
            str後Num = ""
            this.前RXY(200, 3)
            前RXY(0, 0) = 0 ////////////////15/01/08

            FLG側圧あり = 0
            //
            g荷重表記縦 = 0 //////08/10/29
            g荷重表記高 = 0
            g荷重表記高5 = 0 //////09/11/13
            FLG_柱軸重 = False //////13/06/03
            Mark5前位置 = -9999
            //
            FLG_左右接点(1) = False
            FLG_左右接点(2) = False
            FLG_左右接点(3) = False

            if ( fMainForm.SICheck = True ) { //SI単位チェック
                g桁数 = 2 //////////"kN"
            } else {
                g桁数 = 3 //////////"tf"
            }
            //
            if ( FlgDANS != 0 ) { //////////14/05/22
                this.DANS(部材_max, 3)
                NNN = 0
                FLG車両ZU = False
            }
            XY集中(1) = -9999 ////////11/12/16
            XY集中(2) = -9999
            this.節点荷重段数(Jn_max, 4) ////////////////////////09/04/14//////////////// nagase   //Erase 節点荷重段数
            this.DDAN(Jn_max) ////////////08/11/039
            this.g節点水平荷重座標(Jn_max, 2) //////14/11/15
            //
            var SETEN_HYM() ////////////12/08/22
            this.SETEN_HYM(max(Jn_max * 2, 30), 0 To 3) ////////////12/08/22 13/11/24
            var HYM_con As Integer ////////////12/08/22
            //
            ONajiFlag = 0
            OnajiIchiNum = 0
            fno = FreeFile
            FN1 = FOLU & "K_Jitubuzai.txt"
            if ( FLG車両ZU = False ) {
                Open FN1 For( Input As #fno
                Input #fno, D
                荷重max = val(D)
            } else {
                荷重max = Num車両KKK
            }
            if ( 荷重max <= 0 ) {
                FlgCASU = 0
                return;
            }
            FlgCASU = 1
            this.ONajiKaku(荷重max)
            this.GGGGG(部材_max) ////////////09/10/14
            //
            this.連続荷重mark(max(荷重max, 500)) //////////13/04/04  (荷重max, 500)
            this.連続荷重_L1(max(荷重max, 500))
            this.連続荷重_L2(max(荷重max, 500))
            this.連続荷重_P1(0 To max(荷重max, 500))
            this.連続荷重_P2(0 To max(荷重max, 500))
            //
            //////
            this.m荷重CASE(荷重max * 2)
            this.mS部材(荷重max * 2)
            this.mE部材(荷重max * 2)
            this.m荷重mark(荷重max * 2)
            this.m荷重_L1(荷重max * 2)
            this.m荷重_L2(荷重max * 2)
            this.m荷重_P1(荷重max * 2)
            this.m荷重_P2(荷重max * 2)
            this.m荷重方向(荷重max * 2)
            this.m距離符号(荷重max * 2)
            this.m節点J(荷重max * 2)
            this.m荷重_FX(荷重max * 2)
            this.m荷重_FY(荷重max * 2)
            this.m荷重_M(荷重max * 2)

            Mark2離れ(1) = -99999999
            Mark2離れ(2) = -99999999
            KAJYUstrEND = -99999999
            g荷重連寸法補正 = 0 ////////////////////////////07/01/17
            g荷重連寸法回数 = 0
            //
            s連行前節点(1) = 0 ////////09/10/20
            s連行前節点(2) = 0
            s連行後節点(1) = 0
            s連行後節点(2) = 0
            g段上げ = -99999 //////13/04/13
            s荷重位置 = 999999
            //    s荷重側圧位置1 = 999999
            //    s荷重側圧位置2 = -999999
            FLG_側圧9 = 0
            s側圧数 = 0
            H水平(1) = 0 //////13/04/24
            V鉛直(1) = 0
            FLG_列車_衝撃 = False //////13/04/25
            //
            //
            //                if ( 荷重図フォーマット.intレイアウト = 0 ) { EE = 1
            //                if ( 荷重図フォーマット.intレイアウト = 1 ) { EE = 2
            //                if ( 荷重図フォーマット.intレイアウト = 2 ) { EE = 3
            //                if ( 荷重図フォーマット.intレイアウト = 3 ) { EE = 4
            //                if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
            RRR = 4
            if ( 荷重図フォーマット.intレイアウト = 1 || (荷重図フォーマット.intレイアウト = 1 $$ 荷重図フォーマット.int用紙方向 = 0 $$ iKozo = 3) ) {
            RRR = 1
            } else {if ( (荷重図フォーマット.intレイアウト = 1 $$ 荷重図フォーマット.int用紙方向 = 0) ) {
            RRR = 2
            }

            //////////////////////////////////////////////////////////////////////////////////////////////////////// 05/03/16
            //                節点J = X(10)
            //                荷重_FX = X(11)
            //                荷重_FY = X(12)
            //                荷重_M = X(13)
            Flg_PRESTRES(1) = 0 ////////////////////////////08/06/05
            Flg_PRESTRES(2) = 0
            //
            Erase s連行前
            Erase s連行後
            For( i = 1 To Jn_max //////08/11/039
                節点荷重段数(i, 1) = 0
                節点荷重段数(i, 2) = 0
                節点荷重段数(i, 3) = 0
                節点荷重段数(i, 4) = 0 //////09/04/14
                DDAN(i) = 0
                SETEN_HYM(i, 0) = 0 //////////12/08/22
                g節点水平荷重座標(i, 1) = 0 //////14/11/15
                g節点水平荷重座標(i, 2) = 0
            }
            //
            ////////////////////////////////////////////////////////////////////////////12/08/22
            HYM_con = 0
            if ( FLG車両ZU = False ) {
                For( i = 1 To 荷重max ////////////0
                    if ( EOF(fno) ) {
                        Exit For
                    }
                    Line Input #fno, DA ////////// 04/10/18
                    this.D_data(Chr(9), DA, XS(), X(), N, er1, strLL, 1)
            //
                    if ( 描画荷重case = X(1) ) {
                        if ( X(10) > 0 ) {
                            HYM_con = HYM_con + 1
                            SETEN_HYM(HYM_con, 0) = X(10)
                            SETEN_HYM(HYM_con, 1) = X(11)
                            SETEN_HYM(HYM_con, 2) = X(12)
                            SETEN_HYM(HYM_con, 3) = X(13)
                        } else {if ( X(4) = 5 || X(4) = 11 ) {
                             HYM_con = HYM_con + 1
                             SETEN_HYM(HYM_con, 0) = 部J(Abs(X(2)))
                             SETEN_HYM(HYM_con, 2) = 1
            //                } else {if ( X(4) = 11 ) {
            //                     HYM_con = HYM_con + 1
            //                     SETEN_HYM(HYM_con, 0) = 部J(Abs(X(2)))
            //                     SETEN_HYM(HYM_con, 2) = 10
                        }
                    }
                }
                Close #fno
                Open FN1 For( Input As #fno
                Input #fno, D
                荷重max = val(D)
            //    } else {
            //        荷重max = Num車両KKK
                                        //Public str車両CASE名() As String
                                        //Public str車両KKK() As String
                                        //Public Num車両KKK As Integer
            }
            ////////////////////////////////////////////////////////////////////////////12/08/22
            var y荷重No() As Integer
            this.y荷重No(荷重max) //////14/10/13

            CUNT = 0: J8CUNT = 1 //////////08/11/06
            For( i = 1 To 荷重max ////////////1
                if ( FLG車両ZU = False ) {
                    if ( EOF(fno) ) {
                        Exit For
                    }
                    Line Input #fno, DA ////////// 04/10/18
                } else {
                    DA = str車両KKK(i)
                }
                this.D_data(Chr(9), DA, XS(), X(), N, er1, strLL, 1)
                //
                if ( 描画荷重case = X(1) ) { //////////08/06/05 08/11/039
                    if ( X(2) != 0 ) {
                        Now荷重max1 = Now荷重max1 + 1
                        y荷重No(Now荷重max1) = i
            //                if ( X(4) = 6 $$ X(3) < 0 ) {////////コメントにした 13/09/27
            //                    X(3) = -X(3)
            //                }
                        mS部材(Now荷重max1) = X(2)
                        mE部材(Now荷重max1) = X(3)
                        m荷重mark(Now荷重max1) = X(4)
                        m荷重_L1(Now荷重max1) = Round(X(5), 3)
                        m荷重_L2(Now荷重max1) = Round(X(6), 3)
                        m荷重_P1(Now荷重max1) = X(7)
                        m荷重_P2(Now荷重max1) = X(8)
                        m荷重方向(Now荷重max1) = XS(9)
                        m距離符号(Now荷重max1) = strLL
            //////17/10/07
                        if ( X(2) > 0 $$ X(3) > 0 $$ X(2) < X(3) $$ m荷重_L1(Now荷重max1) = 0 $$ m荷重_L2(Now荷重max1) = 0 _
                                            $$ m荷重_P1(Now荷重max1) = m荷重_P2(Now荷重max1) $$ m荷重mark(Now荷重max1) = 2 $$ XS(9) = "" ) {
                                g角度一連 = True
                                this.Check_BuzaiXXXX(X(2) + 0, X(3) + 0, 部材_max, 部I(), 部J(), BuzaiFF, GGGGG(), g角度一連, XS(9), 1)
                                if ( BuzaiFF > 0 ) {
                                    if ( X(2) = GGGGG(1) $$ X(3) = GGGGG(BuzaiFF) ) {
                                        N3 = 0
                                        For( N4 = 1 To BuzaiFF
                                            if ( GGGGG(N4) != N4 ) {
                                                N3 = 1
                                                Exit For
                                            }
                                        Next N4
                                        if ( N3 = 0 ) {
                                            mE部材(Now荷重max1) = -mE部材(Now荷重max1)
                                        }
                                    }
                                }
                        }
            //                HHg = 0
            //                if ( X(4) = 5 ) { //////////15/05/23 やめた
            //                    HHg = Round(集中荷重長さmax / 2, 1) // + IIf(FLG記号 = 1, 1.5, 0)
            //                } else {if ( X(4) = 11 ) {
            //                    HHg = Round(集中荷重長さmax / 2, 1) + 1
            //                }
            //                if ( HHg != 0 ) {
            //                    DDAN(部I(X(2))) = max(DDAN(部I(X(2))), HHg)
            //                    DDAN(部J(X(2))) = max(DDAN(部J(X(2))), HHg)
            //                }
                    }
                    HHg = 0
                    if ( X(10) != 0 ) {
                        Now荷重max2 = Now荷重max2 + 1
                        m節点J(Now荷重max2) = X(10)
                        m荷重_FX(Now荷重max2) = X(11)
                        m荷重_FY(Now荷重max2) = X(12)
                        m荷重_M(Now荷重max2) = X(13)
                    }
                    if ( X(4) = 6 ) {
                        FLG_柱軸重 = True ////////13/06/03
                    }
                    if ( HYM_con > 0 ) { ////////12/08/22
                        For( WWW = 1 To HYM_con
                            HHg = 0
                            if ( 節Y(SETEN_HYM(WWW, 0)) >= min(YY_max, 水平部材最上端) * 0.9 ) {
                                if ( HYM_con = 2 ) {
                                    if ( SETEN_HYM(WWW, 2) != 0 $$ _
                                            (節X(SETEN_HYM(1, 0)) = 節X(部I(Abs(X(2)))) || _
                                             節X(SETEN_HYM(2, 0)) = 節X(部J(Abs(X(3))))) _
                                    ) { //////09/11/06
                                        if ( g連続Mod $$ iKozo = 3 ) { //////////////////////////////////////08/11/069//    節X(節点S)
                                            HHg = Round(集中荷重長さmax / 1.8, 1) + IIf(FLG記号 = 1, 3, 0)
                                        } else {
                                            HHg = Round(集中荷重長さmax / 5, 1) + IIf(FLG記号 = 1, 1.5, 0) //////14/08/17
            //                                    if ( m荷重_FY(WWW) != 0 $$ y水平CUNT > 1 ) {
                                            if ( Not (節X(SETEN_HYM(1, 0)) = 節X(部I(Abs(X(2)))) $$ (X(3) = 0 || 節X(SETEN_HYM(2, 0)) = 節X(部J(Abs(X(3)))))) ) {
                                            HHg = Round(集中荷重長さmax * 0.6, 1) + IIf(FLG記号 = 1, 1.5, 0)
                                            }
            //                                    if ( HHg < 17 ) {
            //                                        if ( Abs(SETEN_HYM(WWW, 1)) + Abs(SETEN_HYM(WWW, 3)) > 0 ) {
            //                                            HHg = HHg + 集中荷重長さmax / 4 //////15/02/17
            //                                        } else {
            //                                            HHg = HHg + 集中荷重長さmax / 5 //////15/02/17
            //                                        }
            //                                        if ( SETEN_HYM(WWW, 2) < 100 ) {
            //                                            HHg = HHg - 3
            //                                        }
            //                                    }
            //                                    if ( mE部材(Now荷重max1) = 0 $$ (節X(SETEN_HYM(1, 0)) = 節X(部I(Abs(X(2))))) ) { ////// || 節X(SETEN_HYM(WWW, 0)) = 節X(部J(Abs(X(2))))) $$ m荷重_P1(Now荷重max1) = m荷重_P2(Now荷重max1) ) { ////// $$ m荷重mark(Now荷重max1) = 2 ) {
            //                                        HHg = Round(集中荷重長さmax / 4, 1)
            //                                    }
                                        }
                                        DDAN(SETEN_HYM(WWW, 0)) = max(DDAN(SETEN_HYM(WWW, 0)), HHg)
                                        yP88 = max(yP88, Abs(SETEN_HYM(WWW, 2)))
                                    } else {if ( Abs(SETEN_HYM(WWW, 1)) + Abs(SETEN_HYM(WWW, 3)) > 0 ) {
                                        HHg = Round(集中荷重長さmax / 4, 1)
                                        DDAN(SETEN_HYM(WWW, 0)) = max(DDAN(SETEN_HYM(WWW, 0)), HHg)
                                    }
                                } else {
                                    if ( Abs(SETEN_HYM(WWW, 1)) + Abs(SETEN_HYM(WWW, 3)) > 0 ) {
                                        HHg = Round(集中荷重長さmax / 4, 1)
                                        DDAN(SETEN_HYM(WWW, 0)) = max(DDAN(SETEN_HYM(WWW, 0)), HHg)
                                    }
                                    if ( SETEN_HYM(WWW, 2) != 0 $$ Not ((X(2) = X(3) || X(3) = 0)) ) {
                                    if ( (節X(SETEN_HYM(WWW, 0)) = g柱X座標(1, 1) || _
                                        節X(SETEN_HYM(WWW, 0)) = g柱X座標(g柱本数, 1)) $$ ((X(2) = X(3) || X(3) = 0)) ) { //////17/08/03
                                    } else {
                                        if ( g連続Mod $$ iKozo = 3 ) { //////////////////////////////////////08/11/069//    節X(節点S)
                                            HHg = Round(集中荷重長さmax / 1.8, 1) + IIf(FLG記号 = 1, 3, 0)
                                        } else {
                                            HHg = Round(集中荷重長さmax * 0.6, 1) + IIf(FLG記号 = 1, 1.5, 0) //////14/08/17
            //                                    if ( HHg < 17 ) {
            //                                        if ( Abs(SETEN_HYM(WWW, 1)) + Abs(SETEN_HYM(WWW, 3)) > 0 ) {
            //                                            HHg = HHg + 集中荷重長さmax / 4 //////15/02/17
            //                                        } else {
            //                                            HHg = HHg + 集中荷重長さmax / 5 //////15/02/17
            //                                        }
            //                                        if ( SETEN_HYM(WWW, 2) < 100 ) {
            //                                            HHg = HHg - 3
            //                                        }
            //                                    }
                                        }
            //                                DDAN(SETEN_HYM(WWW, 0)) = max(DDAN(SETEN_HYM(WWW, 0)), HHg)
            //                                yP88 = max(yP88, Abs(SETEN_HYM(WWW, 2)))
            //                            } else {if ( Abs(SETEN_HYM(WWW, 1)) + Abs(SETEN_HYM(WWW, 3)) > 0 ) {
            //                                HHg = Round(集中荷重長さmax / 4, 1)
            //                                DDAN(SETEN_HYM(WWW, 0)) = max(DDAN(SETEN_HYM(WWW, 0)), HHg)
                                    }
                                    }
                                    if ( Not (節X(SETEN_HYM(WWW, 0)) = JX_min || 節X(SETEN_HYM(WWW, 0)) = JX_max) ) {
                                        DDAN(SETEN_HYM(WWW, 0)) = max(DDAN(SETEN_HYM(WWW, 0)), HHg)
                                        yP88 = max(yP88, Abs(SETEN_HYM(WWW, 2)))
                                    }
                                }
                            } else { //////////////// 中層下層
                                HHg = 0
                                if ( g柱本数 > 0 $$ (節X(SETEN_HYM(WWW, 0)) = g柱X座標(1, 1) || 節X(SETEN_HYM(WWW, 0)) = g柱X座標(g柱本数, 1)) ) { //////08/11/18
                                    if ( Abs(SETEN_HYM(WWW, 1)) > 0 ) {
                                        if ( (SETEN_HYM(WWW, 1) < 0 $$ 節X(SETEN_HYM(WWW, 0)) = g柱X座標(1, 1)) || _
                                           (SETEN_HYM(WWW, 1) > 0 $$ 節X(SETEN_HYM(WWW, 0)) = g柱X座標(g柱本数, 1)) ) {
                                            HHg = max(HHg, Round(集中荷重長さmax / 5, 1))
                                        }
                                    }
                                } else {
                                    if ( SETEN_HYM(WWW, 2) != 0 ) {
                                        HHg = Round(集中荷重長さmax / 15, 1)
                                    }
                                    if ( Abs(SETEN_HYM(WWW, 1)) + Abs(SETEN_HYM(WWW, 3)) > 0 ) {
                                        HHg = max(HHg, Round(集中荷重長さmax / 5, 1))
                                    }
                                }
                                DDAN(SETEN_HYM(WWW, 0)) = max(DDAN(SETEN_HYM(WWW, 0)), HHg) //////////08/11/13
                            }
                            if ( Abs(SETEN_HYM(WWW, 1)) + Abs(SETEN_HYM(WWW, 3)) > 0 ) { ////////07/05/14
                                if ( 節X(SETEN_HYM(WWW, 0)) > JX_min $$ 節X(SETEN_HYM(WWW, 0)) < JX_max ) {
                                    g節点M = 1 ////////////有り
                                }
                            }
                        Next WWW
                        WWW = 0
                    }
                    if ( X(4) = 12 ) { Flg_PRESTRES(1) = 1 //////////08/06/05
                    if ( X(4) = 13 ) { Flg_PRESTRES(2) = 1 //////////08/06/05
            //////08/11/06
                    CUNT = CUNT + 1
                    if ( X(2) < X(3) $$ X(4) = 2 $$ X(5) + X(6) = 0 ) { //////08/12/06
                        X(3) = -X(3)
                    }
                    if ( X(2) < X(3) $$ X(4) = 2 ) {
                        if ( gRuP(J8CUNT, 1) = 0 ) {
                            reed = X(2) * 1000 + X(3)
                            gRuP(J8CUNT, 1) = CUNT
                            gRuP(J8CUNT, 2) = CUNT
                            gRuP(J8CUNT, 3) = X(2) * 1000 + X(3)
                            CUNT8 = 1
                            gRuPF(J8CUNT, CUNT8, 1) = X(4)
            //                    gRuPF(J8CUNT, CUNT8, 2) = X(5)
            //                    gRuPF(J8CUNT, CUNT8, 3) = X(6)
                            gRuPF(J8CUNT, CUNT8, 4) = X(7)
                            gRuPF(J8CUNT, CUNT8, 5) = X(8)
                            節点S = 部I(X(2)) ////////////////17/05/03
                            節点E = 部J(X(2))
                            LLL = 部材Span(節点S, 節点E)
                            if ( X(5) < 0 || InStr(strLL, "-") != 0 ) {
                                X(5) = L9 + Abs(X(5))
                            }
                            L9 = Abs(X(6))
                            if ( X(6) < 0 ) {
                                X(6) = LLL - L9
                            }
                            gRuPF(J8CUNT, CUNT8, 2) = X(5)
                            gRuPF(J8CUNT, CUNT8, 3) = X(6) //////////////////////17/05/03
                        } else {
                            if ( reed = X(2) * 1000 + X(3) ) {
                                gRuP(J8CUNT, 2) = CUNT
                                CUNT8 = CUNT8 + 1
                                gRuPF(J8CUNT, CUNT8, 1) = X(4)
            //                        gRuPF(J8CUNT, CUNT8, 2) = X(5)
            //                        gRuPF(J8CUNT, CUNT8, 3) = X(6)
                                gRuPF(J8CUNT, CUNT8, 4) = X(7)
                                gRuPF(J8CUNT, CUNT8, 5) = X(8)
                                if ( X(5) < 0 || InStr(strLL, "-") != 0 ) { //////////////////////17/05/03
                                    X(5) = L9 + Abs(X(5))
                                }
                                L9 = Abs(X(6)) + L9
                                if ( X(6) < 0 ) {
                                    X(6) = LLL - L9
                                }
                                gRuPF(J8CUNT, CUNT8, 2) = X(5)
                                gRuPF(J8CUNT, CUNT8, 3) = X(6)
                                strLL = ""
            //                        m距離符号(Now荷重max1) = "" //////////////////////17/05/03
                            } else {
                                J8CUNT = J8CUNT + 1
                                gRuP(J8CUNT, 1) = CUNT
                                gRuP(J8CUNT, 2) = CUNT
                                gRuP(J8CUNT, 3) = X(2) * 1000 + X(3)

                                CUNT8 = 1
                                gRuPF(J8CUNT, CUNT8, 1) = X(4)
                                gRuPF(J8CUNT, CUNT8, 2) = X(5)
                                gRuPF(J8CUNT, CUNT8, 3) = X(6)
                                gRuPF(J8CUNT, CUNT8, 4) = X(7)
                                gRuPF(J8CUNT, CUNT8, 5) = X(8)
                            }
                        }
                    } else {
                        if ( gRuP(J8CUNT, 1) != 0 ) {
                            if ( gRuP(J8CUNT, 1) = gRuP(J8CUNT, 2) ) {
                                gRuP(J8CUNT, 1) = 0
                                gRuP(J8CUNT, 2) = 0
                                gRuP(J8CUNT, 3) = 0
                            } else {
                                J8CUNT = J8CUNT + 1
                            }
                        }
                    }
            //////08/11/06
                    gW1 = 999: gW3 = 999
                    if ( X(4) = 14 ) { //////////////////////////////08/10/255
                        if ( X(2) = 901 ) {
                            s連行前(1, 2) = X(7)
                        } else {if ( X(2) = 902 ) {
                            s連行後(1, 2) = X(7)
                        } else {if ( X(2) = 903 ) {
                            s連行前(2, 2) = X(7)
                        } else {if ( X(2) = 904 ) {
                            s連行後(2, 2) = X(7)
                        } else {
                            if ( s連行前(1, 2) != 0 ) { ////////////////////09/10/20
                                if ( s連行前節点(1) = 0 ) {
                                    s連行前(1, 1) = X(2)
                                    s連行前節点(1) = 部I(s連行前(1, 1))
                                }
                            }
                            if ( s連行前(2, 2) != 0 ) {
                                if ( s連行前節点(2) = 0 ) {
                                    s連行前(2, 1) = X(2)
                                    s連行前節点(2) = 部I(s連行前(2, 1))
                                }
                            }
                            s連行後(1, 1) = IIf(X(3) = 0, X(2), Abs(X(3)))
                            s連行後節点(1) = 部J(s連行後(1, 1))
                            s連行後(2, 1) = IIf(X(3) = 0, X(2), Abs(X(3)))
                            s連行後節点(2) = 部J(s連行後(2, 1))
                        } ////////////////////////////////////////////////////////09/10/20
                        if ( FlgDANS != 0 ) { //////////14/05/22
                            N1 = X(2) //       Start部材
                            N2 = X(3) //       End  部材
                            if ( N2 = 0 || N1 = N2 ) {
                                NNN = NNN + 1
                                DANS(NNN, 1) = N1
                                if ( 部材_max >= N1 ) {
                                    DANS(NNN, 2) = Round(LLLLL(N1), 3)
                                }
                                DANS(NNN, 3) = X(7)
                            } else {
                                g角度一連 = True
                                this.Check_BuzaiXXXX(N1, Abs(N2), 部材_max, 部I(), 部J(), BuzaiFF, GGGGG(), g角度一連, XS(9))
                                if ( BuzaiFF = -1 $$ N2 >= 0 ) { BuzaiFF = 0
                                if ( BuzaiFF = 0 ) {
                                    For( N4 = N1 To Abs(N2)
                                        NNN = NNN + 1
                                        DANS(NNN, 1) = N4
                                        DANS(NNN, 2) = Round(LLLLL(N4), 3)
                                        DANS(NNN, 3) = X(7)
                                    Next N4
                                } else {
                                    For( N4 = 1 To BuzaiFF
                                        NNN = NNN + 1
                                        DANS(NNN, 1) = GGGGG(N4)
                                        DANS(NNN, 2) = Round(LLLLL(GGGGG(N4)), 3)
                                        DANS(NNN, 3) = X(7)
                                    Next N4
                                }
                            }
                        }
                    }
                }
            Next
            if ( FLG車両ZU = False ) {
                Close #fno
            }
            if ( s連行前(1, 1) * s連行前(1, 2) = 0 ) {
                s連行前(1, 1) = 0
                s連行前(1, 2) = 0
            }
            if ( s連行前(2, 1) * s連行前(2, 2) = 0 ) {
                s連行前(2, 1) = 0
                s連行前(2, 2) = 0
            }
            if ( s連行後(1, 1) * s連行後(1, 2) = 0 ) {
                s連行後(1, 1) = 0
                s連行後(1, 2) = 0
                s連行後節点(1) = 0
            }
            if ( s連行後(2, 1) * s連行後(2, 2) = 0 ) {
                s連行後(2, 1) = 0
                s連行後(2, 2) = 0
                s連行後節点(2) = 0
            }
            //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////05/03/16
            var BBB As Integer, CCC As Integer
            var gabc() As Integer
            //    this.gabc(部材_max * 5)
            BBB = max(部材_max * 5, 荷重max) ////////08/11/28
            if ( BBB < 100 ) { BBB = 100
            this.gabc(BBB) //////////////////////////////////07/01/16
            寸法値記入 = ""
            strA = ""
            FlgKAZU = 0
            L9 = 0
            分布補正 = 0 //間隔 = 荷重図上盛上げ初期値
            N段数 = 1
            zX_ST = 9999
            zX_EN = -9999
            X_kajyu位置 = -99999
            Y_kajyu位置 = 99999
            連続荷重数 = 0
            BBB = 0: CCC = 0: ggg荷重段数 = 0
            //////////    fno = FreeFile
            //////////    Open FN1 For( Input As #fno
            //////////    Input #fno, D
            //////////    荷重max = val(D)
            var dPnt1 As Integer, dPnt2 As Integer
            var IJ_TAN As Integer
            var strY As String
            dPnt1 = 0
            dPnt2 = 0
            if ( mS部材(Now荷重max1) * mE部材(Now荷重max1) > 0 ) { //////17/03/09
                For( i = 1 To Now荷重max1
                    if ( m荷重mark(i) = 2 $$ (mE部材(i) = 0 || mS部材(i) = mE部材(i)) $$ m荷重_L1(i) = 0 $$ m荷重_L2(i) = 0 ) {
                        dPnt1 = i
                        Exit For
                    }
                }
            }
            if ( dPnt1 > 0 $$ 部材_max > 1 ) {
                IJ_TAN = 部J(mS部材(dPnt1))
                strY = m荷重方向(dPnt1)
                On Error Resume Next ////zzzzz  17/01/16
                For( i = dPnt1 + 1 To Now荷重max1
                    if ( IJ_TAN = 部I(i) $$ strY = m荷重方向(i) $$ m荷重mark(i) = 2 $$ _
                    (mE部材(i) = 0 || mS部材(i) = mE部材(i)) $$ m荷重_L1(i) = 0 $$ m荷重_L2(i) = 0 ) {
                        dPnt2 = i
                        IJ_TAN = 部J(i)
                    } else {
                        Exit For
                    }
                }

                if ( dPnt2 - dPnt1 > 0 $$ 部材_max >= dPnt1 || 部材_max >= dPnt2 ) {
                    For( i = dPnt1 To dPnt2
                        mS部材(i) = dPnt1
                        mE部材(i) = -dPnt2
                        if ( i != dPnt1 ) {
            //                    m荷重_L1(i) = "-0"
                            m距離符号(i) = "-0"
                        }
                        if ( strY = "" ) {
                            m荷重_L2(i) = -LLLLL(i)
                        } else {
                            節点S = 部I(S部材)
                            節点E = 部J(E部材)
                            X1 = Round(節X(節点S), 3)
                            X2 = Round(節X(節点E), 3)
                            m荷重_L2(i) = -(X2 - X1)
                        }
                    }
                    iKozo = 1
                    FR橋脚 = 1
                    RR橋脚 = 1
                }
            } else {if ( Now荷重max1 > 1 $$ mS部材(1) * mE部材(1) > 0 $$ mS部材(1) != mE部材(1) ) {  ////////17/05/02
                dPnt1 = 0
                this.g荷重_L1(Now荷重max1)
                this.g荷重_L2(Now荷重max1)
                this.g荷重_P1(Now荷重max1)
                this.g荷重_P2(Now荷重max1)
                this.g荷重方向(Now荷重max1)
                this.g距離符号(Now荷重max1)
                L9 = 0
                For( i = 1 To Now荷重max1
                    if ( m荷重mark(1) = 2 $$ m荷重mark(i) = 2 $$ mS部材(1) = mS部材(i) $$ mE部材(1) = mE部材(i) ) {
                        g荷重_L1(i) = m荷重_L1(i)
                        g荷重_L2(i) = m荷重_L2(i)
                        g荷重_P1(i) = m荷重_P1(i)
                        g荷重_P2(i) = m荷重_P2(i)
                        g荷重方向(i) = m荷重方向(i)
                        g距離符号(i) = m距離符号(i)
                        //
                        節点S = 部I(mS部材(i)) ////////////////17/05/03
                        節点E = 部J(mS部材(i))
                        LLL = 部材Span(節点S, 節点E)
                        if ( g荷重_L1(i) < 0 || InStr(g距離符号(i), "-") != 0 ) {
                            g荷重_L1(i) = L9 + Abs(g荷重_L1(i))
                        }
                        L9 = Abs(g荷重_L2(i)) + L9
                        if ( g荷重_L2(i) < 0 ) {
                            g荷重_L2(i) = LLL - L9
                        }
                        g距離符号(i) = "" ////////////////////////17/05/03
                    } else {
                        dPnt1 = i
                        Exit For
                    }
                }
                if ( dPnt1 = 0 ) {
                    For( CCC = mS部材(1) To mE部材(1)
                        For( i = 1 To Now荷重max1
                            dPnt1 = dPnt1 + 1
                            mS部材(dPnt1) = CCC
                            mE部材(dPnt1) = CCC
                            m荷重mark(dPnt1) = 2
                            m荷重_L1(dPnt1) = g荷重_L1(i)
                            m荷重_L2(dPnt1) = g荷重_L2(i)
                            m荷重_P1(dPnt1) = g荷重_P1(i)
                            m荷重_P2(dPnt1) = g荷重_P2(i)
                            m荷重方向(dPnt1) = g荷重方向(i)
                            m距離符号(dPnt1) = g距離符号(i)
                        }
                    Next CCC
                    Now荷重max1 = dPnt1
                    gRuP(1, 1) = 0 ////////////////////////////////////////////////////////17/05/02
                }
            }
            CCC = 999
            寸法左右(1) = 0: 寸法左右(2) = 0
            CUNT = 0 ////////09/11/15
            For( i = 1 To Now荷重max1 //////////荷重max ////////////2
            //        if ( EOF(fno) ) {
            //            Exit For
            //        }
            //        Line Input #fno, DA ////////// 04/10/18
            //        this.D_data(Chr(9), DA, XS(), X(), n, er1, strLL) ////// 05/02/27
            //        荷重方向 = XS(9) //////10/08/13
                    X(1) = 描画荷重case //////m荷重CASE(i) ////////////07/11/01
                    X(2) = mS部材(i) //////X(2)
                    X(3) = mE部材(i) //////X(3)
                    X(4) = m荷重mark(i) ////X(4)
                    X(5) = m荷重_L1(i) ////////X(5)
                    X(6) = m荷重_L2(i) ////////X(6)
                    X(7) = m荷重_P1(i) ////////X(7)
                    X(8) = m荷重_P2(i) ////////X(8)
                    XS(9) = m荷重方向(i)
                    strLL = m距離符号(i)
            //            X(10) = m節点J(i) ////////////////X(10)
            //            X(11) = m荷重_FX(i) ////////////X(11)
            //            X(12) = m荷重_FY(i) ////////////X(12)
            //            X(13) = m荷重_M(i) //////////////X(13)
                    荷重方向 = XS(9)

                if ( Abs(X(7)) + Abs(X(8)) != 0 $$ (X(4) != 14 $$ X(4) != 0) ) {
                    ////////////////////////
                    CUNT = CUNT + 1 ////////09/11/15
                    if ( CUNT = 1 $$ InStr(strLL, "-") != 0 ) {
                        strLL = Mid(strLL, InStr(strLL, "-") + 1) ////////09/11/15
                    }
                    前BUZA1 = 0 //////////07/11/079
                    前BUZA2 = 0
                    N1 = X(2) //       Start部材
                    N2 = X(3) //       End  部材
                    LL = 0
                    if ( Not (AAA(1) = X(1) $$ AAA(2) = N1 $$ AAA(3) = IIf(N2 = 0, -N1, N2)) ) { L9 = 0 ////////05/02/27   05/09/20 シングル部材も有効にする
                        if ( N2 = 0 ) { N2 = -N1
                        if ( N2 < 0 ) {
                        gP11 = uBuzai(N1 - 1).intItan
                        For( N3 = N1 To Abs(N2)
                            if ( gP11 != uBuzai(N3 - 1).intItan ) { ////////////09/02/13
                            For( M5 = 1 To 部材_max
                                if ( M5 != N3 $$ gP11 = uBuzai(M5 - 1).intItan ) {
                                    Pt1 = uBuzai(M5 - 1).intItan
                                    Pt2 = uBuzai(M5 - 1).intJtan
                                    if ( (uPoint(Pt1).sngPx = uPoint(Pt2).sngPx) ) {
                                        勾配2 = 1
                                    } else {
                                        勾配2 = (uPoint(Pt1).sngPy - uPoint(Pt2).sngPy) / (uPoint(Pt1).sngPx - uPoint(Pt2).sngPx)
                                    }
                                    if ( Abs(勾配 - 勾配2) < 0.1 ) {
                                        LL = LL + cmnBLen(Pt1, Pt2, XS(9))
                                    }
                                    if ( Pt2 != uBuzai(N3 - 1).intItan ) { ////////////09/02/13
                                        Exit For
                                    }
                                }
                            Next M5
                            }
                            Pt1 = uBuzai(N3 - 1).intItan
                            Pt2 = uBuzai(N3 - 1).intJtan
                            LL = LL + cmnBLen(Pt1, Pt2, XS(9)) ////////////07/07/26
                            if ( gP11 != Pt1 ) { 連番 = 0
                            gP11 = Pt2
                            //
                            if ( (uPoint(Pt1).sngPx = uPoint(Pt2).sngPx) ) {
                                勾配 = 1
                            } else {
                                勾配 = (uPoint(Pt1).sngPy - uPoint(Pt2).sngPy) / (uPoint(Pt1).sngPx - uPoint(Pt2).sngPx)
                            }
                        Next N3
                        }
                        if ( X(5) < 0 || InStr(strLL, "-") != 0 ) {
                            X(5) = L9 - X(5)
                        } else {
                            L9 = 0
                        }
                        if ( Not (X(4) = 4 || X(4) = 8 || X(4) = 9 || X(4) = 10 || X(4) >= 12) ) {
                            if ( X(6) < 0 ) { //////////////////////////////////////////////////// 05/02/27
                                if ( X(4) = 1 || X(4) = 5 || X(4) = 11 ) {
                                    X(6) = X(5) - X(6)
                                } else {
                                    if ( LL != 0 ) {
                                        X(6) = LL + X(6) - X(5)
                                    }
                                }
                            }
                        }
                        if ( X(4) = 1 || X(4) = 5 || X(4) = 11 ) {
                            L9 = X(6)
                        } else {
                            L9 = LL - X(6)
                        }
            ////////
                        AAA(1) = 描画荷重case //X(1)
                        AAA(2) = N1
                        AAA(3) = N2
                //
            //                BBB = BBB + 1
                        if ( X(4) = 6 $$ X(3) < 0 ) { ////////08/06/16
                            X(3) = -X(3)
                        }

                        荷重CASE = X(1)
                        S部材 = X(2)
                        if ( X(3) = 0 ) {
                            if ( X(2) > 0 $$ X(2) < 9999 ) {
                                X(3) = -X(2)
                            }
                        }
                        E部材 = X(3)
                        荷重mark = X(4)
                        荷重_L1 = Round(X(5), 3)
                        荷重_L2 = Round(X(6), 3)
                        荷重_P1 = X(7)
                        荷重_P2 = X(8)
            //////////// 05/05/21 //////////////////////////////////////////////////////////////// 水平部材で ーＥ部材にする
                        if ( E部材 > 0 ) {
                            節点S = 部I(S部材)
                            節点E = 部J(E部材)
                            X1 = Round(節X(節点S), 3)
                            y1 = Round(節Y(節点S), 3)
                            X2 = Round(節X(節点E), 3)
                            Y2 = Round(節Y(節点E), 3)
                        } else {
                            X1 = 0
                            X2 = 10
                        }
                        if ( (X1 != X2) ) {
                            if ( (Abs(y1 - Y2) / Abs(X1 - X2)) < 0.02 ) { //////水平部材
                                if ( (荷重mark = 2) $$ 荷重_L1 + 荷重_L2 = 0 _
                                            $$ S部材 > 0 $$ E部材 > 0 $$ S部材 < E部材 ) {
                                    E部材 = -E部材
                                }
                            }
                        }
            //////////// 05/05/21
                            MinusFlag = 0
                            if ( S部材 < 1 ) {
                                S部材 = 1
                            }
                            if ( E部材 = 0 ) {
                                E部材 = S部材
                            }
                            if ( E部材 < 0 ) {
                                MinusFlag = 1
                            }
                            if ( 荷重mark = 9 ) {
                                E部材 = Abs(E部材) //-*-*-*-*-*-*
                            }
                            II2 = E部材
                            if ( II2 < 0 ) {
                                II2 = S部材
                            }
                            if ( S部材 > 部材_max ) {
                                S部材 = 部材_max
                            }
                            if ( II2 > 部材_max ) {
                                II2 = 部材_max
                            }
                            FFGG = 1
                            SPMORIA = 0
                            StartB1 = S部材
                            EndB1 = II2
                                    For( ii = S部材 To II2
                                        if ( ii <= 部材_max $$ Abs(E部材) <= 部材_max ) {
                                            Select Case E部材
                                            Case Is < 0
                                                E部材 = -E部材
                                                節点S = 部I(S部材)
                                                節点E = 部J(E部材)
                                                部材1 = S部材
                                                部材2 = E部材
                                            Case } else {
                                                節点S = 部I(ii)
                                                節点E = 部J(ii)
                                                部材1 = ii
                                                部材2 = ii
                                                S部材 = ii
                                                E部材 = ii
                                            End Select
                        荷重_P1 = Round(X(7) * 数部材(ii), g桁数) ////////08/01/08
                        荷重_P2 = Round(X(8) * 数部材(ii), g桁数)
                                            X1 = Round(節X(節点S), 3)
                                            y1 = Round(節Y(節点S), 3)
                                            X2 = Round(節X(節点E), 3)
                                            Y2 = Round(節Y(節点E), 3)
                                            LLL = 部材Span(節点S, 節点E)
                                            Select Case 荷重mark
                                            Case 1, 5, 11
                                                if ( 荷重_P1 = 0 $$ 荷重_L1 = 0 ) {
                                                    荷重_P1 = 荷重_P2
                                                    荷重_P2 = 0
                                                    荷重_L1 = 荷重_L2
                                                    荷重_L2 = 0
                                                }
                                                if ( 荷重_P2 = 0 $$ 荷重_L2 = 0 ) { //////////07/06/11
                                                    荷重_L2 = 荷重_L1
                                                }
                                                X_STA = X1 + Round(min(荷重_L1, 荷重_L2) / LLL * (X2 - X1), 3)
                                                Y_STA = y1 + Round(min(荷重_L1, 荷重_L2) / LLL * (Y2 - y1), 3)
                                                X_END = X1 + Round(max(荷重_L1, 荷重_L2) / LLL * (X2 - X1), 3)
                                                Y_END = y1 + Round(max(荷重_L1, 荷重_L2) / LLL * (Y2 - y1), 3)
                                            Case 2, 3
                                                X_STA = X1 + Round((荷重_L1) / LLL * (X2 - X1), 3)
                                                Y_STA = y1 + Round((荷重_L1) / LLL * (Y2 - y1), 3)
                                                X_END = X1 + Round((LLL - 荷重_L2) / LLL * (X2 - X1), 3)
                                                Y_END = y1 + Round((LLL - 荷重_L2) / LLL * (Y2 - y1), 3)
                                            Case 4
                                                X_STA = X1
                                                Y_STA = y1
                                                X_END = X2
                                                Y_END = Y2
                                            Case } else {
                                                X_STA = X1
                                                Y_STA = y1
                                                X_END = X2
                                                Y_END = Y2
                                            End Select
                                            if ( 荷重mark = 1 || 荷重mark = 5 || 荷重mark = 11 ) {
                                                荷重向 = Sgn(Abs(荷重_P1 + 荷重_P2) + 0.00001)
                                                荷重符号 = 1
                                            } else {
                                                荷重向 = Sgn(荷重_P1 + 荷重_P2 + 0.00001)
                                                荷重符号 = 荷重向
                                            }
                                            Select Case 荷重mark
                                            Case 1, 5, 11
                                                荷重種類 = 1
                                            Case 2, 3, 4
                                                荷重種類 = 2
                                            Case } else {
                                                荷重種類 = 荷重mark
                                            End Select
                                            図モード = "連続"

                                            if ( 荷重方向 = "S" ) {
                                            } else {
                                                if ( y1 = Y2 || 荷重方向 = "V" || 荷重方向 = "M" ) {  //水平部材
                                                    if ( 荷重_L_ENDX > X_STA ) {
                                                        図モード = "NEW"
                                                    }
                                                } else {
                                                    if ( 荷重_L_ENDY < Y_STA ) {
                                                        図モード = "NEW"
                                                    }
                                                }
                                                if ( 前節点S != 節点S ) {
                                                    図モード = "NEW"
                                                }
                                                if ( 前節点E != 節点E ) {
                                                    図モード = "NEW"
                                                }
                                            }
                                            if ( 図モード = "NEW" ) { ////////// 05/03/02
                                                zX_ST = 9999
                                                zX_EN = -9999
                                                } ////////////////////////////////////////////////04/07/08
                                                寸法値記入 = ""
                                            水平垂直 = 9
                                            if ( X1 = X2 ) {
                                                水平垂直 = 1 // 垂直
                                            }
                                            if ( y1 = Y2 ) {
                                                水平垂直 = 0 // 水平
                                            }
                                            hosei = 0
                                            if ( X_STA = X_END $$ FR橋脚 = 1 ) {
                                                hosei = 4
                                                if ( 荷重mark = 1 || 荷重mark = 5 || 荷重mark = 11 ) {
                                                } else {
                                                    if ( 荷重_P1 + 荷重_P2 < 0 ) {
                                                        hosei = 2 // 荷重向
                                                    }
                                                }
                                                hosei = 2 // 10/5
                                            }
                                            if ( FR橋脚 = 1 ) {
                                                if ( 荷重mark = 2 $$ 水平垂直 = 0 ) { ////////// 05/02/05
                                                    if ( 荷重_P1 != 荷重_P2 ) { ////////// 05/02/05
                                                        CCC = 1
                                                    } else {
            //                                                if ( 図モード = "NEW" $$ CCC = 999 $$ 水平垂直 = 0 ) {
            //                                                CCC = 0
            //                                                }
                                                    }
                                                }
                                            }
                    if ( 図モード = "NEW" $$ CCC = 999 $$ 水平垂直 != 1 ) { ////////And 水平垂直 = 0 ) { 07/11/079
                        CCC = 0
                    }
            //            if ( 図モード = "NEW" $$ CCC != 999 ) { BBB = BBB + 1
                    if ( 図モード = "NEW" ) {
            //                if ( 荷重種類 <= 2 $$ (YY_max - (y1 + Y2) / 2) < 0.2 ) {
                        if ( 荷重種類 <= 4 $$ (YY_max - (y1 + Y2) / 2) < 0.2 $$ 水平垂直 != 1 ) { //////05/05/21
            //                    if ( Not (荷重種類 = 2 $$ S部材 = II2 $$ 荷重_L1 + 荷重_L2 = 0) ) {
                            if ( Not (X(2) = 前BUZA1 $$ X(3) = 前BUZA2) ) { //////////////////////////////////////////////////07/11/079
                                ggg荷重段数 = ggg荷重段数 + 1
                                前BUZA1 = X(2)
                                前BUZA2 = X(3)
                            }
                        }
                        if ( CCC != 999 ) { BBB = BBB + 1
                    }
                        if ( CCC = 1 ) {
                            gabc(BBB) = CCC
                        }
                        CCC = 0
            ////////12/02/15                    if ( Not (荷重mark = 6 || 荷重mark = 7 || 荷重mark = 8) $$ XS(9) != "S" ) { //////10/08/13
                                        if ( XS(9) != "S" ) { //////12/02/15
                                            strA = "N"
                                            寸法値記入 = "N"
                                            連続荷重数 = 連続荷重数 + 1
                                            連続荷重mark(連続荷重数) = 荷重mark
                                            連続荷重_L1(連続荷重数) = Round(荷重_L1, 3)
                                            連続荷重_L2(連続荷重数) = Round(荷重_L2, 3)
                                            連続荷重_P1(連続荷重数) = 荷重_P1
                                            連続荷重_P2(連続荷重数) = 荷重_P2
                                            荷重_L_STAX = X_STA
                                            荷重_L_STAY = Y_STA
                                            荷重_L_ENDX = X_END
                                            荷重_L_ENDY = Y_END
                                            if ( 荷重mark = 1 || 荷重mark = 5 || 荷重mark = 11 ) {
                                                荷重符号 = 1
                                            } else {
                                                荷重符号 = 荷重向
                                            }
                                            if ( Y_STA = Y_END ) { zX_EN = max(zX_EN, max(X_STA, X_END))
                                                前節点S = 節点S
                                                前節点E = 節点E
                                                前荷重種類 = 荷重種類
                                                前寸法値記入 = 寸法値記入
                                                前荷重mark = 荷重mark
                                                前荷重_L1 = 荷重_L1
                                                前荷重_L2 = 荷重_L2
                                                前荷重_P1 = 荷重_P1
                                                前荷重_P2 = 荷重_P2
                                                前荷重符号 = 荷重符号
                                                前荷重方向 = 荷重方向
                                            }
                                            SS部材 = S部材
                                            EE部材 = E部材
                                        } ////////////////////////////////////////////////05/03/02
                                  }i
                    }
                }
            if ( FlgDANS != 0 ) { //////////14/05/22
            DANS(0, 0) = NNN
            return;
            }
                連続荷重_P1(連続荷重数 + 1) = 0
            //    Close #fno
                if ( 寸法値記入 = "N" $$ 連続荷重数 > 0 $$ CCC != 999 ) {
            //            if ( BBB = 0 ) { BBB = BBB + 1
                        if ( 荷重種類 <= 4 $$ (YY_max - (y1 + Y2) / 2) < 0.2 ) {
                            ggg荷重段数 = ggg荷重段数 + 1
                        }
                    BBB = BBB + 1
                    gabc(BBB) = max(CCC, 1)
                    CCC = 0
                }
            var gKajyuD As Integer ////////08/07/01
            gKajyuD = 0
            CCC = BBB //////////////////////////////////////// 段数 05/03/02
            fno = FreeFile
            this.部材正荷重数(部材_max)
            this.部材負荷重数(部材_max)
            this.節点荷重段数(1000, 4) ////////////////09/04/14//////////// nagase   //Erase 節点荷重段数
            this.Mark6荷重数(部材_max) //////10/02/07
            NC5 = 0
            e天端 = 0
            ////////    FN1 = FOLU & "K_Jitubuzai.txt"
            ////////    Open FN1 For( Input As #fno
            ////////    Input #fno, D
            hosei = 0
            分布補正 = 0 //間隔 = 荷重図上盛上げ初期値
            N段数 = 1
            zX_ST = 9999
            zX_EN = -9999
            連続荷重数 = 0
            荷重_L_STAX = -9000000000#
            荷重_L_STAY = -9000000000#
            荷重_L_ENDX = -9000000000#
            荷重_L_ENDY = -9000000000#
            前節点S = 0
            前節点E = 0
            M荷重(1) = -9000000000#
            M荷重(2) = -9000000000#
            //
            var y節点鉛直() As Single, str節点鉛直() As String
            this.y節点鉛直(Jn_max)
            this.str節点鉛直(Jn_max)
            var m節点モーメント() As Single, mCUNT As Single, mFLG As Single ////////08/11/04
            this.m節点モーメント(Jn_max * 3, 2) ////////08/11/04
            //
            var y節点水平() As Single, str節点水平() As String ////////13/11/24
            this.y節点水平(Jn_max)
            this.str節点水平(Jn_max)

            var ENG_BUZA As Integer //////09/07/22
            ENG_BUZA = 9999
            var つなぎ As Boolean ////////10/04/07
            var New段 As Boolean //////10/10/13
            var sDSTANC() As Single
            this.sDSTANC(2, 部材_max) //////13/04/08
            var LL88 As Single, LL99 As Single //////13/04/08
            var PP99 As Single //////13/04/08
            //
            前PRESUT = 0 //////////////////////////////07/08/04
            荷重max = val(D)
            寸法値記入 = ""
            W分布荷重 = ""
            strA = ""
            FlgKAZU = 0
            mCUNT = 0: mFLG = 0 ////////08/11/04
            BBB = 0 //////////////08/07/01
            AAA(1) = 0: AAA(2) = 0: AAA(3) = 0
            L9 = 0 ////////////////////////////////////////05/02/27
            CUNT = 0 //////08/11/06
            J8CUNT = 1 //////08/11/06
            N風圧 = 0 ////////////10/03/07
            KUIDAN = 0 //////12/02/15
            LLL789 = "" ////////13/04/04
            ////////
                    For( i = 1 To Now荷重max2 ////////13/04/30
                        X(10) = m節点J(i) ////////////////X(10)
                        X(11) = m荷重_FX(i) ////////////X(11)
                        X(12) = m荷重_FY(i) ////////////X(12)
                        X(13) = m荷重_M(i) //////////////X(13)
                        if ( X(10) != 0 $$ X(12) != 0 ) { //////荷重_FY //////////////08/08/28
                            if ( str節点鉛直(X(10)) = "" ) {
                                str節点鉛直(X(10)) = Format(Abs(X(12)), "0.00")
                                y節点鉛直(X(10)) = X(12)
                            } else {
                                str節点鉛直(X(10)) = str節点鉛直(X(10)) & IIf(X(12) > 0, "+", "-") & Format(Abs(X(12)), "0.00")
                            }
                        }
                        if ( X(10) != 0 $$ X(11) != 0 ) { //////荷重_FX //////////08/11/04
            //                    if ( y節点水平(X(10)) = 0 ) {
            //                        y節点水平(X(10)) = 1
            //                    } else {
            //                        y節点水平(X(10)) = 2
            //                        mFLG = 1
            //                    }
                            if ( str節点水平(X(10)) = "" ) { //////////////////////////////////////////////13/11/24
                                str節点水平(X(10)) = Format(X(11), "0.00")
                                y節点水平(X(10)) = X(11)
                            } else {
                                str節点水平(X(10)) = str節点水平(X(10)) & IIf(X(11) > 0, "+", "-") & Format(Abs(X(11)), "0.00")
                            }
                        }
                        if ( X(10) != 0 $$ X(13) != 0 ) { //////荷重_M //////////08/11/04
                            mCUNT = mCUNT + 1
                            m節点モーメント(mCUNT, 1) = X(10)
                            m節点モーメント(mCUNT, 2) = X(13)
                        }
                    }
            //
            var Now側壁連続 As Integer, z側壁連続 As Integer
            //Now側壁連続 = -1
            For( i = 1 To Now荷重max1 //////////荷重max ////////////3
            //////        if ( EOF(fno) ) {
            //////            Exit For
            //////        }
            //////        Line Input #fno, DA ////////// 04/10/18
            //////        this.D_data(Chr(9), DA, XS(), X(), n, er1, strLL) ////// 05/02/27
                    X(1) = 描画荷重case //////m荷重CASE(i) ////////////07/11/01
                    X(2) = mS部材(i) //////X(2)
                    X(3) = mE部材(i) //////X(3)
                    X(4) = m荷重mark(i) ////X(4)
                    X(5) = m荷重_L1(i) ////////X(5)
                    X(6) = m荷重_L2(i) ////////X(6)
                    X(7) = m荷重_P1(i) ////////X(7)
                    X(8) = m荷重_P2(i) ////////X(8)
                    XS(9) = m荷重方向(i)
                    strLL = m距離符号(i)
                if ( 描画荷重case = X(1) ) {
                    荷重方向 = XS(9) //////10/08/13
                    CUNT = CUNT + 1 ////////////08/11/06
                    if ( CUNT = 1 $$ InStr(strLL, "-") != 0 ) {
                        strLL = Mid(strLL, InStr(strLL, "-") + 1) ////////09/11/15
                    }
                if ( (Abs(X(7)) + Abs(X(8)) != 0 || InStr(strLL, "-") != 0) $$ _
                            Not (X(2) = 0 || X(2) > 部材_max) ) { //////05/03/01  06/04/04 $$ Not (X(2) = 0 || X(2) > 部材_max)
            ////////////////////////////////////////////////////////////////////////////// 05/02/27
                N1 = X(2) //       Start部材
                N2 = X(3) //       End  部材
            //        this.CHECK_側壁(N1, N2, z側壁連続)
            //        if ( Now側壁連続 = -1 $$ (z側壁連続 = 1 || z側壁連続 = 2) ) {
            //            Now側壁連続 = z側壁連続
            //        }
                LL = 0
            ////////////////////////////////////////////////////////////////////////////////////////////////////////////////09/10/14
                BuzaiMM = 0
                g角度一連 = True ////////09/10/20
                if ( N1 != 0 $$ N2 != 0 $$ N1 != N2 ) { //////////09/10/14
                    this.Check_BuzaiXXXX(N1, Abs(N2), 部材_max, 部I(), 部J(), BuzaiFF, GGGGG(), g角度一連, XS(9))
                    if ( BuzaiFF = -1 $$ N2 >= 0 ) { BuzaiFF = 0
                    if ( BuzaiFF = -1 ) {
                        this.KAJYU_CHK2(y荷重No(i)) //////14/10/13
                    } else {if ( BuzaiFF > 0 ) {
                        if ( XS(9) != "" ) { ////////09/10/20
                            BuzaiMM = 0
            //                    BuzaiFF = 0
                        } else {
                            BuzaiMM = BuzaiFF //////////10/04/17
                            N1 = 1
                            N2 = BuzaiFF
                        }
                    }
                 }
                 if ( g角度一連 $$ XS(9) = "V" ) {
                        if ( Abs(N2) > 0 ) {
                           if ( 節Y(部I(N1)) = 節Y(部J(Abs(N2))) ) {
                               if ( XS(9) = "V" ) { XS(9) = "" ////////10/08/13
                           }
                        } else {
                           if ( 節Y(部I(N1)) = 節Y(部J(N1)) ) {
                               if ( XS(9) = "V" ) { XS(9) = "" ////////10/08/13
                           }
                        }
                 } else {if ( XS(9) = "H" ) { ////////////10/03/03
            //                BuzaiMM = BuzaiFF
            //                N1 = 1
            //                N2 = BuzaiFF
                 } else {if ( Not g角度一連 $$ XS(9) = "H" $$ BuzaiFF > 0 $$ X(5) + X(6) = 0 $$ X(7) = X(8) $$ N2 < 0 ) { ////////09/10/24
                        BuzaiMM = BuzaiFF
                        N1 = 1
                        N2 = BuzaiFF
                 }
            ////////////////////////////////////////////////////////////////////////////////////////////////////////////////09/10/14
            //            k方向 = 0
            //            if ( XS(9) = "V" || XS(9) = "M" || XS(9) = "S" ) { ////////09/02/13
            //                k方向 = 2 ////////////////////鉛直距離
            //            } else {if ( XS(9) = "H" ) {
            //                k方向 = 1 ////////////////////水平距離
            //            }
            New段 = True ////////10/10/13
            連番 = 1
            if ( N1 > 0 ) {
                if ( Not (AAA(1) = X(1) $$ AAA(2) = N1 $$ AAA(3) = IIf(N2 = 0, -N1, N2)) ) {
                    L9 = 0 ////////05/02/27   05/09/20 シングル部材も有効にする
                    New段 = False ////////10/10/13
                }
                    if ( N2 = 0 ) { N2 = -N1
                    if ( N2 < 0 || BuzaiMM != 0 ) { //////////10/04/17
                        gP11 = uBuzai(N1 - 1).intItan
                        For( N4 = N1 To Abs(N2) ////////////////09/10/14
                            if ( BuzaiMM = 0 ) {
                                N3 = N4
                            } else {
                                N3 = GGGGG(N4)
                            } ////////////////09/10/14
                            if ( BuzaiMM = 0 ) { //////////10/04/17
                            if ( gP11 != uBuzai(N3 - 1).intItan ) { ////////////09/02/13
                            For( M5 = 1 To 部材_max
                                if ( M5 != N3 $$ gP11 = uBuzai(M5 - 1).intItan ) {
                                    Pt1 = uBuzai(M5 - 1).intItan
                                    Pt2 = uBuzai(M5 - 1).intJtan
                                    if ( (uPoint(Pt1).sngPx = uPoint(Pt2).sngPx) ) {
                                        勾配2 = 1
                                    } else {
                                        勾配2 = (uPoint(Pt1).sngPy - uPoint(Pt2).sngPy) / (uPoint(Pt1).sngPx - uPoint(Pt2).sngPx)
                                    }
                                    if ( Abs(勾配 - 勾配2) < 0.1 ) {
                                        LL = LL + cmnBLen(Pt1, Pt2, XS(9))
                                    }
                                    if ( Pt2 != uBuzai(N3 - 1).intItan ) { ////////////09/02/13
                                        Exit For
                                    }
                                }
                            Next M5
                            }
                            }
                            Pt1 = uBuzai(N3 - 1).intItan
                            Pt2 = uBuzai(N3 - 1).intJtan
                            L8 = cmnBLen(Pt1, Pt2, XS(9)) //////13/04/08
                            LL = LL + L8
                            sDSTANC(1, N4) = LL - L8
                            sDSTANC(2, N4) = LL ////////////////////////////13/04/08
                            if ( gP11 != Pt1 ) { 連番 = 0
                            gP11 = Pt2
                            //
                            if ( (uPoint(Pt1).sngPx = uPoint(Pt2).sngPx) ) {
                                勾配 = 1
                            } else {
                                勾配 = (uPoint(Pt1).sngPy - uPoint(Pt2).sngPy) / (uPoint(Pt1).sngPx - uPoint(Pt2).sngPx)
                            }
                        Next N4 ////////////09/10/14////////N3
                    }
                        if ( X(5) < 0 || InStr(strLL, "-") != 0 ) {
                            X(5) = Round(X(5), 3) //////09/10/20
                            X(5) = L9 - X(5)
                        } else {
                            L9 = 0
                            New段 = False ////////10/10/13
                        }
                        X(6) = Round(X(6), 3) //////09/10/20
                        つなぎ = False //////10/04/07
                        if ( Not (X(4) = 4 || X(4) = 8 || X(4) = 9 || X(4) = 10 || X(4) >= 12) ) {
                            if ( X(6) < 0 ) { //////////////////////////////////////////////////// 05/02/27
                                if ( X(4) = 1 || X(4) = 5 || X(4) = 11 ) {
                                    X(6) = X(5) - X(6)
                                } else {
                                    if ( LL != 0 ) {
                                        X(6) = LL + X(6) - X(5)
                                    }
                                }
                                つなぎ = True //////10/04/07
                            }
                            if ( X(4) = 1 || X(4) = 5 || X(4) = 11 ) {
                                L9 = X(6)
                            } else {
                                L9 = LL - X(6)
                            }
                            AAA(1) = X(1)
                            AAA(2) = N1
                            AAA(3) = N2
                        }
            }
            ////////////////////////////////////////////////////////////////////////////// 05/02/27
            //======================================================================
            //                if ( NoBuzaiKajuuJuuhukuFlag = 0 ) { ////////////////////////////// nagase　とりあえず　やめる
            //                    this.ConvertIunputJitsuKajuu2(X(), JI1(), JI2(), JI3(), JI4(), ChangeFlag(), SAFlag(), Acc, I)////// 04/10/05
            //                }
            //            if ( Not ((X(2) <= 0 || X(2) > 部材_max) $$ X(10) <= 0) ) {
                        ONajiKakuFlag = 1
            //                if ( ONajiFlag = 1 ) {
            //                    if ( ONajiKaku(i) = 1 ) {
            //                        ONajiKakuFlag = 1
            //                    } else {
            //                        ONajiKakuFlag = 0
            //                    }
            //                }
            var gStart As Integer, gEnd As Integer, nGNet1 As Integer, nGNet2 As Integer
            var dSS1 As Integer, dSS2 As Integer
            gStart = 0
            gEnd = 0
            CUNT8 = 0
            if ( gRuP(J8CUNT, 1) != 0 ) {
            if ( CUNT >= gRuP(J8CUNT, 1) $$ CUNT <= gRuP(J8CUNT, 2) ) { //08/11/066
                if ( CUNT = gRuP(J8CUNT, 2) ) {
                    gStart = gRuP(J8CUNT, 1)
                    gEnd = gRuP(J8CUNT, 2)
                    dSS1 = Int(gRuP(J8CUNT, 3) / 1000)
                    dSS2 = gRuP(J8CUNT, 3) - dSS1 * 1000
                    X(2) = dSS1 - 1
                } else {
                    GoTo G4G4G4
                }
            }
            } else {
            dSS1 = 0: dSS2 = 0 //////////08/12/06
            }
            For( nGNet1 = dSS1 To dSS2
            if ( gStart != 0 ) {
                X(2) = nGNet1
                X(3) = 0
                CUNT8 = 0
            }
            For( nGNet2 = gStart To gEnd
            if ( gStart != 0 ) {
                CUNT8 = CUNT8 + 1
                X(4) = gRuPF(J8CUNT, CUNT8, 1)
                X(5) = gRuPF(J8CUNT, CUNT8, 2)
                X(6) = gRuPF(J8CUNT, CUNT8, 3)
                X(7) = gRuPF(J8CUNT, CUNT8, 4)
                X(8) = gRuPF(J8CUNT, CUNT8, 5)
                if ( nGNet1 = dSS2 $$ nGNet2 = gEnd ) {
                    J8CUNT = J8CUNT + 1
                }
            }
            ////////////////////////////////////////////////////////09/10/09
            if ( X(2) != X(3) $$ X(3) > 0 $$ (X(4) = 2 || X(4) = 6) $$ _
                    Round(X(5), 3) + Round(X(6), 3) = 0 $$ X(7) = X(8) ) {
                S部材 = 0
                節点E = 部J(X(2))
                For( N3 = X(2) + 1 To X(3)
                    if ( 節点E != 部I(N3) ) {
                        S部材 = 1
                        Exit For
                    }
                    節点E = 部J(N3)
                Next N3
                if ( S部材 = 0 ) {
                    X(3) = -X(3)
                    N2 = X(3)
                }
            }
            //////////////////////////////////////////////////////////09/10/09
            BBB = BBB + 1 //////08/07/01
            //
            //                if ( X(4) = 6 $$ X(3) < 0 ) { ////////08/06/16//////09/11/13 やめた
            //                    X(3) = -X(3)
            //                }

                        FlgKAZU = FlgKAZU + 1
                        荷重CASE = X(1)
                        S部材 = X(2)
                        if ( X(3) = 0 ) {
                            if ( X(2) > 0 $$ X(2) < 9999 ) {
                                X(3) = -X(2)
                            }
                        }
                        E部材 = X(3)
                        荷重mark = X(4)
                        荷重_L1 = Round(X(5), 3)
                        荷重_L2 = Round(X(6), 3)
                        荷重_P1 = X(7)
                        荷重_P2 = X(8)
                        荷重方向 = XS(9)
            ////////09/07/22
            if ( 荷重mark = 14 $$ E部材 < 0 ) {
            ENG_BUZA = Abs(E部材)
            }
                        if ( 荷重mark > 0 ) {
            //////////// 05/05/21
                        MinusFlag = 0
                        if ( S部材 < 1 ) {
                            S部材 = 1
                        }
                        if ( E部材 = 0 ) {
                            E部材 = S部材
                        }
                        if ( E部材 < 0 ) {
                            MinusFlag = 1
                        }
                        節点S = 部I(S部材)
                        節点E = 部J(Abs(E部材))
                        X1 = Round(節X(節点S), 3)
                        y1 = Round(節Y(節点S), 3)
                        X2 = Round(節X(節点E), 3)
                        Y2 = Round(節Y(節点E), 3)
                        if ( (X1 != X2) ) {
                            if ( (Abs(y1 - Y2) / Abs(X1 - X2)) < 0.42 ) { //////水平部材 09/09/301 < 0.02
                                if ( (荷重mark = 2) $$ 荷重_L1 + 荷重_L2 = 0 _
                                            $$ S部材 > 0 $$ E部材 > 0 $$ S部材 < E部材 ) {
                                    //
                                    //////////06/01/26
                                    if ( Not (y1 = Y2 $$ Round((y1 + Y2) / 2, 3) != Round(節Y(Int((節点S + 節点E) / 2)), 3)) ) { //////////06/01/26
                                        if ( 荷重方向 = "V" || 荷重方向 = "H" || 荷重方向 = "M" ) { ////////09/09/301
                                            E部材 = -E部材 ////// +E部材 ---> -E部材
                                        }
                                    }
                                } else {if ( 連番 = 1 $$ E部材 < 0 $$ (荷重mark = 9 || 荷重mark = 14) $$ 荷重_L1 + 荷重_L2 = 0 ) {
                                    E部材 = -E部材 ////// -E部材 ---> +E部材
                                }
                            }
                        }
                        if ( 連番 = 0 $$ E部材 < 0 $$ (荷重mark = 9) $$ 荷重_L1 + 荷重_L2 = 0 ) {
                            E部材 = -E部材  ////// -E部材 ---> +E部材
                        }
            //////09/09/301
            var i7 As Integer, Y4 As Single
                        if ( Not (荷重方向 = "V" || 荷重方向 = "H" || 荷重方向 = "M") ) { ////////09/09/301
                            if ( E部材 < 0 $$ 荷重_P1 + 荷重_P2 > 0 ) { ////////And (荷重mark = 2) $$ 荷重_L1 + 荷重_L2 = 0 ) {
                                Y4 = max(y1, Y2)
                                if ( BuzaiFF > 0 $$ S部材 != Abs(E部材) ) { ////////12/12/15
                                    For( N4 = 1 To BuzaiFF
                                        i7 = GGGGG(N4)
                                        Y4 = max(Y4, 節Y(部I(i7)))
                                        Y4 = max(Y4, 節Y(部J(i7)))
                                    Next N4
                                } else { //////////////////////////////////////////////////////12/12/15
                                    For( i7 = S部材 To Abs(E部材)
                                        Y4 = max(Y4, 節Y(部I(i7)))
                                        Y4 = max(Y4, 節Y(部J(i7)))
                                    }7
                                }
                                Y4 = Round(Y4, 3) ////////////////////////09/10/20
                                if ( Y4 > max(y1, Y2) ) {
                                    E部材 = -E部材
                                }
                            }
                        }
            //////////// 05/05/21
            //                    MinusFlag = 0
            //                    if ( S部材 < 1 ) {
            //                        S部材 = 1
            //                    }
            //                    if ( E部材 = 0 ) {
            //                        E部材 = S部材
            //                    }
            //                    if ( E部材 < 0 ) {
            //                        MinusFlag = 1
            //                    }
            //                    if ( 荷重mark = 9 ) {
            //                        E部材 = Abs(E部材) //-*-*-*-*-*-*
            //                    }
            //                    if ( 荷重方向 = "" $$ y1 = Y2 $$ y1 != 節Y(Int((節点S + 節点E) / 2)) $$ Abs(節点S - 節点E) > 5 ) { //////////////////06/01/25
            //                        E部材 = Abs(E部材)
            //                    }
                            II2 = E部材
                            if ( II2 < 0 ) {
                                II2 = S部材
                            }
                            if ( S部材 > 部材_max ) {
                                S部材 = 部材_max
                            }
                            if ( II2 > 部材_max ) {
                                II2 = 部材_max
                            }
                            FFGG = 1
                            SPMORIA = 0
                            StartB1 = S部材
                            EndB1 = II2
            //////////////////////////////////////////////////////////////////Or 前荷重mark != 荷重mark を除いた  12/12/299
            var YHOSE4 As Single
            if ( (前節点S != 節点S || 前節点E != 節点E || 前荷重_L2 = 0) $$ 連続荷重数 != 0 ) { //////10/10/20//////12/12/17
                if ( Not (iKozo = 1 $$ 前荷重_L1 = 0 $$ 前荷重_L2 = 0 $$ 連続荷重数 <= 1 $$ 前荷重mark = 2 $$ _
                    Abs(節X(前節点S) - 節X(前節点E)) < 4 $$ 連続荷重_P1(1) = 連続荷重_P2(1)) ) { ////////14/1/15

                    this.部材荷重連続寸法(frmPrint.vsPrt1, 連続荷重数, 前節点S, 前節点E, 荷重図開き, _
                            前荷重方向, 連続荷重mark(), 連続荷重_L1(), 連続荷重_L2(), 連続荷重_P1(), 連続荷重_P2(), _
                            前hosei, SS部材, EE部材, 前荷重mark, 描画荷重case, 前BuzaiFF, yGGGGG()) //////10/03/07
                } else {
                    YHOSE4 = 5.2 //+ IIf((Abs(連続荷重_P1(1)) / BU荷重MAX) < 0.9, 3 * IIf(N段数 = 1, 0, 1), 0) //////17/08/16
                    if ( N段数 != 1 ) {
            //                if ( Abs(連続荷重_P1(1)) / BU荷重MAX < 0.92 $$ Abs(連続荷重_P1(1)) / BU荷重MAX > 0.8 ) {
            //                    YHOSE4 = YHOSE4 + 0.4
            //                } else {if ( Abs(連続荷重_P1(1)) / BU荷重MAX < 0.5 ) {
                            YHOSE4 = YHOSE4 + 1.3
            //                }
                    }
            //            if ( YHOSE4 > 5.2 ) { YHOSE4 = YHOSE4 // 5.2
            //                YHOSE4 = 部材荷重段位置(部材1, 部材2, 荷重向, 荷重mark, 荷重_L1, 荷重_L2, 水平垂直, _
            //                             max(Abs(荷重_P1), Abs(荷重_P2)), 荷重方向, 1, BuzaiFF, GGGGG(), 描画荷重case)
            //            if ( YHOSE4 < 3.5 ) { YHOSE4 = 3.5
                    For( k = SS部材 To EE部材 ////////////////////////////////////////////17/03/10 // 全面載荷で寸法が無いから。
                        if ( 部材正荷重数(k) > 集中荷重長さmax || rFlg = 0 ) {
                        if ( 荷重図開き > 0 ) {
            //                    部材正荷重数(k) = 部材正荷重数(k) - 5 - 0.5 * max((1 - Abs(荷重_P1) / BU荷重MAX), 0) ////////5//////10/03/27
                            部材正荷重数(k) = 部材正荷重数(k) + YHOSE4
                            } else {
                            部材負荷重数(k) = 部材負荷重数(k) + YHOSE4
                            }
                        }
                    }

                }
            }
                            RenZoku = 1 ////////////////////// nagase 04/02/21
                            if ( RenZoku = 0 ) {     // 部材番号が１つずつ昇順でなく、ばらばらで並んでいる場合（新仕様）
                                        if ( 図モード = "NEW" ) {
            zX_ST = 9999
            zX_EN = -9999
                                            }
                            } else {            // 部材番号が１つずつ昇順で並んでいる場合（今までの仕様）
            //                        if ( MAXREN > 1 ) { //////// 05/03/02  ////
            //
            var II1 As Integer, II3 As Integer ////////09/10/14
            var FLG_BUZA As Boolean //////13/04/08
                    if ( BuzaiMM = 0 ) {
                        II1 = S部材
                    } else {
                        II1 = 1
                        II2 = 1 //////////BuzaiMM//////////10/04/17
                    }
            if ( g角度一連 = False $$ BuzaiMM != 0 $$ XS(9) = "" ) { //////13/04/08
                II1 = S部材
                II2 = Abs(E部材)
                BuzaiFF = 0
                部材正荷重数(S部材) = 0
                DDAN(部I(S部材)) = 0
                DDAN(部J(S部材)) = 0
                LL88 = 荷重_L1
                LL99 = 荷重_L2
                勾配2 = (X(8) - X(7)) / (LL - LL88 - LL99)
                勾配 = X(7)
                PP99 = X(8)
                W分布荷重 = ""
                if ( E部材 < 0 ) {
                    FLG_BUZA = True
                } else {
                    FLG_BUZA = False
                }
            }
            //        this.CHECK_側壁(II1, II2, z側壁連続)
            //        if ( Now側壁連続 = -1 $$ (z側壁連続 = 1 || z側壁連続 = 2) ) {
            //            Now側壁連続 = z側壁連続
            //        }
            var II9 As Integer //////15/11/17
            II9 = 0
                                    For( II3 = II1 To II2 //////S部材 To II2////////09/10/14
                                        if ( BuzaiMM = 0 ) {
                                            ii = II3
                                        } else {
                                            II9 = II9 + 1
                                            ii = GGGGG(II9) ////GGGGG(II3)//////15/11/17
                                            S部材 = ii
                                            E部材 = -GGGGG(BuzaiMM) ////////10/04/17
                                            if ( g角度一連 = False $$ BuzaiMM != 0 $$ XS(9) = "" ) { //////13/04/08
                                                E部材 = ii
                                                if ( 勾配 = PP99 ) { W分布荷重 = ""
                                                if ( FLG_BUZA = True ) {
                                                    荷重_L1 = 0
                                                    荷重_L2 = 0
                                                    if ( II3 = II1 ) {
                                                        荷重_L1 = LL88
                                                        X(7) = 勾配
                                                        X(8) = 勾配 + 勾配2 * (sDSTANC(2, II3) - LL88)
                                                    } else {if ( II3 = II2 ) {
                                                        荷重_L2 = LL99
                                                        X(7) = 勾配 + 勾配2 * (sDSTANC(1, II3) - LL88)
                                                        X(8) = PP99
                                                    } else {
                                                        X(7) = 勾配 + 勾配2 * (sDSTANC(1, II3) - LL88)
                                                        X(8) = 勾配 + 勾配2 * (sDSTANC(2, II3) - LL88)
                                                    }
                                                    X(7) = Round(X(7), 2)
                                                    X(8) = Round(X(8), 2)
                                                }
                                            } //////////13/04/08
                                        }
            //
             if ( GGBuzaiBai(ii) = 0 || KaSouFlag(ii) = 0.12 ) { ////////08/06/24////08/09/22
             GoTo Next_End //////////////08/06/24
             }
                                        if ( ii <= 部材_max $$ Abs(E部材) <= 部材_max ) {
                                            Select Case E部材
                                            Case Is < 0
                                                E部材 = -E部材
                                                節点S = 部I(S部材)
                                                節点E = 部J(E部材)
                                                部材1 = S部材
                                                部材2 = E部材
                                            Case } else {
                                                節点S = 部I(ii)
                                                節点E = 部J(ii)
                                                部材1 = ii
                                                部材2 = ii
                                                S部材 = ii
                                                E部材 = ii
                                            End Select
                        if ( 荷重mark = 14 ) {
                            荷重_P1 = Round(X(7) * 数部材(ii), 3) ////////08/01/08
                            荷重_P2 = Round(X(8) * 数部材(ii), 3)
                        } else {
                            荷重_P1 = Round(X(7) * 数部材(ii), g桁数) ////////08/01/08
                            荷重_P2 = Round(X(8) * 数部材(ii), g桁数)
                        }
                                            X1 = Round(節X(節点S), 3)
                                            y1 = Round(節Y(節点S), 3)
                                            X2 = Round(節X(節点E), 3)
                                            Y2 = Round(節Y(節点E), 3)
                                            LLL = 部材Span(節点S, 節点E)
                                            Select Case 荷重mark
                                            Case 1, 5, 11
                                                if ( 荷重_P1 = 0 $$ 荷重_L1 = 0 ) {
                                                    荷重_P1 = 荷重_P2
                                                    荷重_P2 = 0
                                                    荷重_L1 = 荷重_L2
                                                    荷重_L2 = 0
                                                }
                                                if ( 荷重_P2 = 0 $$ 荷重_L2 = 0 ) { ////////つなぎ = False ) { ////////10/04/07  //////////07/06/11
                                                    荷重_L2 = 荷重_L1
                                                }
                                                X_STA = X1 + Round(min(荷重_L1, 荷重_L2) / LLL * (X2 - X1), 3)
                                                Y_STA = y1 + Round(min(荷重_L1, 荷重_L2) / LLL * (Y2 - y1), 3)
                                                X_END = X1 + Round(max(荷重_L1, 荷重_L2) / LLL * (X2 - X1), 3)
                                                Y_END = y1 + Round(max(荷重_L1, 荷重_L2) / LLL * (Y2 - y1), 3)
            //
            if ( 荷重mark = 1 $$ N段数 = 1 $$ Not (g連続Mod $$ iKozo = 3) ) { ////////////07/05/14//////08/11/069
            if ( 節Y(部I(ii)) >= YY_max * 0.9 ) {
                if ( DDAN(部I(ii)) != 0 ) {
            //            DDAN(部I(II)) = 0.001 //////12/09/14
                    if ( DDAN(部J(ii)) = 0 ) { DDAN(部J(ii)) = 0.001
                }
            }
            if ( 節Y(部J(ii)) >= YY_max * 0.9 ) {
                if ( DDAN(部J(ii)) != 0 ) {
            //            DDAN(部J(II)) = 0.001 //////12/09/14
                    if ( DDAN(部I(ii)) = 0 ) { DDAN(部I(ii)) = 0.001
                }
            }
            }
                                            Case 2, 3, 6, 7 //////////// 6,7   05/05/28
                                                X_STA = X1 + Round((荷重_L1) / LLL * (X2 - X1), 3)
                                                Y_STA = y1 + Round((荷重_L1) / LLL * (Y2 - y1), 3)
                                                X_END = X1 + Round((LLL - 荷重_L2) / LLL * (X2 - X1), 3)
                                                Y_END = y1 + Round((LLL - 荷重_L2) / LLL * (Y2 - y1), 3)
                                            Case 4
                                                X_STA = X1
                                                Y_STA = y1
                                                X_END = X2
                                                Y_END = Y2
                                            Case } else {
                                                X_STA = X1
                                                Y_STA = y1
                                                X_END = X2
                                                Y_END = Y2
                                            End Select
                                            if ( 荷重mark = 1 || 荷重mark = 5 || 荷重mark = 11 ) {
                                                荷重向 = Sgn(Abs(荷重_P1 + 荷重_P2) + 0.00001)
                                                荷重符号 = 1
                                            } else {
                                                荷重向 = Sgn(荷重_P1 + 荷重_P2 + 0.00001)
                                                荷重符号 = 荷重向
                                            }
                                            Select Case 荷重mark
                                            Case 1, 5, 11
                                                荷重種類 = 1
                                            Case 2, 3, 4
                                                荷重種類 = 2
                                            Case 6 //////////////////////////////////////////////05/05/28
                                                荷重種類 = 6
                                                荷重向 = 1 ////////12/02/15
                                                荷重符号 = 1 ////////12/02/15
                                            Case } else {
                                                荷重種類 = 荷重mark
                                            End Select
                                            図モード = "連続"
                                            if ( 荷重方向 = "S" || (荷重mark = 2 $$ InStr(strLL, "-") != 0) ) { ////////09/10/20
                                            } else {
                                                if ( y1 = Y2 || 荷重方向 = "V" || 荷重方向 = "M" ) {  //水平部材
                                                    if ( 荷重_L_ENDX > X_STA ) {
                                                        図モード = "NEW"
                                                    }
                                                } else {
                                                    if ( 荷重_L_ENDY < Y_STA ) {
                                                        図モード = "NEW"
                                                    }
                                                }
                                                if ( 前節点S != 節点S ) {
                                                    図モード = "NEW"
                                                }
                                                if ( 前節点E != 節点E ) {
                                                    図モード = "NEW"
                                                }
                                                if ( 水平垂直 = 9 $$ 前荷重mark != 荷重mark ) { //////////07/01/077
                                                    図モード = "NEW"
                                                }
                                                if ( 前荷重符号 != 荷重向 ) {  //////////07/12/13
                                                    図モード = "NEW"
                                                }
            ////////////15/03/21
                                                if ( 図モード != "NEW" $$ (荷重mark = 2 || 前荷重mark = 3 || 前荷重mark = 34) ) {
                                                    if ( 荷重_L1 - 前荷重_L2 < 0.2 $$ 前荷重mark != 荷重mark ) {
                                                        図モード = "NEW"
                                                    }
                                                }
                                            }
            //                                    if ( New段 = False $$ InStr(部材名(S部材), "杭") != 0 ) {
            //                                    図モード = "NEW" ////////10/10/13 12/02/15 コメントにした
            //                                    }
                                            if ( 図モード = "NEW" ) {
                                                zX_ST = 9999
                                                zX_EN = -9999
                                                if ( 寸法値記入 = "N" $$ 連続荷重数 > 0 ) {
            //                    if ( (連続荷重mark(1) = 6) ) { ////////08/10/099
                            if ( (連続荷重mark(1) = 2 $$ (前荷重_L1 = 0 $$ 前荷重_L2 = 0) $$ (連続荷重_L1(1) + 連続荷重_L2(1) = 0)) _
                                                $$ Now側壁連続 != z側壁連続 ) {
                                連続荷重数 = 0
                                g荷重表記高 = 0 //////06/10/29
                                g荷重表記高5 = 0 //////09/11/13
                                rFlg = 0
            ////10/03/27
            //                        For( k = SS部材 To EE部材 //////////////////////////////////////////////07/05/14 // 全面載荷で寸法が無いから。
            //                            if ( DDAN(部I(k)) > 0 || DDAN(部J(k)) > 0 ) {
            //                                rFlg = 1
            //                                Exit For
            //                            }
            //                        }
                                if ( BuzaiFF > 0 $$ SS部材 != EE部材 ) { ////////12/12/15
                                    For( N4 = 1 To BuzaiFF
                                        k = GGGGG(N4)
                                        if ( 部材正荷重数(k) > 集中荷重長さmax || rFlg = 0 ) {
            //                                    部材正荷重数(k) = 部材正荷重数(k) - 5 - 0.5 * max((1 - Abs(荷重_P1) / BU荷重MAX), 0) ////////5//////10/03/27
                                        }
                                    Next N4
                                } else { //////////////////////////////////////////////////////12/12/15
                                    For( k = SS部材 To EE部材 //////////////////////////////////////////////07/05/14 // 全面載荷で寸法が無いから。
                                        if ( 部材正荷重数(k) > 集中荷重長さmax || rFlg = 0 ) {
            //                                    部材正荷重数(k) = 部材正荷重数(k) - 5 - 0.5 * max((1 - Abs(荷重_P1) / BU荷重MAX), 0) ////////5//////10/03/27
                                        }
                                    }
                                }
                            } else {
            //                    if ( Not ((連続荷重mark(1) = 6) $$ 連続荷重_L1(1) = 0 $$ 連続荷重_L2(1) = 0) ) { //05/09/20
                                                if ( RR橋脚 = 2 ) {
                                                    if ( 水平垂直 = 1 ) {
                                                        if ( 連続荷重mark(1) = 2 ) {
                                                            if ( InStr(部材名(S部材), "杭") = 0 || Not M杭mod ) {
                                                                hosei = 15
                                                            }
                                                        }
                                                    }
                                                }
            //                                        if ( gabc(BBB) = 1 ) {
            //                                            hosei = hosei + 2 / RRR
            //                                            For( k = 部材1 To 部材2 //////////////05/05/28
            //                                                部材正荷重数(k) = 部材正荷重数(k) // + 3 / RRR
            //                                            }
            //                                        }
            //                                        if ( ONajiKakuFlag = 1 ) {
                             ////////////05/05/30
            //                                        if ( Not (連続荷重数 <= 2 $$ (連続荷重mark(1) = 2 || 連続荷重mark(1) = 6) $$ 連続荷重_L1(1) = 0 $$ 連続荷重_L2(1) = 0) ) {
            k9 = 0
            if ( y節点S != 前節点S $$ y節点S > 0 ) { k9 = 1
            if ( y節点E != 前節点E $$ y節点E > 0 ) { k9 = 1 ////////////////1212999
            if ( k9 = 0 ) {
                For( k = 1 To 連続荷重数
                    if ( y連続荷重_L1(k) != 連続荷重_L1(k) || y連続荷重_L2(k) != 連続荷重_L2(k) ) {
                        k9 = 1
                        Exit For
                    }
                }
            }
            //    if ( Now側壁連続 = z側壁連続 ) { k9 = 0
            var TTTotal5 As Integer
            TTTotal5 = 連続荷重数 //////////////14/11/26
            if ( k9 = 1 ) {
                y節点S = 前節点S
                y節点E = 前節点E
                For( k = 1 To 連続荷重数
                    y連続荷重_L1(k) = 連続荷重_L1(k)
                    y連続荷重_L2(k) = 連続荷重_L2(k)
                }
                //
                this.部材荷重連続寸法(frmPrint.vsPrt1, 連続荷重数, 前節点S, 前節点E, 荷重図開き, _
                        前荷重方向, 連続荷重mark(), 連続荷重_L1(), 連続荷重_L2(), 連続荷重_P1(), 連続荷重_P2(), _
                        前hosei, SS部材, EE部材, 前荷重mark, 描画荷重case, 前BuzaiFF, yGGGGG()) //////10/03/07
            //        Now側壁連続 = -1
            } else {
            //        if ( Now側壁連続 != z側壁連続 ) {
                連続荷重数 = 0
                寸法値記入 = ""
            //        }
                var GHOSEI As Single
                GHOSEI = Round(min(hosei, -2), 2) * 2
                if ( 前荷重mark = 2 || 前荷重mark = 4 ) {
                    GHOSEI = Round((g荷重表記高5 / 56.7), 2) // + 0.8 ////////17/08/11//////// * 1.7
                    if ( GHOSEI < 4.5 ) { //////////////////////////////////////////17/08/11
                        GHOSEI = GHOSEI + 2
                    } else {if ( GHOSEI > 6 ) {
                        GHOSEI = GHOSEI / 2
                    } else {
                        GHOSEI = GHOSEI / 2 ////// + 0.8
                    }
                }
                 //////////////////////////////////////////////////////10/06/02
                        if ( BuzaiFF > 0 $$ SS部材 != EE部材 ) { ////////12/12/15
                            For( N4 = 1 To BuzaiFF
                                 k = GGGGG(N4)
                                 if ( 荷重図開き >= 0 || (iKozo = 3 $$ g連続Mod) ) {
                                     部材正荷重数(k) = 部材正荷重数(k) + GHOSEI
                                 } else {
                                     部材負荷重数(k) = 部材負荷重数(k) + GHOSEI
                                 }
                            Next N4
                        } else { //////////////////////////////////////////////////////12/12/15
                            For( k = SS部材 To EE部材
                                 if ( 荷重図開き >= 0 || (iKozo = 3 $$ g連続Mod) ) {
                                     部材正荷重数(k) = 部材正荷重数(k) + GHOSEI
                                 } else {
                                     部材負荷重数(k) = 部材負荷重数(k) + GHOSEI
                                 }
                            }
                        }
                }
                                                    前hosei = hosei
            //                                            hosei = 前hosei
                                                    BBB = BBB + 1
                                                    KAJYUstrEND = -99999999
                                                }
            //                                            if ( 水平垂直 = 1 ) {
                                                        if ( 柱間離れ(1) >= 節X(前節点S) $$ 節X(前節点S) = 節X(前節点E) ) { 寸法左右(1) = 1
                                                        if ( 柱間離れ(2) <= 節X(前節点S) $$ 節X(前節点S) = 節X(前節点E) ) { 寸法左右(2) = 1
            //                                            }
            //                                            BBB = BBB + 1
            //                                            KAJYUstrEND = -99999999
            //                                        }
                                                } ////////////////////////////////////////////////04/07/08
                                                寸法値記入 = ""
                                                if ( 荷重方向 != "S" ) {
            //
            var sNUM5 As Integer, ZX1 As Single, ZX2 As Single ////////08/11/069
            var wHOSE As Single //////08/11/14
            if ( 荷重_L1 = 0 $$ 荷重_L2 = 0 ) { //////08/11/14
                if ( (max(Abs(荷重_P1), Abs(荷重_P2)) / BU荷重MAX) < 1.7 ) {
                    wHOSE = 0.005
                } else {
                    wHOSE = 0.003
                }
            } else {
                wHOSE = 0.007
                if ( (max(Abs(荷重_P1), Abs(荷重_P2)) / BU荷重MAX) < 1.7 ) {
                    wHOSE = 0.007
                } else {
                    wHOSE = 0.009
                }
            }
            if ( 節Y(部I(ii)) > YY_max * 0.9 ) {
                ZX1 = JX_min: ZX2 = JX_max
            } else {
                ZX1 = g柱X座標(1, 1): ZX2 = g柱X座標(g柱本数, 1)
            }
            //
            //    if ( g連続Mod || g節点M = 1 || 節Y(部I(II)) > YY_max * 0.9 ) { ////////08/11/13 || 節Y(部I(II)) > YY_max * 0.9
            //        sNum5 = 1
            //    } else {
            //        sNum5 = Sgn(N段数 - 1)
            //    }
            Atta = 0 ////////08/11/13
            if ( 下層BUZAI(1, 1) != 0 ) {
                For( M = 1 To 部材_max
                    if ( 下層BUZAI(M, 1) = 0 ) { Exit For
                    if ( 下層BUZAI(M, 1) >= S部材 $$ 下層BUZAI(M, 1) <= Abs(E部材) ) {
                        Atta = 1
                        Exit For
                    }
                Next M
            }
            sNUM5 = 1 ////////08/11/13
            WWW = 0 //////08/11/03
                if ( (X1 != X2) $$ WWW = 0 ) { ////////////////////////////////////////////////////////////////// 05/03/16
                if ( BuzaiFF > 0 $$ 部材1 != 部材2 ) { //////////////////12/12/15
                    For( N4 = 1 To BuzaiFF
                        k = GGGGG(N4)
                        if ( (DDAN(部I(k)) != 0 $$ ZX1 <= 節X(部I(k))) || (DDAN(部J(k)) != 0 $$ ZX2 >= 節X(部J(k))) ) { //////10/01/30
                            if ( 荷重mark != 1 $$ 部材正荷重数(k) = 0 ) { ////////08/11/03
                                if ( Atta = 1 ) {
                                    if ( 下層BUZAI(1, 2) != 部I(k) ) { ////////08/11/13
                                        DDAN(部I(k)) = Int(DDAN(部I(k)) * 100) / 100 + wHOSE //////08/11/14
                                    }
                                    if ( 下層BUZAI(y最低CUNT, 3) != 部J(k) ) {
                                        DDAN(部J(k)) = Int(DDAN(部J(k)) * 100) / 100 + wHOSE //////08/11/14
                                    }
                                    if ( 下層BUZAI(1, 2) != 部I(k) $$ 下層BUZAI(y最低CUNT, 3) != 部J(k) ) {
                                        DDAN(部I(k)) = max(DDAN(部I(k)), DDAN(部J(k)))
                                        DDAN(部J(k)) = max(DDAN(部J(k)), DDAN(部I(k)))
                                    }
                                }
                                if ( iKozo = 1 $$ X(3) >= 0 $$ (荷重mark = 2 || 荷重mark = 3) $$ 荷重_L1 != 0 $$ 荷重_L2 != 0 ) {
            //                                部材正荷重数(k) = 部材正荷重数(k) + min(Round(集中荷重長さmax / 2.5, 1), max(DDAN(部I(k)), DDAN(部J(k)))) * sNUM5 //////08/11/13
                                } else {
                                    if ( N段数 = 1 ) { //////10/03/27
            //                                部材正荷重数(k) = 部材正荷重数(k) + max(DDAN(部I(k)), DDAN(部J(k))) * sNUM5 //////08/11/13
                                    }
                                }
                                WWW = 1
                            } else {if ( 荷重mark = 1 $$ 部材正荷重数(k) = 0 $$ max(DDAN(部I(k)), DDAN(部J(k))) * sNUM5 != 0 ) { //////10/01/188
                                if ( max(DDAN(部I(k)), DDAN(部J(k))) * sNUM5 = 0.002 || max(DDAN(部I(k)), DDAN(部J(k))) * sNUM5 = 6 ) {
                                    if ( N段数 = 1 ) { //////10/03/27
            //                            部材正荷重数(k) = 部材正荷重数(k) + 6.01 //////12.01 ////////4.01//////////10/01/30//////10/03/27
                                    }
                                } else {if ( max(DDAN(部I(k)), DDAN(部J(k))) * sNUM5 > 10 ) { //////10/01/188
            //                            部材正荷重数(k) = 部材正荷重数(k) + IIf(yP88 < 1000, 13.01, 15.51)
                                } else {
            //                            部材正荷重数(k) = 部材正荷重数(k) + 12.01
                                }
                            }
                        }
                    Next N4
                } else { //////////////////////////////////////////////////////12/12/15
                    For( k = 部材1 To 部材2 ////////////////////////////////////////////////////////////////////////// 05/03/24 節点荷重があった時は部材荷重を上げる
                        if ( (DDAN(部I(k)) != 0 $$ ZX1 <= 節X(部I(k))) || (DDAN(部J(k)) != 0 $$ ZX2 >= 節X(部J(k))) ) { //////10/01/30
                            if ( 荷重mark != 1 $$ 部材正荷重数(k) = 0 ) { ////////08/11/03
                                if ( Atta = 1 ) {
                                    if ( 下層BUZAI(1, 2) != 部I(k) ) { ////////08/11/13
                                        DDAN(部I(k)) = Int(DDAN(部I(k)) * 100) / 100 + wHOSE //////08/11/14
                                    }
                                    if ( 下層BUZAI(y最低CUNT, 3) != 部J(k) ) {
                                        DDAN(部J(k)) = Int(DDAN(部J(k)) * 100) / 100 + wHOSE //////08/11/14
                                    }
                                    if ( 下層BUZAI(1, 2) != 部I(k) $$ 下層BUZAI(y最低CUNT, 3) != 部J(k) ) {
                                        DDAN(部I(k)) = max(DDAN(部I(k)), DDAN(部J(k)))
                                        DDAN(部J(k)) = max(DDAN(部J(k)), DDAN(部I(k)))
                                    }
                                }
                                if ( iKozo = 1 $$ X(3) >= 0 $$ (荷重mark = 2 || 荷重mark = 3) $$ 荷重_L1 != 0 $$ 荷重_L2 != 0 ) {
            //                                部材正荷重数(k) = 部材正荷重数(k) + min(Round(集中荷重長さmax / 2.5, 1), max(DDAN(部I(k)), DDAN(部J(k)))) * sNUM5 //////08/11/13
                                } else {
                                    if ( N段数 = 1 ) { //////10/03/27
            //                                部材正荷重数(k) = 部材正荷重数(k) + max(DDAN(部I(k)), DDAN(部J(k))) * sNUM5 //////08/11/13
                                    }
                                }
                                if ( 部材正荷重数(k) != 0 ) { WWW = 1 //////13/04/08
                            } else {if ( 荷重mark = 1 $$ 部材正荷重数(k) = 0 $$ max(DDAN(部I(k)), DDAN(部J(k))) * sNUM5 != 0 ) { //////10/01/188
                                if ( max(DDAN(部I(k)), DDAN(部J(k))) * sNUM5 = 0.002 || max(DDAN(部I(k)), DDAN(部J(k))) * sNUM5 = 6 ) {
                                    if ( N段数 = 1 ) { //////10/03/27
            //                            部材正荷重数(k) = 部材正荷重数(k) + 6.01 + 2 //////12.01 ////////4.01//////////10/01/30//////10/03/27
                                    }
                                } else {if ( max(DDAN(部I(k)), DDAN(部J(k))) * sNUM5 > 10 ) { //////10/01/188
            //                            部材正荷重数(k) = 部材正荷重数(k) + IIf(yP88 < 1000, 13.01, 15.51)
                                } else {
            //                            部材正荷重数(k) = 部材正荷重数(k) + 12.01 ////////10/01/30
                                }
                            } //////////////////08/11/03
                        }
                    }
                    } //////12/12/15
                    if ( WWW = 1 ) { N段数 = 2 //N段数 + 1 //////////08/11/03
                }
                //////////////////06/01/26 コメントにした
                                        } ////////////////////////////////////////////////04/07/08
                                            水平垂直 = 9
                                            if ( X1 = X2 || 荷重方向 = "H" ) { ////////10/03/07
                                                水平垂直 = 1 // 垂直
                                            }
                                            if ( y1 = Y2 ) {
                                                水平垂直 = 0 // 水平
                                            }
                    if ( 部材1 = 部材2 ) {
                        BuzaiFF = 0
                    }
                    if ( (荷重_P1 + 荷重_P2 + 0.0001 > 0) || (荷重mark = 1 || 荷重mark = 5 || 荷重mark = 9 || 荷重mark = 10 || 荷重mark = 11) _
                        || (iKozo = 3 $$ g連続Mod) ) { //////10/03/24
                        荷重図開き = 部材荷重段位置(部材1, 部材2, 荷重向, 荷重mark, 荷重_L1, 荷重_L2, 水平垂直, _
                                     max(Abs(荷重_P1), Abs(荷重_P2)), 荷重方向, 0, BuzaiFF, GGGGG(), 描画荷重case) * Twip //10/03/07
                    } else {
                        荷重図開き = -部材荷重段位置(部材1, 部材2, 荷重向, 荷重mark, 荷重_L1, 荷重_L2, 水平垂直, _
                                     max(Abs(荷重_P1), Abs(荷重_P2)), 荷重方向, 1, BuzaiFF, GGGGG(), 描画荷重case) * Twip //10/03/07
                    }
             下床文字表示 = 0 //////////09/12/03
             if ( Atta = 1 $$ 荷重mark = 2 ) {
                if ( 荷重_P1 != 荷重_P2 ) { 下床文字表示 = 1 ////09/12/03
                if ( 荷重_P1 * 荷重_P2 < 0 ) {
                   if ( 下床文字表示 = 0 ) {
                        荷重図開き = Abs(荷重図開き) ////////09/12/04
                   } else {
                        荷重図開き = -(荷重図開き)
                   }
                }
             }
            //                      } //////08/11/069
                                            hosei = 0
                                            if ( X_STA = X_END $$ FR橋脚 = 1 ) {
                                                hosei = 4
                                                if ( 荷重mark = 1 || 荷重mark = 5 || 荷重mark = 11 ) {
                                                } else {
                                                    if ( 荷重_P1 + 荷重_P2 < 0 ) {
                                                        hosei = 2 // 荷重向
                                                    }
                                                }
                                                hosei = 2 // 10/5
                                            }
                                            if ( Y_STA = Y_END $$ FR橋脚 = 2 ) {
            //                                        hosei = 4
                                            }
                                            if ( FR橋脚 = 1 || FR橋脚 = 2 ) {
                                                if ( 荷重mark = 2 $$ ((荷重_P1 = 荷重_P2 $$ 荷重_P1 != 0) || (荷重_L1 + 荷重_L2 = 0)) ) { //////08/10/15
                                                    if ( 荷重_P1 = 0 ) { //////08/11/26
                                                        hosei = -1.8
                                                    } else {
                                                        hosei = -max(1.5 * Abs(BU荷重MAX / 荷重_P1) ^ 0.3, 1.8)
                                                    }
                                                    if ( (Abs(荷重_P1) / BU荷重MAX) > 0.75 ) { hosei = 0.5
            //                                        } ////////// 08/10/29
                                                } else {if ( 荷重mark = 2 ) { ////////// 05/02/05 ////////// 08/10/29
                                                    if ( gabc(BBB) != 0 ) { ////////// 08/09/26
                                                        if ( 荷重_P1 != 荷重_P2 $$ 荷重_P1 * 荷重_P2 != 0 ) { ////////// 08/10/29
                                                        hosei = max(7 * (max(Abs(荷重_P1), Abs(荷重_P2)) / BU荷重MAX) ^ 0.5, 5.8)
                                                        }
                                                    } else {if ( 荷重_P1 != 荷重_P2 $$ 荷重_P1 * 荷重_P2 != 0 ) { ////////// 08/10/29
                                                        if ( (max(Abs(荷重_P1), Abs(荷重_P2)) / BU荷重MAX) > 0.9 ) {
                                                            hosei = -max((1.3 * Abs(BU荷重MAX / max(Abs(荷重_P1), Abs(荷重_P2))) ^ 1.3), 5.5)
                                                        }
                                                    } else {
            //                                                if ( 荷重_P1 != 0 ) { ////////// 08/10/29
                                                            if ( 荷重_P1 = 荷重_P2 $$ 荷重_L1 = 0 $$ 荷重_L2 = 0 ) {
            //                                                        hosei = -max(2.2 * Abs(BU荷重MAX / 荷重_P1) ^ 0.7, 8) // 05/09/20
            //                                                        if ( iKozo = 3 ) {
                                                                    hosei = -max((1.3 * Abs(BU荷重MAX / 荷重_P1) ^ 1.3), 4.5)
                                                                    hosei = -min(Abs(hosei), 6)
            //                                                        } else {
            //                                                            hosei = -max(1.1 * Abs(BU荷重MAX / 荷重_P1) ^ 0.4, 1.8) // 05/03/24
            //                                                        }
                                                            } else {
            //                                                        hosei = -max(1.1 * Abs(BU荷重MAX / 荷重_P1) ^ 0.4, 1.8) // 05/03/24
                                                                hosei = -min(2.5, Abs(hosei))
                                                            }
            //                                                } ////////// 08/10/29
                                                    }
                                                }
                                                if ( 荷重mark = 3 ) {
            //                                            hosei = -max(2 * Abs(BU荷重MAX / 荷重_P1) ^ 0.3 / 4, 0)
                                                    if ( (荷重_P1 / BU荷重MAX) < 0.5 ) { ////////////////////////////////////////////////////////06/09/06
                                                        if ( 荷重_P1 = 0 ) { //////08/11/26
                                                            hosei = -3.5 / 4
                                                        } else {
                                                            hosei = -max(3 * Abs(BU荷重MAX / 荷重_P1) ^ 0.3, 3.5) / 4
                                                        }
                                                    } else {
                                                        hosei = min(5 * Abs(BU荷重MAX / 荷重_P1) ^ 0.5 / 2, 2.5)
                                                    }
            //                                            hosei = -max(3 * (0.6 - Abs(BU荷重MAX / 荷重_P1) ^ 0.3), 3.5) / 4
            //                                            hosei = 0
                                                }
                                                if ( 荷重mark = 4 ) { ////////////////////////// 05/02/16
                                                    if ( 荷重_P1 = 荷重_P2 ) {
                                                        if ( 荷重_P1 = 0 ) { //////08/11/26
                                                            hosei = -2
                                                        } else {
                                                            hosei = -min(0.5 * Abs(BU荷重MAX / 荷重_P1) ^ 0.3, 2)
                                                        }
                                                    } else {
                                                        hosei = min(1.5 * Abs(BU荷重MAX / max(Abs(荷重_P1), Abs(荷重_P2))) ^ 0.3, 4)
                                                    }
                                                }
                                            }
                                            if ( FR橋脚 = 2 ) {
                                                if ( 荷重mark = 2 $$ ((荷重_P1 = 荷重_P2) || (荷重_L1 + 荷重_L2 = 0)) ) { //////08/10/15
                                                    hosei = -2
                                                    if ( 荷重_P1 != 0 ) { //////08/11/26
                                                    hosei = -max(1.5 * Abs(BU荷重MAX / 荷重_P1) ^ 0.4, 2) // 06/02/12
                                                    }
                                                }
                                                if ( 荷重mark = 3 ) {
                                                    hosei = -3.5
                                                }
                                                if ( (荷重mark = 4 $$ 荷重_P1 = 荷重_P2) ) {
                                                    hosei = -2
            //                                            hosei = -max(2.5 * Abs(BU荷重MAX / 荷重_P1) ^ 0.4, 2) // 06/02/12
                                                }
                                            }
                                            if ( 荷重mark = 6 || 荷重mark = 7 || 荷重mark = 8 ) {
                                                //  hosei = 0
                                                if ( 水平垂直 = 1 ) {
                                                    hosei = -4 //////// 05/05/30
                                                    if ( InStr(部材名(S部材), "杭") != 0 ) { ////12/02/15
                                                        hosei = 0
                                                    }
                                                }
                                            } else {
                                                if ( 荷重mark = 3 || (荷重mark = 4 $$ 荷重_P1 = 荷重_P2) ) {
                                                } else {
                                                    if ( FR橋脚 = 2 $$ 水平垂直 = 1 ) {
                                                        if ( N段数 = 1 ) {
                                                            hosei = 15
                                                        } else {
                                                            hosei = 2
                                                        }
                                                    } else {
                                                        if ( 水平垂直 = 1 ) {
                                                            if ( 荷重mark = 2 $$ iKozo = 3 ) { hosei = 6.8 } else { hosei = 0 ////////04/11/11
                                                        }
                                                        if ( 荷重mark = 2 $$ 荷重_P1 != 荷重_P2 $$ iKozo = 3 $$ 水平垂直 = 1 ) { // 垂直 05/05/02
                                                            hosei = 9.5 //8.8
                                                        }
                                                    }
                                                }
                                            }

                                            if ( Y_STA = Y_END $$ FR橋脚 = 2 ) {
            //                                        hosei = -2
                                            }
                                            if ( 荷重mark = 2 $$ 荷重_L1 + 荷重_L2 = 0 ) { //////12/09/10
                                                hosei = -0.5
                                            }

                                            if ( 荷重図フォーマット.int用紙方向 = 0 $$ Not (iKozo = 1 $$ 描画荷重case = 1) ) { //////07/02/17
                                                if ( CCC = 1 ) { hosei = hosei + 5 ////////// 05/03/02
                                                if ( CCC = 2 ) { hosei = hosei + 4 ////////// 05/03/02
                                            }
            //                      if ( k9 = 1 || 荷重mark = 1 ) { //////08/11/069
            ////////////////////////////////////10/01/30

            if ( 荷重mark = 1 $$ 荷重向 >= 0 $$ 部材正荷重数(部材1) < 26 $$ (部材正荷重数(部材1) * 100 - Int(部材正荷重数(部材1) * 100)) < 0.022 $$ _
            (部材正荷重数(部材1) * 100 - Int(部材正荷重数(部材1) * 100)) > 0.001 ) { //////13/06/07
            //    荷重図開き = 荷重図開き * 0.6 ////////13/06/07//////14/11/18
            } else {if ( 荷重mark = 1 $$ 水平垂直 = 1 ) {
            //    荷重図開き = 荷重図開き * 0.3 ////////14/11/17
            }
            //////        if ( BuzaiFF > 0 $$ 部材1 != 部材2 ) { ////////////////12/12/15
            //////            For( N4 = 1 To BuzaiFF
            //////                k = GGGGG(N4)
            //////                 if ( 荷重向 >= 0 || (iKozo = 3 $$ g連続Mod) ) {
            ////////                    部材正荷重数(k) = 部材正荷重数(k) + Round(IIf(hosei > 0, max(hosei, 1), hosei), 2)
            //////                 } else {
            ////////                    部材負荷重数(k) = 部材負荷重数(k) + Round(IIf(hosei > 0, max(hosei, 1), hosei), 2)
            //////                 }
            //////            Next N4
            //////        } else { //////////////////////////////////////////////////////12/12/15
            //////            For( k = 部材1 To 部材2
            //////                 if ( 荷重向 >= 0 || (iKozo = 3 $$ g連続Mod) ) {
            ////////                    部材正荷重数(k) = 部材正荷重数(k) + Round(IIf(hosei > 0, max(hosei, 1), hosei), 2)
            //////                 } else {
            ////////                    部材負荷重数(k) = 部材負荷重数(k) + Round(IIf(hosei > 0, max(hosei, 1), hosei), 2)
            //////                 }
            //////             }
            //////        }
            }
            //08/07/01
            var PP11, PP22, PP33
            //    if ( Not (荷重mark = 6 || 荷重mark = 7 || 荷重mark = 8) ) { //////////05/03/0////12/02/15
                gKajyuD = gKajyuD + 1
                PP11 = 連続荷重_P2(gKajyuD - 1)
                PP22 = 連続荷重_P1(gKajyuD + 1)
                PP33 = 連続荷重_P2(gKajyuD + 1)
            //    }
                            if ( OndoHenkaHyoujiFlag = 1 ) {
                                this.F部材荷重(frmPrint.vsPrt1, 節点S, 節点E, 荷重図開き, 荷重方向, 荷重mark, 荷重_L1, 荷重_L2, _
                                               荷重_P1, 荷重_P2, 部材1, 部材2, gabc(BBB), 描画荷重case, PP11, PP22, PP33, ENG_BUZA) ////////08/07/01
                            } else {
                                this.F部材荷重(frmPrint.vsPrt1, 節点S, 節点E, 荷重図開き, 荷重方向, 荷重mark, 荷重_L1, 荷重_L2, _
                                               荷重_P1, 荷重_P2, 部材1, 部材2, gabc(BBB), 描画荷重case, PP11, PP22, PP33, ENG_BUZA) ////////08/07/01
                            }
            //08/07/01
                                        if ( XS(9) != "S" ) { //////12/02/15
                                            strA = "N"
                                            寸法値記入 = "N"
                                            連続荷重数 = 連続荷重数 + 1
                                            連続荷重mark(連続荷重数) = 荷重mark
                                            連続荷重_L1(連続荷重数) = Round(荷重_L1, 3)
                                            連続荷重_L2(連続荷重数) = Round(荷重_L2, 3)
                                            連続荷重_P1(連続荷重数) = 荷重_P1
                                            連続荷重_P2(連続荷重数) = 荷重_P2
                                            荷重_L_STAX = X_STA
                                            荷重_L_STAY = Y_STA
                                            荷重_L_ENDX = X_END
                                            荷重_L_ENDY = Y_END
                                            if ( 荷重mark = 1 || 荷重mark = 5 || 荷重mark = 11 ) {
                                                荷重符号 = 1
                                            } else {
                                                荷重符号 = 荷重向
                                            }
                                            if ( Y_STA = Y_END ) { zX_EN = max(zX_EN, max(X_STA, X_END))
                                                前節点S = 節点S
                                                前節点E = 節点E
                                                前荷重種類 = 荷重種類
                                                前寸法値記入 = 寸法値記入
                                                前荷重mark = 荷重mark
                                                前荷重_L1 = 荷重_L1
                                                前荷重_L2 = 荷重_L2
                                                前荷重_P1 = 荷重_P1
                                                前荷重_P2 = 荷重_P2
                                                前荷重符号 = 荷重符号
                                                前荷重方向 = 荷重方向
            //                                        前hosei = hosei
                                                SS部材 = S部材 ////////////////07/01/077
                                                EE部材 = E部材
            //        this.CHECK_側壁(S部材, E部材, z側壁連続)
            //        if ( Now側壁連続 = -1 $$ (z側壁連続 = 1 || z側壁連続 = 2) ) {
            //            Now側壁連続 = z側壁連続
            //        }

            ////////10/03/07
            前BuzaiFF = BuzaiFF
            var U5 As Integer
            if ( 前BuzaiFF > 0 ) { ////////10/04/17
                this.yGGGGG(前BuzaiFF)
                For( U5 = 1 To 前BuzaiFF
                    yGGGGG(U5) = GGGGG(U5)
                Next U5
            }
            ////////10/03/07
                                            }
            //                                    SS部材 = S部材
            //                                    EE部材 = E部材
                                        } ////////////////////////////////////////////////05/03/02

                                        if ( OndoHenkaHyoujiFlag = 1 ) {
                                        } else {
                                            if ( E部材 < 0 $$ X(4) = 9 ) {
                                                Exit For
                                            }
                                        }
                if ( g角度一連 = False $$ BuzaiMM != 0 $$ XS(9) = "" ) { //////13/04/08
                    this.部材荷重連続寸法(frmPrint.vsPrt1, 連続荷重数, 前節点S, 前節点E, 荷重図開き, _
                            前荷重方向, 連続荷重mark(), 連続荷重_L1(), 連続荷重_L2(), 連続荷重_P1(), 連続荷重_P2(), _
                            前hosei, SS部材, EE部材, 前荷重mark, 描画荷重case, 前BuzaiFF, yGGGGG()) //////14/11/26
                }

            Next_End:
                                   }I3 //////////09/10/14
            //                        } ////////////////////////////05/03/02 ////
                            }
                        }
            Next nGNet2 ////////08/11/06
            Next nGNet1 ////////08/11/06
                        } ////////////////////////////05/03/01
                }
            //    Next nGNet2 ////////08/11/06
            //    Next nGNet1 ////////08/11/06
            G4G4G4: ////////08/11/06
            }
            if ( FlgKAZU != 0 ) {
                if ( 寸法値記入 = "N" $$ 連続荷重数 > 0 ) {
            //////12/12/12
            //            if ( (連続荷重mark(1) = 2 $$ (前荷重_L1 = 0 $$ 前荷重_L2 = 0) $$ (連続荷重_L1(1) + 連続荷重_L2(1) = 0)) ) { ////////12/02/15////// || 連続荷重mark(1) = 6) ) {
            //            } else {
            //////12/12/12
                    if ( (RR橋脚 = 2 $$ (InStr(部材名(S部材), "杭") = 0) || Not M杭mod) ) {
                        if ( 水平垂直 = 1 ) {
                            hosei = 15
                        } else {
                            if ( gabc(BBB) = 0 ) { hosei = 3 } else { hosei = 5
                        }
                    }
                    if ( (JX_max = JX_min) ) { hosei = 20 //////////////////////////04/07/20
                    if ( gabc(BBB) = 1 ) {
                        hosei = hosei + 2 / RRR
                    }
            ////////05/05/30
            k9 = 0
            if ( y節点S != 前節点S ) { k9 = 1
            if ( y節点E != 前節点E ) { k9 = 1 ////////////////1212999
            if ( k9 = 0 ) {
                For( k = 1 To 連続荷重数
                    if ( y連続荷重_L1(k) != 連続荷重_L1(k) || y連続荷重_L2(k) != 連続荷重_L2(k) ) {
                        k9 = 1
                        Exit For
                    }
                }
            }
            //    if ( Now側壁連続 = z側壁連続 ) { k9 = 0
            if ( k9 = 1 ) { //////////////13/04/08 荷重方向 --> 前荷重方向
                    this.部材荷重連続寸法(frmPrint.vsPrt1, 連続荷重数, 前節点S, 前節点E, 荷重図開き, _
                            前荷重方向, 連続荷重mark(), 連続荷重_L1(), 連続荷重_L2(), 連続荷重_P1(), 連続荷重_P2(), _
                            前hosei, SS部材, EE部材, 前荷重mark, 描画荷重case, 前BuzaiFF, yGGGGG()) //////10/03/07
            //            Now側壁連続 = -1
            } else {
            //        if ( Now側壁連続 != z側壁連続 ) {
                連続荷重数 = 0
                寸法値記入 = ""
            //        }
            //        if ( BuzaiFF > 0 $$ SS部材 != EE部材 ) { //////////////////12/12/15
            //            For( N4 = 1 To BuzaiFF
            //                k = GGGGG(N4)
            //                 if ( 荷重図開き >= 0 || (iKozo = 3 $$ g連続Mod) ) {
            ////                     部材正荷重数(k) = 部材正荷重数(k) + Round(min(hosei, -2), 2) * 2
            //                 } else {
            ////                     部材負荷重数(k) = 部材負荷重数(k) + Round(min(hosei, -2), 2) * 2
            //                 }
            //            Next N4
            //        } else { //////////////////////////////////////////////////////12/12/15
            //            For( k = SS部材 To EE部材
            //                 if ( 荷重図開き >= 0 || (iKozo = 3 $$ g連続Mod) ) {
            ////                     部材正荷重数(k) = 部材正荷重数(k) + Round(min(hosei, -2), 2) * 2
            //                 } else {
            ////                     部材負荷重数(k) = 部材負荷重数(k) + Round(min(hosei, -2), 2) * 2
            //                 }
            //             }
            //        }
            }
                    前hosei = hosei ////////08/07/06
            //            }//////12/12/12
            //            if ( 水平垂直 = 1 ) {
                        if ( 柱間離れ(1) >= 節X(前節点S) $$ 節X(前節点S) = 節X(前節点E) ) { 寸法左右(1) = 1
                        if ( 柱間離れ(2) <= 節X(前節点S) $$ 節X(前節点S) = 節X(前節点E) ) { 寸法左右(2) = 1
            //            }
                    if ( BuzaiFF > 0 $$ 部材1 != 部材2 ) { //////////////////12/12/15
                        For( N4 = 1 To BuzaiFF
                            k = GGGGG(N4)
                            if ( 荷重向 >= 0 ) {
            //                        部材正荷重数(k) = 部材正荷重数(k) + Round(max(hosei, 2), 2)
                            } else {
                                部材負荷重数(k) = 部材負荷重数(k) + Round(max(hosei, 1), 2)
                            }
                        Next N4
                    } else { //////////////////////////////////////////////////////12/12/15
                        For( k = 部材1 To 部材2
                            if ( 荷重向 >= 0 ) {
            //                        部材正荷重数(k) = 部材正荷重数(k) + Round(max(hosei, 2), 2)
                            } else {
                                部材負荷重数(k) = 部材負荷重数(k) + Round(max(hosei, 1), 2)
                            }
                        }
                    }
                }
            }
            寸法値記入 = ""
            //    Close #fno
            //////////////////////////////////////////////////////////////////////////////////07/01/18  節点荷重をまとめて作図
            var zFLG As Integer, zNUM() As Integer //////08/08/21
            var wNUM As Integer, sNUM1 As Single, sNUM2 As Single
            var sNUM3 As Integer, sSETEN() As Single
            var wSETEN() As Single ////////, wLLL() As Single
            var xFLG As Integer //////08/08/28
            var xSUIHE_Mage As Integer
            xSUIHE_Mage = 0
            xFLG = 0
            var yFLG As Integer //////08/08/28
            yFLG = 0
            //描画荷重case = 描画荷重case
            if ( Now荷重max2 = 0 ) { GoTo GRF_999
            //////    FN1 = FOLU & "K_Jitubuzai.txt"
            //////    Open FN1 For( Input As #fno
            //////    Input #fno, D
            strA = ""
            this.zNUM(Jn_max) ////////////////////////08/08/21
            this.wSETEN(max(Jn_max, 10), 4) //////12/12/16 13/11/24

            //    this.wLLL(Jn_max) //////12/12/16
            wNUM = 0 //////12/12/16
            For( i = 1 To Now荷重max2 ////////13/04/30////////荷重max ////////////4
            //////        if ( EOF(fno) ) {
            //////            Exit For
            //////        }
            //////        Line Input #fno, DA ////////// 04/10/18
            //////        this.D_data(Chr(9), DA, XS(), X(), n, er1, strLL) ////// 05/02/27
                        節点J = m節点J(i) ////////////////X(10)
                        荷重_FX = m荷重_FX(i) ////////////X(11)
                        荷重_FY = m荷重_FY(i) ////////////X(12)
                        荷重_M = m荷重_M(i) //////////////X(13)
            //        if ( 描画荷重case = X(1) ) {
            //                節点J = X(10)
            //                荷重_FX = X(11)
            //                荷重_FY = X(12)
            //                荷重_M = X(13)
                        if ( 節点J > 0 ) {
                            zFLG = 0
                            if ( wRR(節点J) > 0 ) { zFLG = 1 //////08/08/21
                            if ( g背割れ != 0 ) {
                                if ( w節RR(節点J) = 1 ) {
                                    if ( g背割れ = 2 ) { zFLG = 0
                                } else {if ( w節RR(節点J) = 2 ) { ////////////////////////節点が共通
                                    zNUM(節点J) = zNUM(節点J) + 1
                                    if ( g背割れ = 1 ) {
                                        if ( zNUM(節点J) = 1 ) {
                                            zFLG = 1
                                        } else {
                                            zFLG = 0
                                        }
                                    } else {if ( g背割れ = 2 ) {
                                        if ( zNUM(節点J) = 2 ) {
                                            zFLG = 1
                                        } else {
                                            zFLG = 0
                                        }
                                    }
                                }
                            } else { //////08/08/28
                                if ( 荷重_FY != 0 ) {
                                    if ( InStr(str節点鉛直(節点J), "+") = 0 $$ InStr(str節点鉛直(節点J), "-") = 0 ) {
                                        str節点鉛直(節点J) = ""
                                        y節点鉛直(節点J) = 0
                                    } else {
                                        荷重_FY = 0 //////////後でまとめて表示 //////08/08/28
                                        yFLG = 1
                                    }
                                }
                                if ( 荷重_FX != 0 ) { //////////13/11/24
                                    if ( InStr(str節点水平(節点J), "+") = 0 $$ InStr(str節点水平(節点J), "-") = 0 ) {
                                        str節点水平(節点J) = ""
                                        y節点水平(節点J) = 0
                                    } else {
                                        if ( 荷重_M = 0 ) {
                                        荷重_FX = 0 //////////後でまとめて表示 //////08/08/28
                                        xFLG = 1
                                        }
                                    }
                                }
                            }
                            if ( mFLG = 1 ) { //////08/11/04
                                荷重_M = 0
                            }
                            if ( zFLG = 1 $$ Abs(荷重_FX) + Abs(荷重_FY) + Abs(荷重_M) != 0 ) { //////08/08/28
                                wNUM = wNUM + 1 //////////////////////////////12/12/16
                                wSETEN(wNUM, 1) = 節点J
                                wSETEN(wNUM, 2) = 荷重_FX
                                wSETEN(wNUM, 3) = 荷重_FY
                                wSETEN(wNUM, 4) = 荷重_M
                            }
                        }
            //        }
            }
            this.sSETEN(wNUM, 4) //////12/12/16
            sNUM3 = 0
            For( i = 1 To wNUM ////////12/12/16
                節点J = wSETEN(i, 1)
                荷重_FX = wSETEN(i, 2)
                荷重_FY = wSETEN(i, 3)
                荷重_M = wSETEN(i, 4)
                if ( 荷重_FY != 0 $$ Abs(節Y(節点J) - YY_max) < 0.5 ) {
                    sNUM3 = sNUM3 + 1
                    sSETEN(sNUM3, 1) = 節点J
                    sSETEN(sNUM3, 2) = 荷重_FX
                    sSETEN(sNUM3, 3) = 荷重_FY
                    sSETEN(sNUM3, 4) = 荷重_M
                    wSETEN(i, 1) = 0
                }
            }
            sNUM1 = -999999

            For( i = 1 To sNUM3 ////////12/12/16
                節点J = sSETEN(i, 1)
                荷重_FX = sSETEN(i, 2)
                荷重_FY = sSETEN(i, 3)
                荷重_M = sSETEN(i, 4)
                j = 0
                if ( i + 1 <= sNUM3 ) {
                    if ( 荷重_FY != 0 $$ sSETEN(i + 1, 3) != 0 $$ _
                            Abs(節Y(節点J) - YY_max) < 0.5 $$ Abs(節Y(sSETEN(i + 1, 1)) - YY_max) < 0.5 ) {
                        sNUM2 = HEN_X(節X(sSETEN(i + 1, 1)))
                        if ( (sNUM2 - sNUM1) < 150 ) {
                            j = 1
                        }
                        sNUM1 = sNUM2
                    }
                }
                if ( xFLG = 1 ) { 荷重_FX = 0
                if ( yFLG = 1 ) { 荷重_FY = 0
                this.F節点荷重(frmPrint.vsPrt1, 描画荷重case, 節点J, 荷重_FX, 荷重_FY, 荷重_M, strA, "", j)
            }
            For( i = 1 To wNUM
                if ( wSETEN(i, 1) != 0 ) {
                    節点J = wSETEN(i, 1)
                    荷重_FX = wSETEN(i, 2)
                    荷重_FY = wSETEN(i, 3)
                    荷重_M = wSETEN(i, 4)
                    this.F節点荷重(frmPrint.vsPrt1, 描画荷重case, 節点J, 荷重_FX, 荷重_FY, 荷重_M, strA, "", j)
                }
            }

            strA = ""
            if ( yFLG = 1 ) { //////08/08/28
                For( i = 1 To Jn_max
                    if ( y節点鉛直(i) != 0 ) {
                        節点J = i
                        荷重_FX = 0
                        荷重_FY = y節点鉛直(i)
                        荷重_M = 0
                        this.F節点荷重(frmPrint.vsPrt1, 描画荷重case, 節点J, 荷重_FX, 荷重_FY, 荷重_M, strA, str節点鉛直(節点J))
                    }
                }
            }
            if ( xFLG = 1 ) { //////13/11/24
                For( i = 1 To Jn_max
                    if ( y節点水平(i) != 0 ) {
                        節点J = i
                        荷重_FX = y節点水平(i)
                        荷重_FY = 0
                        荷重_M = 0
                        this.F節点荷重(frmPrint.vsPrt1, 描画荷重case, 節点J, 荷重_FX, 荷重_FY, 荷重_M, strA, str節点水平(節点J))
                        xSUIHE_Mage = 1
                    }
                }
            }
            if ( mFLG = 1 ) {
                For( i = 1 To mCUNT
                    節点J = m節点モーメント(i, 1)
                    荷重_FX = 0
                    荷重_FY = 0
                    荷重_M = m節点モーメント(i, 2)
                    this.F節点荷重(frmPrint.vsPrt1, 描画荷重case, 節点J, 荷重_FX, 荷重_FY, 荷重_M, strA, "") //////// IIf(xSUIHE_Mage = 1, "888", ""))
                }
            }
            GRF_999:
            //    Close #fno //////07/11/01
            //

                                                                        */
        }

        /* private void CHECK_側壁(BUZA1 As Integer, BUZA2 As Integer, sHok As Integer)
        var i As Integer
        sHok = 0
        if ( m左側壁Grp(0) > 0 ) {
            For( i = 1 To m左側壁Grp(0)
                if ( m左側壁Grp(0) = BUZA1 ) {
                    sHok = 1
                    Exit For
                }
            }
        }
        if ( m右側壁Grp(0) > 0 $$ sHok = 0 ) {
            For( i = 1 To m右側壁Grp(0)
                if ( m右側壁Grp(0) = BUZA1 ) {
                    sHok = 2
                    Exit For
                }
            }
        }
        if ( sHok = 0 || Abs(BUZA2) = 0 ) { return;
        if ( sHok = 1 ) {
            For( i = 1 To m左側壁Grp(0)
                if ( m左側壁Grp(0) = Abs(BUZA2) ) {
                    sHok = 1
                    Exit For
                }
            }
        } else {if ( sHok = 2 ) {
            For( i = 1 To m右側壁Grp(0)
                if ( m右側壁Grp(0) = Abs(BUZA2) ) {
                    sHok = 2
                    Exit For
                }
            }
        }
        }
        */

        /* private void CHECK_REN(X1 As Single, X2 As Single, REN1() As Double, REN2() As Double, MAXREN)
//
double var i
double var j
double var SS
double var EE
//
SS = 0
EE = 0
For( i = 1 To ZZBuzaiGroupMax
    For( j = 1 To BuzaiMax1
        if ( ZZBuzaiGroup(i, j) = X1 ) {
            SS = X1
        }
        if ( ZZBuzaiGroup(i, j) = X2 $$ SS > 0 ) {
            EE = X2
            Exit For
        }
    }
    if ( SS > 0 $$ EE > 0 ) {
        Exit For
    }
}
if ( SS > 0 $$ EE > 0 ) {
    MAXREN = 1
    return;
}
MAXREN = 0
For( i = X1 To X2
    MAXREN = MAXREN + 1
    REN1(MAXREN) = i
    REN2(MAXREN) = i
}
//
}
    */

        public void ConvertIunputJitsuKajuu1(double Acc, double[] JI1, double[] JI2, double[] JI3, double[] JI4, double[] ChangeFlag, double[] SAFlag)
        {
            /*/
            double var l
            double var j
            double var i
            double var k
            double var HaJime
            double var GroupNum
            double var BuzaiNarabi()
            double var ImaG
            double var GCounter
            double var MaeG
            double var AllLine
            double var Line1
            double var Line2
            double var L1
            double var L2
            double var ZL1()
            double var ZL2()
            double var FZL1()
            double var FZL2()
            double var G1()
            double var G2()
            double var G3()
            double var G4()
            double var P1
            double var P2
            double var SBuzai
            double var EBuzai
            double var EE()
            double var STARTC
            double var STARTI
            double var Atta11
            //
            this.ZL1(1000)
            this.ZL2(1000)
            this.FZL1(1000)
            this.FZL2(1000)
            this.EE(1000)
            this.BuzaiNarabi(BuzaiMax1)
            For( i = 1 To BuzaiMax1
                BuzaiNarabi(i) = 0
            }
            HaJime = 0
            GCounter = 0
            For( i = 1 To Acc
                if ( HaJime = 0 ) {
                    MaeG = 0
                    HaJime = HaJime + 1
                    GCounter = GCounter + 1
                    this.SearchBuzaigroup(JI1(i), GroupNum, BuzaiNarabi(), ImaG)
                    EBuzai = SearchPointEndBuzai(BuzaiNarabi())
                    SBuzai = SearchPointStartBuzai(BuzaiNarabi())
                    AllLine = 0
                    For( j = 1 To BuzaiMax1
                        if ( BuzaiNarabi(j) > 0 ) {
                            AllLine = AllLine + ZBuzaiLength(BuzaiNarabi(j))
                        }
                    }
                    For( j = 1 To 1000
                        ZL1(j) = 0
                        ZL2(j) = 0
                        EE(j) = 0
                    }
                    P1 = SearchPoint(BuzaiNarabi(), JI1(i))
                    L1 = 0
                    For( j = 1 To P1 - 1
                        if ( BuzaiNarabi(j) > 0 ) {
                            L1 = L1 + ZBuzaiLength(BuzaiNarabi(j))
                        }
                    }
                    P2 = SearchPoint(BuzaiNarabi(), JI2(i))
                    L2 = 0
                    For( j = P2 + 1 To BuzaiMax1
                        if ( BuzaiNarabi(j) > 0 ) {
                            L2 = L2 + ZBuzaiLength(BuzaiNarabi(j))
                        }
                    }
                    ZL1(GCounter) = L1 + JI3(i)
                    ZL2(GCounter) = L2 + JI4(i)
                    FZL1(GCounter) = L1 + JI3(i)
                    FZL2(GCounter) = AllLine - ZL2(GCounter)
                    EE(GCounter) = i
                } else {
                    if ( SearchPoint(BuzaiNarabi(), JI1(i)) = 0 ) {  //OTHER GROUP
                        if ( GCounter > 1 ) {
                            STARTC = 0
                            For( j = 1 To 1000
                                ZL1(j) = RoundS(ZL1(j), 3)
                                ZL2(j) = RoundS(ZL2(j), 3)
                                FZL1(j) = RoundS(FZL1(j), 3)
                                FZL2(j) = RoundS(FZL2(j), 3)
                            }
                            For( j = 1 To GCounter
                                if ( STARTC = 0 ) {
                                    STARTI = j
                                    STARTC = STARTC + 1
                                } else {
                                    Atta11 = 0
                                    For( k = STARTI To j
                                        if ( j = k ) {
                                        } else {
                                            if ( (FZL1(j) <= FZL1(k) $$ FZL2(j) <= FZL1(k)) || (FZL1(j) >= FZL2(k) $$ FZL2(j) >= FZL2(k)) ) {
                                            } else {
                                                Atta11 = j
                                                Exit For
                                            }
                                        }
                                    }
                                    if ( Atta11 > 0 ) {
                                        For( k = STARTI To Atta11 - 1
                                            l = EE(k)
                                            JI1(l) = SBuzai
                                            JI2(l) = EBuzai
                                            JI3(l) = ZL1(k)
                                            JI4(l) = ZL2(k)
                                            ChangeFlag(l) = 1
                                        }
                                        STARTI = j
                                    } else {
                                        if ( j = GCounter ) {
                                            For( k = STARTI To j
                                                l = EE(k)
                                                JI1(l) = SBuzai
                                                JI2(l) = EBuzai
                                                JI3(l) = ZL1(k)
                                                JI4(l) = ZL2(k)
                                                ChangeFlag(l) = 1
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        //On Error GoTo NG2:
                        //For( k = 1 To 15
                        //    MsgBox k & "=" & JI1(k) & " " & JI2(k) & " " & JI3(k) & " " & JI4(k)
                        //}
            NG2:
                        GCounter = 1
                        this.SearchBuzaigroup(JI1(2), GroupNum, BuzaiNarabi(), ImaG)
                        SBuzai = SearchPointStartBuzai(BuzaiNarabi())
                        EBuzai = SearchPointEndBuzai(BuzaiNarabi())
                        AllLine = 0
                        For( j = 1 To BuzaiMax1
                            if ( BuzaiNarabi(j) > 0 ) {
                                AllLine = AllLine + ZBuzaiLength(BuzaiNarabi(j))
                            }
                        }
                        For( j = 1 To 1000
                            ZL1(j) = 0
                            ZL2(j) = 0
                            EE(j) = 0
                        }
                        P1 = SearchPoint(BuzaiNarabi(), JI1(i))
                        L1 = 0
                        For( j = 1 To P1 - 1
                            if ( BuzaiNarabi(j) > 0 ) {
                                L1 = L1 + ZBuzaiLength(BuzaiNarabi(j))
                            }
                        }
                        P2 = SearchPoint(BuzaiNarabi(), JI2(i))
                        L2 = 0
                        For( j = P2 + 1 To BuzaiMax1
                            if ( BuzaiNarabi(j) > 0 ) {
                                L2 = L2 + ZBuzaiLength(BuzaiNarabi(j))
                            }
                        }
                        ZL1(GCounter) = L1 + JI3(i)
                        ZL2(GCounter) = L2 + JI4(i)
                        FZL1(GCounter) = L1 + JI3(i)
                        FZL2(GCounter) = AllLine - ZL2(GCounter)
                        EE(GCounter) = i
                    } else {    // EQUAL GROUP
                        GCounter = GCounter + 1
                        P1 = SearchPoint(BuzaiNarabi(), JI1(i))
                        L1 = 0
                        For( j = 1 To P1 - 1
                            if ( BuzaiNarabi(j) > 0 ) {
                                L1 = L1 + ZBuzaiLength(BuzaiNarabi(j))
                            }
                        }
                        P2 = SearchPoint(BuzaiNarabi(), JI2(i))
                        L2 = 0
                        For( j = P2 + 1 To BuzaiMax1
                            if ( BuzaiNarabi(j) > 0 ) {
                                L2 = L2 + ZBuzaiLength(BuzaiNarabi(j))
                            }
                        }
                        ZL1(GCounter) = L1 + JI3(i)
                        ZL2(GCounter) = L2 + JI4(i)
                        FZL1(GCounter) = L1 + JI3(i)
                        FZL2(GCounter) = AllLine - ZL2(GCounter)
                        EE(GCounter) = i
                    }
                }
            }
            if ( GCounter > 1 ) {
                P1 = SearchPoint(BuzaiNarabi(), JI1(Acc))
                L1 = 0
                For( j = 1 To P1 - 1
                    if ( BuzaiNarabi(j) > 0 ) {
                        L1 = L1 + ZBuzaiLength(BuzaiNarabi(j))
                    }
                }
                P2 = SearchPoint(BuzaiNarabi(), JI2(Acc))
                L2 = 0
                For( j = P2 + 1 To BuzaiMax1
                    if ( BuzaiNarabi(j) > 0 ) {
                        L2 = L2 + ZBuzaiLength(BuzaiNarabi(j))
                    }
                }
                ZL1(GCounter) = L1 + JI3(Acc)
                ZL2(GCounter) = L2 + JI4(Acc)
                FZL1(GCounter) = L1 + JI3(Acc)
                FZL2(GCounter) = AllLine - ZL2(GCounter)
                EE(GCounter) = Acc
                if ( GCounter > 1 ) {
                    STARTC = 0
                    For( j = 1 To 1000
                        ZL1(j) = RoundS(ZL1(j), 3)
                        ZL2(j) = RoundS(ZL2(j), 3)
                        FZL1(j) = RoundS(FZL1(j), 3)
                        FZL2(j) = RoundS(FZL2(j), 3)
                    }
                    For( j = 1 To GCounter
                        if ( STARTC = 0 ) {
                            STARTI = j
                            STARTC = STARTC + 1
                        } else {
                            Atta11 = 0
                            For( k = STARTI To j
                                if ( j = k ) {
                                } else {
                                    if ( (FZL1(j) <= FZL1(k) $$ FZL2(j) <= FZL1(k)) || (FZL1(j) >= FZL2(k) $$ FZL2(j) >= FZL2(k)) ) {
                                    } else {
                                        Atta11 = j
                                        Exit For
                                    }
                                }
                            }
                            if ( Atta11 > 0 ) {
                                For( k = STARTI To Atta11 - 1
                                    l = EE(k)
                                    JI1(l) = SBuzai
                                    JI2(l) = EBuzai
                                    JI3(l) = ZL1(k)
                                    JI4(l) = ZL2(k)
                                    ChangeFlag(l) = 1
                                }
                                STARTI = j
                            } else {
                                if ( j = GCounter ) {
                                    For( k = STARTI To j
                                        l = EE(k)
                                        JI1(l) = SBuzai
                                        JI2(l) = EBuzai
                                        JI3(l) = ZL1(k)
                                        JI4(l) = ZL2(k)
                                        ChangeFlag(l) = 1
                                    }
                                }
                            }
                        }
                    }
                }
                //On Error GoTo NG1:
                //For( k = 1 To 15
                //    MsgBox k & "=" & JI1(k) & " " & JI2(k) & " " & JI3(k) & " " & JI4(k)
                //}
            NG1:
            }
            /*/
        }

        private double SearchPoint(double[] BuzaiNarabi, double JI)
        {
            /*/
            double var i
            double var Atta
            //
            Atta = 0
            For( i = 1 To BuzaiMax1
                if ( BuzaiNarabi(i) = JI ) {
                    Atta = i
                    Exit For
                }
            }
            SearchPoint = Atta
            /*/
            return 0;
        }

        private double SearchPointEndBuzai(double[] BuzaiNarabi)
        {
            /*/
            double var i
            double var Atta
            //
            Atta = 0
            For( i = 1 To BuzaiMax1
                if ( BuzaiNarabi(i) = 0 ) {
                    Atta = i - 1
                    Exit For
                }
            }
            if ( Atta = 0 ) {
                Atta = BuzaiMax1
            }
            SearchPointEndBuzai = BuzaiNarabi(Atta)
            /*/
            return 0;
        }

        private double SearchPointStartBuzai(double[] BuzaiNarabi)
        {
            /*/
            double var i
            double var Atta
            //
            Atta = BuzaiNarabi(1)
            SearchPointStartBuzai = Atta
            /*/
            return 0;
        }

        private void SearchBuzaigroup(double JI, double GroupNum, double[] BuzaiNarabi, double ImaG)
        {
            /*/
            double var i
            double var j
            double var Atta1
            //
            Atta1 = 0
            For( i = 1 To ZZBuzaiGroupMax
                For( j = 1 To BuzaiMax1
                    if ( ZZBuzaiGroup(i, j) = JI ) {
                        Atta1 = i
                        Exit For
                    }
                }
                if ( Atta1 > 0 ) {
                    Exit For
                }
            }
            if ( Atta1 > 0 ) {
                ImaG = Atta1
                For( i = 1 To BuzaiMax1
                    BuzaiNarabi(i) = ZZBuzaiGroup(Atta1, i)
                }
            } else {
                ImaG = 0
                For( i = 1 To BuzaiMax1
                    BuzaiNarabi(i) = 0
                }
            }
            /*/
        }

        private void ConvertIunputJitsuKajuu2(float[] X, double[] JI1, double[] JI2, double[] JI3, double[] JI4, double[] ChangeFlag, double[] SAFlag, double Acc, int Poi)
        {
            /*/
            double var i
            double var Atta
            //
            For( i = 1 To Acc
                if ( Poi = SAFlag(i) ) {
                    Atta = i
                    Exit For
                }
            }
            if ( Atta = 0 ) {
                return;
            }
            if ( ChangeFlag(Atta) > 0 ) { //////////////////////////// = を付け加えた
                X(2) = CSng(JI1(Atta))
                X(3) = CSng(-JI2(Atta))
                X(5) = CSng(JI3(Atta))
                X(6) = CSng(JI4(Atta))
            }
            /*/
        }

        private void ConvertIunputJitsuKajuu(float[] X)
        {
            /*/
            var i                       As Integer
            var j                       As Integer
            var StartB                  As Single
            var EndB                    As Single
            var Atta1                   As Single
            var Atta2                   As Single
            var ZAtta1                  As Single
            var ZAtta2                  As Single
            var StartAA                 As Single
            var EndAA                   As Single
            var LLL                     As Single
            //
            if ( X(4) = 2 || X(4) = 3 ) {
            } else {
                return;
            }
            if ( X(5) = 0 $$ X(6) = 0 ) {
                return;
            }
            StartB = X(2)
            EndB = X(3)
            if ( EndB < 0 ) {
                EndB = Abs(EndB)
                Atta1 = 0
                Atta2 = 0
                ZAtta1 = 0
                ZAtta2 = 0
                For( i = 1 To ZZBuzaiGroupMax
                    For( j = 1 To BuzaiMax1
                        if ( ZZBuzaiGroup(i, j) = StartB ) {
                            Atta1 = i
                            ZAtta1 = j
                            Exit For
                        }
                    }
                    if ( Atta1 > 0 ) {
                        Exit For
                    }
                }
                if ( Atta1 = 0 ) {
                    return;
                }
                i = Atta1
                For( j = 1 To BuzaiMax1
                    if ( ZZBuzaiGroup(i, j) = EndB ) {
                        Atta2 = i
                        ZAtta2 = j
                        Exit For
                    }
                }
                if ( Atta2 = 0 ) {
                    return;
                }
                if ( ZAtta1 = 1 ) {
                    LLL = 0
                    EndAA = EndB
                    For( i = ZAtta2 + 1 To BuzaiMax1
                        if ( ZZBuzaiGroup(Atta1, i) > 0 ) {
                            LLL = LLL + RoundS(ZBuzaiLength(ZZBuzaiGroup(Atta1, i)), 3)
                            EndAA = ZZBuzaiGroup(Atta1, i)
                        }
                    }
                    X(2) = ZZBuzaiGroup(Atta1, 1)
                    X(3) = -EndAA
                    X(5) = X(5)
                    X(6) = X(6) + RoundS(LLL, 3)
                } else {
                    LLL = 0
                    StartAA = StartB
                    For( i = ZAtta1 - 1 To 1 Step -1
                        if ( ZZBuzaiGroup(Atta1, i) > 0 ) {
                            LLL = LLL + RoundS(ZBuzaiLength(ZZBuzaiGroup(Atta1, i)), 3)
                            StartAA = ZZBuzaiGroup(Atta1, i)
                        }
                    }
                    X(2) = StartAA
                    X(5) = X(5) + RoundS(LLL, 3)
                    LLL = 0
                    EndAA = EndB
                    For( i = ZAtta2 + 1 To BuzaiMax1
                        if ( ZZBuzaiGroup(Atta1, i) > 0 ) {
                            LLL = LLL + ZBuzaiLength(ZZBuzaiGroup(Atta1, i))
                            EndAA = ZZBuzaiGroup(Atta1, i)
                        }
                    }
                    X(3) = -EndAA
                    X(6) = X(6) + RoundS(LLL, 3)
                }
            }
            /*/
        }

        private float 部材荷重段位置(int 部材S, int 部材E, float 荷重, int 荷重MK,
                                     double L1, double L2, int HV, float 荷重_P, string g方向, int Flg,
                                     int yBuzaiFF, int[] yGGGGG, int CASU)
        { ////////10/03/07//////12/12/15
            return 0;
            /*/
            var i                       As Integer
            var 荷重数                  As Single
            var 間隔                    As Single
            var 盛上間隔                As Single
            var M盛上げ初期値           As Single
            var M荷重盛上げ初期値       As Single
            var P002                    As Single
            var AAA                     As Integer
            var i8 As Integer //////12/12/15
            var Dummy                   As Single //////10/04/03
            //
            var 節点S As Integer, 節点E As Integer
            var wXs As Single, wXe As Single, wYs As Single, wYe As Single //////09/09/300

            節点S = 部I(部材S)
            節点E = 部J(Abs(部材E))
            wXs = 節X(節点S)
            wXe = 節X(節点E)
            wYs = 節Y(節点S)
            wYe = 節Y(節点E)
            Dummy = 0
            //
            AAA = 1
            if ( (g方向 = "V" || g方向 = "H") $$ 荷重 = -1 $$ 荷重MK = 2 ) { ////////10/03/07
                AAA = -1
            }
            P002 = 0.0002
            N段数 = 1
            if ( Flg_PRESTRES(1) + Flg_PRESTRES(2) != 0 ) { Exit Function ////////08/06/055
            if ( RR橋脚 = 1 ) {
                盛上間隔 = (荷重図盛上げpit(1) + 荷重図盛上げpit(2)) / 2.6
                if ( L1 + L2 = 0 $$ 荷重MK = 2 ) {
                    盛上間隔 = 8 //盛上間隔 / 1.4 ////////12/12/155
                }
            } else {if ( RR橋脚 = 2 ) { //////09/03/25
                盛上間隔 = (荷重図盛上げpit(1) + 荷重図盛上げpit(2)) / 2.3 //////09/03/25
            } else {
                盛上間隔 = 荷重図盛上げpit(2)
                if ( 荷重MK = 2 $$ L1 = 0 $$ L2 = 0 ) {
                    盛上間隔 = 荷重図盛上げpit(2) * 0.8 * ((Abs(荷重_P) / BU荷重MAX) ^ 0.25) ////////////////06/02/22
                }
            }
            if ( 荷重MK >= 5 ) { ////////And 荷重MK != 11 ) { //////////////////09/11/19
                部材荷重段位置 = 荷重図上盛上げ初期値
            } else {
                間隔 = -9999
                Select Case 荷重 * AAA ////////10/03/07
                Case Is >= 0
                    if ( g方向 = "H" ) { ////////10/03/07
            //                間隔 = 間隔
                    } else {
                        if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                            For( i8 = 1 To yBuzaiFF
                                i = yGGGGG(i8)
                                 間隔 = max(間隔, 部材正荷重数(i))
                                 if ( (DDAN(部I(i)) > 0 || DDAN(部J(i)) > 0) $$ 荷重MK != 1 ) { //////14/09/27
                                    Dummy = max(Dummy, DDAN(部I(i)))
                                    Dummy = max(Dummy, DDAN(部J(i)))
                                 }
                            }8
                            if ( g方向 = "V" $$ 間隔 < 20 $$ iKozo = 3 ) {
                                間隔 = 0
                                Dummy = 0
                            }
                            if ( wXs = wXe ) {
                                Dummy = 0 //////13/04/30
                            }
                        } else { //////////////////////////////////////////////////12/12/15
                            For( i = 部材S To 部材E
                                 間隔 = max(間隔, 部材正荷重数(i))
                                 if ( (DDAN(部I(i)) > 0 || DDAN(部J(i)) > 0) $$ 荷重MK != 1 ) { //////10/04/03//////14/09/27
                                    Dummy = max(Dummy, DDAN(部I(i)))
                                    Dummy = max(Dummy, DDAN(部J(i)))
                                 }
                            }
            if ( FLG車両ZU = True $$ 間隔 < 17 $$ 間隔 > 0 ) {
            間隔 = 17
            if ( FLG車両ZU $$ 荷重MK = 1 ) {
                間隔 = 25
            }
            }
                            if ( wXs = wXe ) {
                                Dummy = 0 //////13/04/30
                            }
                        }
                        if ( 荷重MK != 1 $$ 間隔 > 20 ) {
                            Dummy = 0
                        }
                        if ( 荷重MK = 1 $$ Dummy > 20 ) {
                            Dummy = Dummy / 2 //////10/04/05
                        } else {if ( 荷重MK = 1 $$ g連続Mod $$ iKozo = 3 ) {
                            Dummy = Dummy / 2 //////10/04/05
                        } else {if ( (荷重MK = 2 || 荷重MK = 3 || 荷重MK = 4) $$ Dummy > 12 $$ iKozo = 1 ) {
            //                        Dummy = Dummy * 1.5 //////14/11/25
                        }
                        if ( Dummy > 0 $$ 節点荷重Fontsize > 9 ) { //////14/11/25
                            Dummy = Dummy + (節点荷重Fontsize - 9) * 2.5
                        }
                        間隔 = max(間隔, Dummy)
            //                if ( 荷重MK = 1 $$ g背割れ = 1 ) { 間隔 = 間隔 + 6 ////////12/11/23
                    }
                    if ( 水平垂直 = 1 ) {
                        M盛上げ初期値 = 荷重図下盛上げ初期値 // 垂直
                    } else {
                        M盛上げ初期値 = 荷重図上盛上げ初期値
                    }
                    部材荷重段位置 = max(M盛上げ初期値, 間隔)
                    if ( 部材荷重段位置 = 間隔 ) {
                        if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                            For( i8 = 1 To yBuzaiFF
                                i = yGGGGG(i8)
                                if ( (g方向 = "H" $$ Abs(SuiHeiAngX(Int((部材S + 部材E) / 2)) - SuiHeiAngX(i)) > 75) ) {
                                    部材正荷重数(i) = -10
                                } else {
                                    部材正荷重数(i) = 間隔 // + IIf(荷重MK = 1, 5, 0)
                                }
                            }8
                        } else { //////////////////////////////////////////////////12/12/15
                            For( i = 部材S To 部材E
                                if ( (g方向 = "H" $$ Abs(SuiHeiAngX(Int((部材S + 部材E) / 2)) - SuiHeiAngX(i)) > 75) ) { //////10/03/07
                                    部材正荷重数(i) = -10
                                } else {
                                    if ( ((間隔 = Dummy $$ 部材正荷重数(i) > 0) || 間隔 = 部材正荷重数(i)) $$ 部材荷重段位置 < 10 ) {
                                    部材荷重段位置 = max(M盛上げ初期値, 間隔)
                                    }
                                    部材正荷重数(i) = 部材荷重段位置 + IIf(荷重MK = 1, 1, 0) //////12/11/23
                                }
                            }
                        }
                        if ( 間隔 > 13 ) { N段数 = 2
                        Exit Function
                    }
            var FLG_やった As Single
            FLG_やった = 0 //////14/12/13
            if ( g方向 = "V" $$ 部材S = 部材E $$ 部材正荷重数(部材S) < 35 ) { ////////////////////////////////14/12/13
                部材荷重段位置 = 部材荷重段位置 + (上層斜めBuzaiV(部材S) / (図Y_SCALE * sNN) / 56.7)
            }
            if ( (FLG7777 = 1 $$ Dummy = 0) || 間隔 = 0 ) {
            Exit Function ////////14/11/19
            }
                    if ( 部材荷重段位置 != M盛上げ初期値 ) {
                        if ( Not (部材荷重段位置 = 6 || 部材荷重段位置 = 19.7 || 部材荷重段位置 = 4.01 _
                             || 部材荷重段位置 = 13.01 || 部材荷重段位置 = 15.51 || 部材荷重段位置 = 2.005) ) { N段数 = 2 //////13/06/07
                             if ( N段数 = 2 $$ 部材荷重段位置 = Dummy ) {
                                N段数 = 1
                             }
                    }
                    if ( 荷重MK = 1 || 荷重MK = 5 || 荷重MK = 11 ) {
                        if ( Round(部材荷重段位置 - Int(部材荷重段位置 * 100) / 100, 5) = 0.0002 ) {
                            if ( 間隔 < 17 ) { //////////////////////////////////////////////////////9/01/28
            //                        部材荷重段位置 = 部材荷重段位置 - 2.5
                                if ( 間隔 < 13 ) { //////10/03/25
                                    間隔 = 間隔 + 7
                                    部材荷重段位置 = 間隔
                                }
                            } else {
                               if ( 間隔 < 26 ) { ////////if ( 間隔 < 28 ) { ////////09/10/299
                                    部材荷重段位置 = 部材荷重段位置 + IIf(N段数 = 1, 13, 0) //////09/01/28 12/12/15
                               } else {if ( 間隔 < 28 ) {
                                    部材荷重段位置 = 部材荷重段位置 + 1 ////////09/10/299
                               } else {if ( 間隔 < 55 ) { //////14/11/178
                                    部材荷重段位置 = 部材荷重段位置 + 0
                               } else {if ( 間隔 < 63 ) { //////14/11/178
                                    部材荷重段位置 = 部材荷重段位置 + 4 // - 2.5
                               } else {if ( 間隔 < 66 ) { //////14/11/178
                                    部材荷重段位置 = 部材荷重段位置 + 2
                               } else {
                                    部材荷重段位置 = 部材荷重段位置 + 6 //////14/11/178
                               }
            //                       間隔 = 間隔 + 5.5 + 1 ////////08/01/311//////10/03/25
                               間隔 = 部材荷重段位置
                            }
            //                    間隔 = 間隔 + 5.5 + 1 ////////08/01/311//////10/03/25
                        } else {
                            if ( 荷重MK = 1 $$ 水平垂直 = 0 ) { ////////09/01/28
                                部材荷重段位置 = 部材荷重段位置 + 1.5 ////// + 1.5 ////////2.5 //////09/10/30 //////12/02/15
                                if ( 荷重MK = 1 $$ g背割れ = 0 ) {
                                    if ( N段数 = 1 ) {
                                        部材荷重段位置 = max(6.5, 部材荷重段位置) //////14/08/17
                                    } else {
                                        if ( 間隔 > 60 ) { //////14/11/178
            //                                    部材荷重段位置 = 部材荷重段位置 - 12
                                        } else {
                                            部材荷重段位置 = 部材荷重段位置 // + 6
            //                                    if ( (Abs(荷重_P) / BP荷重MAX) > 0.8 ) {
            //                                        部材荷重段位置 = 部材荷重段位置 - 6
            //                                    }
                                        }
                                    }
                                }
                            }
                            if ( 荷重MK = 1 ) { ////////And 水平垂直 = 1 ) { //////14/11/17
                                間隔 = 部材荷重段位置
                            } else {
                                間隔 = 部材荷重段位置 + 荷重図盛上げpit(1) * IIf(荷重MK = 1, 0.92, 1) ////////14/11/178
                            }
            //                    if ( FLG記号 = 1 $$ (荷重MK < 5) ) { ////////////////08/01/311
            //                        間隔 = 間隔 + 5.5 - 1 - 2 //////09/10/30
            //                    }
                        }
            //                if ( FLG記号 = 1 $$ (荷重MK < 5) ) { ////////////////08/01/311
            //                    間隔 = 間隔 + 5.5 - 1 - 2 //////09/10/30
            //                }
                    } else {
            var B88 As Single ////////08/09/26

                        if ( 荷重MK = 2 $$ L1 = 0 $$ L2 = 0 ) { ////////And HV = 1 ) {
                            B88 = max((Abs(荷重_P) / BU荷重MAX), 0.2)
            //                    if ( B88 > 0.9 ) { ////////08/10/29
            //                        if ( B88 > 0.999 ) {
            //                            if ( 間隔 = 0 ) {
            //                            間隔 = Round(部材荷重段位置 + 盛上間隔, 2) - 1 + P002
            //                            } else {
            //                            間隔 = Round(部材荷重段位置 + 盛上間隔, 2) + 2 + P002 + IIf(間隔 = 0, 3, 0) ////12/09/01
            //                            }
            //                        } else {
            //                            間隔 = Round(部材荷重段位置 + 盛上間隔, 2) - 1 + P002 ////09/10/14//////+1
            //                        }
            ////                        if ( 部材正荷重数(部材S) = 0 ) { //////10/01/30
            ////                            間隔 = Round((間隔 / 2), 2) + P002
            ////                        }
            //                    } else {
                                if ( B88 = 0.2 ) {
                                    間隔 = Round(部材荷重段位置 + (盛上間隔 + 4 - 2 - 3), 2) + P002 //////0.0002 //////08/10/29//////12/02/15
                                } else {
                                    if ( 間隔 = 0 ) {
                                        間隔 = Round(部材荷重段位置 + 盛上間隔, 2) + P002 ////////0.0002 //////10/04/09 盛上間隔+2
                                    } else {
                                        if ( N段数 = 2 $$ (部材E - 部材S) > 60 ) { ////////And 部材荷重段位置 > 40 ) {
                                            部材荷重段位置 = 部材荷重段位置 - 盛上間隔 - 3 //////13/12/31
                                            間隔 = 部材荷重段位置
                                        } else {
                                            間隔 = Round(部材荷重段位置 + 盛上間隔, 2) + P002  ////////09/11/19
                                            if ( N段数 = 1 $$ 間隔 < 22 ) { 間隔 = 22 ////////10/04/09

                                            if ( 部材荷重段位置 = 13.5 ) { //////14/11/25
                                                部材荷重段位置 = 部材荷重段位置 + 3
                                            }
                                        }
                                    }
                                }
            //                    }
                            if ( g方向 = "M" $$ 間隔 > 15 ) { //////12/12/299
                                間隔 = 15
                                部材荷重段位置 = 7
                            }
                        } else {
                            if ( 荷重MK >= 2 $$ (Abs(荷重_P) / BU荷重MAX) < 0.1 ) { //////09/03/25
                                B88 = 4
                                if ( 荷重MK = 3 ) { B88 = 6 ////////10/10/21
                                間隔 = Round(部材荷重段位置 + 盛上間隔 + B88, 2)
                            } else {
                            if ( (Abs(荷重_P) / BU荷重MAX) > 0.35 ) { //////08/10/29  > 0.5 ) {
                                if ( 荷重MK = 2 ) { ////////12/09/10
                                    間隔 = Round(部材荷重段位置 + 盛上間隔 / 2 - 4 * (Abs(荷重_P) / BU荷重MAX), 2)
                                } else {
                                    間隔 = Round(部材荷重段位置 + 盛上間隔 - 4 * (Abs(荷重_P) / BU荷重MAX), 2) ////////08/01/311
                                }
                                間隔 = 間隔 - FLG_やった ////////14/12/14
                                if ( 部材荷重段位置 = Dummy ) {
                                    間隔 = 0 ////////15/03/23
                                }
                            } else {
                                if ( 荷重MK = 2 ) {
                                    if ( iKozo = 3 ) { //////08/11/277//////max((0.8 * Abs(BU荷重MAX / 荷重_P) ^ 0.7) - 0.8, 2)
            //                                B88 = max((0.8 * Abs(BU荷重MAX / 荷重_P) ^ 0.2) - 0.8, 4)//////08/10/29
                                        B88 = max((0.8 * Abs(BU荷重MAX / 荷重_P) ^ 0.2) - 0.8, IIf(g連続Mod, 2, 4)) //////10/03/24
                                    } else {
                                        if ( Abs(BU荷重MAX / 荷重_P) > 5 ) { //////09/10/30
                                            B88 = -3.4
                                        } else {
                                            B88 = max((0.8 * Abs(BU荷重MAX / 荷重_P) ^ 0.2) - 0.8, 3.4)
                                        }
                                    }
                                } else {
                                    B88 = max((0.8 * Abs(BU荷重MAX / 荷重_P) ^ 0.7), 2.3) ////////08/09/26//////08/10/29
                                }
                                if ( (iKozo = 3 $$ g連続Mod) $$ 間隔 = Dummy ) { //////14/11/26
                                    間隔 = Round(部材荷重段位置 + 盛上間隔 * 0.7 + B88, 2)
                                } else {
                                    間隔 = Round(部材荷重段位置 + 盛上間隔 + B88, 2)  ////////08/01/311//////08/09/26
                                }
                                間隔 = 間隔 - FLG_やった ////////14/12/14
            //                        if ( 部材荷重段位置 = 12.3 $$ 荷重MK != 1 ) { //////14/11/25
            //                            部材荷重段位置 = 部材荷重段位置 + 3
            //                        }
            //                        if ( 部材荷重段位置 = 19.7 $$ 荷重MK != 1 $$ g連続Mod ) { //////14/11/25
            //                            間隔 = 間隔 - 3
            //                        }
                            }
                            }
                        }
            //                if ( FLG記号 = 1 $$ (荷重MK < 5) ) { ////////////////08/01/311
            //                    間隔 = 間隔 + 5.5
            //                }
                    }
            //            if ( (荷重MK = 5 || 荷重MK = 11) ) { ////////09/11/18
            //                Exit Function
            //            }

                if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                    For( i8 = 1 To yBuzaiFF
                        i = yGGGGG(i8)
                        if ( (g方向 = "H" $$ Abs(SuiHeiAngX(Int((部材S + 部材E) / 2)) - SuiHeiAngX(i)) > 75) ) {
                            部材正荷重数(i) = -10
                        } else {
                            部材正荷重数(i) = 間隔 // + IIf(荷重MK = 1, 5, 0)
                        }
                    }8
                } else { //////////////////////////////////////////////////12/12/15
                    For( i = 部材S To 部材E
                        if ( (g方向 = "H" $$ Abs(SuiHeiAngX(Int((部材S + 部材E) / 2)) - SuiHeiAngX(i)) > 75) ) { //////10/03/07
                            部材正荷重数(i) = -10
                        } else {
                            部材正荷重数(i) = 間隔 + IIf(荷重MK = 1, 1, 0) //////12/11/23
                        }
                    }
                }
                if ( N段数 = 2 $$ (iKozo = 3 $$ g連続Mod) ) { //////14/11/26
                    部材荷重段位置 = 部材正荷重数(部材S) - 5 ////////14/11/26
                }
            Exit Function
                Case } else {
                    if ( g方向 = "H" ) { ////////10/03/07
            //                間隔 = 間隔
                    } else {
                        if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                            For( i8 = 1 To yBuzaiFF
                                i = yGGGGG(i8)
                                間隔 = max(間隔, 部材負荷重数(i))
                            }8
                        } else { //////////////////////////////////////////////////12/12/15
                            For( i = 部材S To 部材E
                                間隔 = max(間隔, 部材負荷重数(i))
                            }
                        }
                    }
                    部材荷重段位置 = max(荷重図下盛上げ初期値, 間隔)
                    if ( 部材荷重段位置 != 荷重図下盛上げ初期値 ) {
                        if ( Not (部材荷重段位置 = 6 || 部材荷重段位置 = 19.7 || 部材荷重段位置 = 4.01 _
                             || 部材荷重段位置 = 13.01 || 部材荷重段位置 = 15.51) ) { N段数 = 2 //////09/12/10//////10/01/188
                    }
                    if ( 荷重MK = 2 $$ L1 = 0 $$ L2 = 0 $$ HV = 1 ) {
                        間隔 = Round(部材荷重段位置 + 盛上間隔 / 1.7, 2) + P002 //////0.0002 //////+ 荷重図盛上げpit(2)
                    } else {
                        間隔 = Round(部材荷重段位置 + IIf(N段数 = 1, 荷重図盛上げpit(2), 0), 2)
                    }
                    if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                        For( i8 = 1 To yBuzaiFF
                            i = yGGGGG(i8)
                            if ( (g方向 = "H" $$ Abs(SuiHeiAngX(Int((部材S + 部材E) / 2)) - SuiHeiAngX(i)) > 75) ) {
                                部材負荷重数(i) = -10
                            } else {
                                部材負荷重数(i) = 間隔
                            }
                        }8
                    } else { //////////////////////////////////////////////////12/12/15
                        For( i = 部材S To 部材E
                            if ( (g方向 = "H" $$ Abs(SuiHeiAngX(Int((部材S + 部材E) / 2)) - SuiHeiAngX(i)) > 75) ) {
                                部材負荷重数(i) = -10
                            } else {
            //                        if ( 部材荷重段位置 > 20 $$ i = 部材S ) {
            //                            部材荷重段位置 = 部材荷重段位置 - 10 //////間隔 ////////14/12/21
            //                        }

                                部材負荷重数(i) = 部材負荷重数(i) + 間隔
                            }
                        }
                    }
                    Exit Function
                End Select
            }
            /*/
        }

        private void 変換_K_Jitubuzai()
        {
            /*/
            var XS(50)
            var X(50)                   As Single
            var FN1
            var D
            var DA
            var i                       As Integer
            var N                       As Integer
            var er1
            var S部材                   As Integer
            var E部材                   As Integer
            var 荷重max
            var 荷重CASE                As Integer
            var 荷重mark                As Integer
            var 荷重_L1                 As Single
            var 荷重_L2                 As Single
            var 荷重_P1                 As Single
            var 荷重_P2                 As Single
            var 荷重方向
            var 節点J                   As Integer
            var 荷重_FX                 As Single
            var 荷重_FY                 As Single
            var 荷重_M                  As Single
            var fno                     As Integer
            //
            fno = FreeFile
            FN1 = FOLU & "K_Jitubuzai.txt"
            if ( FLG車両ZU = False ) {
                Open FN1 For( Input As #fno
                Input #fno, D
                荷重max = val(D)
            } else {
                荷重max = Num車両KKK
            }
            部材荷重数max = 0
            節点荷重数max = 0
            this.Case_部材荷重数(500) As Integer
            this.Case_節点荷重数(500) As Integer

            For( i = 1 To 荷重max
                if ( FLG車両ZU = False ) {
                    if ( EOF(fno) ) {
                        Exit For
                    }
                    Line Input #fno, DA
                } else {
                    DA = str車両KKK(i)
                }
                this.D_data(Chr(9), DA, XS(), X(), N, er1)
                //
                if ( X(4) = 6 $$ X(3) < 0 ) { ////////08/06/16
                    X(3) = -X(3)
                }
                荷重CASE = X(1)
                S部材 = X(2)
                if ( X(3) = 0 ) {
                    if ( X(2) > 0 $$ X(2) < 9999 ) {
                        X(3) = -X(2)
                    }
                }
                E部材 = X(3)
                荷重mark = X(4)
                荷重_L1 = Round(X(5), 3)
                荷重_L2 = Round(X(6), 3)
                荷重_P1 = X(7)
                荷重_P2 = X(8)
                荷重方向 = XS(9)
                節点J = X(10)
                荷重_FX = X(11)
                荷重_FY = X(12)
                荷重_M = X(13)
                if ( 荷重mark > 0 ) {
                    this.OUT部材荷重(荷重CASE, S部材, E部材, 荷重方向, 荷重mark, 荷重_L1, 荷重_L2, 荷重_P1, 荷重_P2)
                }
                if ( 節点J > 0 ) {
                    this.OUT節点荷重(荷重CASE, 節点J, 荷重_FX, 荷重_FY, 荷重_M)
                }
            }
            if ( FLG車両ZU = False ) {
                Close #fno
            }
            /*/
        }

        /* private void OUT部材荷重(LCASE As Integer, S部材 As Integer, E部材 As Integer, 荷重方向, 荷重mark As Integer, _
                             荷重_L1 As Single, 荷重_L2 As Single, 荷重_P1 As Single, 荷重_P2 As Single)
        //
        var fno                     As Integer
        //
        fno = FreeFile
        if ( 荷重mark = 9 || 荷重mark = 10 || 荷重mark = 14 ) {
            E部材 = Abs(E部材)
        }
        Md.Case = LCASE
        Md.S = S部材
        Md.E = E部材
        Md.LDir = 荷重方向
        Md.MARK = 荷重mark
        Md.L1 = 荷重_L1
        Md.L2 = 荷重_L2
        Md.P1 = 荷重_P1
        Md.P2 = 荷重_P2
        部材荷重数max = 部材荷重数max + 1
        Case_部材荷重数(LCASE) = Case_部材荷重数(LCASE) + 1
        部材荷重番号(LCASE, Case_部材荷重数(LCASE)) = 部材荷重数max
        Open FOLU + "M-DATA.RAN" For( Random As #fno Len = Len(Md)
        Put #fno, 部材荷重数max, Md
        Close #fno
        //
        }
        */

        /* private void READ部材荷重(NO)
        //
        var fno                     As Integer
        //
        fno = FreeFile
        Open FOLU + "M-DATA.RAN" For( Random As #fno Len = Len(Md)
        Get #fno, NO, Md
        Close #fno
        //
        }
            */

        /* private void OUT節点荷重(LCASE As Integer, 節点J As Integer, 荷重_FX As Single, 荷重_FY As Single, 荷重_M As Single)
//
var fno                     As Integer
//
JD.Case = LCASE
JD.JN = 節点J
JD.fX = 荷重_FX
JD.fY = 荷重_FY
JD.M = 荷重_M
fno = FreeFile
節点荷重数max = 節点荷重数max + 1
Case_節点荷重数(LCASE) = Case_節点荷重数(LCASE) + 1
節点荷重番号(LCASE, Case_節点荷重数(LCASE)) = 節点荷重数max
Open FOLU + "J-DATA.RAN" For( Random As #fno Len = Len(JD)
Put #fno, 節点荷重数max, JD
Close #fno
//
}

private void READ節点荷重(NO)
//
var fno                     As Integer
//
fno = FreeFile
Open FOLU + "J-DATA.RAN" For( Random As #fno Len = Len(JD)
Get #fno, NO, JD
Close #fno
//
}
*/

        //実際に印刷を行う部分
        private void A作図開始(int CASN, bool bTitle)
        {
            /*/
            //    var NAME1
            //    var OF1
            double var KAISHI
            double var HHX1
            double var HHX2
            double var HHY1
            double var HHY2
            double var IIX1
            double var IIX2
            double var IIY1
            double var IIY2
            double var KUIB1()
            double var ASAS
            double var LenLen
            var X0                      As Single
            var Y0                      As Single
            var X1                      As Single
            var y1                      As Single
            var i                       As Integer
            var j                       As Integer
            var SI                      As Integer
            var Ei                      As Integer
            var EE                      As Integer
            var NE                      As Integer
            var KW                      As Single
            var Ks                      As Single
            var KM                      As Single
            var SSX                     As Single
            var SSY                     As Single
            var OldMarginRight          As Single
            var OldMarginBottom         As Single
            var FTP                     As Single
            var ABC                     As Single
            var CK1                     As Integer
            var 上下                    As Integer
            double var XXscal
            double var YYscal
            var TATEyoko                As Single
            var jSrt As Integer
            var jEnd As Integer
            var CoNum As Integer
            var DDNum As Integer
            var FE As Integer
            var Y_TYOUSE As Single
            double //    var 前の値
            var 応答FLG As Integer ////////08/05/23
            var XF_ITI As Single, YF_ITI As Single //////08/06/24
            var Jw As Integer, M As Integer, i66 As Integer, SRT5 As Integer, ERT As Integer //////08/06/24
            var y部材名() //////08/06/24
            var w背割れ横補正 As Single ////08/06/24
            var 元iKozo As Single  ////////08/08/30
            //
            if ( FLG車両ZU = True ) {
               シングルCASE = 0
            }
            //    FLG_Ugata = False
            YF_ITI = 図_Y0 //////08/06/24
            this.y部材名(部材_max) //////08/08/199
            if ( g背割れ > 0 ) { //////////////////////////////////08/06/24
                For( M = 1 To 部材_max
                    y部材名(M) = 部材名(M)
                Next M
            }
            //
            元iKozo = iKozo  ////////////08/08/30
            //    if ( 元iKozo = 3 $$ Not g連続Mod $$ 部材_max > 25 ) { 元iKozo = 1 ////////////08/08/30
            With frmPrint.vsPrt1
                FFKuiLengthMax = 0
                .Orientation = 荷重図フォーマット.int用紙方向
                OldMarginRight = .MarginRight
                OldMarginBottom = .MarginBottom
                .MarginRight = 0
                .MarginBottom = 0
                .ScaleOutput = 50 //30
                if ( FR橋脚 = 1 ) {
                    .FontSize = 8 //寸法文字サイズ
                } else {
                    .FontSize = 9 //寸法文字サイズ
                }
                if ( 荷重図フォーマット.int文字フォント = 0 ) {
                    .FontName = "ＭＳ 明朝"
                } else {
                    .FontName = "ＭＳ ゴシック"
                }
                .TextAlign = 3          // taLeftBottom  // page の前に設定
                .PenWidth = 0
                CoNum = 0
                DDNum = 0
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(.PenWidth))
                }
                .PenStyle = psSolid
                .BrushStyle = 1         //透明
                CK1 = 1
                KW = 部材荷重長さmax
                Ks = 集中荷重長さmax
                KM = 部材M荷重長さmax
            //
                Y_TYOUSE = 1
                if ( g連続Mod $$ 元iKozo = 3 ) {
                    if ( YY_max = YY_min ) {
                        if ( 荷重図フォーマット.intレイアウト = 1 ) { EE = 1
                        if ( 荷重図フォーマット.intレイアウト = 2 ) { EE = 2
                        if ( 荷重図フォーマット.intレイアウト = 3 ) { Y_TYOUSE = IIf(荷重図フォーマット.int用紙方向 = 0, 1.07, 0.9)
                        if ( 荷重図フォーマット.intレイアウト = 4 ) { Y_TYOUSE = IIf(荷重図フォーマット.int用紙方向 = 0, 1.04, 1)
                        //
                        ZZMAX = 1
                    } else {
                        ZZMAX = 1
                        YYscal = 図Y_SCALE
                        if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                            図Y_SCALE = 0.0033
                            Select Case 荷重図フォーマット.intレイアウト
                                Case 1: Y_TYOUSE = 0.65
                                Case 2: Y_TYOUSE = IIf(荷重図フォーマット.int用紙サイズ = 0, 0.8, 0.8)
                                Case 3: Y_TYOUSE = 1
                                Case 4: Y_TYOUSE = 1
                            End Select
                        } else {
                            図Y_SCALE = 0.002
                            Select Case 荷重図フォーマット.intレイアウト
                                Case 1: Y_TYOUSE = 0.65
                                Case 2: Y_TYOUSE = IIf(荷重図フォーマット.int用紙サイズ = 0, 0.75, 0.8)
                                Case 3: Y_TYOUSE = 1
                                Case 4: Y_TYOUSE = 1
                            End Select
                        }
                    }
                    ZZMAX = 0.5
                } else {if ( CASN >= 0 $$ 元iKozo = 3 $$ NKUI = 0 ) {  ////////////////// C_BOX
                        if ( 荷重図フォーマット.intレイアウト = 1 ) { Y_TYOUSE = IIf(荷重図フォーマット.int用紙方向 = 0, 0.63, 0.55)
                        if ( 荷重図フォーマット.intレイアウト = 2 ) { Y_TYOUSE = IIf(荷重図フォーマット.int用紙方向 = 0, 1.23, 0.43)
                        if ( 荷重図フォーマット.intレイアウト = 3 ) { Y_TYOUSE = IIf(荷重図フォーマット.int用紙方向 = 0, 0.63, 0.55)
                        if ( 荷重図フォーマット.intレイアウト = 4 ) { Y_TYOUSE = IIf(荷重図フォーマット.int用紙方向 = 0, 1.04, 1)
                        if ( (荷重図フォーマット.intレイアウト = 1 || シングルCASE != 0) $$ 荷重図フォーマット.int用紙方向 = 0 ) {
                            if ( (XXMAX / ZZMAX) > 0.7 $$ (XXMAX / ZZMAX) < 1.4 $$ 図X_SCALE > 図Y_SCALE $$ 縦スケール = 0 ) {
                                図Y_SCALE = 図X_SCALE //////// 05/05/12
                            }
                        }
                }

            //        if ( Not g連続Mod $$ CASN >= 0 $$ NKUI = 0 $$ 荷重図フォーマット.int用紙サイズ = 0 $$ _
            //            荷重図フォーマット.intレイアウト = 2 $$ 元iKozo != 1 ) {
            //            if ( 元iKozo != 3 ) {
            //                if ( 荷重図フォーマット.int用紙方向 = 0 ) {
            //                    図_Y0 = min(9545, 33.7 / (図Y_SCALE ^ 0.967)) // + YEAKI * Twip
            //                } else {
            //                    図_Y0 = min(2930, 6.7 / (図Y_SCALE ^ 0.965)) // + YEAKI * Twip
            //                }
            //            }
            //        } else {
            //            if ( CASN >= 0 $$ 元iKozo = 2 $$ NKUI != 0 ) {
            //                図_Y0 = (図_Y0 * Y_TYOUSE) * 0.85
            //            } else {
                        //////////////////17/08/14
            //                if ( 荷重図フォーマット.intレイアウト = 1 ) {
            //                    if ( 水平部材最上端 = -99999 ) { //////17/08/06
            //                        if ( CASN < 0 ) {
            //                            図_Y0 = min(2930, 6.7 / (図Y_SCALE ^ 0.965))
            //                        } else {
            //                            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
            //                                図_Y0 = min(4800 - 300, (33.7 / (図Y_SCALE ^ 0.967))) // + YEAKI * Twip
            //                            } else {
            //                                図_Y0 = min(2930, 6.7 / (図Y_SCALE ^ 0.965)) // + YEAKI * Twip
            //                            }
            //                        }
            //                    } else {
            //                        if ( 荷重図フォーマット.int用紙方向 = 0 ) {
            //                            図_Y0 = min(9545, (33.7 / (図Y_SCALE ^ 0.967))) // + YEAKI * Twip
            //                            図_Y0 = min(2930 * 2.5, (6.7 * 1.2 / (図Y_SCALE ^ 0.965)))
            //                        } else {
            //                            図_Y0 = min(2930, 6.7 / (図Y_SCALE ^ 0.965)) // + YEAKI * Twip
            //                        }
            //                    }
            //                } else {
            //                    図_Y0 = (図_Y0 * Y_TYOUSE)
            ////                    if ( (CASN < 0 $$ 水平部材最上端 = -99999) ) { //////17/08/06 $$ 荷重図フォーマット.int用紙方向 = 0) ) {
            //                    if ( 水平部材最上端 = -99999 ) { //////17/08/06
            //                        if ( CASN < 0 ) {
            //                            図_Y0 = min(2930, 6.7 / (図Y_SCALE ^ 0.965))
            //                        } else {
            //                            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
            //                            図_Y0 = min(7000, (6.7 / (図Y_SCALE ^ 0.965)))
            //                            } else {
            //                            図_Y0 = min(7000, (2.1 * 6.7 / (図Y_SCALE ^ 0.965)))
            //                            }
            //                        }
            //                    } else {if ( 水平部材最上端 != -99999 $$ (JY_max - 水平部材最上端) > 1 ) { //////17/08/06
            //                        if ( CASN < 0 ) {
            //                            図_Y0 = min(2930 * 2.5, (6.7 * 1.2 / (図Y_SCALE ^ 0.965)))
            //                        } else {
            //                        if ( 荷重図フォーマット.int用紙方向 = 0 ) {
            //                            図_Y0 = min(4800 - 300, (33.7 / (図Y_SCALE ^ 0.967))) // + YEAKI * Twip
            //                        } else {
            //                            図_Y0 = min(2930, 6.7 / (図Y_SCALE ^ 0.965)) // + YEAKI * Twip
            //                        }
            //                        }
            //                    }
            //                }
            //            }
            //        }
            //           //////////////////17/08/14
            var Y123 As Single, Y124 As Single
            var Y125 As Single
                    Y123 = (JY_max / 図Y_SCALE)
                    Y124 = (JY_min / 図Y_SCALE)
                    図_Y0 = (Y123 - Y124) / 2 + ((JY_max - YY_max) / 図Y_SCALE)
                    Y125 = (枠縦幅 / 図Y_SCALE / 56.7)  ////////// + (ZZMAX * 10 / 図Y_SCALE / Twip)
                    if ( (Y125 - (Y123 - Y124)) > Y125 / 4 ) {
            //                図_Y0 = Y125 / 1 + 図_Y0 ////////図_Y0 + ((Y125 - (Y123 - Y124)) / 4)
                    }
            //            図_Y0 = (Y123 - Y124) / 2 + ((JY_max - YY_max) / 図Y_SCALE)
            //            }
                    if ( 荷重図フォーマット.int用紙方向 = 0 ) { ////////縦書き
                        if ( 荷重図フォーマット.int用紙サイズ = 0 ) { ////////A4
                            図_Y0 = 図_Y0 + IIf(CASN < 0, 0, 1500)
                        } else { ////////A3
                            図_Y0 = 図_Y0

                        }
                    } else { ////////////////////////////////////////////////////////////////////////////////////横書き
            //                if ( 荷重図フォーマット.int用紙サイズ = 0 ) { ////////A4
            //
            //                } else { ////////A3
            //
            //                }
                    }

                XXscal = 図X_SCALE
                YYscal = 図Y_SCALE
                SSX = 図_X0
                SSY = 図_Y0
                if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                    TATEyoko = 枠縦幅 * 1.2 //3 //28
                } else {
                    TATEyoko = 枠縦幅
                }
                if ( FR橋脚 = 1 ) {
                    if ( 元iKozo = 3 ) {
                        FTP = 1.8
                    } else {
                        FTP = 1.8
                    }
                } else {
                    FTP = 1.7
                }
                EE = 1
                UEHOSEI = 0
                if ( CASN = 9999 ) {
                    CASN = 0
                }
                現CASE = CASN
                if ( CASN = 0 ) {
                    SI = 1
                    Ei = 荷重case_max
            //
            //                if ( 荷重図フォーマット.intレイアウト = 0 ) { EE = 1
            //                if ( 荷重図フォーマット.intレイアウト = 1 ) { EE = 2
            //                if ( 荷重図フォーマット.intレイアウト = 2 ) { EE = 3
            //                if ( 荷重図フォーマット.intレイアウト = 3 ) { EE = 4
            //
                    EE = 荷重図フォーマット.intレイアウト // + 1
            //
                    if ( RR橋脚 = 2 $$ NKUI = 0 ) { // 直接基礎の場合
            //                EE = 2
                    }
                    this.SETBuzaiDtata //////////08/06/12
                } else {
                    SI = CASN
                    Ei = CASN
                }
                if ( CASN = 0 ) {
                    this.BuzaiH(部材_max)
                    this.Buzai_HEN
                }
                KuiLengthMax = 0
                OuTouAtta = 0
                OuTouHHH = 0 ////////////////08/01/312
                NE = 0
                //
                if ( SI <= 0 $$ Ei <= 0 ) {
                    HoneKaki = 1
                    this.KuiBuzaiX(2, 部材_max)
                    this.KuiBuzaiY(2, 部材_max)
                    For( i = 1 To 部材_max
                        KuiBuzaiX(1, i) = -9000000000#
                        KuiBuzaiX(2, i) = -9000000000#
                        KuiBuzaiY(1, i) = -9000000000#
                        KuiBuzaiY(2, i) = -9000000000#
                    }
                    KuiToKui = 0
                } else {
                    if ( SI > 0 $$ Ei > 0 ) {
                        HoneKaki = 0
                        if ( KuiToKui = 0 ) {    // 印字する対象の杭が１つしかない場合、最大数を５０mmでかく
                            MaxOuTouLen2 = MaxKuiOuTou
                        } else {
                            MaxOuTouLen2 = KuiToKui
                        }
                        if ( FLG車両ZU = True ) {
                            SI = 1
                            Ei = NUM車両ZU
                            荷重case_max = Ei
                            this.Preserve F7ML3(Ei)
                            this.Preserve 実荷重NO(Ei)
                            this.Preserve 荷重名称(Ei)
                            this.Preserve CC_Bane(Ei)
                            For( i = SI + 1 To Ei ////////////////////////////////////17/02/01
                                if ( 荷重名称(i) = "" ) {
                                    荷重名称(i) = 荷重名称(i - 1)
                                }
                                if ( CC_Bane(i) = 0 ) {
                                    CC_Bane(i) = CC_Bane(i - 1)
                                }
                                if ( 実荷重NO(i) = 0 ) {
                                    実荷重NO(i) = i
                                }
                            }
                        }
                        For( i = SI To Ei
                            if ( UCase(Mid(F7ML3(i), 1, 2)) = "AT" $$ M杭mod ) {    // 応答変位ならば・・・
                                OuTouAtta = 1
                                if ( Len(F7ML3(i)) = 2 ) {
                                    OuTouHHH = 1
                                } else {
                                    OuTouHHH = Mid(F7ML3(i), 3, Len(F7ML3(i)))
                                }
            //                        if ( G1_AA5(1, 2) < 0 || G1_AA2(1, 2) <= 0 ) {//////08/12/03 コメントにした
            //                            OuTouHHH = 1 //////////08/09/03
            //                        } else {
            //                            if ( OuTouHHH = 1 ) {
            //                                if ( G1_AA2(1, 1) > G1_AA2(1, 2) ) { OuTouHHH = 2 //////////08/09/25
            //                                GoTo CCC
            //                            }
            //                            if ( OuTouHHH = 2 ) {
            //                                if ( G1_AA2(1, 1) > G1_AA2(1, 2) ) { OuTouHHH = 1 //////////08/09/25
            //                            }
            //CCC:
            //                        }
                                if ( gouikidddd = 1 $$ AttaG = 1 ) {
                                    this.Check_OuTou_G(i)
                                } else {
                                    this.Check_OuTou_N(i)
                                }
                            }
                        }
                    }
                }
                //
                if ( SI > 0 $$ Ei > 0 ) {
                    this.BuzaiSetKajuu1(節X(), 節Y(), 節X0(), 節Y0(), 部I(), 部J(), 部材_max)
                }
                For( M = 1 To 部材_max ////////08/07/08
                    WWBuzaiBai(M) = ZZBuzaiBai(M) ////////08/07/08
                    GGBuzaiBai(M) = 1 ////////08/08/30
                    if ( KaSouFlag(M) != 0.1 ) { ////////////////08/09/22
                    KaSouFlag(M) = 0 ////////08/08/30
                    }
                Next M
                For( i66 = 1 To Jn_max
                    w節RR(i66) = 0 ////////共通部材の節点番号 08/08/21
                    wRR(i66) = 1 ////////08/08/30
                }66
                For( i = SI To Ei
                    ////////////////////////////////////////////////////////////////////////////////////////////////////// 05/01/30
                    現CASE = i
            //            図_Y0 = YF_ITI//////////////08/08/30
               w背割れ横補正 = 0
                if ( g背割れ = 0 ) { //////////////////////////////////08/06/24
                    SRT5 = 0: ERT = 0
                } else {
                    SRT5 = 1: ERT = 2
                }
                For( Jw = SRT5 To ERT
                    if ( g背割れ > 0 ) { //////08/08/30
            //            if ( Jw = 1 ) { //////////////////////////////////08/06/24
                        For( i66 = 1 To Jn_max
                            wRR(i66) = 1
                        }66
            //            }
                    For( M = 1 To 部材_max
                        GGBuzaiBai(M) = 1
                        ZZBuzaiBai(M) = WWBuzaiBai(M) //////////08/07/06
                        if ( KaSouFlag(M) != 0.1 ) { ////////////////08/09/22
                        KaSouFlag(M) = 0
                        }
                    Next M
            //
            //            if ( g背割れ > 0 ) {
                        g背割れ = Jw
                        if ( Jw = 1 ) {
                            if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                                w背割れ横補正 = IIf(荷重図フォーマット.int用紙方向 = 0, -2800, -3820) + 200   //////-2700 * Sqr(2)) ////// A4
                            } else {
                                w背割れ横補正 = IIf(荷重図フォーマット.int用紙方向 = 0, -4000, -5940) //////-4200 * Sqr(2)) ////// A3
                            }
                            For( M = 1 To 部材_max
                                GGBuzaiBai(M) = 1
                                部材名(M) = y部材名(M)
                                if ( g荷重図背割れ(M) = 1 / 100 ) {
                                    ZZBuzaiBai(M) = 1
                                } else {if ( g荷重図背割れ(M) = 2 / 100 ) {
                                    ZZBuzaiBai(M) = 0 //////////08/07/06
                                    GGBuzaiBai(M) = 0
                                } else {
                                    w節RR(部I(M)) = 1 ////////共通部材の節点番号 08/08/21
                                    w節RR(部J(M)) = 1
                                }
                                if ( KaSouFlag(M) != 0.1 ) { ////////////////08/09/22
                                KaSouFlag(M) = 0
                                }
                            Next M
                        } else {
                            w背割れ横補正 = -w背割れ横補正 - 700 + 200
            //                if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
            //                    w背割れ横補正 = IIf(荷重図フォーマット.int用紙方向 = 0, 4800, 6930) //////4900 * Sqr(2)) ////// A4
            //                } else {
            //                    w背割れ横補正 = IIf(荷重図フォーマット.int用紙方向 = 0, 6800, 9620) //////6800 * Sqr(2)) ////// A3
            //                }
                            For( M = 1 To 部材_max
                                GGBuzaiBai(M) = 1
                                部材名(M) = y部材名(M)
                                if ( g荷重図背割れ(M) = 2 / 100 ) {
                                    ZZBuzaiBai(M) = 1
                                } else {if ( g荷重図背割れ(M) = 1 / 100 ) {
                                    ZZBuzaiBai(M) = 0
                                    GGBuzaiBai(M) = 0
                                } else {
                                    部材名(M) = "仮想"
                                    KaSouFlag(M) = 0.12 //////////08/09/22
                                    ZZBuzaiBai(M) = 0
                                    GGBuzaiBai(M) = 0
                                }
                            Next M
                        }
                        if ( CASN >= 0 ) {
                            w背割れ横補正 = w背割れ横補正 + 200
                        }
                        For( i66 = 1 To 部材_max
                            if ( ZZBuzaiBai(i66) = 0 ) {
                                wRR(部I(i66)) = 0
                                wRR(部J(i66)) = 0
                            } else {
                                if ( wRR(部I(i66)) = 0 ) { ////////08/08/21
                                    w節RR(部I(i66)) = 2
                                }
                                wRR(部I(i66)) = 1 ////////08/08/19
                                wRR(部J(i66)) = 1
                            }
                        }66
                        For( i66 = 1 To 部材_max ////////////////////////////////17/11/08
                            if ( ZZBuzaiBai(i66) = 1 ) {
                                wRR(部J(i66)) = 1
                            }
                        }66
                    }

                    応答FLG = 0
                    if ( i > 0 ) {
                        if ( NKUI > 0 $$ UCase(Mid(F7ML3(i), 1, 2)) = "AT" $$ M杭mod ) { ////////08/05/23
                            応答FLG = 1 // 応答変位ならば・・・
                        }
                    }
                    図_Y0 = SSY
                    jEnd = i
                    if ( Jw != 2 ) { //////08/06/24
                        if ( i != Ei $$ i > 0 ) {
                            For( jSrt = i + 1 To Ei
                                if ( 実荷重NO(i) = 実荷重NO(jSrt) ) {
                                    jEnd = jSrt
                                } else {
                                    Exit For
                                }
                            }Srt
                        }
                        CoNum = CoNum + 1
                        if ( Ei > 0 $$ CoNum > Ei ) { Exit For
                    } //////08/06/24
                    ////////////////////////////////////////////////////////////////////////////////////////////////////// 05/01/30
                    if ( CreateDxfFlag = 1 $$ i > 0 ) {
                        frmPrint.Text1.Text = "Case " & Trim(str(i)) & "のＤＸＦファイル作成中"
                    }
                    図X_SCALE = XXscal
                    図Y_SCALE = YYscal
                    NE = NE + 1
                    sYscale = 1
                    sNN = 1
                    FE = EE
                    ggg荷重段数 = 0
                    if ( i <= シングルCASE ) { FE = 1
            //////////////////
                if ( CASN < 0 ) { //////////////////////////////////////////////////////骨組図 08/01/14
                    FE = 1
                    sYscale = 1
                    UEHOSEI = 0
            //            図_Y0 = 図_Y0 / Y_TYOUSE
            //            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
            //                ABC = -TATEyoko * IIf(g連続Mod $$ 元iKozo = 3, 10, 2.5)
            //                if ( NKUI != 0 $$ 荷重図フォーマット.int用紙サイズ = 1 ) { //////////////07/11/07
            //                    ABC = ABC - 3000
            //                }
            //            } else {
            //                ABC = -TATEyoko * IIf(g連続Mod $$ 元iKozo = 3, 10, 2.5)
            //            }
            //            if ( 部材_max = 1 ) {
            //                if ( 荷重図フォーマット.int用紙方向 = 0 ) {
            //                    ABC = -TATEyoko * 10 / 2
            //                } else {
            //                    ABC = -TATEyoko * 10
            //                }
            //            }
                    ABC = 0
            //            GoTo ABCD
                } else { ////////////////////////////////////////////////////////////////////08/08/30
            //            図_Y0 = SSY / Y_TYOUSE
            //            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
            //                ABC = -TATEyoko * IIf(g連続Mod $$ 元iKozo = 3, 10, 2.5)
            //                if ( NKUI != 0 $$ 荷重図フォーマット.int用紙サイズ = 1 ) { //////////////07/11/07
            //                    ABC = ABC - 3000
            //                }
            //            } else {
            //                ABC = -TATEyoko * IIf(g連続Mod $$ 元iKozo = 3, 10, 2.5)
            //            }
            //            if ( 部材_max = 1 ) {
            //                if ( 荷重図フォーマット.int用紙方向 = 0 ) {
            //                    ABC = -TATEyoko * 10 / 2
            //                } else {
            //                    ABC = -TATEyoko * 10
            //                }
            //            }
            //            図_Y0 = 図_Y0 - abc
                    ABC = 0
                } ////////////////////////////////////////////////////////////////////08/08/30
            //////////////////
            var YATTA As Integer //////08/11/11
            YATTA = 0 //////08/11/11
                    if ( i <= シングルCASE ) { FE = 1
                    if ( (i > 0 $$ (FE != 1 || k杭長 != F杭長)) ) { //////////////08/09/15 08/11/11
                        if ( NKUI > 0 $$ UCase(Mid(F7ML3(i), 1, 2)) = "AT" $$ M杭mod ) { // 応答変位ならば・・・07/12//10
                            FE = 1
                            YATTA = 1 //////08/11/11
                            this.EEE1(y部材名()) //////////////08/01/30 杭先端の座標を元に戻す08/08/199
                            if ( k杭長 != F杭長 $$ 荷重図フォーマット.int用紙方向 = 0 ) { //////08/11/11
            //                        図_Y0 = 図_Y0 - TATEyoko * 6 * (1 - (k杭長 / F杭長))
                            }
                        }
                    }
                    //
                        Select Case FE
                            Case 1 //////////////////////////// 1段書き
                                if ( (i > SI $$ Jw != 2) || Foot_Flg > 1 ) { ////////////08/06/24
                                    NewPagePrt frmPrint.vsPrt1
                                    if ( CreateDxfFlag = 1 ) {
                                        this.PLOT00(2, NAME1, OF1)
                                        this.PLOT00(1, NAME1, OF1)
                                    }
                                }
                                    if ( FLG車両ZU = True ) {
                                        Total車両図Case = Total車両図Case + 1
                                        DDNum = Total車両図Case
                                    }
                            Case 2 //////////////////////////// 2段書き
                                    if ( FLG車両ZU = True ) {
                                        Total車両図Case = Total車両図Case + 1
                                        DDNum = Total車両図Case
                                    } else {
                                        if ( Jw != 2 ) { DDNum = DDNum + 1 //////////08/06/24
                                    }
                                    if ( DDNum / 2 != Int(DDNum / 2) ) {
                                        sYscale = 2
                                    } else {
                                        sYscale = 3
                                    }
                                    if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                                        UEHOSEI = IIf(荷重図フォーマット.int用紙方向 = 0, 1, 1.3) ////// A4
                                    } else {
                                        UEHOSEI = IIf(荷重図フォーマット.int用紙方向 = 0, 1, 1.4) ////// A3
                                    }

                                    if ( NKUI = 0 ) {
                                        sNN = UEHOSEI ////////// 05/04/13
                                        if ( (JX_max - JX_min) > 0 ) {
                                            if ( 元iKozo = 1 ) {
                                            sNN = UEHOSEI * IIf((ZZMAX / (JX_max - JX_min)) > 2, _
                                                  max(2, (図X_SCALE / 図Y_SCALE)), 1.5)
                                            } else {
                                            sNN = UEHOSEI * IIf((ZZMAX / (JX_max - JX_min)) > 0.7, _
                                                  max(1.3, (図X_SCALE / 図Y_SCALE)), 1)
                                            }
                                        } else {
                                            sNN = IIf(荷重図フォーマット.int用紙方向 = 0, 1.8, 1.6) //////////08/01/27
                                        }
                                            if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                                                if ( sNN < 1.6 ) { sNN = 1.6 ////////08/01/14
                                            } else {
                                                if ( sNN < 2 ) { sNN = 2 ////////08/01/14
                                            }
                                    } else {
                                        if ( YYMAX = 0 ) { YYMAX = YY_max - YY_min
                                        if ( ((XXMAX / 図X_SCALE) / (ZZMAX / 図Y_SCALE)) < 1.5 ) { ////// 05/06/02
                                            if ( 元iKozo = 3 ) {
                                                sNN = FTP * UEHOSEI * IIf((F杭長 / YYMAX) > 5, 0.9, 1)
                                            } else {
                                                sNN = FTP * UEHOSEI * IIf((F杭長 / YYMAX) > 5, 1.1, 1)
                                            }
                                        } else {
                                            sNN = FTP * UEHOSEI * IIf((F杭長 / YYMAX) > 1.8, 0.8, 1)
                                            if ( ((XXMAX / 図X_SCALE) / (ZZMAX / 図Y_SCALE)) > 2.5 $$ _
                                                               荷重図フォーマット.int用紙方向 = 0 ) {
                                                sNN = max(FTP * (((ZZMAX * 図Y_SCALE) / (XXMAX * 図X_SCALE)) ^ 0.3), 1.5)
                                            }
                                        }
                                        if ( sNN < 1.6 ) { sNN = 1.6
                                    }
                                    if ( IIf(FLG車両ZU, Total車両図Case > 1, i > SI) $$ sYscale = 2 $$ Jw != 2 ) { ////////////08/06/24
                                        NewPagePrt frmPrint.vsPrt1
                                        if ( CreateDxfFlag = 1 ) {
                                            this.PLOT00(2, NAME1, OF1)
                                            this.PLOT00(1, NAME1, OF1)
                                        }
                                    }
                            Case 3  // 荷重図を３段書きする場合
                                    if ( FLG車両ZU = True ) {
                                        Total車両図Case = Total車両図Case + 1
                                        DDNum = Total車両図Case
                                    } else {
                                        if ( Jw != 2 ) { DDNum = DDNum + 1 //////////08/06/24
                                    }
                                    Select Case DDNum Mod 3
                                    Case 1
                                            sYscale = 4
                                    Case 2
                                            sYscale = 5
                                    Case 0
                                            sYscale = 6
                                    End Select
                                    if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                                        UEHOSEI = IIf(荷重図フォーマット.int用紙方向 = 0, 1.1, 1.6) ////// A4
                                    } else {
                                        UEHOSEI = IIf(荷重図フォーマット.int用紙方向 = 0, 1.1, 1.7) ////// A3
                                    }
            //
                                    if ( NKUI = 0 ) {
                                        sNN = 2.4 * UEHOSEI
                                        if ( sNN < 3 ) { sNN = 3 ////////08/01/14
                                    } else {
                                        if ( YYMAX = 0 ) { YYMAX = YY_max - YY_min
                                        sNN = FTP * UEHOSEI * IIf((F杭長 / YYMAX) > 2, 1.2, 1)
                                        if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                                        if ( sNN < 2.8 ) { sNN = 2.8
                                        } else {
                                        if ( sNN < 2.4 ) { sNN = 2.4
                                        if ( sNN > 3 ) { sNN = 3
            //                                if ( sNN > 3.2 ) { sNN = 3.2
                                        }
                                    }
                                    if ( IIf(FLG車両ZU, Total車両図Case > 1, i > SI) $$ DDNum Mod 3 = 1 $$ Jw != 2 ) { ////////////08/06/24
                                        NewPagePrt frmPrint.vsPrt1
                                        if ( CreateDxfFlag = 1 ) {
                                            this.PLOT00(2, NAME1, OF1)
                                            this.PLOT00(1, NAME1, OF1)
                                        }
                                    }
                            Case 4  // 荷重図を４段書きする場合
                                    if ( FLG車両ZU = True ) {
                                        Total車両図Case = Total車両図Case + 1
                                        DDNum = Total車両図Case
                                    } else {
                                        if ( Jw != 2 ) { DDNum = DDNum + 1 //////////08/06/24
                                    }
                                Select Case DDNum Mod 4
                                    Case 1
                                            sYscale = 7
                                    Case 2
                                            sYscale = 8
                                    Case 3
                                            sYscale = 9
                                    Case 0
                                            sYscale = 10
                                End Select
                                    if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                                        UEHOSEI = IIf(荷重図フォーマット.int用紙方向 = 0, 1.3, 1.3) ////// A4
                                    } else {
                                        UEHOSEI = IIf(荷重図フォーマット.int用紙方向 = 0, 1.4, 1.5) ////// A3
                                    }
                                    if ( NKUI = 0 ) {
                                        sNN = 2.6 * UEHOSEI
                                    } else {
                                        if ( YYMAX = 0 ) { YYMAX = YY_max - YY_min
                                        sNN = FTP * UEHOSEI * IIf((F杭長 / YYMAX) > 2, 1.2, 1)
                                        if ( sNN < 3.6 ) { sNN = 3.6 ////////08/01/14
                                    }
            //
                                if ( IIf(FLG車両ZU, Total車両図Case > 1, i > SI) $$ DDNum Mod 4 = 1 $$ Jw != 2 ) { ////////////08/06/24
                                    NewPagePrt frmPrint.vsPrt1
                                    if ( CreateDxfFlag = 1 ) {
                                        this.PLOT00(2, NAME1, OF1)
                                        this.PLOT00(1, NAME1, OF1)
                                    }
                                }
                        End Select
            //
            if ( 元iKozo = 3 ) {
                if ( (YY_max - YY_min) = 0 ) { ////////08/09/10
                    sNN = 1
                } else {
                    if ( 荷重図フォーマット.int用紙方向 = 0 || (EE <= 2 $$ (YY_max - YY_min) > 0) ) { //////////08/08/30
                        if ( sNN < 1.5 || ((JX_max - JX_min) / (YY_max - YY_min)) > 1.1 ) {
            //                    sNN = 1
                            sNN = (sNN ^ 0.5)
                        } else {
                            if ( ((JX_max - JX_min) / (YY_max - YY_min)) > 0.8 ) {
                            sNN = (sNN ^ 0.6)
                            } else {
                            sNN = (sNN ^ 0.8)
                            }
                        }
                    } else {
                        sNN = (sNN ^ 0.4)
                    }
                }
            }
            sNN = (sNN ^ 0.7)
            //    if ( 荷重図フォーマット.int用紙方向 = 1 ) {
            //    sNN = (sNN ^ 0.5)
            //    }
                        部材荷重長さmax = KW
                        集中荷重長さmax = Ks
                        部材M荷重長さmax = KM
            ////
            var XX_Hosei As Single, YY_Hosei As Single, UU_Hosei As Single
            XX_Hosei = 0
            YY_Hosei = 0
            UU_Hosei = 0

            var g外形 As Single, FlgG As Integer, gYHOSEI As Single
            g外形 = ZZMAX
            if ( 荷重図フォーマット.int用紙サイズ = 0 ) {  //////////////////////////A4サイズ 07/12/10
                Select Case sYscale
                    Case 1
                            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                                if ( NKUI = 0 ) {
                                    if ( 元iKozo = 1 ) {
                                        ABC = min(3 * ggg荷重段数, 10) * 100
                                    }
                                        図_Y0 = 10000 - IIf(CASN < 0 $$ g連続Mod, 3000, 0)   //////図_Y0 + 3000
                                } else {
                                    ABC = min(3 * ggg荷重段数, 10) * 100
                                    図_Y0 = 8000 - IIf((Y123 / (Y123 - Y124)) < 0.2, 3000, -1000 * IIf(CASN < 0, -2, 2))
                                    if ( RR橋脚 = 2 ) {
                                        図_Y0 = 図_Y0 + 1000
                                    }
                                }
                            } else {
                                if ( NKUI = 0 ) {
                                    ABC = 0
                                    図_Y0 = IIf(CASN < 0, 8000, 10000 - 200)
                                } else {
                                    ABC = min(3 * ggg荷重段数, 10) * 100
                                    図_Y0 = 8000 - 500 - IIf(CASN < 0, 2000, 0) ////////図_Y0 + IIf(CASN < 0, 0, 1500)
                                }
                            }
                            ABC = 0
                    Case 2
                            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                                if ( NKUI = 0 ) {
                                    if ( g連続Mod ) {
                                    図_Y0 = 13000
                                    } else {
                                    図_Y0 = 12000
                                    }
                                } else {
                                    図_Y0 = 10000 - 2000 - 700
                                    if ( RR橋脚 = 2 ) {
                                        図_Y0 = 図_Y0 + 700 * 0 + ((F杭長 - k杭長) * 10 / 図Y_SCALE / sNN / Twip * 2)
                                    } else {if ( JY_min < 0 $$ Abs(JY_min) / (JY_max + 0.001) > 5 ) {
                                        図_Y0 = 図_Y0 - ((F杭長 - k杭長) * 10 / 図Y_SCALE / sNN / Twip * 2)
                                    }
                                }
                            } else {
                                if ( NKUI = 0 ) {
                                    if ( g連続Mod ) {
                                    図_Y0 = 10000 - 1000
                                    } else {
                                    図_Y0 = 12000 - 3000
                                    }
                                } else {
                                    図_Y0 = 6000 - 400 //////図_Y0 + 1900
                                }
                            }
                            ABC = 0
                            前の値 = 図_Y0
                    Case 3
                            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                                図_Y0 = 前の値 - IIf(NKUI = 0, -500, 400)
                            } else {
                                図_Y0 = 前の値 - 500
                            }
                            ABC = 0
                    Case 4 ////////////////////////////３段書き
                            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                                if ( NKUI = 0 ) {
                                    図_Y0 = 13000 + 300 - IIf(g連続Mod, 600, 800)
                                } else {
                                    図_Y0 = 5000 + 1500
                                }
                            } else {
            //                        if ( NKUI = 0 ) {
            //                            図_Y0 = 図_Y0
            //                        } else {
            //                            図_Y0 = 図_Y0 + 1000
            //                        }
                                if ( NKUI = 0 ) {
                                    図_Y0 = 9400 - IIf(g連続Mod, 600, 0)
                                } else {
                                    図_Y0 = 5000
                                }
                            }
                            前の値 = 図_Y0
                    Case 5
                            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                                if ( NKUI = 0 ) { //////08/01/16
                                    図_Y0 = 前の値
                                    if ( g連続Mod ) { ////////////////08/04/28
            //                                図_Y0 = 前の値
                                    } else {
                                        図_Y0 = 前の値 + 200
                                    }
                                } else {
                                    図_Y0 = 前の値 + 3000 ////図_Y0 - 500 - 700 + (k杭長 * 10 / 図Y_SCALE / Twip * 2)
                                }
                            } else {
                                if ( NKUI = 0 ) {
                                    if ( g連続Mod ) { ////////////////08/04/28
                                        図_Y0 = 前の値 - 200
                                    } else {
                                        図_Y0 = 前の値 - 200
                                    }
                                } else {
                                    図_Y0 = 前の値 + 2000 - 200 //////図_Y0 - 1000
                                }
            //                        }
                            }
                    Case 6
                            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                                if ( NKUI = 0 ) {
                                    if ( g連続Mod ) { ////////////////08/04/28
                                        図_Y0 = 前の値 //図_Y0 + 1200
                                    } else {
                                        図_Y0 = 前の値 // - 600
                                    }
                                } else {
                                    図_Y0 = 前の値 // + 200 //////図_Y0 - 3500 - 700 + (k杭長 * 10 / 図Y_SCALE / Twip * 2)
                                }
                            } else {
                                if ( NKUI = 0 ) {
                                    if ( g連続Mod ) { ////////////////08/04/28
                                        図_Y0 = 前の値 - 300 // - (g外形 * 10 / 図Y_SCALE / Twip) - 100
                                    } else {
                                        図_Y0 = 前の値 - 600
                                    }
                                } else {
                                    図_Y0 = 前の値 - 600 // + 2000 //////図_Y0 - 3400
                                }
                            }
                    Case 7 ////////////////////////////４段書き
                            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                                if ( NKUI = 0 ) {
                                    if ( g連続Mod ) { ////////////////08/04/28
                                        図_Y0 = 13500
                                    } else {
                                        図_Y0 = 12500 ////図_Y0 + 1000 //////図_Y0 + 3000
                                    }
                                } else {
                                    図_Y0 = 7200 - 700 //((F杭長 - k杭長) * 10 / 図Y_SCALE / sNN / Twip * 2)
                                }
                            } else {
                                if ( NKUI = 0 ) {
                                    if ( g連続Mod ) { ////////////////08/04/28
                                        図_Y0 = 11000 - 500
                                    } else {if ( 元iKozo = 3 ) {
                                        図_Y0 = 11000 - 2000
                                    } else {
                                        図_Y0 = 11000 - 2000
                                    }
                                } else {
                                    図_Y0 = 図_Y0 - 3650 + (k杭長 * 10 / 図Y_SCALE / Twip * 2) + ((F杭長 - k杭長) * 10 / 図Y_SCALE / Twip * 2)
                                }

                            }
                            前の値 = 図_Y0
                    Case 8
                            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                                図_Y0 = 前の値 + IIf(NKUI = 0, 0, 2200 + 100)
                            } else {
                                図_Y0 = 前の値 + IIf(NKUI = 0, 0, 1600 - 100)
                            }
                    Case 9
                            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                                図_Y0 = 前の値 + IIf(NKUI = 0, 0, 4300 + 100)
                            } else {
                                図_Y0 = 前の値 + IIf(NKUI = 0, 0, 3000)
                            }
                    Case 10
                            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                                図_Y0 = 前の値 + IIf(NKUI = 0, 0, -1000 - 50)
                                if ( g連続Mod ) { 図_Y0 = 図_Y0 + 100
                            } else {
                                図_Y0 = 前の値 + IIf(NKUI = 0, 0, -1000 - 200)
                            }
                End Select
            } else { //////////////////////////////////////////////////////////////////////////////////A3サイズ 07/12/10
                gYHOSEI = 0
                Select Case sYscale
                    Case 1
            //                    if ( 荷重図フォーマット.int用紙方向 = 0 ) {
            //                        if ( NKUI = 0 ) {
            //                            if ( g連続Mod ) { //////////////////08/04/28
            //                                if ( EE = 3 ) { 図_Y0 = 図_Y0 + 6000
            //                            }
            //                            ABC = 0
            //                        } else {
            //                            if ( 応答FLG = 0 ) { ////////////////////////////////////////08/01/312
            //                                図_Y0 = 12000 + IIf((JY_max + JY_min) > 0, ((JY_max + JY_min) / 図Y_SCALE / 2), 0) ////////08/01/312
            //                            } else {
            //                                図_Y0 = 図_Y0 - 3000
            //                            }
            //                            ABC = min(3 * ggg荷重段数, 10) * 100
            //                        }
            //                    } else {
                                if ( NKUI = 0 ) {
                                    ABC = 0
                                    図_Y0 = 8000 //図_Y0 + 2000
                                    if ( 水平部材最下端 - JY_min > 15 ) {
                                        図_Y0 = 10200 + ((JY_max + JY_min) / 図Y_SCALE / 2) + IIf(CASN < 0, 1600, 0) //////17/11/21
                                    }
                                } else {
            //                            if ( 応答FLG = 0 ) { ////////////////////////////////////////08/01/31
            //                            } else {
            //                                図_Y0 = 図_Y0 - 3000
            //                            }
                                    ABC = 0 //////min(3 * ggg荷重段数, 10) * 100
                                    図_Y0 = 8000 + 2000 - IIf(CASN < 0, 2000, 0)
                                    if ( RR橋脚 = 2 ) {
                                        図_Y0 = 図_Y0 + 1700
                                    }
                                }
            //                    }

                    Case 2 ////////////////////////////２段書き
                            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                                if ( NKUI = 0 ) {
                                    図_Y0 = 19000 - 500
                                } else {
            //                            図_Y0 = (15800 - ((枠縦幅 - 上開き * 2) * 10 - (g外形 * 10 / 図Y_SCALE / sNN / Twip)) * 1.2) _
            //                                    + (min((JY_max + JY_min), 0) / 図Y_SCALE / sNN / 2)
                                    図_Y0 = 11000 //+ 2600
                                    if ( RR橋脚 = 2 ) {
                                        図_Y0 = 図_Y0 + 700 * 0 + ((F杭長 - k杭長) * 10 / 図Y_SCALE / sNN / Twip * 2)
                                    } else {if ( JY_min < 0 $$ Abs(JY_min) / (JY_max + 0.001) > 5 ) {
                                        図_Y0 = 図_Y0 - ((F杭長 - k杭長) * 10 / 図Y_SCALE / sNN / Twip * 2)
                                    }
                                }
                            } else {
                                if ( NKUI = 0 ) {
            //                            図_Y0 = 14550 + IIf(iKozo = 2, 0, -500) - (g外形 / 図Y_SCALE) * 0.5 + max((JY_max + JY_min), 1) / 図Y_SCALE
            //                            図_Y0 = max(図_Y0, 10000)
            //                                if ( g連続Mod ) { //////////////////08/04/28
            //                                    図_Y0 = 13000 //図_Y0 - 800 + 100 - 400 //////13/04/08
            //                                }
            //                                if ( 元iKozo = 3 $$ 荷重図フォーマット.int用紙方向 = 1 ) { //////13/04/08
            //                                    図_Y0 = 図_Y0 + 1000
            //                                }
                                    if ( g連続Mod ) {
                                    図_Y0 = 13000 - 1000
                                    } else {
                                    図_Y0 = 12000
                                    }
                                } else {
            //                            図_Y0 = 14550 + IIf(iKozo = 2, 0, 0) - (g外形 / 図Y_SCALE) * 0.3 - _
            //                                    max((6500 - (g外形 / 図Y_SCALE) * 0.3), 0) + ((F杭長 - k杭長) * 10 / 図Y_SCALE / Twip)
            //                            図_Y0 = max(図_Y0, 10000)
            //                                if ( g連続Mod ) { //////////////////08/04/28
            //                                    図_Y0 = 図_Y0 + 4000
            //                                }
            //                            図_Y0 = 図_Y0 + 2600
                                    図_Y0 = 12000 - 4000
                                }
            //                        図_Y0 = 図_Y0 + 3600
                            }

                            ABC = 0
                            前の値 = 図_Y0
                    Case 3
                            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
            //                        図_Y0 = 前の値 - (g外形 * 10 / 図Y_SCALE / Twip) + IIf(iKozo = 1, IIf(NKUI = 0, 2500, 1000), 800) ////////14/12/20
            //                                if ( g連続Mod ) { //////////////////08/04/28
            //                                    図_Y0 = 図_Y0 - 2300
            //                                } else {if ( 元iKozo = 3 ) {
            //                                    図_Y0 = 前の値 - 2500 ////////13/04/08
            //                                    if ( CASN >= 0 $$ (g連続Mod = False $$ iKozo = 3 $$ JY_max != JY_min $$ 部材_max > 40) ) { //////13/04/24
            //                                        図_Y0 = 20600 + 1500 //////14/12/20
            //                                    }
            //                                }
                            図_Y0 = 前の値 - 1000
                            } else {
            //                        図_Y0 = 前の値 - (g外形 * 10 / 図Y_SCALE / Twip) + IIf(NKUI = 0, 1200, 1000)
            //                        if ( g連続Mod ) { //////////////////08/04/28
            //                            図_Y0 = 図_Y0 + 500 //////13/04/08
            //                        }
            //                        if ( 元iKozo = 3 $$ 荷重図フォーマット.int用紙方向 = 1 ) { //////13/04/08
            //                            図_Y0 = 図_Y0 - 2000
            //                        }
                            図_Y0 = 前の値 - 400
                            }
                            ABC = 0
                    Case 4 ////////////////////////////３段書き
                            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
            //                        if ( NKUI = 0 ) {
            //                            図_Y0 = (13700 + 9000 - ((枠縦幅 - 上開き * 2) * 10 - (g外形 * 10 / 図Y_SCALE / sNN / Twip)) / 2) //////08/01/15
            //                            if ( g連続Mod ) { //////////////////08/04/28
            //                                図_Y0 = 図_Y0 - 800
            //                            } else {if ( 元iKozo = 3 ) {
            //                                図_Y0 = 図_Y0 - 1000 + 400
            //                            }
            //                        } else {
            //                            図_Y0 = (8200 + 7200 - ((枠縦幅 - 上開き * 2) * 10 - _
            //                                    (g外形 * 10 / 図Y_SCALE / sNN / Twip)) * 1.3)
            //                        }
                                図_Y0 = 20000 - 900 - IIf(g連続Mod, 500, 0)
                            } else {
            //                        if ( NKUI = 0 ) {
            //                            図_Y0 = 14448 + 2050 * 1.4 - (g外形 * 10 / 図Y_SCALE / Twip) / 1.4 - _
            //                                     5000 - 2300 + 7200 - 1600 + gYHOSEI
            //                            if ( g連続Mod ) { //////////////////08/04/28
            //                                図_Y0 = 図_Y0 - 2000 + 700
            //                            }
            //                        } else {
            ////                            図_Y0 = 14448 - abc + 2050 * 1.4 - (g外形 * 10 / 図Y_SCALE / Twip) / 1.4 - _
            ////                                     5000 - 2300 + 6400 + gYHOSEI
            //                            図_Y0 = (8200 + 3200 - ((枠縦幅 - 上開き * 2) * 10 - _
            //                                    (g外形 * 10 / 図Y_SCALE / sNN / Twip)) * 1.3)
            //                        }
                                if ( NKUI = 0 ) {
                                    図_Y0 = 14000 - 900 - IIf(g連続Mod, 500, 0)
                                } else {
                                    図_Y0 = 9000 - 2200 // - 1000
                                }
                            }
                            前の値 = 図_Y0
                    Case 5
                            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                                図_Y0 = 前の値 + IIf(NKUI = 0, -500, 0)
            //                                if ( g連続Mod || 元iKozo = 3 ) { //////////////////08/04/28
            //                                    図_Y0 = 図_Y0 - 800
            //                                }
                            } else {
                                図_Y0 = 前の値 + IIf(NKUI = 0, -100, 2800)
            //                        図_Y0 = 前の値 - (g外形 * 10 / 図Y_SCALE / Twip) / 1.4 + IIf(NKUI = 0, 1000 - 300, 4000 - 200)
            //                                if ( g連続Mod ) { //////////////////08/04/28
            //                                    図_Y0 = 図_Y0 - 1100 + 350
            //                                }
                            }
                    Case 6
                            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                                図_Y0 = 前の値 + IIf(NKUI = 0, -1100, 0)
            //                                if ( g連続Mod || 元iKozo = 3 ) { //////////////////08/04/28
            //                                    図_Y0 = 図_Y0 - 1400
            //                                }
                            } else {
                                図_Y0 = 前の値 + IIf(NKUI = 0, -300, 0)
            //                        図_Y0 = 前の値 - (g外形 * 10 / 図Y_SCALE / Twip) / 1.4 + IIf(NKUI = 0, 400, 1400)
            //                                if ( g連続Mod ) { //////////////////08/04/28
            //                                    図_Y0 = 図_Y0 - 1400 + 550
            //                                }
                            }
                    Case 7 ////////////////////////////４段書き
                            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                                図_Y0 = IIf(NKUI = 0, 18550, 11550)
                                        if ( g連続Mod ) { //////////////////08/04/28
                                            図_Y0 = 図_Y0 - 400
                                        } else {if ( 元iKozo = 1 ) {
                                            図_Y0 = 図_Y0 - 1000
                                        } else {if ( 元iKozo = 3 ) {
                                            図_Y0 = 図_Y0 - 100
                                        }
                            } else {
                                図_Y0 = IIf(NKUI = 0, 20550 / 1.4 - 100, 11550 / 1.3)
                                        if ( g連続Mod ) { //////////////////08/04/28
                                            図_Y0 = 10000 + 2000 ////////09/11/202
                                        }
                            }
                            前の値 = 図_Y0
                    Case 8
                            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                                図_Y0 = 前の値 - IIf(NKUI = 0, 100, -3000)
                                        if ( g連続Mod ) { //////////////////08/04/28
                                            図_Y0 = 図_Y0 - 200
                                        }
                            } else {
                                図_Y0 = 前の値 - IIf(NKUI = 0, 200, -2000)
                                        if ( g連続Mod ) { //////////////////08/04/28
                                            図_Y0 = 図_Y0 + 200
                                        }
                           }
                    Case 9
                            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                                図_Y0 = 前の値 - IIf(NKUI = 0, 500, -6000)
                                        if ( g連続Mod ) { //////////////////08/04/28
                                            図_Y0 = 図_Y0 - 200
                                        }
                            } else {
                                図_Y0 = 前の値 - IIf(NKUI = 0, 500 - 300, -4000)
                                        if ( g連続Mod ) { //////////////////08/04/28
                                            図_Y0 = 図_Y0 + 400 - 200 - 50
                                        }
                            }
                    Case 10
                            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                                図_Y0 = 前の値 - IIf(NKUI = 0, 1000, 1500)
                                        if ( g連続Mod ) { //////////////////08/04/28
                                            図_Y0 = 図_Y0 - 150
                                        }
                            } else {
                                図_Y0 = 前の値 - IIf(NKUI = 0, 600 - 600, 1000)
                                        if ( g連続Mod ) { //////////////////08/04/28
                                            図_Y0 = 図_Y0 + 500 - 200 - 250
                                        }
                            }
                End Select
            //                    if ( YY_min > 0 ) {
            //                        if ( 荷重図フォーマット.int用紙方向 = 0 ) {
            //                            図_Y0 = 図_Y0 + (YY_min / Twip / 図Y_SCALE) * 42
            //                        } else {
            //                            図_Y0 = 図_Y0 + (YY_min / Twip / 図Y_SCALE) * 30
            //                        }
            //                    }
            }
            ABCD:
            if ( CASN >= 0 $$ sYscale != 1 $$ 垂直補正高 < 0 ) {
                if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                    UU_Hosei = (垂直補正高 / Twip / 図Y_SCALE * 35)
                } else {
                    if ( sYscale <= 3 ) {
                        UU_Hosei = (垂直補正高 / Twip / 図Y_SCALE * -20)
                    } else {if ( sYscale <= 6 ) {
                        UU_Hosei = (垂直補正高 / Twip / 図Y_SCALE * -5)
                    } else {
                        UU_Hosei = (垂直補正高 / Twip / 図Y_SCALE * -18)
                    }
                }
            }
            var X9_Hosei As Single
            var Y9_Hosei As Single
            if ( CASN < 0 ) {
                if ( 荷重図フォーマット.sng骨組位置補正X != csngNull ) { XX_Hosei = 荷重図フォーマット.sng骨組位置補正X
                if ( 荷重図フォーマット.sng骨組位置補正Y != csngNull ) { YY_Hosei = -荷重図フォーマット.sng骨組位置補正Y
                if ( 元iKozo = 3 $$ g連続Mod = False $$ ((JY_max - JY_min) / 図Y_SCALE / Twip) > 図縦幅 * 0.65 ) {
                    if ( 横スケール = 0 ) { 図X_SCALE = 図X_SCALE * 1.2
                    if ( 縦スケール = 0 ) { 図Y_SCALE = 図Y_SCALE * 1.2
                }
            } else {
                X9_Hosei = 0
                Y9_Hosei = 0
            //        if ( YY_Hosei = 0 $$ YY_Hosei != 0 ) {
                    if ( sYscale != 1 $$ (XX_Hosei + YY_Hosei != 0) ) { //////09/11/30
                        if ( 荷重図フォーマット.intレイアウト = 2 ) {
                            XX_Hosei = XX_Hosei / 2
                            YY_Hosei = YY_Hosei / 2
                        } else {
                            XX_Hosei = 0
                            YY_Hosei = 0
                        }
                    }
                    if ( iKozo = 1 $$ YY_Hosei = 0 $$ CASN >= 0 $$ NKUI = 0 ) { //////And 図Y_SCALE > 0.002 ) { //////12/12/12
                        if ( sYscale = 1 ) {
                            if ( 荷重図フォーマット.int用紙方向 = 1 ) { ////////横
                                if ( 荷重図フォーマット.int用紙サイズ = 1 ) { ////////A3
                                    Y9_Hosei = 30
                                } else {
                                    Y9_Hosei = -20 //////14/12/15
                                }
                            } else {
                                if ( 荷重図フォーマット.int用紙サイズ = 1 ) { ////////A3
                                    Y9_Hosei = 40
                                } else {
                                    Y9_Hosei = 20
                                }
                            }
                        } else {if ( sYscale = 2 ) {
                            if ( 荷重図フォーマット.int用紙方向 = 1 ) { ////////横
                                if ( 荷重図フォーマット.int用紙サイズ = 1 ) { ////////A3
                                    Y9_Hosei = 30
                                } else {
                                    Y9_Hosei = -20 //////14/12/15
                                }
                            } else {
                                if ( 荷重図フォーマット.int用紙サイズ = 1 ) { ////////A3
                                    Y9_Hosei = 30
                                } else {
                                    Y9_Hosei = 15
                                }
                            }
                        }
                    }
                    if ( 元iKozo = 3 $$ g連続Mod = False ) {
                        if ( iKozo = 1 $$ sYscale = 1 $$ YY_Hosei = 0 $$ CASN >= 0 $$ NKUI = 0 $$ 図Y_SCALE > 0.002 ) { //////12/12/12
                            Y9_Hosei = 20
                        } else {if ( CASN >= 0 ) {
            //                                    荷重図フォーマット.intレイアウト = 2 $$ 荷重図フォーマット.int用紙方向 = 0 ) {
                            X9_Hosei = -5
                            Y9_Hosei = -23
                            if ( 荷重図フォーマット.int用紙サイズ = 1 ) { ////////A3
                                図X_SCALE = 図X_SCALE * 1.2
                                図Y_SCALE = 図Y_SCALE * 1.2
                                X9_Hosei = 15
                                if ( sYscale = 1 || Not (sYscale = 2 || sYscale = 3) ) {
                                    Y9_Hosei = 0
                                } else {
                                    if ( 荷重図フォーマット.intレイアウト = 2 ) {
                                        Y9_Hosei = -30
                                    }
                                }
                                if ( 荷重図フォーマット.int用紙方向 = 1 ) { ////////横
                                    X9_Hosei = 15
                                    Y9_Hosei = -15
                                    if ( sYscale = 3 ) {
                                        Y9_Hosei = 25
                                    }
                                }
            //                    }
                            } else {if ( (sYscale = 2 || sYscale = 3) ) {
                                if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                                    図Y_SCALE = 図Y_SCALE * 1.3
                                    Y9_Hosei = -15
                                } else {if ( 荷重図フォーマット.int用紙方向 = 0 ) { //////14/08/14
            //                            if ( ((JY_max - JY_min) / 図Y_SCALE / Twip) > 図縦幅 / 1.7 ) { //////LLX
                                    if ( ((JX_max - JX_min) / 図X_SCALE / Twip) > 図横幅 * 0.8 ) { //////LLX
                                        図X_SCALE = 図X_SCALE * 1.4
                                        図Y_SCALE = 図Y_SCALE * 1.4
                                        X9_Hosei = 15
                                    } else {
                                        X9_Hosei = 0
                                    }
                                }
                            } else {if ( sYscale = 1 ) {
                                X9_Hosei = 0
                                Y9_Hosei = -20
                            } else { //////////////////////////////////////////////////4,5,6段
                                Y9_Hosei = 0
                            }
                        } else {if ( CASN >= 0 $$ sYscale = 1 ) {
                            X9_Hosei = -5
                            Y9_Hosei = -23
                        }
                    } else {
                        if ( 荷重図フォーマット.int用紙方向 = 0 ) { //////14/08/14
                            if ( iKozo = 1 $$ NKUI = 0 $$ ((JY_max - JY_min) / 図Y_SCALE / Twip) > 図縦幅 / 1.5 ) {  //////LLX
                                図X_SCALE = 図X_SCALE * 1.06 //////1.3
                                図Y_SCALE = 図Y_SCALE * 1.1
                                X9_Hosei = 5
                            }
                        } else {if ( CASN >= 0 $$ 荷重図フォーマット.intレイアウト = 2 $$ 荷重図フォーマット.int用紙方向 = 1 ) {
                            if ( sYscale = 1 ) {
                                Y9_Hosei = 5 //////15
                            } else {
                                Y9_Hosei = 0 //////15
                            }
                        }
                    }
                    if ( X9_Hosei = 0 $$ 荷重図フォーマット.int用紙方向 = 1 $$ 荷重図フォーマット.int用紙サイズ = 0 ) { //////A4横
                        X9_Hosei = 7 //////14/12/15
                    }
                    XX_Hosei = X9_Hosei
                    YY_Hosei = Y9_Hosei
            //        if ( CASN >= 0 $$ g連続Mod = True ) {
            //            YY_Hosei = 5
            //            if ( 荷重図フォーマット.int用紙方向 = 1 $$ 荷重図フォーマット.int用紙サイズ = 0 $$ sYscale = 1 ) {
            //                図_Y0 = 8500
            //            }
            //        }

                if ( 荷重図フォーマット.sng荷重位置補正X != csngNull ) {
                    XX_Hosei = XX_Hosei + 荷重図フォーマット.sng荷重位置補正X
                }
                if ( 荷重図フォーマット.sng荷重位置補正Y != csngNull ) {
            //            YY_Hosei = -荷重図フォーマット.sng荷重位置補正Y
                    if ( 荷重図フォーマット.intレイアウト > 2 ) {
                        YY_Hosei = XX_Hosei - 荷重図フォーマット.sng荷重位置補正Y / 2
                    } else {
                        YY_Hosei = YY_Hosei - 荷重図フォーマット.sng荷重位置補正Y / sNN
                    }
                }
                ////
                if ( 荷重図フォーマット.int用紙サイズ = 1 $$ sYscale != 1 ) {
            //            UU_Hosei = UU_Hosei - 2000
                }
            }
            if ( 元iKozo = 3 $$ 荷重図フォーマット.int用紙方向 = 1 ) { //////13/04/08
                if ( XX_Hosei = 0 $$ sYscale != 1 $$ g連続Mod = False ) {
                    if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                        XX_Hosei = XX_Hosei + 20
                    } else {
                        XX_Hosei = XX_Hosei + 30
                    }
                }
            }
            ////////////////////////14/12/20
            if ( 荷重図フォーマット.int用紙サイズ = 1 $$ 荷重図フォーマット.int用紙方向 = 0 ) {
                XX_Hosei = XX_Hosei + 5
            }
            //////////////////////////////////門型 柱下端 固定
            if ( CASN >= 0 $$ iKozo = 1 $$ 水平部材最上端 = 水平部材最下端 $$ YU_max = YY_min ) {
                YY_Hosei = YY_Hosei - 35
            } else {if ( CASN >= 0 $$ iKozo = 1 $$ YY_Hosei = 0 $$ NKUI = 0 $$ 水平部材最上端 = 水平部材最下端 $$ YY_max != YY_min ) {
                if ( 荷重図フォーマット.intレイアウト = 1 ) { //////14/06/29
                    YY_Hosei = 15
                } else {if ( 荷重図フォーマット.intレイアウト = 2 ) {
                    YY_Hosei = 8
                }
            }
            //    if ( YY_Hosei = 0 $$ iKozo = 3 $$ g連続Mod = False $$ CASN >= 0 $$ (sYscale = 2 || sYscale = 3) $$ 荷重図フォーマット.intレイアウト = 2 ) { ////////14/01/09
            //        YY_Hosei = -40
            //    }
            //
                    図_X0 = SSX + XX_Hosei * Twip + 横補正 + w背割れ横補正
                    if ( FLG_Ugata $$ iKozo = 1 ) {
                        if ( 荷重図フォーマット.int用紙方向 = 0 $$ sYscale = 1 ) {
                            UU_Hosei = UU_Hosei - 2500
                        } else {
                            UU_Hosei = UU_Hosei - 800
                        }
                    }
                    図_Y0 = (図_Y0 + ABC) + YY_Hosei * Twip + UU_Hosei
            //////14/03/26
                    if ( XXYY(2) > 15 $$ (XXYY(1) - XXYY(2)) > 50 $$ g連続Mod ) { ////////JX_min < 0 + XXYY(2) + XXYY(1) ) {
                        if ( 荷重図フォーマット.int用紙方向 = 0 ) {
            //                    図_X0 = 図_X0 - (XXYY(2) / 図X_SCALE * 100 / 7 / Twip)
                            if ( 荷重図フォーマット.int用紙サイズ = 1 $$ CASN >= 0 ) {
                            図_X0 = 図_X0 - (XXYY(2) / 図X_SCALE * 100 / 3 / Twip)
                            } else {
                            図_X0 = 図_X0 - (XXYY(2) / 図X_SCALE * 100 / 7 / Twip)
                            }
                        } else { ////////横
                            if ( CASN < 0 ) {
                                if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                                    図_X0 = 図_X0 - (XXYY(2) / 図X_SCALE * 100 / 6 / Twip)
                                } else {
                                    図_X0 = 図_X0 - (XXYY(2) / 図X_SCALE * 100 / 3 / Twip)
                                }
                            } else {
                                if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                                    図_X0 = 図_X0 - (XXYY(2) / 図X_SCALE * 100 / 12 / Twip)
                                } else {
                                    図_X0 = 図_X0 - (XXYY(2) / 図X_SCALE * 100 / 10 / Twip)
                                }
                            }
                        }
                    } else {if ( CASN < 0 $$ iKozo = 1 $$ YY_Hosei = 0 $$ 荷重図フォーマット.int用紙方向 = 0 _
                            $$ 荷重図フォーマット.int用紙サイズ = 0 $$ 水平部材最上端 = 水平部材最下端 _
                            $$ 水平部材最上端 > 0 ) { //////A4横 17/08/07
                        図_Y0 = 図_Y0 / 1.5
                    }
            //            if ( CASN < 0 $$ iKozo = 2 $$ YY_Hosei = 0 $$ 荷重図フォーマット.int用紙方向 = 0 $$ 荷重図フォーマット.int用紙サイズ = 0 ) { //////A4横
            //                図_Y0 = 6000 ////// 図_Y0 - 1000 - IIf(JY_max > 7, (JY_max - 7) * 800, 0)
            //            }
            //////14/03/26
                    //枠 ------------------------------------------------------
                    this.OUT_枠(i, bTitle, jEnd)
            //            //節点番号 ------------------------------------------------------
            //            this.OUT_節点番号(CASN, I)
                    //部材 ------------------------------------------------------
                    .PenStyle = 0
            //            this.OUT_部材(CASN, i) //////////////////////////////04/07/20
            //            this.支点Mark(CInt(I))
                    //節点 ------------------------------------------------------
                    .PenWidth = 0
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(.PenWidth))
                    }
                    Pen色 = QBColor(9)  //明るい青
                    .PenColor = Pen色
                    .PenStyle = psSolid
                    this.OUT_節点(CASN)
            var Dummy(1) As Single
                    if ( i >= 0 ) {
                        //荷重図 ------------------------------------------------------
                        .BrushStyle = 1     //透明
                        .PenStyle = psSolid
                        j = 実荷重NO(i)
                        if ( g背割れ = SRT5 ) { ////////12/11/22
                        this.BU荷重CALC(j)
                        }
            var FlgCASU As Integer
            FlgCASU = 1
                        this.READ_K_Jitubuzai(j, Dummy(), , FlgCASU) //////14/05/21
            if ( FlgCASU = 0 ) { GoTo GRF444
                        荷重座標Y = 荷重座標Y初期値 * Twip
                        if ( i > 0 $$ SI > 0 $$ Ei > 0 ) {
                            if ( UCase(Mid(F7ML3(i), 1, 2)) = "AT" $$ M杭mod ) {    // 応答変位ならば・・・
            //                        if ( NKUI <= 1 ) {    //////////////////////////////////07/05/01
            //                            MaxOuTouLen2 = MaxKuiOuTou
            //                        } else {
            //                            this.mn変位縮尺(KAISHI, OuTouBai, KuiToKui)
            //
            //                            MaxOuTouLen2 = KuiToKui
            //                        } ////////////////////////////////////////////////////////////////////////////////////////////////////07/05/01
                                this.mn変位縮尺(KAISHI, OuTouBai, KuiToKui) //////08/08/31

                                if ( KuiToKui = 0 ) {
                                    MaxOuTouLen2 = MaxKuiOuTou / 2
                                } else {
                                    MaxOuTouLen2 = KuiToKui
                                }
                                //////////////////////////////////////////////////////////////////////////////////////////////08/08/31
                                OuTouAtta = 1
                                    if ( Len(F7ML3(i)) = 2 ) {
                                        OuTouHHH = 1
                                    } else {
                                        OuTouHHH = Mid(F7ML3(i), 3, Len(F7ML3(i))) ////////08/08/31
                                    }
            //                            if ( G1_AA5(1, 2) < 0 || G1_AA2(1, 2) <= 0 ) {//////08/12/03 コメントにした
            //                                OuTouHHH = 1 //////////08/09/03
            //                            } else {
            //                                if ( OuTouHHH = 1 ) {
            //                                    if ( G1_AA2(1, 1) > G1_AA2(1, 2) ) { OuTouHHH = 2 //////////08/09/25
            //                                    GoTo AAA
            //                                }
            //                                if ( OuTouHHH = 2 ) {
            //                                    if ( G1_AA2(1, 1) > G1_AA2(1, 2) ) { OuTouHHH = 1 //////////08/09/25
            //                                }
            //AAA:
            //                            }
                                if ( gouikidddd = 1 $$ AttaG = 1 ) {
                                    this.Out_OuTou_G(i)
                                } else {
                                    this.Out_OuTou_N(i)
                                }
                            }
                        }
                    }
                    this.OUT_部材(CASN, i, sYscale) //////////////////////////////04/07/20
                    //
                    //節点番号 ------------------------------------------------------
                    this.OUT_節点番号(CASN, i)

                    if ( i >= 0 ) {
            //                if ( i != Ei $$ NKUI > 0 $$ UCase(Mid(F7ML3(i), 1, 2)) = "AT" $$ M杭mod $$ Jw != 1 ) { ////////08/06/244
                        if ( YATTA = 1 ) { //////08/11/11
                            this.EEE2(y部材名()) //////////////////////////05/05/23 杭先端の座標を元に戻す08/08/199
                            DDNum = 0 ////////08/07/06
                        }
                    }
                }w ////////////////////////////08/06/24
                    i = jEnd
                }
                if ( g背割れ > 0 ) { //////////////08/08/199
                    g背割れ = 1
                    For( M = 1 To 部材_max
                        部材名(M) = y部材名(M)
                    Next M
                }
                sYscale = 1 //////////08/08/31
                //
                if ( OuTouAtta = 1 ) {   // 応答変位があった場合、各杭の応答変位の図を表示する
                    For( i = SI To Ei
                        if ( UCase(Mid(F7ML3(i), 1, 2)) = "AT" $$ M杭mod ) {    // 応答変位ならば・・・
                            if ( Len(F7ML3(i)) = 2 ) {
                                OuTouHHH = 1
                            } else {
                                OuTouHHH = Mid(F7ML3(i), 3, Len(F7ML3(i)))
                            }
            //                    if ( G1_AA5(1, 2) < 0 || G1_AA2(1, 2) <= 0 ) {//////08/12/03 コメントにした
            //                        OuTouHHH = 1 //////////08/09/03
            //                    } else {
            //                        if ( OuTouHHH = 1 ) {
            //                            if ( G1_AA2(1, 1) > G1_AA2(1, 2) ) { OuTouHHH = 2 //////////08/09/25
            //                            GoTo BBB
            //                        }
            //                        if ( OuTouHHH = 2 ) {
            //                            if ( G1_AA2(1, 1) > G1_AA2(1, 2) ) { OuTouHHH = 1 //////////08/09/25
            //                        }
            //BBB:
            //                    }
                            if ( gouikidddd = 1 $$ AttaG = 1 ) {
                                this.Out_OuTouHeniZu_G(i, bTitle)
                            } else {
                                this.Out_OuTouHeniZu_N(i, bTitle)
                            }
                        }
                    }
                }
                .MarginRight = OldMarginRight
                .MarginBottom = OldMarginBottom
            End With
            GRF444:
            部材荷重長さmax = KW
            集中荷重長さmax = Ks
            部材M荷重長さmax = KM
            /*/
        }

        //private void B作図開始(CASN As Integer, bTitle As Boolean)
        //
        //}

        /* private void mn変位縮尺(KAISHI, OuTouBai, KuiToKui) //////////07/05/01
        var i As Integer, j As Integer, ASAS As Integer
        double var LenLen
        double var KUIB1()
        double var HHX1 As Double, IIX1
        LenLen = 9000000000#
                this.KUIB1(部材_max)
                KAISHI = 0
                For( j = 1 To 部材_max
                    if ( (InStr(部材名(j), "杭") = 1 || InStr(部材名(j), "側壁") != 0) $$ M杭mod ) {
                        KAISHI = KAISHI + 1
                        KUIB1(KAISHI) = j
                    }
                }

                    For( i = 1 To KAISHI
                        For( ASAS = 1 To KAISHI
                            if ( i = ASAS ) {
                            } else {
                                HHX1 = KuiBuzaiX(1, KUIB1(i))
        //                            HHX2 = KuiBuzaiX(2, KUIB1(I))
        //                            HHY1 = KuiBuzaiX(1, KUIB1(I))
        //                            HHY2 = KuiBuzaiX(2, KUIB1(I))
                                IIX1 = KuiBuzaiX(1, KUIB1(ASAS))
        //                            IIX2 = KuiBuzaiX(2, KUIB1(ASAS))
        //                            IIY1 = KuiBuzaiX(1, KUIB1(ASAS))
        //                            IIY2 = KuiBuzaiX(2, KUIB1(ASAS))
                                if ( HHX1 >= IIX1 ) {
                                } else {
                                    LenLen = SMin(LenLen, (IIX1 - HHX1) / OuTouBai * 0.77 * 0.5)
                                }
                            }
                        Next ASAS
                    }
                    if ( LenLen > MaxKuiOuTou / OuTouBai ) {
                        KuiToKui = 0
                    } else {
                        KuiToKui = LenLen * OuTouBai
                    }
        }
                    */

        private void OUT_枠(int 描画荷重case, bool bTitle, int EndCase = 0)
        {
            /*/
            var X00
            var Y00
            var X01
            var Y01
            var X10
            var Y10
            var X11
            var Y11
            var X20
            var Y20
            var X21
            var Y21
            var ParamAngle              As Single
            var ParamFontSize           As Single
            var ParamXPoint             As Single
            var ParamYpoint             As Single
            var ParamText
            var QWX1                    As Single
            var QWY1                    As Single
            var strCaseName As String
            if ( g背割れ = 2 ) { return; //////////////////////////////////08/06/24
            //
            var strNAMA1 As String, strNAMA2 As String

            if ( 描画荷重case >= 0 ) {
                strNAMA1 = 英語名(荷重名称(描画荷重case))
                strNAMA2 = 英語名(荷重名称(EndCase))
                if ( FLG車両ZU = False ) {
                    if ( EndCase = 0 || 描画荷重case = EndCase || (str(描画荷重case) = str(EndCase) $$ 荷重記号(描画荷重case) = 荷重記号(EndCase)) ) {
                        strCaseName = " Ｃase" & str(描画荷重case) & "  " & strNAMA1 & "　" & 荷重記号(描画荷重case)
                    } else {
                        if ( strNAMA1 = strNAMA2 ) {
                        strCaseName = " Ｃase" & str(描画荷重case) & " ～" & str(EndCase) & "  " & strNAMA1 & "  " & 荷重記号(描画荷重case) & "～" & 荷重記号(EndCase)
                        } else {
                        strCaseName = " Ｃase" & str(描画荷重case) & " ～" & str(EndCase) & "  " & strNAMA1 & "～" & strNAMA2 & "  " & 荷重記号(描画荷重case) & "～" & 荷重記号(EndCase)
                        }
                    }
                } else {
                    strCaseName = "  <" & Format(Total車両図Case) & "> Ｃase " & str車両KKK(0) & "  " & 英語名(str車両CASE名(描画荷重case))
                }
            }
            X00 = 左開き * Twip
            Y00 = 上開き * Twip
            X01 = X00 + 枠横幅 * Twip
            Y01 = Y00
            X10 = X00
            Y10 = Y00 + 10 * Twip
            X11 = X01
            Y11 = Y10
            X20 = X00
            Y20 = Y00 + 枠縦幅 * Twip
            X21 = X01
            Y21 = Y20
            With frmPrint.vsPrt1
            //        if ( sYscale != 3 ) {
                if ( gbolZuWaku ) { //////////////////////////////09/11/02 // 外枠作成
            //            if ( 荷重図フォーマット.int作図指定(0) = 0 ) {
                        .PenWidth = 枠Pen幅
                        if ( CreateDxfFlag = 1 ) {
                            this.PLOTPEN(CSng(.PenWidth))
                        }
                        .PenColor = QBColor(枠Pen色)
                        DrawLinePrt frmPrint.vsPrt1, X00, Y00, X01, Y01
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(X00), CSng(Y00), CSng(X01), CSng(Y01))
                        }
                        if ( sYscale = 1 $$ 描画荷重case > 0 ) { //////09/11/04
                            .PenWidth = 枠Pen幅 / 2
                            if ( CreateDxfFlag = 1 ) {
                                this.PLOTPEN(CSng(.PenWidth))
                            }
            //                    if ( 描画荷重case = 1 ) { //////////09/11/04  13/04/07
            //                    DrawLinePrt frmPrint.vsPrt1, X10, Y10 + 100, X11, Y11 + 100
            //                    } else {
                            DrawLinePrt frmPrint.vsPrt1, X10, Y10, X11, Y11
            //                    }
                            if ( CreateDxfFlag = 1 ) {
                                this.LINEOUT(CSng(X10), CSng(Y10), CSng(X11), CSng(Y11))
                            }
                            .PenWidth = 枠Pen幅
                            if ( CreateDxfFlag = 1 ) {
                                this.PLOTPEN(CSng(.PenWidth))
                            }
                        }
                        DrawLinePrt frmPrint.vsPrt1, X20, Y20, X21, Y21
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(X20), CSng(Y20), CSng(X21), CSng(Y21))
                        }
                        DrawLinePrt frmPrint.vsPrt1, X00, Y00, X20, Y20
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(X00), CSng(Y00), CSng(X20), CSng(Y20))
                        }
                        DrawLinePrt frmPrint.vsPrt1, X01, Y01, X21, Y21
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(X01), CSng(Y01), CSng(X21), CSng(Y21))
                        }
                        if ( 荷重図フォーマット.int用紙方向 != 1 ) {
                            .TextAngle = 0
                            .FontSize = 8
                            MyCurrentX = X00 + (枠横幅 - 22) * Twip
                            MyCurrentY = Y00 - 4 * Twip
                            QWX1 = MyCurrentX
                            QWY1 = MyCurrentY
                            PrintoutPrt frmPrint.vsPrt1, "PAGE"
                            if ( CreateDxfFlag = 1 ) {
                                ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                                ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                                ParamXPoint = QWX1
                                ParamYpoint = QWY1
                                ParamText = "PAGE"
                                this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                            }
                            .PenWidth = 0
                            if ( CreateDxfFlag = 1 ) {
                                this.PLOTPEN(CSng(.PenWidth))
                            }
                            DrawLinePrt frmPrint.vsPrt1, X00 + (枠横幅 - 22 + 8) * Twip, Y00 - 1.5 * Twip, X00 + 枠横幅 * Twip, Y00 - 1.5 * Twip
                            if ( CreateDxfFlag = 1 ) {
                                this.LINEOUT(X00 + (枠横幅 - 22 + 8) * Twip, Y00 - 1.5 * Twip, X00 + 枠横幅 * Twip, Y00 - 1.5 * Twip)
                            }
                        }
            //            }
                }
                if ( bTitle ) {
                    .TextAngle = 0
                    .FontSize = 10
                    MyCurrentX = X00 + 5 * Twip
                    if ( NoKaikin = 1 ) {
            //                if ( sYscale != 3 ) {
            //                    MyCurrentY = Y00 + 4 * Twip
            //                } else {
            //                    if ( 荷重図フォーマット.int用紙方向 = 1 ) {
            //                        MyCurrentY = Y00 + 30 * Twip + 図縦幅 * Twip / 1.9 //2 ////1.5
            //                    } else {
            //                        MyCurrentY = Y00 + 28 * Twip + 図縦幅 * Twip / 1.55 //2 ////1.5
            //                    }
            //                }
                    } else {
                        if ( sYscale = 1 || sYscale = 2 || sYscale = 4 || sYscale = 7 ) {
                            MyCurrentY = Y00 + 4 * Twip
                        } else {
                            Select Case sYscale
            //////////////２段書き
                            Case 3
                                if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                                   if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                                   MyCurrentY = Y00 + 30 * Twip + 図縦幅 * Twip / 1.8 // A4
                                   } else {
                                   MyCurrentY = Y00 + 30 * Twip + 図縦幅 * Twip / 1.55 //A3
                                   }
                                } else {
                                   MyCurrentY = Y00 + 28 * Twip + 図縦幅 * Twip / 1.55 //2 ////1.5
                                }
            //////////////３段書き
                            Case 5      // 荷重図を３段書きする場合の２番目の位置
                                if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                                   if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                                   MyCurrentY = Y00 + 30 * Twip + 図縦幅 * Twip / 1.9 * 0.5
                                   } else {
                                   MyCurrentY = Y00 + 30 * Twip + 図縦幅 * Twip / 1.9 * 0.7
                                   }
                                } else {
                                   if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                                   MyCurrentY = Y00 + 28 * Twip + 図縦幅 * Twip / 1.55 * 0.6
                                   } else {
                                   MyCurrentY = Y00 + 28 * Twip + 図縦幅 * Twip / 1.55 * 0.6
                                   }
                                }
                            Case 6      // 荷重図を３段書きする場合の３番目の位置
                                if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                                   if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                                   MyCurrentY = Y00 + 30 * Twip + 図縦幅 * Twip / 1.9 * 1.4 * 1.05
                                   } else {
                                   MyCurrentY = Y00 + 30 * Twip + 図縦幅 * Twip / 1.9 * 1.4 * 1.2
                                   }
                                } else {
                                   if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                                   MyCurrentY = Y00 + 28 * Twip + 図縦幅 * Twip / 1.55 * 1.4 * 1.02
                                   } else {
                                   MyCurrentY = Y00 + 28 * Twip + 図縦幅 * Twip / 1.55 * 1.4 * 0.98
                                   }
                                }
            //////////////４段書き
                            Case 8      // 荷重図を４段書きする場合の２番目の位置
                                if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                                    if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                                    MyCurrentY = Y00 + 30 * Twip + 図縦幅 * Twip / 1.9 * 0.3
                                    } else {
                                    MyCurrentY = Y00 + 30 * Twip + 図縦幅 * Twip / 1.9 * 0.43
                                    }
                                } else {
                                    if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                                    MyCurrentY = Y00 + 28 * Twip + 図縦幅 * Twip / 1.55 * 0.4
                                    } else {
                                    MyCurrentY = Y00 + 28 * Twip + 図縦幅 * Twip / 1.55 * 0.42
                                    }
                                }
                            Case 9      // 荷重図を４段書きする場合の３番目の位置
                                if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                                    if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                                    MyCurrentY = Y00 + 30 * Twip + 図縦幅 * Twip / 1.9 * 1.05
                                    } else {
                                    MyCurrentY = Y00 + 30 * Twip + 図縦幅 * Twip / 1.9 * 1.15
                                    }
                                } else {
                                    if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                                    MyCurrentY = Y00 + 28 * Twip + 図縦幅 * Twip / 1.55
                                    } else {
                                    MyCurrentY = Y00 + 28 * Twip + 図縦幅 * Twip / 1.55 * 0.98
                                    }
                                }
                            Case 10     // 荷重図を４段書きする場合の４番目の位置
                                if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                                    if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                                    MyCurrentY = Y00 + 30 * Twip + 図縦幅 * Twip / 1.9 * 1.6 * 1.1
                                    } else {
                                    MyCurrentY = Y00 + 30 * Twip + 図縦幅 * Twip / 1.9 * 1.6 * 1.18
                                    }
                                } else {
                                    if ( 荷重図フォーマット.int用紙サイズ = 0 ) {
                                    MyCurrentY = Y00 + 28 * Twip + 図縦幅 * Twip / 1.55 * 1.6
                                    } else {
                                    MyCurrentY = Y00 + 28 * Twip + 図縦幅 * Twip / 1.55 * 1.54
                                    }
                                }
                            Case } else {
                            End Select
                        }
                    }
                    Select Case 描画荷重case
                    Case Is > 0
                        if ( RR橋脚 = 2 $$ IIf(FLG車両ZU, Total車両図Case = 1, 描画荷重case = 1) ) {
                            if ( 荷重図フォーマット.int作図指定(0) != 0 ) {
                                MyCurrentY = MyCurrentY + 3 * Twip //枠線なし
                            }
                            QWX1 = MyCurrentX
                            QWY1 = MyCurrentY
                            PrintoutPrt frmPrint.vsPrt1, strCaseName // & strNAMA1 & " " & 荷重記号(描画荷重case)
                            if ( CreateDxfFlag = 1 ) {
                                ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                                ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                                ParamXPoint = QWX1
                                ParamYpoint = QWY1
                                ParamText = IIf(荷重図フォーマット.int作図指定(0) = 0, "", "　　　　　　") & strCaseName // & strNAMA1 & " " & 荷重記号(描画荷重case)
                                this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                            }
                            .FontSize = 10.5
                            MyCurrentX = X00 + 2 * Twip
                            if ( 荷重図フォーマット.int作図指定(0) = 0 ) {
                                MyCurrentY = MyCurrentY - 8.5 * Twip   //枠線あり
                            } else {
                                MyCurrentY = MyCurrentY - 6 * Twip //枠線なし
                            }
                            QWX1 = MyCurrentX
                            QWY1 = MyCurrentY
                            PrintoutPrt frmPrint.vsPrt1, 英語名("  ３. 荷 重 図")
                            if ( CreateDxfFlag = 1 ) {
                                ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                                ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                                ParamXPoint = QWX1
                                ParamYpoint = QWY1
                                ParamText = 英語名("  ３. 荷 重 図")
                                this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                            }
                            .FontSize = 10
                        } else {
                            if ( 荷重図フォーマット.int作図指定(0) != 0 $$ IIf(FLG車両ZU, Total車両図Case = 1, 描画荷重case = 1) ) {
                                MyCurrentY = MyCurrentY + 3 * Twip //枠線なし
                            }
                            QWX1 = MyCurrentX
                            QWY1 = MyCurrentY
                            PrintoutPrt frmPrint.vsPrt1, strCaseName
                            if ( CreateDxfFlag = 1 ) {
                                ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                                ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                                ParamXPoint = QWX1
                                ParamYpoint = QWY1
                                ParamText = IIf(荷重図フォーマット.int作図指定(0) = 0, "", "　　　　　　") & strCaseName
                                this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                            }
                        }
                        if ( RR橋脚 = 1 $$ 描画荷重case = 1 $$ IIf(FLG車両ZU, Total車両図Case = 1, True) ) {
                            .FontSize = 11
                            MyCurrentX = X00 + 2 * Twip
                            if ( 荷重図フォーマット.int作図指定(0) = 0 ) {
                                MyCurrentY = MyCurrentY - 8.5 * Twip   //枠線あり
                            } else {
                                MyCurrentY = MyCurrentY - 5 * Twip //枠線なし
                            }
                            QWX1 = MyCurrentX
                            QWY1 = MyCurrentY
                            PrintoutPrt frmPrint.vsPrt1, IIf(FLG車両ZU = False, 英語名(" 荷 重 図"), 英語名(" 車両載荷状態図"))
                            if ( CreateDxfFlag = 1 ) {
                                ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                                ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                                ParamXPoint = QWX1
                                ParamYpoint = QWY1
                                ParamText = IIf(FLG車両ZU = False, 英語名(" 荷 重 図"), 英語名(" 車両載荷状態図"))
                                this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                            }
                            .FontSize = 10
                        }
                    Case -1 ////////////////////////////////////////////////////// 骨 組 図
                        .FontSize = 10
                        MyCurrentX = X00 + 10 * Twip
                        MyCurrentY = MyCurrentY + 8.5 * Twip
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, 英語名("    軸 線 図")
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = 英語名("    軸 線 図")
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                    Case } else {
                    End Select
                }
            End With
            /*/
        }

        private void OUT_節点(int CASN)
        {
            /*///////////////////////////////////////////////////////////////////////////////////////////////////////////// 部材点の出力　ポッチ
            var i                       As Integer
            var EnPRM1                  As Single
            var EnPRM2                  As Single
            var EnPRM3                  As Single
            var EnPRM4                  As Single
            var EnPRM5                  As Single
            var EnTYPE1                 As Single
            //
            //    if ( g連続Mod ) { return; //////////////////////////////////////////////////////// 05/02/16
            frmPrint.vsPrt1.PenWidth = 部材Pen幅 / 1.5
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            frmPrint.vsPrt1.PenColor = QBColor(節点Pen色)
            if ( FR橋脚 = 2 $$ NKUI = 0 $$ CASN = 0 $$ Foot_Flg = 0 ) {
                Jn_max = 2
            }
            For( i = 1 To Jn_max
                if ( JJM(i) != 0 $$ JJM(i) != 9 $$ wRR(i) > 0 ) { //////////////08/08/18 $$ wRR(i) > 0
                if ( NoUseSettenNumberPrint = 1 ) {
                    DrawCirclePrt frmPrint.vsPrt1, HEN_X(節X(i)), HEN_Y(節Y(i)), 20 //15
                    if ( CreateDxfFlag = 1 ) {
                        EnPRM1 = CSng(HEN_X(節X(i)))
                        EnPRM2 = CSng(HEN_Y(節Y(i)))
                        EnPRM3 = 0
                        EnPRM4 = 360
                        EnPRM5 = 20
                        EnTYPE1 = 7
                        this.PLOTCIRCLE_Nuritsubushi(EnPRM1, EnPRM2, EnPRM3, EnPRM4, EnPRM5, EnTYPE1)
                    }
                } else {
                    if ( UseSettenNumber(i) = 1 || (CASN < 0 $$ UseSettenNumber(i) > 0.1) || (CASN = 0 $$ UseSettenNumber(i) >= 0.5) ) {
                        DrawCirclePrt frmPrint.vsPrt1, HEN_X(節X(i)), HEN_Y(節Y(i)), 20 //15
                        if ( CreateDxfFlag = 1 ) {
                            EnPRM1 = CSng(HEN_X(節X(i)))
                            EnPRM2 = CSng(HEN_Y(節Y(i)))
                            EnPRM3 = 0
                            EnPRM4 = 360
                            EnPRM5 = 20
                            EnTYPE1 = 7
                            this.PLOTCIRCLE_Nuritsubushi(EnPRM1, EnPRM2, EnPRM3, EnPRM4, EnPRM5, EnTYPE1)
                        }
                    }
                }
                }
            }
            /*/
        }

        private void OUT_節点番号(int CASN, int iCA)
        {
            /*/
            var ParamAngle              As Single
            var ParamFontSize           As Single
            var ParamXPoint             As Single
            var ParamYpoint             As Single
            var ParamText
            var QWX1                    As Single
            var QWY1                    As Single
            double var TX()
            double var TY()
            double var TZ()
            var i                       As Integer
            var j                       As Integer
            var M                       As Integer
            var k                       As Integer
            var MSUU As Single
            var X1
            var y1
            var X2
            var Y2
            var LL As Single
            var XX8 As Single, XX9 As Single, yy9 As Single, LL9 As Single
            var MMM() As Integer
            var USEJ() As Integer
            var 水平部材Y_MIN As Single ////////08/07/11
            //
            水平部材Y_MIN = 99999
            //     gbolSeten = chk作図(1)         //荷重図の節点番号の作図 ////// 05/04/01
            //     gbolBuZai = chk作図(2)         //荷重図の部材番号の作図
            //
            if ( (CASN >= 0 $$ gbolSeten = 1) ) { return; ////////////////05/02/07
                this.TX(Jn_max)
                this.TY(Jn_max)
                this.TZ(Jn_max)
                this.MMM(Jn_max)
                this.USEJ(Jn_max)
                this.SET_ShiTenData(1, TX(), TY(), TZ())
            For( i = 1 To Jn_max
                MMM(i) = 0
                USEJ(i) = 0
            }
            With frmPrint.vsPrt1
                .FontSize = 節点番号Fontsize
            //        if ( CASN < 0 ) {
            //            .FontSize = .FontSize * 0.9 //////14/11/177
            //        } else {
            //            .FontSize = .FontSize * 0.8 //////14/11/177
            //        }
                .TextAngle = 0
                if ( FR橋脚 = 2 $$ NKUI = 0 $$ CASN = 0 $$ Foot_Flg = 0 ) {
                    Jn_max = 2
                }
            For( k = 1 To 2 //////////////////////////////////先に水平部材 k=1
                XX8 = -99999
                XX9 = 99999: yy9 = 99999
                For( M = 1 To 部材_max
                    X1 = HEN_X(節X(部I(M)))
                    y1 = HEN_Y(節Y(部I(M)))
                    X2 = HEN_X(節X(部J(M)))
                    Y2 = HEN_Y(節Y(部J(M)))
                    LL = Sqr((X1 - X2) ^ 2 + (y1 - Y2) ^ 2) / (図X_SCALE * Twip * 10) ////////////17/07/31  / (図X_SCALE * Twip * 10)
                    LL9 = Sqr((X1 - XX9) ^ 2 + (y1 - yy9) ^ 2) / (図X_SCALE * Twip * 10)
            //            if ( LL < 30 ) {
            //                XX9 = X2: YY9 = Y2
            //            } else {
            //                XX9 = X1: YY9 = y1
            //            }
                if ( k = 1 $$ X1 = X2 ) {
                    GoTo AA6
                }
                if ( k = 1 $$ X1 != X2 ) { ////////08/07/11
                    水平部材Y_MIN = min(水平部材Y_MIN, 節Y(部I(M)))
                    水平部材Y_MIN = min(水平部材Y_MIN, 節Y(部J(M)))
                }
            //    JJM(i) = 2 //////// 接続部材が１
            //    JJM(i) = 9 //////// 端点
                For( j = 1 To 2
                    if ( j = 1 ) {
            //                if ( M != 1 $$ (iKozo = 3 $$ g連続Mod) $$ (JX_max = JX_min) ) {
            //                } else {
                        i = 部I(M)
                        if ( MMM(i) != 0 || JJM(i) = 0 ) {
                            GoTo AA5
                        }
                        MMM(i) = i
            //                }
                    } else {
                        if ( (M != 部材_max $$ (iKozo = 3 $$ g連続Mod) $$ (JY_max = JY_min)) $$ (X1 = X2 $$ LL < 350) ) {
                            GoTo AA5
                        } else {
                            i = 部J(M)
                            if ( JJM(i) != 9 ) {
                                if ( Not (X1 != X2 $$ JJM(i) = 3) ) {
                                if ( MMM(i) != 0 || JJM(i) != 1 ) { //Or (X1 != X2 $$ LL > 30) ) {
                                    GoTo AA5
                                }
                                }
                            }
                            MMM(i) = i
                        }
                    }
            //
              if ( (CASN < 0 $$ JJM(i) != 0) || (CASN >= 0 $$ JJM(i) != 0) ) {
                    MyCurrentX = HEN_X(節X(i)) + 20
                    if ( FR橋脚 = 2 $$ NKUI = 0 $$ CASN = 0 $$ Foot_Flg = 0 $$ i = 2 ) {
                        MyCurrentY = HEN_Y(節Y(i)) - 130
                    } else {
                        if ( FR橋脚 = 2 $$ (i = 2) $$ k = 2 ) {
                            MyCurrentY = HEN_Y(節Y(i)) - 150
                        } else {
                            if ( j = 1 $$ JJM(i) = 9 $$ X1 = X2 ) { //////10/01/14
                                MyCurrentY = HEN_Y(節Y(i)) - 150
                            } else {
                                MyCurrentY = HEN_Y(節Y(i)) + 25
                            }
                            if ( (Abs(節X(部I(M)) - JX_min) < 0.6 $$ j = 1 $$ (JJM(i) = 3 || JJM(i) = 9)) ) { // $$ X1 != X2 ) { ////10/01/14
                                if ( Shiten_FLG(i) = 1 ) {
                                    MyCurrentX = HEN_X(節X(i)) - 130 - (.FontSize * Twip * 0.3)
                                } else {
                                    MyCurrentX = HEN_X(節X(i)) - 130
                                }
                            }
                        }
                    }
            //            if ( i != 1 $$ i < Jn_max ) {
                        if ( 節X(部I(M)) != 節X(部J(M)) $$ 節Y(部I(M)) != 節Y(部J(M)) ) { //////////////06/01/25
                            if ( 節Y(部I(M)) - 節Y(部J(M)) > 0 ) {
            //                    MyCurrentX = MyCurrentX - .FontSize * Twip / 2 - (Len(str(i + 1))) * 45 / 2
                            MyCurrentX = MyCurrentX - .FontSize * Twip / 2 - (Len(str(i)) ^ 1.5) * 45 / 1.5 ////////09/10/14
                            } else {
                            MyCurrentX = MyCurrentX - .FontSize * Twip / 100
                            }
                            if ( 節Y(i) = JY_min ) { ////////09/10/14
                            MyCurrentY = MyCurrentY - .FontSize * Twip / 2 * Abs(HEN_Y(節Y(部I(M))) - HEN_Y(節Y(部J(M)))) / LL
                            }
                        } else { //////////////06/01/25
                        if ( X1 != X2 ) { ////////////////////////////// 水平
                            if ( (iKozo = 3 $$ g連続Mod $$ ((JY_max = JY_min) || (JJM(i) = 0 || JJM(i) = 9))) $$ ((i = 1 $$ j = 1) || (M = 部材_max $$ j = 2)) ) {
                                if ( (M = 1 || i = 1) ) {
                                    MyCurrentX = MyCurrentX - 20 * (.FontSize * Twip * 図X_SCALE * 10) / 2 ////////////08/04/25   /3
                                } else {if ( (M = 部材_max $$ j = 2) ) {
                                    MyCurrentX = MyCurrentX + 5 * (.FontSize * Twip * 図X_SCALE * 10) / 4 //////////////08/04/25   /4
                                } else {
                                    MyCurrentX = MyCurrentX + 2.5 * (.FontSize * Twip * 図X_SCALE * 10) / 2 ////////05/06/01
                                }
                            } else {
                                if ( (iKozo = 1 $$ JX_min = 節X(i) $$ JJM(i) = 9) ) {
                                    MyCurrentX = MyCurrentX - 10 * (.FontSize * Twip * 図X_SCALE * 10)
                                } else {if ( (iKozo = 1 $$ JX_max = 節X(i) $$ JJM(i) = 9) ) {
                                    MyCurrentX = MyCurrentX + 1 * (.FontSize * Twip * 図X_SCALE * 10)
                                } else {
                                    MSUU = 1 //Len(str(i))
                                    if ( ((JX_max + JX_min) / 2 >= 節X(i) - 0.25) $$ Not (iKozo = 3 $$ g連続Mod) ) {
                                        if ( j = 1 $$ JJM(i) = 2 ) {
            //                                   if ( CASN < 0 || gbolBuZai = 0 ) { //////////////////// 部材番号を出力
            //                                   if ( gbolBuZai = 0 ) { //////////////////// 部材番号を出力
                                                if ( LL < 350 ) {
            //                                        MyCurrentX = MyCurrentX - ((.FontSize * Twip * 0.4) * MSUU * 1.8 - (Len(str(i + 1)) - 0.5) * 30)
            //                  MyCurrentX = MyCurrentX - (IIf(gbolBuZai = 0 || CASN < 0, (250 - LL), (300 - LL)) + (Len(str(i + 1))) * 35)
                          MyCurrentX = MyCurrentX - 100 ////////17/07/31
                                                } else {
                                                if ( LL9 < 350 ) {
            //                                        if ( CASN < 0 || gbolBuZai = 0 ) { //////////////////// 部材番号を出力
            //                                        if ( LL9 != 0 ) {
                                                if ( (JX_max + JX_min) / 2 >= 節X(i) ) {
            //                                        MyCurrentX = MyCurrentX + (.FontSize * Twip * 0.4) * MSUU * 0.7 + IIf((JJM(部I(M)) = 2 || JJM(部J(M)) = 2), (Len(str(i + 1)) - 1) * 40 / 3, 0)
            //                 MyCurrentX = MyCurrentX + (IIf(gbolBuZai = 0, max(0, (200 - LL9)), max(0, (100 - LL9)))) + IIf((JJM(部I(M)) = 2 || JJM(部J(M)) = 2), (Len(str(i + 1)) - 1) * 40 / 3, 0)
                         MyCurrentX = MyCurrentX - 50 ////////17/07/31
                                                } else {
            //                                        MyCurrentX = MyCurrentX + (.FontSize * Twip * 0.4) * MSUU * 1.5
                                                }
                                                }
                                                }
            //                                   } else {
            ////                                        if ( LL < 350 ) {
            //                                        MyCurrentX = MyCurrentX - (.FontSize * Twip * 0.4) * MSUU * 1.8 //- (Len(str(i + 1))) * 40
            ////                                        }
            //                                   }
                                        }
                                        if ( j = 2 $$ (JJM(i) = 2 || JJM(i) = 3) ) {
                                           MyCurrentX = max(MyCurrentX, (XX8 + (.FontSize * Twip * 0.4) * MSUU / 2) + (Len(str(i + 1)) - 1) * 40)
                                        }
                                    } else { ////////////////// (JX_max + JX_min) / 2 < 節X(i)
                                        if ( j = 1 $$ JJM(i) = 2 ) {
            //                                   if ( CASN < 0 || gbolBuZai = 0 ) { //////////////////// 部材番号を出力
            //                                   if ( gbolBuZai = 0 ) { //////////////////// 部材番号を出力
                                                if ( LL < 350 ) {
                                                    if ( JJM(部J(M)) = 1 || JJM(部J(M)) = 3 ) { //////////05/05/22

            //           MyCurrentX = MyCurrentX - (IIf(CASN < 0, (250 - LL), (200 - LL)) + (Len(str(i + 1)) - 0.5) * 30 + (Len(str(部J(M))) - 1) * 30)
                   MyCurrentX = MyCurrentX - 200 ////////17/07/31
                                                    } else {
                                                    MyCurrentX = MyCurrentX - max(0, ((.FontSize * Twip * 0.25) * MSUU * 1.9 + (Len(str(i + 1)) - 0.5) * 30))
                                                    }
                                                } else {
                                                    if ( (CASN < 0 || gbolBuZai = 0) $$ Not (iKozo = 3 $$ g連続Mod) ) { //////////////////// 部材番号を出力
            //                                                MyCurrentX = MyCurrentX + (.FontSize * Twip * 0.4 / 4) * MSUU * 0.5
                                                        MyCurrentX = MyCurrentX - 100 ////////17/07/31
                                                    } else {
            //                                                MyCurrentX = MyCurrentX + (.FontSize * Twip * 0.4) * MSUU * 0.05 * 2
                                                        MyCurrentX = MyCurrentX - 100 ////////17/07/31
                                                    }
                                                }
            //                                   } else {
            ////                                        if ( LL < 350 ) {
            //                                        MyCurrentX = MyCurrentX - max(0, (.FontSize * Twip * 0.4) * MSUU * 1.9) //+ (Len(str(i + 1)) + 0.5) * 30)
            ////                                        }
            //                                   }
                                        } else {if ( j = 2 $$ (JJM(i) = 1 || JJM(i) = 3) ) {
            //                                if ( j = 2 $$ (JJM(i) = 1 || JJM(i) = 3) ) {
            //                                   if ( CASN < 0 || gbolBuZai = 0 || JJM(i) = 3 ) { //////////////////// 部材番号を出力
                                           if ( Not (Abs(節X(部I(M)) - JX_min) < 0.6 || Abs(節X(部J(M)) - JX_max) < 0.6) _
                                                        || Abs(節X(部J(M)) - JX_max) < 0.6 ) { ////13/08/08
                                                if ( Shiten_FLG(i) = 1 ) { //////14/05/04
                                                    MyCurrentX = MyCurrentX + (.FontSize * Twip * 0.04) * MSUU * 1.4 - (Len(str(i)) - 1) * 30 / 2 //////14/05/04
                                                } else {
                                                    MyCurrentX = MyCurrentX - (.FontSize * Twip * 0.4) * MSUU * 1.4 - (Len(str(i)) - 1) * 30
                                                }
                                           }
            //                                   } else {
            //                                   MyCurrentX = MyCurrentX - (.FontSize * Twip * 0.4 * MSUU * 1.5 + (Len(str(i)) - 1) * 30)
            //                                   }
                                        } else {
                                           if ( (Abs(節X(部I(M)) - JX_min) < 0.6 || Abs(節X(部J(M)) - JX_max) < 0.6) ) { ////10/01/14
                                           MyCurrentX = MyCurrentX - (.FontSize * Twip * 0.2)
                                           } else {
                                           MyCurrentX = MyCurrentX - (.FontSize * Twip * 0.4) * MSUU * 2 ////09/10/14//// * 1.7
                                           }
                                        }
                                        if ( j = 2 $$ JJM(i) = 2 ) {
                                           if ( CASN < 0 || gbolBuZai = 0 ) {  //////////////////// 部材番号を出力
                                           MyCurrentX = max(MyCurrentX, (X1 + (.FontSize * Twip * 0.4) * MSUU / 1.7) + (Len(str(i)) - 1) * 30)
                                           }
                                        }
                                    }
                                }
                            }
                            if ( CASN >= 0 $$ gbolBuZai = 1 ) { //////////////////// 部材番号を出力しない
                                if ( (JX_max + JX_min) / 2 >= 節X(i) ) {
                                    if ( j = 1 $$ JJM(i) = 2 $$ JJM(部J(M)) = 1 ) {
                                        MyCurrentX = MyCurrentX + (.FontSize * Twip * 0.4)
                                    }
                                } else {
                                    if ( j = 1 $$ JJM(i) = 2 $$ LL9 < 350 $$ (JX_max + JX_min) / 2 >= 節X(i) - 0.25 ) {
                                        MyCurrentX = MyCurrentX - (.FontSize * Twip * 0.4)
                                    }
                                }
                            }
                        } else { ////////////////////////////// 鉛直
                            if ( (JX_max + JX_min) / 2 < 節X(i) $$ Not (JJM(i) = 3 || JJM(i) = 9) ) {
            //                        if ( CASN >= 0 ) {
                                MyCurrentX = MyCurrentX - (.FontSize * Twip * 0.2) * IIf(i < 10, 2.3, 2.9) * 1.3 //IIf(CASN >= 0, 1.1, 1)
            //                        }
                            } else {if ( (JX_max + JX_min) / 2 > 節X(i) $$ i > 9 ) { ////////05/05/22
                                MyCurrentX = MyCurrentX - (.FontSize * Twip * 0.05)
                            }
            if ( 水平部材Y_MIN - 節Y(i) > 1.5 $$ Not ((InStr(部材名(M), "杭") = 1) $$ M杭mod $$ i = 部J(M)) ) { //08/07/11
            //        MyCurrentY = (y1 - .FontSize * Twip * 0.4 * 1.2) //////08/08/16
            } else {
                            if ( j = 2 $$ JJM(i) = 1 ) {
                                MyCurrentY = min(MyCurrentY - 220, (Y2 - .FontSize * Twip * 0.4 * 1.2))
                            }
                            if ( (j = 2 $$ JJM(i) = 2) ) {
                                if ( LL < 350 ) {
                                MyCurrentY = max(MyCurrentY + 20, (y1 + .FontSize * Twip * 0.4 * 1.2))
                                } else {
                                MyCurrentY = min(MyCurrentY - 220, (Y2 - .FontSize * Twip * 0.4 * 1.2))
                                }
                            } else {if ( (j = 1 $$ JJM(部J(M)) = 1 $$ JJM(i) = 2) ) {
                                if ( LL < 350 ) {
                                MyCurrentY = min(MyCurrentY - (230 - LL), (y1 - .FontSize * Twip * 0.4 * 1.2))
                                }
                                if ( LL9 < 350 ) { //////////////05/06/01
                                MyCurrentY = min(MyCurrentY + (150 - LL9), (y1 + .FontSize * Twip * 0.4 * 1.2))
                                }
                            } else {if ( (j = 1 $$ JJM(i) = 2) ) {
                                if ( LL < 350 $$ (JY_max + JY_min) / 2 > (節Y(部I(M)) + 節Y(部J(M))) / 2 $$ JJM(部J(M)) = 2 ) {
                                    MyCurrentY = min(MyCurrentY - 100, (y1 - .FontSize * Twip * 0.4 * 1.2))
                                } else {if ( LL < 100 ) {
                                    MyCurrentY = max(MyCurrentY + (150 - LL) / 2, (y1 - .FontSize * Twip * 0.4 * 0.15))
                                } else {if ( LL < 350 ) {
                                    if ( Not (FR橋脚 = 2 $$ (i = 2) $$ k = 2) ) {
                                        if ( NKUI = 0 $$ iKozo = 3 $$ Abs(節Y(部J(M)) - YY_min) < 1 ) { //Y2 = HEN_Y(節Y(部J(M)))
                                            MyCurrentY = min(MyCurrentY - 50, (y1 - .FontSize * Twip * 0.4 * 1.2))
                                        } else {
                                            MyCurrentY = y1 - (.FontSize * Twip * 0.4) //////14/05/04//////max(MyCurrentY + 20, (y1 + .FontSize * Twip * 0.4 * 1.2))
                                        }
                                    }
                                } else {if ( LL9 < 350 ) {
                                    MyCurrentY = min(MyCurrentY + (150 - LL9), (y1 + .FontSize * Twip * 0.4 * 1.2))
                                }
                            }
                }
                            if ( (InStr(部材名(M), "杭") = 1) $$ M杭mod ) {
                                if ( j = 1 ) {
                                    MyCurrentY = MyCurrentY + 50 ////09/08/07//////120 //////// 05/06/01
                                } else {
                                if ( iCA >= 0 $$ j = 2 ) {
                                    if ( UCase(Mid(F7ML3(iCA), 1, 2)) = "AT" $$ M杭mod ) {
                                        MyCurrentX = MyCurrentX - 200
                                        MyCurrentY = MyCurrentY + 50
                                    }
                                }
                                }
                            }
                    }
                    } //////////////06/01/25
            //            if ( (gOut部材番号 = False $$ CASN = 0) || (CASN >= 0 $$ JJM(i) != 1) ) { ////////// 05/04/01
            //            if ( (gbolSeten = 1 $$ CASN >= 0 $$ JJM(i) = 0) ) { ////////// 05/04/01
                    if ( (gbolSeten = 1 $$ JJM(i) = 0) ) {  ////////// 05/04/01
                    } else {
                        XX8 = MyCurrentX
            //                if ( TX(i) + TY(i) + TZ(i) < 5 $$ TX(i) + TY(i) + TZ(i) > 0 ) {
            //                if ( TX(I) + TY(I) + TZ(I) >= 0 $$ Not g連続Mod ) { //////////////////////////////////////////////////////////05/05/23
                        if ( Shiten_FLG(i) = 1 $$ Not g連続Mod ) { //////////14/05/04
                            if ( Not (水平部材Y_MIN - 節X(i) > 1.5) ) { //////////////////////////////////////// 08/07/11
                            MyCurrentX = MyCurrentX + (.FontSize * Twip * 0.12) // 05/02/09
                            }
                        } else {
                            if ( TX(i) < 0 $$ TY(i) < 0 $$ TZ(i) < 0 ) {
                            } else {
            //                    if ( (JX_max + JX_min) / 2 >= 節X(i) - 0.25 ) {
                                if ( (JX_max + JX_min) / 2 < 節X(i) $$ Not (JJM(i) = 3 || JJM(i) = 9) || (g連続Mod $$ i != 1) ) {
                                MyCurrentX = MyCurrentX + (.FontSize * Twip * 0.05) // 05/02/09
                                } else {
                                MyCurrentX = MyCurrentX - (.FontSize * Twip * 0.05) // 05/02/09
                                }
                            }
                        }
                        if ( wRR(i) > 0 ) { //////////////08/06/23
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        if ( NoUseSettenNumberPrint = 1 ) {
                            if ( USEJ(i) = 0 ) { ////////////06/02/14
                                PrintoutPrt frmPrint.vsPrt1, " " + Mid(str(i), 2)
                                USEJ(i) = 1
                                if ( CreateDxfFlag = 1 ) {
                                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                                    ParamXPoint = QWX1
                                    ParamYpoint = QWY1
                                    ParamText = " " + Mid(str(i), 2)
                                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                                    XX8 = ParamXPoint
                                }
                            }
                        } else {
                            if ( USEJ(i) = 0 ) { ////////////06/02/14
                                PrintoutPrt frmPrint.vsPrt1, " " + Mid(str(i), 2)
                                USEJ(i) = 1
                                if ( CreateDxfFlag = 1 ) {
                                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                                    ParamXPoint = QWX1
                                    ParamYpoint = QWY1
                                    ParamText = " " + Mid(str(i), 2)
                                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                                    XX8 = ParamXPoint
                                }
                            }
                        }
                        } //////////////08/06/23
                    }
                    }
            AA5:
                }
            AA6:
                    if ( LL < 30 ) {
                        XX9 = X2: yy9 = Y2
                    } else {
                        XX9 = X1: yy9 = y1
                    }
                Next M
                }
            End With
            /*/
        }

        /* private Function SSMax(Param1 As Single, Param2 As Single) As Single
        //
        if ( Param1 > Param2 ) {
            SSMax = Param1
        } else {
            if ( Param1 < Param2 ) {
                SSMax = Param2
            } else {
                SSMax = Param1
            }
        }
        //
        }
            */

        /* private Function SSMin(Param1 As Single, Param2 As Single) As Single
        //
        if ( Param1 > Param2 ) {
            SSMin = Param2
        } else {
            if ( Param1 < Param2 ) {
                SSMin = Param1
            } else {
                SSMin = Param1
            }
        }
        //
        }
            */

        private void OUT_部材(int CASN, int CaseP, int KUIHON)
        { //部材NO)
            /*/
            //    var Dummy寸法()
            //    var Dummy9寸法()
            //    var DummyX()             As Variant
            //    var DummyY()             As Variant
            var i                       As Integer
            var j                       As Integer
            var GHGH                    As Single
            //    var UpDownFlag()            As Integer
            var X1
            var y1
            var X2
            var Y2
            var ZFX
            var ZFY
            var AFX
            var AFY
            var MOJ
            double var X()
            double var Y()
            var Dn1()                   As Integer
            var Dn2()                   As Integer
            var 寸法()
            var 寸法9()
            var NN1                     As Integer
            var NN2                     As Integer
            var st                      As Integer
            var YY0                     As Single
            var YY1                     As Single
            var Yy2                     As Single
            var Yz1                     As Single
            var Yz2                     As Single
            var bOutput1                As Boolean
            var bOutput2                As Boolean
            var EE                      As Integer
            var SSAA                    As Variant
            var FAFA(1000)              As Variant
            var HIH                     As Integer
            var GGII                    As Integer
            var GGjj                    As Integer
            var yHosei                  As Single
            var CheckFgFg               As Single
            var ATTAFLAG                As Single
            var KANAZ                   As Single
            var DummyY2                 As Single
            var y本数位置                As Single
            var ASF1                    As Single
            var LL As Single
            var XX9 As Single, yy9 As Single, LL9 As Single, HH9 As Single, JJ9 As Single
            var 杭奥行き本数   As Integer
            var KKK As Integer ////////////////////////////////// 05/02/07
            var yyy As Single //////////////////////////////////// 05/02/07
            var rFlg As Integer
            var GGG As Integer
            var bKUI As Integer
            KKK = -1
            rFlg = 0
            bKUI = 0
            //
            //    if ( iKozo = 3 $$ Abs(JY_max - JY_min) < 0.01 ) {
            //        iKozo = 1 ////////連続梁////////// 03/10/04
            //    }
            //    this.UpDownFlag(部材_max)
            //    this.Dummy寸法(1000) //////////09/10/05
            //    this.Dummy9寸法(1000)
            //    this.DummyX(1000)
            //    this.DummyY(1000)
            //    this.寸法9(1000) //////////09/10/05
            //
            this.GFLAG(2000)
            yHosei = 0
            y本数位置 = -99999
            //////////////////////////////////////////////////////////////////////////////////////////////////////////// 05/01/31
            杭奥行き本数 = 0
            if ( NKUI != 0 ) {
                For( i = 1 To 部材_max
                    if ( ZZBuzaiBai(i) != 0 ) { ////////08/06/23
                    if ( InStr(部材名(i), "杭") = 1 $$ (KUIHON = 1 || CASN < 0) ) { //////05/03/13
                        杭奥行き本数 = max(杭奥行き本数, 数部材(i))
                    }
                    }
                Next
            }
            With frmPrint.vsPrt1
                .PenColor = QBColor(部材Pen色)
                .PenWidth = 部材Pen幅
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(.PenWidth))
                }
                .FontSize = 部材番号Fontsize
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(.PenWidth))
                }
            //        if ( CASN = -1 ) {
            //            .FontSize = .FontSize * 0.9 //////14/11/177
            //        } else {
            //            .FontSize = .FontSize * 0.8 //////14/11/177
            //        }
                if ( RR橋脚 = 2 $$ NKUI = 0 $$ CASN = 0 $$ Foot_Flg = 0 ) {
                    部材_max = 1
                }
                Yz1 = 9000000000#
                Yz2 = -9000000000#
                XX9 = -99999: yy9 = -99999: HH9 = 999999999: JJ9 = 0
                yyy = HEN_Y(節Y(部I(1)))
            var brFlg As Integer
            brFlg = 0
                For( i = 1 To 部材_max
                    if ( ZZBuzaiBai(i) != 0 ) {
                    if ( RR橋脚 = 1 ) {
                        if ( InStr(部材名(i), "剛") != 0 ) {
                            .PenWidth = 部材Pen幅 + 10 //5 剛域 太い
                            if ( CreateDxfFlag = 1 ) {
                                this.PLOTPEN(CSng(.PenWidth))
                            }
                        } else {
                            .PenWidth = 部材Pen幅
                            if ( CreateDxfFlag = 1 ) {
                                this.PLOTPEN(CSng(.PenWidth))
                            }
                        }
                    } else { // RR橋脚 = 2
                        if ( InStr(部材名(i), "剛") != 0 || InStr(部材名(i), "ﾌｰﾁﾝｸﾞ") != 0 ) {
                            if ( InStr(部材名(i), "ﾌｰﾁﾝｸﾞ") != 0 ) {
                                .PenWidth = 部材Pen幅 + 12 //5ﾌｰﾁﾝｸﾞ太い
                                if ( CreateDxfFlag = 1 ) {
                                    this.PLOTPEN(CSng(.PenWidth))
                                }
                            } else {
                                .PenWidth = 部材Pen幅 + 10 //5 剛域 太い
                                if ( CreateDxfFlag = 1 ) {
                                    this.PLOTPEN(CSng(.PenWidth))
                                }
                            }
                        } else {
                            .PenWidth = 部材Pen幅
                            if ( CreateDxfFlag = 1 ) {
                                this.PLOTPEN(CSng(.PenWidth))
                            }
                        }
                    }
                    X1 = HEN_X(節X(部I(i)))
                    y1 = HEN_Y(節Y(部I(i)))
                    X2 = HEN_X(節X(部J(i)))
                    Y2 = HEN_Y(節Y(部J(i)))
                    LL = Sqr((X1 - X2) ^ 2 + (y1 - Y2) ^ 2)
            //            LL9 = Sqr((X1 - XX9) ^ 2 + (Y1 - YY9) ^ 2)
                    if ( LL < 30 ) {
                        XX9 = X2: yy9 = Y2
                    } else {
                        XX9 = X1: yy9 = y1
                    }
            //
            var WWW As Integer
            WWW = 0
            if ( CaseP > 0 ) {
                if ( 一期施工Flag(i) = 1 $$ (InStr(荷重名称(CaseP), "一期") != 0 || _
                                            InStr(荷重名称(CaseP), "１期") != 0 || _
                                            InStr(荷重名称(CaseP), "1期") != 0) ) { //////09/03/13
                    WWW = 1
                }
            }
            if ( i = 1 $$ X1 != X2 ) { //////////////橋脚ではない  06/02/14
                brFlg = 1
            }
                    if ( LL != 0 ) {
                    if ( Abs(yyy - HEN_Y(節Y(部I(i)))) / LL > 0.2 ) { KKK = -1 //////// 05/02/07
                    }
                    yyy = HEN_Y(節Y(部I(i)))
                    if ( HoneKaki = 1 ) {
                        KuiBuzaiX(1, i) = X1
                        KuiBuzaiX(2, i) = y1
                        KuiBuzaiY(1, i) = X2
                        KuiBuzaiY(2, i) = Y2
                    }
                    BuzaiGAri = 0
                    GenZaiI = i
                    if ( KaSouFlag(i) = 0 $$ WWW = 0 ) { //////09/03/13
                        DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(X1), CSng(y1), CSng(X2), CSng(Y2))
                        }
                    } else {
            //                if ( ZFAngle(i) = 90 ) { //////////////// 05/03/17
                        if ( X1 > X2 || y1 > Y2 ) { ////////07/12/15
                            this.PlotLine1_FG(CDbl(X2), CDbl(Y2), CDbl(X1), CDbl(y1), 2)
                        } else {
                            this.PlotLine1_FG(CDbl(X1), CDbl(y1), CDbl(X2), CDbl(Y2), 2)
                        }
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(X1), CSng(y1), CSng(X2), CSng(Y2))
                        }
                    }
                    .PenStyle = psSolid
                    if ( gouikidddd = 1 $$ Atta寸法 = 1 ) {
                        if ( Atta寸法 = 1 ) {
                            if ( ZXXXX1(i) = -9000000000# || ZYYYY1(i) = -9000000000# || WWW = 1 ) {
                            } else {
                                BuzaiGAri = 1 ////////////////////06/04/04
                                AFX = X1
                                AFY = y1
                                ZFX = HEN_X(CSng(ZXXXX1(i)))
                                ZFY = HEN_Y(CSng(ZYYYY1(i)))
                                .PenWidth = 部材Pen幅 + 15
                                if ( CreateDxfFlag = 1 ) {
                                    this.PLOTPEN(CSng(.PenWidth))
                                }
                                DrawLinePrt frmPrint.vsPrt1, AFX, AFY, ZFX, ZFY
                                if ( CreateDxfFlag = 1 ) {
                                    this.LINEOUT(CSng(AFX), CSng(AFY), CSng(ZFX), CSng(ZFY))
                                }
                            }
                            if ( ZXXXX2(i) = -9000000000# || ZYYYY2(i) = -9000000000# || WWW = 1 ) {
                            } else {
                                BuzaiGAri = 1
                                AFX = X2
                                AFY = Y2
                                ZFX = HEN_X(CSng(ZXXXX2(i)))
                                ZFY = HEN_Y(CSng(ZYYYY2(i)))
                                .PenWidth = 部材Pen幅 + 15
                                if ( CreateDxfFlag = 1 ) {
                                    this.PLOTPEN(CSng(.PenWidth))
                                }
                                DrawLinePrt frmPrint.vsPrt1, AFX, AFY, ZFX, ZFY
                                if ( CreateDxfFlag = 1 ) {
                                    this.LINEOUT(CSng(AFX), CSng(AFY), CSng(ZFX), CSng(ZFY))
                                }
                            }
                        }
                    }
                    .PenWidth = 部材Pen幅
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(.PenWidth))
                    }
                    Yz1 = min(Yz1, 節Y(部I(i)))
                    Yz2 = max(Yz2, 節Y(部I(i)))
                    //-------------- 部材番号 --------------
            //     gbolBuZai = chk作図(2)         //荷重図の部材番号の作図 ////// 05/04/01
                    if ( Abs(X1 - X2) < 0.01 $$ (JX_max + JX_min) / 2 < 節X(部I(i)) $$ InStr(部材名(i), "杭") = 0 $$ iKozo != 2 ) {
                        if ( CASN != -1 ) {
                            X1 = X1 + 60 + (.FontSize * Twip / 6) //////1.5 //1.35 ////////// 05/02/07
                            X2 = X2 + 60 + (.FontSize * Twip / 6) //.FontSize * Twip / 2 //////1.5 //1.35 ////////// 05/02/07
                        } else {
                            X1 = X1 + 60 + (.FontSize * Twip / 6)
                            X2 = X2 + 60 + (.FontSize * Twip / 6) ////// 2
                        }
                    }
            //////// 05/02/07
            //            if ( CASN < 0 ) { ////////////////////////////////////////////////////////05/04/16
                            if ( 節X(部I(i)) = 節X(部J(i)) ) {
                                if ( (JX_max + JX_min) / 2 >= 節X(部I(i)) || InStr(部材名(i), "杭") = 1 || iKozo = 2 ) {
                                    X1 = X1 - .FontSize * Twip / 15
                                    X2 = X2 - .FontSize * Twip / 15
                                } else {
                                    X1 = X1 + .FontSize * Twip / 15 + 20
                                    X2 = X2 + .FontSize * Twip / 15 + 20
                                }
                                if ( (iKozo = 3 $$ g連続Mod) ) {
                                    y1 = y1 - .FontSize * Twip / 10
                                    Y2 = Y2 - .FontSize * Twip / 10
                                } else {
                                    if ( JJ9 = 部I(i) $$ Abs(HH9 - (y1 + Y2) / 2) < 550 $$ JJM(部I(i)) = 2 $$ JJM(部J(i)) = 2 ) { ////////05/04/16
                                        if ( (YY_max + YY_min) / 2 > (節Y(部I(i)) + 節Y(部J(i))) / 2 ) {
                                            y1 = y1 - Round(max(0, HH9 + .FontSize * Twip / 6 * Len("(" + Mid(str(i), 2) + ")") - (y1 + Y2) / 2), 3)
                                            Y2 = Y2 - Round(max(0, HH9 + .FontSize * Twip / 6 * Len("(" + Mid(str(i), 2) + ")") - (y1 + Y2) / 2), 3)
                                        } else {
                                            y1 = y1 + Round(max(0, HH9 + .FontSize * Twip / 6 * Len("(" + Mid(str(i), 2) + ")") - (y1 + Y2) / 2), 3)
                                            Y2 = Y2 + Round(max(0, HH9 + .FontSize * Twip / 6 * Len("(" + Mid(str(i), 2) + ")") - (y1 + Y2) / 2), 3)
                                        }
                                    }
            ////////////// 05/05/22
                                    if ( X1 = X2 $$ Abs(y1 - Y2) < 150 $$ JJM(部I(i)) = 2 $$ JJM(部J(i)) = 2 ) {
                                        if ( Abs(HEN_Y(節Y(部I(i - 1))) - HEN_Y(節Y(部J(i - 1)))) > 1000 || Abs(HEN_Y(節Y(部I(i + 1))) - HEN_Y(節Y(部J(i + 1)))) > 300 ) {
                                            y1 = y1 - max(160 - (Abs(y1 - Y2) / 図Y_SCALE / Twip / 3), 0) //////16/12/19
                                            Y2 = Y2 - max(160 - (Abs(y1 - Y2) / 図Y_SCALE / Twip / 3), 0)
                                        } else {
                                            y1 = y1 + max(260 - (Abs(y1 - Y2) / 図Y_SCALE / Twip / 3), 0) //////16/12/19
                                            Y2 = Y2 + max(260 - (Abs(y1 - Y2) / 図Y_SCALE / Twip / 3), 0)
                                        }
                                    }
            ////////////// 05/05/22
                                    if ( JJM(部J(i)) != 2 ) {
                                        HH9 = 9999999999#
                                        JJ9 = 0
                                    } else {
                                        HH9 = (y1 + Y2) / 2
                                        JJ9 = 部J(i)
                                    }
                                }
                            }
            //                    if ( (iKozo = 3 $$ g連続Mod $$ 節X(部I(i)) != 節X(部J(i))) ) {
                            if ( 節X(部I(i)) != 節X(部J(i)) ) {
                                y1 = y1 - .FontSize * Twip / 20
                                Y2 = Y2 - .FontSize * Twip / 20
                            }
                            if ( (iKozo = 1 $$ JX_min = 節X(部I(i)) $$ JJM(部I(i)) = 9 $$ 節X(部I(i)) != 節X(部J(i))) $$ Abs(X1 - X2) < 250 ) {
                                X1 = X1 - .FontSize * Twip / 2 - (Len(str(i)) - 1) * 20
                                X2 = X2 - .FontSize * Twip / 2 - (Len(str(i)) - 1) * 20
                            }
            //                    if ( (iKozo = 3 $$ g連続Mod $$ 節X(部I(i)) != 節X(部J(i))) ) {
            //                        y1 = y1 - .FontSize * Twip / IIf(CASN < 0, 8, 20)
            //                        Y2 = Y2 - .FontSize * Twip / IIf(CASN < 0, 8, 20)
            //                    } else {if ( (iKozo = 1 $$ JX_min = 節X(部I(i)) $$ JJM(部I(i)) = 9) ) {
            //                        X1 = X1 - .FontSize * Twip / 2 - (Len(str(i)) - 1) * 10
            //                        X2 = X2 - .FontSize * Twip / 2 - (Len(str(i)) - 1) * 10
            //                    }
                            if ( 節X(部I(i)) != 節X(部J(i)) $$ (((LL < 300)) $$ Abs(AngleDF1[i]] < 20] $$ Not (iKozo = 3 $$ g連続Mod] ] {  ////// 05/02/07
                                if ( (JJM(部I(i)) = 2 $$ JJM(部J(i)) = 2) || _
                                    Abs(節X(部I(i)) - JX_min) < 0.6 || Abs(節X(部J(i)) - JX_max) < 0.6 ) { //////10/01/14
                                } else {
                                    KKK = KKK + 1 //////////////////////////////////////////////////////////////// 05/02/07
                                    if ( KKK Mod 2 = 0 || i = 1 || KKK = 0 ) {
                                        if ( KKK = 0 ) { KKK = KKK + 1
            //                                X1 = X1 + .FontSize * Twip / 4 + (Len(str(i)) - 1) * 10//////17/07/31 コメントにした
            //                                X2 = X2 + .FontSize * Twip / 4 + (Len(str(i)) - 1) * 10
                                    } else {
            //                                X1 = X1 - .FontSize * Twip / 4 - (Len(str(i)) - 1) * 10
            //                                X2 = X2 - .FontSize * Twip / 4 - (Len(str(i)) - 1) * 10
                                    }
                                }
                            } else {
                                KKK = 0
                            }
                                if ( Not (iKozo = 3 $$ g連続Mod) $$ Abs(AngleDF1[i]] < 20 ] { // Abs(y1 - Y2] < 0.1 ] {
            //                            if ( 節X(部I(I)) != 節X(部J(I)) $$ (Abs(節Y(部I(I)) - YY_max) < 0.1 || LL < 300) ) { //////上層はり//////08/08/29
            //                                y1 = y1 - .FontSize * Twip / 2.1 //1.9
            //                                Y2 = Y2 - .FontSize * Twip / 2.1 //1.9
            //                            } else {if ( iKozo = 1 $$ 節X(部I(I)) != 節X(部J(I)) $$ (Abs(節Y(部I(I)) - YY_min) < 0.1 || LL > 300) ) { //////下層はり
            //                                y1 = y1 - .FontSize * Twip / 2.1 //1.9
            //                                Y2 = Y2 - .FontSize * Twip / 2.1 //1.9
            //                            }
                                    if ( 節X(部I(i)) != 節X(部J(i)) ) { //////////////////08/08/29
                                        y1 = y1 - .FontSize * Twip / 2.1 //1.9
                                        Y2 = Y2 - .FontSize * Twip / 2.1 //1.9
                                    }
                                } else {
                                    if ( Not (iKozo = 3 $$ g連続Mod) $$ Abs(y1 - Y2) < 250 $$ X1 = X2 ) {
                                        if ( JJM(部I(i)) = 2 $$ JJM(部J(i)) != 2 $$ iKozo != 2 ) {
            //                                    y1 = y1 + max(.FontSize * Twip / 1.3 - LL / 1.5, 0)//////14/08/13コメントにした
            //                                    Y2 = Y2 + max(.FontSize * Twip / 1.3 - LL / 1.5, 0)
                                        }
                                        if ( JJM(部I(i)) != 2 $$ JJM(部J(i)) = 2 $$ iKozo != 2 ) {
                                            y1 = y1 + max(.FontSize * Twip / 2.1 - LL / 1.5, 0)
                                            Y2 = Y2 + max(.FontSize * Twip / 2.1 - LL / 1.5, 0)
                                        }
            //                                if ( JJM(部I(i)) = 2 $$ JJM(部J(i)) = 2 ) { ////////05/04/16
            //                                    y1 = y1 + .FontSize * Twip * 0.5
            //                                    Y2 = Y2 + .FontSize * Twip * 0.5
            //                                }
                                    }
                                }
                            if ( 節X(部I(i)) != 節X(部J(i)) $$ 節Y(部I(i)) != 節Y(部J(i)) ) { //////////////06/01/25
                                X1 = HEN_X(節X(部I(i))) - .FontSize * Twip / 1.5 * (HEN_Y(節Y(部I(i))) - HEN_Y(節Y(部J(i)))) / LL
                                X2 = HEN_X(節X(部J(i))) - .FontSize * Twip / 1.5 * (HEN_Y(節Y(部I(i))) - HEN_Y(節Y(部J(i)))) / LL
                                y1 = HEN_Y(節Y(部I(i))) - .FontSize * Twip / 1.5 * Abs(HEN_X(節X(部I(i))) - HEN_X(節X(部J(i)))) / LL
                                Y2 = HEN_Y(節Y(部J(i))) - .FontSize * Twip / 1.5 * Abs(HEN_X(節X(部I(i))) - HEN_X(節X(部J(i)))) / LL
                            }
            //                    } ////////////////////////////////////////////////////////////////////////////////////// 05/02/07
                       if ( CASN < 0 || (CASN >= 0 $$ gbolBuZai = 0) ) { ////// 05/04/01
                            MOJ = "(" + Mid(str(i), 2) + ")"
                            if ( AngleKK(X1, y1, X2, Y2) <= 20 $$ AngleDF1[i] != 90 ] {
                                this.MOJ軸C("U上", X1, y1, X2, Y2, MOJ)
                            } else {
                                if ( AngleDF1[i] = 90 || AngleDF1[i] = 270 ] {
            //                            if ( (LL < 30 $$ LL9 < 30) ) {
            //                            this.MOJ軸C("S上", X2 - .FontSize * Twip / 2.5, Y2, X1 - .FontSize * Twip / 2.5, y1, MOJ)
            //                            } else {
                                    this.MOJ軸C("S上", X2, Y2, X1, y1, MOJ)
            //                            }
                                } else {
            //                        if ( (LL < 30 $$ LL9 < 30) ) {
            //                            this.MOJ軸C("U上", X2, Y2 - .FontSize * Twip / 2.5, X1, y1 - .FontSize * Twip / 2.5, MOJ)
            //                            } else {
                                    this.MOJ軸C("U上", X2, Y2, X1, y1, MOJ)
            //                            }
                                }
                            }
                        } ////// 05/04/01
            //////            } else { ////////////////////////////////////////////////////////05/04/16
            //////                    if ( (iKozo = 3 $$ g連続Mod $$ 節X(部I(i)) != 節X(部J(i))) ) {
            //////                        y1 = y1 - .FontSize * Twip / 20
            //////                        Y2 = Y2 - .FontSize * Twip / 20
            //////                    } else {if ( (iKozo = 1 $$ JX_min = 節X(部I(i)) $$ JJM(部I(i)) = 9) ) {
            //////                            X1 = X1 - .FontSize * Twip / 2 - (Len(str(i)) - 1) * 10
            //////                            X2 = X2 - .FontSize * Twip / 2 - (Len(str(i)) - 1) * 10
            //////                    }
            //////                    if ( (((gOut部材番号 = False) || (LL < 300)) $$ Abs(AngleDF1[i]] < 20] $$ Not (iKozo = 3 $$ g連続Mod] ] {  ////// 05/02/07
            //////                        KKK = KKK + 1 ////////////////////////////////// 05/02/07
            //////                        if ( KKK Mod 2 = 0 || i = 1 || KKK = 0 ) {
            //////                            if ( KKK = 0 ) { KKK = KKK + 1
            //////                            X1 = X1 + .FontSize * Twip / 4 + (Len(str(i)) - 1) * 10
            //////                            X2 = X2 + .FontSize * Twip / 4 + (Len(str(i)) - 1) * 10
            //////                        } else {
            //////                            X1 = X1 - .FontSize * Twip / 4 - (Len(str(i)) - 1) * 10
            //////                            X2 = X2 - .FontSize * Twip / 4 - (Len(str(i)) - 1) * 10
            //////                        }
            //////                    } else {
            //////                        KKK = 0
            //////                    } ////////////////////////////////////////////////////////////////////////////////////// 05/02/07
            //////                        if ( Not (iKozo = 3 $$ g連続Mod) $$ Abs(y1 - Y2) < 0.1 ) {
            //////                            if ( Abs(節Y(部I(i)) - JY_max) < 0.1 || LL < 300 ) {
            //////                                y1 = y1 - .FontSize * Twip / 1.9
            //////                                Y2 = Y2 - .FontSize * Twip / 1.9
            //////                            }
            //////                        } else {
            //////                            if ( Not (iKozo = 3 $$ g連続Mod) $$ Abs(y1 - Y2) < 250 $$ X1 = X2 ) {
            //////                                if ( JJM(部I(i)) = 2 $$ JJM(部J(i)) != 2 ) {
            //////                                    y1 = y1 - max(.FontSize * Twip / 1.3 - LL / 1.5, 0)
            //////                                    Y2 = Y2 - max(.FontSize * Twip / 1.3 - LL / 1.5, 0)
            //////                                } else {
            //////                                    if ( Abs(y1 - Y2) < 350 $$ JJM(部I(i)) = 2 $$ JJM(部J(i)) = 2 ) { ////////05/04/16
            //////                                        y1 = y1 + .FontSize * Twip * 0.5
            //////                                        Y2 = Y2 + .FontSize * Twip * 0.5
            //////                                    }
            //////                                }
            ////////                           } else {
            //////                                if ( JJM(部I(i)) != 2 $$ JJM(部J(i)) = 2 ) {
            //////                                    y1 = y1 + max(.FontSize * Twip / 1.8 - LL / 1.5, 0)
            //////                                    Y2 = Y2 + max(.FontSize * Twip / 1.8 - LL / 1.5, 0)
            //////                                } else {
            //////                                    if ( Abs(y1 - Y2) < 350 $$ JJM(部I(i)) = 2 $$ JJM(部J(i)) = 2 ) { ////////05/04/16
            //////                                        y1 = y1 + .FontSize * Twip * 0.5
            //////                                        Y2 = Y2 + .FontSize * Twip * 0.5
            //////                                    }
            //////                                }
            //////                            }
            //////                        }
            ////////                     }
            //////               if ( CASN < 0 || (CASN >= 0 $$ gbolBuZai = 0) ) { ////// 05/04/01
            //////                    MOJ = "(" + Mid(str(i), 2) + ")"
            //////                    if ( AngleKK(X1, y1, X2, Y2) = 0 $$ AngleDF1[i] != 90 ] {
            //////                        this.MOJ軸C("U上", X1, y1, X2, Y2, MOJ)
            //////                    } else {
            //////                        if ( AngleDF1[i] = 90 ] {
            //////                            this.MOJ軸C("S上", X2, Y2, X1, y1, MOJ)
            //////                        } else {
            //////                            this.MOJ軸C("U上", X2, Y2, X1, y1, MOJ)
            //////                        }
            //////                    }
            //////                } //////////////05/04/01
            //////            } ////////////////////////////////////////////////////////05/04/16
            //
                    // 杭の部材数の出力
                    if ( (CASN < 0 || CaseP = 1) $$ (InStr(部材名(i), "杭") = 1) $$ k杭数 = 1 $$ 杭奥行き本数 > 1 ) {
                        Y2 = Y2 + 300
                        if ( Abs(X2 - y本数位置) < 400 ) { //////////////// 04/10/14
                            bKUI = bKUI + 1
                            if ( Int((bKUI + 1) / 2) * 2 = (bKUI + 1) ) {
                            Y2 = Y2 + 150
                            }
            //                    y本数位置 = -99999
                        } else {
                            bKUI = 0
            //                   y本数位置 = X2
                        }
                        y本数位置 = X2 //////////////// 04/10/14
            //
                        if ( NoJtan(i) = 1 ) {
                            .FontSize = 部材番号Fontsize * 1.3
            //                    if ( 数部材(I) = 0 ) { 数部材(I) = 1
                            if ( 数部材(i) = Int(数部材(i)) ) {
                                MOJ = "n=" & Mid(str(数部材(i)), 2) & "本"
                            } else {
                                if ( 数部材(i) * 10 = Int(数部材(i) * 10) ) {
                                    MOJ = "n=" & Format(数部材(i), "0.0") & "本"
                                } else {
                                    MOJ = "n=" & Format(数部材(i), "0.00") & "本"
                                }
                            }
                            this.MOJ軸C("U上", X2, Y2, X2 + 1, Y2, MOJ)
                            .FontSize = 部材番号Fontsize
                        }
                    }
                    }
                }
                /////////////////////////////////////////////////// 分布ばねマーク 13/11/26
                this.分布ばねMark(0, CASN)
            //        For( i = 1 To 部材_max
            //            if ( InStr(部材名(i), "杭") = 0 ) {
            //            }
            //        }
                /////////////////////////////////////////////////// 分布ばねマーク 13/11/26
            //////////////
                DummyY2 = 9999
                if ( Foot_Flg = 0 ) {   /////////// 固定のマーク
                    X1 = HEN_X(節X(部J(1))) - 150
                    y1 = HEN_Y(節Y(部J(1)))
                    X2 = HEN_X(節X(部J(1))) + 150
                    Y2 = HEN_Y(節Y(部J(1)))
                    DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(X1), CSng(y1), CSng(X2), CSng(Y2))
                    }
                    .PenWidth = 部材Pen幅 - 10
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(.PenWidth))
                    }
                    For( i = 1 To 4
                        X1 = HEN_X(節X(部J(1))) - 130 + i * 60
                        y1 = HEN_Y(節Y(部J(1)))
                        X2 = HEN_X(節X(部J(1))) - 200 + i * 60
                        Y2 = HEN_Y(節Y(部J(1))) + 70
                        DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(X1), CSng(y1), CSng(X2), CSng(Y2))
                        }
                    }
                    .PenWidth = 部材Pen幅 + 12
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(.PenWidth))
                    }
                } else {
                    /////////// 支点のマーク
                    this.支点Mark(CaseP) //CInt(CaseP)) ////////// nagase
                    /////////// 支点のマーク end
            //
            if ( Not (g連続Mod $$ iKozo = 3) ) {
            if ( (CASN >= 0 $$ (部材_max > 40 || g柱本数 < 2)) ) { ////////多分ｱｰﾁ 10/03/07
                return;
            }
            }

            }
            End With

            this.s軸線寸法表示(CASN, CaseP, KUIHON, brFlg)

            BuzaiGAri = 0
            /*/
        }

        private void s軸線寸法表示(int CASN, int CaseP, int KUIHON, bool brFlg)
        {
            /*
            var Dummy寸法()
            var Dummy9寸法()
            double var DummyX()
            double var DummyY()
            var i                       As Integer
            var j                       As Integer
            var GHGH                    As Single
            var UpDownFlag()            As Integer
            var X1
            var y1
            var X2
            var Y2
            var ZFX
            var ZFY
            var AFX
            var AFY
            var MOJ
            double var X()
            double var Y()
            var Dn1()                   As Integer
            var Dn2()                   As Integer
            var 寸法()
            var 寸法9()
            var NN1                     As Integer
            var NN2                     As Integer
            var st                      As Integer
            var YY0                     As Single
            var YY1                     As Single
            var Yy2                     As Single
            var Yz1                     As Single
            var Yz2                     As Single
            var bOutput1                As Boolean
            var bOutput2                As Boolean
            var EE                      As Integer
            var SSAA                    As Variant
            var FAFA(1000)              As Variant
            var HIH                     As Integer
            var GGII                    As Integer
            var GGjj                    As Integer
            var yHosei                  As Single
            var CheckFgFg               As Single
            var ATTAFLAG                As Single
            var KANAZ                   As Single
            var DummyY2                 As Single
            var y本数位置               As Single
            var ASF1                    As Single
            var LL As Single
            var XX9 As Single, yy9 As Single, LL9 As Single, HH9 As Single, JJ9 As Single
            var 杭奥行き本数   As Integer
            var KKK As Integer ////////////////////////////////// 05/02/07
            var yyy As Single //////////////////////////////////// 05/02/07
            var rFlg As Integer
            var GGG As Integer
            var bKUI As Integer
            KKK = -1
            rFlg = 0
            bKUI = 0
            //
            if ( iKozo = 3 $$ Not g連続Mod $$ CASN >= 0 ) { return;
            //    if ( iKozo = 3 $$ Abs(YY_max - YY_min) < 0.01 ) {
            //        iKozo = 1 ////////連続梁////////// 03/10/04
            //    }
            this.UpDownFlag(部材_max)
            this.Dummy寸法(1000) //////////09/10/05
            this.Dummy9寸法(1000)
            this.DummyX(1000)
            this.DummyY(1000)
            this.寸法9(1000) //////////09/10/05
            //
            this.GFLAG(2000)
            //
            var SUIHEIKATAN As Single
            SUIHEIKATAN = 水平部材最下端
            if ( 水平部材最下端 = 99999 ) {
                if ( 下層BUZAI(0, 0) != 0 ) {
                    SUIHEIKATAN = 節Y0(下層BUZAI(1, 1))
                }
            }
            //    return;
            //============================================================================================
            With frmPrint.vsPrt1
                                    For( i = 1 To 部材_max //1000
                                        FBuzaiNumber1(i) = 0
                                        FBuzaiNumber2(i) = 0
                                    }

                    if ( CASN < 0 || (iKozo = 1 $$ CaseP = 1) || (iKozo = 3 $$ g連続Mod) || (iKozo = 3 $$ Abs(YY_max - YY_min) >= 0.01 $$ CaseP = 1) ) { //////// 05/01/29
                        this.Dn1(Jn_max * 2) //////09/11/02
                        this.Dn2(Jn_max * 2)
                        this.getOuterPoint_kairyo(節X0(), 節Y0(), 部材_max, 部I(), 部J(), X1, X2, y1, Y2)
                        if ( ((y1 = Y2 $$ y1 != YY_max) $$ Not (RR橋脚 = 1 $$ CASN < 0)) ) {
                            bOutput1 = False
                            bOutput2 = True
                            JouhouSunpouCalcFlag = 0
                            this.varPointSelect_Kairyou(3, Jn_max, 節X0(), 節Y0(), 部材_max, 部I(), 部J(), 部材名(), ZZBuzaiBai(), NN2, Dn2(), FBuzaiNumber2(), wRR(), YMin杭無)
                            if ( NN2 < 2 ) {
                                bOutput2 = False
                            }
                        } else {
                            JouhouSunpouCalcFlag = 1
                            if ( iKozo = 2 $$ CASN < 0 $$ NKUI > 0 ) { //////13/11/16
                                this.varPointSelect_Kairyou(1, Jn_max, 節X0(), 節Y0(), 部材_max, 部I(), 部J(), 部材名(), ZZBuzaiBai(), NN1, Dn1(), FBuzaiNumber1(), wRR(), YY_max, 1, iKozo) //////13/04/08
                                Dn1(2) = 1
                                Dn1(3) = Dn1(NN1)
                                NN1 = 3
                            } else {
                                if ( iKozo = 3 ) {
                                    this.varPointSelect_Kairyou(1, Jn_max, 節X0(), 節Y0(), 部材_max, 部I(), 部J(), 部材名(), ZZBuzaiBai(), NN1, Dn1(), FBuzaiNumber1(), wRR(), IIf(階段Mod, YY_min, IIf((YY_max - YY_min) < 2, YY_max, (YY_max - YY_min) / 2)), 1, iKozo) //////13/04/08
                                } else {
                                    this.varPointSelect_Kairyou(1, Jn_max, 節X0(), 節Y0(), 部材_max, 部I(), 部J(), 部材名(), ZZBuzaiBai(), NN1, Dn1(), FBuzaiNumber1(), wRR(), IIf(階段Mod, -99, YMin杭無), 1, iKozo) //////13/04/08
                                    if ( NN1 = 0 ) {
                                        this.varPointSelect_Kairyou(1, Jn_max, 節X0(), 節Y0(), 部材_max, 部I(), 部J(), 部材名(), ZZBuzaiBai(), NN1, Dn1(), FBuzaiNumber1(), wRR(), YY_max, 1, iKozo) //////水平部材最上端  JY_max
            //                                if ( NN1 = 0 $$ 水平部材最上端 < JY_max $$ y水平CUNT > 0 ) {
            //                                    NN1 = NN1 + 1
            //                                    bOutput1 = True
            //                                    For( i = 1 To y水平CUNT
            //                                        wRR(NN1) = 水平BUZAI(i) // = 部I(M)
            //                                        FBuzaiNumber1(NN1) = 水平BUZAIM(i)
            //                                        NN1 = NN1 + 1
            //                                        wRR(NN1) = 水平BUZAI(i + 1) // = 部J(M)
            //                                    }
            //                                }
                                    }
                                }
                            }
                            JouhouSunpouCalcFlag = 2
                            ////////07/12/31
                            if ( iKozo = 3 $$ g連続Mod ) {  //////And YY_max - YY_min < 2 ) {
                                this.varPointSelect_Kairyou2(3, Jn_max, 節X0(), 節Y0(), 部材_max, 部I(), 部J(), NN2, Dn2(), _
                                     FBuzaiNumber2(), wRR(), YY_max, 999, 下層BUZAI(), DummyY2, 1, iKozo) //////09/02/20//////NKUI)
                            } else {
                                this.varPointSelect_Kairyou2(3, Jn_max, 節X0(), 節Y0(), 部材_max, 部I(), 部J(), NN2, Dn2(), _
                                     FBuzaiNumber2(), wRR(), YY_max, YMin杭無, 下層BUZAI(), DummyY2, 1, iKozo) //////09/02/20//////NKUI)
                            }
                            if ( NN1 <= 1 $$ NN2 <= 0 $$ y水平CUNT > 0 ) { ////// $$ 柱間離れ(1) + 柱間離れ(2) = 0
                                NN1 = y水平CUNT + 1
                                For( KANAZ = 1 To NN1 - 1
                                Dn1(KANAZ) = 水平BUZAI(KANAZ) ////// 部I(M)
                                Dn1(KANAZ + 1) = 水平BUZAI(KANAZ + 1) ////// 部J(M)
                                Next
                            }
                            DummyY2 = 9999
                            For( KANAZ = 1 To 部材_max
                                if ( ZZBuzaiBai(KANAZ) != 0 ) {
                                    if ( ZFAngle(KANAZ) = 0 ) {
                                        DummyY2 = SSMin(CSng(節Y0(部I(KANAZ))), DummyY2)
                                        DummyY2 = SSMin(CSng(節Y0(部J(KANAZ))), DummyY2)
                                    }
                                }
                            }ANAZ
                            JouhouSunpouCalcFlag = 0
                            bOutput1 = False
                            bOutput2 = False
                            if ( NN1 > 1 ) {
                                bOutput1 = True
                            }
                            if ( NN2 > 1 ) {
                                bOutput2 = True
                            }
                            if ( NN2 = NN1 $$ NN2 > 1 ) {
                                if ( FR橋脚 = 1 $$ 下層BUZAI(0, 0) = 0 ) {
                                    bOutput2 = False
                                    For( i = 1 To NN1
                                        if ( 節X(Dn2(i)) != 節X(Dn1(i)) ) {
                                            bOutput2 = True
                                            Exit For
                                        } else {
                                            if ( Dn2(i) != Dn1(i) ) {
                                                bOutput2 = True
                                                Exit For
                                            }
                                        }
                                    Next
                                    if ( bOutput2 = False ) { ////////////08/01/10
                                        yHosei = 0
                                        For( i = 1 To NN1
                                            if ( 節Y(Dn1(i)) = YY_min $$ YY_max = YY_min ) {
                                                yHosei = yHosei + 1
                                            }
                                        Next
                                        if ( yHosei = NN1 ) {
                                            bOutput2 = True
                                            bOutput1 = False
                                        }
                                        yHosei = 0
                                    }
                                } else {
            //                            bOutput1 = False //////15/12/23 コメントにした
            //                            For( i = 1 To NN1
            //                                if ( 節X(Dn2(i)) != 節X(Dn1(i)) ) {
            //                                    bOutput1 = True
            //                                    Exit For
            //                                }
            //                            Next
                                }
                            }
                        }
                        if ( iKozo = 1 $$ CASN >= 0 ) {
                            bOutput1 = True
                            bOutput2 = True
                        }
                        if ( iKozo = 2 $$ CASN < 0 $$ NKUI > 0 ) { //////13/11/16
                            bOutput1 = True
                            bOutput2 = True
            //                    NN2 = NN1
            //                    For( i = 1 To NN1
            //                        Dn2(i) = Dn1(i)
            //                    }
                        }
                         ////////////ｼﾝｸﾞﾙ で 横書き //////////////04/07/06
                        if ( (iKozo = 1 $$ CASN = 0 $$ NKUI = 0) ) {
                            bOutput2 = False ////////////////////////////////////////////////////////////06/03/08
                        }
                        if ( iKozo = 3 $$ g連続Mod ) {  ////////連続梁////////// 05/01/29
                            bOutput1 = False
                            bOutput2 = True
                            if ( NN2 < NN1 ) {
                                if ( NN1 < 2 ) { NN1 = 2 ////////09/11/13
                                if ( NN1 != 0 $$ NN2 < 2 ) { ////////09/11/13
                                    NN2 = NN1
                                    For( i = 1 To NN2
                                        Dn2(i) = Dn1(i)
                                    }
                                }
                            }
                            if ( CASN < 0 ) {
                                yHosei = 5
                            }
                            if ( CASN = 0 ) {
                                yHosei = 6
                            }
                        }
                        if ( DummyY2 = 9999 ) {
                        } else {
                            Y2 = DummyY2
                        }
                        if ( Not (iKozo = 3 $$ g連続Mod) ) {
                            if ( CASN >= 0 $$ sYscale != 1 ) {
                                bOutput1 = False
                                if ( NKUI = 0 ) { bOutput2 = False ////// 05/05/29
                            }
                        }
            var BOXだよ As Integer
            BOXだよ = 0
                if ( CaseP = 1 $$ CASN >= 0 $$ NN1 > 1 $$ iKozo = 3 $$ g連続Mod = False ) { //////09/11/13
                    bOutput1 = True
                    if ( NKUI = 0 ) {
                        bOutput2 = False
                    } else {
                        bOutput2 = True
                    }
                    BOXだよ = 1
                }
            ////////////////////////////////////////////////////////////////////////// 05/02/05
            var CNum As Integer
            var kFlg As Integer //////07/04/24
            var yFig As Integer //////10/11/033
            var dL1 As Single
            var dL2 As Single

            CNum = 0: kFlg = 0: yFig = 0 //////10/11/033
            if ( bOutput1 $$ CASN >= 0 ) {
            For( i = 1 To MQM //部材_max //////////////////// 05/02/07
                if ( 部材正荷重数(上層Buzai(i)) > 20 ) {
                    CNum = 1
                    Exit For
                }
            }
            if ( CNum = 1 ) { bOutput1 = False
            }
            if ( bOutput1 = False $$ CASN < 0 $$ FR橋脚 = 2 $$ g柱本数 > 1 $$ NKUI > 0 ) { ////////10/11/033
                //                g柱X座標(g柱本数, 1) : X
                //                g柱X座標(g柱本数, 2) : I-tan
                //                g柱X座標(g柱本数, 3) = 上端のY
                NN1 = 0
                if ( JX_min != g柱X座標(1, 1) ) {
                    NN1 = NN1 + 1
                    Dn1(NN1) = g柱I_X(1)
                }
                For( i = 1 To g柱本数
                    NN1 = NN1 + 1
                    Dn1(NN1) = g柱X座標(i, 2)
                }
                if ( JX_max != g柱X座標(g柱本数, 1) ) {
                    NN1 = NN1 + 1
                    Dn1(NN1) = g柱I_X(2)
                }
                bOutput1 = True
                yFig = 1
            }
            //////////// 05/02/05
            if ( CASN < 0 $$ iKozo = 1 $$ bOutput1 = True $$ 水平部材最上端 = SUIHEIKATAN $$ 水平部材最上端 != YY_max ) { //////13/11/15 14/01/09
            bOutput1 = False
            bOutput2 = True
            NN2 = NN1
            For( i = 1 To NN1
                Dn2(i) = Dn1(i)
                FBuzaiNumber2(i) = FBuzaiNumber1(i)
            }
            NN1 = 0
            For( i = 1 To Jn_max
                if ( 節Y(i) > (水平部材最上端 + YY_max) / 2 ) {
                    NN1 = NN1 + 1
                    Dn1(NN1) = i
                    FBuzaiNumber1(i) = 0
                }
            }
            if ( NN1 > 1 ) {
                bOutput1 = True
            }
            } else {
            if ( CASN >= 0 ) {
                if ( Not (iKozo = 3 $$ g連続Mod) ) {
                    bOutput1 = False
                }
            }
            }
            var FLG_UUU As Integer, P_UUU As Integer
            FLG_UUU = 0
            var WUW As Integer, XXU() As Single
            this.XXU(部材_max, 0 To 2)
            WUW = 0
            if ( (YU_max > 水平部材最上端) ) { //////And iKozo != 3 ) { ////////////////U型擁壁//////14/08/04
            if ( (水平部材最上端 / Abs(YU_max - 水平部材最上端)) < 0.5 $$ YU_max / 2 > 水平部材最上端 ) {
                For( i = 1 To 部材_max
                    if ( 節X(部I(i)) = 節X(部J(i)) ) {
                        if ( 節Y(部I(i)) > 水平部材最上端 || 節Y(部J(i)) > 水平部材最上端 ) {
                            P_UUU = 0
                            if ( WUW > 0 ) {
                                For( P_UUU = 1 To WUW
                                    if ( XXU(P_UUU, 1) = 節X(部I(i)) ) {
                                        if ( XXU(WUW, 2) < max(節Y(部I(i)), 節Y(部J(i))) ) {
                                            XXU(WUW, 0) = IIf(節Y(部I(i)) > 節Y(部J(i)), 部I(i), 部J(i))
                                            XXU(WUW, 2) = max(節Y(部I(i)), 節Y(部J(i)))
                                        }
                                        P_UUU = 0
                                        Exit For
                                    }
                                Next
                            }
                            if ( WUW = 0 || P_UUU > WUW ) {
                                WUW = WUW + 1
                                XXU(WUW, 0) = IIf(節Y(部I(i)) > 節Y(部J(i)), 部I(i), 部J(i))
                                XXU(WUW, 1) = 節X(部I(i))
                                XXU(WUW, 2) = max(節Y(部I(i)), 節Y(部J(i)))
                            }
                        }
                    }
                }
                if ( WUW > 1 ) {
                    if ( NN2 = 0 ) {
            //                y最低CUNT = y最低CUNT + 1
            //                下層BUZAI(y最低CUNT, 1) = M
            //                下層BUZAI(y最低CUNT, 2) = 部I(M)
            //                下層BUZAI(y最低CUNT, 3) = 部J(M)

                        For( i = 1 To y最低CUNT
                            Dn2(i) = 下層BUZAI(i, 2)
                        }
                        i = y最低CUNT + 1
                        Dn2(i) = 下層BUZAI(y最低CUNT, 3)
                        NN2 = i
            //                NN2 = NN1
            //                For( i = 1 To NN1
            //                    Dn2(i) = Dn1(i)
            //                }
                    }
                    NN1 = WUW
                    For( i = 1 To WUW
                        Dn1(i) = XXU(i, 0)
                    }
                    if ( CASN < 0 ) {
                        if ( NN1 > 1 ) { FLG_UUU = 1
                        if ( NN1 > 1 ) { bOutput1 = True
                        if ( NN2 > 1 ) { bOutput2 = True
                    } else {
                        bOutput1 = False
                        bOutput2 = False
                    }
                }
            }
            }
                        if ( bOutput1 $$ RR橋脚 != 2 ) { //                 水平　上 --------------------------①
                            if ( (iKozo = 2 || CASN < 0) || (iKozo != 1 $$ CaseP = 1) ) {
                                if ( gouikidddd = 1 ) { //And Atta寸法 = 1 ) { //////////////////////////////08/11/27
                                    this.X(NN1)
                                    this.Y(NN1)
                                    this.寸法(NN1)
            //                            this.寸法9(NN1)
                                    YY0 = YY_max
                                    if ( CASN < 0 ) {
                                        if ( YY_max = 0 $$ YY_min = 0 ) {
                                            YY1 = -10 + 1 - 5
                                            Yy2 = -8 + 1
                                            if ( iKozo = 1 ) {
                                                YY0 = YY_max // - 3
                                            }
                                        } else {
                                            YY1 = -4
                                            Yy2 = -7
                                            if ( iKozo = 1 || iKozo = 3 || NKUI != 0 ) { ////////09/12/25//////Or iKozo = 3 ) { ////////08/01/24
                                                YY0 = YY_max + min(1, (100 * 図Y_SCALE * 3)) * 1.3 // min(3, Abs(YY_max + YY_min) / 2) //YY_max + 3 ////////////////////06/08/21
                                                if ( iKozo = 2 || yFig = 1 ) { //////10/11/033
                                                    YY0 = SUIHEIKATAN + (YY_max - SUIHEIKATAN) / IIf(iKozo = 2, 10, 3)
                                                }
                                                if ( YY_min < 0 $$ NKUI = 0 $$ (100 * 図Y_SCALE) > 0.3 ) {
                                                    YY0 = YY0 - (0.1 / 図Y_SCALE / Twip) / 4
                                                }
                                                if ( NKUI != 0 ) { //////09/11/13//////And (100 * 図Y_SCALE) > 0.5 ) { ////////////08/02/07
                                                    if ( (100 * 図Y_SCALE) > 0.5 ) {
                                                        YY0 = YY0 + 2
                                                    } else {
                                                        if ( (100 * 図Y_SCALE) < 0.35 ) { //////10/01/17
                                                            if ( iKozo != 1 ) {
                                                                if ( iKozo = 2 ) {
                                                                    YY0 = YY0 + 1.5
                                                                } else {
                                                                    YY0 = YY0 - IIf((100 * 図Y_SCALE) < 0.2, 1, 1.5) //////10/01/17//////////13/04/01
                                                                }
                                                            }
                                                        } else {if ( (100 * 図Y_SCALE) < 0.45 ) { //////10/04/04
            //                                                    YY0 = YY0 - 1
                                                        } else {
                                                            YY0 = YY0 + 1 //////09/11/13
                                                        }
                                                    }
                                                }
                                                SSAA = 0 ////////08/06/245
                                                For( i = 1 To NN1
                                                    SSAA = SSAA + 1
                                                    if ( FBuzaiNumber1(i) <= 0 || FBuzaiNumber1(i) > 部材_max ) {
                                                        FAFA(SSAA) = 0
                                                    } else {
                                                        FAFA(SSAA) = FBuzaiNumber1(i)
                                                    }
                                                }
                                                ATTAFLAG = 0
                                                For( i = 1 To NN1 - 1
                                                    if ( ILineG(FAFA(i)) > 0 || JLineG(FAFA(i)) > 0 ) {
                                                        ATTAFLAG = ATTAFLAG + 1
                                                        Exit For
                                                    }
                                                }
                                                if ( (100 * 図Y_SCALE) < 0.2 ) { //////10/01/30
                                                    if ( YY0 < 1.6 ) { YY0 = ((0.1 / 図Y_SCALE / Twip) / 3) // + 2 //////15/07/15
                                                    YY1 = -6
                                                    Yy2 = (-YY0 / 2 - 5) - IIf(ATTAFLAG = 1, YY0 / 2, 3) - 6
                                                } else {
                                                    YY1 = -4
                                                    Yy2 = (-YY0 / 2 - 5) - IIf(ATTAFLAG = 1, YY0 / 2, 3) ////////08/11/27 -3を+3
                                                }
                                                if ( Yy2 < -20 ) {
                                                    if ( Yy2 < -50 ) {
                                                        Yy2 = -12
                                                    } else {
                                                        Yy2 = -20 ////////09/06/04
                                                    }
                                                }
                                                //
                                                if ( YY_max - max(節Y(Dn1(1)), 節Y(Dn1(NN1))) > 4 ) { //////08/08/15
                                                    Yy2 = -10 - IIf(ATTAFLAG = 1, YY0 / 2 + 1, -2.5) ////////09/08/03
                                                } else {if ( 節Y(Dn1(1)) = 0 || (YY_max - YY_min) / 4 > 節Y(Dn1(1)) ) { //////08/11/27
            //                                            Yy2 = Yy2 - 10
                                                    Yy2 = -10 - IIf(ATTAFLAG = 1, YY0 / 2 + 1, 0) - 4 //////08/11/27
                                                    YY0 = YY0 + 1 //////13/06/08
                                                }
                                                if ( 水平部材最上端 = SUIHEIKATAN ) {  //////13/11/15
                                                    YY0 = YY_max + 1
            //                                            if ( iKozo = 1 $$ (YY_max - YY_min) < 8 $$ _
            //                                               ((JX_max - JX_min) / (YY_max - YY_min)) > 1.5 $$ 部材_max < 6 ) { //////14//01/09
                                                    if ( iKozo = 1 ) { //////And 部材_max < 6 ) {
                                                        YY0 = 水平部材最上端 + 1
            //                                                Yy2 = -10
                                                    } else {if ( iKozo = 2 ) {
                                                        YY0 = 水平部材最上端 + 2.8 //////16/07/15 コメントにした
                                                        Yy2 = -10
                                                    }
                                                    if ( YY0 > 20 $$ 水平部材最上端 = YU_max ) {
                                                        YY0 = YY0 + 4 //////16/09/30
                                                        Yy2 = -16
                                                    }
                                                } else {
                                                    if ( (YU_max > 水平部材最上端) $$ Yy2 < -20 ) { //////14/09/27
                                                        if ( Abs(Yy2) > ((YU_max - 水平部材最上端) / 図Y_SCALE / Twip / 1.5) ) {
                                                            Yy2 = Yy2 + ((YU_max - 水平部材最上端) / 図Y_SCALE / Twip / 1.5)
                                                        } else { //////14/11/07
                                                            if ( ((YU_max - 水平部材最上端) / 図Y_SCALE / Twip) > 40 ) {
                                                                YY0 = (YU_max + 水平部材最上端) / 2.2
                                                            }
                                                        }
                                                    }
                                                }
                                            } else {if ( iKozo = 3 ) {
                                                YY0 = 水平部材最上端 + min(0.1, (100 * 図Y_SCALE)) + (YY_max - 水平部材最上端) / 3 ////13/04/177//////YY_max + min(0.1, (100 * 図Y_SCALE))
                                                if ( YY_min < 0 ) {
                                                    YY0 = 水平部材最上端 + min(水平部材最上端 / 1.5, (0.05 / 図Y_SCALE / Twip) / 2) // + (YY_max - 水平部材最上端) / 3 ////13/04/177
                                                } else {
                                                    YY0 = 水平部材最上端 + min(0.1, (0.2 / 図Y_SCALE / Twip)) + (YY_max - 水平部材最上端) / 3 ////13/04/177
                                                }
                                                if ( 階段Mod $$ YY_max > 階段水平部材最上端 $$ 階段水平部材最上端 != -99999 ) {
                                                    YY0 = YY0 + (YY_max - 階段水平部材最上端) / 2
                                                }
                                                if ( iKozo = 3 $$ YY0 > 8 ) { //////////////12/12/15
                                                    YY1 = (-10 + 1 + 5 + 3 - 1) - 3
                                                    Yy2 = (-8 + 1 - 10 + 3 - 1) - 3
                                                    YY0 = YY0 + 1.3 //////////13/11/09 ////// + 3
                                                } else {
                                                    YY1 = (-10 + 1 + 5 + 3 - 1) - IIf(YY0 > 8, YY0 / 2, 0)  //////10/01/24
                                                    Yy2 = (-8 + 1 - 10 + 3 - 1) + IIf(YY0 > 8, YY0 / 3, 0)
                                                    if ( ((YY0 - 水平部材最上端) / 図Y_SCALE) > 5000 ) {
                                                        YY0 = 水平部材最上端 + 0.22
            //                                                YY2 = -3
                                                    } else {if ( 階段Mod ) {
                                                        YY0 = 水平部材最上端 + 0.3
                                                    }
                                                }
                                            }
                                        }
                                    } else {
                                        if ( YY_max = 0 $$ YY_min = 0 ) {
                                            YY1 = -15 + 1
                                            Yy2 = -10
                                        } else {
                                            YY1 = -15 + 1
                                            Yy2 = -10 - 4
                                            if ( BOXだよ = 1 ) { //////09/11/13
                                                if ( 荷重図フォーマット.int用紙方向 = 0 $$ KUIHON <= 2 ) {
                                                    YY1 = -15 + 2
                                                    Yy2 = -9 - 5
                                                } else {
                                                    YY1 = -15 + 2 + 3
                                                    Yy2 = -9 - 5 + 3
                                                }
                                            }
                                            if ( 水平部材最上端 = 水平部材最下端 ) {  //////13/11/15
                                                YY0 = YY_max + 1
                                            }
            //                                    if ( iKozo = 3 ) {
            //                                        YY1 = -15 + 2
            //                                        Yy2 = -9 - 5
            //                                        if ( 荷重図フォーマット.intレイアウト != 0 ) { //Or 荷重図フォーマット.intレイアウト = 1 ) {
            //                                            YY1 = YY1 + 7
            //                                        }
            //                                    }
                                        }
                                    }
            if ( (YU_max > 水平部材最上端) $$ WUW > 1 ) {
            YY0 = JY_max + 0.3
            YY1 = -6
            //    Yy2 = YY0 * (-3) //////-10
            } else {
            if ( FLG_UUU = 1 ) { //////14/08/04
                YY0 = YY_max + 0.5
                YY1 = -6
                Yy2 = YY0 * (-3) //////-10
            } else {
                if ( (YY0 - YY_max) < 4 ) {
                    if ( (YY0 = 0 $$ YY_max = 0) ) { //////16/12/20
                        YY0 = JY_max + 1
                        YY1 = -6 + 2
                        Yy2 = YY0 * (-2) + 1 //////-10
                    } else {
                        if ( iKozo = 1 ) {
                                YY0 = YY0 + (YY0 - YY_max) / 5
                                YY1 = -6 + 2 * 0
                                Yy2 = YY0 * (-1) + 2 //////-10
                        } else {
                            if ( iKozo = 3 ) {
                                YY0 = YY0 - (YY0 - YY_max) / 4
                                YY1 = -6 + 3
                                Yy2 = YY0 * (-1.5) + 1 //////-10
                                Yy2 = 20 * (-1) //////////17/07/20
                            } else {
                                YY0 = YY_max + (YY0 - YY_max) / 1.5
                                YY1 = -6 - 3
                                Yy2 = -18 //////YY0 * (-1.5) + 1 //////-10
                            }
                        }
                    }
                } else {
                    if ( iKozo = 1 ) {
                        YY0 = IIf(JY_max > 5, JY_max - 1, 5)
                        YY1 = -6 - 0.5
                        if ( BuzaiSunpouSenWriteFlag = 1 ) {
                            Yy2 = YY0 * (-1.8)
                        } else {
                            Yy2 = YY0 * (-1)
                        }
                    } else {
                        YY0 = YY0 - (YY0 - YY_max) / 10 * 1.5
                        YY1 = -6
                        Yy2 = YY0 * (-1.5)
                    }
                }
            }
            }
                                    st = 1
                                    For( i = st To NN1
                                        X(i) = HEN_X(節X(Dn1(i)))
                                        Y(i) = HEN_Y(YY0)
            //                                if ( i < NN1 $$ YY0 > (YY_max - YMin杭無) / 2 ) {
                                        if ( i < NN1 ) {
                                            if ( Dn1(i + 1) <= Jn_max $$ (FBuzaiNumber1(i) != 0 || 節X0(Dn1(i + 1)) > 節X0(Dn1(i))) ) { //////08/01/04
                                                寸法(i) = F2(Abs(節X0(Dn1(i + 1)) - 節X0(Dn1(i))))
                                                寸法9(i) = F2(Abs(節X0(Dn1(i + 1)) - 節X0(Dn1(i))))
                                            }
                                        }
                                    }
                                    SSAA = 0
                                    CheckFgFg = 0
                                    For( i = st To NN1 - 1
                                        GGII = Dn1(i)
                                        GGjj = Dn1(i + 1)
                                        For( HIH = 1 To 部材_max
                                            if ( ZZBuzaiBai(HIH) != 0 ) {
                                            if ( (ILineGX(HIH) = GGII $$ JLineGX(HIH) = GGjj) || (ILineGX(HIH) = GGjj $$ JLineGX(HIH) = GGII) ) {
                                            } else {
                                                CheckFgFg = 1
                                                Exit For
                                            }
                                            }
                                        Next HIH
                                        if ( CheckFgFg = 1 ) {
                                            Exit For
                                        }
                                    }
            //                            For( i = 1 To 部材_max //1000
            //                                FBuzaiNumber1(i) = 0
            //                                FBuzaiNumber2(i) = 0
            //                            }
                                    if ( BuzaiSunpouSenWriteFlag = 1 $$ CASN < 0 ) { ////09/12/25////And CASN <= 0 ) {
                                        if ( CheckFgFg = 1 $$ Dn1(st) = 0 ) {
                                            CheckFgFg = 0
                                        }
                                        if ( CheckFgFg = 1 ) {
            //                                    For( i = ST To NN1 - 1
            //                                        For( j = 1 To 部材_max
            //                                            if ( ZZBuzaiBai(j) != 0 $$ Not (AngleDF1[j] = 90 || AngleDF1[j]] = 270 ] { ////////06/03/07 水平部材
            //                                            if ( i = NN1 - 1 ) {
            //                                                if ( Dn1(i + 1) = FBuzaiJ(j) ) {
            //                                                    FBuzaiNumber1(i) = j
            ////                                                    Exit For
            //                                                }
            //                                            } else {
            //                                                if ( Dn1(i) = FBuzaiI(j) || Dn1(i) = FBuzaiJ(j) ) {
            //                                                    FBuzaiNumber1(i) = j
            ////                                                    Exit For
            //                                                }
            //                                            }
            //                                            }
            //                                        }
            //                                    }
                                            For( i = st To NN1 // - 1
                                                SSAA = SSAA + 1
                                                if ( FBuzaiNumber1(i) <= 0 || FBuzaiNumber1(i) > 部材_max ) { ////////08/01/099
                                                    FAFA(SSAA) = 0
                                                } else {
                                                    FAFA(SSAA) = FBuzaiNumber1(i)
                                                    if ( FAngle(FAFA(SSAA)) = 180 ) {
                                                        UpDownFlag(FAFA(SSAA)) = -1
                                                    } else {
                                                        UpDownFlag(FAFA(SSAA)) = 1
                                                    }
                                                }
                                            }
                                        } else {
                                            For( i = st To NN1 - 1
                                                GGII = Dn1(i)
                                                GGjj = Dn1(i + 1)
                                                For( HIH = 1 To 部材_max
                                                    if ( ZZBuzaiBai(HIH) != 0 ) {
                                                    if ( (ILineGX(HIH) = GGII $$ JLineGX(HIH) = GGjj) || (ILineGX(HIH) = GGjj $$ JLineGX(HIH) = GGII) ) {
                                                        SSAA = SSAA + 1
                                                        FAFA(SSAA) = HIH
                                                        if ( (ILineGX(HIH) = GGII $$ JLineGX(HIH) = GGjj) ) {
                                                            UpDownFlag(FAFA(SSAA)) = 1
                                                        }
                                                        if ( (ILineGX(HIH) = GGjj $$ JLineGX(HIH) = GGII) ) {
                                                            UpDownFlag(FAFA(SSAA)) = -1
                                                        }
                                                        Exit For
                                                    }
                                                    }
                                                Next HIH
                                            }
                                        }
                                        SSAA = 0
                                        //
                                        ATTAFLAG = 0
                                        For( i = 1 To NN1 - 1
                                            if ( ILineG(FAFA(i)) > 0 || JLineG(FAFA(i)) > 0 ) {
                                                ATTAFLAG = ATTAFLAG + 1
                                            }
                                        }
                                        For( i = 1 To NN1 - 1
            //                                    if ( ILineG(FAFA(i)) > 0 || JLineG(FAFA(i)) > 0 ) {
                                            //////08/01/099
                                            if ( FAFA(i) > 0 $$ ((ILineG(FAFA(i)) > 0 || JLineG(FAFA(i)) > 0)) $$ _
                                               ZBuzaiLength(FAFA(i)) != ILineG(FAFA(i)) + JLineG(FAFA(i)) ) {
                                                dL1 = Round(ILineG(FAFA(i)) * 斜比(FAFA(i), 1), 3) ////////07/12/31
                                                dL2 = Round(JLineG(FAFA(i)) * 斜比(FAFA(i), 1), 3)
                                                if ( ILineG(FAFA(i)) > 0 $$ JLineG(FAFA(i)) > 0 ) {
                                                    if ( UpDownFlag(FAFA(i)) = 1 ) {
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = HEN_X(節X(Dn1(i)))
                                                        DummyY(SSAA) = HEN_Y(YY0)
                                                        Dummy寸法(SSAA) = F2(dL1) //////////Abs(ILineG(FAFA(i))))
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = HEN_X(節X(Dn1(i)) + dL1) //////ILineG(FAFA(i)))
                                                        DummyY(SSAA) = HEN_Y(YY0)
                                                        Dummy寸法(SSAA) = F2(Abs(節X(Dn1(i + 1)) - 節X(Dn1(i)) - dL1 - dL2)) //////JLineG(FAFA(i)) - ILineG(FAFA(i))))
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = HEN_X(節X(Dn1(i + 1)) - dL2) //////JLineG(FAFA(i)))
                                                        DummyY(SSAA) = HEN_Y(YY0)
                                                        Dummy寸法(SSAA) = F2(Abs(dL2)) //////JLineG(FAFA(i))))
                                                    } else {
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = HEN_X(節X(Dn1(i)))
                                                        DummyY(SSAA) = HEN_Y(YY0)
                                                        Dummy寸法(SSAA) = F2(Abs(dL2)) //////JLineG(FAFA(i))))
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = HEN_X(節X(Dn1(i)) + dL2) //////JLineG(FAFA(i)))
                                                        DummyY(SSAA) = HEN_Y(YY0)
                                                        Dummy寸法(SSAA) = F2(Abs(節X(Dn1(i + 1)) - 節X(Dn1(i)) - dL1 - dL2)) ////// JLineG(FAFA(i)) - ILineG(FAFA(i))))
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = HEN_X(節X(Dn1(i + 1)) - dL1) //////ILineG(FAFA(i)))
                                                        DummyY(SSAA) = HEN_Y(YY0)
                                                        Dummy寸法(SSAA) = F2(Abs(dL1)) //////ILineG(FAFA(i))))
                                                    }
                                                } else {
                                                    if ( ILineG(FAFA(i)) > 0 ) {
                                                        if ( UpDownFlag(FAFA(i)) = 1 ) {
                                                            SSAA = SSAA + 1
                                                            GFLAG(SSAA) = 1
                                                            DummyX(SSAA) = HEN_X(節X(Dn1(i)))
                                                            DummyY(SSAA) = HEN_Y(YY0)
                                                            Dummy寸法(SSAA) = F2(Abs(dL1)) //////ILineG(FAFA(i))))
                                                            SSAA = SSAA + 1
                                                            GFLAG(SSAA) = 1
                                                            DummyX(SSAA) = HEN_X(節X(Dn1(i)) + dL1) //////ILineG(FAFA(i)))
                                                            DummyY(SSAA) = HEN_Y(YY0)
                                                            Dummy寸法(SSAA) = F2(Abs(節X(Dn1(i + 1)) - 節X(Dn1(i)) - dL1)) //////ILineG(FAFA(i))))
                                                        } else {
                                                            SSAA = SSAA + 1
                                                            GFLAG(SSAA) = 1
                                                            DummyX(SSAA) = HEN_X(節X(Dn1(i)))
                                                            DummyY(SSAA) = HEN_Y(YY0)
                                                            Dummy寸法(SSAA) = F2(Abs(節X(Dn1(i + 1)) - 節X(Dn1(i)) - dL1)) //////ILineG(FAFA(i))))
                                                            SSAA = SSAA + 1
                                                            GFLAG(SSAA) = 1
                                                            DummyX(SSAA) = HEN_X(節X(Dn1(i + 1)) - dL1) //////ILineG(FAFA(i)))
                                                            DummyY(SSAA) = HEN_Y(YY0)
                                                            Dummy寸法(SSAA) = F2(Abs(dL1)) //////ILineG(FAFA(i))))
                                                        }
                                                    } else {
                                                        if ( JLineG(FAFA(i)) > 0 ) {
                                                            if ( UpDownFlag(FAFA(i)) = 1 ) {
                                                                SSAA = SSAA + 1
                                                                GFLAG(SSAA) = 1
                                                                DummyX(SSAA) = HEN_X(節X(Dn1(i)))
                                                                DummyY(SSAA) = HEN_Y(YY0)
                                                                Dummy寸法(SSAA) = F2(Abs(節X(Dn1(i + 1)) - 節X(Dn1(i)) - dL2)) //////JLineG(FAFA(i))))
                                                                SSAA = SSAA + 1
                                                                GFLAG(SSAA) = 1
                                                                DummyX(SSAA) = HEN_X(節X(Dn1(i + 1)) - dL2) //////JLineG(FAFA(i)))
                                                                DummyY(SSAA) = HEN_Y(YY0)
                                                                Dummy寸法(SSAA) = F2(Abs(dL2)) //////JLineG(FAFA(i))))
                                                            } else {
                                                                SSAA = SSAA + 1
                                                                GFLAG(SSAA) = 1
                                                                DummyX(SSAA) = HEN_X(節X(Dn1(i)))
                                                                DummyY(SSAA) = HEN_Y(YY0)
                                                                Dummy寸法(SSAA) = F2(Abs(dL2)) //////JLineG(FAFA(i))))
                                                                SSAA = SSAA + 1
                                                                GFLAG(SSAA) = 1
                                                                DummyX(SSAA) = HEN_X(節X(Dn1(i)) + dL2) //////JLineG(FAFA(i)))
                                                                DummyY(SSAA) = HEN_Y(YY0)
                                                                Dummy寸法(SSAA) = F2(Abs(節X(Dn1(i + 1)) - 節X(Dn1(i)) - dL2)) //////JLineG(FAFA(i))))
                                                            }
                                                        }
                                                    }
                                                }
                                            } else {
                                                SSAA = SSAA + 1
                                                GFLAG(SSAA) = 0
                                                DummyX(SSAA) = HEN_X(節X(Dn1(i)))
                                                DummyY(SSAA) = HEN_Y(YY0)
                                                Dummy寸法(SSAA) = F2(Abs(節X(Dn1(i + 1)) - 節X(Dn1(i))))
                                            }
                                        }
                                        //
                                        SSAA = SSAA + 1
                                        GFLAG(SSAA) = 1
                                        DummyX(SSAA) = HEN_X(節X(Dn1(NN1)))
                                        DummyY(SSAA) = HEN_Y(YY0)
                                        Dummy寸法(SSAA) = ""
                                    }
                                    .FontSize = 荷重寸法Fontsize
                                    .PenWidth = 部材荷重寸法Pen幅
                                    if ( CreateDxfFlag = 1 ) {
                                        this.PLOTPEN(CSng(.PenWidth))
                                    }
                                    .PenColor = QBColor(部材荷重寸法Pen色)
            if ( FLG_UUU = 1 ) { //////14/08/04
            //     GoTo GRF_UUU
            SSAA = 0
            }
                    if ( iKozo = 1 ) {
                    if ( 水平部材最上端 = 水平部材最下端 ) { //////////////////17/08/07
            //                YY0 = YY0 / 2
                        YY1 = -5.5
                        Yy2 = -17
                    } else {
                        YY0 = IIf(JY_max > 5, JY_max - 1, 5)
                        YY1 = -6.5
                        if ( NN1 != SSAA ) { //////BuzaiSunpouSenWriteFlag = 1 ) {
                            Yy2 = YY0 * (-1.8) * 1.8 ////////17/09/05
                        } else {
                            if ( (100 * 図Y_SCALE * YY0) > 7 ) {
                            Yy2 = YY0 * (-0.5)
                            } else {
                            Yy2 = YY0 * (-0.8)
                            }
                        }
                    }
                    }
                            if ( 階段Mod ) { //////////////////////////17/08/15
                                YY0 = YY_max + 0.5
                                YY1 = -4
                                Yy2 = -12
                            }
                                    if ( SSAA <= 1 ) {
                                        this.SunPou2(">", NN1, YY1, Yy2, 寸法(), X(), Y(), 99) //フレーム
                                    } else {
                                        if ( BuzaiSunpouSenReverse = 1 ) {
                                            if ( ATTAFLAG > 0 ) {
                                                this.CalcMulti(Y(), -7 * OuTouBai)
                                                if ( YY1 = -6.5 ) {
                                                    YY1 = YY1 + 1.3
                                                    Yy2 = Yy2 + 1.8 * Sgn(Yy2)
                            if ( Abs(Yy2) > 17 ) {
                                Yy2 = 17 * Sgn(Yy2) //////Yy2 / 2.5
                            }
                                                }
                                                this.SunPou2(">", NN1, YY1, Yy2, 寸法(), X(), Y(), 99) //フレーム
            //                                        Yy2 = Yy2 - 7 ////////08/07/11//////08/09/22コメントにした
                                                if ( GouikibuzaiIgaiNoSunpou = 1 ) {
                                                    this.SunPou2G(">", CInt(SSAA), YY1, Yy2, Dummy寸法(), DummyX(), DummyY(), 99) //フレーム
                                                } else {
                                                    this.SunPou2(">", CInt(SSAA), YY1, Yy2, Dummy寸法(), DummyX(), DummyY(), 99) //フレーム
                                                }
                                            } else {
                                                if ( YY1 = -6.5 ) {
            //                                            YY1 = YY1 + 1
                                                    Yy2 = Yy2 - 2
                                                }
                                                this.SunPou2(">", NN1, YY1, Yy2, 寸法(), X(), Y(), 99) //フレーム
                                            }
                                            Yy2 = Yy2 + 15 ////////////////////06/08/21
                                        } else {
                                            if ( ATTAFLAG > 0 ) {
                                                this.CalcMulti(DummyY(), -7 * OuTouBai)
                                                this.SunPou2(">", NN1, YY1, Yy2, 寸法(), X(), Y(), 99) //フレーム
                                                if ( GouikibuzaiIgaiNoSunpou = 1 ) {
                                                    this.SunPou2G(">", CInt(SSAA), YY1, Yy2, Dummy寸法(), DummyX(), DummyY(), 99) //フレーム
                                                } else {
                                                    this.SunPou2(">", CInt(SSAA), YY1, Yy2, Dummy寸法(), DummyX(), DummyY(), 99) //フレーム
                                                }
                                            } else {
                                                this.SunPou2(">", NN1, YY1, Yy2, 寸法(), X(), Y(), 99) //フレーム
                                            }
                                        }
                                    }
                                } else {
                                    this.X(NN1)
                                    this.Y(NN1)
                                    this.寸法(NN1)
                                    YY0 = YY_max
                                    if ( CASN < 0 ) {
                                        if ( YY_max = 0 $$ YY_min = 0 ) {
                                            YY1 = 15 + 1
                                            Yy2 = 10
                                        } else {
            //                                    YY1 = -10 + 1 - 5 + 10 - 3
            //                                    Yy2 = YY1 //-8 + 1
            //                                    if ( iKozo = 1 ) {
            //                                        YY0 = YY_max // - 3
            //                                    }
                                            YY1 = -10 + 1 - 5 + 10 - 3
                                            Yy2 = -8 + 1
                                            if ( iKozo = 1 || NKUI != 0 ) {
                                                YY0 = YY_max + 2 //////////////// 07/02/05  min(3, Abs(YY_max + YY_min) / 2) //- 2 //YY_max + 3 ////////////////////06/08/21
                                                YY1 = -10 + 1 + 5 + 3
                                                Yy2 = -(YY0 - YY_max) + YY1 - 10 //-8 + 1 - 10 + 3 ////////////////////06/08/21
                                                //
                                                if ( (YY_max / 図Y_SCALE / Twip) < 30 $$ (-YY_min / 図Y_SCALE / Twip) > 100 ) { //////07/04/24
                                                    YY0 = (35 * (図Y_SCALE * Twip)) ////////YY_max * 2
                                                    if ( YY0 > 2.5 ) { YY0 = 2.5 ////////08/02/25
                                                    YY1 = -10 + 1 + 5 + 3 // - 1
                                                    Yy2 = -(YY0 - YY_max) + YY1 - 10 + 2 // - 3 //-8 + 1 - 10 + 3 ////////////////////06/08/21
                                                    kFlg = 1
                                                }
            //                                        if ( 荷重図フォーマット.int用紙方向 = 1 ) { //////////07/01/19
                                                if ( iKozo = 1 $$ NKUI = 0 ) { //////////07/01/19
                                                if ( YY0 < 10 ) { //////////////////////////////////////////07/08/04
                                                    YY0 = YY0 + 3
                                                    YY1 = YY1 - 3 + 1.5
                                                    Yy2 = Yy2 - 3 + 1.5
                                                    } else {
                                                    YY0 = YY0 + 0.2 //////////////////08/02/07
            //                                            YY1 = YY1 - 3 + 1.5
            //                                            Yy2 = Yy2 - 3 + 1.5
                                                    }
                                                }
                                            } else {if ( iKozo = 3 ) {
            //                                        YY0 = YY_max + 0.1
                                                YY0 = YY_max + 1.5 // + (0.3 / 図Y_SCALE / Twip)
            //                                        if ( YY_max > 0 $$ YY_min < 0 ) {
            //                                            YY0 = YY_max - YY_min
            //                                        }
                                                YY1 = -10 + 1 + 5 + 3 - 1
                                                Yy2 = -8 + 1 - 10 + 3 - 1
                                                if ( NKUI = 0 $$ YY_min < 0 ) {
                                                    YY0 = YY0 + min((-YY_min / 図Y_SCALE / Twip / 30), 0.5) //////07/08/17 - を +
                                                }
                                            }
                                            if ( iKozo = 2 $$ brFlg = 0 $$ kFlg = 0 ) { ////////////////////07/04/24 ////// $$ kFlg = 0 追加
                                                YY1 = -10 + 1 - 5 + 10 - 3
                                                Yy2 = YY1 //-8 + 10
                                                YY0 = min(3, YY_max) // - 3
                                            }
                                        }
                                    } else {
                                        if ( YY_max = 0 $$ YY_min = 0 ) {
                                            YY1 = 15 + 1
                                            Yy2 = 10
                                        } else {
                                            YY1 = -15 + 1
                                            Yy2 = -10
                                            if ( iKozo = 3 ) {
                                                YY1 = -15 + 2
                                                Yy2 = -9
                                                // シングル
            //                                        if ( 荷重図フォーマット.intレイアウト = 1 || 荷重図フォーマット.intレイアウト = 2 || 荷重図フォーマット.intレイアウト = 5 ) {
            //                                            YY1 = YY1 - 7
            //                                        }
                                                if ( sYscale != 1 ) { // シングル  05/05/10
                                                    YY1 = -15 + 2 + 7
                                                    Yy2 = -9
                                                }
                                                if ( 枠縦幅 < 200 ) {
                                                    YY1 = YY1 - 7
                                                }
                                            }
                                        }
                                    }
                                    st = 1
                                    For( i = st To NN1 // - 1
                                        X(i) = HEN_X(節X(Dn1(i)))
                                        Y(i) = HEN_Y(YY0)
            //                                if ( i < NN1 $$ YY0 > (YY_max - YMin杭無) / 2 ) {
                                        if ( i < NN1 ) {
                                            if ( Dn1(i + 1) <= Jn_max $$ (FBuzaiNumber1(i) != 0 || 節X0(Dn1(i + 1)) > 節X0(Dn1(i))) ) {  //////08/01/04
                                                寸法(i) = F2(Abs(節X0(Dn1(i + 1)) - 節X0(Dn1(i))))
                                                寸法9(i) = F2(Abs(節X0(Dn1(i + 1)) - 節X0(Dn1(i))))
                                            }
                                        }
                                    }
                                    .FontSize = 荷重寸法Fontsize
                                    .PenWidth = 部材荷重寸法Pen幅
                                    if ( CreateDxfFlag = 1 ) {
                                        this.PLOTPEN(CSng(.PenWidth))
                                    }
                                    .PenColor = QBColor(部材荷重寸法Pen色)
                                    this.SunPou2(">", NN1, YY1, Yy2, 寸法(), X(), Y(), 99) //フレーム
                                }
                            }
                        }
            //                For( i = 1 To 部材_max //1000 //////////08/01/03
            //                    FBuzaiNumber1(i) = 0
            //                    FBuzaiNumber2(i) = 0
            //                }
            //
            //========================================================================================
            //
            var FLG上 As Integer
            FLG上 = 0
            var MN2() As Integer
            this.MN2(1000)
            MN2(1) = 0
            if ( NN2 > 0 ) {
            For( i = 1 To NN2
                MN2(i) = Dn2(i)
            }
            }
            var FLGTTT As Integer
            FLGTTT = 0
            var zKUI_YZAhyou As Single
            zKUI_YZAhyou = 9999
                this.X(100)
                this.Y(100)
                this.寸法(100)
            if ( 階段Mod ) { GoTo GRF_GRF //////13/04/08
            if ( NKUI != 0 $$ CASN < 0 ) {
                if ( (NKUI = NN2 || NN2 = 0) $$ SSAA = 0 ) {
                    FLGTTT = 1
                    GoTo GRF_33
                }
            }
            if ( NKUI != 0 $$ (SUIHEIKATAN = YY_min || NN2 = 0) $$ CASN < 0 ) {
            //        NN2 = 0
            //        For( i = 1 To 部材_max //////////15/12/20
            //            if ( InStr(部材名(i), "杭") = 1 ) {
            //                NN2 = NN2 + 1
            //                Dn2(NN2) = 部J(i)
            //            }
            //        }
            }
            if ( NKUI != 0 $$ CASN < 0 ) {
                if ( ((水平部材最上端 - SUIHEIKATAN) / 図Y_SCALE) > 2500 ) { //////16/02/20
            //            zKUI_YZAhyou = SUIHEIKATAN
                } else {
                    For( i = 1 To 部材_max //////////15/12/20
                        if ( InStr(部材名(i), "杭") = 1 ) {
                            if ( zKUI_YZAhyou > 節Y(部J(i)) ) {
                                zKUI_YZAhyou = 節Y(部J(i))
                            }
                        }
                    }
                }
            //        if ( 荷重図フォーマット.int用紙方向 = 0 ) {
            //            YY0 = YY_min + 1 + ((0.2 - (k杭長 * 図Y_SCALE * Twip)) / 図Y_SCALE / Twip)
            //            YY1 = 15 + 4 // - 4
            //            Yy2 = 10
                if ( NN2 = NKUI || Abs(zKUI_YZAhyou - YY_min) < 20 ) {
                    if ( (水平部材最上端 - SUIHEIKATAN) = 0 $$ iKozo = 2 $$ NKUI > 0 $$ NN2 != NKUI ) { //////16/07/15
                        YY0 = IIf(NN2 = NKUI, 1, 0.5)
                        YY1 = 15 + 4 - 3
                        Yy2 = 12
                        if ( 水平部材最上端 = YU_max ) { //////16/09/30
                            YY0 = 水平部材最上端 + 3.5
                            YY1 = -8
                            Yy2 = -10
                        }
                        YY0 = 水平部材最上端 - 0.3
                        GoTo ABCD
                    } else {
                        YY0 = IIf(NN2 = NKUI, 1, 0.1) + ((0.2 - (Abs(zKUI_YZAhyou) * 図Y_SCALE * Twip)) / 図Y_SCALE / Twip)
                        YY1 = 15 + 4 // - 4
                        Yy2 = 10
                    }
                    if ( NN2 = NKUI $$ SSAA = 0 ) { ////////17/01/09
                        GoTo ABCD
                    }
                }
            }
            FLGTTT = 1
            ////////////////////////////////////////////////////////////////////////////    水平　下　-----------------②
                        if ( bOutput2 = True $$ (CASN < 0 || Not (iKozo = 1 $$ NKUI != 0 $$ CASN = 0)) ) {
                            if ( gouikidddd = 1 ) { //////10/01/27////////And iKozo != 3 ) { ////////Atta寸法 = 1 ) { //////08/11/277
                                this.X(NN2)
                                this.Y(NN2)
                                this.寸法(NN2)
                                    YY0 = SUIHEIKATAN ////////09/10/14//////////Y2
                                    YY1 = 15 + 3 ////////08/01/03  + 3
                                    Yy2 = 10
                                if ( NKUI != 0 || (SUIHEIKATAN - YY_min) > 5 ) { //////13/04/177
            //                            if ( (Abs(YY0 - (YY_max - YY_min) / 2) / (YY_max - YY_min)) < 0.1 ) {
            //                                YY0 = 0
            //                            }
                                    if ( CASN < 0 ) { ////////09/05/25
                                        YY1 = 17: Yy2 = 8 //////09/10/14
            //                                if ( ((k杭長 * 図Y_SCALE * Twip) < 0.3) ) {
                                        if ( ((SUIHEIKATAN - YY_min) * 図Y_SCALE * Twip) < 1 ) { //////09/10/14
                                            YY0 = YY_min + ((0.2 - (k杭長 * 図Y_SCALE * Twip)) / 図Y_SCALE / Twip)
                                            YY1 = 15 + 4
                                            Yy2 = 10
                                            if ( ((0.3 + (k杭長 * 図Y_SCALE * Twip)) / 図Y_SCALE / Twip) > 12 ) {
                                                if ( iKozo = 2 ) {
                                                    YY0 = YY_min + 2.5
                                                    YY1 = -10 + 2
                                                    Yy2 = -8 + 2
                                                } else {
                                                    YY0 = YY_min + 2.5
                                                    YY1 = -10 - 2.5
                                                    Yy2 = -8 - 1
                                                }
                                            }
                                        } else {
                                            if ( ((SUIHEIKATAN - YY_min) * 図Y_SCALE * Twip) > 4 ) { //////////// 13/04/22
                                                YY0 = SUIHEIKATAN + ((SUIHEIKATAN - YY_min) / 2 / 1.3 * 図Y_SCALE * Twip) //////13/04/177
                                                YY1 = 22: Yy2 = 17
                                                if ( ((SUIHEIKATAN - YY_min) * 図Y_SCALE * Twip) > 5 ) {
            //                                            YY0 = 3
                                                    YY1 = 22 + 8
                                                    if ( ((SUIHEIKATAN - YY_min) * 図Y_SCALE * Twip) > 10 ) {
                                                        YY1 = YY1 + 5
                                                    }
            //                                            Yy2 = 17 + 8
                                                }
                                            } else {
                                                 //////13/06/08 コメントにした
            //                                        YY0 = SUIHEIKATAN + ((SUIHEIKATAN - YY_min) / 1.3 * 図Y_SCALE * Twip) //////13/04/177//////13/06/08
                                                YY1 = 20 - 2: Yy2 = 12 - 2
                                                if ( ((SUIHEIKATAN - YY_min) / (JX_max - JX_min)) < 0.2 $$ NKUI != 0 ) {
                                                    YY0 = YY_min
                                                    YY1 = 10: Yy2 = 12
                                                }
                                            }
                                        }
                                    } else {
                                        YY1 = 15: Yy2 = 8 ////////////////////09/08/06
                                        if ( ((SUIHEIKATAN - YY_min) * 図Y_SCALE * Twip) < 1 ) { //////09/10/14
                                            YY0 = YY_min + ((0.4 - (k杭長 / 2 * 図Y_SCALE * Twip)) / 図Y_SCALE / Twip) //////10/04/03
                                        }
                                    } ////////09/05/25
                                    if ( ((YY_max - Y2) / 図Y_SCALE / Twip) > 35 $$ CASN < 0 ) { //////////08/06/24////08/08/15
                                        if ( NKUI > 0 ) { //////13/11/16
                                            if ( iKozo = 2 ) {
                                                YY0 = SUIHEIKATAN // - 3
                                                YY1 = 15
                                                Yy2 = 13
                                            } else {if ( iKozo = 1 $$ ((SUIHEIKATAN - k杭長) - YY_min) > 10 ) {
                                                YY0 = -(((SUIHEIKATAN - k杭長) - YY_min) * 図Y_SCALE * Twip) / 2
                                                YY1 = 15 + 2
                                                Yy2 = 10 //13
                                            }
                                            if ( ((水平部材最上端 - SUIHEIKATAN) / 図Y_SCALE) > 2200 ) { //////16/02/20  2500
                                                YY0 = ((水平部材最上端 - SUIHEIKATAN + 0.5) * 図Y_SCALE * 56.7) //////0.4
                                                if ( YY0 > 1.2 ) { YY0 = 1.2
                                                YY0 = SUIHEIKATAN + YY0
                                                YY1 = -13
                                                Yy2 = -5 - 6
                                                FLG上 = 1
                                            }
                                        }
                                    //////08/12/06 コメントにした
            //                                YY1 = -(15 + 3) - IIf(GouikibuzaiIgaiNoSunpou = 1 $$ CASN < 0, 6, 0)
            //                                Yy2 = -10 - IIf(GouikibuzaiIgaiNoSunpou = 1 $$ CASN < 0, 3, 0)
                                    }
                                } else {
                                    YY0 = YY_min
                                    if ( CASN = 0 || (iKozo = 3 $$ g連続Mod) ) { //////10/03/24
                                        YY1 = 13 + 5 + 3 + 3
                                        Yy2 = 5 + 7 + 3 + 3
                                        if ( iKozo = 3 ) {
                                            YY1 = 13 + 5 + 3 - 3
                                            Yy2 = 5 + 7 + 3
                                            if ( 枠縦幅 < 200 ) {
                                                YY1 = YY1 - 7
                                            }
                                            if ( yHosei != 0 ) {
                                                YY1 = 10 - yHosei
                                                Yy2 = 8 - yHosei
                                            }
                                            if ( CASN < 0 $$ (iKozo = 3 $$ g連続Mod) ) { //////10/03/24
                                                YY1 = 10
                                                Yy2 = 8
                                                YY0 = YY_min - 0.8
                                            }
                                        }
                                    } else {
                                        if ( FR橋脚 = 2 ) { ////////////08/01/24
                                            if ( iKozo = 3 ) {
                                                YY0 = YY0 + 1 * Sgn(YY0) + IIf(YY_min < 0 $$ NKUI = 0, (0.04 / 図Y_SCALE / Twip), 0)
                                                if ( YY0 > 0 ) {
                                                    YY1 = YY0 + 13
                                                } else {
                                                    YY1 = Abs(YY0) // + 13
                                                }
                                                Yy2 = YY1 - 3
                                            } else {
                                                YY0 = YY0 + IIf(YY_min < 0 $$ NKUI = 0, (0.005 / 図Y_SCALE / Twip), 0)
                                                y1 = YY0 + 13
                                                Yy2 = YY1 - 3
                                            }
                                        } else {
                                            if ( iKozo = 3 $$ NKUI = 0 ) { //////16/05/12//////iKozo != 3 ) { //////////////12/12/15 14/05/01
                                                if ( NKUI = 0 ) {
                                                    if ( (SUIHEIKATAN = YY_min $$ YY_max = YY_min) ) { //////13/08/08
                                                        YY0 = YY0 / 2 //YY0 - 2
                                                        YY1 = 8 //10
                                                        Yy2 = 12
                                                        GoTo ABCD
                                                    } else {
                                                        if ( YY_max - YY_min > 2 $$ YY0 = YY_min $$ YY0 < 0 ) { ////////13/12/11
                                                            YY0 = YY0 + 2 //////09/10/14
                                                        }
                                                        if ( 座標Y調整 != 0 ) {
                                                            YY0 = YY0 - 2
                                                            YY1 = 18
                                                            Yy2 = 18
                                                            GoTo ABCD
                                                        }
                                                    }
                                                }
                                                YY1 = 2 + 13 - 3
                                                Yy2 = YY1 + 3 - IIf(NN2 > 40, 3, 0)
            ABCD:
                                            } else {
                                                if ( NKUI = 0 $$ SUIHEIKATAN = YY_min ) { //////14/01/06
                                                    if ( (0.01 / 図Y_SCALE / Twip) < 0.5 ) { //////14/03/04
                                                        if ( 水平部材最下端 = 水平部材最下端 $$ (YU_max > 水平部材最上端) $$ WUW > 1 ) {
                                                            YY0 = YY0 - 0.1 //////15/12/16
                                                            FLG_Ugata = True
                                                        } else {
                                                            YY0 = YY0 + 0.15
                                                        }
                                                    } else {
                                                        YY0 = YY0 - 1.5 + 3 //////13/11/09
                                                    }
                                                }
                                                if ( NKUI = 0 $$ SUIHEIKATAN = 0 $$ SUIHEIKATAN = YY_min ) {
                                                    YY0 = -0.1
                                                    YY1 = 17
                                                    Yy2 = YY1 + 3
                                                } else {
                                                    YY1 = 2 + 13 - 3
                                                    Yy2 = YY1 + 3
                                                }
                                                if ( NKUI = 0 $$ YY_max - YY_min < 1.2 $$ iKozo = 3 $$ g連続Mod = False ) { ////////16/03/19
                                                    YY0 = YY_max + 0.35
                                                    YY1 = YY0 - 2
                                                    Yy2 = YY1 - 10
                                                }
                                            }
                                        }
                                    }
                                    if ( FR橋脚 = 2 ) {
                                        if ( CASN = 0 ) {
                                            YY1 = YY1 - 10
                                            Yy2 = Yy2 - 10
                                        } else {
                                            YY1 = YY1 - 3
                                            Yy2 = Yy2 - 3
                                        }
                                    }
                                }
                                YY1 = YY1 + yHosei
                                Yy2 = Yy2 + yHosei
                                //
                                For( i = 1 To NN2 // - 1
                                    X(i) = HEN_X(節X(Dn2(i)))
                                    Y(i) = HEN_Y(YY0)
                                    if ( i < NN2 ) {
                                        if ( Dn2(i + 1) <= Jn_max $$ (FBuzaiNumber2(i) != 0 || 節X0(Dn2(i + 1)) > 節X0(Dn2(i))) ) {  ////////08/01/04
                                            寸法(i) = F2(Abs(節X0(Dn2(i + 1)) - 節X0(Dn2(i))))
            //                                    FBuzaiNumber2(i) = Dn2(i + 1)
                                            GGII = Dn2(i)
                                            GGjj = Dn2(i + 1)
                                            For( HIH = 1 To 部材_max
                                                if ( ZZBuzaiBai(HIH) != 0 ) {
                                                    if ( (ILineGX(HIH) = GGII $$ JLineGX(HIH) = GGjj) || (ILineGX(HIH) = GGjj $$ JLineGX(HIH) = GGII) ) {
                                                        FBuzaiNumber2(i) = HIH
                                                        Exit For
                                                    }
            //                                            }
                                                }
                                            Next HIH
                                        }
            //                                FAFA(i) = FBuzaiNumber2(i) ////////08/01/04
                                    }
                                }
                                SSAA = 0
                                CheckFgFg = 0
                                st = 1 //////////////////////////12/04/24
                                For( i = st To NN2 //For( i = st To NN2 - 1//////12/04/24
                                    GGII = Dn2(i)
                                    GGjj = Dn2(i + 1)
                                    For( HIH = 1 To 部材_max
                                        if ( ZZBuzaiBai(HIH) != 0 ) {
                                            if ( (ILineGX(HIH) = GGII $$ JLineGX(HIH) = GGjj) || (ILineGX(HIH) = GGjj $$ JLineGX(HIH) = GGII) ) {
                                            } else {
                                                CheckFgFg = 1
                                                Exit For
                                            }
                                        }
                                    Next HIH
                                    if ( CheckFgFg = 1 ) {
                                        Exit For
                                    }
                                }
                                if ( (CheckFgFg = 1 $$ Dn2(st) = 0) ) { ////14/05/01//Or NN2 - 1 = 1 ) {
                                    CheckFgFg = 0
                                }
                                if ( CheckFgFg = 1 || CheckFgFg != 1 ) {
            //                            For( i = ST To NN2 - 1
            //                                For( j = 1 To 部材_max
            //                                    if ( ZZBuzaiBai(j) != 0 $$ Not (AngleDF1[j] = 90 || AngleDF1[j]] = 270 ] { ////////06/03/07 水平部材
            //                                    if ( i = NN2 - 1 ) {
            //                                        if ( Dn2(i + 1) = FBuzaiJ(j) ) {
            //                                            FBuzaiNumber1(i) = j
            ////                                            Exit For
            //                                        }
            //                                    } else {
            //                                        if ( Dn2(i) = FBuzaiI(j) || Dn2(i) = FBuzaiJ(j) ) {
            //                                            FBuzaiNumber1(i) = j
            ////                                            Exit For
            //                                        }
            //                                    }
            //                                    }
            //                                    if ( ZZBuzaiBai(j) != 0 ) {
            //                                        if ( (Dn2(i) = FBuzaiJ(j) $$ Dn2(i + 1) = FBuzaiI(j)) || _
            //                                                    (Dn2(i + 1) = FBuzaiJ(j) $$ Dn2(i) = FBuzaiI(j)) ) { ////////07/12/29
            //                                            ASF1 = 1
            //                                            FBuzaiNumber1(i) = j
            //                                            Exit For
            //                                        }
            //                                    }
            //                                }
            //                            }
            For( i = 1 To 部材_max //////10/04/07
                FAFA(i) = 0
            }
                                    SSAA = 0
                                    For( i = st To NN2 - 1

                                        SSAA = SSAA + 1
                                        if ( val(寸法(i)) != 0 ) { //////14/08/04
                                            if ( FBuzaiNumber2(i) <= 0 || FBuzaiNumber2(i) > 部材_max ) { ////////08/01/099
                                                FAFA(SSAA) = 0
                                            } else {
                                                FAFA(SSAA) = FBuzaiNumber2(i)
                                                if ( FAngle(FAFA(SSAA)) = 180 ) {
                                                    UpDownFlag(FAFA(SSAA)) = 0 //////-1
                                                } else {
                                                    if ( FAngle(FAFA(SSAA)) = 0 ) { ////////16/10/20
                                                        UpDownFlag(FAFA(SSAA)) = 1
                                                    } else {
                                                        UpDownFlag(FAFA(SSAA)) = -1
                                                    }
                                                }
                                            }
                                        } else {
                                            UpDownFlag(FAFA(SSAA)) = 0
                                        }
                                    }
                                } else {
                                    For( i = 1 To NN2 - 1
                                        GGII = Dn2(i)
                                        GGjj = Dn2(i + 1)
                                        For( HIH = 1 To 部材_max
                                            if ( ZZBuzaiBai(HIH) != 0 ) {
                                            if ( (ILineGX(HIH) = GGII $$ JLineGX(HIH) = GGjj) || (ILineGX(HIH) = GGjj $$ JLineGX(HIH) = GGII) ) {
                                                SSAA = SSAA + 1
                                                FAFA(SSAA) = HIH
                                                if ( (ILineGX(HIH) = GGII $$ JLineGX(HIH) = GGjj) ) {
                                                    UpDownFlag(FAFA(SSAA)) = 1
                                                }
                                                if ( (ILineGX(HIH) = GGjj $$ JLineGX(HIH) = GGII) ) {
                                                    UpDownFlag(FAFA(SSAA)) = -1
                                                }
                                                Exit For
                                            }
                                            }
                                        Next HIH
                                    }
                                }
                                SSAA = 0
                                //
                                ATTAFLAG = 0
                                if ( BuzaiSunpouSenWriteFlag = 1 $$ CASN < 0 ) {
                                    For( i = 1 To NN2 - 1
                                        if ( ILineG(FAFA(i)) > 0 || JLineG(FAFA(i)) > 0 ) {
                                            ATTAFLAG = ATTAFLAG + 1
                                        }
                                    }
                                    For( i = 1 To NN2 // - 1
                                         //////////////////////////////////07/12/29 Not (YY_max - 節Y(部I(FAFA(i)))) < (YY_max - YY_min) / 10 を追加
            //                                if ( (ILineG(FAFA(i)) > 0 || JLineG(FAFA(i)) > 0) $$ Not (YY_max - 節Y(部I(FAFA(i)))) < (YY_max - YY_min) / 10 ) {
                                        //////08/01/099
                                        if ( FAFA(i) > 0 $$ ((ILineG(FAFA(i)) > 0 || JLineG(FAFA(i)) > 0)) $$ _
                                           ZBuzaiLength(FAFA(i)) != ILineG(FAFA(i)) + JLineG(FAFA(i)) ) {
                                            dL1 = Round(ILineG(FAFA(i)) * 斜比(FAFA(i), 1), 3) ////////07/12/31水平下
                                            dL2 = Round(JLineG(FAFA(i)) * 斜比(FAFA(i), 1), 3)
                                            if ( ILineG(FAFA(i)) > 0 $$ JLineG(FAFA(i)) > 0 ) {
                                                if ( UpDownFlag(FAFA(i)) = 1 ) {
                                                    SSAA = SSAA + 1
                                                    GFLAG(SSAA) = 1
                                                    DummyX(SSAA) = HEN_X(節X(Dn2(i)))
                                                    DummyY(SSAA) = HEN_Y(YY0)
                                                    Dummy寸法(SSAA) = F2(Abs(dL1)) //////ILineG(FAFA(i))))
                                                    SSAA = SSAA + 1
                                                    GFLAG(SSAA) = 1
                                                    DummyX(SSAA) = HEN_X(節X(Dn2(i)) + dL1) //////ILineG(FAFA(i)))
                                                    DummyY(SSAA) = HEN_Y(YY0)
                                                    Dummy寸法(SSAA) = F2(Abs(節X(Dn2(i + 1)) - 節X(Dn2(i)) - dL1 - dL2)) ////// JLineG(FAFA(i)) - ILineG(FAFA(i))))
                                                    SSAA = SSAA + 1
                                                    GFLAG(SSAA) = 1
                                                    DummyX(SSAA) = HEN_X(節X(Dn2(i + 1)) - dL2) //////JLineG(FAFA(i)))
                                                    DummyY(SSAA) = HEN_Y(YY0)
                                                    Dummy寸法(SSAA) = F2(Abs(dL2)) //////JLineG(FAFA(i))))
                                                } else {
                                                    SSAA = SSAA + 1
                                                    GFLAG(SSAA) = 1
                                                    DummyX(SSAA) = HEN_X(節X(Dn2(i)))
                                                    DummyY(SSAA) = HEN_Y(YY0)
                                                    Dummy寸法(SSAA) = F2(Abs(dL2)) //////JLineG(FAFA(i))))
                                                    SSAA = SSAA + 1
                                                    GFLAG(SSAA) = 1
                                                    DummyX(SSAA) = HEN_X(節X(Dn2(i)) + dL2) //////JLineG(FAFA(i)))
                                                    DummyY(SSAA) = HEN_Y(YY0)
                                                    Dummy寸法(SSAA) = F2(Abs(節X(Dn2(i + 1)) - 節X(Dn2(i)) - dL1 - dL2)) //////JLineG(FAFA(i)) - ILineG(FAFA(i))))
                                                    SSAA = SSAA + 1
                                                    GFLAG(SSAA) = 1
                                                    DummyX(SSAA) = HEN_X(節X(Dn2(i + 1)) - dL1) //////ILineG(FAFA(i)))
                                                    DummyY(SSAA) = HEN_Y(YY0)
                                                    Dummy寸法(SSAA) = F2(Abs(dL1)) //////ILineG(FAFA(i))))
                                                }
                                            } else {
                                                if ( ILineG(FAFA(i)) > 0 ) {
                                                    if ( UpDownFlag(FAFA(i)) = 1 ) { //////// = 1 ) { //////16/05/12
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = HEN_X(節X(Dn2(i)))
                                                        DummyY(SSAA) = HEN_Y(YY0)
                                                        Dummy寸法(SSAA) = F2(Abs(dL1)) //////ILineG(FAFA(i))))
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = HEN_X(節X(Dn2(i)) + dL1) //////ILineG(FAFA(i)))
                                                        DummyY(SSAA) = HEN_Y(YY0)
                                                        Dummy寸法(SSAA) = F2(Abs(節X(Dn2(i + 1)) - 節X(Dn2(i)) - dL1)) //////ILineG(FAFA(i))))
                                                    } else {
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = HEN_X(節X(Dn2(i)))
                                                        DummyY(SSAA) = HEN_Y(YY0)
                                                        Dummy寸法(SSAA) = F2(Abs(節X(Dn2(i + 1)) - 節X(Dn2(i)) - dL1)) //////ILineG(FAFA(i))))
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = HEN_X(節X(Dn2(i + 1)) - dL1) //////ILineG(FAFA(i)))
                                                        DummyY(SSAA) = HEN_Y(YY0)
                                                        Dummy寸法(SSAA) = F2(Abs(dL1)) //////ILineG(FAFA(i))))
                                                    }
                                                } else {
                                                    if ( JLineG(FAFA(i)) > 0 ) {
                                                        if ( UpDownFlag(FAFA(i)) = 1 ) { //////// = 1 ) { //////16/05/12
                                                            SSAA = SSAA + 1
                                                            GFLAG(SSAA) = 1
                                                            DummyX(SSAA) = HEN_X(節X(Dn2(i)))
                                                            DummyY(SSAA) = HEN_Y(YY0)
                                                            Dummy寸法(SSAA) = F2(Abs(節X(Dn2(i + 1)) - 節X(Dn2(i)) - dL2)) //////JLineG(FAFA(i))))
                                                            SSAA = SSAA + 1
                                                            GFLAG(SSAA) = 1
                                                            DummyX(SSAA) = HEN_X(節X(Dn2(i + 1)) - dL2) //////JLineG(FAFA(i)))
                                                            DummyY(SSAA) = HEN_Y(YY0)
                                                            Dummy寸法(SSAA) = F2(Abs(dL2)) //////JLineG(FAFA(i))))
                                                        } else {
                                                            SSAA = SSAA + 1
                                                            GFLAG(SSAA) = 1
                                                            DummyX(SSAA) = HEN_X(節X(Dn2(i)))
                                                            DummyY(SSAA) = HEN_Y(YY0)
                                                            Dummy寸法(SSAA) = F2(Abs(dL2)) //////JLineG(FAFA(i))))
                                                            SSAA = SSAA + 1
                                                            GFLAG(SSAA) = 1
                                                            DummyX(SSAA) = HEN_X(節X(Dn2(i)) + dL2) //////JLineG(FAFA(i)))
                                                            DummyY(SSAA) = HEN_Y(YY0)
                                                            Dummy寸法(SSAA) = F2(Abs(節X(Dn2(i + 1)) - 節X(Dn2(i)) - dL2)) //////JLineG(FAFA(i))))
                                                        }
                                                    }
                                                }
                                            }
                                        } else {
                                            SSAA = SSAA + 1
                                            GFLAG(SSAA) = 0
                                            DummyX(SSAA) = HEN_X(節X(Dn2(i)))
                                            DummyY(SSAA) = HEN_Y(YY0)
                                            Dummy寸法(SSAA) = "" //////F2(Abs(節X(Dn2(i + 1)) - 節X(Dn2(i))))
                                        }
                                    }
                                    //
                                    SSAA = SSAA + 1
                                    DummyY(SSAA) = HEN_Y(YY0)
            //                            GFLAG(SSAA) = 1
            //                            DummyX(SSAA) = HEN_X(節X(Dn2(NN2)))
            //                            DummyY(SSAA) = HEN_Y(YY0)
                                    Dummy寸法(SSAA) = ""
                                }
            //if ( CheckFgFg = 1 ) {
            //    GGG = 1
            //} else {
            GGG = 0
                                For( i = 1 To NN2 // - 1
                                    if ( i < NN2 ) {
                                        if ( 寸法(i) != "" $$ 寸法(i) != 寸法9(i) ) {
                                            GGG = 1
                                        }
                                        if ( bOutput1 = False || (iKozo = 3 $$ CASN < 0 $$ NKUI > 0) || _
                                            (iKozo = 1 $$ CASN < 0 $$ GouikibuzaiIgaiNoSunpou = 1 $$ ZZBuzaiBai(FAFA(i))) ) {
                                            GGG = 1
                                        }
                                    }
                                }
            //}
            //                        if ( bOutput1 = False || (iKozo = 3 $$ CASN < 0 $$ NKUI > 0) || _
            //                        (iKozo = 1 $$ CASN < 0 $$ GouikibuzaiIgaiNoSunpou = 1 $$ FAFA(i)) ) {
            //                            GGG = 1
            //                        }
            if ( GGG = 1 ) {
                                .FontSize = 荷重寸法Fontsize
                                .PenWidth = 部材荷重寸法Pen幅
                                if ( CreateDxfFlag = 1 ) {
                                    this.PLOTPEN(CSng(.PenWidth))
                                }
                                .PenColor = QBColor(部材荷重寸法Pen色)
                                if ( SSAA <= 1 ) {
                                    this.SunPou2(">", NN2, YY1, Yy2, 寸法(), X(), Y(), 99) //フレーム
                                } else {
                                    if ( BuzaiSunpouSenReverse = 1 ) {
                                        if ( ATTAFLAG > 0 ) {
                                            this.CalcMulti(Y(), IIf(NKUI = 0 $$ iKozo = 3, 11, 7) * OuTouBai)
                                            if ( Not (iKozo = 3 $$ g連続Mod) ) { //////10/03/24
                                                if ( NKUI = 0 ) {
                                                    YY1 = YY1 + 1 //////08/01/24
                                                    Yy2 = Yy2 + 1 //////08/01/24
            //                                    } else {if ( NKUI != 0 $$ YY0 = SUIHEIKATAN $$ Buzaiばね地層 = 0 ) {
            //                                        YY0 = YY_min + ((0.2 - (k杭長 * 図Y_SCALE * Twip)) / 図Y_SCALE / Twip)
            //                                        YY1 = YY0
            //                                        Yy2 = 10
                                                }
                                            }
                                            if ( (NKUI = NN2) ) { //////17/01/09
                                                if ( (1 / 図Y_SCALE / Twip) < 5 ) {
                                                    YY0 = SUIHEIKATAN + 1
                                                    YY1 = -9
                                                    Yy2 = -17 ////////17/004/11
                                                } else {
                                                    YY0 = SUIHEIKATAN + 0.5
                                                    YY1 = -13
                                                    Yy2 = YY1 - 8
                                                }
                                                GGG = 0
                                                    For( i = 1 To CInt(SSAA)
                                                        DummyY(i) = HEN_Y(YY0)
                                                        if ( Dummy寸法(i) != "" ) {
                                                            GGG = GGG + 1
                                                        }
                                                    }
                                                    SSAA = GGG + 1 ////////17/004/11
                                                GoTo GRF789
                                            } else {
                                                this.SunPou2(">", NN2, YY1, Yy2, 寸法(), X(), Y(), 99) //フレーム
                                            }
                                            if ( YY1 >= 0 ) { //////////NKUI = 0 ) { //////////08/07/11
            //                                       if ( NKUI = 0 $$ iKozo != 3 ) {
            //                                           Yy2 = Yy2 - 14 ////////08/01/24
            //                                       }
                            ////////08/01/04 + 1.5
                                                if ( ((YY_max - Y2) / 図Y_SCALE / Twip) > 35 $$ YY1 < 0 ) { //////////08/07/10
                                                    YY1 = YY1 - 12
                                                    Yy2 = Yy2 - 5
                                                } else {if ( ((SUIHEIKATAN - YY_min) * 図Y_SCALE * Twip) > 4 ) { //////////// 13/04/22
            //                                            YY1 = YY1 - 12
                                                    Yy2 = 3 //////Yy2 - 5 - 7
                                                }
                                                if ( NKUI > 0 $$ YY0 < 0 $$ Abs(YY0) > 13 ) {
                                                    YY0 = SUIHEIKATAN - 1.7
                                                    YY1 = 4
                                                    Yy2 = 3

                                                    For( i = 1 To CInt(SSAA)
                                                        DummyY(i) = HEN_Y(YY0)
                                                    }
                                                    zKUI_YZAhyou = -9999
                                                    if ( MN2(1) > 0 ) {
                                                        For( i = 1 To NN2
                                                            if ( zKUI_YZAhyou < 節Y(MN2(i)) ) { //
                                                                zKUI_YZAhyou = 節Y(MN2(i))
                                                            }
                                                        }
                                                    } else {
                                                        For( i = 1 To CInt(SSAA)
                                                            if ( FAFA(i) != 0 ) {
                                                                if ( zKUI_YZAhyou < 節Y(部I(FAFA(i))) ) { //
                                                                    zKUI_YZAhyou = 節Y(部I(FAFA(i)))
                                                                }
            //                                                        if ( zKUI_YZAhyou < 節Y(部J(FAFA(i))) ) { //
            //                                                            zKUI_YZAhyou = 節Y(部J(FAFA(i)))
            //                                                        }
                                                            }
                                                        }
                                                    }
            //                                            zKUI_YZAhyou = -9999
            //                                            For( i = 1 To NN2 - 1
            //                                            if ( zKUI_YZAhyou < 節Y(Dn2(i)) ) { //
            //                                                zKUI_YZAhyou = 節Y(Dn2(i))
            //                                            }
            //                                            }
                                                    if ( Abs(YY_max - zKUI_YZAhyou) < YY_max / 20 ) {
                                                        YY0 = YY_max
                                                        YY1 = -10
                                                        Yy2 = -16
                                                        For( i = 1 To CInt(SSAA)
                                                            DummyY(i) = HEN_Y(YY0)
                                                        }
                                                    }
                                                } else {
                                                    if ( (NKUI = 0 $$ YY1 > 0) ) { ////////(NKUI = 0 $$ iKozo = 3) ) {////17/02/24
                                                        if ( Yy2 > 0 ) {
                                                            if ( YY_max > 5 ) {
                                                                YY1 = 20
                                                                Yy2 = 9 //////Yy2 / 2
                                                            } else {
                                                                YY1 = -(13 + 8) ////////15 - 5 //-10 + 5
                                                                Yy2 = -24 //////10 - 4 //////-17 + 5
                                                            }
                                                            if ( 水平部材最下端 - JY_min > 15 ) { ////////17/11/21
                                                                YY1 = -(13 + 8 + 15) ////////15 - 5 //-10 + 5
                                                                Yy2 = -24 - 5 + 3 //////10 - 4 //////-17 + 5
                                                            }
                                                            For( i = 1 To CInt(SSAA)
                                                                DummyY(i) = Y(1) - 550
                                                            }
                                                            GoTo GRF789
                                                        }
                                                        if ( ((YY_max - Y2) / 図Y_SCALE / Twip) > 65 ) {
                                                                YY1 = -(15 - 2)
                                                                Yy2 = -18
                                                            For( i = 1 To CInt(SSAA)
                                                                DummyY(i) = Y(1) - 350
                                                            }
                                                        } else {
                                                            if ( iKozo = 1 ) { //////// Yy2 > YY1 ) {
                                                                YY1 = -(15 - 2) ////////15 - 5 //-10 + 5
                                                                Yy2 = -23 //////10 - 4 //////-17 + 5
                                                                For( i = 1 To CInt(SSAA)
                                                                    DummyY(i) = Y(1)
                                                                }
                                                            } else {
                                                                YY1 = 15 - 2 - 5
                                                                Yy2 = -16 - 4
                                                                For( i = 1 To CInt(SSAA)
                                                                    DummyY(i) = Y(1) + 200 + 200 + 200 + 300  ////////17/07/20
                                                                }
                                                            }
                                                        }
                                                   } else {
                                                        YY1 = -15
                                                        Yy2 = -17
                                                    }
                                                }
            //                                                For( i = 1 To CInt(SSAA)
            //                                                    DummyY(i) = Y(1)
            //                                                }
                                            } else {
                                                if ( FLG上 = 1 ) {
                                                    YY1 = 2 - 3.3
                                                    Yy2 = 2 - 5
                                                } else {
                                                    if ( iKozo = 1 ) { ////////17/03/13
                                                        YY1 = -1.5
                                                        Yy2 = -2.5 //Yy2 - 1.5
                                                    } else {
                                                        YY1 = YY1 + 12 //////////08/07/11
                                                        Yy2 = Yy2 - 5
                                                    }
                                                } //////////08/07/11
                                            }
            GRF789:
                                            if ( GouikibuzaiIgaiNoSunpou = 1 ) {
                                                this.SunPou2G(">", CInt(SSAA), YY1 + 1.5, Yy2 + 1.5, Dummy寸法(), DummyX(), DummyY(), 99) //フレーム
                                            } else {
                                                this.SunPou2(">", CInt(SSAA), YY1 + 1.5, Yy2 + 1.5, Dummy寸法(), DummyX(), DummyY(), 99) //フレーム
                                            }
                                        } else {
                                            if ( YY1 < 25 ) { //////And iKozo = 1 ) {
                                                if ( iKozo = 2 ) {
                                                    YY1 = YY1 + 3 // - 30
                                                    Yy2 = Yy2 - 2
                                                } else {
                                                    if ( iKozo = 1 $$ ATTAFLAG = 0 ) {
                                                        YY1 = YY1 + 8
                                                        Yy2 = Yy2 + 2
                                                    } else {
                                                        YY1 = YY1 + 4 // - 30
                                                        Yy2 = Yy2 - 2
                                                    }

                                                }
                                            }
                                            this.SunPou2(">", NN2, YY1, Yy2, 寸法(), X(), Y(), 99) //フレーム
                                        }
                                    } else {
                                        if ( ATTAFLAG > 0 ) {
                                            this.CalcMulti(DummyY(), 7 * OuTouBai)
                                            this.SunPou2(">", NN2, YY1, Yy2, 寸法(), X(), Y(), 99) //フレーム
                                            if ( GouikibuzaiIgaiNoSunpou = 1 ) {
                                                this.SunPou2G(">", CInt(SSAA), YY1, Yy2, Dummy寸法(), DummyX(), DummyY(), 99) //フレーム
                                            } else {
                                                this.SunPou2(">", CInt(SSAA), YY1, Yy2, Dummy寸法(), DummyX(), DummyY(), 99) //フレーム
                                            }
                                        } else {
                                            this.SunPou2(">", NN2, YY1, Yy2, 寸法(), X(), Y(), 99) //フレーム
                                        }
                                    }
            }
                                }
                            } else {
                                this.X(NN2)
                                this.Y(NN2)
                                this.寸法(NN2)
                                YY0 = Y2
                                YY1 = 15
                                Yy2 = 10
                                if ( NKUI = 0 ) {
                                    YY0 = YY_min
            //                            if ( CASN = 0 ) { ////////////////////////////////////04/08/27 nagase
                                        YY1 = 13 + 5 + 3 + 3
                                        Yy2 = 5 + 7 + 3 + 3
            //////09/11/202
            if ( iKozo = 3 $$ g連続Mod ) {
                if ( CASN >= 0 ) {
                    YY1 = YY1 - 15
                    Yy2 = Yy2 - 13
                }
                GoTo yUUU
            }
                                        if ( iKozo = 3 ) {
                                            if ( sYscale = 1 $$ (荷重図フォーマット.int用紙方向 = 0 || g連続Mod) ) { //////09/11/13
            //
                                                YY1 = YY0 + 7 + 8 + 15 - IIf(CASN < 0, 16 + 8, 20) ////////10/01/24
                                                Yy2 = YY0 + 5 + 8 + 15 + 10 - IIf(CASN < 0, 25, 15)
                                                if ( Yz2 - Yz1 < 1.5 $$ Not g連続Mod ) {
                                                    YY1 = YY1 + 15
                                                    Yy2 = Yy2 + 15
                                                } else {if ( g連続Mod ) {
                                                    if ( 荷重図フォーマット.int用紙サイズ = 0 ) { //////09/11/20
                                                        if ( CASN < 0 ) { ////////////09/11/19
                                                            YY1 = YY1 + 15 - 10 //+ 3
                                                            Yy2 = Yy2 + 15 - 10 //+ 3
                                                            YY0 = YY0 - 0.5 //////////////////////09/11/199
                                                        } else {
                                                            YY1 = YY1 + 15 - 10 + 3
                                                            Yy2 = Yy2 + 15 - 10 + 3
                                                        }
                                                    } else {
                                                        if ( CASN < 0 ) { ////////////09/11/19
                                                            YY1 = YY1 + 15 - 10
                                                            Yy2 = Yy2 + 15 - 10
                                                            if ( 荷重図フォーマット.int用紙方向 = 0 ) { //////09/11/199
                                                            YY0 = YY0 - 1.5 //////////////////////09/11/199
                                                            } else {
                                                            YY0 = YY0 - 0.5 //////////////////////09/11/199
                                                            }
                                                        } else {
                                                            YY1 = YY1 + 10 - 10 - 1
                                                            Yy2 = Yy2 + 10 - 10 - 1
                                                            YY0 = YY0 - 1.7
                                                        }
                                                    }
                                                    GoTo yUUU
                                                }
                                                //
                                            } else {
            //                                    YY0 = YY_min - 0.5 * Sgn(YY_min)
            //                                    if ( NKUI = 0 ) { //////////////////////////////// 05/05/27
                                                YY1 = YY0 + 3 + 5 + 5 - 2 - IIf(CASN < 0, 0, 15) + 図Y_SCALE
                                                Yy2 = YY0 + 7 + 5 + 13 - 2 - IIf(CASN < 0, 10, 15)
                                                if ( g連続Mod ) { //////And CASN < 0 ) { ////////08/09/26
                                                    if ( CASN < 0 ) { ////////////09/11/19
                                                        YY0 = YY0 - 0.8
                                                        YY1 = YY1 + 0.5
                                                        Yy2 = Yy2 - 0.5
                                                    } else {
                                                        if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                                                            if ( 荷重図フォーマット.int用紙サイズ = 0 ) { //////09/11/20
                                                                YY0 = YY0 - 0.8 - 3 - IIf(YY0 = 0, 9, 0)
                                                                YY1 = YY1 + 0.5 - 3 - IIf(YY0 = 0, 9, 0)
                                                                Yy2 = Yy2 - 0.5 - 3 - IIf(YY0 = 0, 9, 0)
                                                            } else {
                                                                YY0 = YY0 - 0.8 - 3 - IIf(YY0 = 0, 5, -0.5) //////09/11/199
                                                                YY1 = YY1 + 0.5 - 3 - IIf(YY0 = 0, 3, 0)
                                                                Yy2 = Yy2 - 0.5 - 3 - IIf(YY0 = 0, 5, 0)
                                                            }
                                                        } else {
                                                            if ( 荷重図フォーマット.int用紙サイズ = 0 ) { //////09/11/20
                                                                YY0 = YY0 - 0.8 - 1 - IIf(YY0 = 0, 5, 1) //////09/11/199
                                                                YY1 = YY1 + 0.5 - 1 - IIf(YY0 = 0, 5, 0)
                                                                Yy2 = Yy2 - 0.5 - 1 - IIf(YY0 = 0, 5, 0)
                                                            } else {
                                                                YY0 = YY0 - 0.8 - 1 - IIf(YY0 = 0, 5, 0)
                                                                YY1 = YY1 + 0.5 - 1 - IIf(YY0 = 0, 5, 0)
                                                                Yy2 = Yy2 - 0.5 - 1 - IIf(YY0 = 0, 5, 0)
                                                            }
                                                        }
                                                    }
                                                    GoTo yUUU
                                                }
                                            }
                                        if ( g連続Mod $$ YY_max != YY_min ) { ////////////////////05/02/24
                                            YY0 = YY_min - 0.5 * Sgn(YY_min)
                                            YY1 = YY0 + 7 + 2
                                            Yy2 = YY0 + 5 + 2
                                        } else {
                                            if ( g連続Mod ) { //////////////////////////////////// 連続桁
                                                if ( YY_min = 0 ) {
                                                YY0 = -0.5
                                                } else {
            //                                        YY0 = YY_min - 0.5 * Sgn(YY_min)
                                                YY0 = -YY_min - 0.5 * Sgn(YY_min) //////09/11/13
                                                }
               //////////09/11/13 コメントにした
            //                                        if ( (YY_max - YY_min) = 0 $$ CASN >= 0 ) { ////////////////////06/02/04
            //                                            YY0 = YY0 + 0.5
            //                                        }
            //                                        if ( (YY_max - YY_min) = 0 $$ CASN < 0 ) {
            //                                            YY0 = YY0 + 0.3
            //                                        }
                                                if ( CASN < 0 ) {
                                                    if ( 荷重図フォーマット.int用紙方向 = 0 ) { //////09/11/13
                                                    YY0 = YY0 + 0.2  //////////09/11/13
                                                    } else {
                                                    YY0 = YY0 + 0.3  //////////09/11/13
                                                    }
                                                        YY1 = YY0 + 7 - 5 - 5 + 5 //////09/11/13
                                                        Yy2 = YY0 + 5 - 5 + 10 //////09/11/13
                                                    GoTo FRG5
                                                } else {
                                                    if ( YY_min = 0 ) {
                                                    YY0 = YY0 + 0.3 //////////09/11/13
                                                    } else {
            //                                            YY0 = YY_min + 0.8 * Sgn(YY_min)
                                                    }
                                                }
                                                YY1 = YY0 + 7 - 5
                                                Yy2 = YY0 + 5 - 5
                                                Select Case 荷重図フォーマット.intレイアウト
                                                Case 2 // ２段書きする場合
                                                    if ( 枠縦幅 > 200 ) {
                                                        YY1 = YY0 + 7 - 5 + 2 //////09/11/13
                                                        Yy2 = YY0 + 5 - 5 + 5 //////09/11/13
                                                    } else {
                                                        YY1 = YY0 + 7 - 10 - 2 + 2 //////09/11/13
                                                        Yy2 = YY0 + 5 - 10 - 2 + 14 //////09/11/13
                                                    }
                                                Case 1 // Case1 を シングル
                                                    if ( 枠縦幅 > 200 ) {
                                                        YY1 = YY0 + 7 - 5 + 6 //////09/11/13
                                                        Yy2 = YY0 + 5 - 5 + 14 //////09/11/13
                                                    } else {
                                                        YY1 = YY0 + 7 - 10 + 4 //////09/11/13
                                                        Yy2 = YY0 + 5 - 10 + 16 //////09/11/13
                                                    }
            //                                        Case 2 // シングル
            //                                                YY1 = YY0 + 7 - 5
            //                                                Yy2 = YY0 + 5 - 5
                                                Case 3 // ３段書きする場合
                                                    if ( 枠縦幅 > 200 ) {
                                                        YY1 = YY0 + 7 - 5 - 3 - 2 + 4 //////09/11/13
                                                        Yy2 = YY0 + 5 - 5 - 3 - 2 + 10 //////09/11/13
                                                    } else {
                                                        YY1 = YY0 + 7 - 5 - 8 + 2 //////09/11/13
                                                        Yy2 = YY0 + 5 - 5 - 8 + 14 //////09/11/13
                                                    }
                                                Case 4 // ４段書きする場合
                                                    if ( 枠縦幅 > 200 ) {
                                                        YY1 = YY0 + 7 - 5 - 5 - 2 + 4 //////09/11/13
                                                        Yy2 = YY0 + 5 - 5 - 5 - 2 + 10 //////09/11/13
                                                    } else {
                                                        YY1 = YY0 + 7 - 5 - 8 + 2 //////09/11/13
                                                        Yy2 = YY0 + 5 - 5 - 8 + 14 //////09/11/13
                                                    }
                                                End Select
                                            } else {
                                                if ( Not (iKozo = 3 $$ NKUI = 0) ) {
                                                YY1 = YY1 + IIf(iKozo = 3 $$ YY0 < 0, 13, 0) //- IIf(iKozo = 3 $$ NKUI = 0, 15, 0) //////////05/05/02
                                                Yy2 = Yy2 + IIf(iKozo = 3 $$ YY0 < 0, 13, 0) //- IIf(iKozo = 3 $$ NKUI = 0, 10, 0)
                                                }
                                            }
            //                                    } //////////05/02/24
                                        }
            yUUU: ////////08/09/26
                                    } else {
                                        if ( g連続Mod ) { //////////// 連続桁 05/01/29
                                            if ( g連続Mod $$ YY_max != YY_min ) { ////////////  //////////05/02/24
                                            YY0 = YY_min - 0.5
                                            YY1 = YY0 + 7 + 8
                                            Yy2 = YY0 + 5 + 8
                                           } else {
                                            YY0 = YY_min - 0.5
                                            YY1 = YY0 + 7
                                            Yy2 = YY0 + 5
                                            }
                                        } else {
                                            YY0 = YY_min - 0.5
                                            YY1 = YY0 + 7 + 8 + 12
                                            Yy2 = YY0 + 5 + 8 + 12 + IIf(iKozo = 3 $$ NKUI = 0, 10, 3)
            //                                        if ( 荷重図フォーマット.int用紙方向 = 1 ) { //////////07/01/19
                                            if ( iKozo = 1 $$ NKUI = 0 ) { //////////07/01/19
            //                                        YY0 = YY0 + 1 * Sgn(YY0) //////////07/08/04
                                                if ( YY0 >= 0 ) { //////////07/08/04
                                                    YY0 = YY0 + 0.5
                                                    YY1 = YY1 - 6
                                                } else {
                                                    YY0 = YY0 + 1.5 - IIf(YY0 < 0, 0.7, 0) ////////////// 08/01/10 - IIf(YY0 < 0, 0.7, 0)
                                                    YY1 = YY1 - 6
                                                }
                                            }
                                        }
                                    }
                                    if ( FR橋脚 = 2 ) {
                                        if ( CASN = 0 ) {
                                            YY1 = YY1 - 10
                                            Yy2 = Yy2 - 10
                                        } else {
                                            YY1 = YY1 + 3
                                            Yy2 = Yy2 + 3
                                        }
                                    }
                                }
                                //
            //                        if ( Not (iKozo = 3 $$ NKUI = 0 $$ YY_max - YY_min < 0.1) ) {
                                if ( Yz2 - Yz1 < 1.5 $$ Not g連続Mod ) {
                                    YY1 = YY1 - 15
                                    Yy2 = Yy2 - 15
                                }
                                if ( NN2 > 1 $$ NN1 <= 1 $$ SuiheiBBFlag = 0 ) {
                                    YY1 = YY1 + 15
                                    Yy2 = Yy2 + 15
                                } else {
            //                            YY1 = YY1 + 5 //////////////// 05/01/29
                                }
                                if ( Not g連続Mod $$ NKUI = 0 ) {
                                    if ( YY1 < 25 ) { ////////////////////////////////06/02/13
                                        if ( NKUI = 0 ) { //////////07/01/19
                                            YY1 = YY1 + 5 + 5  ////// 05/01/29
                                            Yy2 = Yy2 + 5 - 7 - min(YY_min, 0)
                                        } else {
                                            YY1 = YY1 + 5 ////// 05/01/29
                                            Yy2 = Yy2 + 5
                                        }
                                    }
                                }
            FRG5: //////////09/11/13
            GGG = 0
                                For( i = 1 To NN2 // - 1
                                    X(i) = HEN_X(節X(Dn2(i)))
                                    Y(i) = HEN_Y(YY0)
            //                            if ( i < NN2 $$ YY0 < (YY_max - YMin杭無) / 2 ) {
                                    if ( i < NN2 ) {
                                        if ( Dn2(i + 1) <= Jn_max $$ (FBuzaiNumber2(i) != 0 || 節X0(Dn2(i + 1)) > 節X0(Dn2(i))) ) {  ////////08/01/04
                                            寸法(i) = F2(Abs(節X0(Dn2(i + 1)) - 節X0(Dn2(i))))
                                        }
                                        if ( 寸法(i) != "" $$ 寸法(i) != 寸法9(i) ) {
                                            GGG = 1
                                        }
                                    }
                                }
                                if ( bOutput1 = False ) { GGG = 1
            if ( GGG = 1 ) {

                                .FontSize = 荷重寸法Fontsize
                                .PenWidth = 部材荷重寸法Pen幅
                                if ( CreateDxfFlag = 1 ) {
                                    this.PLOTPEN(CSng(.PenWidth))
                                }
                                .PenColor = QBColor(部材荷重寸法Pen色)
                                this.SunPou2(">", NN2, YY1, Yy2, 寸法(), X(), Y(), 99) //フレーム
            }
                            }
            GRF_33:
             if ( NKUI != 0 $$ FLGTTT = 1 ) {
                NN2 = 0
                For( i = 1 To 部材_max
                    if ( InStr(部材名(i), "杭") = 1 ) {
                        NN2 = NN2 + 1
                        Dn2(NN2) = 部J(i)
                        if ( zKUI_YZAhyou > 節Y(部J(i)) ) {
                            zKUI_YZAhyou = 節Y(部J(i))
                        }
                    }
                }
                if ( NN2 > 0 ) {
                    this.X(NN2) ////////16/06/16
                    this.Y(NN2)
                    this.寸法(NN2)
                    YY0 = ((0# - (Abs(zKUI_YZAhyou) * 図Y_SCALE * Twip)) / 図Y_SCALE / Twip)
                    YY1 = 16 - 1
                    Yy2 = 8
                    For( i = 1 To NN2 // - 1
                        X(i) = HEN_X(節X(Dn2(i)))
                        Y(i) = HEN_Y(YY0)
                        寸法(i) = F2(Abs(節X0(Dn2(i + 1)) - 節X0(Dn2(i))))
                    }
                    if ( Not (NN2 = 2 $$ val(寸法(1)) = 柱間離れ(2) - 柱間離れ(1)) ) {
                    this.SunPou2(">", CInt(NN2), YY1 + 1.2, Yy2 + 1.2, 寸法(), X(), Y(), 99)
                    }
                }
             }
            }
            //////////////////////////////
            GRF_GRF:
            //////// 垂直寸法 ////////////////////////////////////////////////////////////////////////// 垂直寸法//////////垂直右//////////垂直右//////////垂直右寸法　③
            //
            if ( CASN >= 0 $$ iKozo = 1 ) { return; ////////09/10/24
            var J8 As Integer
            var xHASIRA As Single
            var m杭先 As Integer, m杭後 As Integer
            m杭先 = 0: m杭後 = 0
            var m杭番 As Integer
            m杭番 = 0
            var m層数 As Integer
            m層数 = 0
            var m杭縮尺  As Single
            var X_Zahyo As Single
            //
            st = 1 ////////08/08/19
                    if ( CASN >= 0 $$ NN1 > 1 $$ iKozo = 1 ) { //////////07/06/27
                        if ( 節Y0(部I(Dn1(1))) <= 節Y0(部J(Dn1(NN1 - 1))) ) {
                            J8 = 0
                        } else {
                            J8 = 1
                        }
                    }
                    if ( CASN < 0 $$ 部材_max < 2 ) { J8 = 1
            //
                    if ( 柱間離れ(2) != 0 ) { //////if ( 柱間離れ(2) != -99999 ) { //////13/06/07
                        xHASIRA = min(柱間離れ(2), XXYY(3))
                    } else {
                        xHASIRA = XXYY(3)
                    }
                    if ( g柱本数 > 1 $$ 柱間離れ(2) - 柱間離れ(1) < 1.2 ) { ////////15/03/21
                        xHASIRA = 柱間離れ(1)
            //            X_Zahyo = 999
            //            For( i = 1 To g柱本数
            //
            //            }
                    }
                    if ( 階段Mod ) {
                        xHASIRA = XXYY(1)
                    }

            var sRENPEKI As Single
            var sSENTAN As Single
            var LL77(30) As Single, J5 As Integer
            var KTAB As Integer
            var KTA1 As Integer
            var XXXX As Single
            //    if ( XXYY(3) - xHASIRA > 8 $$ JX_max > 40 ) { //////15/08/09
            //        XXXX = HEN_X(xHASIRA)
            //    } else {
            //        XXXX = HEN_X(JX_max)
            //    }
            KTA1 = 1
            if ( XXYY(3) - 柱間離れ(2) > 8 $$ 柱間離れ(1) + 柱間離れ(2) > 0 ) {
                KTA1 = 2
            }
            For( KTAB = 1 To KTA1
                if ( KTAB = 1 ) { ////////////////////////////////////////////杭列右
                    xHASIRA = 柱間離れ(2)
                    XXXX = HEN_X(xHASIRA)
                    if ( 柱間離れ(1) + 柱間離れ(2) = 0 ) {
                        xHASIRA = XXYY(3)
                        XXXX = HEN_X(JX_max)
                    }
                } else { //////////////////////////////////////////////////////////////////外壁
                    xHASIRA = XXYY(3)
                    XXXX = HEN_X(JX_max)
                }
            //        if ( g柱本数 <= 1 ) { //////15/08/28////////XXYY(4) XXYY(3)
            //        xHASIRA = IIf(XXYY(4) > 0, XXYY(4), JX_max) - 0.01 //////JX_max //////15/12/01 コメントにした
            //        XXXX = HEN_X(xHASIRA)
            //        }
                sRENPEKI = -999
                sSENTAN = SUIHEIKATAN
                        JouhouSunpouCalcFlag = 0
                        NN1 = 0
                        this.varPointSelect_Kairyou(0, Jn_max, 節X0(), 節Y0(), 部材_max, 部I(), 部J(), 部材名(), ZZBuzaiBai(), _
                                                    NN1, Dn1(), ZZBuzaiBai(), wRR(), , , iKozo, xHASIRA, _
                                                    IIf(sRENPEKI = -999, 0, sRENPEKI)) //////14/06/17
            //        if ( g柱本数 = 1 ) { //////15/08/28
            //            xHASIRA = IIf(XXYY(3) > 0, XXYY(3), JX_max)
            //            xHASIRA = (XXYY(3) + JX_max) / 2
                    xHASIRA = JX_max
                    XXXX = HEN_X(xHASIRA)
                    if ( JX_max = JX_min $$ y1層厚(1, 0) > 0 ) {
                      XXXX = XXXX + 1000
                    }
            //        }
            var Ypoint As Integer
            Ypoint = 0
            var YpoitY As Single
            YpoitY = -9999
            if ( KTAB = 1 $$ NN1 > 1 $$ y1層厚(1, 0) > 0 ) {
                        For( i = 1 To 部材_max //1000
                            FBuzaiNumber1(i) = 0
                            FBuzaiNumber2(i) = 0
                            if ( 階段Mod = False $$ ZZBuzaiBai(i) = 1 ) {
                                X1 = 節X(部I(i))
                                y1 = 節Y(部I(i))
                                X2 = 節X(部J(i))
                                Y2 = 節Y(部J(i))
                                if ( X1 = X2 $$ (XXYY(3) + XXYY(4)) / 2 < X1 ) {
                                    if ( sSENTAN >= Y2 ) {
                                        sRENPEKI = X1
                                        sSENTAN = Y2
                                    }
                                }
                                if ( InStr(部材名(i), "杭") = 1 ) {
                                   if ( m杭先 = 0 ) {
                                        m杭先 = 部J(i)
                                        m杭縮尺 = ZZBuzaiBai(i)
                                   }
                                   m杭後 = 部J(i)
                                    m杭番 = 1
                                    if ( Len(部材名(i)) > 1 ) {
                                        m杭番 = Mid(部材名(i), 2, Len(部材名(i)))
                                        m杭縮尺 = ZZBuzaiBai(i)
                                    }
                                }
                                if ( X1 = X2 $$ InStr(部材名(i), "杭") = 0 ) {
                                    if ( y1 > YpoitY ) {
                                        Ypoint = 部I(i)
                                        YpoitY = y1
                                    }
                                    if ( Y2 > YpoitY ) {
                                        Ypoint = 部J(i)
                                        YpoitY = y1
                                    }

                                }
                            }
                        }
                        if ( Dn1(NN1) != Ypoint ) { ////////15/08/28
                            NN1 = NN1 + 1
                            Dn1(NN1) = Ypoint
                        }
            if ( Buzaiばね地層 = 1 ) {
            m杭番 = 0
            }
                        if ( m杭番 > 0 ) { //////////14/08/21 地層線表示
                            J5 = 0
                            For( i = y1層厚(m杭番, 0) To 1 Step -1
                                if ( y1層厚(m杭番, i) > 0 ) {
                                    J5 = J5 + 1
                                    LL77(J5) = y1層厚(m杭番, i)
                                }
                            }
                            m層数 = y1層厚(m杭番, 0)
                        }
            }

            if ( 階段Mod $$ NN1 = 1 ) {
            NN1 = 2
            Dn1(1) = 1
            Dn1(2) = 2
            } else {if ( 節Y(Dn1(1)) = 節Y(Dn1(2)) $$ NN1 = 2 ) { //////14/08/04
            For( i = 1 To 部材_max
                if ( xHASIRA = 節X(部I(i)) $$ xHASIRA = 節X(部J(i)) ) {
                    Dn1(1) = 部I(i)
                    Dn1(2) = 部J(i)
                    Exit For
                }
            }
            }
            this.寸法(NN1) ////////////07/07/17
            //
                        if ( NN1 > 1 $$ (CASN < 0 || CheckSuityuoku(Jn_max, 節X0(), 節Y0(), 部材_max, 部I(), 部J()) = 1) ) {
                            if ( ((gouikidddd = 1 $$ Atta寸法 = 1) || 部材_max < 2) $$ CASN < 0 ) { //////////////////////////////////////////////////////////////////06/05/17
                                this.X(NN1)
                                this.Y(NN1)
                                this.寸法(NN1)
                                For( i = 1 To NN1 //- 1
                                    X(i) = XXXX ////////HEN_X(JX_max)
                                    Y(i) = HEN_Y(節Y(Dn1(i)))
                                    if ( i < NN1 ) {
                                         if ( Abs(節Y0(Dn1(i + 1)) = 節Y0(Dn1(i))) ) {

                                         } else {
                                         if ( Dn1(i + 1) <= Jn_max ) {
                                            寸法(i) = F2(Abs(節Y0(Dn1(i + 1)) - 節Y0(Dn1(i))))
                                            寸法9(i) = 寸法(i)
                                        }
                                        }
                                    }
                                }
                    if ( NN1 >= 2 ) { //////////////////////////// 05/05/30
                    }
            //
            For( i = 1 To 部材_max //////10/04/08
                FAFA(i) = 0
            }
            //
            var HJK As Integer
            HJK = 0
                                For( i = 1 To NN1
                                    X(i) = XXXX ////////HEN_X(JX_max)
                                    Y(i) = HEN_Y(節Y(Dn1(i)))
                                    if ( i < NN1 ) {
                                        if ( Dn1(i + 1) <= Jn_max ) {
                                            寸法(i) = F2(Abs(節Y0(Dn1(i + 1)) - 節Y0(Dn1(i))))
                                            if ( val(寸法(i)) != 0 ) {
                                                HJK = HJK + 1
                                                寸法9(HJK) = 寸法(i) ////////13/11/15
                                            }
                                        }
                                    }
                                }

                                CheckFgFg = 1 //////09/10/23
                                SSAA = 0 ////////09/10/20
                                //
                                J8 = 0
                                For( i = st To NN1 - 1
                                    GGII = Dn1(i)
                                    GGjj = Dn1(i + 1)
                                    For( HIH = 1 To 部材_max
                                        if ( ZZBuzaiBai(HIH) != 0 ) {
                                            if ( (ILineGX(HIH) = GGII $$ JLineGX(HIH) = GGjj) || (ILineGX(HIH) = GGjj $$ JLineGX(HIH) = GGII) ) {
                                                SSAA = SSAA + 1 ////////09/10/20
                                                if ( Abs(節Y0(Dn1(i + 1)) - 節Y0(Dn1(i))) > 0 ) { //////And Not (HIH = 部材_max $$ NKUI != 0) ) { ////////13/04/01
                                                    FAFA(SSAA) = HIH ////////09/10/20
                                                    if ( (ILineGX(HIH) = GGII $$ JLineGX(HIH) = GGjj) ) { //////09/10/23
                                                        UpDownFlag(FAFA(SSAA)) = 1
                                                    }
                                                    if ( (ILineGX(HIH) = GGjj $$ JLineGX(HIH) = GGII) ) { //////09/10/23
                                                        UpDownFlag(FAFA(SSAA)) = -1
                                                    }
                                                    CheckFgFg = 0 //////09/10/23
                                                    if ( J8 = 0 ) {
                                                        J8 = i ////////////13/04/01
                                                    }
                                                } else {
                                                    FAFA(SSAA) = 0
                                                }
                                                Exit For( ////////09/10/23
                                            } else {
                                            }
                                        }
                                    Next HIH
                                }
                                SSAA = 0
                                if ( CheckFgFg = 1 ) {
                                    ASF1 = 0
                                    SSAA = 0 ////////09/10/20
                                    For( i = st To NN1 - 1
                                        SSAA = SSAA + 1
                                        if ( FBuzaiNumber1(i) <= 0 || FBuzaiNumber1(i) > 部材_max ) { ////////08/01/099
                                        } else {
                                            if ( FAngle(FAFA(SSAA)) = 90 ) {
                                                UpDownFlag(FAFA(SSAA)) = 1
                                            } else {
                                                UpDownFlag(FAFA(SSAA)) = -1
                                            }
                                        }
                                    }
                                } ////////09/10/23
                                SSAA = 0
                                //
                                ATTAFLAG = 0
                                if ( BuzaiSunpouSenWriteFlag = 1 $$ CASN <= 0 ) {
                                    For( i = 1 To NN1 - 1
                                        if ( ILineG(FAFA(i)) > 0 || JLineG(FAFA(i)) > 0 ) {
                                            ATTAFLAG = ATTAFLAG + 1
                                        }
                                    }
                if ( NKUI = 0 ) { ////////13/04/01
                    J8 = 0
                }
                                    For( i = 1 To NN1 - 1
                                            if ( FAFA(i) > 0 $$ ((ILineG(FAFA(i)) > 0 || JLineG(FAFA(i)) > 0)) $$ _
                                           ZBuzaiLength(FAFA(i)) != ILineG(FAFA(i)) + JLineG(FAFA(i)) ) {
                                            if ( ILineG(FAFA(i)) > 0 || JLineG(FAFA(i)) > 0 ) {
                                                if ( UpDownFlag(FAFA(i)) = -1 ) {
                                                    if ( 節Y(Dn1(1)) > 節Y(Dn1(NN1)) ) { //////14/09/24
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                                                        DummyY(SSAA) = HEN_Y(節Y(Dn1(i))) // - ILineG(FAFA(i)))
                                                        Dummy寸法(SSAA) = F2(Abs(ILineG(FAFA(i))))
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                                                        DummyY(SSAA) = HEN_Y(節Y(Dn1(i)) - ILineG(FAFA(i)))
                                                        Dummy寸法(SSAA) = F2(Abs(節Y(Dn1(i)) - 節Y(Dn1(i + 1)) - JLineG(FAFA(i)) - ILineG(FAFA(i))))
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                                                        DummyY(SSAA) = HEN_Y(節Y(Dn1(i + 1)) + JLineG(FAFA(i)))
                                                        Dummy寸法(SSAA) = F2(Abs(JLineG(FAFA(i))))
                                                    } else {
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                                                        DummyY(SSAA) = HEN_Y(節Y(Dn1(i)))
                                                        Dummy寸法(SSAA) = F2(Abs(JLineG(FAFA(i))))
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                                                        DummyY(SSAA) = HEN_Y(節Y(Dn1(i)) + JLineG(FAFA(i)))
                                                        Dummy寸法(SSAA) = F2(Abs(節Y(Dn1(i + 1)) - 節Y(Dn1(i)) - JLineG(FAFA(i)) - ILineG(FAFA(i))))
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                                                        DummyY(SSAA) = HEN_Y(節Y(Dn1(i)) + (節Y(Dn1(i + 1)) - 節Y(Dn1(i)) - ILineG(FAFA(i))))
                                                        Dummy寸法(SSAA) = F2(Abs(ILineG(FAFA(i))))
                                                    }
                                                } else {
                                                    SSAA = SSAA + 1
                                                    GFLAG(SSAA) = 1
                                                    DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                                                    DummyY(SSAA) = HEN_Y(節Y(Dn1(i)))
                                                    Dummy寸法(SSAA) = F2(Abs(ILineG(FAFA(i))))
                                                    SSAA = SSAA + 1
                                                    GFLAG(SSAA) = 1
                                                    DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                                                    DummyY(SSAA) = HEN_Y(節Y(Dn1(i)) + ILineG(FAFA(i)))
                                                    Dummy寸法(SSAA) = F2(Abs(節Y(Dn1(i + 1)) - 節Y(Dn1(i)) - JLineG(FAFA(i)) - ILineG(FAFA(i))))
                                                    SSAA = SSAA + 1
                                                    GFLAG(SSAA) = 1
                                                    DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                                                    DummyY(SSAA) = HEN_Y(節Y(Dn1(i)) + (節Y(Dn1(i + 1)) - 節Y(Dn1(i)) - JLineG(FAFA(i))))
                                                    Dummy寸法(SSAA) = F2(Abs(JLineG(FAFA(i))))
                                                }
                                            } else {
                                                if ( ILineG(FAFA(i)) > 0 ) {
                                                    if ( UpDownFlag(FAFA(i)) = -1 ) {
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                                                        if ( J8 != 0 ) { ////////////////////////////13/04/01
                                                            DummyY(SSAA) = HEN_Y(節Y(Dn1(J8 + 0)))
                                                            Dummy寸法(SSAA) = F2(Abs(節Y(Dn1(J8 + 1 + 0)) - 節Y(Dn1(J8 + 0)) - ILineG(FAFA(i))))
                                                            SSAA = SSAA + 1
                                                            GFLAG(SSAA) = 1
                                                            DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                                                            DummyY(SSAA) = HEN_Y(節Y(Dn1(J8 + 1 + 0)) - ILineG(FAFA(i)))
                                                            Dummy寸法(SSAA) = F2(Abs(ILineG(FAFA(i))))
                                                        } else {
                                                            DummyY(SSAA) = HEN_Y(節Y(Dn1(i)))
                                                            Dummy寸法(SSAA) = F2(Abs(節Y(Dn1(i + 1)) - 節Y(Dn1(i)) - ILineG(FAFA(i))))
                                                            SSAA = SSAA + 1
                                                            GFLAG(SSAA) = 1
                                                            DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                                                            DummyY(SSAA) = HEN_Y(節Y(Dn1(i + 1)) - ILineG(FAFA(i)))
                                                            Dummy寸法(SSAA) = F2(Abs(ILineG(FAFA(i))))
                                                        }
                                                    } else {
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                                                        DummyY(SSAA) = HEN_Y(節Y(Dn1(i)))
                                                        Dummy寸法(SSAA) = F2(Abs(ILineG(FAFA(i))))
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                                                        DummyY(SSAA) = HEN_Y(節Y(Dn1(i)) + ILineG(FAFA(i)))
                                                        Dummy寸法(SSAA) = F2(Abs(節Y(Dn1(i + 1)) - 節Y(Dn1(i)) - ILineG(FAFA(i))))
                                                    }
                                                } else {
                                                    if ( JLineG(FAFA(i)) > 0 ) {
                                                        if ( UpDownFlag(FAFA(i)) = -1 ) {
                                                            SSAA = SSAA + 1
                                                            GFLAG(SSAA) = 1
                                                            DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                                                            if ( SSAA = 1 $$ J8 != 0 ) { ////////////////////////////13/04/177
                                                                DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                                                                DummyY(SSAA) = HEN_Y(節Y(Dn1(J8))) // - JLineG(FAFA(i)))
                                                                Dummy寸法(SSAA) = F2(Abs(節Y(Dn1(J8 + 1)) - 節Y(Dn1(J8)) - JLineG(FAFA(i))))
                                                                DummyY(SSAA + 1) = HEN_Y(節Y(Dn1(J8 + 1)))

                                                                SSAA = SSAA + 1
                                                                GFLAG(SSAA) = 1
                                                                DummyY(SSAA) = HEN_Y(節Y(Dn1(J8 + 1)) - JLineG(FAFA(i)))
                                                                Dummy寸法(SSAA) = F2(Abs(JLineG(FAFA(i))))
                                                            } else {
                                                                DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                                                                DummyY(SSAA) = HEN_Y(節Y(Dn1(i)))
                                                                Dummy寸法(SSAA) = F2(Abs(JLineG(FAFA(i))))

                                                                SSAA = SSAA + 1
                                                                GFLAG(SSAA) = 1
                                                                DummyY(SSAA) = HEN_Y(節Y(Dn1(i)) + JLineG(FAFA(i)))
                                                                Dummy寸法(SSAA) = F2(Abs(節Y(Dn1(i + 1)) - 節Y(Dn1(i)) - JLineG(FAFA(i))))
                                                           } ////////////////////////////13/04/177
                                                        } else {
                                                            SSAA = SSAA + 1
                                                            GFLAG(SSAA) = 1
                                                            DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                                                            DummyY(SSAA) = HEN_Y(節Y(Dn1(i)))
                                                            Dummy寸法(SSAA) = F2(Abs(節Y(Dn1(i + 1)) - 節Y(Dn1(i)) - JLineG(FAFA(i))))
                                                            SSAA = SSAA + 1
                                                            GFLAG(SSAA) = 1
                                                            DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                                                            DummyY(SSAA) = HEN_Y(節Y(Dn1(i)) + 節Y(Dn1(i + 1)) - 節Y(Dn1(i)) - JLineG(FAFA(i)))
                                                            Dummy寸法(SSAA) = F2(Abs(JLineG(FAFA(i))))
                                                        }
                                                    }
                                                }
                                            }
                                        } else {
                                            if ( FAFA(i) > 0 $$ 節Y(Dn1(i + 1)) - 節Y(Dn1(i)) > 0 ) { //////09/10/22 10/04/07
                                                SSAA = SSAA + 1
                                                GFLAG(SSAA) = 0
                                                DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                                                DummyY(SSAA) = HEN_Y(節Y(Dn1(i)))
                                                Dummy寸法(SSAA) = F2(Abs(節Y(Dn1(i + 1)) - 節Y(Dn1(i))))
                                            } else {if ( 節Y(Dn1(i + 1)) - 節Y(Dn1(i)) = 0 ) { //////10/04/07
                                                FAFA(i) = 0
                                            }
            if ( KTAB = 1 $$ i = 1 $$ m層数 > 0 ) { //////////14/08/21 地層線表示
                    if ( JX_max = JX_min $$ y1層厚(1, 0) > 0 ) {
                      XXXX = XXXX - 400
                    }
                LL77(0) = 0
                For( J5 = 1 To m層数 + 1
                    SSAA = SSAA + 1
                    GFLAG(SSAA) = 1
                    DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                    DummyY(SSAA) = HEN_Y(節Y(m杭後) + LL77(0) * m杭縮尺)
                    Dummy寸法(SSAA) = F2(LL77(J5))
                    LL77(0) = LL77(0) + LL77(J5)
                }5
            }
                                        }
                                    }
                                    //
                                    SSAA = SSAA + 1
                                    GFLAG(SSAA) = 1
                                    DummyX(SSAA) = XXXX ////////HEN_X(JX_max)
                                    DummyY(SSAA) = HEN_Y(節Y(Dn1(NN1)))
                                    Dummy寸法(SSAA) = ""
                                }
              J5 = 0
              For( i = 1 To NN1
                if ( val(寸法(i)) > 0 ) {
                    J5 = J5 + 1
                    Dummy9寸法(i) = 寸法(i) ////////17/03/19
                }
              }
              NN1 = J5 + 1
                                if ( (Abs(d垂直(2) - JX_max) / 図X_SCALE / Twip) > 10 ) {
                                    YY1 = 16 + 2 - min(6, (Abs(d垂直(2) - JX_max) / 図X_SCALE / Twip) / (2 + g背割れ / 2))
                                    Yy2 = 8 + 4
                                } else {
                                    YY1 = 16 + 2
                                    Yy2 = 8 + 4
                                }
                                if ( g背割れ != 0 ) { //////////////////////////////////08/06/24
                                    YY0 = YY0 - 5
                                    YY1 = YY1 - 5
                                }
                                if ( iKozo = 3 $$ CASN >= 0 ) {
                                    YY1 = YY1 + 8 + 2
                                    if ( g連続Mod ) {
                                    YY1 = YY1 + IIf(CASN >= 0 $$ 垂直寸法位置補正(1) = 0 $$ 横余裕 < 10, -9, 0)
                                    }
                                } else {
                                    if ( (枠横幅 - ((JX_max - JX_min) / 図X_SCALE / Twip)) > 80 ) {
                                        YY1 = YY1 + 6
                                    } else {if ( (枠横幅 - ((JX_max - JX_min) / 図X_SCALE / Twip)) > 50 ) {
                                        YY1 = YY1 + 3
                                    } else {if ( (枠横幅 - ((JX_max - JX_min) / 図X_SCALE / Twip)) < 20 ) {
                                        YY1 = YY1 - 1
                                    }
                                }
                                Yy2 = YY1 // + 6 ////////08/08/19
                                if ( ATTAFLAG > 0 ) {
                                    YY1 = YY1 - 4 //////05/05/30 右
                                    if ( (枠横幅 - ((JX_max - JX_min) / 図X_SCALE / Twip)) < 60 $$ iKozo = 3 ) { //////14/08/13
                                    YY1 = YY1 - 2
                                    }
                                }
                                //
                                .FontSize = 荷重寸法Fontsize
                                .PenWidth = 部材荷重寸法Pen幅
                                if ( CreateDxfFlag = 1 ) {
                                    this.PLOTPEN(CSng(.PenWidth))
                                }
                                .PenColor = QBColor(部材荷重寸法Pen色)
             if ( 寸法左右(2) = 0 ) { ////////05/05/29
                                if ( SSAA <= 1 ) {
                                    this.SunPou2("<", NN1, YY1, Yy2, 寸法(), X(), Y(), 99)
                                } else {
                                    if ( BuzaiSunpouSenReverse = 1 ) {
                                        Yy2 = Yy2 - 7 ////////////////////////////////////////08/07/10
                                        if ( ATTAFLAG > 0 ) {
                                            this.CalcMulti(X(), 7 * OuTouBai)
                                            Yy2 = Yy2 + 6 //////////////////////////////////////////////////////////////////////////////////////////06/08/21
                                            this.SunPou2("<", NN1, YY1, Yy2, 寸法(), X(), Y(), 99)
            if ( KTAB = 1 ) {
            //////////////杭地層寸法
                                            if ( 節Y(Dn1(1)) > 節Y(Dn1(NN1)) ) { //////14/09/24
                                                YY1 = YY1 * (-1) ////////////////////////////////////////////////////////////////////////////////////////14/09/24
                                                Yy2 = (Yy2 - 14 * 0) * (-1)
                                            } else {
                                                Yy2 = Yy2 - 14
                                            }
            //                                    if ( m層数 > 1 ) {
            //                                        SSAA = m層数 + 2 ////////15/08/09
            //                                    }
                                            if ( GouikibuzaiIgaiNoSunpou = 1 ) {
                                                this.SunPou2G("<", CInt(SSAA), YY1, Yy2, Dummy寸法(), DummyX(), DummyY(), 99)
                                            } else {
                                                this.SunPou2("<", CInt(SSAA), YY1, Yy2, Dummy寸法(), DummyX(), DummyY(), 99)
                                            }
            //////////////杭地層寸法
            }
                                        } else {
                                            this.SunPou2("<", NN1, YY1, Yy2, 寸法(), X(), Y(), 99)
                                            if ( GouikibuzaiIgaiNoSunpou = 1 ) { ////////////////////////////////////////////////////06/04/21 追加
                                                this.SunPou2G("<", CInt(SSAA), YY1, Yy2, Dummy寸法(), DummyX(), DummyY(), 99)
                                            } else {
                                                this.SunPou2("<", CInt(SSAA), YY1, Yy2, Dummy寸法(), DummyX(), DummyY(), 99)
                                            }
                                        }
                                    } else {
                                        if ( ATTAFLAG > 0 ) {
                                            this.CalcMulti(DummyX(), 7 * OuTouBai)
                                            this.SunPou2("<", NN1, YY1, Yy2, 寸法(), X(), Y(), 99)
                                            if ( GouikibuzaiIgaiNoSunpou = 1 ) {
                                                this.SunPou2G("<", CInt(SSAA), YY1, Yy2, Dummy寸法(), DummyX(), DummyY(), 99)
                                            } else {
                                                this.SunPou2("<", CInt(SSAA), YY1, Yy2, Dummy寸法(), DummyX(), DummyY(), 99)
                                            }
                                        } else {
                                            this.SunPou2("<", NN1, YY1, Yy2, 寸法(), X(), Y(), 99)
                                        }
                                    }
                                }
                                } ////////05/05/29
                            } else {
                                this.X(NN1)
                                this.Y(NN1)
                                this.寸法(NN1)
                                rFlg = 0 //////12/08/
                                For( i = 1 To NN1 //- 1
                                    X(i) = XXXX ////////HEN_X(JX_max)
                                    Y(i) = HEN_Y(節Y(Dn1(i)))
                                    if ( i < NN1 ) {
                                        if ( Dn1(i + 1) <= Jn_max ) {
                                            if ( 節Y0(Dn1(i + 1)) > 節Y0(Dn1(i)) ) {
                                                寸法(i) = F2(Abs(節Y0(Dn1(i + 1)) - 節Y0(Dn1(i))))
                                                rFlg = rFlg + 1
                                                寸法9(rFlg) = 寸法(i)
                                            } else {
            //                                    寸法(i) = ""
                                                if ( 節Y0(Dn1(i + 1)) != 節Y0(Dn1(i)) ) {
                                                寸法(i) = F2(Abs(節Y0(Dn1(i + 1)) - 節Y0(Dn1(i))))
                                                rFlg = rFlg + 1
                                                寸法9(rFlg) = 寸法(i)
                                                }
                                            }
                                        }
                                    }
                                }
                                rFlg = 0
                                //
                                if ( (Abs(d垂直(2) - JX_max) / 図X_SCALE / Twip) > 10 ) { //////09/10/23
                                    YY1 = 16 + 2 - min(6, (Abs(d垂直(2) - JX_max) / 図X_SCALE / Twip) / (2 + g背割れ / 2))
                                    Yy2 = 8 + 4 - min(6, (Abs(d垂直(2) - JX_max) / 図X_SCALE / Twip) / (2 + g背割れ / 2))
                                } else {
                                    YY1 = 16 + 2
                                    Yy2 = 8 + 4
                                }
                                if ( g背割れ != 0 ) { //////////////////////////////////08/06/24
                                    YY1 = YY1 - 8
                                }
                                if ( iKozo = 3 $$ CASN >= 0 ) {
                                    YY1 = YY1 + 9 //6  //////////////////04/11/11 右
                                    if ( CASN >= 0 $$ 垂直寸法位置補正(1) = 0 $$ 横余裕 < 10 ) {
                                    YY1 = YY1 - 9 ////////05/01/29 右
                                    } else {if ( g連続Mod $$ iKozo = 3 ) { //////////// 05/02/25
                                    YY1 = YY1 - 6 //4
                                    }
                                } else {
                                    if ( Jn_max = 2 $$ CASN >= 0 ) { //////////////05/05/28
                                        YY1 = YY1 + 6
                                    } else {
                                        if ( (枠横幅 - ((JX_max - JX_min) / 図X_SCALE / Twip)) > 80 ) {
                                            YY1 = YY1 + 6
                                        } else {if ( (枠横幅 - ((JX_max - JX_min) / 図X_SCALE / Twip)) > 50 ) {
                                            if ( Dummy寸法(1) != "" ) { //////17/06/19
                                                YY1 = YY1 + 3
                                            }
                                        } else {if ( (枠横幅 - ((JX_max - JX_min) / 図X_SCALE / Twip)) < 20 ) {
                                            YY1 = YY1 - 3
                                        }
                                    }
                                }
                                Yy2 = YY1 - 4
                                if ( iKozo = 3 $$ g連続Mod $$ 垂直左右 >= 0 ) { ////////連続梁////////// 05/02/24
                                    YY1 = YY1 - 10
                                    Yy2 = Yy2 - 5
                                }
                                if ( 垂直左右 < 0 ) {
                                      YY1 = -YY1: Yy2 = -Yy2
                                }
                                .FontSize = 荷重寸法Fontsize
                                .PenWidth = 部材荷重寸法Pen幅
                                if ( CreateDxfFlag = 1 ) {
                                    this.PLOTPEN(CSng(.PenWidth))
                                }
                                .PenColor = QBColor(部材荷重寸法Pen色)
                                this.SunPou2("<", NN1, YY1, Yy2, 寸法(), X(), Y(), 99)
                                if ( KTAB = 1 $$ m層数 > 0 ) { //////////14/08/21 地層線表示
                                    YY1 = YY1 - 10
                                    Yy2 = Yy2 - 12 - 4
                                    SSAA = 0
                                    LL77(0) = 0
                                    For( i = 1 To m層数 + 1
                                        SSAA = SSAA + 1
                                        GFLAG(SSAA) = 1
                                        DummyX(SSAA) = XXXX ////////HEN_X(JX_max) + 250
                                        DummyY(SSAA) = HEN_Y(節Y(m杭後) + LL77(0) * m杭縮尺)
                                        Dummy寸法(SSAA) = F2(LL77(i))
                                        LL77(0) = LL77(0) + LL77(i)
                                    }
                                    this.SunPou2G("<", CInt(SSAA), YY1, Yy2, Dummy寸法(), DummyX(), DummyY(), 99)
                                }
                            }
                            if ( KTAB = 1 $$ m層数 > 1 ) { ////////////////////地層線  破線
                                    X1 = HEN_X(節X(m杭先)) - 500
                                    X2 = HEN_X(節X(m杭後)) + 500
                                    LL77(0) = 0
                                    For( i = 1 To m層数 - 1
                                        LL77(0) = LL77(0) + LL77(i)
                                        y1 = HEN_Y(節Y(m杭後) + LL77(0) * m杭縮尺)
                                        Y2 = y1
                                        this.PlotLine1_FG(CDbl(X2), CDbl(Y2), CDbl(X1), CDbl(y1), 2)
                                    }
                                    LL77(0) = LL77(0) + LL77(i)
                                    y1 = HEN_Y(節Y(m杭後) + LL77(0) * m杭縮尺)
                                    Y2 = y1
                                    this.PlotLine1_FG(CDbl(X2), CDbl(Y2), CDbl(X1), CDbl(y1), 2)
                            }
                        }

                }TAB

              //
              ////////////////////////////////////////垂直左//////////垂直左//////////垂直左//////////垂直左//////////垂直左寸法　④
              //
            //      For( i = 1 To SSAA
            //            Dummy9寸法(i) = Dummy寸法(i)
            //            Dummy寸法(i) = ""
            //      }
            //                For( i = 1 To 部材_max //1000
            //                    FBuzaiNumber1(i) = 0
            //                    FBuzaiNumber2(i) = 0
            ////                    Dn1(i) = 0
            //                }
            //
            For( i = 1 To 部材_max //////10/04/07
                FAFA(i) = 0
            }
            //
              SSAA = 0
                        JouhouSunpouCalcFlag = 0
                        if ( 柱間離れ(1) != -99999 ) { //////14/01/06
                            if ( iKozo = 1 ) {
                                xHASIRA = max(柱間離れ(1), XXYY(4))
                            } else {
                                xHASIRA = min(柱間離れ(1), XXYY(2))
                            }
                        } else {
                            xHASIRA = XXYY(2)
                        }
            //                xHASIRA = min(柱間離れ(1), XXYY(2)) ////////15/08/09
            //                if ( 階段Mod ) {
            //                    xHASIRA = XXYY(2)
            //                }
                        this.varPointSelect_Kairyou(2, Jn_max, 節X0(), 節Y0(), 部材_max, 部I(), 部J(), 部材名(), ZZBuzaiBai(), _
                                                    NN2, Dn2(), ZZBuzaiBai(), wRR(), , , iKozo, xHASIRA + 0.1) ////////09/10/20
                        bOutput1 = False //////09/10/05コメントにした 09/10/20解除
            //  //
            if ( g柱本数 < 2 || 階段Mod ) { NN2 = 1
            if ( NN2 >= 2 ) {
            For( i = 1 To NN2
            if ( 節X(Dn2(i)) > 柱間離れ(1) + (柱間離れ(1) + 柱間離れ(2)) * 0.3 ) {
            //        Dn2(i) = -Dn2(i)//////12/08/10コメント
            }

            //    For( HIH = 1 To NN1 ////////////////////////09/03/27 09/10/22コメント
            //        if ( Dn1(HIH) = Dn2(i) $$ HIH != 1 $$ HIH != NN1 ) { ////////09/04/02
            //            Dn2(i) = 0
            //            Exit For
            //        }
            //    Next HIH
            }
            HIH = 0
            For( i = 1 To NN2
            if ( Dn2(i) > 0 $$ (節Y0(Abs(Dn2(i + 1))) != 節Y0(Abs(Dn2(i))) || i = NN2) ) { ////////13/06/07
                HIH = HIH + 1
                Dn2(HIH) = Dn2(i)
            }
            }
            if ( NN2 != HIH ) {
                Dn2(NN2) = 0
                NN2 = HIH
            }
            }
            //  if ( iKozo = 1 ) { NN2 = 0 ////////////////////////////////////////////// 左はとあえず中止する    05/09/20   06/04/21 コメントにした
            //
            if ( NN2 = 2 $$ Abs(節Y(Dn2(1)) - 節Y(Dn2(2))) = k杭長 ) {
                NN2 = 1
            }
            var W9 As Integer
            if ( NKUI = 0 ) { ////////////////////  06/04/21
                W9 = 2
            } else {
                W9 = 3
            }
            //    if ( NN2 >= W9 ) { //////////////////////////// 05/05/30
            //        For( i = W9 To NN2
            //          For( HIH = 1 To 部材_max
            //              if ( ZZBuzaiBai(HIH) != 0 ) {
            //                  if ( Dn2(i) = ILineGX(HIH) $$ (FAngle(HIH) = 270 || FAngle(HIH) = 90) ) {
            //                      Dn2(i - 1) = JLineGX(HIH)
            //                      Exit For
            //                  }
            //                  if ( Dn2(i) = JLineGX(HIH) $$ (FAngle(HIH) = 270 || FAngle(HIH) = 90) ) {
            //                      Dn2(i - 1) = ILineGX(HIH)
            //                      Exit For
            //                  }
            //              }
            //          Next HIH
            //        }
            //    }
                        if ( NN2 > 1 $$ (FR橋脚 = 1 || FR橋脚 = 2) ) { //////10/11/03
                            if ( NN2 != NN1 ) {
            //                        For( i = 1 To NN2
            //                            For( j = 1 To NN1
            //                                if ( 節Y(Dn2(i)) != 節Y(Dn1(j)) ) {
            //                                    bOutput1 = True
            //                                    Exit For
            //                                }
            //                            }
            //                            if ( bOutput1 = True ) { Exit For
            //                        }
                                bOutput1 = True
                            } else {
                                For( i = 1 To NN2
                                    if ( 節Y(Dn2(i)) != 節Y(Dn1(i)) ) {
                                        bOutput1 = True
                                        Exit For
                                    } else {
                                        if ( Dn2(i) != Dn1(i) ) {
                                            bOutput1 = True
                                            Exit For
                                        }
                                    }
                                Next
                            }
                        }
                        For( i = 1 To 部材_max //1000
                            FBuzaiNumber1(i) = 0
                            FBuzaiNumber2(i) = 0
                        }
            if ( gouikidddd = 1 $$ Atta寸法 = 1 ) { bOutput1 = True
                        if ( bOutput1 $$ (CASN < 0 || CheckSuityuoku(Jn_max, 節X0(), 節Y0(), 部材_max, 部I(), 部J()) = 1) ) {
                            if ( gouikidddd = 1 ) { //////And Atta寸法 = 1 ) {
                                this.X(NN2)
                                this.Y(NN2)
                                this.寸法(NN2)
            //                        if ( NN1 != NN2 ) {
            //                        this.寸法9(NN2)
            //                        }
                                For( i = 1 To NN2
                                    X(i) = HEN_X(JX_min)
                                    Y(i) = HEN_Y(節Y(Dn2(i)))
                                    if ( i < NN2 ) {
                                        if ( Dn2(i + 1) <= Jn_max ) {
                                            寸法(i) = F2(Abs(節Y0(Dn2(i + 1)) - 節Y0(Dn2(i))))
                                            if ( 寸法9(i) != 寸法(i) ) { rFlg = 1
                                        }
                                    }
                                }
            //                        if ( (gouikidddd = 1 $$ Atta寸法 = 1) ) { rFlg = 1 ////////// 05/05/30  06/05/17
                                CheckFgFg = 1 //////09/10/23
                                if ( rFlg = 1 || gouikidddd = 1 ) { //////14/05/01//////09/10/05////////Or rFlg = 0 ) { ////////// 05/02/08
                                SSAA = 0 ////////09/10/20
                                For( i = st To NN2 - 1
                                    GGII = Dn2(i)
                                    GGjj = Dn2(i + 1)
                                    For( HIH = 1 To 部材_max
                                        if ( ZZBuzaiBai(HIH) != 0 ) {
                                            if ( (ILineGX(HIH) = GGII $$ JLineGX(HIH) = GGjj) || (ILineGX(HIH) = GGjj $$ JLineGX(HIH) = GGII) ) {
                                                SSAA = SSAA + 1
                                                if ( Abs(節Y0(Dn2(i + 1)) - 節Y0(Dn2(i))) > 0 ) { //////09/10/23
                                                    FAFA(SSAA) = HIH
                                                    if ( (ILineGX(HIH) = GGII $$ JLineGX(HIH) = GGjj) ) { ////////09/10/20
                                                        UpDownFlag(FAFA(SSAA)) = 1
                                                    }
                                                    if ( (ILineGX(HIH) = GGjj $$ JLineGX(HIH) = GGII) ) { ////////09/10/20
                                                        UpDownFlag(FAFA(SSAA)) = -1
                                                    }
                                                    CheckFgFg = 0
                                                } else {
                                                    FAFA(SSAA) = 0
                                                }
                                                Exit For( ////////09/10/23
                                            } else {
            //                                    CheckFgFg = 1
            //                                    Exit For( ////////09/10/20
                                            }
                                        }
                                    Next HIH
            //                            if ( CheckFgFg = 1 ) {
            //                                Exit For
            //                            }
                                }
            //                        if ( CheckFgFg = 1 $$ Dn2(st) = 0 ) { ////////09/10/20
            //                            CheckFgFg = 0
            //                        }
                                SSAA = 0
                                if ( CheckFgFg = 1 ) {
                                    For( i = st To NN2 - 1
                                        ASF1 = 0
            ////////09/04/02 コメントをはずした
            //                                For( j = 1 To 部材_max //////////////08/01/099
            //                                    if ( ZZBuzaiBai(j) != 0 ) { ////////09/10/20////////And CASN < 0 ) { //////////////08/01/099
            //                                        if ( i = NN2 - 1 ) {
            //                                            if ( Dn2(i) = FBuzaiJ(j) $$ (FAngle(j) = 270) ) {
            //                                                ASF1 = 1
            //                                                FBuzaiNumber1(i) = j
            //                                                Exit For
            //                                            }
            //                                            if ( Dn2(i) = FBuzaiI(j) $$ (FAngle(j) = 90) ) {
            //                                                ASF1 = 1
            //                                                FBuzaiNumber1(i) = j
            //                                                Exit For
            //                                            }
            //                                        } else {
            //                                            if ( Dn2(i) = FBuzaiJ(j) $$ (FAngle(j) = 270) ) {
            //                                                ASF1 = 1
            //                                                FBuzaiNumber1(i) = j
            //                                                Exit For
            //                                            }
            //                                            if ( Dn2(i) = FBuzaiI(j) $$ (FAngle(j) = 90) ) {
            //                                                ASF1 = 1
            //                                                FBuzaiNumber1(i) = j
            //                                                Exit For
            //                                            }
            //                                        }
            //                                        if ( (Dn2(i) = FBuzaiJ(j) $$ Dn2(i + 1) = FBuzaiI(j)) || _
            //                                                    (Dn2(i + 1) = FBuzaiJ(j) $$ Dn2(i) = FBuzaiI(j)) ) { ////////07/12/29
            //                                            ASF1 = 1
            //                                            FBuzaiNumber1(i) = j
            //                                            Exit For
            //                                        }
            //                                    }
            ////                                }
            //                                if ( ASF1 = 0 ) {
            //                                    GHGH = 0
            //                                    For( j = 1 To 部材_max
            //                                        if ( ZZBuzaiBai(j) != 0 ) {
            //                                        if ( Dn1(i) = FBuzaiJ(j) $$ (FAngle(j) = 0 || FAngle(j) = 180) ) {
            //                                            GHGH = FBuzaiI(j)
            //                                            Exit For
            //                                        }
            //                                        }
            //                                    }
            //                                    if ( GHGH > 0 ) {
            //                                        For( j = 1 To 部材_max
            //                                            if ( ZZBuzaiBai(j) != 0 ) {
            //                                            if ( i = NN1 - 1 ) {
            //                                            } else {
            //                                                if ( (GHGH = FBuzaiJ(j) || GHGH = FBuzaiI(j)) $$ (FAngle(j) = 90 || FAngle(j) = 270) ) {
            //                                                    FBuzaiNumber1(i) = j
            //                                                    Exit For
            //                                                }
            //                                            }
            //                                            }
            //                                        }
            //                                    }
            //                                }
            //                                if ( ZZBuzaiBai(i) > 0 $$ ZZBuzaiBai(i) <= 部材_max ) {
            //                                    FBuzaiNumber1(i) = ZZBuzaiBai(i) //////////08/01/099
            //                                    ASF1 = 1
            //                                }
                                    }
                                } //////////////////////////09/10/23
            //                            For( i = st To NN2 - 1
            //                                SSAA = SSAA + 1
            //                                if ( FBuzaiNumber1(i) <= 0 || FBuzaiNumber1(i) > 部材_max ) { ////////08/01/099
            //                                    FAFA(SSAA) = 0
            //                                } else {
            ////                                    FAFA(SSAA) = FBuzaiNumber1(i) ////////09/10/20
            //                                    if ( FAngle(FAFA(SSAA)) = 90 ) {
            //                                        UpDownFlag(FAFA(SSAA)) = 1
            //                                    } else {
            //                                        UpDownFlag(FAFA(SSAA)) = -1
            //                                    }
            //                                }
            //                            }
            //                        } else {
            //                            For( i = 1 To NN2 - 1
            //                                GGII = Dn2(i)
            //                                GGjj = Dn2(i + 1)
            //                                For( HIH = 1 To 部材_max
            //                                    if ( ZZBuzaiBai(HIH) != 0 ) {
            //                                    if ( (ILineGX(HIH) = GGII $$ JLineGX(HIH) = GGjj) || (ILineGX(HIH) = GGjj $$ JLineGX(HIH) = GGII) ) {
            //                                        SSAA = SSAA + 1
            //                                        FAFA(SSAA) = HIH
            //                                        if ( (ILineGX(HIH) = GGII $$ JLineGX(HIH) = GGjj) ) {
            //                                            UpDownFlag(FAFA(SSAA)) = 1
            //                                        }
            //                                        if ( (ILineGX(HIH) = GGjj $$ JLineGX(HIH) = GGII) ) {
            //                                            UpDownFlag(FAFA(SSAA)) = -1
            //                                        }
            //                                        Exit For
            //                                    }
            //                                    }
            //                                Next HIH
            //                            }
            //                        }////////09/10/23
                                SSAA = 0
                                //
                                ATTAFLAG = 0
                                if ( BuzaiSunpouSenWriteFlag = 1 $$ CASN < 0 ) { ////////07/12/29
                                    For( i = 1 To NN2 - 1 //////////////09/10/23
                                        if ( ILineG(FAFA(i)) > 0 || JLineG(FAFA(i)) > 0 ) {
                                            ATTAFLAG = ATTAFLAG + 1
                                        }
                                    } //////////////09/10/23
                                    For( i = 1 To NN2 - 1
                                        if ( FAFA(i) > 0 $$ (ILineG(FAFA(i)) > 0 || JLineG(FAFA(i)) > 0) $$ _
                                           ZBuzaiLength(FAFA(i)) != ILineG(FAFA(i)) + JLineG(FAFA(i)) ) { //////08/01/099
                                            if ( ILineG(FAFA(i)) > 0 $$ JLineG(FAFA(i)) > 0 ) {
                                                if ( UpDownFlag(FAFA(i)) = -1 ) {
                                                    ATTAFLAG = 1
                                                    SSAA = SSAA + 1
                                                    GFLAG(SSAA) = 1
                                                    DummyX(SSAA) = HEN_X(JX_min)
                                                    DummyY(SSAA) = HEN_Y(節Y(Dn2(i)))
                                                    Dummy寸法(SSAA) = F2(Abs(JLineG(FAFA(i))))
                                                    SSAA = SSAA + 1
                                                    GFLAG(SSAA) = 1
                                                    DummyX(SSAA) = HEN_X(JX_min)
                                                    DummyY(SSAA) = HEN_Y(節Y(Dn2(i)) + JLineG(FAFA(i)))
                                                    Dummy寸法(SSAA) = F2(Abs(節Y(Dn2(i + 1)) - 節Y(Dn2(i)) - JLineG(FAFA(i)) - ILineG(FAFA(i))))
                                                    SSAA = SSAA + 1
                                                    GFLAG(SSAA) = 1
                                                    DummyX(SSAA) = HEN_X(JX_min)
                                                    DummyY(SSAA) = HEN_Y(節Y(Dn2(i)) + (節Y(Dn2(i + 1)) - 節Y(Dn2(i)) - ILineG(FAFA(i))))
                                                    Dummy寸法(SSAA) = F2(Abs(ILineG(FAFA(i))))
                                                } else {
                                                    ATTAFLAG = 1
                                                    SSAA = SSAA + 1
                                                    GFLAG(SSAA) = 1
                                                    DummyX(SSAA) = HEN_X(JX_min)
                                                    DummyY(SSAA) = HEN_Y(節Y(Dn2(i)))
                                                    Dummy寸法(SSAA) = F2(Abs(ILineG(FAFA(i))))
                                                    SSAA = SSAA + 1
                                                    GFLAG(SSAA) = 1
                                                    DummyX(SSAA) = HEN_X(JX_min)
                                                    DummyY(SSAA) = HEN_Y(節Y(Dn2(i)) + ILineG(FAFA(i)))
                                                    Dummy寸法(SSAA) = F2(Abs(節Y(Dn2(i + 1)) - 節Y(Dn2(i)) - JLineG(FAFA(i)) - ILineG(FAFA(i))))
                                                    SSAA = SSAA + 1
                                                    GFLAG(SSAA) = 1
                                                    DummyX(SSAA) = HEN_X(JX_min)
                                                    DummyY(SSAA) = HEN_Y(節Y(Dn2(i)) + (節Y(Dn2(i + 1)) - 節Y(Dn2(i)) - JLineG(FAFA(i))))
                                                    Dummy寸法(SSAA) = F2(Abs(JLineG(FAFA(i))))
                                                }
                                            } else {
                                                if ( ILineG(FAFA(i)) > 0 ) {
                                                    if ( UpDownFlag(FAFA(i)) = -1 ) {
                                                        ATTAFLAG = 1
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = HEN_X(JX_min)
                                                        DummyY(SSAA) = HEN_Y(節Y(Dn2(i)))
                                                        Dummy寸法(SSAA) = F2(Abs(節Y(Dn2(i + 1)) - 節Y(Dn2(i)) - ILineG(FAFA(i))))
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = HEN_X(JX_min)
                                                        DummyY(SSAA) = HEN_Y(節Y(Dn2(i + 1)) - ILineG(FAFA(i)))
                                                        Dummy寸法(SSAA) = F2(Abs(ILineG(FAFA(i))))
                                                        SSAA = SSAA
                                                    } else {
                                                        ATTAFLAG = 1
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = HEN_X(JX_min)
                                                        DummyY(SSAA) = HEN_Y(節Y(Dn2(i)))
                                                        Dummy寸法(SSAA) = F2(Abs(ILineG(FAFA(i))))
                                                        SSAA = SSAA + 1
                                                        GFLAG(SSAA) = 1
                                                        DummyX(SSAA) = HEN_X(JX_min)
                                                        DummyY(SSAA) = HEN_Y(節Y(Dn2(i)) + ILineG(FAFA(i)))
                                                        Dummy寸法(SSAA) = F2(Abs(節Y(Dn2(i + 1)) - 節Y(Dn2(i)) - ILineG(FAFA(i))))
                                                    }
                                                } else {
                                                    if ( JLineG(FAFA(i)) > 0 ) {
                                                        if ( UpDownFlag(FAFA(i)) = -1 ) {
                                                            ATTAFLAG = 1
                                                            SSAA = SSAA + 1
                                                            GFLAG(SSAA) = 1
                                                            DummyX(SSAA) = HEN_X(JX_min)
                                                            DummyY(SSAA) = HEN_Y(節Y(Dn2(i)))
                                                            Dummy寸法(SSAA) = F2(Abs(JLineG(FAFA(i))))
                                                            SSAA = SSAA + 1
                                                            GFLAG(SSAA) = 1
                                                            DummyX(SSAA) = HEN_X(JX_min)
                                                            DummyY(SSAA) = HEN_Y(節Y(Dn2(i)) + JLineG(FAFA(i)))
                                                            Dummy寸法(SSAA) = F2(Abs(節Y(Dn2(i + 1)) - 節Y(Dn2(i)) - JLineG(FAFA(i))))
                                                        } else {
                                                            ATTAFLAG = 1
                                                            SSAA = SSAA + 1
                                                            GFLAG(SSAA) = 1
                                                            DummyX(SSAA) = HEN_X(JX_min)
                                                            DummyY(SSAA) = HEN_Y(節Y(Dn2(i)))
                                                            Dummy寸法(SSAA) = F2(Abs(節Y(Dn2(i + 1)) - 節Y(Dn2(i)) - JLineG(FAFA(i))))
                                                            SSAA = SSAA + 1
                                                            GFLAG(SSAA) = 1
                                                            DummyX(SSAA) = HEN_X(JX_min)
                                                            DummyY(SSAA) = HEN_Y(節Y(Dn2(i)) + 節Y(Dn2(i + 1)) - 節Y(Dn2(i)) - JLineG(FAFA(i)))
                                                            Dummy寸法(SSAA) = F2(Abs(JLineG(FAFA(i))))
                                                        }
                                                    }
                                                }
                                            }
                                        } else {
                                            SSAA = SSAA + 1
                                            GFLAG(SSAA) = 0
                                            DummyX(SSAA) = HEN_X(JX_min)
                                            DummyY(SSAA) = HEN_Y(節Y(Dn2(i)))
                                            Dummy寸法(SSAA) = F2(Abs(節Y(Dn2(i + 1)) - 節Y(Dn2(i))))
                                        }
                                    }
                               } ////////// 05/02/08
                                    //
                                    SSAA = SSAA + 1
                                    GFLAG(SSAA) = 1
                                    DummyX(SSAA) = HEN_X(JX_min)
                                    DummyY(SSAA) = HEN_Y(節Y(Dn2(NN2)))
                                    Dummy寸法(SSAA) = ""
            //      if ( gouikidddd = 1 $$ Atta寸法 = 1 ) { rFlg = 0 ////////////05/05/30
                                rFlg = 0 ////////////06/05/17
            //                        if ( CASN < 0 ) { ////////07/06/266
                                    For( i = 1 To NN2 - 1
                                          if ( Dummy9寸法(i) != 寸法(i) ) {
                                              rFlg = 1
                                              Exit For
                                          }
                                    }
                                    if ( CASN >= 0 ) { ////////09/10/20
                                        rFlg = 1
                                    }
            //                        }
                          } else {
                                rFlg = 0 ////////07/06/266
                                GoTo SKIP //////////////////////////////10/04/08
                          }
             if ( (寸法左右(1) = 1 || rFlg = 0) $$ NN1 = NN2 ) { return; ////////05/05/29  07/06/266
            //                        if ( (Abs(d垂直(1) - JX_min) / 図X_SCALE / Twip) > 10 ) { //////09/10/22
            //                            YY1 = -15 + (Abs(d垂直(1) - JX_min) / 図X_SCALE / Twip) / (2 + g背割れ / 2)
            //                            Yy2 = -8 - 3 - 7 + (Abs(d垂直(1) - JX_min) / 図X_SCALE / Twip) / (2 + g背割れ / 2)
            //                        } else {
                                    YY1 = -15 + g背割れ
                                    Yy2 = -8 - 3 - 7 + g背割れ //////09/10/22
            //                        }
                                if ( iKozo = 3 $$ CASN >= 0 ) {
            //                            YY1 = YY1 - 5
                                    YY1 = YY1 - 8 // - 4 ////////////////// 04/07/08
                                    YY1 = YY1 + IIf(CASN >= 0 $$ 垂直寸法位置補正(2) = 0 $$ 横余裕 < 10, 8, 0)  //////05/01/29 左
                                } else {
            //                            if ( iKozo = 1 $$ CASN >= 0 ) { YY1 = YY1 + 2 //////05/01/30 左
            //                            YY1 = YY1 - 2
                                    if ( (枠横幅 - ((JX_max - JX_min) / 図X_SCALE / Twip)) > 80 ) { //////////////06/05/17
                                        if ( g背割れ = 0 $$ CASN >= 0 ) { ////////09/10/22
                                            YY1 = YY1 - 6
                                        } else {
                                            YY1 = YY1 - 3
                                        }
                                    } else {if ( (枠横幅 - ((JX_max - JX_min) / 図X_SCALE / Twip)) > 50 ) {
                                        YY1 = YY1 - 1 //////09/08/07   -3
                                        if ( (枠横幅 - ((JX_max - JX_min) / 図X_SCALE / Twip)) < 60 $$ iKozo = 3 ) { //////14/08/13
                                            YY1 = YY1 + 2
                                            if ( iKozo = 3 ) {
                                                Yy2 = Yy2 + 6
                                            }
                                        }
                                    } else {if ( (枠横幅 - ((JX_max - JX_min) / 図X_SCALE / Twip)) < 20 ) {
                                        YY1 = YY1 + 2
                                    }
                                    if ( CASN >= 0 ) { ////////09/10/20
                                        YY1 = YY1 - 2
                                        Yy2 = YY1 + 6
                                    }
                                }
            //                        if ( gouikidddd = 1 $$ Atta寸法 = 1 ) { YY1 = YY1 + 5
                                .FontSize = 荷重寸法Fontsize
                                .PenWidth = 部材荷重寸法Pen幅
                                if ( CreateDxfFlag = 1 ) {
                                    this.PLOTPEN(CSng(.PenWidth))
                                }
                                .PenColor = QBColor(部材荷重寸法Pen色)
                                if ( SSAA <= 1 ) {
                                    this.SunPou2("<", NN2, YY1, Yy2, 寸法(), X(), Y(), 1)
                                } else {
                                    if ( BuzaiSunpouSenReverse = 1 ) {
                                        if ( ATTAFLAG > 0 ) {
                                            this.CalcMulti(X(), -7 * OuTouBai)
                                            this.SunPou2("<", NN2, YY1, Yy2, 寸法(), X(), Y(), 1)
                                            if ( GouikibuzaiIgaiNoSunpou = 1 ) {
                                                this.SunPou2G("<", CInt(SSAA), YY1, Yy2, Dummy寸法(), DummyX(), DummyY(), 1)
                                            } else {
                                                this.SunPou2("<", CInt(SSAA), YY1, Yy2, Dummy寸法(), DummyX(), DummyY(), 1)
                                            }
                                        } else {
                                            this.SunPou2("<", NN2, YY1, Yy2, 寸法(), X(), Y(), 1)
                                        }
                                    } else {
                                        if ( ATTAFLAG > 0 ) {
                                            this.CalcMulti(DummyX(), -7 * OuTouBai)
                                            this.SunPou2("<", NN2, YY1, Yy2, 寸法(), X(), Y(), 1)
                                            if ( GouikibuzaiIgaiNoSunpou = 1 ) {
                                                this.SunPou2G("<", CInt(SSAA), YY1, Yy2, Dummy寸法(), DummyX(), DummyY(), 1)
                                            } else {
                                                this.SunPou2("<", CInt(SSAA), YY1, Yy2, Dummy寸法(), DummyX(), DummyY(), 1)
                                            }
                                        } else {
                                            this.SunPou2("<", NN2, YY1, Yy2, 寸法(), X(), Y(), 1)
                                        }
                                    }
                                }
                            } else {
                                this.X(NN2)
                                this.Y(NN2)
                                this.寸法(NN2)
            //                        if ( NN1 != NN2 ) {
            //                        this.寸法9(NN2)
            //                        }
                                For( i = 1 To NN2
                                    X(i) = HEN_X(JX_min)
                                    Y(i) = HEN_Y(節Y(Dn2(i)))
                                    if ( i < NN2 ) {
                                        if ( Dn2(i + 1) <= Jn_max ) {
                                            寸法(i) = F2(Abs(節Y0(Dn2(i + 1)) - 節Y0(Dn2(i))))
                                            if ( 寸法9(i) != 寸法(i) ) { rFlg = 1
                                        }
                                    }
                                }
                                if ( rFlg = 1 ) {
                                YY1 = -15
                                Yy2 = -8 - 3
                                if ( iKozo = 3 $$ CASN >= 0 ) {
                                    if ( g連続Mod ) { //////////// 05/02/26
                                    YY1 = YY1 + 4
                                    Yy2 = Yy2 + 4
                                    } else {
                                    YY1 = YY1 - 5 - 4
                                    YY1 = YY1 + IIf(CASN >= 0 $$ 垂直寸法位置補正(2) = 0 $$ 横余裕 < 10, 8, 0)  //////05/01/29 左
                                    }
                                } else {
            //                            if ( iKozo = 1 $$ CASN >= 0 ) { YY1 = YY1 + 2 //////05/01/30 左
                                    if ( (枠横幅 - ((JX_max - JX_min) / 図X_SCALE / Twip)) > 80 ) { //////////////06/05/17
                                        YY1 = YY1 - 6
                                    } else {if ( (枠横幅 - ((JX_max - JX_min) / 図X_SCALE / Twip)) > 50 ) {
                                        YY1 = YY1 - 3
                                    } else {if ( (枠横幅 - ((JX_max - JX_min) / 図X_SCALE / Twip)) < 20 ) {
                                        YY1 = YY1 + 2
                                    }
                                }
                                if ( 垂直左右 < 0 ) {  ////////////////////09/10/20
                                      YY1 = -YY1: Yy2 = -Yy2
                                }
                                .FontSize = 荷重寸法Fontsize
                                .PenWidth = 部材荷重寸法Pen幅
                                if ( CreateDxfFlag = 1 ) {
                                    this.PLOTPEN(CSng(.PenWidth))
                                }
                                .PenColor = QBColor(部材荷重寸法Pen色)
                                this.SunPou2("<", NN2, YY1, Yy2, 寸法(), X(), Y(), 1)
                                }
                            }
                        }
                    }
            //        }
            SKIP:

            End With
            BuzaiGAri = 0
            /*/
        }

        /* private void CalcMulti(D(), AAA As Single)
//
var i                       As Integer
var ii                      As Integer
//
ii = UBound(D(), 1)
For( i = 1 To ii
    D(i) = D(i) + AAA
}
//
}
*/

        private int CheckSuityuoku(int Jn_max, float[] X0, float[] Y0, int Bmax, int[] BuzaiI, int[] BuzaiJ)
        {
            return 0;
            /*/
            var i                       As Integer
            double var X
            double var Y
            double var STARTX
            double var ENDX
            double var STARTY
            double var ENDY
            double var ANG
            double var SLASHLEN
            double var TEMPANG
            double var GOSA
            double var XLEN
            double var YLEN
            var Atta                    As Integer
            //
            Atta = 0
            For( i = 1 To Bmax
                STARTX = X0(BuzaiI(i))
                ENDX = X0(BuzaiJ(i))
                STARTY = Y0(BuzaiI(i))
                ENDY = Y0(BuzaiJ(i))
                GOSA = 5
                XLEN = Abs(STARTX - ENDX)
                YLEN = Abs(STARTY - ENDY)
                this.CALCANGLEN(YLEN, 90, XLEN, SLASHLEN, TEMPANG, ANG)
                if ( STARTY > ENDY ) {
                    ANG = -ANG
                }
                if ( XLEN > -GOSA $$ XLEN < GOSA ) {
                    ANG = 90
                } else {
                    if ( YLEN > -GOSA $$ YLEN < GOSA ) {
                        ANG = 0
                    }
                }
                if ( ANG = 90 ) {
                    Atta = 1
                    Exit For
                }
            }
            if ( Bmax < 2 ) { Atta = 1
            CheckSuityuoku = Atta
            /*/
        }

        private void 部材DATA整理()
        {
            /*/
            var i                       As Integer
            var X0
            var Y0
            var XE
            var YE
            var BTAN
            var 部材角度i
            var 部材角度j
            var 節点部材数
            var ret
            //
            this.節点部材角度(Jn_max, 50)  //Revarによって中身を初期化する。
            For( i = 1 To 部材_max
                if ( ZZBuzaiBai(i) != 0 ) {
                X0 = 節X(部I(i))
                Y0 = 節Y(部I(i))
                XE = 節X(部J(i))
                YE = 節Y(部J(i))
                if ( YE = Y0 $$ XE = X0 ) {
                    if ( FR橋脚 = 2 ) {
                        YE = Y0 - 0.001 //02/05/05
                    }
                }
                BTAN = 0
                if ( X0 != XE ) {
                    BTAN = (YE - Y0) / (XE - X0)
                }
                部材角度i = 180 * Atn(BTAN) / π
                if ( X0 > XE ) {
                    部材角度i = 部材角度i + 180
                }
                if ( X0 = XE ) {
                    部材角度i = 90
                    if ( YE < Y0 ) {
                        部材角度i = 270
                    }
                }
                if ( 部材角度i < 0 ) {
                    部材角度i = 部材角度i + 360
                }
                Select Case 部材角度i
                Case 0
                    部材角度j = 180
                Case 180
                    部材角度j = 0
                Case Is > 180
                    部材角度j = 部材角度i - 180
                Case Is > 0
                    部材角度j = 部材角度i + 180
                End Select
                節点部材数 = 節点部材角度(部I(i), 0) + 1
                節点部材角度(部I(i), 0) = 節点部材数
                節点部材角度(部I(i), 節点部材数) = 部材角度i
                節点部材数 = 節点部材角度(部J(i), 0) + 1
                節点部材角度(部J(i), 0) = 節点部材数
                節点部材角度(部J(i), 節点部材数) = 部材角度j
                }
            }
            /*/
        }

        private void OUT_部材荷重(int LCASE)
        {
            /*/
            var 前MOJ
            var NO
            var MOJS
            var MOJE
            var MOJMARK
            var MOJ方向
            var MOJ
            var P1
            var P2
            var MOJL1
            var MOJL2
            var MOJP1
            var MOJP2
            var i                       As Integer
            var ParamAngle              As Single
            var ParamFontSize           As Single
            var ParamXPoint             As Single
            var ParamYpoint             As Single
            var ParamText
            var QWX1                    As Single
            var QWY1                    As Single
            //
            if ( 荷重座標X = 0 ) {
                return;
            }
            if ( Case_部材荷重数(LCASE) = 0 ) {
                return;
            }
            前MOJ = ""
            With frmPrint.vsPrt1
                .FontSize = 荷重文字Fontsize
                .TextAngle = 0
                荷重座標Y = 荷重座標Y + 荷重文字pit * Twip
                MyCurrentX = 荷重座標X * Twip
                MyCurrentY = 荷重座標Y
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, "[部材荷重]"
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = "[部材荷重]"
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
                For( i = 1 To Case_部材荷重数(LCASE)
                    NO = 部材荷重番号(LCASE, i)
                    this.READ部材荷重(NO)
                    MOJS = "ｽﾀｰﾄ" + F0(Md.S)
                    MOJE = "ｴﾝﾄﾞ" + F0(Md.E)
                    MOJMARK = F0(Md.MARK)
                    MOJ方向 = Trim(Md.LDir)
                    if ( MOJ方向 = "" ) {
                        MOJ方向 = "Local"
                    }
                    MOJ = MOJS + MOJE + MOJMARK + MOJ方向
                    if ( 前MOJ != MOJ ) {
                        Select Case Md.MARK
                            Case 1
                                MOJMARK = "部材直角方向集中荷重"
                                P1 = "P1="
                                P2 = "P2="
                            Case 2
                                MOJMARK = "部材直角方向分布荷重"
                                P1 = "W1="
                                P2 = "W2="
                            Case 3
                                MOJMARK = "部材直角方向三角形荷重"
                                P1 = "W1="
                                P2 = "W2="
                            Case 4
                                MOJMARK = "部材直角方向台形荷重"
                                P1 = "W1="
                                P2 = "W2="
                            Case 5
                                MOJMARK = "部材方向集中荷重"
                                P1 = "P1="
                                P2 = "P2="
                            Case 6
                                MOJMARK = "部材方向分布荷重"
                                P1 = "W1="
                                P2 = "W2="
                            Case 7
                                MOJMARK = "部材方向三角形荷重"
                                P1 = "W1="
                                P2 = "W2="
                            Case 8
                                MOJMARK = "部材方向台形分布荷重"
                                P1 = "W1="
                                P2 = "W2="
                            Case 9
                                MOJMARK = "温度変化①(線膨張)"
                                P1 = "P1="
                                P2 = "P2="
                                MOJ方向 = ""
                            Case 10
                                MOJMARK = "温度変化②"
                                P1 = "P1="
                                P2 = "P2="
                                MOJ方向 = ""
                            Case 11
                                MOJMARK = "モーメント荷重"
                                P1 = "M1="
                                P2 = "M2="
                                MOJ方向 = ""
                            Case 12
                                MOJMARK = "プレストレスト二次応力①"
                                P1 = "P1="
                                P2 = "P2="
                                MOJ方向 = ""
                            Case 13
                                MOJMARK = "プレストレスト二次応力②"
                                P1 = "P1="
                                P2 = "P2="
                                MOJ方向 = ""
                            Case 14
                                MOJMARK = "連行荷重"
                                P1 = "P1="
                                P2 = "P2="
                                MOJ方向 = ""
                        End Select
                        荷重座標Y = 荷重座標Y + (荷重文字pit + 2) * Twip
                        MyCurrentY = 荷重座標Y
                        MyCurrentX = 荷重座標X * Twip
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, MOJS
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = MOJS
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                        MyCurrentX = (荷重座標X + 8) * Twip
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, MOJE
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = MOJE
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                        MyCurrentX = (荷重座標X + 18) * Twip
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, MOJMARK
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = MOJMARK
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                        MyCurrentX = (荷重座標X + 46) * Twip
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, MOJ方向
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = MOJ方向
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                        前MOJ = MOJ
                    }
                    MOJL1 = "L1=" + F2(Md.L1)
                    MOJL2 = "L2=" + F2(Md.L2)
                    MOJP1 = P1 + F2(Md.P1)
                    MOJP2 = P2 + F2(Md.P2)
                    荷重座標Y = 荷重座標Y + 荷重文字pit * Twip
                    MyCurrentX = 荷重座標X * Twip
                    MyCurrentY = 荷重座標Y
                    MyCurrentX = (荷重座標X) * Twip
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, MOJP1
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = MOJP1
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                    MyCurrentX = (荷重座標X + 14) * Twip
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, MOJP2
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = MOJP2
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                    MyCurrentX = (荷重座標X + 28) * Twip
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, MOJL1
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = MOJL1
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                    MyCurrentX = (荷重座標X + 40) * Twip
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, MOJL2
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = MOJL2
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                }
            End With
            荷重座標Y = 荷重座標Y + 5 * Twip
            /*/
        }

        private void OUT_節点荷重(int LCASE)
        {
            /*/
            var i
            var NO
            var MOJ
            var MOJX
            var MOJY
            var MOJM
            var ParamAngle              As Single
            var ParamFontSize           As Single
            var ParamXPoint             As Single
            var ParamYpoint             As Single
            var ParamText
            var QWX1                    As Single
            var QWY1                    As Single
            //
            if ( 荷重座標X = 0 ) {
                return;
            }
            if ( Case_節点荷重数(LCASE) = 0 ) {
                return;
            }
            With frmPrint.vsPrt1
                .FontSize = 荷重文字サイズ //荷重文字Fontsize
                .TextAngle = 0
                荷重座標Y = 荷重座標Y + 荷重文字pit * Twip
                MyCurrentX = 荷重座標X * Twip
                MyCurrentY = 荷重座標Y
                PrintoutPrt frmPrint.vsPrt1, "[節点荷重]"
                荷重座標Y = 荷重座標Y + 2 * Twip
                For( i = 1 To Case_節点荷重数(LCASE)
                    NO = 節点荷重番号(LCASE, i)
                    this.READ節点荷重(NO)
                    MOJ = " Jn" + F0(JD.JN)
                    MOJX = " H=" + F2(JD.fX)
                    MOJY = "  P=" + F2(JD.fY)
                    MOJM = " M=" + F2(JD.M)
                    荷重座標Y = 荷重座標Y + 荷重文字pit * Twip
                    MyCurrentY = 荷重座標Y
                    MyCurrentX = 荷重座標X * Twip
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, MOJ
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = MOJ
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                    MyCurrentX = (荷重座標X + 9 - 1) * Twip
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, MOJX
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = MOJX
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                    MyCurrentX = (荷重座標X + 23 + 1) * Twip
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, MOJY
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = MOJY
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                    MyCurrentX = (荷重座標X + 38 + 1) * Twip
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, MOJM
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = MOJM
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                }
            End With
            /*/
        }


        private float 図X(float XX)
        {
            //
            return MathF.Round(XX / this.図X_SCALE, 8);
            //
        }

        private float 図Y(float YY)
        {
            return 1;
            /*/
            float DAN3 = 10 * Twip;
            float DAN4 = 7 * Twip;

if ( NoKaikin = 1 ) {
    Select Case sYscale
    Case 1
        図Y = Round(YY / 図Y_SCALE + 3 * Twip, 8)
    Case 2
        if ( NKUI = 0 ) {
            図Y = Round(YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI) * Twip / 1.6, 10)
        } else {
            図Y = Round(YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI - 3) * Twip / 4, 10) ///2.7
            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                図Y = 図Y // - 5 * Twip
            }
            if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                図Y = 図Y // - 0 * Twip
            }
        }
    Case 3
        if ( NKUI = 0 ) {
            図Y = Round(YY / 図Y_SCALE / sNN + (図縦幅 + UEHOSEI) * Twip / 5, 10)
        } else {
            図Y = Round(YY / 図Y_SCALE / sNN + (図縦幅 + UEHOSEI + 15 - 3 + 33) * Twip / 2.2, 10) ///2.6
            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                図Y = 図Y + 6 * Twip
            }
            if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                図Y = 図Y // - 0 * Twip
            }
        }
    Case } else {
    End Select
} else {    // 荷重図の３段書き、４段書き対応版のプログラムソース

    Select Case sYscale
    Case 1
        図Y = Round(YY / 図Y_SCALE + 3 * Twip, 8)
    Case 2
        if ( NKUI = 0 ) {
            図Y = Round(YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI) * Twip / 1.6, 10)
        } else {
            図Y = Round(YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI - 3) * Twip / 4, 10) ///2.7
            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                図Y = 図Y // - 5 * Twip
            }
            if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                図Y = 図Y // - 0 * Twip
            }
        }
    Case 3
        if ( NKUI = 0 ) {
            図Y = Round(YY / 図Y_SCALE / sNN + (図縦幅 + UEHOSEI) * Twip / 5, 10)
        } else {
            図Y = Round(YY / 図Y_SCALE / sNN + (図縦幅 + UEHOSEI + 15 - 3 + 33) * Twip / 2.2, 10) ///2.6
            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                図Y = 図Y + 6 * Twip
            }
            if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                図Y = 図Y // - 0 * Twip
            }
        }
    Case 4      // 荷重図を３段書きする場合の１番目の位置
        if ( NKUI = 0 ) {
            図Y = Round(YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI) * Twip / 1.6 * 1.25, 10) - DAN3
        } else {
            図Y = Round(YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI - 3) * Twip / 4 * 1.25, 10) ///2.7
            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                図Y = 図Y // - 5 * Twip
            }
            if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                図Y = 図Y // - 0 * Twip
            }
        }
    Case 5      // 荷重図を３段書きする場合の２番目の位置
        if ( NKUI = 0 ) {
            図Y = Round(YY / 図Y_SCALE / sNN + (図縦幅 + UEHOSEI) * Twip / 5 * 0.4, 10) - DAN3
        } else {
//                図Y = Round(YY / 図Y_SCALE / sNN + (図縦幅 + UEHOSEI + 15 - 3 + 33) * Twip / 2.2 * 0.4, 10) ///2.6
            図Y = Round(YY / 図Y_SCALE / sNN + (図縦幅 - UEHOSEI - 3 + (15 + 33)) * Twip / 2.2 * 1.25, 10)
            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                図Y = 図Y // + 6 * Twip
            }
            if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                図Y = 図Y // - 0 * Twip
            }
        }
    Case 6      // 荷重図を３段書きする場合の３番目の位置
        if ( NKUI = 0 ) {
            図Y = Round(YY / 図Y_SCALE / sNN + (図縦幅 + UEHOSEI) * Twip / 5 * 1.25, 10) - DAN3
        } else {
            図Y = Round(YY / 図Y_SCALE / sNN + (図縦幅 + UEHOSEI + 15 - 3 + 33) * Twip / 2.2 * 1.25, 10) ///2.6
            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                図Y = 図Y // + 6 * Twip
            }
            if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                図Y = 図Y // - 0 * Twip
            }
        }
    Case 7      // 荷重図を４段書きする場合の一番目の位置
        if ( NKUI = 0 ) {
            図Y = Round(YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI) * Twip / 1.6 * 1.35, 10) - DAN4
        } else {
            図Y = Round(YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI - 3) * Twip / 4 * 1.35, 10) ///2.7
            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                図Y = 図Y // - 5 * Twip
            }
            if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                図Y = 図Y // - 0 * Twip
            }
        }
    Case 8      // 荷重図を４段書きする場合の２番目の位置
        if ( NKUI = 0 ) {
            図Y = Round(YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI) * Twip / 1.6 * 0.725, 10) - DAN4
        } else {
            図Y = Round(YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI - 3) * Twip / 4 * 0.725, 10) ///2.7
            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                図Y = 図Y // - 5 * Twip
            }
            if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                図Y = 図Y // - 0 * Twip
            }
        }
    Case 9      // 荷重図を４段書きする場合の３番目の位置
        if ( NKUI = 0 ) {
            図Y = Round(YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI) * Twip / 1.6 * 0.1, 10) - DAN4
        } else {
            図Y = Round(YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI - 3) * Twip / 4 * 0.1, 10) ///2.7
            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                図Y = 図Y // - 5 * Twip
            }
            if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                図Y = 図Y // - 0 * Twip
            }
        }
    Case 10     // 荷重図を４段書きする場合の４番目の位置
        if ( NKUI = 0 ) {
            図Y = Round(YY / 図Y_SCALE / sNN + (図縦幅 + UEHOSEI) * Twip / 5 * 1.6, 10) - DAN4
        } else {
//                図Y = Round(YY / 図Y_SCALE / sNN + (図縦幅 + UEHOSEI + 45) * Twip / 2.2 * 1.6, 10)
            図Y = YY / 図Y_SCALE / sNN
            図Y = 図Y + (図縦幅 + UEHOSEI + 15 - 3 + 33) * Twip / 2.2 * 1.6
            図Y = Round(図Y, 10)
            if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                図Y = 図Y // + 6 * Twip
            }
            if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                図Y = 図Y // - 0 * Twip
            }
        }
    Case } else {
    End Select
}
/*/
        }

        private float HEN_X(float XX)
        {
            //
            return MathF.Round(this.図_X0 + XX / this.図X_SCALE, 8);
            //
        }

        private float HEN_ZX(double XX)
        {
            return 1;
            /*/
            return MathF Round(KuiMaxLen * OuTouBai * (-XX / KuiLengthMax) + OutouStartX, 8)
            /*/
        }

        private float HEN_ZY(double YY)
        {
            return 1;
            /*/
            HEN_ZY = RoundS(KuiMaxLen * OuTouBai * (-YY / KuiLengthMax) + OutouStartY, 8)
            /*/
        }

        private float HEN_Y(float YY)
        {
            return 1;
            /*/
            var DAN3                    As Single
            var DAN4                    As Single
            //
            DAN3 = 10 * Twip
            DAN4 = 7 * Twip
            //
            if ( NoKaikin = 1 ) {
                Select Case sYscale
                Case 1
                    HEN_Y = Round(図_Y0 - YY / 図Y_SCALE, 8)
                Case 2 //二枚書き 上
                    if ( NKUI = 0 ) {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI) * Twip / 1.6, 10)
                    } else {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI - 3) * Twip / 4, 10)   ///2.7
                        if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                            HEN_Y = HEN_Y
                        }
                        if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                            HEN_Y = HEN_Y
                        }
                    }
                Case 3 //二枚書き 下
                    if ( NKUI = 0 ) {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN + (図縦幅 + UEHOSEI) * Twip / 5, 10)
                    } else {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN + (図縦幅 + UEHOSEI + 15 - 3 + 33) * Twip / 2.2, 10) ///2.6
                        if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                            HEN_Y = HEN_Y + 6 * Twip
                        }
                        if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                            HEN_Y = HEN_Y
                        }
                    }
                Case } else {
                End Select
            } else {    // 荷重図の３段書き、４段書き対応版のプログラムソース
                UEHOSEI = 0
                Select Case sYscale
                Case 1
                    HEN_Y = Round(図_Y0 - YY / 図Y_SCALE, 8)
                Case 2 //二枚書き 上
                    if ( NKUI = 0 ) {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI) * Twip / 1.6, 10)
                    } else {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI - 3) * Twip / 4, 10)   ///2.7
                        if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                            HEN_Y = HEN_Y
                        }
                        if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                            HEN_Y = HEN_Y
                        }
                    }
                Case 3 //二枚書き 下
                    if ( NKUI = 0 ) {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN + (図縦幅 + UEHOSEI) * Twip / 5, 10)
                    } else {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN + (図縦幅 + UEHOSEI + 15 - 3 + 33) * Twip / 2.2, 10) ///2.6
                        if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                            HEN_Y = HEN_Y + 6 * Twip
                        }
                        if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                            HEN_Y = HEN_Y
                        }
                    }
                Case 4      // 荷重図を３段書きする場合の１番目の位置
                    if ( NKUI = 0 ) {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI) * Twip / 1.6 * 1.25, 10) - DAN3
                    } else {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI - 3) * Twip / 4 * 1.25, 10) ///2.7
                        if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                            HEN_Y = HEN_Y
                        }
                        if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                            HEN_Y = HEN_Y
                        }
                    }
                Case 5      // 荷重図を３段書きする場合の２番目の位置
                    if ( NKUI = 0 ) {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI) * Twip / 1.6 * 0.4, 10) - DAN3
                    } else {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI - 3) * Twip / 4 * 0.4, 10) ///2.7
                        if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                            HEN_Y = HEN_Y
                        }
                        if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                            HEN_Y = HEN_Y
                        }
                    }
                Case 6      // 荷重図を３段書きする場合の３番目の位置
                    if ( NKUI = 0 ) {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN + (図縦幅 + UEHOSEI) * Twip / 5 * 1.25, 10)
                    } else {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN + (図縦幅 + UEHOSEI + 15 - 3 + 33) * Twip / 2.2 * 1.25, 10) ///2.6
                        if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                            HEN_Y = HEN_Y + 6 * Twip
                        }
                        if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                            HEN_Y = HEN_Y
                        }
                    }
                Case 7      // 荷重図を４段書きする場合の１番目の位置
                    if ( NKUI = 0 ) {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI) * Twip / 1.6 * 1.35, 10) - DAN4
                    } else {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI - 3) * Twip / 4 * 1.35, 10) ///2.7
                        if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                            HEN_Y = HEN_Y
                        }
                        if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                            HEN_Y = HEN_Y
                        }
                    }
                Case 8      // 荷重図を４段書きする場合の２番目の位置
                    if ( NKUI = 0 ) {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI) * Twip / 1.6 * 0.725, 10) - DAN4
                    } else {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI - 3) * Twip / 4 * 0.725, 10) ///2.7
                        if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                            HEN_Y = HEN_Y
                        }
                        if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                            HEN_Y = HEN_Y
                        }
                    }
                Case 9      // 荷重図を４段書きする場合の３番目の位置
                    if ( NKUI = 0 ) {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI) * Twip / 1.6 * 0.1, 10) - DAN4
                    } else {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN - (図縦幅 - UEHOSEI - 3) * Twip / 4 * 0.1, 10) ///2.7
                        if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                            HEN_Y = HEN_Y
                        }
                        if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                            HEN_Y = HEN_Y
                        }
                    }
                Case 10     // 荷重図を４段書きする場合の４番目の位置
                    if ( NKUI = 0 ) {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN + (図縦幅 + UEHOSEI) * Twip / 5 * 1.6, 10) - DAN4
                    } else {
                        HEN_Y = Round(図_Y0 - YY / 図Y_SCALE / sNN + (図縦幅 + UEHOSEI + 15 - 3 + 33) * Twip / 2.2 * 1.6, 10) ///2.6
                        if ( 荷重図フォーマット.int用紙方向 = 0 ) {
                            HEN_Y = HEN_Y + 6 * Twip
                        }
                        if ( 荷重図フォーマット.int用紙方向 = 1 ) {
                            HEN_Y = HEN_Y
                        }
                    }
                Case } else {
                End Select
            }
            /*/
        }

        private float 部材Span(int i0, int IE)
        {
            return 0;
            /*/
            Select Case True
            Case 節X0(IE) = 節X0(i0)
                部材Span = Round(Abs(節Y0(IE) - 節Y0(i0)), 3)
                if ( 部材Span <= 0 ) {
                    部材Span = 1
                }
            Case 節Y0(IE) = 節Y0(i0)
                部材Span = Round(Abs(節X0(IE) - 節X0(i0)), 3)
            Case } else {
                部材Span = Round(Sqr((節X0(IE) - 節X0(i0)) ^ 2 + (節Y0(IE) - 節Y0(i0)) ^ 2), 3)
            End Select
            /*/
        }

        private int 部材荷重数(int 部材S, int 部材E, float 荷重)
        {
            return 1;
            /*/
            var i                       As Integer
            var 荷重数                  As Integer
            //
            荷重数 = 1
            Select Case 荷重
            Case Is >= 0
                For( i = 部材S To 部材E
                }
                For( i = 部材S To 部材E
                }
            Case } else {
                For( i = 部材S To 部材E
                }
                For( i = 部材S To 部材E
                }
            End Select
            部材荷重数 = 荷重数
            /*/
        }

        private void 部材荷重連続寸法(object obj, int 連続荷重数, int 節点S, int 節点E,
                                double 荷重図開き, string 荷重方向5, int[] 連続荷重mark, double[] 連続荷重_L1, double[] 連続荷重_L2, double[] 連続荷重_P1, double[] 連続荷重_P2,
                                string dhosei, int SS1, int SE2, bool Mark_Flg, int CASU, int yBuzaiFF, int[] yGGGGG)
        {
            /*
var FLG_MMM As Integer
FLG7777 = 0
yyHH1 = 部材連続寸法_90
yyHH2 = 0
//
if ( (InStr(荷重名称(逆実荷重NO(CASU)), "風圧") != 0 $$ アーチBOX) ) {
return;
}
if ( 節X(節点S) = 節X(節点E) ) {
    FLG_MMM = 1 // 垂直
}
if ( FLG_MMM = 0 $$ (節X(節点S) < 節X(節点E) || アーチBOX) $$ 連続荷重_P1(1) <= 0 $$ 連続荷重_P2(1) <= 0 ) {
    FLG_MMM = 1
}
if ( FR橋脚 = 2 || (iKozo = 3 $$ g連続Mod) || (iKozo = 3 $$ 部材_max < 20) ) {
    FLG_MMM = 1
}
if ( 荷重方向5 = "H" ) {
    FLG_MMM = 1
}

if ( 階段Mod ) { FLG_MMM = 2
if ( FLG車両ZU = True ) {
     FLG_MMM = 1
}
if ( 連続荷重mark(1) = 5 || 連続荷重mark(1) = 11 ) {
    FLG_MMM = 0
}
if ( (s荷重位置 != 999999 || s側圧数 > 0) $$ FR橋脚 = 1 $$ 階段Mod = False $$ FLG車両ZU = False ) {
//    if ( (s荷重位置 != 999999 || s側圧数 > 0) $$ FR橋脚 = 1 $$ g連続Mod = False $$ 階段Mod = False $$ FLG車両ZU = False ) {
    if ( s側圧数 = 0 ) {
        this.部材連続寸法_9(frmPrint.vsPrt1, 連続荷重数, 節点S, 節点E, 荷重図開き, _
                荷重方向5, 連続荷重mark(), 連続荷重_L1(), 連続荷重_L2(), 連続荷重_P1(), 連続荷重_P2(), _
                dhosei, SS1, SE2, Mark_Flg, CASU, yBuzaiFF, yGGGGG())
    } else {
        FLG側圧あり = 1 //////14/12/22
        this.部材連続寸法_99(frmPrint.vsPrt1, 連続荷重数, 節点S, 節点E, 荷重図開き, _
                荷重方向5, 連続荷重mark(), 連続荷重_L1(), 連続荷重_L2(), 連続荷重_P1(), 連続荷重_P2(), _
                dhosei, SS1, SE2, Mark_Flg, CASU, yBuzaiFF, yGGGGG())
    }
} else {if ( FLG_MMM = 0 ) {
    this.部材連続寸法_0(frmPrint.vsPrt1, 連続荷重数, 節点S, 節点E, 荷重図開き, _
            荷重方向5, 連続荷重mark(), 連続荷重_L1(), 連続荷重_L2(), 連続荷重_P1(), 連続荷重_P2(), _
            dhosei, SS1, SE2, Mark_Flg, CASU, yBuzaiFF, yGGGGG())
} else {if ( FLG_MMM = 1 ) {
    this.部材連続寸法_1(frmPrint.vsPrt1, 連続荷重数, 節点S, 節点E, 荷重図開き, _
            荷重方向5, 連続荷重mark(), 連続荷重_L1(), 連続荷重_L2(), 連続荷重_P1(), 連続荷重_P2(), _
            dhosei, SS1, SE2, Mark_Flg, CASU, yBuzaiFF, yGGGGG())
} else {
    this.部材連続寸法_2(frmPrint.vsPrt1, 連続荷重数, 節点S, 節点E, 荷重図開き, _
            荷重方向5, 連続荷重mark(), 連続荷重_L1(), 連続荷重_L2(), 連続荷重_P1(), 連続荷重_P2(), _
            dhosei, SS1, SE2, Mark_Flg, CASU, yBuzaiFF, yGGGGG())
}

連続荷重数 = 0
g荷重表記縦 = 0 //////08/10/29
g荷重表記高 = 0
g荷重表記高5 = 0 //////09/11/13
g段上げ = -99999 //////13/04/13
s荷重位置 = 999999
//    s荷重側圧位置1 = 999999
//    s荷重側圧位置2 = -999999
FLG_側圧9 = 0
s側圧数 = 0
FLG_WmWs = 0 //////////15/01/07
                            */
        }

        private void 部材連続寸法_99(object obj, int 連続荷重数, int 節点S, int 節点E,
                            double 荷重図開き, string 荷重方向5, int[] 連続荷重mark, double[] 連続荷重_L1, double[] 連続荷重_L2, double[] 連続荷重_P1, double[] 連続荷重_P2,
                            string dhosei, int SS1, int SE2, bool Mark_Flg, int CASU, int yBuzaiFF, int[] yGGGGG)
        {
            /*
var 寸法補助線
var BSPAN
var BX0
var BY0
var BXE
var BYE
var 図BSPAN
var 図倍率
var BSN
var BCS
var BTAN
var B角度
var XX1
var XX2
var XX3
var YY1
var Yy2
var YY3
var PX0
var PY0
var PXE
var PYE
var PX1D
var PY1D
var PX2D
var PY2D
var PX3D
var PY3D
var 寸法(100) //////09/10/25
double var X(100)
double var Y(100)
var i                       As Integer
var j                       As Integer
double var GGII
double var GGjj
var HIH                       As Integer
var XL2
var NN                      As Integer
var HV                      As Integer
var HV5                     As Integer
var N55                     As Integer
var XL(100)                 As Single
var CNum As Integer
var GHOSEI As Single
var UUUU As Integer, PPPP As Single
var Flg3 As Integer //////////////////////////////////////////////////07/07/26
var AALL As Single ////////////08/07/02
var J4 As Integer ////////08/07/08
var J5 As Single ////////08/09/26
var J6 As Single ////////08/09/26
var P6 As Single ////////08/09/26
var J7 As Single ////////08/09/26
var P7 As Single ////////08/09/26
var P8 As Single ////////////////////////////09/11/199
var J8 As Single ////////08/09/26
var J9 As Single, J10 As Single //////////////////08/10/095
var yFR橋脚 As Integer
var yiKozo As Integer
var 寸法線位置 //////////////////////////////08/10/29
var wXs As Single, wXe As Single, wYs As Single, wYe As Single //////09/09/300
var f寸法FLG As Integer //////09/08/14
var s寸法文字2段 As Boolean ////////////////09/10/20
var s斜めFLG As Integer //////09/10/24
var Max荷重 As Single //////09/10/299
var MK5 As Integer //////09/11/09
var m調整高 As Single //////10/11/11
var FLG杭杭 As Boolean //////////////////////////////////11/12/166
var FLGMORO As Boolean ////14/07/19
var 鉛直文字列 As String //////////////09/11/16
鉛直文字列 = "1"
//
FLGMORO = False
//    yyHH1 = 0 //////////////////14/11/19
//    yyHH2 = 0
FLG杭杭 = False //////////////11/12/166
if ( InStr(部材名(SS部材), "杭") != 0 ) {
    FLG杭杭 = True
}
if ( FLG杭杭 = False ) {
    if ( yBuzaiFF > 0 ) { ////////12/12/15
        For( j = 1 To yBuzaiFF
            i = yGGGGG(j)
            if ( InStr(部材名(i), "杭") = 1 ) {
                FLG杭杭 = True
                Exit For
            }
        }
    } else {
        For( i = SS1 To SE2
            if ( InStr(部材名(i), "杭") = 1 ) {
               FLG杭杭 = True
               Exit For
            }
        }
    }
}
if ( FLG杭杭 = True $$ 連続荷重mark(1) = 6 ) { //////12/02/15
    s斜めFLG = 0
    For( i = 1 To 連続荷重数
        if ( 連続荷重_L1(i) != 0 || 連続荷重_L2(i) != 0 ) {
            s斜めFLG = 1
            Exit For
        }
    }
    if ( s斜めFLG = 0 ) {
        GoTo ABC //////return;
    }
}
if ( Flg_PRESTRES(1) = 1 || Flg_PRESTRES(2) = 1 ) { //////12/02/15
    GoTo ABC //////return;
}
s斜めFLG = 0 //////09/10/24
f寸法FLG = 0
m調整高 = 0 //////////////10/11/11
yFR橋脚 = FR橋脚
yiKozo = iKozo
//
if ( Not (yiKozo = 3 $$ g連続Mod) ) {
        yiKozo = 1 ////////10/01/24 12/12/15
}
if ( iKozo = 1 $$ s側圧数 != 0 $$ g連続Mod = False ) {
    yiKozo = 3 ////////////BOX  15/02/02
}
        yFR橋脚 = 1
//
BSPAN = 部材Span(節点S, 節点E)
////////09/09/300
var ii As Integer, i7 As Integer, i8 As Integer //////09/10/14
wXs = 節X(節点S)
wXe = 節X(節点E)
wYs = 節Y(節点S)
wYe = 節Y(節点E)
var 荷重方向
荷重方向 = 荷重方向5 ////////09/10/20
if ( wYs = wYe $$ (荷重方向 = "V" || 荷重方向 = "M") $$ yBuzaiFF = 0 ) {
    荷重方向 = ""
}
if ( SS1 = SE2 $$ 荷重方向 = "H" $$ 連続荷重mark(1) = 2 ) { //////////09/10/24
    s斜めFLG = 2
}
if ( (Abs(SE2 - SS1) > 1 || yBuzaiFF > 0) $$ _
                    (荷重方向 = "V" || 荷重方向 = "M") ) { ////////09/09/301
    if ( 荷重方向 = "V" $$ 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) + 連続荷重_P2(1) < 0 ) {
        PPPP = min(wYs, wYe)
        if ( yBuzaiFF > 0 ) { //////////////////09/10/14
            For( i8 = 1 To yBuzaiFF
                i7 = yGGGGG(i8)
                J4 = 部I(i7): PPPP = min(PPPP, 節Y(J4))
                J4 = 部J(i7): PPPP = min(PPPP, 節Y(J4))
            }8
        } else {
            For( i7 = SS1 To SE2
                J4 = 部I(i7): PPPP = min(PPPP, 節Y(J4))
                J4 = 部J(i7): PPPP = min(PPPP, 節Y(J4))
            }7
        }
    } else {
        PPPP = max(wYs, wYe)
        if ( yBuzaiFF > 0 ) { //////////////////09/10/14
            For( i8 = 1 To yBuzaiFF
                i7 = yGGGGG(i8)
                J4 = 部I(i7): PPPP = max(PPPP, 節Y(J4))
                J4 = 部J(i7): PPPP = max(PPPP, 節Y(J4))
            }8
        } else {
            For( i7 = SS1 To SE2
                J4 = 部I(i7): PPPP = max(PPPP, 節Y(J4))
                J4 = 部J(i7): PPPP = max(PPPP, 節Y(J4))
            }7
        }
    }
    wYs = PPPP
    wYe = PPPP
}
BX0 = 図X(wXs)
BY0 = 図Y(wYs)
BXE = 図X(wXe)
BYE = 図Y(wYe)
////////09/09/300
水平垂直 = 9 //////////////////////////08/07/02
if ( BX0 = BXE ) {
    水平垂直 = 1 // 垂直
    AALL = 図Y_SCALE
}
if ( BY0 = BYE ) {
    水平垂直 = 0 // 水平
    AALL = 図X_SCALE
}
if ( BX0 != BXE ) {
    if ( (Abs(BY0 - BYE) / Abs(BX0 - BXE)) < 0.05 ) { ////////10/10/13
        水平垂直 = 0 // 水平
        AALL = 図X_SCALE
    }
}

//    if ( 水平垂直 = 9 $$ 荷重方向 = "H" $$ Mark111 = 2 ) { //////09/08/23
//    For( i = 1 To 連続荷重数
//        連続荷重_P1(i) = 連続荷重_P1(i) * (-1)
//        連続荷重_P2(i) = 連続荷重_P2(i) * (-1)
//    }
//    }
if ( dhosei = "" || dhosei = 0 ) {
    GHOSEI = hosei
} else {
    GHOSEI = dhosei
}
if ( g荷重連寸法補正 = 1 ) { //////////////////////////////07/01/17
    GHOSEI = GHOSEI + 3.5
    g荷重連寸法補正 = 0
}
if ( BX0 != BXE $$ (節Y0(節点S) + 節Y0(節点E)) / 2 > (YY_max * 0.8) ) { ////////////07/01/177
    g荷重連寸法回数 = g荷重連寸法回数 + 1 ////////////07/01/177
}
if ( (水平垂直 = 1 $$ yiKozo = 3 $$ 連続荷重数 = 1 $$ 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) != 連続荷重_P2(1)) ) {
    if ( s側圧数 = 0 ) { g荷重表記縦 = 1
}
////////////////////////////07/11/03
j = 0
J4 = 0: J5 = 0: J6 = 0: J7 = 0: P6 = 0: J7 = 0
J8 = 0: J9 = 0: J10 = 0
P6 = 0: P7 = 0: P8 = 0
MK5 = 0
For( i = 1 To 連続荷重数
    if ( 連続荷重mark(i) = 1 ) {
        j = j + 1
        if ( Len(鉛直文字列) < Len(Format(連続荷重_P1(i), "0.00")) ) { 鉛直文字列 = Format(連続荷重_P1(i), "0.00")
        if ( Len(鉛直文字列) < Len(Format(連続荷重_P2(i), "0.00")) ) { 鉛直文字列 = Format(連続荷重_P2(i), "0.00")
    }
    if ( 連続荷重mark(i) = 4 ) {
      J4 = J4 + 1
    }
    if ( 連続荷重mark(i) = 5 || 連続荷重mark(i) = 11 ) {
      MK5 = MK5 + 1
    }
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    if ( (連続荷重_P1(i) >= 0 || 連続荷重_P2(i) >= 0) ) {
        if ( 連続荷重mark(i) = 1 ) {
            J5 = 1
            P6 = max(P6, 連続荷重_P1(i))
            P6 = max(P6, 連続荷重_P2(i))
       }
        if ( 連続荷重mark(i) = 2 $$ (連続荷重_P1(i) * 連続荷重_P2(i) != 0 $$ 連続荷重_P1(i) != 連続荷重_P2(i)) ) {
            J6 = 1
        }
        if ( 連続荷重mark(i) = 2 $$ (連続荷重_P1(i) * 連続荷重_P2(i) = 0 || 連続荷重_P1(i) = 連続荷重_P2(i)) ) {
            J7 = J7 + 1
        }
        if ( 連続荷重mark(i) = 2 $$ 連続荷重_P1(i) = 連続荷重_P2(i) ) {
            J9 = J9 + 1
        }
        if ( 連続荷重mark(i) = 2 $$ 連続荷重_P1(i) * 連続荷重_P2(i) = 0 ) {
            J10 = J10 + 1
        }
        if ( (連続荷重mark(i) = 4 $$ 連続荷重_P1(i) = 連続荷重_P2(i)) _
            || (連続荷重mark(i) = 3 $$ 連続荷重_P1(i) * 連続荷重_P2(i) = 0) ) {
            J8 = J8 + 1
        }
        if ( 連続荷重mark(i) = 2 || 連続荷重mark(i) = 4 || 連続荷重mark(i) = 3 ) {
            P6 = max(P6, Abs(連続荷重_P1(i)))
            P6 = max(P6, Abs(連続荷重_P2(i)))
        }
    }
    if ( g荷重表記縦 = 0 || (g荷重表記縦 = 1 $$ 連続荷重_P1(i) != 連続荷重_P2(i)) || 連続荷重mark(i) = 1 ) {
        P7 = max(P7, Abs(連続荷重_P1(i)))
        P7 = max(P7, Abs(連続荷重_P2(i)))
    }
}
//
var Mark111 As Integer
//
if ( J5 = 1 ) { ////////////////////////////////09/11/13
    g荷重表記高 = 0
    Mark111 = 1
} else {
    if ( g荷重表記縦 = 1 ) {
        For( i = 1 To 連続荷重数 //////09/11/199
            if ( (連続荷重mark(i) = 2 || 連続荷重mark(i) = 4) $$ _
                (連続荷重_P1(i) * 連続荷重_P2(i) = 0 || 連続荷重_P1(i) != 連続荷重_P2(i)) ) {
                P8 = max(P8, Abs(連続荷重_P1(i))) //////09/11/30
                P8 = max(P8, Abs(連続荷重_P2(i)))
            }
        }
        if ( P8 != 0 ) {
            P7 = P8
        }
        if ( g荷重表記高 < g荷重表記高5 / 1.5 ) {
            g荷重表記高 = g荷重表記高5 / 1.5
        } //////09/11/199
    } else {
        if ( 水平垂直 = 0 $$ g荷重表記高5 > 180 ) { //////10/01/03
            g荷重表記高5 = 180
        }
        g荷重表記高 = g荷重表記高5
    }
    if ( (MK5 != 0 $$ MK5 = 連続荷重数) ) {
        Mark111 = 5
    } else {
        Mark111 = 連続荷重mark(1)
    }
}
//////////////////////////////////////////////////////////////
if ( Mark111 = 6 ) { //////////////////////12/02/15
    if ( 連続荷重数 = 1 ) {
        if ( 連続荷重_L1(1) = 0 $$ 連続荷重_L2(1) = 0 ) {
            GoTo ABC //////return;
        }
        if ( InStr(部材名(SS部材), "柱") != 0 ) { //////////////////12/02/15
            if ( 節X(節点S) != g柱X座標(g柱本数, 1) ) {
                GoTo ABC //////return;
            }
        }
    } else {if ( InStr(部材名(SS部材), "杭") != 0 ) { //////////////////12/02/15
        荷重図開き = Abs(荷重図開き) //////136
        KUIDAN = 0
    }
}
Max荷重 = BU荷重MAX //////////////////////////////////////09/10/299
if ( J5 = 1 || Mark111 = 5 ) { //////08/09/26//////09/11/09
    J6 = 0
    J7 = 0
    J8 = 0
    J9 = 0 //////08/10/09
    J5 = IIf(yFR橋脚 = 1, -0.7, 1)
    GHOSEI = 0
    Max荷重 = BP荷重MAX ////////////////09/10/299
    if ( Max荷重 = 0 ) { Max荷重 = P7 ////////////09/11/30
} else {
    if ( J10 = 連続荷重数 ) {
        J6 = 1 //////08/10/095
        J7 = 0 //////08/10/096
    }
    if ( J6 = 1 ) {
        if ( (P6 / Max荷重) < 0.7 ) {
            if ( J10 = 連続荷重数 ) { //////08/10/096
                J6 = 0
            } else {
//                    J6 = min(1 / (P6 / Max荷重), 3) //////////09/04/06
                J6 = 0.3 //////////09/04/06
            }
        } else {if ( (P6 / Max荷重) > 0.9 ) {
            if ( yFR橋脚 = 1 ) {
                if ( 部材正荷重数(SS1) < 20 ) {
                    J6 = -1.5
                } else {
                    J6 = -2.2
                }
            } else {
                J6 = 2.5
            }
        } else {
            J6 = -0.5
        }
        if ( yiKozo = 3 || g連続Mod ) {
            J6 = -1.5
        }
    }
}
if ( J7 = 連続荷重数 ) { J7 = 1 } else { J7 = 0
if ( J9 = 連続荷重数 ) { J9 = 1 } else { J9 = 0 //////08/10/09
if ( J8 = 連続荷重数 ) {
    if ( ((P6 / Max荷重) ^ 0.7) < 0.6 ) { //////08/10/09
        J8 = 1.5
    } else {if ( (P6 / Max荷重) > 0.95 ) {
        J8 = 1.3
    } else {
        J8 = Round((Max荷重 / P6) ^ 0.5, 1) //////1//////08/10/29
    }
} else {
    J8 = 0
}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////08/09/26
if ( 水平部材最上端 = 水平部材最下端 $$ 連続荷重数 = 1 $$ 連続荷重_P1(1) * 連続荷重_P2(1) < 0 ) {
    FLGMORO = True
}
//    if ( (Mark111 = 1 || Mark111 = 11) ) {
if ( j != 0 ) {
    if ( FLG記号 = 1 ) { ////////////////07/05/13
        GHOSEI = GHOSEI + IIf(j = 連続荷重数, 0.5, 1) //////+ 3
    }
} else {
    if ( g連続Mod ) {
        j = 2 ////////////////////06/12/14
        GHOSEI = max(GHOSEI, 0) ////////////////////連続梁 05/02/06
            For( i = 1 To 連続荷重数
                  if ( (連続荷重mark(i) = 2 || 連続荷重mark(i) = 3 || 連続荷重mark(i) = 4) $$ _
                     (連続荷重_P1(i) != 連続荷重_P2(i)) $$ ((連続荷重_L2(i) - 連続荷重_L1(i)) * AALL * Twip) < 0.5 ) {
                        j = 0
                        Exit For
                  }
            }
            if ( FLG記号 = 1 ) { ////////////////07/05/13
                if ( j = 0 ) {
                    GHOSEI = GHOSEI + 5.5
                }
            }
    } else {
        if ( yFR橋脚 = 2 ) {
            GHOSEI = max(GHOSEI, 0) ////////////////////////////// 05/09/20
        } else {
            j = 2 ////////////////////06/12/14
            For( i = 1 To 連続荷重数
                  if ( 連続荷重mark(i) != 2 ) { j = 0
            }
        if ( j = 2 ) { // if ( 連続荷重mark(1) = 2 ) {
            UUUU = 0: PPPP = 0 ////////////////////06/12/14
            For( i = 1 To 連続荷重数
                  if ( (連続荷重_P1(i) != 連続荷重_P2(i)) ) { UUUU = 1
                  PPPP = max(PPPP, Abs(連続荷重_P1(i)))
                  PPPP = max(PPPP, Abs(連続荷重_P2(i)))
            }
                if ( (Mark111 = 2 $$ GHOSEI < -2) || (Mark111 = 3 $$ GHOSEI > -2) ) {
                    if ( (Mark111 = 2 $$ GHOSEI < -2) ) {
                        GHOSEI = 2.5
                    } else {
                        GHOSEI = -荷重寸法線位置(1) * (1 - (PPPP / Max荷重) ^ 0.25)
                    }
                } else {
                    GHOSEI = GHOSEI / 2.5
                }
                if ( UUUU = 0 ) { ////////////////////////////////////////////////////////////06/12/14
                    if ( ((PPPP / Max荷重) ^ 0.5) > 0.8 ) {
                        GHOSEI = max(GHOSEI, 2.5)
                    } else {
                        GHOSEI = max(GHOSEI, 1)
                    }
                } else {
                    GHOSEI = GHOSEI + IIf(((PPPP / Max荷重) ^ 0.5) > 0.8, 1.5, 0)
                    GHOSEI = GHOSEI + ((PPPP / Max荷重) ^ 0.6) * 1.3 ////////////////06/12/14
                    if ( GHOSEI < hosei ) {
                        GHOSEI = max(hosei, 9)
                    }
                }
                if ( GHOSEI < -5 ) { ////////////06/09/06
                    GHOSEI = -5
                    if ( FLG記号 = 1 ) { ////////////// ////////08/06/17
                        GHOSEI = GHOSEI + 5.5
                    }
                } else {if ( GHOSEI > -0.8 $$ Mark111 = 3 ) { ////////////06/09/06
                    GHOSEI = -1
                    if ( FLG記号 = 1 ) { ////////////// ////////08/06/17
                        GHOSEI = GHOSEI + 5.5
                    }
                }
                if ( BX0 = BXE ) { //////////////08/06/17
                    GHOSEI = GHOSEI + 4
                }
            } else { ////// 05/09/20
                GHOSEI = 0
            }
//                }
        }
    }
}
////////////////////////////////////////////////////////////////////////// 05/02/05
CNum = 0
if ( yiKozo = 1 ) {
i = 節点S
Do
            GGII = i
            GGjj = (i + 1)
            if ( GGII * GGjj = 0 || GGII > 1000 ) { Exit Do ////////05/04/26
            j = 0
            HIH = 0
            Do
                j = j + 1
                if ( j > 部材_max ) { Exit Do
                if ( GGII = 部I(j) $$ GGjj = 部J(j) ) {
                    HIH = j
                    Exit Do
                }
            Loop
            if ( HIH > 0 ) {
                if ( ZFAngle(HIH) = 0 $$ 部材正荷重数(HIH) > 20 ) {
                    CNum = 1
                    Exit Do
                }
            }
    i = i + 1
    if ( i = 節点E ) { Exit Do
 Loop
    if ( CNum = 0 $$ g連続Mod ) {
    GHOSEI = max(GHOSEI, 8) ////////////////////連続梁 05/02/06
    }
}    //
Select Case 荷重方向
Case "V", "M", "S"
    BSPAN = Round(Abs(節X0(節点S) - 節X0(節点E)), 3)
    BY0 = max(BY0, BYE)
    BYE = BY0
Case "H"
    BSPAN = Round(Abs(節Y0(節点S) - 節Y0(節点E)), 3)
    if ( (節X0(節点S) + 節X0(節点E)) / 2 < (JX_max + JX_min) / 2 ) { ////////////07/01/08
        if ( s斜めFLG = 0 ) {
        BX0 = min(BX0, BXE)
        } else {
        BX0 = min(BX0, BXE)
        }
    } else {
        if ( s斜めFLG = 0 ) {
        BX0 = max(BX0, BXE)
        } else {
        BX0 = max(BX0, BXE)
        }
    }
    BXE = BX0
Case } else {
End Select
図BSPAN = Sqr((BXE - BX0) ^ 2 + (BYE - BY0) ^ 2)
if ( 図BSPAN <= 0 ) {
    図BSPAN = 1
}
if ( BSPAN <= 0 ) {
    BSPAN = 1
}
図倍率 = 図BSPAN / BSPAN
BSN = (BYE - BY0) / 図BSPAN
BCS = (BXE - BX0) / 図BSPAN
if ( 荷重方向 = "V" ) { //////And 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) + 連続荷重_P2(1) > 0 ) { //////10/03/07
//        BCS = Abs(BCS)
}
BTAN = 0
if ( BX0 != BXE ) {
    BTAN = (BYE - BY0) / (BXE - BX0)
}
B角度 = 180 * Atn(BTAN) / π
if ( BX0 > BXE ) {
    B角度 = B角度 + 180
}
if ( BX0 = BXE ) {
    B角度 = 90
}
if ( BYE < BY0 ) {
    B角度 = 270
}
//
Flg3 = 0
Select Case 荷重方向 ////////////////////07/01/08
Case "V", "M", "S"
        PX0 = HEN_X(wXs) - 荷重図開き * BSN
        PY0 = min(HEN_Y(wYs), HEN_Y(wYe)) - 荷重図開き * Abs(BCS) ////////////07/01/09
Case "H"
    if ( (節X0(節点S) + 節X0(節点E)) / 2 < (JX_max + JX_min) / 2 ) { ////////////07/01/08
        if ( 連続荷重_P1(1) + 連続荷重_P2(1) > 0 $$ s斜めFLG = 0 ) { ////////09/10/24
            PX0 = min(HEN_X(wXs), HEN_X(wXe)) - 荷重図開き * BSN * 1 ////////09/10/24
        } else {
            if ( s斜めFLG = 0 ) {
                PX0 = min(HEN_X(wXs), HEN_X(wXe)) - 荷重図開き * BSN * 13 ////////09/08/24
            } else {
                PX0 = min(HEN_X(wXs), HEN_X(wXe)) - Abs(荷重図開き * BSN) * 10 ////////09/08/24
                Flg3 = 1
            }
        }
        PY0 = HEN_Y(wYs) - 荷重図開き * BCS
    } else {
        if ( 連続荷重_P1(1) + 連続荷重_P2(1) > 0 $$ s斜めFLG = 0 ) { ////////09/10/24
        PX0 = min(HEN_X(wXs), HEN_X(wXe)) // + 荷重図開き * BSN * 0.3
        } else {
            PX0 = max(HEN_X(wXs), HEN_X(wXe)) - 荷重図開き * BSN * IIf(s斜めFLG = 0, 0, 10) ////////09/10/24
            if ( s斜めFLG != 0 ) {
                Flg3 = 1 ////////////07/07/26//////////////////////////////09/10/24 コメントにした
            }
        }
        PY0 = HEN_Y(wYs) - 荷重図開き * BCS
    }
Case } else {
    PX0 = HEN_X(wXs) - 荷重図開き * BSN
    if ( yiKozo = 1 $$ 水平垂直 = 0 $$ N段数 = 1 $$ 連続荷重数 = 1 $$ _
       Abs(YY_max - wYs) > (YY_max - YY_min) / 5 ) { //////////////////////////////////07/06/177
        PY0 = HEN_Y(wYs) + 荷重図開き * BCS
    } else {
        if ( 連続荷重数 = 1 $$ Mark111 = 11 $$ _
                    Abs(YY_max - wYs) <= (YY_max - YY_min) / 10 ) { //////08/06/16
            PY0 = HEN_Y(wYs) + 荷重図開き * BCS
        } else {
            PY0 = HEN_Y(wYs) - 荷重図開き * BCS
        }
    }
End Select
//   q１
//////////////////////////////////////////06/01/29
UUUU = 0: PPPP = 0
For( i = 1 To 連続荷重数
    if ( 連続荷重mark(i) = 2 $$ 連続荷重_P1(i) = 連続荷重_P2(i) ) {
        PPPP = max(PPPP, Abs(連続荷重_P1(i)))
    } else {
        UUUU = 1
    }
}
//////////////////////////////////////////06/01/29
XL(1) = 0
NN = 1
集中有無 = 0
HV = 0
HV5 = 0
N55 = 1
j = 0
//
var SNUM As Integer
SNUM = max(連続荷重数, s側圧数)
var Total As Integer //////13/04/20
var Num文字列数 As Integer
var kPoint() As Integer
this.kPoint((SNUM + 1) * 4, 2)
var strKAJYU() As String
this.strKAJYU(SNUM + 1, 2) //////13/04/20
var FG_Num As Integer
var FLG_888 As Integer: FLG_888 = 0
Total = 0
Num文字列数 = 0
FG_Num = 0

For( i = 1 To SNUM ////////14/11/17
    if ( 連続荷重数 < s側圧数 ) {
        連続荷重mark(i) = 連続荷重mark(連続荷重数)
        連続荷重_P1(i) = 連続荷重_P1(連続荷重数)
        連続荷重_P2(i) = 連続荷重_P2(連続荷重数)
    }
    if ( 連続荷重_L1(i) - XL(NN) > 0.001 ) {
        NN = NN + 1
        XL(NN) = 連続荷重_L1(i)
    }
    if ( s斜めFLG = 2 ) { ////////09/10/24
        連続荷重_P1(i) = Abs(連続荷重_P1(i))
        連続荷重_P2(i) = Abs(連続荷重_P2(i))
    }
    Select Case 連続荷重mark(i)
    Case 1, 5, 11
            if ( Not (連続荷重_P2(i) = 0 $$ 連続荷重_L2(i) = 0) ) { ////////if ( 連続荷重_P2(I) != 0  07/06/11
            if ( 連続荷重_L2(i) != XL(NN) ) {
                XL2 = Round(連続荷重_L2(i), 3)
                NN = NN + 1
                XL(NN) = XL2
            }
            }
            if ( 連続荷重mark(i) != 5 ) {
                集中有無 = 1
            }
    Case 2, 4, 6, 7
            if ( s側圧数 = 0 ) {
                if ( 連続荷重mark(i) = 2 $$ (水平垂直 = 0 || 荷重方向 = "V" || 荷重方向 = "M") ) { //////13/04/20
                    if ( Not (連続荷重_P1(i) + 連続荷重_P2(i) = 0) ) {
                        Total = Total + 1
                        strKAJYU(i, 1) = IIf(連続荷重_P1(i) = 0, "", F2(連続荷重_P1(i)))
                        strKAJYU(i, 2) = IIf(連続荷重_P2(i) = 0, "", F2(連続荷重_P2(i)))
                        kPoint(i, 1) = NN
                        kPoint(i, 2) = NN + 1
                        Num文字列数 = max(Num文字列数, Len(strKAJYU(i, 1)))
                        Num文字列数 = max(Num文字列数, Len(strKAJYU(i, 2)))
                    }
                }
            } else {if ( s側圧数 > 0 ) {
                if ( 連続荷重mark(i) = 2 $$ (水平垂直 = 1 || 荷重方向 = "H") ) { //////13/04/22
                        Total = Total + 1
                        strKAJYU(i, 1) = IIf(連続荷重_P1(i) = 0, "", F2(Abs(連続荷重_P1(i))))
                        strKAJYU(i, 2) = IIf(連続荷重_P2(i) = 0, "", F2(Abs(連続荷重_P2(i))))
                        kPoint(i, 1) = NN
                        kPoint(i, 2) = NN + 1
                        Num文字列数 = max(Num文字列数, Len(strKAJYU(i, 1)))
                        Num文字列数 = max(Num文字列数, Len(strKAJYU(i, 2)))
                }
            }
            if ( 連続荷重_L2(i) != 0 ) {
                XL2 = Round(BSPAN - 連続荷重_L2(i), 3)
                NN = NN + 1
                XL(NN) = XL2
            }
            if ( 連続荷重_P1(i) != 連続荷重_P2(i) $$ 連続荷重_P1(i) != 0 $$ 連続荷重_P2(i) != 0 ) {
//                    if ( HV = 0 ) {
                    if ( (連続荷重_L1(i) = 0 $$ wXs = JX_min) ) {
                        FLG_888 = 1
                    } else {if ( (連続荷重_L2(i) = 0 $$ wXe = JX_max) ) {
                        FLG_888 = 2
                    }
//                    }
                HV = 1
                HV5 = 1
            }
    Case 3
            XL2 = Round(連続荷重_L1(i) + (BSPAN - 連続荷重_L1(i) - 連続荷重_L2(i)) / 2, 3)
            NN = NN + 1
            XL(NN) = XL2
            if ( 連続荷重_L2(i) != 0 ) {
                XL2 = Round(BSPAN - 連続荷重_L2(i), 3)
                NN = NN + 1
                XL(NN) = XL2
            }
//                if ( 水平垂直 != 1 ) {
//                    Total = Total + 1
//                    strKAJYU(i, 1) = F2(連続荷重_P1(i) + 連続荷重_P2(i)) & strUN & "/m"
//                    if ( 連続荷重_P2(i) != 0 ) {
//                    strKAJYU(i, 2) = F2(連続荷重_P2(i)) & strUN & "/m"
//                    }
//                    kPoint(i, 1) = NN
//                    kPoint(i, 2) = NN + 1
//                }
    Case } else {
            if ( 連続荷重_L2(i) != 0 ) {
                XL2 = Round(BSPAN - 連続荷重_L2(i), 3)
                NN = NN + 1
                XL(NN) = XL2
            }
    End Select
}

if ( 連続荷重数 = 1 $$ 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) + 連続荷重_P2(1) = 0 $$ _
                                              連続荷重_L1(1) + 連続荷重_L2(1) = 0 ) {
    NN = NN + 1
    XL(NN) = BSPAN / 2 ////////12/11/27 逆対称の分布荷重

} else {if ( XL2 != BSPAN ) { //////12/12/15
    if ( XL(NN) < BSPAN ) {
        if ( yiKozo = 3 $$ 連続荷重数 = 1 $$ NN = 1 $$ 連続荷重mark(1) = 2 $$ wYs = wYe $$ _
            Not (Abs(YY_max - wYs) < 1 || _
            (Abs(水平部材最下端 - wYs) < 1 $$ 連続荷重_P1(1) + 連続荷重_P2(1) > 0)) ) { //////13/06/07
            NN = NN
        } else {
            NN = NN + 1
            XL(NN) = BSPAN //////12/12/15
        }
    }
}
        //////////////////////////////08/07/06
if ( yiKozo = 1 $$ 連続荷重数 = 1 $$ NN <= 2 $$ 連続荷重mark(1) = 2 $$ wYs = wYe $$ _
            (Abs((YY_max + YY_min) / 2 - wYs) < 1 || _
            (Abs(水平部材最下端 - wYs) < 1 $$ 連続荷重_P1(1) + 連続荷重_P2(1) > 0)) ) {
    if ( 連続荷重_P1(1) = 連続荷重_P2(1) ) { GoTo GRF777 ////////////13/04/08
}

N55 = 1
j = 0
For( i = 1 To 連続荷重数
    if ( 連続荷重_L1(i) - XL(N55) > 0.001 ) {
        N55 = N55 + 1
    }
    Select Case 連続荷重mark(i)
    Case 1, 5, 11
        if ( Not (連続荷重_P2(i) = 0 $$ 連続荷重_L2(i) = 0) ) {
            N55 = N55 + 1
        }
        if ( 連続荷重mark(i) != 5 ) {
            j = 1
        }
    Case 2, 6, 7
        if ( 連続荷重_L2(i) != 0 ) {
            N55 = N55 + 1
        }
        if ( i = 連続荷重数 ) {
            AALL = (XL(N55) - XL(N55 - 1))
        } else {
            AALL = (XL(N55 + 1) - XL(N55))
        }
        if ( 連続荷重mark(i) = 2 $$ (連続荷重_P1(i) != 連続荷重_P2(i)) ) {
            if ( (yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) ) {
            }
        }
    Case 3
        N55 = N55 + 1
        if ( 連続荷重_L2(i) != 0 ) {
            N55 = N55 + 1
        }
        if ( (max(Abs(連続荷重_P1(i)), Abs(連続荷重_P2(i))) / Max荷重) < 0.2 ) {
            j = 3
        }
    Case 4
        N55 = N55 + 1
        if ( (max(Abs(連続荷重_P1(i)), Abs(連続荷重_P2(i))) / Max荷重) < 0.2 ) {
            j = 4
        }
    Case } else {
        if ( 連続荷重_L2(i) != 0 ) {
            N55 = N55 + 1
        }
    End Select
}
if ( 集中有無 != 1 $$ J7 = 0 ) {
    GHOSEI = 1.5 + 1
    if ( j = 2 ) {
        GHOSEI = 9.5 * (P6 / Max荷重)
    }
}
//////////////////////////////08/07/06
var gY55 As Single, GOUKEI As Single, J55 As Single, J88 As Single
//
if ( (Mark111 = 2 || Mark111 = 3 || Mark111 = 4) ) {
    if ( ((P7 / Max荷重) ^ 1.2) < 0.3 ) {
        P7 = Round(0.35 * Max荷重, 1)
        P6 = P7 //////09/11/13
        if ( ((P7 / Max荷重) ^ 1.2) < 0.2 ) {
            P7 = Round(0.2 * Max荷重, 1)
            P6 = P7 //////09/11/13
        } else {if ( ((P7 / Max荷重) ^ 1.2) < 0.15 ) {
            P7 = Round(0.12 * Max荷重, 1)
            P6 = P7 //////09/11/13
        }
        GHOSEI = 0
        hosei = 0
    } else {if ( (P7 / Max荷重) > 0.8 ) {
        P7 = Max荷重
//            gHosei = 0
//            hosei = 0
        J6 = -0.5
    }

}
gY55 = 0
if ( FLG_列車_衝撃 ) {
    if ( N段数 = 1 ) {
        gY55 = -51
    } else {
        gY55 = -120
    }
    if ( 荷重方向 = "M" ) { //////12/12/17
        gY55 = -80
    }
} else {if ( J5 = 0 $$ J10 = 連続荷重数 ) {
    gY55 = 150 * (P7 / Max荷重)
    if ( P7 < 100 $$ Not (yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) ) {
    gY55 = gY55 - 100
    }
} else {if ( J5 = 0 $$ J7 = 1 $$ J9 = 1 ) {
    if ( (P7 / Max荷重) > 0.6 ) {
        J7 = 1
        if ( (P7 / Max荷重) > 0.9 ) { J7 = 0
    } else {
        J6 = 1
    }
}
if ( J5 != 0 ) {
    J55 = J5
    if ( SS1 = SE2 ) {
        if ( N段数 > 1 ) {
            if ( (P7 / BP荷重MAX) > 0.9 ) {
                if ( P7 >= 100 ) {
                    J55 = 1
                } else {if ( P7 < 33 ) {
                    J55 = 0.5
                }
            } else {
                J55 = 1.5
            }
        } else {
            if ( P7 >= 100 ) { J55 = 1
        }
    } else {
        if ( Len(鉛直文字列) >= 9 ) {
            if ( P7 >= 100000 ) {
                J55 = 0.1
                GHOSEI = GHOSEI - 2
            } else {
                J55 = 1.2
            }
        } else {if ( Len(鉛直文字列) = 8 ) {
            if ( P7 >= 10000 ) {
                J55 = 0.1
                GHOSEI = GHOSEI - 2
            } else {
                J55 = 1.2
            }
        } else {if ( Len(鉛直文字列) = 7 ) {
            if ( P7 >= 1000 ) {
                J55 = 0.4
            } else {
                J55 = 1.3
            }
        } else {if ( Len(鉛直文字列) = 6 ) {
            if ( P7 >= 100 ) {
                if ( N段数 = 1 ) {
                    J55 = 0.1
                } else {
                    if ( (P7 / Max荷重) > 0.99 ) {
                        J55 = 0.5
                    } else {
                        J55 = -0.3
                    }
                }
            } else {
                J55 = 0.7
            }
        } else {if ( Len(鉛直文字列) >= 5 ) {
            J55 = 0
        }
    }
    if ( (GHOSEI = 0.5 || GHOSEI = 2.5) $$ Abs(YY_max - wYs) > (YY_max - YY_min) / 5 ) { ////////08/11/27
        J55 = J5
    }
    GOUKEI = (J7 * 60 + J88 * 160 - J55 * 120 - J6 * 80 + GHOSEI * 20) // - gY55
    if ( Mark111 = 1 $$ GOUKEI < 200 ) { ////////14/08/28
        GOUKEI = 200
        if ( 連続荷重mark(1) = 2 ) {
        GOUKEI = 444
        }
    }
    if ( Mark111 = 5 ) { ////////09/11/17
        GOUKEI = 50
    }
    GoTo YNEXT
}

if ( g荷重表記縦 = 0 $$ g荷重表記高 != 0 ) { ////////08/10/29
    if ( Mark111 = 4 $$ g荷重表記縦 = 0 ) { //////09/11/202
        g荷重表記高 = 220
        GOUKEI = 150
    } else {
        if ( g荷重表記高 < 100 ) { // g荷重表記高 = 100
//            GOUKEI = 260 - 100 - gY55 + 60  //////06/10/29
                GOUKEI = 260 / 2 - g荷重表記高 - gY55 + 60 //////////////09/03/10
        } else {
            GOUKEI = 260 - g荷重表記高 - gY55 + 60
            if ( (P7 / Max荷重) > 0.9 ) { //////09/11/12
                if ( g荷重表記高 < 260 ) {
                    if ( g荷重表記高 = 180 $$ gY55 = 0 $$ N段数 = 1 ) { ////////10/01/03
                        GOUKEI = 260 ////////10/02/03//////720 ////////10/01/03
                    } else {
                        GOUKEI = 260 ////////10/01/03
                    }
                } else {
                    GOUKEI = 260 ////////10/01/03
                }
            } else {
                if ( g荷重表記高 > 140 $$ GOUKEI < 220 ) { ////////09//11/199
                    GOUKEI = 220
                } else {
                    GOUKEI = 280 + GOUKEI
                    if ( ((P7 / Max荷重) ^ 1.3) < 0.3 ) { //////09/11/13
                        GOUKEI = 0 //////200 //////13/006/21  元 2
                    }
                }
            }
        }
    }
} else {
    if ( g荷重表記縦 = 0 $$ (P7 / Max荷重) < 0.3 $$ N段数 != 1 $$ gY55 = 0 ) {  //////08/10/29
        if ( (J7 = 1 $$ J9 = 1) $$ J8 = 0 ) {
            if ( (P7 / Max荷重) < 0.2 ) {
                GOUKEI = -20
            } else {
                GOUKEI = 0
            }
        } else {if ( J7 = 1 $$ J8 = 0 ) {
            GOUKEI = 120 * (1 - (P7 / Max荷重) ^ 1.5)
        } else {
            GOUKEI = 300 * (1 - (P7 / Max荷重) ^ 0.7)
        }
    } else {
        J55 = J5
        J88 = J8
        if ( J5 + J6 + J7 + J8 + gY55 = 0 ) {
            if ( (P7 / Max荷重) < 0.6 ) {
                J88 = Round((P7 / Max荷重), 1)
                if ( (P7 / Max荷重) < 0.1 ) {
                    J88 = 1.5
                }
            }
                if ( Mark111 = 4 $$ g荷重表記縦 = 1 $$ hosei > 0 ) {
                    J55 = 1.5 //+ (g荷重表記高 / 300)
                }
        } else {if ( g荷重表記縦 = 1 || (P7 / Max荷重) > 0.85 ) {
            if ( (yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) ) {
                if ( (P7 / Max荷重) < 0.5 $$ P7 >= 10 ) {
                J55 = Round(5 * (P7 / Max荷重) ^ 0.5, 1)
                } else {
                J55 = Round(3 * (P7 / Max荷重) ^ 0.5, 1) ////////09/11/199
                if ( 下床文字表示 = 0 $$ 連続荷重_P1(1) * 連続荷重_P2(1) < 0 $$ g荷重表記高 > 260 ) {
//                        J55 = J55 - Round(g荷重表記高 / 20, 1) //////09/12/04
                }
                }
//                    J6 = 0 //-0.5
                if ( J6 = 0 ) {
                    J6 = -0.5
                    J7 = 0
                } else {if ( J6 > 0 ) { //////08/11/05
                    J6 = 2
                } else {
                    if ( (P7 / Max荷重) > 0.95 ) { ////////////////////08/11/09////08/12/06
                        J6 = J6 + 2.5 ////////08/11/09
                    } else {
                        J6 = J6 + 2 ////////08/11/13
                    }
                }
            } else {
//                    J55 = Round(2 * (P7 / Max荷重), 1)
                J55 = Round(5.5 * (P7 / Max荷重) ^ 0.5, 1) ////////////08/12/07 //////09/04/06
                if ( g荷重表記縦 = 1 $$ J55 < 4 ) { ////////09/11/11
                    J55 = J55 + 1.5
                }
                if ( (P7 / Max荷重) > 0.9 ) { //////09/04/06
                    if ( J6 < 0 ) { J6 = J6 / 2
                } else {
                    if ( J6 < 0 ) { J6 = 2.5 ////////////J6 = 0//////////////////08/11/17
                    if ( (P7 / Max荷重) < 0.2 ) { J55 = J55 + 0.8 //////09/04/06
                }
                J7 = 0
            }
        } else {if ( (P7 / Max荷重) > 0.8 ) {
            J6 = J6 + 2
        } else {if ( (P7 / Max荷重) < 0.15 $$ J8 = 0 ) {
            if ( J6 = 1 ) {
                J6 = 0
                J88 = 1.8
            } else {
                J7 = 2
            }
        }
        GOUKEI = (J7 * 60 + J88 * 160 - J55 * 120 - J6 * 80 - gY55)
        if ( g荷重表記縦 = 1 $$ g荷重表記高 < 120 $$ GOUKEI < -560 ) { ////09/12/25////09/11/199
            GOUKEI = -560 ////////09/12/25//////-450
        }
    }
} ////////08/10/29
YNEXT:

if ( 水平垂直 = 0 $$ (Mark111 = 2 || Mark111 = 3 || Mark111 = 4) ) { ////////09/11/11
    if ( 荷重図開き < 0 ) {
        GOUKEI = GOUKEI - 180 //09/11/16
    } else {if ( (g荷重表記縦 = 1 $$ GOUKEI * 1.3 > -400 $$ GOUKEI < 0) ) { ////////09/11/11
        GOUKEI = GOUKEI * 1.3
    } else {if ( (g荷重表記縦 = 1 $$ GOUKEI < -630 $$ GOUKEI < 0) ) { ////////09/11/11 $$ GOUKEI < -650 ////10/01/14
        GOUKEI = -550
    }
    if ( 下床文字表示 = 0 $$ 連続荷重_P1(1) * 連続荷重_P2(1) < 0 $$ g荷重表記高 > 250 ) { //////09/12/04
        GOUKEI = -650 - Round(g荷重表記高 / 2, 1) //////09/12/04
    }
    if ( g荷重表記縦 = 0 $$ yiKozo = 3 $$ g連続Mod = False $$ (P7 / Max荷重) < 0.75 $$ 荷重図開き > 0 ) { //////13/04/19//////13/12/31
        if ( 連続荷重数 = 1 $$ 連続荷重_L1(1) + 連続荷重_L2(1) = 0 $$ wXs = XXYY(2) $$ wXe = XXYY(1) $$ wYs != YY_max ) {
            NN = 1
        }
    }
} else {if ( 水平垂直 = 0 $$ GOUKEI < -500 $$ (Mark111 = 5 || Mark111 = 11) ) {
    GOUKEI = -180 ////////09/11/11
}
GOUKEI = Round(GOUKEI, 0) ////////08/10/29//////08/11/27
////////09/02/20
var yyF5 As Single, yyF6 As Single //////09/08/05
yyF5 = 0

if ( Not (水平垂直 = 1 $$ Mark111 = 1) ) { //////09/09/25
    if ( (水平垂直 = 1 $$ (連続荷重_P1(1) < 0 || 連続荷重_P2(1) < 0)) ) { ////////09/08/03
        if ( Mark111 = 1 ) {
            if ( Len(Format(P7, "0.00")) > 6 ) {
                yyF5 = 450
            } else {
                yyF5 = 350
            }
        } else {
            if ( g荷重表記縦 = 0 $$ N段数 = 1 $$ 連続荷重_P1(1) = 連続荷重_P2(1) ) {
                if ( FLG杭杭 || yiKozo != 3 ) { ////////09/08/03 09/08/05
                    yyF5 = -70
                } else {
                    yyF5 = -130
                }
            }
        }
    }
} else {if ( (水平垂直 = 1 $$ Mark111 = 1) ) {
        if ( 連続荷重_P1(1) > 0 ) {
            寸法線位置 = -10 ////////14/11/16
            寸法補助線 = 3
            yyF5 = -100
            f寸法FLG = -1
        } else {
            寸法線位置 = 2.5 ////////14/11/16
            寸法補助線 = 3
            yyF5 = 0
            f寸法FLG = 1
        }

        For( i = 1 To NN
            寸法(i) = F2(XL(i + 1) - XL(i))
            XL(i) = 図倍率 * XL(i)
            X(i) = PX0 + XL(i) * BCS + yyF5
            Y(i) = PY0 - XL(i) * BSN + GOUKEI * BCS
        }
        this.SunPou2("<", NN, 寸法線位置, 寸法補助線, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, 1, 荷重図開き)
        GoTo ABC
}
For( i = 1 To NN
    寸法(i) = F2(XL(i + 1) - XL(i))
    XL(i) = 図倍率 * XL(i)
    X(i) = PX0 + XL(i) * BCS + yyF5 //////09/02/20
    if ( 荷重方向 = "V" || 荷重方向 = "M" || 荷重方向 = "S" ) {
        Y(i) = PY0 - XL(i) * BSN + GOUKEI * Abs(BCS)
    } else {
        Y(i) = PY0 - XL(i) * BSN + GOUKEI * BCS
    }
}
////////////////////
var RX1D, RX2D, RY1D, RY2D, RY3D, DXY, 前DXY, WW, Ww1, Ww2
var strNum1 As String, strNum2 As String //////////14/12/22//////, str前Num As String, str後Num As String
var FLG_横書き As Integer
var k荷重表記縦 As Integer
////////=====================================s荷重位置s荷重位置s荷重位置s荷重位置s荷重位置s荷重位置
if ( s側圧数 > 0 ) {
    if ( FLG_側圧9 = 1 ) { ////////左→
        s荷重位置 = min(s各側圧位置(1, 1), s各側圧位置(1, 2))
        For( i = 2 To s側圧数
            s荷重位置 = min(s各側圧位置(i, 1), s各側圧位置(i, 2))
        }
    } else { ////////FLG_側圧9 = 2 ////////右←
        s荷重位置 = max(s各側圧位置(1, 1), s各側圧位置(1, 2))
        For( i = 2 To s側圧数
            s荷重位置 = max(s各側圧位置(i, 1), s各側圧位置(i, 2))
        }
//            s荷重位置 = s荷重位置 + 500
    }
}
if ( s荷重位置 != 999999 ) { //////13/04/20
    if ( g荷重表記縦 = 0 ) {
        if ( s側圧数 = 0 ) {
            寸法線位置 = -5
            寸法補助線 = -3.5
            if ( Mark111 = 3 ) { ////////////////////////////////////////13/10/10
                if ( (P7 / Max荷重) < 0.38 ) {
                   寸法線位置 = -7.7 //////////////////////////14/11/26
                } else {if ( (P7 / Max荷重) < 0.44 ) {
                    寸法線位置 = -8
                } else {if ( (P7 / Max荷重) > 0.9 ) { //////13/10/10
                    寸法線位置 = -10.5
                } else {
                    寸法線位置 = -8 //////14/09/27
                }
            }
            if ( Mark111 = 4 ) {
                if ( (P7 / Max荷重) < 0.44 ) {
                    寸法線位置 = -4
                }
            }
        } else {
            if ( FLG_側圧9 = 1 ) {
                寸法線位置 = -8
                寸法補助線 = -4
            } else {
                寸法線位置 = 8
                寸法補助線 = 4
            }
        }
    } else {
        if ( s側圧数 = 0 ) {
            寸法線位置 = -16
            寸法補助線 = -4
        } else {
            if ( FLG_側圧9 = 1 ) {
                寸法線位置 = -16 - 2
                寸法補助線 = -8
            } else {
                寸法線位置 = -17 - 2
                寸法補助線 = 8
            }
        }
    }
var gKAJYUITI As Single
gKAJYUITI = s荷重位置
var gVVITI As Single
    gVVITI = s荷重位置 ////////14/11/18////// - 50
var FLG_999 As Integer: FLG_999 = 0

    if ( s側圧数 = 0 ) {
        if ( s側圧数 = 0 $$ 荷重図開き > 0 $$ 水平部材最下端 = wYs $$ wYs = wYe $$ N段数 = 1 $$ FLGMORO ) { //////1/04/25
            s荷重位置 = HEN_Y(wYs)
        }
        For( i = 1 To NN
            Y(i) = s荷重位置
        }
    } else {
        For( i = 1 To NN
            X(i) = s荷重位置
        }
    }

    k荷重表記縦 = g荷重表記縦
    if ( Total > 0 ) {
        FLG_横書き = 0
        if ( k荷重表記縦 = 0 ) {
            For( i = 1 To Total
                strNum1 = strKAJYU(i, 1)
                strNum2 = strKAJYU(i, 2)
                RX1D = X(kPoint(i, 1))
                RX2D = X(kPoint(i, 2))
                if ( s側圧数 = 0 ) {
//                        if ( Not ((strNum1 = strNum2) $$ Abs(RX1D - RX2D) >= 500) ) {
                    if ( Not (strNum1 = "" || strNum2 = "") ) { //////14/11/18
                        if ( Not (i < Total $$ strKAJYU(i + 1, 1) = strKAJYU(i + 1, 2) $$ strNum2 = strKAJYU(i + 1, 1)) ) {
                            if ( (strNum1 != strNum2) || Abs(RX1D - RX2D) < 500 $$ (RX1D - HEN_X(wXe) > 600 || HEN_X(wXe) - RX2D > 600) ) {
                            if ( strNum1 != strNum2 $$ ((strNum1 != "" $$ strNum2 != "") || Abs(RX1D - RX2D) < 300) ) { //////14/11/78
                                FLG_横書き = 1
                                Exit For
                            }
                            }
                        }
                    }
                } else {
                    if ( Not (strNum1 = "" || strNum2 = "") || (strNum1 != strNum2 $$ strNum2 != "") ) {
                        if ( strNum1 != strNum2 ) {
                            FLG_横書き = 1
                            Exit For
                        }
                    }
                }
                if ( i = 1 $$ FLG_888 = 1 ) {
                        FLG_横書き = 1
                        Exit For
                }
            }
        }
        WW = frmPrint.vsPrt1.TextWidth("A") + 2
    if ( s側圧数 = 0 ) {
        寸法線位置 = -(Num文字列数 * 2 + 5)
        寸法補助線 = -4

        For( i = 1 To Total
            strNum1 = strKAJYU(i, 1)
            strNum2 = strKAJYU(i, 2)
            str後Num = strKAJYU(i + 1, 1)
            if ( strNum1 = strNum2 ) {
//                   if ( strKAJYU(i - 1, 1) = "" $$ strKAJYU(i - 1, 2) = strNum1 $$ _
//                      strKAJYU(i + 1, 2) = "" $$ strNum2 = str後Num ) {
//                       strKAJYU(i - 1, 2) = ""
//                       strKAJYU(i, 1) = ""
//                       strKAJYU(i, 2) = ""
//                       strKAJYU(i + 1, 1) = ""
//                   }
            }
        }
        For( i = 1 To Total
            strNum1 = strKAJYU(i, 1)
            strNum2 = strKAJYU(i, 2)
            str後Num = strKAJYU(i + 1, 1)

            RY1D = yyHH1 + (frmPrint.vsPrt1.TextWidth(strNum1) + 330)
            RY2D = yyHH2 + (frmPrint.vsPrt1.TextWidth(strNum2) + 330)
//                RY1D = RY3D + (frmPrint.vsPrt1.TextWidth(strNum1) + 330)
//                RY2D = RY3D + (frmPrint.vsPrt1.TextWidth(strNum2) + 330)
            RX1D = X(kPoint(i, 1))
            RX2D = X(kPoint(i, 2))
            if ( (RX2D - RX1D) < 800 $$ Not (i = 1 || i = Total) ) {
                FLG_999 = 1
            }
            if ( i = 1 ) { ////////////////////////////////////////13/04/24
                if ( strNum1 != strNum2 $$ H水平(0) = 節Y(節点S) $$ H水平(1) = val(strNum1) $$ H水平(2) = Round(RX1D, 3) ) {
                    strNum1 = ""
                    if ( FLG_横書き = 1 $$ Total = 1 $$ Abs(RX1D - RX2D) > 600 $$ strNum1 = strNum2 ) {
                        FLG_横書き = 0
                        if ( g荷重表記縦 = 0 ) {
                            gVVITI = s荷重位置 + 0
                        } else {
                            gVVITI = s荷重位置 + 3
                        }
                    }
                }
            }
            if ( i = Total ) {
                H水平(0) = IIf(荷重方向 = "V", 節Y(節点S), 節Y(節点E))
                H水平(1) = val(strNum2)
                H水平(2) = Round(RX2D, 3)
            }
            strNum1 = strNum1 & IIf(strNum1 = "", "", strUN & "/m")
            strNum2 = strNum2 & IIf(strNum2 = "", "", strUN & "/m")
            str後Num = str後Num & IIf(str後Num = "", "", strUN & "/m")

            if ( FLG_横書き = 0 ) {
                if ( 部材_max > 40 ) { //////And strNum1 = strNum2 ) { ////////g連続Mod = False $$ iKozo = 3 $$ 部材_max > 30 ) {
                    寸法線位置 = -4.5
                    寸法補助線 = -3
                } else {
                    寸法線位置 = -7
                    寸法補助線 = -3
                    g荷重表記高 = 130
                }
                if ( s側圧数 = 0 $$ 荷重図開き > 0 $$ 水平部材最下端 = wYs $$ wYs = wYe $$ N段数 = 1 $$ FLGMORO ) { //////1/04/25
                    if ( (yiKozo = 3 $$ NKUI = 0 $$ 部材_max > 100) ) { ////////13/12/31
                        寸法線位置 = -8.5
                    } else {
                        寸法線位置 = 9
                        寸法補助線 = 5
                    }
                }
//                    GoTo GRF44
                if ( strNum1 != strNum2 ) {
                    if ( strNum1 != "" ) {
                        if ( strNum1 != str前Num || (strNum1 = str前Num $$ RX1D != X(kPoint(i - 1, 2))) $$ str後Num = "" ) {
                            WW = frmPrint.vsPrt1.TextWidth(strNum1)
                            this.MOJ2C("D上*", RX1D - WW / 2 + WW / 8, gVVITI, RX1D + WW / 2 + WW / 8, gVVITI, strNum1)
//                                str前Num = strNum1
                        }
                    }

                    if ( strNum2 != "" $$ strNum1 != "" $$ strNum2 != str後Num ) { //////14/11/178
                        WW = frmPrint.vsPrt1.TextWidth(strNum2)
                        this.MOJ2C("D上*", RX2D - WW / 2 + WW / 8, gVVITI, RX2D + WW / 2 + WW / 8, gVVITI, strNum2)
                        str前Num = strNum2
                    }

                }
                GoTo GRF44
            }
            if ( strNum1 = strNum2 ) {
                if ( Abs(RX1D - RX2D) < 200 ) {
                    if ( str前前Num != strNum1 || Abs(sgl前前Num - (RX1D + RX2D) / 2) > 1000 ) {
                        if ( yiKozo = 1 $$ k荷重表記縦 = 0 ) {
                            if ( s側圧数 = 0 $$ 荷重図開き > 0 $$ 水平部材最下端 = wYs $$ wYs = wYe $$ N段数 = 1 $$ FLGMORO ) { //////1/04/25
                                RY1D = gVVITI - 150
                            } else {
                                RY1D = s荷重位置 + 170
                            }
                            RY3D = RY1D
                            this.MOJ2L("U上", RX1D, RY1D, RX2D, RY3D, strNum1) ////////////////下に表記
                            sgl前前Num = (RX1D + RX2D) / 2
                        } else { ////////////////縦に表記
                            if ( str前前Num != strNum1 ) {
                                DXY = (RX1D + RX2D) / 2 - WW * 1.5
                                if ( Abs(DXY - 前DXY) < 150 ) {
                                    DXY = 前DXY + WW * 1.5
                                }
                                if ( (val(strKAJYU(i, 1)) / Max荷重) < 0.1 ) {
                                    RY1D = RY1D + 200
                                    RY3D = RY3D + 200
                                }
                                this.MOJ2L("U上", DXY, RY1D, DXY, RY3D, strNum1)
                                if ( yiKozo != 1 ) {
                                    k荷重表記縦 = 1 //////13/12/28
                                }
                                前DXY = DXY
                                sgl前前Num = DXY
                            }
                        }
                    }
                }
                str前Num = strNum1
                str前前Num = strNum1
            } else {
                if ( Total = 1 ) {
                    if ( Abs(RX1D - RX2D) < 800 ) {
                        DXY = RX1D - WW
                        if ( strNum1 != "" ) {
                        this.MOJ2L("U上", DXY, RY1D, DXY, RY3D, strNum1): k荷重表記縦 = 1
                        }
                        DXY = RX2D + WW
                        if ( strNum2 != "" ) {
                        this.MOJ2L("U上", DXY, RY2D, DXY, RY3D, strNum2): k荷重表記縦 = 1
                        }
                    } else {
                        DXY = RX1D + WW
                        DXY = RX1D - WW / 2
                        if ( strNum1 != "" ) {
                        this.MOJ2L("U上", DXY, RY1D, DXY, RY3D, strNum1): k荷重表記縦 = 1
                        }
                        DXY = RX2D - WW * 2.2
                        if ( strNum2 != "" ) {
                        this.MOJ2L("U上", DXY, RY2D, DXY, RY3D, strNum2): k荷重表記縦 = 1
                        }
                    }
                } else {
                    if ( i = 1 ) {
                        if ( strNum1 != "" ) {
                            if ( Abs(RX1D - RX2D) < 150 ) {
                                DXY = RX2D - WW * 3
                            } else {
                                DXY = RX1D - WW / 2
                                if ( FLG_888 = 1 ) { //////14/09/17
                                    DXY = DXY - WW * 2
                                }
                            }
                            this.MOJ2L("U上", DXY, RY1D, DXY, RY3D, strNum1)
                            if ( FLG_888 != 1 ) { //////14/09/17
                                k荷重表記縦 = 1
                            }
                            前DXY = DXY
                        }
                        if ( strKAJYU(i, 2) = strKAJYU(i + 1, 1) $$ X(kPoint(i, 2)) = X(kPoint(i + 1, 1)) ) {
                            DXY = RX2D - WW
                        } else {
                            if ( Abs(RX1D - RX2D) < 150 ) {
                                DXY = RX2D - WW * 3
                            } else {
                                DXY = RX2D - WW * 2.2
                            }
                        }
                        if ( Abs(DXY - 前DXY) < 150 ) {
                            DXY = 前DXY + WW * 1.5
                        }
                        if ( strNum2 != "" $$ strKAJYU(i, 2) != strKAJYU(i + 1, 1) ) {
                        this.MOJ2L("U上", DXY, RY2D, DXY, RY3D, strNum2): k荷重表記縦 = 1
                        前DXY = DXY
                        str前Num = strNum2
                        }
                    } else {if ( i = Total ) {
                        if ( strNum1 != str前Num || (strNum1 = str前Num $$ RX1D != X(kPoint(i - 1, 2))) ) {
                            DXY = RX1D - WW / 2
                            if ( Abs(DXY - 前DXY) < 150 ) {
                                DXY = 前DXY + WW * 1.5
                            }
                            this.MOJ2L("U上", DXY, RY1D, DXY, RY3D, strNum1): k荷重表記縦 = 1
                            前DXY = DXY
                            str前Num = strNum1
                        }
                        //
                        if ( strNum2 != "" ) {
                            DXY = RX2D - WW * 2.2
                            if ( FLG_888 = 2 ) { //////14/09/17
                                DXY = DXY + WW * 2.3
                            }
                            if ( Abs(DXY - 前DXY) < 150 ) {
                                DXY = 前DXY + WW * 1.5
                            }
                            this.MOJ2L("U上", DXY, RY2D, DXY, RY3D, strNum2)
                            if ( FLG_888 != 2 ) {
                                k荷重表記縦 = 1
                            }
                        }
////////// 一般的
                    } else {
                        if ( strNum1 != "" $$ strNum1 != str前Num || (strNum1 = str前Num $$ RX1D != X(kPoint(i - 1, 2))) ) {
                            if ( Abs(RX1D - RX2D) < 150 ) {
                                DXY = RX1D - WW * 3
                            } else {
                                DXY = RX1D - WW / 2 //////(RX1D + Ww)
                            }
                            if ( Abs(DXY - 前DXY) < 150 ) {
                                DXY = (前DXY + WW * 1.5)
                            }
                            if ( strNum1 != "" ) {
                                this.MOJ2L("U上", DXY, RY1D, DXY, RY3D, strNum1)
//                                    if ( strNum2 = "" ) {
                                    前DXY = DXY
                                    str前Num = strNum1
                                    k荷重表記縦 = 1
//                                    }
                            }
                        }
                        //
                            DXY = RX2D - WW * 2.2
                            if ( Abs(DXY - 前DXY) < 150 ) {
                                DXY = 前DXY + WW * 1.5
                            }
                        if ( strNum2 != "" ) {
                            this.MOJ2L("U上", DXY, RY2D, DXY, RY3D, strNum2)
                            前DXY = DXY
                            str前Num = strNum2
                            k荷重表記縦 = 1
                        }
                    }
                }
            }
GRF44:
        }
        g荷重表記縦 = k荷重表記縦
        if ( g荷重表記縦 = 0 ) {
            if ( Not (yiKozo = 3 $$ NKUI = 0 $$ 部材_max > 100) ) { ////////13/12/31
            寸法線位置 = Round(min(13 * (P7 / Max荷重), 5), 2) * Sgn(寸法線位置) //////13/12/28
            }
            if ( s側圧数 = 0 $$ 荷重図開き > 0 $$ 水平部材最下端 = wYs $$ wYs = wYe $$ N段数 = 1 $$ FLGMORO ) {
                寸法線位置 = max(寸法線位置, 7)
                寸法補助線 = Abs(寸法補助線) * Sgn(寸法線位置)
            }
        }
    } else { //////////////////////////////////////////////////////////////////////////////////////////////////////////側壁
//            str前Num = ""
        RY3D = s荷重位置 - (Num文字列数 * WW + 400)
        For( i = 1 To Total
            strNum1 = strKAJYU(i, 1)
            strNum2 = strKAJYU(i, 2)
            RY1D = Y(kPoint(i, 1))
            RY2D = Y(kPoint(i, 2))
            if ( i = 1 ) { ////////////////////////////////////////13/04/24
                if ( V鉛直(0) = 節X(節点S) $$ V鉛直(1) = val(strNum1) $$ Abs(V鉛直(2) - Round(RY1D, 3)) < 0.005 ) {
                    strNum1 = ""
                }
            }
            if ( i = Total ) {
                V鉛直(0) = 節X(節点E)
                V鉛直(1) = val(strNum2)
                V鉛直(2) = Round(RY2D, 3)
            }
            if ( FLG杭杭 = True $$ i != 1 $$ strKAJYU(i, 1) = strKAJYU(i, 2) $$ strKAJYU(1, 1) = strKAJYU(i, 1) ) {
                GoTo GRF55
            }
            strNum1 = strNum1 & IIf(strNum1 = "", "", strUN & "/m")
            strNum2 = strNum2 & IIf(strNum2 = "", "", strUN & "/m")
//                WW = max(frmPrint.vsPrt1.TextWidth(strNum1), frmPrint.vsPrt1.TextWidth(strNum2))
            if ( strNum1 = strNum2 ) {
                if ( FLG_側圧9 = 1 ) {
//                        RX1D = s各側圧位置(i, 1) - (80 + WW * 1) ////// 15/02/02
//                        RX2D = s各側圧位置(i, 2) - (80 + WW * 1)
                    RX1D = s各側圧位置(i, 1) - (frmPrint.vsPrt1.TextWidth(strNum1) + IIf(iKozo = 3, 10, 50))
                    RX2D = s各側圧位置(i, 2) - (frmPrint.vsPrt1.TextWidth(strNum2) + IIf(iKozo = 3, 10, 50))
                } else {
                    RX1D = s各側圧位置(i, 1) + WW * 0.5
                    RX2D = s各側圧位置(i, 2) + WW * 0.5
                }
            } else {
                if ( FLG_側圧9 = 1 ) {
                    RX1D = s各側圧位置(i, 1) - (frmPrint.vsPrt1.TextWidth(strNum1) + IIf(iKozo = 3, 10, 100))
                    RX2D = s各側圧位置(i, 2) - (frmPrint.vsPrt1.TextWidth(strNum2) + IIf(iKozo = 3, 10, 100))
                } else {
                    RX1D = s各側圧位置(i, 1) + 60 + IIf(iKozo = 3, 10, 100)
                    RX2D = s各側圧位置(i, 2) + 60 + IIf(iKozo = 3, 10, 100)
                }
            }
            if ( FLG_側圧9 = 2 ) {
                RX1D = RX1D + 60
                RX2D = RX2D + 60
            }
            Ww1 = frmPrint.vsPrt1.TextWidth(strNum1)
            Ww2 = frmPrint.vsPrt1.TextWidth(strNum2)
                            //
            if ( FLG_横書き = 0 ) {
//                    if ( FLG_側圧9 = 1 ) {
//                        寸法線位置 = -8
//                        寸法補助線 = -4
//                    } else {
//                        寸法線位置 = 10
//                        寸法補助線 = 4
//                    }
                    if ( strNum1 != "" ) {
                        if ( strNum1 != str前Num ) { //////Or (strNum1 = str前Num $$ RX1D != X(kPoint(i - 1, 2))) ) {
                            if ( iKozo = 1 ) {
                                DXY = s各側圧位置(i, 1) + IIf(FLG_側圧9 = 1, -240, 40)
                            } else {
                                DXY = s各側圧位置(i, 1) + IIf(FLG_側圧9 = 1, -180, 40)
                            }
                            RY3D = (RY1D + RY2D) / 2 + Ww1 * 0.4
                            if ( Abs(RY3D + DXY - 前前DXY(FLG_側圧9)) < Ww1 ) { ////////14/12/02
                                DXY = DXY + IIf(FLG_側圧9 = 1, -WW * 1.5, WW * 1.5)
                                this.MOJ2L("U上", DXY, RY3D, DXY, RY3D, strNum1)
                                前前DXY(FLG_側圧9) = 0
                            } else {
                                this.MOJ2L("U上", DXY, RY3D, DXY, RY3D, strNum1)
                                前前DXY(FLG_側圧9) = RY3D + DXY
                            }
                        }
                    }
                if ( strNum1 = strNum2 ) { GoTo GRF55
            }
            if ( FLG_側圧9 = 1 ) {
                if ( 連続荷重数 = 1 ) {
                    寸法線位置 = -(Num文字列数 * 1.8 + 6.5)
                    寸法補助線 = -8
                } else {
                    寸法線位置 = -(Num文字列数 * 2 + 6.5)
                    寸法補助線 = -8
                }
            } else {
                if ( 連続荷重数 = 1 ) {
                    寸法線位置 = (Num文字列数 * 1.8 + 7)
                    寸法補助線 = 8
                } else {
                    寸法線位置 = (Num文字列数 * 2 + 7)
                    寸法補助線 = 8
                }
            }
            if ( strNum1 = strNum2 ) {
//                    if ( Abs(RX1D - RX2D) < 500 ) {
                    RY3D = (RY1D + RY2D) / 2
                    this.MOJ2C("D上*", RX1D, RY3D, RX1D + Ww1, RY3D, strNum1): k荷重表記縦 = 1
                    前DXY = DXY
                    str前Num = strNum1
//                    }
            } else {
                if ( Total = 1 ) {
                    if ( wYs = JY_max || wYs = YY_max ) {
                        DXY = RY1D - WW / 8
                    } else {
                        DXY = RY1D + WW * 1.8
                        if ( Abs(前前DXY(FLG_側圧9) - DXY) > 250 ) {
                            DXY = RY1D
                        }
                    }
                    前DXY = DXY
                    if ( strNum1 != "" $$ strNum1 != str前Num ) {
                        this.MOJ2C("D上*", RX1D, DXY, RX1D + Ww1, DXY, strNum1): k荷重表記縦 = 1
                    }
                    if ( (wYe = YY_min || wYe = 水平部材最下端) $$ 連続荷重_L2(Total) = 0 ) { //////13/11/15
                        DXY = RY2D + WW * 1.8
                        if ( FLG_側圧9 = 1 ) { //////13/11/16
                            RX2D = RX2D + WW * 2.3
                        }
                        if ( FLG_側圧9 = 2 ) {
                            RX2D = RX2D - WW
                        }
                    } else {
                        DXY = RY2D - WW / 8
                    }
                    if ( Abs(DXY - 前DXY) < 150 ) {
                        DXY = 前DXY + WW * 0.2
                    } else {
//                            if ( Abs(RY2D - RY3D) < 160 ) {
//                                DXY = RY2D + WW * 1.8 //////////14/12/02
//                            } else {
                            DXY = RY2D - WW * 0 //////////14/12/02
                            if ( (wYe = YY_min || wYe = 水平部材最下端) $$ 連続荷重_L2(Total) = 0 ) {
                                DXY = RY2D + WW * 2.3
                            }
//                            }
                    }
                    WW = frmPrint.vsPrt1.TextWidth(strNum2)
var 前後RXY As Single
var RXY_ As Single
var QQQ2 As Single, yyy As Single
RXY_ = RX2D + Ww2 / 2
yyy = DXY
this.前後XYXY(RXY_, 前後RXY, QQQ2, yyy)
//                        if ( Abs(RX2D - 前RXY) < WW + 20 ) { //////15/01/08
//                            if ( strNum2 = str前Num ) {
//                                strNum2 = ""
//                            }
//                        }
                    if ( Abs(RX2D + Ww2 / 2 - 前後RXY) < WW + 20 ) { //////15/01/08
                        if ( val(strKAJYU(i, 2)) = QQQ2 ) {
                            strNum2 = ""
                        } else {
                            DXY = DXY - 120
                        }
                    }

                    if ( strNum2 != "" ) {
                        this.MOJ2C("D上*", RX2D, DXY, RX2D + Ww2, DXY, strNum2): k荷重表記縦 = 1
                        str前Num = strNum2
//                            前RXY = RX2D + Ww2
                        前RXY(0, 0) = 前RXY(0, 0) + 1
                        前RXY(前RXY(0, 0), 1) = RX2D + Ww2 / 2
                        前RXY(前RXY(0, 0), 2) = DXY
                        前RXY(前RXY(0, 0), 3) = val(strKAJYU(i, 2))
                    }
                } else {
                    if ( i = 1 ) {
                        if ( wYs = JY_max || wYs = YY_max ) {
                            DXY = RY1D - WW / 8
                        } else {
                            DXY = RY1D + WW * 1.8
                        }
                        if ( strNum1 != "" ) {
                            this.MOJ2C("D上*", RX1D, DXY, RX1D + Ww1, DXY, strNum1): k荷重表記縦 = 1
                            前DXY = DXY
                            str前Num = strNum1
                        }
                        DXY = RY2D - WW / 8
                        if ( Abs(DXY - 前DXY) < 150 ) {
                            if ( strKAJYU(i, 2) = strKAJYU(i + 1, 1) ) {
                                DXY = RY2D + WW * 1.8
                            } else {
                                DXY = 前DXY + WW * 1.5
                            }
                        }
                        if ( (wYe = YY_min || wYe = 水平部材最下端) $$ 連続荷重_L2(i) = 0 ) { //////13/11/15
                            DXY = RY2D + WW * 1.8
                            if ( FLG_側圧9 = 1 ) { //////13/11/16
                                RX2D = RX2D + WW * 2.3
                            }
                            if ( FLG_側圧9 = 2 ) {
                                RX2D = RX2D - WW
                            }
                        }
                        if ( strNum2 != "" ) {
                            this.MOJ2C("D上*", RX2D, DXY, RX2D + Ww2, DXY, strNum2): k荷重表記縦 = 1
                            前DXY = DXY
                            str前Num = strNum2
                        }
                    } else {if ( i = Total ) {
                        if ( strNum1 != str前Num ) {
                            DXY = RY1D + WW * 1.8
                            if ( Abs(DXY - 前DXY) < 150 ) {
                                DXY = 前DXY + WW * 1.5
                            }
                            this.MOJ2C("D上*", RX1D, DXY, RX1D + Ww1, DXY, strNum1): k荷重表記縦 = 1
                            前DXY = DXY
                            str前Num = strNum1
                        }
                        //
                        if ( strNum2 != "" ) {
                            DXY = RY2D + WW * 1.8
                            if ( Abs(DXY - 前DXY) < 150 ) {
                                DXY = 前DXY + WW * 1.5
                            }
                            if ( (wYe = YY_min || wYe = 水平部材最下端) $$ 連続荷重_L2(i) = 0 ) { //////13/11/15
                                if ( iKozo = 3 ) {
                                DXY = DXY + WW / 3
                                } else {
                                DXY = DXY + WW / 1.3
                                }
                                if ( FLG_側圧9 = 1 ) {
                                    RX2D = RX2D + WW * 3
                                } else {if ( FLG_側圧9 = 2 ) {
                                    RX2D = RX2D - WW * 2.5
                                }
                            } else {
                                if ( Abs(DXY - 前DXY) < 150 ) {
                                    DXY = 前DXY + WW * 1.5
                                } else {
                                    DXY = RY2D - WW * 0 //////////14/12/02
                                }
                            }
                            this.MOJ2C("D上*", RX2D, DXY, RX2D + Ww2, DXY, strNum2): k荷重表記縦 = 1
                        }
////////// 一般的
                    } else {
                        if ( strNum1 != str前Num ) {
                            DXY = RY1D + WW * 1.8
                            if ( Abs(DXY - 前DXY) < 150 ) {
                                DXY = (前DXY + WW * 1.5)
                            }
                            if ( strNum1 != "" ) {
                                this.MOJ2C("D上*", RX1D, DXY, RX1D + Ww1, DXY, strNum1): k荷重表記縦 = 1
                                前DXY = DXY
                                str前Num = strNum1
                            }
                        }
//                            if ( strKAJYU(i, 2) = strKAJYU(i + 1, 1) ) {
//                                DXY = RY2D - Ww
//                            } else {
//                                DXY = RY2D - Ww / 8
//                            }
                        DXY = RY2D - WW / 8
                        if ( Abs(DXY - 前DXY) < 150 ) {
                            if ( strKAJYU(i, 2) = strKAJYU(i + 1, 1) ) {
                                DXY = RY2D + WW * 1.8
                            } else {
                                DXY = 前DXY + WW * 1.5
                            }
                        }
//
//                            DXY = RY2D - Ww / 8
//                            if ( Abs(DXY - 前DXY) < 150 ) {
//                                DXY = 前DXY + Ww * 1.5
//                            }
                        if ( i < Total $$ strKAJYU(i, 2) = strKAJYU(i + 1, 1) $$ strKAJYU(i + 1, 2) = strKAJYU(i + 1, 1) ) {
                            str前Num = strNum2
                        } else {
                            if ( strNum2 != "" ) {
                                this.MOJ2C("D上*", RX2D, DXY, RX2D + Ww2, DXY, strNum2): k荷重表記縦 = 1
                                前DXY = DXY
                                str前Num = strNum2
                            }
                        }
                    }
                }
            }
GRF55:
        }
        g荷重表記縦 = k荷重表記縦

        }
    }
    if ( 連続荷重_L1(1) + 連続荷重_L2(1) = 0 $$ (wXs = JX_min $$ wXe = JX_max) $$ Now荷重max1 > 1 ) {
        if ( N段数 = 1 ) { //////14/11/178
            yyF5 = 8
        } else {
//                yyF5 = 0
            if ( (P7 / Max荷重) > 0.8 ) {
                yyF5 = 0
                if ( 部材正荷重数(SS1) < 30 ) {
                        yyF5 = 0.5
                } else {
                        yyF5 = 1
                }
            } else {
                yyF5 = 4.5 ////14/11/178
            }
        }
        For( i = SS1 To SE2
            部材正荷重数(i) = 部材正荷重数(i) - yyF5 //////14/11/178
        }

        GoTo ABC //////GoTo GRF9
    } else {
        GoTo GRF9
    }
}
if ( X(1) = X(連続荷重数) ) {
    HV = 0
}
//////////
obj.FontSize = 荷重寸法Fontsize
obj.PenWidth = 部材荷重寸法Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(obj.PenWidth))
}
obj.PenColor = QBColor(部材荷重寸法Pen色)
Select Case Mark111
Case 1, 2, 3, 4, 5, 6, 7, 11
//GRF: //////////////////////09/11/06
    if ( 水平垂直 != 1 $$ 荷重図開き < 0 ) { //////09/11/16
        寸法線位置 = Abs(寸法線位置) ////////////10/05/12寸法線位置 * Sgn(荷重図開き) //////09/11/16
    }
//////08/11/06
var M As Integer, Atta As Integer
var YUT As Single
    Atta = 0
    //////////09/11/09
    if ( 水平垂直 != 1 $$ (Mark111 = 1 || Mark111 = 5 || Mark111 = 6 || Mark111 = 11) $$ N段数 = 1 ) { ////////08/11/06
        if ( 下層BUZAI(1, 1) != 0 ) {
            For( M = 1 To 部材_max
                if ( 下層BUZAI(M, 1) = 0 ) { Exit For
                if ( 下層BUZAI(M, 2) >= 節点S $$ 下層BUZAI(M, 2) <= 節点E ) {
                    Atta = 1
                    Exit For
                }
                if ( 下層BUZAI(M, 3) >= 節点S $$ 下層BUZAI(M, 3) <= 節点E ) {
                    Atta = 1
                    Exit For
                }
            Next M
        }
        if ( Atta = 0 $$ yiKozo = 1 $$ Abs(YY_max - (wYe + wYs) / 2) > 1.6 ) {
            Atta = 1
            PY0 = min(HEN_Y(wYs), HEN_Y(wYe)) + 2 * Twip
        }
        if ( Atta = 0 $$ yiKozo = 1 $$ (水平部材最下端 = (wYs + wYe) / 2 $$ Mark111 = 6) ) { //////13/11/15
            Atta = 1
            PY0 = min(HEN_Y(wYs), HEN_Y(wYe)) + 2 * Twip
        }
    }
//////08/11/06
    if ( Atta = 1 ) {
        if ( (水平部材最下端 = (wYs + wYe) / 2) $$ (yiKozo = 1 || yiKozo = 3) $$ 水平垂直 = 0 $$ N段数 = 1 ) {
            For( i = 1 To NN //////////09/10/25
                Y(i) = PY0 + (XL(i) * BSN - 0 * BCS) - 5 * Twip //////////////09/11/08
            }
            this.SunPou2("<", NN, 10, 4, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, 1, 荷重図開き): GoTo ABC //////09/10/20 12/12/15
        } else {
            For( i = 1 To NN //////////09/10/25
                Y(i) = PY0 + (XL(i) * BSN - 95 * BCS) - 5 * Twip //////////////09/11/08
            }
            this.SunPou2("<", NN, 10, 4, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, , 荷重図開き): GoTo ABC //////09/10/20 12/12/15
        }
    } else {
        if ( Mark111 = 5 ) {
            if ( 水平垂直 = 1 ) { ////13/04/08
                寸法線位置 = -10
                寸法補助線 = -3
            } else {
                寸法線位置 = 4.5
                寸法補助線 = -4
            }
        }
        if ( f寸法FLG = 0 ) { //////09/08/14
GRF8: //////12/12/17
//            if ( 連続荷重数 = 1 $$ NN = 2 $$ (YY_max = wYs $$ YY_max = wYe) ) {
//                if ( LLL789 = 寸法(1) & Format((節点S + 節点E) * 10) ) {
//                    GoTo ABC
//                }
//            }
        if ( LLL789 = 寸法(1) & Format((節点S + 節点E) * 10) ) { GoTo ABC //////14/11/16
        if ( 連続荷重mark(1) = 6 $$ wXs = wXe $$ g柱本数 > 0 $$ RR橋脚 = 1 ) {
            if ( 節X(節点S) = g柱X座標(1, 1) ) {
                寸法線位置 = -10
            } else {if ( 節X(節点S) = g柱X座標(g柱本数, 1) ) {
            } else {
                if ( (Abs(寸法線位置) / 図X_SCALE) < 600 ) {
                寸法線位置 = -Round((600 * 図X_SCALE), 1)
                }
                if ( FLG柱軸重 = True ) {
                    寸法線位置 = 5.5
                    寸法補助線 = 6.5
                }
            }
        }
GRF9:
            if ( s側圧数 != 0 $$ 水平垂直 = 1 ) { //////13/04/30
//                    if ( (節X(節点S) = JX_max $$ 荷重図開き < 0) ) {
//                        if ( 寸法線位置 < 0 ) { //////14/09/17
//                            寸法線位置 = -2.5
//                            寸法補助線 = 6.01 - 1.5
//                        } else {
//                            寸法線位置 = 6
//                            寸法補助線 = 6.01
//                        }
//                        For( i = 1 To NN
//                            X(i) = PX0 + 500 + 150
//                        }
//                    } else {if ( (節X(節点S) = JX_min $$ 荷重図開き > 0) ) {
//                        if ( 寸法線位置 > 0 ) { //////14/09/17
//                            寸法線位置 = -1
//                            寸法補助線 = -6.01 + 2.5
//                        } else {
//                            寸法線位置 = -6
//                            寸法補助線 = -6.01
//                        }
//                        For( i = 1 To NN
//                            X(i) = PX0 - 550 + 150
//                        }
//                    } else {
//                        if ( 寸法線位置 < 0 ) {
//                            寸法線位置 = -5 //////14/11/17
//                        } else {
//                            寸法線位置 = 8
//                        }
//                    }
                if ( 荷重図開き < 0 ) { ////////(節X(節点S) = JX_min $$ 荷重図開き < 0) ) { ////////14/11/28
                    if ( FLG_横書き = 0 ) {
                        寸法線位置 = -9.5
                        寸法補助線 = -5
                        For( i = 1 To NN
                            X(i) = PX0 - 100
                        }
                    } else {
                        if ( アーチBOX $$ s側圧数 = 1 ) {
                        } else {
                        if ( 節X(節点S) = JX_min ) { //////And 節Y(節点E) != YY_min ) { //////14/12/02
                            寸法線位置 = -13
                            寸法補助線 = -5
                        } else {
//                                寸法線位置 = -8
//                                寸法補助線 = -5
                        }
                        For( i = 1 To NN
                            X(i) = PX0 - 700 //////17/02/24
                        }
                        }
                    }
                }
                if ( 荷重図開き > 0 ) {
                    if ( FLG_横書き = 0 ) {
                        寸法線位置 = 12
                        寸法補助線 = 5
                        For( i = 1 To NN
                            X(i) = PX0 + 150
                        }
                    } else {
                        if ( アーチBOX $$ s側圧数 = 1 ) {
                        } else {
                            if ( 節X(節点S) = JX_max ) { //////And 節Y(節点E) != YY_min ) { //////14/12/02
                                寸法線位置 = 17.5
                                寸法補助線 = 5
                            } else {
                                寸法線位置 = 8.5
                                寸法補助線 = 5 + IIf(FLG_側圧9 = 2, 2, 0)
                            }
                            if ( 連続荷重_P2(1) > 0 $$ FLG_側圧9 = 2 ) {
                                Ww1 = max(frmPrint.vsPrt1.TextWidth(strNum1), frmPrint.vsPrt1.TextWidth(strNum2)) / 2
                            } else {
                                Ww1 = IIf(連続荷重_P2(1) > 0, IIf(FLG_側圧9 = 2, -200, 0), IIf(FLG_側圧9 = 2, 200, 0))
                            }
                            For( i = 1 To NN
                                X(i) = PX0 + 600 + Ww1 - 450 //////17/02/24
                            }
                        }
                    }
                }
                if ( s側圧数 = 1 $$ wXs = wXe $$ N段数 = 1 $$ アーチBOX = False ) { //////15/01/08
                    if ( g柱X座標(g柱本数, 1) = wXs $$ 荷重図開き < 0 $$ FLG_横書き = 1 ) {
//                            s荷重位置 = HEN_X(wXs) - 400 - 30
                        if ( strNum2 = "" ) {
                            寸法線位置 = 寸法線位置 / 2
                            For( i = 1 To NN
                                X(i) = X(i) + 250
                            }
                        } else {
                            寸法線位置 = 寸法線位置 / 2 - IIf(連続荷重_P2(1) < 0 $$ FLG_側圧9 = 2, 2, 0)
//                                寸法補助線 = 寸法補助線 / 2
                        }
//                            寸法補助線 = -2
                    } else {if ( g柱X座標(1, 1) = wXs $$ 荷重図開き > 0 $$ FLG_横書き = 1 ) {
                        s荷重位置 = HEN_X(wXs) - 400 - 30 + 100
//                            寸法線位置 = 寸法線位置 / 2
                    } else {if ( g柱X座標(1, 1) != wXs $$ g柱X座標(g柱本数, 1) != wXs ) {
                        if ( 荷重図開き > 0 ) {
                            s荷重位置 = HEN_X(wXs) - 460
                            寸法線位置 = 4.5
                            寸法補助線 = -5
                        } else {
                            s荷重位置 = HEN_X(wXs) + 520 + 10
                            寸法線位置 = -5
                            寸法補助線 = 6
                        }
                        For( i = 1 To NN
                            X(i) = s荷重位置
                        }
                    }
                }
                if ( NN > 2 $$ FLG杭杭 $$ Mark111 = 2 ) {  //////////17/05/25
                    if ( 寸法線位置 < 0 ) {
                        For( i = 1 To NN
                            X(i) = PX0 - 0 //////17/02/24
                        }
                        寸法線位置 = 7.5
                        寸法補助線 = 3
                    } else {
                        For( i = 1 To NN
                            X(i) = PX0 - 0 //////17/02/24
                        }
                        寸法線位置 = -4.5
                        寸法補助線 = -3
                    }
                }
                this.SunPou2("<", NN, 寸法線位置, 寸法補助線, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, 1, 荷重図開き)
            } else {
                if ( s側圧数 = 0 $$ (水平部材最下端 = (wYs + wYe) / 2) $$ yiKozo = 1 $$ 水平垂直 = 0 _
                               $$ N段数 = 1 $$ (連続荷重mark(1) = 1 || 連続荷重mark(1) = 5 || 連続荷重mark(1) = 11) ) {
                    寸法線位置 = 10.01 //////13/08/11
                    寸法補助線 = 6.01
                    if ( 水平部材最下端 = YY_max ) {
                        YUT = 5 * Twip
                    } else {
                        YUT = -5 * Twip
                    }
                    For( i = 1 To NN
                        Y(i) = PY0 + (XL(i) * BSN - 0 * BCS) + YUT
                    }
                } else {if ( 連続荷重_P1(1) * 連続荷重_P2(1) < 0 $$ 水平垂直 = 0 ) { //////13/11/15
                    寸法線位置 = -20
                    寸法補助線 = -3.5
                } else {if ( GOUKEI = 444 ) {
                    寸法線位置 = -16
                } else {if ( NN > 2 $$ Abs(寸法線位置) <= 6 $$ FLG_999 = 1 ) { ////////14/09/17
                    if ( g荷重表記縦 = 1 ) { 寸法線位置 = 6.5 * Sgn(寸法線位置)
                }
                this.SunPou2("<", NN, 寸法線位置, 寸法補助線, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, 1, 荷重図開き)
            }
        } else {if ( f寸法FLG = -1 ) { ////////09/08/14
            this.SunPou2("<", NN, -7, -4, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, 1, 荷重図開き)
        } else {if ( f寸法FLG = 1 ) { //////09/08/14
            this.SunPou2("<", NN, 6, 4, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, 1, 荷重図開き)
        }
    }
Case } else {
End Select
//   //////////////////////////////////////////////08/07/06
ABC:

s荷重位置 = gKAJYUITI
if ( 水平垂直 = 1 ) {
    yyF6 = max(HEN_X(節X(節点S)), HEN_X(節X(節点E)))
} else {
    yyF6 = min(HEN_Y(節Y(節点S)), HEN_Y(節Y(節点E)))
}
yyF5 = Abs(yyF6 - g段上げ) / Twip
WW = frmPrint.vsPrt1.TextWidth("A") + 2

if ( 荷重図開き > 0 ) {
    yyF5 = Round(yyF5 + WW * 2 / Twip, 2)
} else {
    yyF5 = Round(yyF5 + WW * 3 / Twip, 2)
}
yyF5 = yyF5 + IIf(s寸法文字2段, 2.3, 0)

if ( Not (Mark111 = 6 || Mark111 = 7 || Mark111 = 8 || Mark111 = 9 || _
        Mark111 = 10 || Mark111 > 11 || g段上げ = -99999) ) { //////13/04/13
    if ( 連続荷重mark(1) = 5 ) {
        J5 = 9999
        J6 = 0
        For( i = 1 To MQM
            J4 = 上層Buzai(i)
            J5 = min(J5, 部材正荷重数(J4))
            J6 = max(J6, 部材正荷重数(J4))
        }
        if ( J6 < 5 ) { J6 = 5
        if ( J5 != J6 ) {
            For( i = 1 To MQM
                J4 = 上層Buzai(i)
                部材正荷重数(J4) = J6
            }
        }
    } else {

//            }
        if ( yBuzaiFF > 0 ) {
            For( i8 = 1 To yBuzaiFF
                i = yGGGGG(i8)
                if ( (荷重方向5 = "H" $$ Abs(SuiHeiAngX(Int((yGGGGG(1) + yGGGGG(yBuzaiFF)) / 2)) - SuiHeiAngX(i)) > 75) ) {
                    if ( 荷重図開き > 0 ) {
//                            部材正荷重数(i) = yyF5
                    } else {
//                            部材負荷重数(i) = yyF5
                    }
                } else {
                    if ( 荷重図開き > 0 ) {
                        部材正荷重数(i) = yyF5
                    } else {
                        部材負荷重数(i) = yyF5
                    }
                }
            }8
        } else {
            For( i = SS1 To SE2
//                    if ( (荷重方向5 = "H" $$ Abs(SuiHeiAngX(Int((yGGGGG(1) + yGGGGG(yBuzaiFF)) / 2)) - SuiHeiAngX(i)) > 75) ) {
//                    } else {
                if ( 荷重図開き > 0 ) {
                    部材正荷重数(i) = yyF5
                } else {
                    部材負荷重数(i) = yyF5
                }
//                    }
            }
        }

    }
} //////12/12/299
GRF777:
if ( FLG_横書き = 1 ) {
    前前DXY(FLG_側圧9) = DXY
}
                */
        }

        private void 前後XYXY(float XX0, float XX1, float PPP2, float DXY)
        {
            /*
var i As Integer, j As Integer
var XX2 As Single, XX3 As Single
XX1 = 0
PPP2 = 0
XX3 = 0
if ( 前RXY(0, 0) = 0 ) { return;
j = 1
XX1 = 前RXY(j, 1)
//    DXY = 前RXY(J, 2)
PPP2 = 前RXY(j, 3)
XX3 = 99999
For( i = 2 To 前RXY(0, 0)
    if ( Abs(XX0 - 前RXY(i, 1)) < XX3 ) {
        j = i
        XX3 = Abs(XX0 - 前RXY(i, 1))
    }
}
if ( j > 1 ) {
    XX1 = 前RXY(j, 1)
//        DXY = 前RXY(J, 2)
    PPP2 = 前RXY(j, 3)
    if ( Abs(DXY = 前RXY(j, 2)) > 200 ) {
        XX1 = 0
    }
}
*/
        }

        private void 部材連続寸法_9(object obj, int 連続荷重数, int 節点S, int 節点E,
                                    double 荷重図開き, string 荷重方向5, int[] 連続荷重mark, double[] 連続荷重_L1, double[] 連続荷重_L2, double[] 連続荷重_P1, double[] 連続荷重_P2,
                                    string dhosei, int SS1, int SE2, bool Mark_Flg, int CASU, int yBuzaiFF, int[] yGGGGG)
        {
            /*
            var 寸法補助線
            var BSPAN
            var BX0
            var BY0
            var BXE
            var BYE
            var 図BSPAN
            var 図倍率
            var BSN
            var BCS
            var BTAN
            var B角度
            var XX1
            var XX2
            var XX3
            var YY1
            var Yy2
            var YY3
            var PX0
            var PY0
            var PXE
            var PYE
            var PX1D
            var PY1D
            var PX2D
            var PY2D
            var PX3D
            var PY3D
            var 寸法(100) //////09/10/25
            double var X(100)
            double var Y(100)
            var i                       As Integer
            var j                       As Integer
            double var GGII
            double var GGjj
            var HIH                       As Integer
            var XL2
            var NN                      As Integer
            var HV                      As Integer
            var HV5                     As Integer
            var N55                     As Integer
            var XL(100)                 As Single
            var CNum As Integer
            var GHOSEI As Single
            var UUUU As Integer, PPPP As Single
            var Flg3 As Integer //////////////////////////////////////////////////07/07/26
            var AALL As Single ////////////08/07/02
            var J4 As Integer ////////08/07/08
            var J5 As Single ////////08/09/26
            var J6 As Single ////////08/09/26
            var P6 As Single ////////08/09/26
            var J7 As Single ////////08/09/26
            var P7 As Single ////////08/09/26
            var P8 As Single ////////////////////////////09/11/199
            var J8 As Single ////////08/09/26
            var J9 As Single, J10 As Single //////////////////08/10/095
            var yFR橋脚 As Integer
            var yiKozo As Integer
            var 寸法線位置 //////////////////////////////08/10/29
            var wXs As Single, wXe As Single, wYs As Single, wYe As Single //////09/09/300
            var f寸法FLG As Integer //////09/08/14
            var s寸法文字2段 As Boolean ////////////////09/10/20
            var s斜めFLG As Integer //////09/10/24
            var Max荷重 As Single //////09/10/299
            var MK5 As Integer //////09/11/09
            var m調整高 As Single //////10/11/11
            var FLG杭杭 As Boolean //////////////////////////////////11/12/166
            var FLGMORO As Boolean ////14/07/19
            var 鉛直文字列 As String //////////////09/11/16
            鉛直文字列 = "1"
            var FLG_AAA As Integer: FLG_AAA = 0
            FLGMORO = False
            //    yyHH1 = 0 //////////////////14/11/19
            //    yyHH2 = 0
            FLG杭杭 = False //////////////11/12/166
            if ( InStr(部材名(SS部材), "杭") != 0 ) {
                FLG杭杭 = True
            }
            if ( FLG杭杭 = False ) {
                if ( yBuzaiFF > 0 ) { ////////12/12/15
                    For( j = 1 To yBuzaiFF
                        i = yGGGGG(j)
                        if ( InStr(部材名(i), "杭") = 1 ) {
                            FLG杭杭 = True
                            Exit For
                        }
                    }
                } else {
                    For( i = SS1 To SE2
                        if ( InStr(部材名(i), "杭") = 1 ) {
                           FLG杭杭 = True
                           Exit For
                        }
                    }
                }
            }
            if ( FLG杭杭 = True $$ 連続荷重mark(1) = 6 ) { //////12/02/15
                s斜めFLG = 0
                For( i = 1 To 連続荷重数
                    if ( 連続荷重_L1(i) != 0 || 連続荷重_L2(i) != 0 ) {
                        s斜めFLG = 1
                        Exit For
                    }
                }
                if ( s斜めFLG = 0 ) {
                    GoTo ABC //////return;
                }
            }
            if ( Flg_PRESTRES(1) = 1 || Flg_PRESTRES(2) = 1 ) { //////12/02/15
                GoTo ABC //////return;
            }
            s斜めFLG = 0 //////09/10/24
            f寸法FLG = 0
            m調整高 = 0 //////////////10/11/11
            yFR橋脚 = FR橋脚
            yiKozo = iKozo
            //
            if ( Not (yiKozo = 3 $$ g連続Mod) ) {
                    yiKozo = 1 ////////10/01/24 12/12/15
            }
                    yFR橋脚 = 1
            //
            BSPAN = 部材Span(節点S, 節点E)
            ////////09/09/300
            var ii As Integer, i7 As Integer, i8 As Integer //////09/10/14
            wXs = 節X(節点S)
            wXe = 節X(節点E)
            wYs = 節Y(節点S)
            wYe = 節Y(節点E)
            var 荷重方向
            荷重方向 = 荷重方向5 ////////09/10/20
            if ( wYs = wYe $$ (荷重方向 = "V" || 荷重方向 = "M") $$ yBuzaiFF = 0 ) {
                荷重方向 = ""
            }
            if ( SS1 = SE2 $$ 荷重方向 = "H" $$ 連続荷重mark(1) = 2 ) { //////////09/10/24
                s斜めFLG = 2
            }
            if ( (Abs(SE2 - SS1) > 1 || yBuzaiFF > 0) $$ _
                                (荷重方向 = "V" || 荷重方向 = "M") ) { ////////09/09/301
                if ( 荷重方向 = "V" $$ 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) + 連続荷重_P2(1) < 0 ) {
                    PPPP = min(wYs, wYe)
                    if ( yBuzaiFF > 0 ) { //////////////////09/10/14
                        For( i8 = 1 To yBuzaiFF
                            i7 = yGGGGG(i8)
                            J4 = 部I(i7): PPPP = min(PPPP, 節Y(J4))
                            J4 = 部J(i7): PPPP = min(PPPP, 節Y(J4))
                        }8
                    } else {
                        For( i7 = SS1 To SE2
                            J4 = 部I(i7): PPPP = min(PPPP, 節Y(J4))
                            J4 = 部J(i7): PPPP = min(PPPP, 節Y(J4))
                        }7
                    }
                } else {
                    PPPP = max(wYs, wYe)
                    if ( yBuzaiFF > 0 ) { //////////////////09/10/14
                        For( i8 = 1 To yBuzaiFF
                            i7 = yGGGGG(i8)
                            J4 = 部I(i7): PPPP = max(PPPP, 節Y(J4))
                            J4 = 部J(i7): PPPP = max(PPPP, 節Y(J4))
                        }8
                    } else {
                        For( i7 = SS1 To SE2
                            J4 = 部I(i7): PPPP = max(PPPP, 節Y(J4))
                            J4 = 部J(i7): PPPP = max(PPPP, 節Y(J4))
                        }7
                    }
                }
                wYs = PPPP
                wYe = PPPP
            }
            BX0 = 図X(wXs)
            BY0 = 図Y(wYs)
            BXE = 図X(wXe)
            BYE = 図Y(wYe)
            ////////09/09/300
            水平垂直 = 9 //////////////////////////08/07/02
            if ( BX0 = BXE ) {
                水平垂直 = 1 // 垂直
                AALL = 図Y_SCALE
            }
            if ( BY0 = BYE ) {
                水平垂直 = 0 // 水平
                AALL = 図X_SCALE
            }
            if ( BX0 != BXE ) {
                if ( (Abs(BY0 - BYE) / Abs(BX0 - BXE)) < 0.05 ) { ////////10/10/13
                    水平垂直 = 0 // 水平
                    AALL = 図X_SCALE
                }
            }

            //    if ( 水平垂直 = 9 $$ 荷重方向 = "H" $$ Mark111 = 2 ) { //////09/08/23
            //    For( i = 1 To 連続荷重数
            //        連続荷重_P1(i) = 連続荷重_P1(i) * (-1)
            //        連続荷重_P2(i) = 連続荷重_P2(i) * (-1)
            //    }
            //    }
            if ( dhosei = "" || dhosei = 0 ) {
                GHOSEI = hosei
            } else {
                GHOSEI = dhosei
            }
            if ( g荷重連寸法補正 = 1 ) { //////////////////////////////07/01/17
                GHOSEI = GHOSEI + 3.5
                g荷重連寸法補正 = 0
            }
            if ( BX0 != BXE $$ (節Y0(節点S) + 節Y0(節点E)) / 2 > (YY_max * 0.8) ) { ////////////07/01/177
                g荷重連寸法回数 = g荷重連寸法回数 + 1 ////////////07/01/177
            }
            if ( (水平垂直 = 1 $$ yiKozo = 3 $$ 連続荷重数 = 1 $$ 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) != 連続荷重_P2(1)) ) {
                if ( s側圧数 = 0 ) { g荷重表記縦 = 1
            }
            ////////////////////////////07/11/03
            j = 0
            J4 = 0: J5 = 0: J6 = 0: J7 = 0: P6 = 0: J7 = 0
            J8 = 0: J9 = 0: J10 = 0
            P6 = 0: P7 = 0: P8 = 0
            MK5 = 0
            For( i = 1 To 連続荷重数
                if ( 連続荷重mark(i) = 1 ) {
                    j = j + 1
                    if ( Len(鉛直文字列) < Len(Format(連続荷重_P1(i), "0.00")) ) { 鉛直文字列 = Format(連続荷重_P1(i), "0.00")
                    if ( Len(鉛直文字列) < Len(Format(連続荷重_P2(i), "0.00")) ) { 鉛直文字列 = Format(連続荷重_P2(i), "0.00")
                }
                if ( 連続荷重mark(i) = 4 ) {
                  J4 = J4 + 1
                }
                if ( 連続荷重mark(i) = 5 || 連続荷重mark(i) = 11 ) {
                  MK5 = MK5 + 1
                }
                ////////////////////////////////////////////////////////////////////////////////////////////////////
                if ( (連続荷重_P1(i) >= 0 || 連続荷重_P2(i) >= 0) ) {
                    if ( 連続荷重mark(i) = 1 ) {
                        J5 = 1
                        P6 = max(P6, 連続荷重_P1(i))
                        P6 = max(P6, 連続荷重_P2(i))
                   }
                    if ( 連続荷重mark(i) = 2 $$ (連続荷重_P1(i) * 連続荷重_P2(i) != 0 $$ 連続荷重_P1(i) != 連続荷重_P2(i)) ) {
                        J6 = 1
                    }
                    if ( 連続荷重mark(i) = 2 $$ (連続荷重_P1(i) * 連続荷重_P2(i) = 0 || 連続荷重_P1(i) = 連続荷重_P2(i)) ) {
                        J7 = J7 + 1
                    }
                    if ( 連続荷重mark(i) = 2 $$ 連続荷重_P1(i) = 連続荷重_P2(i) ) {
                        J9 = J9 + 1
                    }
                    if ( 連続荷重mark(i) = 2 $$ 連続荷重_P1(i) * 連続荷重_P2(i) = 0 ) {
                        J10 = J10 + 1
                    }
                    if ( (連続荷重mark(i) = 4 $$ 連続荷重_P1(i) = 連続荷重_P2(i)) _
                        || (連続荷重mark(i) = 3 $$ 連続荷重_P1(i) * 連続荷重_P2(i) = 0) ) {
                        J8 = J8 + 1
                    }
                    if ( 連続荷重mark(i) = 2 || 連続荷重mark(i) = 4 || 連続荷重mark(i) = 3 ) {
                        P6 = max(P6, Abs(連続荷重_P1(i)))
                        P6 = max(P6, Abs(連続荷重_P2(i)))
                    }
                }
                if ( g荷重表記縦 = 0 || (g荷重表記縦 = 1 $$ 連続荷重_P1(i) != 連続荷重_P2(i)) || 連続荷重mark(i) = 1 ) {
                    P7 = max(P7, Abs(連続荷重_P1(i)))
                    P7 = max(P7, Abs(連続荷重_P2(i)))
                }
            }
            //
            var Mark111 As Integer
            //
            if ( J5 = 1 ) { ////////////////////////////////09/11/13
                g荷重表記高 = 0
                Mark111 = 1
            } else {
                if ( g荷重表記縦 = 1 ) {
                    For( i = 1 To 連続荷重数 //////09/11/199
                        if ( (連続荷重mark(i) = 2 || 連続荷重mark(i) = 4) $$ _
                            (連続荷重_P1(i) * 連続荷重_P2(i) = 0 || 連続荷重_P1(i) != 連続荷重_P2(i)) ) {
                            P8 = max(P8, Abs(連続荷重_P1(i))) //////09/11/30
                            P8 = max(P8, Abs(連続荷重_P2(i)))
                        }
                    }
                    if ( P8 != 0 ) {
                        P7 = P8
                    }
                    if ( g荷重表記高 < g荷重表記高5 / 1.5 ) {
                        g荷重表記高 = g荷重表記高5 / 1.5
                    } //////09/11/199
                } else {
                    if ( 水平垂直 = 0 $$ g荷重表記高5 > 180 $$ 連続荷重数 <= 2 ) { //////10/01/03
                        g荷重表記高 = 180
                    } else {
                        g荷重表記高 = g荷重表記高5
                    }
                }
                if ( (MK5 != 0 $$ MK5 = 連続荷重数) ) {
                    Mark111 = 5
                } else {
                    Mark111 = 連続荷重mark(1)
                }
            }
            //////////////////////////////////////////////////////////////
            if ( Mark111 = 6 ) { //////////////////////12/02/15
                if ( 連続荷重数 = 1 ) {
                    if ( 連続荷重_L1(1) = 0 $$ 連続荷重_L2(1) = 0 ) {
                        GoTo ABC //////return;
                    }
                    if ( InStr(部材名(SS部材), "柱") != 0 ) { //////////////////12/02/15
                        if ( 節X(節点S) != g柱X座標(g柱本数, 1) ) {
                            GoTo ABC //////return;
                        }
                    }
                } else {if ( InStr(部材名(SS部材), "杭") != 0 ) { //////////////////12/02/15
                    荷重図開き = Abs(荷重図開き) //////136
                    KUIDAN = 0
                }
            }
            Max荷重 = BU荷重MAX //////////////////////////////////////09/10/299
            if ( J5 = 1 || Mark111 = 5 ) { //////08/09/26//////09/11/09
                J6 = 0
                J7 = 0
                J8 = 0
                J9 = 0 //////08/10/09
                J5 = IIf(yFR橋脚 = 1, -0.7, 1)
                GHOSEI = 0
                Max荷重 = BP荷重MAX ////////////////09/10/299
                if ( Max荷重 = 0 ) { Max荷重 = P7 ////////////09/11/30
            } else {
                if ( J10 = 連続荷重数 ) {
                    J6 = 1 //////08/10/095
                    J7 = 0 //////08/10/096
                }
                if ( J6 = 1 ) {
                    if ( (P6 / Max荷重) < 0.7 ) {
                        if ( J10 = 連続荷重数 ) { //////08/10/096
                            J6 = 0
                        } else {
            //                    J6 = min(1 / (P6 / Max荷重), 3) //////////09/04/06
                            J6 = 0.3 //////////09/04/06
                        }
                    } else {if ( (P6 / Max荷重) > 0.9 ) {
                        if ( yFR橋脚 = 1 ) {
                            if ( 部材正荷重数(SS1) < 20 ) {
                                J6 = -1.5
                            } else {
                                J6 = -2.2
                            }
                        } else {
                            J6 = 2.5
                        }
                    } else {
                        J6 = -0.5
                    }
                    if ( yiKozo = 3 || g連続Mod ) {
                        J6 = -1.5
                    }
                }
            }
            if ( J7 = 連続荷重数 ) { J7 = 1 } else { J7 = 0
            if ( J9 = 連続荷重数 ) { J9 = 1 } else { J9 = 0 //////08/10/09
            if ( J8 = 連続荷重数 ) {
                if ( ((P6 / Max荷重) ^ 0.7) < 0.6 ) { //////08/10/09
                    J8 = 1.5
                } else {if ( (P6 / Max荷重) > 0.95 ) {
                    J8 = 1.3
                } else {
                    J8 = Round((Max荷重 / P6) ^ 0.5, 1) //////1//////08/10/29
                }
            } else {
                J8 = 0
            }
            //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////08/09/26
            if ( 水平部材最上端 = 水平部材最下端 $$ 連続荷重数 = 1 $$ 連続荷重_P1(1) * 連続荷重_P2(1) < 0 ) {
                FLGMORO = True
            }
            //    if ( (Mark111 = 1 || Mark111 = 11) ) {
            if ( j != 0 ) {
                if ( FLG記号 = 1 ) { ////////////////07/05/13
                    GHOSEI = GHOSEI + IIf(j = 連続荷重数, 0.5, 1) //////+ 3
                }
            } else {
                if ( g連続Mod ) {
                    j = 2 ////////////////////06/12/14
                    GHOSEI = max(GHOSEI, 0) ////////////////////連続梁 05/02/06
                        For( i = 1 To 連続荷重数
                              if ( (連続荷重mark(i) = 2 || 連続荷重mark(i) = 3 || 連続荷重mark(i) = 4) $$ _
                                 (連続荷重_P1(i) != 連続荷重_P2(i)) $$ ((連続荷重_L2(i) - 連続荷重_L1(i)) * AALL * Twip) < 0.5 ) {
                                    j = 0
                                    Exit For
                              }
                        }
                        if ( FLG記号 = 1 ) { ////////////////07/05/13
                            if ( j = 0 ) {
                                GHOSEI = GHOSEI + 5.5
                            }
                        }
                } else {
                    if ( yFR橋脚 = 2 ) {
                        GHOSEI = max(GHOSEI, 0) ////////////////////////////// 05/09/20
                    } else {
                        j = 2 ////////////////////06/12/14
                        For( i = 1 To 連続荷重数
                              if ( 連続荷重mark(i) != 2 ) { j = 0
                        }
                    if ( j = 2 ) { // if ( 連続荷重mark(1) = 2 ) {
                        UUUU = 0: PPPP = 0 ////////////////////06/12/14
                        For( i = 1 To 連続荷重数
                              if ( (連続荷重_P1(i) != 連続荷重_P2(i)) ) { UUUU = 1
                              PPPP = max(PPPP, Abs(連続荷重_P1(i)))
                              PPPP = max(PPPP, Abs(連続荷重_P2(i)))
                        }
                            if ( (Mark111 = 2 $$ GHOSEI < -2) || (Mark111 = 3 $$ GHOSEI > -2) ) {
                                if ( (Mark111 = 2 $$ GHOSEI < -2) ) {
                                    GHOSEI = 2.5
                                } else {
                                    GHOSEI = -荷重寸法線位置(1) * (1 - (PPPP / Max荷重) ^ 0.25)
                                }
                            } else {
                                GHOSEI = GHOSEI / 2.5
                            }
                            if ( UUUU = 0 ) { ////////////////////////////////////////////////////////////06/12/14
                                if ( ((PPPP / Max荷重) ^ 0.5) > 0.8 ) {
                                    GHOSEI = max(GHOSEI, 2.5)
                                } else {
                                    GHOSEI = max(GHOSEI, 1)
                                }
                            } else {
                                GHOSEI = GHOSEI + IIf(((PPPP / Max荷重) ^ 0.5) > 0.8, 1.5, 0)
                                GHOSEI = GHOSEI + ((PPPP / Max荷重) ^ 0.6) * 1.3 ////////////////06/12/14
                                if ( GHOSEI < hosei ) {
                                    GHOSEI = max(hosei, 9)
                                }
                            }
                            if ( GHOSEI < -5 ) { ////////////06/09/06
                                GHOSEI = -5
                                if ( FLG記号 = 1 ) { ////////////// ////////08/06/17
                                    GHOSEI = GHOSEI + 5.5
                                }
                            } else {if ( GHOSEI > -0.8 $$ Mark111 = 3 ) { ////////////06/09/06
                                GHOSEI = -1
                                if ( FLG記号 = 1 ) { ////////////// ////////08/06/17
                                    GHOSEI = GHOSEI + 5.5
                                }
                            }
                            if ( BX0 = BXE ) { //////////////08/06/17
                                GHOSEI = GHOSEI + 4
                            }
                        } else { ////// 05/09/20
                            GHOSEI = 0
                        }
            //                }
                    }
                }
            }
            ////////////////////////////////////////////////////////////////////////// 05/02/05
            CNum = 0
            if ( yiKozo = 1 ) {
            i = 節点S
            Do
                        GGII = i
                        GGjj = (i + 1)
                        if ( GGII * GGjj = 0 || GGII > 1000 ) { Exit Do ////////05/04/26
                        j = 0
                        HIH = 0
                        Do
                            j = j + 1
                            if ( j > 部材_max ) { Exit Do
                            if ( GGII = 部I(j) $$ GGjj = 部J(j) ) {
                                HIH = j
                                Exit Do
                            }
                        Loop
                        if ( HIH > 0 ) {
                            if ( ZFAngle(HIH) = 0 $$ 部材正荷重数(HIH) > 20 ) {
                                CNum = 1
                                Exit Do
                            }
                        }
                i = i + 1
                if ( i = 節点E ) { Exit Do
             Loop
                if ( CNum = 0 $$ g連続Mod ) {
                GHOSEI = max(GHOSEI, 8) ////////////////////連続梁 05/02/06
                }
            }    //
            Select Case 荷重方向
            Case "V", "M", "S"
                BSPAN = Round(Abs(節X0(節点S) - 節X0(節点E)), 3)
                BY0 = max(BY0, BYE)
                BYE = BY0
            Case "H"
                BSPAN = Round(Abs(節Y0(節点S) - 節Y0(節点E)), 3)
                if ( (節X0(節点S) + 節X0(節点E)) / 2 < (JX_max + JX_min) / 2 ) { ////////////07/01/08
                    if ( s斜めFLG = 0 ) {
                    BX0 = min(BX0, BXE)
                    } else {
                    BX0 = min(BX0, BXE)
                    }
                } else {
                    if ( s斜めFLG = 0 ) {
                    BX0 = max(BX0, BXE)
                    } else {
                    BX0 = max(BX0, BXE)
                    }
                }
                BXE = BX0
            Case } else {
            End Select
            図BSPAN = Sqr((BXE - BX0) ^ 2 + (BYE - BY0) ^ 2)
            if ( 図BSPAN <= 0 ) {
                図BSPAN = 1
            }
            if ( BSPAN <= 0 ) {
                BSPAN = 1
            }
            図倍率 = 図BSPAN / BSPAN
            BSN = (BYE - BY0) / 図BSPAN
            BCS = (BXE - BX0) / 図BSPAN
            if ( 荷重方向 = "V" ) { //////And 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) + 連続荷重_P2(1) > 0 ) { //////10/03/07
            //        BCS = Abs(BCS)
            }
            BTAN = 0
            if ( BX0 != BXE ) {
                BTAN = (BYE - BY0) / (BXE - BX0)
            }
            B角度 = 180 * Atn(BTAN) / π
            if ( BX0 > BXE ) {
                B角度 = B角度 + 180
            }
            if ( BX0 = BXE ) {
                B角度 = 90
            }
            if ( BYE < BY0 ) {
                B角度 = 270
            }
            //
            Flg3 = 0
            Select Case 荷重方向 ////////////////////07/01/08
            Case "V", "M", "S"
                    PX0 = HEN_X(wXs) - 荷重図開き * BSN
                    PY0 = min(HEN_Y(wYs), HEN_Y(wYe)) - 荷重図開き * Abs(BCS) ////////////07/01/09
            Case "H"
                if ( (節X0(節点S) + 節X0(節点E)) / 2 < (JX_max + JX_min) / 2 ) { ////////////07/01/08
                    if ( 連続荷重_P1(1) + 連続荷重_P2(1) > 0 $$ s斜めFLG = 0 ) { ////////09/10/24
                        PX0 = min(HEN_X(wXs), HEN_X(wXe)) - 荷重図開き * BSN * 1 ////////09/10/24
                    } else {
                        if ( s斜めFLG = 0 ) {
                            PX0 = min(HEN_X(wXs), HEN_X(wXe)) - 荷重図開き * BSN * 13 ////////09/08/24
                        } else {
                            PX0 = min(HEN_X(wXs), HEN_X(wXe)) - Abs(荷重図開き * BSN) * 10 ////////09/08/24
                            Flg3 = 1
                        }
                    }
                    PY0 = HEN_Y(wYs) - 荷重図開き * BCS
                } else {
                    if ( 連続荷重_P1(1) + 連続荷重_P2(1) > 0 $$ s斜めFLG = 0 ) { ////////09/10/24
                    PX0 = min(HEN_X(wXs), HEN_X(wXe)) // + 荷重図開き * BSN * 0.3
                    } else {
                        PX0 = max(HEN_X(wXs), HEN_X(wXe)) - 荷重図開き * BSN * IIf(s斜めFLG = 0, 0, 10) ////////09/10/24
                        if ( s斜めFLG != 0 ) {
                            Flg3 = 1 ////////////07/07/26//////////////////////////////09/10/24 コメントにした
                        }
                    }
                    PY0 = HEN_Y(wYs) - 荷重図開き * BCS
                }
            Case } else {
                PX0 = HEN_X(wXs) - 荷重図開き * BSN
                if ( yiKozo = 1 $$ 水平垂直 = 0 $$ N段数 = 1 $$ 連続荷重数 = 1 $$ _
                   Abs(YY_max - wYs) > (YY_max - YY_min) / 5 ) { //////////////////////////////////07/06/177
                    PY0 = HEN_Y(wYs) + 荷重図開き * BCS
                } else {
                    if ( 連続荷重数 = 1 $$ Mark111 = 11 $$ _
                                Abs(YY_max - wYs) <= (YY_max - YY_min) / 10 ) { //////08/06/16
                        PY0 = HEN_Y(wYs) + 荷重図開き * BCS
                    } else {
                        PY0 = HEN_Y(wYs) - 荷重図開き * BCS
                    }
                }
            End Select
            //
            //////////////////////////////////////////06/01/29
            UUUU = 0: PPPP = 0
            For( i = 1 To 連続荷重数
                if ( 連続荷重mark(i) = 2 $$ 連続荷重_P1(i) = 連続荷重_P2(i) ) {
                    PPPP = max(PPPP, Abs(連続荷重_P1(i)))
                } else {
                    UUUU = 1
                }
            }
            //////////////////////////////////////////06/01/29
            XL(1) = 0
            NN = 1
            集中有無 = 0
            HV = 0
            HV5 = 0
            N55 = 1
            j = 0
            //
            var SNUM As Integer
            SNUM = max(連続荷重数, s側圧数)
            var Total As Integer //////13/04/20
            var Num文字列数 As Integer
            var kPoint() As Integer
            this.kPoint((SNUM + 1) * 4, 2)
            var strKAJYU() As String
            this.strKAJYU(SNUM + 1, 2) //////13/04/20
            var FG_Num As Integer
            var FLG_888 As Integer: FLG_888 = 0
            Total = 0
            Num文字列数 = 0
            FG_Num = 0
            For( i = 1 To SNUM ////////14/11/17
                if ( 連続荷重数 < s側圧数 ) {
                    連続荷重mark(i) = 連続荷重mark(連続荷重数)
                    連続荷重_P1(i) = 連続荷重_P1(連続荷重数)
                    連続荷重_P2(i) = 連続荷重_P2(連続荷重数)
                }
                if ( 連続荷重_L1(i) - XL(NN) > 0.001 ) {
                    NN = NN + 1
                    XL(NN) = 連続荷重_L1(i)
                }
                if ( s斜めFLG = 2 ) { ////////09/10/24
                    連続荷重_P1(i) = Abs(連続荷重_P1(i))
                    連続荷重_P2(i + SNUM) = Abs(連続荷重_P2(i))
                }
                Select Case 連続荷重mark(i)
                Case 1, 5, 11
                        if ( Not (連続荷重_P2(i) = 0 $$ 連続荷重_L2(i) = 0) ) { ////////if ( 連続荷重_P2(I) != 0  07/06/11
                            if ( 連続荷重_L2(i) != XL(NN) ) {
                                XL2 = Round(連続荷重_L2(i), 3)
                                NN = NN + 1
                                XL(NN) = XL2
                            }
                        }
                        if ( 連続荷重mark(i) != 5 ) {
                            集中有無 = 1
                        }
                Case 2, 4, 6, 7
                        if ( s側圧数 = 0 ) {
                            if ( 連続荷重mark(i) = 2 $$ (水平垂直 = 0 || 荷重方向 = "V" || 荷重方向 = "M") ) { //////13/04/20
            //                        if ( Not (連続荷重_P1(i) + 連続荷重_P2(i) = 0) ) {
                                    Total = Total + 1
                                    strKAJYU(i, 1) = IIf(連続荷重_P1(i) = 0, "", F2(連続荷重_P1(i)))
                                    strKAJYU(i, 2) = IIf(連続荷重_P2(i) = 0, "", F2(連続荷重_P2(i)))
                                    kPoint(i, 1) = NN
                                    kPoint(i, 2) = NN + 1
                                    Num文字列数 = max(Num文字列数, Len(strKAJYU(i, 1)))
                                    Num文字列数 = max(Num文字列数, Len(strKAJYU(i, 2)))
            //                        }
                            }
                        } else {if ( s側圧数 > 0 ) {
                            if ( 連続荷重mark(i) = 2 $$ (水平垂直 = 1 || 荷重方向 = "H") ) { //////13/04/22
                                    Total = Total + 1
                                    strKAJYU(i, 1) = IIf(連続荷重_P1(i) = 0, "", F2(Abs(連続荷重_P1(i))))
                                    strKAJYU(i, 2) = IIf(連続荷重_P2(i) = 0, "", F2(Abs(連続荷重_P2(i))))
                                    kPoint(i, 1) = NN
                                    kPoint(i, 2) = NN + 1
                                    Num文字列数 = max(Num文字列数, Len(strKAJYU(i, 1)))
                                    Num文字列数 = max(Num文字列数, Len(strKAJYU(i, 2)))
                            }
                        }
                        if ( 連続荷重_L2(i) != 0 ) {
                            XL2 = Round(BSPAN - 連続荷重_L2(i), 3)
                            NN = NN + 1
                            XL(NN) = XL2
                        }
                        if ( (BSPAN - 連続荷重_L1(i) - 連続荷重_L2(i)) < 3 ) { //////15/04/06
                        if ( 連続荷重_P1(i) != 連続荷重_P2(i) $$ 連続荷重_P1(i) != 0 $$ 連続荷重_P2(i) != 0 ) {
                                if ( (連続荷重_L1(i) = 0 $$ wXs = JX_min) ) {
                                    FLG_888 = 1
                                } else {if ( (連続荷重_L2(i) = 0 $$ wXe = JX_max) ) {
                                    FLG_888 = 2
                                }
                            HV = 1
                            HV5 = 1
                        }
                        }
                Case 3
                        XL2 = Round(連続荷重_L1(i) + (BSPAN - 連続荷重_L1(i) - 連続荷重_L2(i)) / 2, 3)
                        NN = NN + 1
                        XL(NN) = XL2
                        if ( 連続荷重_L2(i) != 0 ) {
                            XL2 = Round(BSPAN - 連続荷重_L2(i), 3)
                            NN = NN + 1
                            XL(NN) = XL2
                        }
            //                if ( 水平垂直 != 1 ) {
            //                    Total = Total + 1
            //                    strKAJYU(i, 1) = F2(連続荷重_P1(i) + 連続荷重_P2(i)) & strUN & "/m"
            //                    if ( 連続荷重_P2(i) != 0 ) {
            //                    strKAJYU(i, 2) = F2(連続荷重_P2(i)) & strUN & "/m"
            //                    }
            //                    kPoint(i, 1) = NN
            //                    kPoint(i, 2) = NN + 1
            //                }
                Case } else {
                        if ( 連続荷重_L2(i) != 0 ) {
                            XL2 = Round(BSPAN - 連続荷重_L2(i), 3)
                            NN = NN + 1
                            XL(NN) = XL2
                        }
                End Select
            }

            if ( 連続荷重数 = 1 $$ 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) + 連続荷重_P2(1) = 0 $$ _
                                                          連続荷重_L1(1) + 連続荷重_L2(1) = 0 ) {
                NN = NN + 1
                XL(NN) = BSPAN / 2 ////////12/11/27 逆対称の分布荷重

            } else {if ( XL2 != BSPAN ) { //////12/12/15
                if ( XL(NN) < BSPAN ) {
                    if ( yiKozo = 3 $$ 連続荷重数 = 1 $$ NN = 1 $$ 連続荷重mark(1) = 2 $$ wYs = wYe $$ _
                        Not (Abs(YY_max - wYs) < 1 || _
                        (Abs(水平部材最下端 - wYs) < 1 $$ 連続荷重_P1(1) + 連続荷重_P2(1) > 0)) ) { //////13/06/07
                        NN = NN
                    } else {
                        NN = NN + 1
                        XL(NN) = BSPAN //////12/12/15
                    }
                }
            }
                    //////////////////////////////08/07/06
            if ( yiKozo = 1 $$ 連続荷重数 = 1 $$ NN <= 2 $$ 連続荷重mark(1) = 2 $$ wYs = wYe $$ _
                        (Abs((YY_max + YY_min) / 2 - wYs) < 1 || _
                        (Abs(水平部材最下端 - wYs) < 1 $$ 連続荷重_P1(1) + 連続荷重_P2(1) > 0)) ) {
                if ( 連続荷重_P1(1) = 連続荷重_P2(1) $$ Abs(水平部材最上端 - wYs) > 0.2 ) { //////16/10/17
                    GoTo GRF666 ////////////13/04/08
                }
            }

            N55 = 1
            j = 0
            For( i = 1 To 連続荷重数
                if ( 連続荷重_L1(i) - XL(N55) > 0.001 ) {
                    N55 = N55 + 1
                }
                Select Case 連続荷重mark(i)
                Case 1, 5, 11
                    if ( Not (連続荷重_P2(i) = 0 $$ 連続荷重_L2(i) = 0) ) {
                        N55 = N55 + 1
                    }
                    if ( 連続荷重mark(i) != 5 ) {
                        j = 1
                    }
                Case 2, 6, 7
                    if ( 連続荷重_L2(i) != 0 ) {
                        N55 = N55 + 1
                    }
                    if ( i = 連続荷重数 ) {
                        AALL = (XL(N55) - XL(N55 - 1))
                    } else {
                        AALL = (XL(N55 + 1) - XL(N55))
                    }
                    if ( 連続荷重mark(i) = 2 $$ (連続荷重_P1(i) != 連続荷重_P2(i)) ) {
                        if ( (yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) ) {
                        }
                    }
                Case 3
                    N55 = N55 + 1
                    if ( 連続荷重_L2(i) != 0 ) {
                        N55 = N55 + 1
                    }
                    if ( (max(Abs(連続荷重_P1(i)), Abs(連続荷重_P2(i))) / Max荷重) < 0.2 ) {
                        j = 3
                    }
                Case 4
                    N55 = N55 + 1
                    if ( (max(Abs(連続荷重_P1(i)), Abs(連続荷重_P2(i))) / Max荷重) < 0.2 ) {
                        j = 4
                    }
                Case } else {
                    if ( 連続荷重_L2(i) != 0 ) {
                        N55 = N55 + 1
                    }
                End Select
            }
            if ( 集中有無 != 1 $$ J7 = 0 ) {
                GHOSEI = 1.5 + 1
                if ( j = 2 ) {
                    GHOSEI = 9.5 * (P6 / Max荷重)
                }
            }
            //////////////////////////////08/07/06
            var gY55 As Single, GOUKEI As Single, J55 As Single, J88 As Single
            GOUKEI = 0

            if ( (Mark111 = 2 || Mark111 = 3 || Mark111 = 4) ) {
                if ( ((P7 / Max荷重) ^ 1.2) < 0.3 ) {
                    P7 = Round(0.35 * Max荷重, 1)
                    P6 = P7 //////09/11/13
                    if ( ((P7 / Max荷重) ^ 1.2) < 0.2 ) {
                        P7 = Round(0.2 * Max荷重, 1)
                        P6 = P7 //////09/11/13
                    } else {if ( ((P7 / Max荷重) ^ 1.2) < 0.15 ) {
                        P7 = Round(0.12 * Max荷重, 1)
                        P6 = P7 //////09/11/13
                    }
                    GHOSEI = 0
                    hosei = 0
                } else {if ( (P7 / Max荷重) > 0.8 ) {
                    P7 = Max荷重
            //            gHosei = 0
            //            hosei = 0
                    J6 = -0.5
                }

            }
            gY55 = 0
            if ( FLG_列車_衝撃 ) {
                if ( N段数 = 1 ) {
                    gY55 = -51
                } else {
                    gY55 = -120
                }
                if ( 荷重方向 = "M" ) { //////12/12/17
                    gY55 = -80
                }
            } else {if ( J5 = 0 $$ J10 = 連続荷重数 ) {
                gY55 = 150 * (P7 / Max荷重)
                if ( P7 < 100 $$ Not (yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) ) {
                gY55 = gY55 - 100
                }
            } else {if ( J5 = 0 $$ J7 = 1 $$ J9 = 1 ) {
                if ( (P7 / Max荷重) > 0.6 ) {
                    J7 = 1
                    if ( (P7 / Max荷重) > 0.9 ) { J7 = 0
                } else {
                    J6 = 1
                }
            }
            if ( J5 != 0 ) {
                J55 = J5
                if ( SS1 = SE2 ) {
                    if ( N段数 > 1 ) {
                        if ( (P7 / BP荷重MAX) > 0.9 ) {
                            if ( P7 >= 100 ) {
                                J55 = 1
                            } else {if ( P7 < 33 ) {
                                J55 = 0.5
                            }
                        } else {
                            J55 = 1.5
                        }
                    } else {
                        if ( P7 >= 100 ) { J55 = 1
                    }
                } else {
                    if ( Len(鉛直文字列) >= 9 ) {
                        if ( P7 >= 100000 ) {
                            J55 = 0.1
                            GHOSEI = GHOSEI - 2
                        } else {
                            J55 = 1.2
                        }
                    } else {if ( Len(鉛直文字列) = 8 ) {
                        if ( P7 >= 10000 ) {
                            J55 = 0.1
                            GHOSEI = GHOSEI - 2
                        } else {
                            J55 = 1.2
                        }
                    } else {if ( Len(鉛直文字列) = 7 ) {
                        if ( P7 >= 1000 ) {
                            J55 = 0.4
                        } else {
                            J55 = 1.3
                        }
                    } else {if ( Len(鉛直文字列) = 6 ) {
                        if ( P7 >= 100 ) {
                            if ( N段数 = 1 ) {
                                J55 = 0.1
                            } else {
                                if ( (P7 / Max荷重) > 0.99 ) {
                                    J55 = 0.5
                                } else {
                                    J55 = -0.3
                                }
                            }
                        } else {
                            J55 = 0.7
                        }
                    } else {if ( Len(鉛直文字列) >= 5 ) {
                        J55 = 0
                    }
                }
                if ( (GHOSEI = 0.5 || GHOSEI = 2.5) $$ Abs(YY_max - wYs) > (YY_max - YY_min) / 5 ) { ////////08/11/27
                    J55 = J5
                }
                GOUKEI = (J7 * 60 + J88 * 160 - J55 * 120 - J6 * 80 + GHOSEI * 20) // - gY55
                if ( Mark111 = 1 $$ GOUKEI < 200 ) { ////////14/08/28
                    GOUKEI = 200
                    if ( 連続荷重mark(1) = 2 ) {
                    GOUKEI = 444
                    }
                }
                if ( Mark111 = 5 ) { ////////09/11/17
                    GOUKEI = 50
                }
                GoTo YNEXT
            }
            if ( g荷重表記縦 = 0 $$ g荷重表記高 != 0 ) { ////////08/10/29
                if ( Mark111 = 4 $$ g荷重表記縦 = 0 ) { //////09/11/202
                    g荷重表記高 = 220
                    GOUKEI = 150
                } else {
                    if ( g荷重表記高 < 100 ) { // g荷重表記高 = 100
            //            GOUKEI = 260 - 100 - gY55 + 60  //////06/10/29
                            GOUKEI = 260 / 2 - g荷重表記高 - gY55 + 60 //////////////09/03/10
                    } else {
                        GOUKEI = 260 - g荷重表記高 - gY55 + 60
                        if ( (P7 / Max荷重) > 0.9 ) { //////09/11/12
                            if ( g荷重表記高 < 260 ) {
                                if ( g荷重表記高 = 180 $$ gY55 = 0 $$ N段数 = 1 ) { ////////10/01/03
                                    GOUKEI = 260 ////////10/02/03//////720 ////////10/01/03
                                } else {
                                    GOUKEI = 260 ////////10/01/03
                                }
                            } else {
            //                        GOUKEI = g荷重表記高 ////////260 ////////10/01/03
                            }
                        } else {
                            if ( g荷重表記高 > 140 $$ GOUKEI < 220 ) { ////////09//11/199
                                GOUKEI = 220
                            } else {
                                GOUKEI = 280 + GOUKEI
                                if ( ((P7 / Max荷重) ^ 1.3) < 0.3 ) { //////09/11/13
                                    GOUKEI = 0 //////200 //////13/006/21  元 2
                                }
                            }
                        }
                    }
                }
            } else {
                if ( g荷重表記縦 = 0 $$ (P7 / Max荷重) < 0.3 $$ N段数 != 1 $$ gY55 = 0 ) {  //////08/10/29
                    if ( (J7 = 1 $$ J9 = 1) $$ J8 = 0 ) {
                        if ( (P7 / Max荷重) < 0.2 ) {
                            GOUKEI = -20
                        } else {
                            GOUKEI = 0
                        }
                    } else {if ( J7 = 1 $$ J8 = 0 ) {
                        GOUKEI = 120 * (1 - (P7 / Max荷重) ^ 1.5)
                    } else {
                        GOUKEI = 300 * (1 - (P7 / Max荷重) ^ 0.7)
                    }
                } else {
                    J55 = J5
                    J88 = J8
                    if ( J5 + J6 + J7 + J8 + gY55 = 0 ) {
                        if ( (P7 / Max荷重) < 0.6 ) {
                            J88 = Round((P7 / Max荷重), 1)
                            if ( (P7 / Max荷重) < 0.1 ) {
                                J88 = 1.5
                            }
                        }
                            if ( Mark111 = 4 $$ g荷重表記縦 = 1 $$ hosei > 0 ) {
                                J55 = 1.5 //+ (g荷重表記高 / 300)
                            }
                    } else {if ( g荷重表記縦 = 1 || (P7 / Max荷重) > 0.85 ) {
                        if ( (yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) ) {
                            if ( (P7 / Max荷重) < 0.5 $$ P7 >= 10 ) {
                            J55 = Round(5 * (P7 / Max荷重) ^ 0.5, 1)
                            } else {
                            J55 = Round(3 * (P7 / Max荷重) ^ 0.5, 1) ////////09/11/199
                            if ( 下床文字表示 = 0 $$ 連続荷重_P1(1) * 連続荷重_P2(1) < 0 $$ g荷重表記高 > 260 ) {
            //                        J55 = J55 - Round(g荷重表記高 / 20, 1) //////09/12/04
                            }
                            }
            //                    J6 = 0 //-0.5
                            if ( J6 = 0 ) {
                                J6 = -0.5
                                J7 = 0
                            } else {if ( J6 > 0 ) { //////08/11/05
                                J6 = 2
                            } else {
                                if ( (P7 / Max荷重) > 0.95 ) { ////////////////////08/11/09////08/12/06
                                    J6 = J6 + 2.5 ////////08/11/09
                                } else {
                                    J6 = J6 + 2 ////////08/11/13
                                }
                            }
                        } else {
            //                    J55 = Round(2 * (P7 / Max荷重), 1)
                            J55 = Round(5.5 * (P7 / Max荷重) ^ 0.5, 1) ////////////08/12/07 //////09/04/06
                            if ( g荷重表記縦 = 1 $$ J55 < 4 ) { ////////09/11/11
                                J55 = J55 + 1.5
                            }
                            if ( (P7 / Max荷重) > 0.9 ) { //////09/04/06
                                if ( J6 < 0 ) { J6 = J6 / 2
                            } else {
                                if ( J6 < 0 ) { J6 = 2.5 ////////////J6 = 0//////////////////08/11/17
                                if ( (P7 / Max荷重) < 0.2 ) { J55 = J55 + 0.8 //////09/04/06
                            }
                            J7 = 0
                        }
                    } else {if ( (P7 / Max荷重) > 0.8 ) {
                        J6 = J6 + 2
                    } else {if ( (P7 / Max荷重) < 0.15 $$ J8 = 0 ) {
                        if ( J6 = 1 ) {
                            J6 = 0
                            J88 = 1.8
                        } else {
                            J7 = 2
                        }
                    }
                    GOUKEI = (J7 * 60 + J88 * 160 - J55 * 120 - J6 * 80 - gY55)
                    if ( g荷重表記縦 = 1 $$ g荷重表記高 < 120 $$ GOUKEI < -560 ) { ////09/12/25////09/11/199
                        GOUKEI = -560 ////////09/12/25//////-450
                    }
                }
            } ////////08/10/29
            YNEXT:
            if ( 水平垂直 = 0 $$ (Mark111 = 2 || Mark111 = 3 || Mark111 = 4) ) { ////////09/11/11
                if ( 荷重図開き < 0 ) {
                    GOUKEI = GOUKEI * (-1) //////- 180 //09/11/16
                } else {if ( (g荷重表記縦 = 1 $$ GOUKEI * 1.3 > -400 $$ GOUKEI < 0) ) { ////////09/11/11
                    GOUKEI = GOUKEI * 1.3
                } else {if ( (g荷重表記縦 = 1 $$ GOUKEI < -630 $$ GOUKEI < 0) ) { ////////09/11/11 $$ GOUKEI < -650 ////10/01/14
                    GOUKEI = -550
                }
                if ( 下床文字表示 = 0 $$ 連続荷重_P1(1) * 連続荷重_P2(1) < 0 $$ g荷重表記高 > 250 ) { //////09/12/04
                    GOUKEI = -650 - Round(g荷重表記高 / 2, 1) //////09/12/04
                }
                if ( g荷重表記縦 = 0 $$ yiKozo = 3 $$ g連続Mod = False $$ (P7 / Max荷重) < 0.75 $$ 荷重図開き > 0 ) { //////13/04/19//////13/12/31
                    if ( 連続荷重数 = 1 $$ 連続荷重_L1(1) + 連続荷重_L2(1) = 0 $$ wXs = XXYY(2) $$ wXe = XXYY(1) $$ wYs != YY_max ) {
                        NN = 1
                    }
                }
            } else {if ( 水平垂直 = 0 $$ GOUKEI < -500 $$ (Mark111 = 5 || Mark111 = 11) ) {
                GOUKEI = -180 ////////09/11/11
            }
            GOUKEI = Round(GOUKEI, 0) ////////08/10/29//////08/11/27
            ////////09/02/20
            if ( N段数 = 1 $$ 水平垂直 = 0 $$ 荷重図開き > 0 ) { //////17/08/13
                For( i = SS1 To SE2
                   if ( 部材正荷重数(i) > 13 ) {
                        N段数 = 2
                        Exit For
                   }
                }
            }
            var yyF5 As Single, yyF6 As Single //////09/08/05
            yyF5 = 0
            if ( Not (水平垂直 = 1 $$ Mark111 = 1) ) { //////09/09/25
                if ( (水平垂直 = 1 $$ (連続荷重_P1(1) < 0)) ) { ////////09/08/03
                    if ( Mark111 = 1 ) {
                        if ( Len(Format(P7, "0.00")) > 6 ) {
                            yyF5 = 450
                        } else {
                            yyF5 = 350
                        }
                    } else {
                        if ( g荷重表記縦 = 0 $$ N段数 = 1 $$ 連続荷重_P1(1) = 連続荷重_P2(1) ) {
                            if ( FLG杭杭 || yiKozo != 3 ) { ////////09/08/03 09/08/05
                                yyF5 = -70
                            } else {
                                yyF5 = -130
                            }
                        }
                    }
                }
            } else {if ( (水平垂直 = 1 $$ Mark111 = 1) ) {
                    if ( 連続荷重_P1(1) > 0 ) {
                        寸法線位置 = -10 ////////14/11/16
                        寸法補助線 = 3
                        yyF5 = -100
                        f寸法FLG = -1
                    } else {
                        寸法線位置 = 2.5 ////////14/11/16
                        寸法補助線 = 3
                        yyF5 = 0
                        f寸法FLG = 1
                    }

                    For( i = 1 To NN
                        寸法(i) = F2(XL(i + 1) - XL(i))
                        XL(i) = 図倍率 * XL(i)
                        X(i) = PX0 + XL(i) * BCS + yyF5
                        Y(i) = PY0 - XL(i) * BSN + GOUKEI * BCS
                    }
                    if ( N段数 = 1 || NN > 2 ) { //////17/08/13
                    this.SunPou2("<", NN, 寸法線位置, 寸法補助線, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, 1, 荷重図開き): GoTo ABC
                    }
            } //////09/09/25
            For( i = 1 To NN
                寸法(i) = F2(XL(i + 1) - XL(i))
                XL(i) = 図倍率 * XL(i)
                X(i) = PX0 + XL(i) * BCS + yyF5 //////09/02/20
                if ( 荷重方向 = "V" || 荷重方向 = "M" || 荷重方向 = "S" ) {
                    Y(i) = PY0 - XL(i) * BSN + GOUKEI * Abs(BCS)
                } else {
                    Y(i) = PY0 - XL(i) * BSN + GOUKEI * BCS
                }
            }
            ////////////////////
            var RX1D, RX2D, RY1D, RY2D, RY3D, DXY, 前DXY, WW, Ww1, Ww2
            var strNum1 As String, strNum2 As String, str前Num As String, str後Num As String
            var FLG_横書き As Integer
            var k荷重表記縦 As Integer
            if ( s側圧数 > 0 ) {
                if ( FLG_側圧9 = 1 ) { ////////左→
                    s荷重位置 = min(s各側圧位置(1, 1), s各側圧位置(1, 2))
                    For( i = 2 To s側圧数
                        s荷重位置 = min(s各側圧位置(i, 1), s各側圧位置(i, 2))
                    }
                } else { ////////FLG_側圧9 = 2 ////////右←
                    s荷重位置 = max(s各側圧位置(1, 1), s各側圧位置(1, 2))
                    For( i = 2 To s側圧数
                        s荷重位置 = max(s各側圧位置(i, 1), s各側圧位置(i, 2))
                    }
                }
            }
            var Hose555 As Single
            Hose555 = 0
            if ( s荷重位置 != 999999 ) { //////13/04/20
                if ( g荷重表記縦 = 0 ) {
                    if ( s側圧数 = 0 ) {
                        寸法線位置 = -6 //////-5  17/06/07
                        寸法補助線 = -3.5
                        if ( Mark111 = 3 ) { ////////////////////////////////////////13/10/10
                            if ( (P7 / Max荷重) < 0.38 ) {
                               寸法線位置 = -7.7 //////////////////////////14/11/26
                            } else {if ( (P7 / Max荷重) < 0.5 ) {
                                寸法線位置 = -8
                            } else {if ( (P7 / Max荷重) > 0.9 ) { //////13/10/10
                                寸法線位置 = -10.5
                            } else {
                                寸法線位置 = -8 //////14/09/27
                            }
            //                }
                        } else {if ( Mark111 = 4 ) {
                            if ( (P7 / Max荷重) < 0.36 ) {
                                寸法線位置 = -6 //////-4.7 - 1.5 ////////////////////////////17/05/25
                            } else {
                                if ( (P7 / Max荷重) > 0.6 ) {
                                    寸法線位置 = -9
                                } else {
                                    寸法線位置 = -7
                                }
                            }
                        } else {if ( (P7 / Max荷重) < 0.4 ) { //////17/06/07
                             s荷重位置 = s荷重位置 + 20
                             Hose555 = 60
                        }
                    } else {
                        if ( FLG_側圧9 = 1 ) {
                            寸法線位置 = -6
                            寸法補助線 = -4
                        } else {
                            寸法線位置 = 8
                            寸法補助線 = 4
                        }
                    }
                } else {
                    if ( s側圧数 = 0 ) {
                        寸法線位置 = -16
                        if ( 荷重文字サイズ > 9 ) {
                            寸法線位置 = 寸法線位置 - IIf(荷重文字サイズ > 9, ((荷重文字サイズ - 9) * 25 / Twip), 0) - IIf(Abs(P7) >= 100, 2.5, 0)
                        }
                        寸法補助線 = -4
                    } else {
                        if ( FLG_側圧9 = 1 ) {
                            寸法線位置 = -16 - 2
                            寸法補助線 = -8
                        } else {
                            寸法線位置 = -17 - 2
                            寸法補助線 = 8
                        }
                    }
                }

            var gKAJYUITI As Single
            gKAJYUITI = s荷重位置
            var gVVITI As Single
            var gVVITI2 As Single
                gVVITI = s荷重位置 ////////14/11/18////// - 50
                gVVITI2 = s荷重位置
            var FLG_999 As Integer: FLG_999 = 0
            var FLG_Boo As Boolean
                if ( s側圧数 = 0 $$ ((荷重図開き > 0 $$ 水平部材最下端 = wYs $$ wYs = wYe $$ _
                                    N段数 = 1 $$ FLGMORO) || 水平部材最下端 = YY_max) ) {
                    FLG_Boo = True
                    if ( NN > 20 ) { k荷重表記縦 = 1
                } else {
                    FLG_Boo = False
                    if ( 水平部材最下端 = YY_max $$ 荷重図開き > 0 ) {
                        FLG_Boo = True
                    }
                }
                if ( N段数 > 1 || g連続Mod ) {
                    FLG_Boo = False
                }
                if ( s側圧数 = 0 ) {
                    if ( FLG_Boo ) {
                        s荷重位置 = HEN_Y(wYs) - g荷重表記高5 * 1.2 - 荷重図開き //////17/08/07 - IIf(yiKozo = 3 $$ g連続Mod, 荷重図開き, 0) //////17/04/10
                    }
                    if ( FLG_WmWs = 1 || Mark111 = 1 ) { ////////15/01/07
                        s荷重位置 = HEN_Y(wYs) + 160 * 0 - 荷重図開き
                    } else {if ( FLG_Boo = True $$ Mark111 != 1 ) {
            //                s荷重位置 = s荷重位置 + 200
                    }
                    For( i = 1 To NN
                        Y(i) = s荷重位置 - Hose555
                    }
                } else {
                    For( i = 1 To NN
                        X(i) = s荷重位置
                    }
                }
            //
                For( i = 1 To Total
                    strNum1 = strKAJYU(i, 1)
                    strNum2 = strKAJYU(i, 2)
                    str後Num = strKAJYU(i + 1, 1)
                    if ( strNum1 = strNum2 ) {
            //               if ( strKAJYU(i - 1, 1) != strNum1 $$ strKAJYU(i - 1, 2) = strNum1 $$ _
            //                  strKAJYU(i + 1, 2) != strNum2 $$ strNum2 = str後Num ) {
            //                       strKAJYU(i - 1, 2) = ""
            //                       strKAJYU(i, 1) = ""
            //                       strKAJYU(i, 2) = ""
            //                       strKAJYU(i + 1, 1) = ""
            //               }
                       if ( strKAJYU(i - 1, 2) = strNum1 $$ strNum1 != strNum2 ) {
                            strKAJYU(i - 1, 2) = ""
                       }
            //               if ( strKAJYU(i + 1, 1) = strNum2 ) {
            //                    strKAJYU(i + 1, 1) = ""
            //               }
                    }
                }
            var FLG_縦横 As Integer
            FLG_縦横 = 0
            var FLG_水平で書く As Boolean
            FLG_水平で書く = False
            double var 前のX
            前のX = 0
                k荷重表記縦 = g荷重表記縦
                if ( Total > 0 ) {
                    FLG_横書き = 0
                    if ( k荷重表記縦 = 0 ) {
                        For( i = 1 To Total
                            strNum1 = strKAJYU(i, 1)
                            strNum2 = strKAJYU(i, 2)
                            RX1D = X(kPoint(i, 1))
                            RX2D = X(kPoint(i, 2))
            //                    if ( s側圧数 = 0 ) {
            //                        if ( Not ((strNum1 = strNum2) $$ Abs(RX1D - RX2D) >= 500) ) {
                                if ( Not (strNum1 = "" || strNum2 = "") ) { //////14/11/18
            //                            if ( Not (i < Total $$ strKAJYU(i + 1, 1) = strKAJYU(i + 1, 2) $$ strNum2 = strKAJYU(i + 1, 1)) ) {
                                        if ( (strNum1 != strNum2) || Abs(RX1D - RX2D) < 500 $$ (RX1D - HEN_X(wXe) > 600 || HEN_X(wXe) - RX2D > 600) ) {
                                            if ( strNum1 != strNum2 $$ ((strNum1 != "" $$ strNum2 != "") || Abs(RX1D - RX2D) < 300) ) { //////14/11/78
                                                if ( (i = 1 $$ Abs(HEN_X(JX_min) - RX1D) < 600) ) {
                                                    FLG_縦横 = 1
                                                } else {if ( (i = Total $$ Abs(HEN_X(JX_max) - RX2D) < 600) ) {
                                                    FLG_縦横 = 2
                                                } else {
                                                    FLG_横書き = 1
                                                }
                                                if ( (i - 1 > 0 $$ strNum1 != strNum2) ) {
                                                    if ( strKAJYU(i - 1, 2) != strNum1 $$ strKAJYU(i - 1, 2) != "" ) {
                                                        FLG_横書き = 1
                                                    }
                                                }
                                            }
                                        }
                                }
                            if ( i = 1 $$ FLG_888 = 1 ) {
                                    FLG_横書き = 1
                                    Exit For
                            }
            //                    if ( Not (strNum1 = "" || strNum2 = "") ) {
                                if ( (Total = 1 $$ strNum1 != strNum2) ) {
                                    FLG_水平で書く = True
                                }
            //                    }
                        }
                    }
                    WW = frmPrint.vsPrt1.TextWidth("A") + 2
            var COUNT As Integer
            COUNT = 0
            var RX1D後 As Single
                if ( s側圧数 = 0 ) {
                    寸法線位置 = -(Num文字列数 * 2 + 5 - 2)
                    寸法補助線 = -4
                    if ( (P7 / Max荷重) < 0.6 $$ Abs(寸法線位置) > 10 ) {
                        寸法線位置 = -(10)
                    }
            FLG_AAA = 1
                    For( i = 1 To Total
                        strNum1 = strKAJYU(i, 1)
                        strNum2 = strKAJYU(i, 2)
                        str後Num = strKAJYU(i + 1, 1)
                            RX1D = X(kPoint(i, 1))
                            RX2D = X(kPoint(i, 2))
                        if ( (strNum1 = strNum2 || strNum2 = str後Num) $$ (Abs(RX1D - 前のX) < 1.5 || i = 1) ) {
                            COUNT = COUNT + 1
                        }
                        前のX = RX2D
                    }
                    if ( Total = COUNT ) {
                        FLG_AAA = 0
                    } else {
            //                GoTo ABC
                    }
                    //
                    if ( FLG_AAA = 0 $$ s側圧数 = 0 ) { //////////////////////////////15/12/24
                        if ( strKAJYU(1, 1) != strKAJYU(1, 2) ) {
                            FLG_AAA = 1
                        }
                        if ( FLG_AAA = 0 ) {
                            For( i = 1 To Total - 1
                                if ( strKAJYU(i, 1) != strKAJYU(i, 2) $$ strKAJYU(i + 1, 1) != strKAJYU(i + 1, 2) ) {
                                    FLG_AAA = 1
                                    Exit For
                                }
                            }
                            if ( FLG_AAA = 1 ) {
                                For( i = 1 To NN
                                    Y(i) = gVVITI - g荷重表記高5 - 100 ////////-500
                                }
                            } else {
                                For( i = 1 To NN
                                    Y(i) = gVVITI - IIf(g荷重表記高 > 260, 160, -80)
                                }
                            }
                        }
                    }

                    For( i = 1 To Total
                        strNum1 = strKAJYU(i, 1)
                        strNum2 = strKAJYU(i, 2)
                        str後Num = strKAJYU(i + 1, 1)
                        if ( strNum1 != strNum2 $$ FLG_AAA = 0 ) { GoTo GRF44
                        RY1D = yyHH1 + (frmPrint.vsPrt1.TextWidth(strNum1) + 330 - 80 / 2)
                        RY2D = yyHH2 + (frmPrint.vsPrt1.TextWidth(strNum2) + 330 - 80 / 2)
                        RX1D = X(kPoint(i, 1))
                        RX2D = X(kPoint(i, 2))
                        RX1D後 = X(kPoint(i + 1, 1))
                        if ( (RX2D - RX1D) < 300 $$ Not (i = 1 || i = Total) ) {
                            FLG_999 = 1
                        }
                        if ( i = 1 ) { ////////////////////////////////////////13/04/24
                            if ( strNum1 != strNum2 $$ H水平(0) = 節Y(節点S) $$ H水平(1) = val(strNum1) $$ H水平(2) = Round(RX1D, 3) ) {
                                strNum1 = ""
                                if ( (FLG_横書き = 1 || FLG_縦横 != 0) $$ Total = 1 $$ Abs(RX1D - RX2D) > 600 $$ strNum1 = strNum2 ) {
                                    FLG_横書き = 0
                                    if ( g荷重表記縦 = 0 ) {
                                        gVVITI = s荷重位置 + 0
                                    } else {
                                        gVVITI = s荷重位置 + 3
                                    }
                                }
                            }
            //                    if ( FLG_横書き = 1 ) {
            //                        RX1D = RX1D - 200
            //                    }
                        }
                        if ( i = Total ) {
                            H水平(0) = IIf(荷重方向 = "V", 節Y(節点S), 節Y(節点E))
                            H水平(1) = val(strNum2)
                            H水平(2) = Round(RX2D, 3)
                        }
                        strNum1 = strNum1 & IIf(strNum1 = "", "", strUN & "/m")
                        strNum2 = strNum2 & IIf(strNum2 = "", "", strUN & "/m")
                        str後Num = str後Num & IIf(str後Num = "", "", strUN & "/m")
                        if ( Total = 1 $$ FLG_横書き = 0 $$ Abs(RX1D - RX2D) < 700 $$ strNum1 != strNum2 $$ 連続荷重数 > 1 ) { //////16/07/01
                            FLG_横書き = 1
                        }
                        if ( FLG_横書き = 0 ) { ////// || (strKAJYU(i - 1, 1) = "" $$ strKAJYU(i - 1, 2) = strKAJYU(i, 1) $$ strKAJYU(i, 2) = "") ) {
                            if ( Not (yiKozo = 3 $$ g連続Mod) ) {
                            if ( 部材_max > 40 ) { //////And strNum1 = strNum2 ) { ////////g連続Mod = False $$ iKozo = 3 $$ 部材_max > 30 ) {
                                寸法線位置 = -4.5
                                寸法補助線 = -3
                            } else {
                                寸法線位置 = -7
                                寸法補助線 = -3
                                g荷重表記高 = 130
                            }
                            if ( FLG_Boo ) { //////1/04/25
                                if ( (yiKozo = 3 $$ NKUI = 0 $$ 部材_max > 100) ) { ////////13/12/31
                                    寸法線位置 = -8.5
                                } else {
                                    寸法線位置 = 9 + 6
                                    寸法補助線 = 5 + 4
                                }
                            }
                            }
                            if ( strNum1 != strNum2 ) {
                                if ( strNum1 != "" ) {
                                    if ( strNum1 != str前Num || (strNum1 = str前Num $$ RX1D != X(kPoint(i - 1, 2))) $$ str後Num = "" ) {
            //                            if ( strNum1 != str前Num || (strNum1 = str前Num $$ RX1D != X(kPoint(i - 1, 2))) $$ str後Num = "" ) {
                                        WW = frmPrint.vsPrt1.TextWidth(strNum1)
                                        if ( FLG_列車_衝撃 = False $$ (FLG_縦横 != 0 || FLG_水平で書く || i = 1 || i = Total) ) {
            //                                    if ( (val(strKAJYU(i, 1)) / Max荷重) < 0.44 ) {
                                                gVVITI2 = (val(strKAJYU(i, 2)) - val(strKAJYU(i, 1))) / 図Y_SCALE / sNN / Twip // - (図縦幅 - UEHOSEI) * Twip
                                                if ( gVVITI2 > 0 ) {
                                                    gVVITI2 = gVVITI2 / 10
                                                } else {
                                                    if ( Abs(gVVITI2) < 200 ) {
                                                        gVVITI2 = -20
                                                    } else {
                                                        gVVITI2 = gVVITI2 / 10 /////////// 4
                                                    }
                                                }
                                                gVVITI2 = gVVITI + gVVITI2
                                                if ( str前Num = "" ) { //////////////////17/08/06
                                                this.MOJ2C("D上*", RX1D - WW / 2 + WW / 8, gVVITI2, RX1D + WW / 2 + WW / 8, gVVITI2, strNum1)
                                                }
                                            } else {
                                                if ( Not (i > 1 $$ strKAJYU(i - 1, 1) = strKAJYU(i - 1, 2) $$ strKAJYU(i - 1, 1) = strKAJYU(i, 1)) ) {
                                                    this.MOJ2C("D上*", RX1D - WW / 2 + WW / 8, gVVITI, RX1D + WW / 2 + WW / 8, gVVITI, strNum1)
                                                }
                                            }
                                            if ( RX1D = HEN_X(節X(節点S)) $$ wYs = YY_max $$ N段数 = 1 $$ 荷重図開き < 800 $$ k荷重表記縦 = 0 ) {
                                                FLG_左右接点(1) = True //////////////15/04/05
                                            }
            //                                }
                                        str前Num = strNum1
                                    }
                                }

                                if ( strNum2 != "" $$ (strNum2 != str後Num || (strNum2 = str後Num $$ Abs(RX1D後 - RX2D) > 800)) ) { //////14/11/178
                                    WW = frmPrint.vsPrt1.TextWidth(strNum2)
                                    if ( (val(strKAJYU(i, 2)) / Max荷重) < 0.44 ) {
                                        gVVITI2 = (val(strKAJYU(i, 1)) - val(strKAJYU(i, 2))) / 図Y_SCALE / sNN / Twip
                                        if ( gVVITI2 > 0 ) {
                                            gVVITI2 = gVVITI2 / 10
                                        } else {
                                            if ( Abs(gVVITI2) < 200 ) {
                                                gVVITI2 = -20
                                            } else {
                                                gVVITI2 = gVVITI2 / 10
                                            }
                                        }
                                        gVVITI2 = gVVITI + gVVITI2
            //                                if ( strNum1 = "" $$ str後Num = "" ) { //////17/08/05
                                        this.MOJ2C("D上*", RX2D + WW / 4, gVVITI2, RX2D + WW / 2, gVVITI2, strNum2)
            //                                }
                                    } else {
                                        this.MOJ2C("D上*", RX2D - WW / 8, gVVITI, RX2D + WW / 2, gVVITI, strNum2)
                                    }
                                    if ( RX2D = HEN_X(節X(節点E)) $$ wYe = YY_max $$ N段数 = 1 $$ 荷重図開き < 800 $$ k荷重表記縦 = 0 ) {
                                        FLG_左右接点(2) = True //////////////15/04/05
                                    }
                                    str前Num = strNum2
                                }

                            }
            //                    GoTo GRF44
                        }
                        if ( strNum1 = strNum2 ) {
                            if ( Abs(RX1D - RX2D) < 200 ) {
                                if ( str前前Num != strNum1 || Abs(sgl前前Num - (RX1D + RX2D) / 2) > 1000 ) {
                                    if ( yiKozo = 1 $$ (k荷重表記縦 = 0 || k荷重表記縦 = 1) ) {
                                        if ( FLG_Boo ) { //////1/04/25
                                            RY1D = gVVITI - 220
                                            RY2D = RY1D
                                        } else {
                                            if ( YY_max = 節Y(節点S) ) {
                                                RY1D = s荷重位置 - 220
                                            } else {
                                                RY1D = s荷重位置 - 220
                                            }
                                        }
                                        RY3D = RY1D
                                        WW = frmPrint.vsPrt1.TextWidth(strNum1)
            //                                if ( z上層両X座標(2) = 節X(節点E) $$ 水平部材最上端 = 節Y(節点S) $$ Abs(RX2D = HEN_X(節X(節点E))) < WW $$ i = Total $$ Abs(sgl前前Num - (RX1D + RX2D) / 2) > WW * 2 ) {
                                        if ( Abs(RX1D - RX2D) < WW ) {
                                            if ( (z上層両X座標(1) = 節X(節点S) $$ i = 1) || (z上層両X座標(2) = 節X(節点E) $$ i = Total) ) {
                                                WW = WW / 2
                                                RX1D = RX1D - WW
                                                RX2D = RX2D - WW
                                            }
                                        }
                                        if ( Abs(RX1D - RX2D) > 500 $$ strNum1 = strNum2 ) {
                                            this.MOJ2L("U上", RX1D, RY1D, RX2D, RY3D, strNum1) ////////////////下に表記
                                            sgl前前Num = (RX1D + RX2D) / 2
                                        } else {

                                        }
                                    } else { ////////////////縦に表記
                                        if ( str前前Num != strNum1 ) {
                                            DXY = (RX1D + RX2D) / 2 - WW * 1.5
                                            if ( Abs(DXY - 前DXY) < 150 ) {
                                                DXY = 前DXY + WW * 1.5
                                            }
                                            if ( (val(strKAJYU(i, 1)) / Max荷重) < 0.1 ) {
                                                RY1D = RY1D + 200
                                                RY3D = RY3D + 200
                                            }
            //                                    this.MOJ2L("U上", DXY, RY1D, DXY, RY3D, strNum1)
                                            if ( yiKozo != 1 ) {
                                                k荷重表記縦 = 1 //////13/12/28
                                            }
                                            前DXY = DXY
                                            sgl前前Num = DXY
                                        }
                                    }
                                }
                            }
                            str前Num = strNum1
                            str前前Num = strNum1
                        } else {
                            if ( Total = 1 ) {
                                k荷重表記縦 = 1
                                if ( Abs(RX1D - RX2D) < 800 ) {
                                    DXY = RX1D - WW
                                    if ( strNum1 != "" ) {
            //                            this.MOJ2L("U上", DXY, RY1D, DXY, RY3D, strNum1): k荷重表記縦 = 1
                                    }
                                    DXY = RX2D + WW
                                    if ( strNum2 != "" ) {
            //                            this.MOJ2L("U上", DXY, RY2D, DXY, RY3D, strNum2): k荷重表記縦 = 1
                                    }
                                } else {
                                    DXY = RX1D - WW
                                    DXY = RX1D - WW / 2
                                    if ( strNum1 != "" ) {
            //                            this.MOJ2L("U上", DXY, RY1D, DXY, RY3D, strNum1): k荷重表記縦 = 1
                                    }
                                    DXY = RX2D - WW * 2.2
                                    if ( strNum2 != "" ) {
            //                            this.MOJ2L("U上", DXY, RY2D, DXY, RY3D, strNum2): k荷重表記縦 = 1
                                    }
                                }
                            } else {
                                if ( i = 1 ) {
                                    if ( strNum1 != "" ) {
                                        if ( Abs(RX1D - RX2D) < 150 ) {
                                            DXY = RX2D - WW * 3
                                        } else {
                                            DXY = RX1D - WW / 2
                                            if ( FLG_888 = 1 ) { //////14/09/17
                                                DXY = DXY - WW * 2
                                            }
                                        }
            //                                this.MOJ2L("U上", DXY, RY1D, DXY, RY3D, strNum1)
                                        if ( FLG_888 != 1 ) { //////14/09/17
                                            k荷重表記縦 = 1
                                        }
                                        前DXY = DXY
                                    }
                                    if ( strKAJYU(i, 2) = strKAJYU(i + 1, 1) $$ X(kPoint(i, 2)) = X(kPoint(i + 1, 1)) ) {
                                        DXY = RX2D - WW
                                    } else {
                                        if ( Abs(RX1D - RX2D) < 150 ) {
                                            DXY = RX2D - WW * 3
                                        } else {
                                            DXY = RX2D - WW * 2.2
                                        }
                                    }
                                    if ( Abs(DXY - 前DXY) < 150 ) {
                                        DXY = 前DXY + WW * 1.5
                                    }
                                    if ( strNum2 != "" $$ (strKAJYU(i, 2) != strKAJYU(i + 1, 1) || Abs(RX2D - X(kPoint(i + 1, 1))) > 200) ) {
            //                            this.MOJ2L("U上", DXY, RY2D, DXY, RY3D, strNum2)
                                    k荷重表記縦 = 1
                                        前DXY = DXY
                                        str前Num = strNum2
                                    }
                                } else {if ( i = Total ) {
                                    if ( strNum1 != str前Num || (strNum1 = str前Num $$ RX1D != X(kPoint(i - 1, 2))) ) {
                                        DXY = RX1D - WW / 2
                                        if ( Abs(DXY - 前DXY) < 150 ) {
                                            DXY = 前DXY + WW * 1.5
                                        }
            //                                this.MOJ2L("U上", DXY, RY1D, DXY, RY3D, strNum1): k荷重表記縦 = 1
                                        k荷重表記縦 = 1
                                        前DXY = DXY
                                        str前Num = strNum1
                                    }
                                    //
                                    if ( strNum2 != "" ) {
                                        DXY = RX2D - WW * 2.2
                                        if ( FLG_888 = 2 ) { //////14/09/17
                                            DXY = DXY + WW * 2
                                        }
                                        if ( Abs(DXY - 前DXY) < 150 ) {
                                            DXY = 前DXY + WW * 1.5
                                        }
            //                                this.MOJ2L("U上", DXY, RY2D, DXY, RY3D, strNum2)
                                        if ( FLG_888 != 2 ) {
                                            k荷重表記縦 = 1
                                        }
                                    }
            ////////// 一般的
                                } else {
                                    if ( strNum1 != "" $$ strNum1 != str前Num || (strNum1 = str前Num $$ RX1D != X(kPoint(i - 1, 2))) ) {
                                        if ( Abs(RX1D - RX2D) < 150 ) {
                                            DXY = RX1D - WW * 3
                                        } else {
                                            DXY = RX1D - WW / 2 //////(RX1D + Ww)
                                        }
                                        if ( Abs(DXY - 前DXY) < 150 ) {
                                            DXY = (前DXY + WW * 1.5)
                                        }
                                        if ( strNum1 != "" ) {
            //                                    this.MOJ2L("U上", DXY, RY1D, DXY, RY3D, strNum1)
            //                                    if ( strNum2 = "" ) {
                                                前DXY = DXY
                                                str前Num = strNum1
                                                k荷重表記縦 = 1
            //                                    }
                                        }
                                    }
                                    //
                                        DXY = RX2D - WW * 2.2
                                        if ( Abs(DXY - 前DXY) < 150 ) {
                                            DXY = 前DXY + WW * 1.5
                                        }
                                    if ( strNum2 != "" ) {
            //                               this.MOJ2L("U上", DXY, RY2D, DXY, RY3D, strNum2)
            //                                前DXY = DXY
            //                                str前Num = strNum2
            //                                if ( str後Num != strNum2 ) {
            //                                    k荷重表記縦 = 1
            //                                }
                                    } else {
                                        str前Num = strNum2
                                    }
                                }
                            }
                        }
            GRF44:
                    }
            ////GRF4455:
                    g荷重表記縦 = k荷重表記縦
                    if ( g荷重表記縦 = 0 ) {
                        if ( Not (yiKozo = 3 $$ NKUI = 0 $$ 部材_max > 100) ) { ////////13/12/31
                        寸法線位置 = Round(min(14 * (P7 / Max荷重), 7), 2) * Sgn(寸法線位置) //////13/12/28
                        }
                        if ( s側圧数 = 0 $$ 荷重図開き > 0 $$ 水平部材最下端 = wYs $$ wYs = wYe $$ N段数 = 1 ) {
                        if ( FLGMORO ) {
                            寸法線位置 = max(寸法線位置, 7)
                            寸法補助線 = Abs(寸法補助線) * Sgn(寸法線位置)
                        } else {if ( 水平部材最上端 = 水平部材最下端 ) { //////////////////17/08/07
                                寸法線位置 = -7
                                寸法補助線 = Abs(寸法補助線) * Sgn(寸法線位置)
                            }
                        }
            if ( FLG_WmWs = 1 ) { //////15/01/07
                        寸法線位置 = -10
                        寸法補助線 = -4
            }
            if ( s側圧数 = 0 $$ 荷重図開き < 0 $$ 水平部材最下端 = wYs $$ wYs = wYe $$ N段数 = 1 ) { //////17/07/29
                        寸法線位置 = 20
                        寸法補助線 = 8
            }

                    }
                } else { //////////////////////////////////////////////////////////////////////////////////////////////////////////側壁
                    str前Num = ""
                    RY3D = s荷重位置 - (Num文字列数 * WW + 400)
                    For( i = 1 To Total
                        strNum1 = strKAJYU(i, 1)
                        strNum2 = strKAJYU(i, 2)
                        RY1D = Y(kPoint(i, 1))
                        RY2D = Y(kPoint(i, 2))
                        if ( i = 1 ) { ////////////////////////////////////////13/04/24
                            if ( V鉛直(0) = 節X(節点S) $$ V鉛直(1) = val(strNum1) $$ Abs(V鉛直(2) - Round(RY1D, 3)) < 0.005 ) {
                                strNum1 = ""
                            }
                        }
                        if ( i = Total ) {
                            V鉛直(0) = 節X(節点E)
                            V鉛直(1) = val(strNum2)
                            V鉛直(2) = Round(RY2D, 3)
                        }
                        if ( FLG_側圧9 = 1 ) {
                            RX1D = s各側圧位置(i, 1) - (frmPrint.vsPrt1.TextWidth(strNum1) + 330)
                            RX2D = s各側圧位置(i, 2) - (frmPrint.vsPrt1.TextWidth(strNum2) + 330)
                        } else {
                            RX1D = s各側圧位置(i, 1) + 60
                            RX2D = s各側圧位置(i, 2) + 60
                        }
                        strNum1 = strNum1 & IIf(strNum1 = "", "", strUN & "/m")
                        strNum2 = strNum2 & IIf(strNum2 = "", "", strUN & "/m")
                        Ww1 = frmPrint.vsPrt1.TextWidth(strNum1)
                        Ww2 = frmPrint.vsPrt1.TextWidth(strNum2)
                        if ( FLG_横書き = 0 ) {
                            if ( FLG_側圧9 = 1 ) {
                                寸法線位置 = -8
                                寸法補助線 = -4
                            } else {
                                寸法線位置 = 10
                                寸法補助線 = 4
                            }
            //                    if ( strNum1 != strNum2 ) {
                                if ( strNum1 != "" ) {
                                    if ( strNum1 != str前Num ) { //////Or (strNum1 = str前Num $$ RX1D != X(kPoint(i - 1, 2))) ) {
                                        DXY = s各側圧位置(i, 1) + IIf(FLG_側圧9 = 1, -200, 50)
                                        RY3D = (RY1D + RY2D) / 2
                                        this.MOJ2L("U上", DXY, RY3D + Ww1 / 2 - Ww1 / 8, DXY, RY3D - Ww1 / 2 - Ww1 / 8, strNum1)
                                    }
                                }
                            if ( strNum1 = strNum2 ) { GoTo GRF55
                        }
                        if ( FLG_側圧9 = 1 ) {
                            if ( 連続荷重数 = 1 ) {
                            寸法線位置 = -(Num文字列数 * 1.8 + 6.5)
                            寸法補助線 = -8
                            } else {
                            寸法線位置 = -(Num文字列数 * 2 + 6.5)
                            寸法補助線 = -8
                            }
                        } else {
                            if ( 連続荷重数 = 1 ) {
                                寸法線位置 = (Num文字列数 * 1.8 + 7)
                                寸法補助線 = 8
                            } else {
                                寸法線位置 = (Num文字列数 * 2 + 7)
                                寸法補助線 = 8
                            }
                        }
                        if ( strNum1 = strNum2 ) {
            //                    if ( Abs(RX1D - RX2D) < 500 ) {
                                RY3D = (RY1D + RY2D) / 2
                                this.MOJ2C("D上*", RX1D, RY3D, RX1D + Ww1, RY3D, strNum1):
            k荷重表記縦 = 1
                                前DXY = DXY
                                str前Num = strNum1
            //                    }
                        } else {
                            if ( Total = 1 ) {
                                if ( wYs = JY_max || wYs = YY_max ) {
                                    DXY = RY1D - WW / 8
                                } else {
                                    DXY = RY1D + WW * 2.2
                                }
                                前DXY = DXY
                                if ( strNum1 != "" ) {
                                    this.MOJ2C("D上*", RX1D, DXY, RX1D + Ww1, DXY, strNum1)
                                    k荷重表記縦 = 1
                                }
                                if ( (wYe = YY_min || wYe = 水平部材最下端) $$ 連続荷重_L2(Total) = 0 ) { //////13/11/15
                                    DXY = RY2D + WW * 2.2
                                    if ( FLG_側圧9 = 1 ) { //////13/11/16
                                        RX2D = RX2D + WW * 2
                                    }
                                    if ( FLG_側圧9 = 2 ) {
                                        RX2D = RX2D - WW
                                    }
                                } else {
                                    DXY = RY2D - WW / 8
                                }
                                if ( Abs(DXY - 前DXY) < 150 ) {
                                    DXY = 前DXY + WW * 1.5
                                }
                                if ( strNum2 != "" ) {
                                this.MOJ2C("D上*", RX2D, DXY, RX2D + Ww2, DXY, strNum2):
                                k荷重表記縦 = 1
                                }
                            } else {
                                if ( i = 1 ) {
                                    if ( wYs = JY_max || wYs = YY_max ) {
                                        DXY = RY1D - WW / 8
                                    } else {
                                        DXY = RY1D + WW * 2.2
                                    }
                                    if ( strNum1 != "" ) {
                                        this.MOJ2C("D上*", RX1D, DXY, RX1D + Ww1, DXY, strNum1):
                                        k荷重表記縦 = 1
                                        前DXY = DXY
                                        str前Num = strNum1
                                    }
                                    DXY = RY2D - WW / 8
                                    if ( Abs(DXY - 前DXY) < 150 ) {
                                        if ( strKAJYU(i, 2) = strKAJYU(i + 1, 1) ) {
                                            DXY = RY2D + WW * 2.2
                                        } else {
                                            DXY = 前DXY + WW * 1.5
                                        }
                                    }
                                    if ( (wYe = YY_min || wYe = 水平部材最下端) $$ 連続荷重_L2(i) = 0 ) { //////13/11/15
                                        DXY = RY2D + WW * 2.2
                                        if ( FLG_側圧9 = 1 ) { //////13/11/16
                                            RX2D = RX2D + WW * 2
                                        }
                                        if ( FLG_側圧9 = 2 ) {
                                            RX2D = RX2D - WW
                                        }
                                    }
                                    if ( strNum2 != "" ) {
                                        this.MOJ2C("D上*", RX2D, DXY, RX2D + Ww2, DXY, strNum2):
            k荷重表記縦 = 1
                                        前DXY = DXY
                                        str前Num = strNum2
                                    }
                                } else {if ( i = Total ) {
                                    if ( strNum1 != str前Num ) {
                                        DXY = RY1D + WW * 2.2
                                        if ( Abs(DXY - 前DXY) < 150 ) {
                                            DXY = 前DXY + WW * 1.5
                                        }
                                        this.MOJ2C("D上*", RX1D, DXY, RX1D + Ww1, DXY, strNum1):
                                        k荷重表記縦 = 1
                                        前DXY = DXY
                                        str前Num = strNum1
                                    }
                                    //
                                    if ( strNum2 != "" ) {
                                        DXY = RY2D + WW * 2.2
                                        if ( Abs(DXY - 前DXY) < 150 ) {
                                            DXY = 前DXY + WW * 1.5
                                        }
                                        if ( (wYe = YY_min || wYe = 水平部材最下端) $$ 連続荷重_L2(i) = 0 ) { //////13/11/15
                                            if ( FLG_側圧9 = 1 ) {
                                                RX2D = RX2D + WW * 3
                                            } else {if ( FLG_側圧9 = 2 ) {
                                                RX2D = RX2D - WW * 2.5
                                            }
                                        }
                                        this.MOJ2C("D上*", RX2D, DXY, RX2D + Ww2, DXY, strNum2):
                                        k荷重表記縦 = 1
                                    }
            ////////// 一般的
                                } else {
                                    if ( strNum1 != str前Num ) {
                                        DXY = RY1D + WW * 2.2
                                        if ( Abs(DXY - 前DXY) < 150 ) {
                                            DXY = (前DXY + WW * 1.5)
                                        }
                                        if ( strNum1 != "" ) {
                                            this.MOJ2C("D上*", RX1D, DXY, RX1D + Ww1, DXY, strNum1): k荷重表記縦 = 1
                                            前DXY = DXY
                                            str前Num = strNum1
                                        }
                                    }
            //                            if ( strKAJYU(i, 2) = strKAJYU(i + 1, 1) ) {
            //                                DXY = RY2D - Ww
            //                            } else {
            //                                DXY = RY2D - Ww / 8
            //                            }
                                    DXY = RY2D - WW / 8
                                    if ( Abs(DXY - 前DXY) < 150 ) {
                                        if ( strKAJYU(i, 2) = strKAJYU(i + 1, 1) ) {
                                            DXY = RY2D + WW * 2.2
                                        } else {
                                            DXY = 前DXY + WW * 1.5
                                        }
                                    }
            //
            //                            DXY = RY2D - Ww / 8
            //                            if ( Abs(DXY - 前DXY) < 150 ) {
            //                                DXY = 前DXY + Ww * 1.5
            //                            }
                                    if ( strNum2 != "" ) {
                                        this.MOJ2C("D上*", RX2D, DXY, RX2D + Ww2, DXY, strNum2): k荷重表記縦 = 1
                                        前DXY = DXY
                                        str前Num = strNum2
                                    }
                                }
                            }
                        }
            GRF55:
                    }
                    g荷重表記縦 = k荷重表記縦

                    }
                }
                if ( 連続荷重_L1(1) + 連続荷重_L2(1) = 0 $$ (wXs = JX_min $$ wXe = JX_max) $$ Now荷重max1 > 1 $$ 荷重図開き > 0 ) { //////And iKozo = 1 ) {
                    if ( N段数 = 1 ) { //////14/11/178
                        yyF5 = -8  ////////17/08/11
                    } else {
            //                yyF5 = 0
                        if ( (P7 / Max荷重) > 0.8 ) {
                            yyF5 = 0
                            if ( 部材正荷重数(SS1) < 30 ) {
                                    yyF5 = 0.5
                            } else {
                                    yyF5 = 1
                            }
                        } else {
                            yyF5 = 4.5 ////14/11/178
                        }
                    }
                    For( i = SS1 To SE2
                        部材正荷重数(i) = 部材正荷重数(i) - yyF5 //////14/11/178
                    }
                    if ( NN = 1 ) { GoTo ABC //////GoTo GRF9
                } else {
                    GoTo GRF9
                }
            }
            if ( X(1) = X(連続荷重数) ) {
                HV = 0
            }
            //////////
            //    if ( N段数 = 1 $$ 水平垂直 = 0 $$ 荷重図開き > 0 ) {
            //        For( i = SS1 To SE2
            //           if ( 部材正荷重数(i) > 10 ) {
            //                N段数 = 2
            //                Exit For
            //           }
            //        }
            //    }

            obj.FontSize = 荷重寸法Fontsize
            obj.PenWidth = 部材荷重寸法Pen幅
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(obj.PenWidth))
            }
            obj.PenColor = QBColor(部材荷重寸法Pen色)
            Select Case Mark111
            Case 1, 2, 3, 4, 5, 6, 7, 11
            //GRF: //////////////////////09/11/06
                if ( 水平垂直 != 1 $$ 荷重図開き < 0 ) { //////09/11/16
                    寸法線位置 = Abs(寸法線位置) ////////////10/05/12寸法線位置 * Sgn(荷重図開き) //////09/11/16
                }
            //////08/11/06
            var M As Integer, Atta As Integer
            var YUT As Single
            var FLG_下引出し As Integer
            FLG_下引出し = 0 ////////14/12/21
                Atta = 0
                //////////09/11/09
                if ( 水平垂直 != 1 $$ (Mark111 = 1 || Mark111 = 5 || Mark111 = 6 || Mark111 = 11) $$ N段数 = 1 ) { ////////08/11/06
                    if ( 下層BUZAI(1, 1) != 0 ) {
                        For( M = 1 To 部材_max
                            if ( 下層BUZAI(M, 1) = 0 ) { Exit For
                            if ( 下層BUZAI(M, 2) >= 節点S $$ 下層BUZAI(M, 2) <= 節点E ) {
                                Atta = 1
                                Exit For
                            }
                            if ( 下層BUZAI(M, 3) >= 節点S $$ 下層BUZAI(M, 3) <= 節点E ) {
                                Atta = 1
                                Exit For
                            }
                        Next M
                    }
                    if ( Atta = 0 $$ yiKozo = 1 $$ Abs(YY_max - (wYe + wYs) / 2) > 1.6 ) {
                        Atta = 1
                        PY0 = min(HEN_Y(wYs), HEN_Y(wYe)) + 2 * Twip
                    }
                    if ( Atta = 0 $$ yiKozo = 1 $$ (水平部材最下端 = (wYs + wYe) / 2 $$ Mark111 = 6) ) { //////13/11/15
                        Atta = 1
                        PY0 = min(HEN_Y(wYs), HEN_Y(wYe)) + 2 * Twip
                    }
                }
            //////08/11/06
                if ( Atta = 1 ) {
                    if ( (水平部材最下端 = (wYs + wYe) / 2) $$ (yiKozo = 1 || yiKozo = 3) $$ 水平垂直 = 0 $$ N段数 = 1 ) {
                        For( i = 1 To NN //////////09/10/25
                            Y(i) = PY0 + (XL(i) * BSN - 0 * BCS) - 5 * Twip //////////////09/11/08
                        }
                        if ( N段数 = 1 || NN > 2 ) { //////17/08/13
                        this.SunPou2("<", NN, 10, 4, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, 1, 荷重図開き): GoTo ABC //////09/10/20 12/12/15
                        }
                    } else {
                        For( i = 1 To NN //////////09/10/25
                            Y(i) = PY0 + (XL(i) * BSN - 95 * BCS) - 5 * Twip //////////////09/11/08
                        }
                        if ( N段数 = 1 || NN > 2 ) { //////17/08/13
                        this.SunPou2("<", NN, 10, 4, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, , 荷重図開き): GoTo ABC //////09/10/20 12/12/15
                        }
                    }
                } else {
                    if ( Mark111 = 5 ) {
                        if ( 水平垂直 = 1 ) { ////13/04/08
                            寸法線位置 = -10
                            寸法補助線 = -3
                        } else {
                            寸法線位置 = 4.5
                            寸法補助線 = -4
                        }
                    }
                    if ( f寸法FLG = 0 ) { //////09/08/14
            GRF8: //////12/12/17
            //            if ( 連続荷重数 = 1 $$ NN = 2 $$ (YY_max = wYs $$ YY_max = wYe) ) {
            //                if ( LLL789 = 寸法(1) & Format((節点S + 節点E) * 10) ) {
            //                    GoTo ABC
            //                }
            //            }
                    if ( LLL789 = 寸法(1) & Format((節点S + 節点E) * 10) ) { GoTo ABC //////14/11/16
                    if ( 連続荷重mark(1) = 6 $$ wXs = wXe $$ g柱本数 > 0 $$ RR橋脚 = 1 ) {
                        if ( 節X(節点S) = g柱X座標(1, 1) ) {
                            寸法線位置 = -10
                        } else {if ( 節X(節点S) = g柱X座標(g柱本数, 1) ) {
                        } else {
                            if ( (Abs(寸法線位置) / 図X_SCALE) < 600 ) {
                            寸法線位置 = -Round((600 * 図X_SCALE), 1)
                            }
                            if ( FLG柱軸重 = True ) {
                                寸法線位置 = 5.5
                                寸法補助線 = 6.5
                            }
                        }
                    }
            GRF9:
                        if ( s側圧数 != 0 $$ 水平垂直 = 1 ) { //////13/04/30
                            if ( (節X(節点S) = JX_max $$ 荷重図開き < 0) ) {
                                if ( 寸法線位置 < 0 ) { //////14/09/17
                                    寸法線位置 = -2.5
                                    寸法補助線 = 6.01 - 1.5
                                } else {
                                    寸法線位置 = 6
                                    寸法補助線 = 6.01
                                }
                                For( i = 1 To NN
                                    X(i) = PX0 + 500 + 150
                                }
                            } else {if ( (節X(節点S) = JX_min $$ 荷重図開き > 0) ) {
                                if ( 寸法線位置 > 0 ) { //////14/09/17
                                    寸法線位置 = -1
                                    寸法補助線 = -6.01 + 2.5
                                } else {
                                    寸法線位置 = -6
                                    寸法補助線 = -6.01
                                }
                                For( i = 1 To NN
                                    X(i) = PX0 - 550 + 150
                                }
                            } else {
                                if ( 寸法線位置 < 0 ) {
                                    寸法線位置 = -5 //////14/11/17
                                } else {
                                    寸法線位置 = 8
                                }
                            }
                            if ( N段数 = 1 || NN > 2 ) { //////13/04/30//////13/11/15
                                this.SunPou2("<", NN, 寸法線位置, 寸法補助線, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, 1, 荷重図開き)
                            }
                        } else {
                            if ( s側圧数 = 0 $$ 水平部材最下端 != YY_max $$ (水平部材最下端 = (wYs + wYe) / 2) $$ yiKozo = 1 $$ 水平垂直 = 0 _
                                           $$ N段数 = 1 $$ (連続荷重mark(1) = 1 || 連続荷重mark(1) = 5 || 連続荷重mark(1) = 11) ) {
                                寸法線位置 = 18.01 //////13/08/11 10.01
                                寸法補助線 = 6.01
                                if ( 水平部材最下端 = YY_max ) {
                                    YUT = 5 * Twip
                                } else {
                                    YUT = -5 * Twip
                                    FLG_下引出し = -1 ////////14/12/21
                                }
                                For( i = 1 To NN
                                    Y(i) = PY0 + (XL(i) * BSN - 0 * BCS) + YUT
                                }
                            } else {if ( 連続荷重_P1(1) * 連続荷重_P2(1) < 0 $$ 水平垂直 = 0 ) { //////13/11/15
            //                        寸法線位置 = -20
            //                        寸法補助線 = -3.5
                            } else {if ( GOUKEI = 444 ) {
                                寸法線位置 = -16
                            } else {if ( NN > 2 $$ Abs(寸法線位置) <= 6 $$ FLG_999 = 1 ) { ////////14/09/17
                                if ( g荷重表記縦 = 1 ) { 寸法線位置 = 6.5 * Sgn(寸法線位置)
                            }
                            if ( (FLG_横書き = 0) ) {
                                RX1D = 0
                                RX2D = 0
                                YUT = 0
                                For( i = 1 To Total - 1
                                    strNum1 = strKAJYU(i, 1)
                                    strNum2 = strKAJYU(i, 2)
                                    WW = max(frmPrint.vsPrt1.TextWidth(strNum1 & "kN/"), frmPrint.vsPrt1.TextWidth(strNum2 & "kN/"))
                                    if ( strNum1 != "" ) {
                                        RX1D = X(kPoint(i, 1))
                                    }
                                    if ( strNum2 != "" ) {
                                        RX2D = X(kPoint(i, 2))
                                    }
                                    if ( RX1D * RX2D != 0 $$ strKAJYU(i + 1, 1) = "" ) {
                                        if ( Abs(RX2D - RX1D) < WW $$ Abs(RX2D - RX1D) != 0 ) {
                                            YUT = 4 * Twip
                                            Exit For
                                        }
                                    }
                                }
                                if ( YUT > 0 ) {
                                    For( i = 1 To NN
                                        Y(i) = Y(i) - YUT
                                    }
                                }
                            }
                            if ( FLG_列車_衝撃 $$ 寸法線位置 > -7 ) { //////15/02/17
                                寸法線位置 = -7
                            }
                            if ( Mark111 = 3 $$ (P6 / Max荷重) > 0.9 $$ (wYe = 水平部材最下端) $$ 水平垂直 = 0 ) {

                            } else {
                                if ( k荷重表記縦 = 0 $$ 寸法線位置 < 0 $$ iKozo = 1 $$ (wYe = 水平部材最下端) $$ 水平垂直 = 0 ) {
                                    if ( 図Y_SCALE > 0.003 ) {
                                        寸法線位置 = -3 //////17/03/01
                                    }
                                }
                                if ( (P6 / Max荷重) > 0.9 $$ k荷重表記縦 = 0 $$ 寸法線位置 < 0 $$ Abs(寸法線位置) < 6 $$ iKozo = 3 $$ Mark111 = 4 ) {
                                    寸法線位置 = Round(-11 * (P6 / Max荷重), 1) ////////17/05/25 g荷重表記高5
                                }
            //                        if ( Abs(寸法線位置) < 11 $$ FLG_横書き = 1 ) {
            //                            寸法線位置 = 11 * Sgn(寸法線位置)
            //                        }
                                if ( Abs(寸法線位置) < 12.5 $$ FLG_横書き = 1 ) { //////17/08/16
                                    寸法線位置 = 12.5 * Sgn(寸法線位置)
                                }
                                if ( Abs(寸法線位置) < 5.5 ) {
                                    寸法線位置 = 5.5 * Sgn(寸法線位置)
                                }
                            }
                            if ( N段数 = 1 || NN > 2 ) { //////17/08/13
                            this.SunPou2("<", NN, 寸法線位置, 寸法補助線, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, 1, 荷重図開き)
                            }
                        }
                    } else {if ( f寸法FLG = -1 ) { ////////09/08/14
                        this.SunPou2("<", NN, -7, -4, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, 1, 荷重図開き)
                    } else {if ( f寸法FLG = 1 ) { //////09/08/14
                        this.SunPou2("<", NN, 6, 4, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, 1, 荷重図開き)
                    }
                }
            Case } else {
            End Select
            //   //////////////////////////////////////////////08/07/06
            ABC:
            var FLG_Pas As Integer
            FLG_Pas = 0
            if ( FLG_横書き = 0 ) {
                For( i = 1 To Total
                    if ( (strKAJYU(i, 1) != "" $$ strKAJYU(i, 2) = "") || (strKAJYU(i, 1) = "" $$ strKAJYU(i, 2) != "") ) {
                    } else {
                        FLG_Pas = 1
                        Exit For
                    }
                }
                if ( FLG_Pas = 1 ) { GoTo GRF666
            }
            //
            if ( FLG_AAA = 1 $$ Total > 0 ) { ////////////////////////////荷重値の出力=================
                if ( (FLG_横書き = 0) ) {
                    RX1D = 0
                    RX2D = 0
                    For( i = 1 To Total - 1
                        strNum1 = strKAJYU(i, 1)
                        strNum2 = strKAJYU(i, 2)
                        WW = max(frmPrint.vsPrt1.TextWidth(strNum1 & "kN/"), frmPrint.vsPrt1.TextWidth(strNum2 & "kN/"))
                        if ( strNum1 != "" ) {
                            RX1D = X(kPoint(i, 1))
                        }
                        if ( strNum2 != "" ) {
                            RX2D = X(kPoint(i, 2))
                        }
                        if ( RX1D * RX2D != 0 $$ strKAJYU(i + 1, 1) = "" ) {
                            if ( Abs(RX2D - RX1D) < WW $$ Abs(RX2D - RX1D) != 0 ) {
                                FLG_横書き = 2
                                Exit For
                            }
                        }
                    }
                    if ( (FLG_横書き = 0) ) { GoTo GRF666 //////////17/08/05
                }
                    For( i = 1 To Total
                        strNum1 = strKAJYU(i, 1)
                        strNum2 = strKAJYU(i, 2)
                            RX1D = X(kPoint(i, 1))
                            RX2D = X(kPoint(i, 2))
                            if ( Abs(RX2D - X(kPoint(i + 1, 1))) < 1 ) {
                                str後Num = strKAJYU(i + 1, 1)
                            } else {
                                str後Num = ""
                            }
                        if ( strNum1 != "" || strNum2 != "" ) { ////////FLG_横書き = 0 ) {
                            RY1D = yyHH1 + (frmPrint.vsPrt1.TextWidth(strNum1) + 330 + 40 / 2)
                            RY2D = yyHH2 + (frmPrint.vsPrt1.TextWidth(strNum2) + 330 + 40 / 2)
                        } else {
                            RY1D = yyHH1 - 30
                            RY2D = yyHH2 - 30
                        }
                        RY3D = RY2D - 200
                        if ( FLG_横書き = 2 ) {
                            RY1D = yyHH1 + 750 + 50
                            RY2D = yyHH1 + 750 + 50
                             if ( strNum1 = strNum2 ) {
                                strNum2 = ""
                             }
                        } else {
                            RY1D = RY1D - 70
                            RY2D = RY2D - 70
                        }

            //                RY1D = RY3D + (frmPrint.vsPrt1.TextWidth(strNum1) + 330)
            //                RY2D = RY3D + (frmPrint.vsPrt1.TextWidth(strNum2) + 330)
                        RX1D = X(kPoint(i, 1))
                        RX2D = X(kPoint(i, 2))
                        if ( (RX2D - RX1D) < 800 $$ Not (i = 1 || i = Total) ) {
                            FLG_999 = 1
                        }
                        if ( i = 1 ) { ////////////////////////////////////////13/04/24
                            if ( strNum1 != strNum2 $$ H水平(0) = 節Y(節点S) $$ H水平(1) = val(strNum1) $$ H水平(2) = Round(RX1D, 3) ) {
                                strNum1 = ""
                                if ( (FLG_横書き = 1 || FLG_縦横 != 0) $$ Total = 1 $$ Abs(RX1D - RX2D) > 600 $$ strNum1 = strNum2 ) {
                                    FLG_横書き = 0
                                    if ( g荷重表記縦 = 0 ) {
                                        gVVITI = s荷重位置 + 0
                                    } else {
                                        gVVITI = s荷重位置 + 3
                                    }
                                }
                            }
                        }
                        if ( i = Total ) {
                            H水平(0) = IIf(荷重方向 = "V", 節Y(節点S), 節Y(節点E))
                            H水平(1) = val(strNum2)
                            H水平(2) = Round(RX2D, 3)
                        }
                        strNum1 = strNum1 & IIf(strNum1 = "", "", strUN & "/m")
                        strNum2 = strNum2 & IIf(strNum2 = "", "", strUN & "/m")
                        str後Num = str後Num & IIf(str後Num = "", "", strUN & "/m")

                        if ( (FLG_横書き = 0 $$ FLG_縦横 = 0) ) { //////if ( FLG_横書き = 0 ) {
                            if ( 部材_max > 40 ) {
                                寸法線位置 = -4.5
                                寸法補助線 = -3
                            } else {
                                寸法線位置 = -7
                                寸法補助線 = -3
                                g荷重表記高 = 130
                            }
                            if ( FLG_Boo ) { //////1/04/25
                                if ( (yiKozo = 3 $$ NKUI = 0 $$ 部材_max > 100) ) { ////////13/12/31
                                    寸法線位置 = -8.5
                                } else {
                                    寸法線位置 = 9
                                    寸法補助線 = 5
                                }
                            }
            //                    GoTo GRF44_
                            if ( strNum1 != strNum2 $$ strKAJYU(i - 1, 1) != strKAJYU(i - 1, 2) || (i = 1 $$ strNum1 != "") ) { //////14/11/28
                                if ( strNum1 != "" ) {
                                    if ( strNum1 != str前Num || (i = Total || strNum1 = str前Num $$ RX1D != X(kPoint(i - 1, 2))) $$ str後Num = "" ) {
                                        WW = frmPrint.vsPrt1.TextWidth(strNum1)
                                        this.MOJ2C("D上*", RX1D - WW / 2 + WW / 8, gVVITI, RX1D + WW / 2 + WW / 8, gVVITI, strNum1)
                                        str前Num = strNum1
                                    }
                                }

                                if ( strNum2 != "" $$ strNum2 != str後Num ) { //////14/11/178
                                    WW = frmPrint.vsPrt1.TextWidth(strNum2)
                                    this.MOJ2C("D上*", RX2D - WW / 2 + WW / 8, gVVITI, RX2D + WW / 2 + WW / 8, gVVITI, strNum2)
                                    str前Num = strNum2
                                }

                            }
                            GoTo GRF44_
                        }
                        if ( strNum1 = strNum2 ) { //////Or (strKAJYU(i - 1, 1) = "" $$ strKAJYU(i - 1, 2) = strKAJYU(i, 1) $$ strKAJYU(i, 2) = "") ) {
                            if ( Abs(RX1D - RX2D) < 500 ) {
            //                        if ( str前前Num != strNum1 || Abs(sgl前前Num - (RX1D + RX2D) / 2) > 1000 ) {
                                    if ( yiKozo = 1 $$ k荷重表記縦 = 0 ) {
                                        if ( FLG_Boo ) { //////1/04/25
                                            RY1D = gVVITI - 150
                                        } else {
                                            RY1D = s荷重位置 + 170
                                        }
                                        RY3D = RY1D
                                        this.MOJ2L("U上", RX1D, RY1D, RX2D, RY3D, strNum1) ////////////////下に表記
                                        sgl前前Num = (RX1D + RX2D) / 2
                                    } else { ////////////////縦に表記
                                        if ( str前前Num != strNum1 || Abs(RX1D - RX2D) < 500 ) {
                                            WW = frmPrint.vsPrt1.TextWidth("1")
                                            DXY = (RX1D + RX2D) / 2 - WW * 1.5
                                            if ( Abs(DXY - 前DXY) < 150 ) {
                                                DXY = 前DXY + WW * 1.5
                                            }
                                            if ( (val(strKAJYU(i, 1)) / Max荷重) < 0.1 ) {
                                                RY1D = RY1D + 200
                                                RY3D = RY3D + 200
                                            }
                                            this.MOJ2L("U上", DXY, RY1D, DXY, RY3D, strNum1)
                                            if ( yiKozo != 1 ) {
                                                k荷重表記縦 = 1 //////13/12/28
                                            }
                                            前DXY = DXY
                                            sgl前前Num = DXY
                                        }
                                    }
            //                        }
                            }
                            str前Num = strNum1
                            str前前Num = strNum1
                        } else {
                            if ( Total = 1 ) {
            //                        if ( Abs(RX1D - RX2D) < 800 ) {
            //                            DXY = RX1D - WW / 4 //////16/07/01  / 4
            //                            if ( strNum1 != "" ) {
            //                            if ( FLG_横書き = 2 ) {
            //                                DXY = RX1D - 220
            //                            }
            //                                this.MOJ2L("U上", DXY, RY1D, DXY, RY3D, strNum1)
            //                            }
            //                            DXY = RX2D + WW / 4 //////16/07/01  / 4
            //                            if ( strNum2 != "" ) {
            //                                if ( FLG_横書き = 2 ) {
            //                                    DXY = RX2D - 10
            //                                }
            //                                this.MOJ2L("U上", DXY, RY2D, DXY, RY3D, strNum2)
            //                            }
            //                        } else {
                                    if ( (RX1D = HEN_X(wXs) $$ wXs = JX_min) ) { //////Or FLG_横書き = 1 ) { //////14/11/20
                                        DXY = RX1D - WW * 2.5
                                        RY1D = RY1D + WW * 6 * 0
                                   } else {
                                        DXY = RX1D + WW
                                        DXY = RX1D - WW / 2
                                    }
                                    if ( strNum1 != "" ) {
                                        if ( FLG_横書き = 2 ) {
                                            DXY = RX1D - 220
                                        }
                                        this.MOJ2L("U上", DXY, RY1D, DXY, RY3D, strNum1)
                                    }
                                    if ( (RX2D = HEN_X(wXe) $$ wXe = JX_max) ) { //////Or FLG_横書き = 1 ) { //////14/11/20
                                        DXY = RX2D + WW * 2 * 0
                                        RY2D = RY2D + WW * 6 * 0
                                    } else {
                                        DXY = RX2D - WW * 2.2
                                    }
                                    if ( strNum2 != "" ) {
                                        if ( FLG_横書き = 2 ) {
                                            DXY = RX2D - 10
                                        }
                                        this.MOJ2L("U上", DXY, RY2D, DXY, RY2D - 200, strNum2)
                                    }
            //                        }
                            } else {
                                if ( i = 1 ) {
                                    if ( strNum1 != "" ) {
                                        if ( Abs(RX1D - RX2D) < 150 ) {
                                            DXY = RX2D - WW * 3
                                        } else {
                                            DXY = RX1D - WW / 2
                                            if ( FLG_888 = 1 ) { //////14/09/17
                                                DXY = DXY - WW * 2
                                            }
                                        }
                                        if ( FLG_横書き = 2 ) {
                                            DXY = RX1D - 220
                                        }
                                        this.MOJ2L("U上", DXY, RY1D, DXY, RY1D - 200, strNum1)
                                        if ( FLG_888 != 1 ) { //////14/09/17
                                            k荷重表記縦 = 1
                                        }
                                        前DXY = DXY
                                    }
                                    if ( strKAJYU(i, 2) = strKAJYU(i + 1, 1) $$ X(kPoint(i, 2)) = X(kPoint(i + 1, 1)) ) {
                                        DXY = RX2D - WW
                                    } else {
                                        if ( Abs(RX1D - RX2D) < 150 ) {
                                            DXY = RX2D - WW * 3
                                        } else {
                                            DXY = RX2D - WW * 2.2
                                        }
                                    }
                                    if ( Abs(DXY - 前DXY) < 150 ) {
                                        DXY = 前DXY + WW * 1.5
                                    }
                                    if ( strNum2 != "" $$ (strKAJYU(i, 2) != strKAJYU(i + 1, 1) || Abs(RX2D - X(kPoint(i + 1, 1))) > 200) ) {
                                        if ( FLG_横書き = 2 ) {
                                            DXY = RX2D - 10
                                        }
                                        this.MOJ2L("U上", DXY, RY2D, DXY, RY2D - 200, strNum2): k荷重表記縦 = 1
                                        前DXY = DXY
                                        str前Num = strNum2
                                    } else {
                                        str前Num = "*"
                                    }
                                } else {if ( i = Total ) {
                                    if ( strNum1 != str前Num || (strNum1 = str前Num $$ RX1D != X(kPoint(i - 1, 2))) ) {
                                        DXY = RX1D - WW / 2
                                        if ( Abs(DXY - 前DXY) < 150 ) {
                                            DXY = 前DXY + WW * 1.5
                                        } else {if ( str前Num = "*" ) {
                                            DXY = DXY - WW
                                        }
                                        if ( FLG_横書き = 2 ) {
                                            DXY = RX1D - 220
                                        }
                                        this.MOJ2L("U上", DXY, RY1D, DXY, RY3D, strNum1): k荷重表記縦 = 1
                                        前DXY = DXY
                                        str前Num = strNum1
                                    }
                                    //
                                    if ( strNum2 != "" ) {
                                        WW = frmPrint.vsPrt1.TextWidth("2") * 1.2
                                        if ( FLG_縦横 = 2 ) {
                                            DXY = RX2D - WW * 2.2 //////15/02/17
                                            if ( (DXY - 前DXY) < WW * 1.5 ) {
                                                DXY = 前DXY + WW * 1.5
                                            }
                                        } else {
                                            DXY = RX2D - WW * 2.2
                                            if ( FLG_888 = 2 ) { //////14/09/17
                                                DXY = DXY + WW * 2
                                            }
                                            if ( Abs(DXY - 前DXY) < 150 ) {
                                                DXY = 前DXY + WW * 1.5
                                            }
                                        }
                                        if ( FLG_横書き = 2 ) {
                                            DXY = RX2D - 10
                                            if ( (DXY - 前DXY) < WW * 1.5 ) {
                                                DXY = 前DXY + WW * 1.5
                                            }
                                        }
                                        this.MOJ2L("U上", DXY, RY2D, DXY, RY2D - 200, strNum2)
                                        if ( FLG_888 != 2 ) {
                                            k荷重表記縦 = 1
                                        }
                                    }
            ////////// 一般的
                                } else {
                                    if ( (strNum1 != "" $$ strNum1 != str前Num) || (strNum1 = str前Num $$ RX1D != X(kPoint(i - 1, 2))) ) {
                                        if ( Abs(RX1D - RX2D) < 200 $$ (X(kPoint(i - 1, 2)) - X(kPoint(i - 1, 1))) > 300 ) {
                                            WW = frmPrint.vsPrt1.TextWidth("2") * 1.2
                                            DXY = RX1D - WW * 1.5
                                        } else {
                                            WW = frmPrint.vsPrt1.TextWidth("2") * 1.2
                                            DXY = (RX1D - WW / 2) //////(RX1D + Ww)
                                        }
            //                                if ( Abs(DXY - 前DXY) < 150 ) {
            //                                    DXY = (前DXY + WW * 1.5)
            //                                }
                                        if ( strNum1 != "" ) {
                                            if ( FLG_横書き = 2 ) {
                                                DXY = RX1D - 220
                                            }
                                            this.MOJ2L("U上", DXY, RY1D, DXY, RY1D - 200, strNum1)
            //                                    if ( strNum2 = "" ) {
                                                前DXY = DXY
                                                str前Num = strNum1
                                                k荷重表記縦 = 1
            //                                    }
                                        }
                                    }
                                        WW = frmPrint.vsPrt1.TextWidth("2") * 1.2
                                        DXY = RX2D - WW * 2.2
                                        if ( Abs(DXY - 前DXY) < 150 ) {
                                            DXY = 前DXY + WW * 1.5
                                        }
                                    if ( strNum2 != "" $$ Not (strNum2 = str後Num $$ Abs(X(kPoint(i + 1, 1)) - X(kPoint(i, 2))) < 1) ) {
                                        if ( (strKAJYU(i, 1) = "" $$ strKAJYU(i + 1, 2) = "") $$ Abs(RX1D - RX2D) > 600 ) {
                                            Ww2 = frmPrint.vsPrt1.TextWidth("1")
                                            DXY = (RX1D + RX2D) / 2 + Ww2 / 5
                                            this.MOJ2L("U上", DXY + 60, RY2D - 200, DXY + Ww2 / 2, RY2D - 200, strNum2)
                                        } else {
                                            DXY = RX2D - WW * 1.8
                                            if ( FLG_横書き = 2 ) {
                                                DXY = RX2D - 10
                                            }
                                            this.MOJ2L("U上", DXY, RY2D, DXY, RY2D - 200, strNum2)
                                        }
                                        前DXY = DXY
                                        str前Num = strNum2
                                        k荷重表記縦 = 1
                                    }
                                }
                            }
                        }
            GRF44_:
                    }
                    g荷重表記縦 = k荷重表記縦
                    if ( g荷重表記縦 = 0 ) {
                        if ( Not (yiKozo = 3 $$ NKUI = 0 $$ 部材_max > 100) ) { ////////13/12/31
                        寸法線位置 = Round(min(13 * (P7 / Max荷重), 5), 2) * Sgn(寸法線位置) //////13/12/28
                        }
                        if ( s側圧数 = 0 $$ 荷重図開き > 0 $$ 水平部材最下端 = wYs $$ wYs = wYe $$ N段数 = 1 $$ FLGMORO ) {
                            寸法線位置 = max(寸法線位置, 7)
                            寸法補助線 = Abs(寸法補助線) * Sgn(寸法線位置)
                        }
                    }
                } else { //////////////////////////////////////////////////////////////////////////////////////////////////////////側壁
            //            str前Num = ""
            //            RY3D = s荷重位置 - (Num文字列数 * WW + 400)
            //            For( i = 1 To Total
            //                strNum1 = strKAJYU(i, 1)
            //                strNum2 = strKAJYU(i, 2)
            //                RY1D = Y(kPoint(i, 1))
            //                RY2D = Y(kPoint(i, 2))
            //                if ( i = 1 ) { ////////////////////////////////////////13/04/24
            //                    if ( V鉛直(0) = 節X(節点S) $$ V鉛直(1) = val(strNum1) $$ Abs(V鉛直(2) - Round(RY1D, 3)) < 0.005 ) {
            //                        strNum1 = ""
            //                    }
            //                }
            //                if ( i = Total ) {
            //                    V鉛直(0) = 節X(節点E)
            //                    V鉛直(1) = val(strNum2)
            //                    V鉛直(2) = Round(RY2D, 3)
            //                }
            //                if ( FLG_側圧9 = 1 ) {
            //                    RX1D = s各側圧位置(i, 1) - (frmPrint.vsPrt1.TextWidth(strNum1) + 330 + 80)
            //                    RX2D = s各側圧位置(i, 2) - (frmPrint.vsPrt1.TextWidth(strNum2) + 330 + 80)
            //                } else {
            //                    RX1D = s各側圧位置(i, 1) + 60
            //                    RX2D = s各側圧位置(i, 2) + 60
            //                }
            //                strNum1 = strNum1 & IIf(strNum1 = "", "", strUN & "/m")
            //                strNum2 = strNum2 & IIf(strNum2 = "", "", strUN & "/m")
            //                Ww1 = frmPrint.vsPrt1.TextWidth(strNum1)
            //                Ww2 = frmPrint.vsPrt1.TextWidth(strNum2)
            //                if ( (FLG_横書き = 0 $$ FLG_縦横 = 0) ) { ////if ( FLG_横書き = 0 ) {
            //                    if ( FLG_側圧9 = 1 ) {
            //                        寸法線位置 = -8
            //                        寸法補助線 = -4
            //                    } else {
            //                        寸法線位置 = 10
            //                        寸法補助線 = 4
            //                    }
            ////                    if ( strNum1 != strNum2 ) {
            //                        if ( strNum1 != "" ) {
            //                            if ( strNum1 != str前Num ) { //////Or (strNum1 = str前Num $$ RX1D != X(kPoint(i - 1, 2))) ) {
            //                                DXY = s各側圧位置(i, 1) + IIf(FLG_側圧9 = 1, -200, 50)
            //                                RY3D = (RY1D + RY2D) / 2
            //                                this.MOJ2L("U上", DXY, RY3D + Ww1 / 2 - Ww1 / 8, DXY, RY3D - Ww1 / 2 - Ww1 / 8, strNum1)
            //                            }
            //                        }
            //                    if ( strNum1 = strNum2 ) { GoTo GRF55_
            //                }
            //                if ( FLG_側圧9 = 1 ) {
            //                    if ( 連続荷重数 = 1 ) {
            //                    寸法線位置 = -(Num文字列数 * 1.8 + 6.5)
            //                    寸法補助線 = -8
            //                    } else {
            //                    寸法線位置 = -(Num文字列数 * 2 + 6.5)
            //                    寸法補助線 = -8
            //                    }
            //                } else {
            //                    if ( 連続荷重数 = 1 ) {
            //                        寸法線位置 = (Num文字列数 * 1.8 + 7)
            //                        寸法補助線 = 8
            //                    } else {
            //                        寸法線位置 = (Num文字列数 * 2 + 7)
            //                        寸法補助線 = 8
            //                    }
            //                }
            //                if ( strNum1 = strNum2 ) {
            ////                    if ( Abs(RX1D - RX2D) < 500 ) {
            //                        RY3D = (RY1D + RY2D) / 2
            //                        this.MOJ2C("D上*", RX1D, RY3D, RX1D + Ww1, RY3D, strNum1): k荷重表記縦 = 1
            //                        前DXY = DXY
            //                        str前Num = strNum1
            ////                    }
            //                } else {
            //                    if ( Total = 1 ) {
            //                        if ( wYs = JY_max || wYs = YY_max ) {
            //                            DXY = RY1D - WW / 8
            //                        } else {
            //                            DXY = RY1D + WW * 2.2
            //                        }
            //                        前DXY = DXY
            //                        if ( strNum1 != "" ) {
            //                            this.MOJ2C("D上*", RX1D, DXY, RX1D + Ww1, DXY, strNum1): k荷重表記縦 = 1
            //                        }
            //                        if ( (wYe = YY_min || wYe = 水平部材最下端) $$ 連続荷重_L2(Total) = 0 ) { //////13/11/15
            //                            DXY = RY2D + WW * 2.2
            //                            if ( FLG_側圧9 = 1 ) { //////13/11/16
            //                                RX2D = RX2D + WW * 2
            //                            }
            //                            if ( FLG_側圧9 = 2 ) {
            //                                RX2D = RX2D - WW
            //                            }
            //                        } else {
            //                            DXY = RY2D - WW / 8
            //                        }
            //                        if ( Abs(DXY - 前DXY) < 150 ) {
            //                            DXY = 前DXY + WW * 1.5
            //                        }
            //                        if ( strNum2 != "" ) {
            //                        this.MOJ2C("D上*", RX2D, DXY, RX2D + Ww2, DXY, strNum2): k荷重表記縦 = 1
            //                        }
            //                    } else {
            //                        if ( i = 1 ) {
            //                            if ( wYs = JY_max || wYs = YY_max ) {
            //                                DXY = RY1D - WW / 8
            //                            } else {
            //                                DXY = RY1D + WW * 2.2
            //                            }
            //                            if ( strNum1 != "" ) {
            //                                this.MOJ2C("D上*", RX1D, DXY, RX1D + Ww1, DXY, strNum1): k荷重表記縦 = 1
            //                                前DXY = DXY
            //                                str前Num = strNum1
            //                            }
            //                            DXY = RY2D - WW / 8
            //                            if ( Abs(DXY - 前DXY) < 150 ) {
            //                                if ( strKAJYU(i, 2) = strKAJYU(i + 1, 1) ) {
            //                                    DXY = RY2D + WW * 2.2
            //                                } else {
            //                                    DXY = 前DXY + WW * 1.5
            //                                }
            //                            }
            //                            if ( (wYe = YY_min || wYe = 水平部材最下端) $$ 連続荷重_L2(i) = 0 ) { //////13/11/15
            //                                DXY = RY2D + WW * 2.2
            //                                if ( FLG_側圧9 = 1 ) { //////13/11/16
            //                                    RX2D = RX2D + WW * 2
            //                                }
            //                                if ( FLG_側圧9 = 2 ) {
            //                                    RX2D = RX2D - WW
            //                                }
            //                            }
            //                            if ( strNum2 != "" ) {
            //                                this.MOJ2C("D上*", RX2D, DXY, RX2D + Ww2, DXY, strNum2): k荷重表記縦 = 1
            //                                前DXY = DXY
            //                                str前Num = strNum2
            //                            }
            //                        } else {if ( i = Total ) {
            //                            if ( strNum1 != str前Num ) {
            //                                DXY = RY1D + WW * 2.2
            //                                if ( Abs(DXY - 前DXY) < 150 ) {
            //                                    DXY = 前DXY + WW * 1.5
            //                                }
            //                                this.MOJ2C("D上*", RX1D, DXY, RX1D + Ww1, DXY, strNum1): k荷重表記縦 = 1
            //                                前DXY = DXY
            //                                str前Num = strNum1
            //                            }
            //                            //
            //                            if ( strNum2 != "" ) {
            //                                DXY = RY2D + WW * 2.2
            //                                if ( Abs(DXY - 前DXY) < 150 ) {
            //                                    DXY = 前DXY + WW * 1.5
            //                                }
            //                                if ( (wYe = YY_min || wYe = 水平部材最下端) $$ 連続荷重_L2(i) = 0 ) { //////13/11/15
            //                                    if ( FLG_側圧9 = 1 ) {
            //                                        RX2D = RX2D + WW * 3
            //                                    } else {if ( FLG_側圧9 = 2 ) {
            //                                        RX2D = RX2D - WW * 2.5
            //                                    }
            //                                }
            //                                this.MOJ2C("D上*", RX2D, DXY, RX2D + Ww2, DXY, strNum2): k荷重表記縦 = 1
            //                            }
            //////////// 一般的
            //                        } else {
            //                            if ( strNum1 != str前Num ) {
            //                                DXY = RY1D + WW * 2.2
            //                                if ( Abs(DXY - 前DXY) < 150 ) {
            //                                    DXY = (前DXY + WW * 1.5)
            //                                }
            //                                if ( strNum1 != "" ) {
            //                                    this.MOJ2C("D上*", RX1D, DXY, RX1D + Ww1, DXY, strNum1): k荷重表記縦 = 1
            //                                    前DXY = DXY
            //                                    str前Num = strNum1
            //                                }
            //                            }
            ////                            if ( strKAJYU(i, 2) = strKAJYU(i + 1, 1) ) {
            ////                                DXY = RY2D - Ww
            ////                            } else {
            ////                                DXY = RY2D - Ww / 8
            ////                            }
            //                            DXY = RY2D - WW / 8
            //                            if ( Abs(DXY - 前DXY) < 150 ) {
            //                                if ( strKAJYU(i, 2) = strKAJYU(i + 1, 1) ) {
            //                                    DXY = RY2D + WW * 2.2
            //                                } else {
            //                                    DXY = 前DXY + WW * 1.5
            //                                }
            //                            }
            ////
            ////                            DXY = RY2D - Ww / 8
            ////                            if ( Abs(DXY - 前DXY) < 150 ) {
            ////                                DXY = 前DXY + Ww * 1.5
            ////                            }
            //                            if ( strNum2 != "" ) {
            //                                this.MOJ2C("D上*", RX2D, DXY, RX2D + Ww2, DXY, strNum2): k荷重表記縦 = 1
            //                                前DXY = DXY
            //                                str前Num = strNum2
            //                            }
            //                        }
            //                    }
            //                }
            GRF55_:
            //            }
            }
            GRF666:
            s荷重位置 = gKAJYUITI
            if ( 水平垂直 = 1 ) {
                yyF6 = max(HEN_X(節X(節点S)), HEN_X(節X(節点E)))
            } else {
                yyF6 = min(HEN_Y(節Y(節点S)), HEN_Y(節Y(節点E)))
            }
                FLG7777 = 1
                if ( yyHH1 = 0 ) {
                    yyF5 = Round((y等分布高 / 56.7) + 4.8, 2)
                    For( i = SS1 To SE2
                       部材正荷重数(i) = yyF5
                    }
                } else {
                    yyF5 = Round(((yyF6 - ((yyHH1 + yyHH2) / 2)) / 56.7) + 5.5 - 0.7 + IIf(s寸法文字2段, 2.3, 0), 2)
                    For( i = SS1 To SE2
                       部材正荷重数(i) = yyF5 + IIf(Mark111 = 1, 0.5, 0)
                    }
                } ////////
                if ( FLG_下引出し = -1 ) { ////////14/12/21
                    For( i = SS1 To SE2
                       部材負荷重数(i) = 部材負荷重数(i) + 10.3
                    }
                }
            //        GoTo GRF777
            //GRF777:
                                                            */
        }

        private void 部材連続寸法_0(object obj, int 連続荷重数, int 節点S, int 節点E,
                                    double 荷重図開き, string 荷重方向5, int[] 連続荷重mark, double[] 連続荷重_L1, double[] 連続荷重_L2, double[] 連続荷重_P1, double[] 連続荷重_P2,
                                    string dhosei, int SS1, int SE2, bool Mark_Flg, int CASU, int yBuzaiFF, int[] yGGGGG)
        {
            /*/
            var 寸法補助線
            var BSPAN
            var BX0
            var BY0
            var BXE
            var BYE
            var 図BSPAN
            var 図倍率
            var BSN
            var BCS
            var BTAN
            var B角度
            var XX1
            var XX2
            var XX3
            var YY1
            var Yy2
            var YY3
            var PX0
            var PY0
            var PXE
            var PYE
            var PX1D
            var PY1D
            var PX2D
            var PY2D
            var PX3D
            var PY3D
            var 寸法(100) //////09/10/25
            double var X(100)
            double var Y(100)
            var i                       As Integer
            var j                       As Integer
            double var GGII
            double var GGjj
            var HIH                       As Integer
            var XL2
            var NN                      As Integer
            var HV                      As Integer
            var HV5                     As Integer
            var N55                     As Integer
            var XL(100)                 As Single
            var CNum As Integer
            var GHOSEI As Single
            var UUUU As Integer, PPPP As Single
            var Flg3 As Integer //////////////////////////////////////////////////07/07/26
            var AALL As Single ////////////08/07/02
            var J4 As Integer ////////08/07/08
            var J5 As Single ////////08/09/26
            var J6 As Single ////////08/09/26
            var P6 As Single ////////08/09/26
            var J7 As Single ////////08/09/26
            var P7 As Single ////////08/09/26
            var P8 As Single ////////////////////////////09/11/199
            var J8 As Single ////////08/09/26
            var J9 As Single, J10 As Single //////////////////08/10/095
            var yFR橋脚 As Integer
            var yiKozo As Integer
            var 寸法線位置 //////////////////////////////08/10/29
            var wXs As Single, wXe As Single, wYs As Single, wYe As Single //////09/09/300
            var f寸法FLG As Integer //////09/08/14
            var s寸法文字2段 As Boolean ////////////////09/10/20
            var s斜めFLG As Integer //////09/10/24
            var Max荷重 As Single //////09/10/299
            var MK5 As Integer //////09/11/09
            var m調整高 As Single //////10/11/11
            var FLG杭杭 As Boolean //////////////////////////////////11/12/166
            var 鉛直文字列 As String //////////////09/11/16
            鉛直文字列 = "1"
            //
            FLG杭杭 = False //////////////11/12/166
            if ( InStr(部材名(SS部材), "杭") != 0 ) {
                FLG杭杭 = True
            }
            if ( FLG杭杭 = False ) {
                if ( yBuzaiFF > 0 ) { ////////12/12/15
                    For( j = 1 To yBuzaiFF
                        i = yGGGGG(j)
                        if ( InStr(部材名(i), "杭") = 1 ) {
                            FLG杭杭 = True
                            Exit For
                        }
                    }
                } else {
                    For( i = SS1 To SE2
                        if ( InStr(部材名(i), "杭") = 1 ) {
                           FLG杭杭 = True
                           Exit For
                        }
                    }
                }
            }
            if ( FLG杭杭 = True $$ 連続荷重mark(1) = 6 ) { //////12/02/15
                s斜めFLG = 0
                For( i = 1 To 連続荷重数
                    if ( 連続荷重_L1(i) != 0 || 連続荷重_L2(i) != 0 ) {
                        s斜めFLG = 1
                        Exit For
                    }
                }
                if ( s斜めFLG = 0 ) {
                    GoTo ABC //////return;
                }
            }
            if ( Flg_PRESTRES(1) = 1 || Flg_PRESTRES(2) = 1 ) { //////12/02/15
                GoTo ABC //////return;
            }
            s斜めFLG = 0 //////09/10/24
            f寸法FLG = 0
            m調整高 = 0 //////////////10/11/11
            yFR橋脚 = FR橋脚
            yiKozo = iKozo
            //
            if ( Not (yiKozo = 3 $$ g連続Mod) ) {
                    yiKozo = 1 ////////10/01/24 12/12/15
            }
                    yFR橋脚 = 1
            //
            BSPAN = 部材Span(節点S, 節点E)
            ////////09/09/300
            var ii As Integer, i7 As Integer, i8 As Integer //////09/10/14
            wXs = 節X(節点S)
            wXe = 節X(節点E)
            wYs = 節Y(節点S)
            wYe = 節Y(節点E)
            var 荷重方向
            荷重方向 = 荷重方向5 ////////09/10/20
            if ( wYs = wYe $$ (荷重方向 = "V" || 荷重方向 = "M") $$ yBuzaiFF = 0 ) {
                荷重方向 = ""
            }
            if ( SS1 = SE2 $$ 荷重方向 = "H" $$ 連続荷重mark(1) = 2 ) { //////////09/10/24
                s斜めFLG = 2
            }
            ////////////////////////////////////////////////////////////////////////////////09/10/24
            //////10/03/07
            if ( (Abs(SE2 - SS1) > 1 || yBuzaiFF > 0) $$ _
                                (荷重方向 = "V" || 荷重方向 = "M") ) { ////////09/09/301
                if ( 荷重方向 = "V" $$ 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) + 連続荷重_P2(1) < 0 ) {
                    PPPP = min(wYs, wYe)
                    if ( yBuzaiFF > 0 ) { //////////////////09/10/14
                        For( i8 = 1 To yBuzaiFF
                            i7 = yGGGGG(i8)
                            J4 = 部I(i7): PPPP = min(PPPP, 節Y(J4))
                            J4 = 部J(i7): PPPP = min(PPPP, 節Y(J4))
                        }8
                    } else {
                        For( i7 = SS1 To SE2
                            J4 = 部I(i7): PPPP = min(PPPP, 節Y(J4))
                            J4 = 部J(i7): PPPP = min(PPPP, 節Y(J4))
                        }7
                    }
                } else {
                    PPPP = max(wYs, wYe)
                    if ( yBuzaiFF > 0 ) { //////////////////09/10/14
                        For( i8 = 1 To yBuzaiFF
                            i7 = yGGGGG(i8)
                            J4 = 部I(i7): PPPP = max(PPPP, 節Y(J4))
                            J4 = 部J(i7): PPPP = max(PPPP, 節Y(J4))
                        }8
                    } else {
                        For( i7 = SS1 To SE2
                            J4 = 部I(i7): PPPP = max(PPPP, 節Y(J4))
                            J4 = 部J(i7): PPPP = max(PPPP, 節Y(J4))
                        }7
                    }
                }
                wYs = PPPP
                wYe = PPPP
            }
            BX0 = 図X(wXs)
            BY0 = 図Y(wYs)
            BXE = 図X(wXe)
            BYE = 図Y(wYe)
            ////////09/09/300
            水平垂直 = 9 //////////////////////////08/07/02
            if ( BX0 = BXE ) {
                水平垂直 = 1 // 垂直
                AALL = 図Y_SCALE
            }
            if ( BY0 = BYE ) {
                水平垂直 = 0 // 水平
                AALL = 図X_SCALE
            }
            if ( BX0 != BXE ) {
                if ( (Abs(BY0 - BYE) / Abs(BX0 - BXE)) < 0.05 ) { ////////10/10/13
                    水平垂直 = 0 // 水平
                    AALL = 図X_SCALE
                }
            }

            //    if ( 水平垂直 = 9 $$ 荷重方向 = "H" $$ Mark111 = 2 ) { //////09/08/23
            //    For( i = 1 To 連続荷重数
            //        連続荷重_P1(i) = 連続荷重_P1(i) * (-1)
            //        連続荷重_P2(i) = 連続荷重_P2(i) * (-1)
            //    }
            //    }
            if ( dhosei = "" || dhosei = 0 ) { ////////08/10/29
                GHOSEI = hosei
            } else {
                GHOSEI = dhosei //////////hosei////////08/10/29
            }
            if ( g荷重連寸法補正 = 1 ) { //////////////////////////////07/01/17
                GHOSEI = GHOSEI + 3.5
                g荷重連寸法補正 = 0
            }
            if ( BX0 != BXE $$ (節Y0(節点S) + 節Y0(節点E)) / 2 > (YY_max * 0.8) ) { ////////////07/01/177
                g荷重連寸法回数 = g荷重連寸法回数 + 1 ////////////07/01/177
            }
            if ( (水平垂直 = 1 $$ iKozo = 3 $$ 連続荷重数 = 1 $$ 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) != 連続荷重_P2(1)) ) {
                g荷重表記縦 = 1 //////13/02/01
            }
            ////////////////////////////07/11/03
            j = 0
            J4 = 0: J5 = 0: J6 = 0: J7 = 0: P6 = 0: J7 = 0 ////////08/09/26
            J8 = 0: J9 = 0: J10 = 0 ////////08/10/095
            P6 = 0: P7 = 0: P8 = 0 //////09/11/199
            MK5 = 0 //////09/11/09
            For( i = 1 To 連続荷重数
                if ( 連続荷重mark(i) = 1 ) { ////////09/11/16//////Or 連続荷重mark(i) = 11 ) {
                    j = j + 1
                ////////////////////////////////////////09/11/16
                    if ( Len(鉛直文字列) < Len(Format(連続荷重_P1(i), "0.00")) ) { 鉛直文字列 = Format(連続荷重_P1(i), "0.00")
                    if ( Len(鉛直文字列) < Len(Format(連続荷重_P2(i), "0.00")) ) { 鉛直文字列 = Format(連続荷重_P2(i), "0.00")
            //                Exit For
                }
                if ( 連続荷重mark(i) = 4 ) { ////////08/07/08
                  J4 = J4 + 1
                }
                if ( 連続荷重mark(i) = 5 || 連続荷重mark(i) = 11 ) { ////////09/11/16
                  MK5 = MK5 + 1
                }
                ////////////////////////////////////////////////////////////////////////////////////////////////////
                if ( (連続荷重_P1(i) >= 0 || 連続荷重_P2(i) >= 0) ) { //////08/09/26
                    if ( 連続荷重mark(i) = 1 ) {
                        J5 = 1
                        P6 = max(P6, 連続荷重_P1(i))
                        P6 = max(P6, 連続荷重_P2(i))
                   } //////////////////////////////////////////////////////////////////////////////////////////////////////////////!= 09/12/02
                    if ( 連続荷重mark(i) = 2 $$ (連続荷重_P1(i) * 連続荷重_P2(i) != 0 $$ 連続荷重_P1(i) != 連続荷重_P2(i)) ) {
                        J6 = 1
            //                g荷重表記縦 = 1 ////////08/11/28//////09/03/10 コメントにした
                    }
                    if ( 連続荷重mark(i) = 2 $$ (連続荷重_P1(i) * 連続荷重_P2(i) = 0 || 連続荷重_P1(i) = 連続荷重_P2(i)) ) {
                        J7 = J7 + 1
                    }
                    if ( 連続荷重mark(i) = 2 $$ 連続荷重_P1(i) = 連続荷重_P2(i) ) { //////08/10/09
                        J9 = J9 + 1 //////08/10/09
                    }
                    if ( 連続荷重mark(i) = 2 $$ 連続荷重_P1(i) * 連続荷重_P2(i) = 0 ) { //////08/10/09
                        J10 = J10 + 1 //////08/10/09
                    }
                    if ( (連続荷重mark(i) = 4 $$ 連続荷重_P1(i) = 連続荷重_P2(i)) _
                        || (連続荷重mark(i) = 3 $$ 連続荷重_P1(i) * 連続荷重_P2(i) = 0) ) { //////////08/10/09
                        J8 = J8 + 1
                    }
                    if ( 連続荷重mark(i) = 2 || 連続荷重mark(i) = 4 || 連続荷重mark(i) = 3 ) { //////////08/10/09
                        P6 = max(P6, Abs(連続荷重_P1(i))) ////08/10/29
                        P6 = max(P6, Abs(連続荷重_P2(i))) ////08/10/29
                    }
                }
                if ( g荷重表記縦 = 0 || (g荷重表記縦 = 1 $$ 連続荷重_P1(i) != 連続荷重_P2(i)) || 連続荷重mark(i) = 1 ) {  //////08/11/17
                    P7 = max(P7, Abs(連続荷重_P1(i))) ////08/10/29
                    P7 = max(P7, Abs(連続荷重_P2(i))) ////08/10/29
                }
            } ////////////////////////////07/11/03
            //
            var Mark111 As Integer
            //
            if ( J5 = 1 ) { ////////////////////////////////09/11/13
                g荷重表記高 = 0
                Mark111 = 1
            } else {
                if ( g荷重表記縦 = 1 ) {
                    For( i = 1 To 連続荷重数 //////09/11/199
                        if ( (連続荷重mark(i) = 2 || 連続荷重mark(i) = 4) $$ _
                            (連続荷重_P1(i) * 連続荷重_P2(i) = 0 || 連続荷重_P1(i) != 連続荷重_P2(i)) ) {
            //                    if ( P7 != Abs(連続荷重_P1(i)) ) { P8 = max(P8, Abs(連続荷重_P1(i))) //////09/11/199
            //                    if ( P7 != Abs(連続荷重_P2(i)) ) { P8 = max(P8, Abs(連続荷重_P2(i)))
                            P8 = max(P8, Abs(連続荷重_P1(i))) //////09/11/30
                            P8 = max(P8, Abs(連続荷重_P2(i)))
                        }
                    }
                    if ( P8 != 0 ) {
                        P7 = P8
                    }
                    if ( g荷重表記高 < g荷重表記高5 / 1.5 ) {
                        g荷重表記高 = g荷重表記高5 / 1.5
                    } //////09/11/199
                } else {
                    if ( 水平垂直 = 0 $$ g荷重表記高5 > 180 ) { //////10/01/03
                        g荷重表記高5 = 180
                    }
                    g荷重表記高 = g荷重表記高5
                }
                if ( (MK5 != 0 $$ MK5 = 連続荷重数) ) {
                    Mark111 = 5
                } else {
                    Mark111 = 連続荷重mark(1)
                }
            }
            //////////////////////////////////////////////////////////////
            if ( Mark111 = 6 ) { //////////////////////12/02/15
                if ( 連続荷重数 = 1 ) {
                    if ( 連続荷重_L1(1) = 0 $$ 連続荷重_L2(1) = 0 ) {
                        GoTo ABC //////return;
                    }
                    if ( InStr(部材名(SS部材), "柱") != 0 ) { //////////////////12/02/15
                        if ( 節X(節点S) != g柱X座標(g柱本数, 1) ) {
                            GoTo ABC //////return;
                        }
                    }
                } else {if ( InStr(部材名(SS部材), "杭") != 0 ) { //////////////////12/02/15
                    荷重図開き = Abs(荷重図開き) //////136
                    KUIDAN = 0
            //            Mark111 = 2
            //            For( i = 1 To 連続荷重数
            //                連続荷重mark(i) = 2
            //            }
                }
            }
            Max荷重 = BU荷重MAX //////////////////////////////////////09/10/299
            if ( J5 = 1 || Mark111 = 5 ) { //////08/09/26//////09/11/09
                J6 = 0
                J7 = 0
                J8 = 0
                J9 = 0 //////08/10/09
                J5 = IIf(yFR橋脚 = 1, -0.7, 1)
                GHOSEI = 0
                Max荷重 = BP荷重MAX ////////////////09/10/299
                if ( Max荷重 = 0 ) { Max荷重 = P7 ////////////09/11/30
            } else {
                if ( J10 = 連続荷重数 ) {
                    J6 = 1 //////08/10/095
                    J7 = 0 //////08/10/096
                }
                if ( J6 = 1 ) {
                    if ( (P6 / Max荷重) < 0.7 ) {
                        if ( J10 = 連続荷重数 ) { //////08/10/096
                            J6 = 0
                        } else {
            //                    J6 = min(1 / (P6 / Max荷重), 3) //////////09/04/06
                            J6 = 0.3 //////////09/04/06
                        }
                    } else {if ( (P6 / Max荷重) > 0.9 ) {
                        if ( yFR橋脚 = 1 ) {
                            if ( 部材正荷重数(SS1) < 20 ) {
                                J6 = -1.5
                            } else {
                                J6 = -2.2
                            }
                        } else {
                            J6 = 2.5
                        }
                    } else {
                        J6 = -0.5
                    }
                    if ( yiKozo = 3 || g連続Mod ) {
                        J6 = -1.5
                    }
                }
            }
            if ( J7 = 連続荷重数 ) { J7 = 1 } else { J7 = 0
            if ( J9 = 連続荷重数 ) { J9 = 1 } else { J9 = 0 //////08/10/09
            if ( J8 = 連続荷重数 ) {
                if ( ((P6 / Max荷重) ^ 0.7) < 0.6 ) { //////08/10/09
                    J8 = 1.5
                } else {if ( (P6 / Max荷重) > 0.95 ) {
                    J8 = 1.3
                } else {
                    J8 = Round((Max荷重 / P6) ^ 0.5, 1) //////1//////08/10/29
                }
            } else {
                J8 = 0
            }
            //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////08/09/26
            //    if ( (Mark111 = 1 || Mark111 = 11) ) {
            if ( j != 0 ) {
                if ( FLG記号 = 1 ) { ////////////////07/05/13
                    GHOSEI = GHOSEI + IIf(j = 連続荷重数, 0.5, 1) //////+ 3
                }
            } else {
                if ( g連続Mod ) {
                    j = 2 ////////////////////06/12/14
                    GHOSEI = max(GHOSEI, 0) ////////////////////連続梁 05/02/06
                        For( i = 1 To 連続荷重数
                              if ( (連続荷重mark(i) = 2 || 連続荷重mark(i) = 3 || 連続荷重mark(i) = 4) $$ _
                                 (連続荷重_P1(i) != 連続荷重_P2(i)) $$ ((連続荷重_L2(i) - 連続荷重_L1(i)) * AALL * Twip) < 0.5 ) {
                                    j = 0
                                    Exit For
                              }
                        }
                        if ( FLG記号 = 1 ) { ////////////////07/05/13
                            if ( j = 0 ) {
                                GHOSEI = GHOSEI + 5.5
                            }
                        }
                } else {
                    if ( yFR橋脚 = 2 ) {
                        GHOSEI = max(GHOSEI, 0) ////////////////////////////// 05/09/20
                    } else {
                        j = 2 ////////////////////06/12/14
                        For( i = 1 To 連続荷重数
                              if ( 連続荷重mark(i) != 2 ) { j = 0
                        }
                    if ( j = 2 ) { // if ( 連続荷重mark(1) = 2 ) {
                        UUUU = 0: PPPP = 0 ////////////////////06/12/14
                        For( i = 1 To 連続荷重数
                              if ( (連続荷重_P1(i) != 連続荷重_P2(i)) ) { UUUU = 1
                              PPPP = max(PPPP, Abs(連続荷重_P1(i)))
                              PPPP = max(PPPP, Abs(連続荷重_P2(i)))
                        }
            //                if ( (連続荷重mark(1) = 2 || 連続荷重mark(1) = 3) ) {
            //                    gHosei = -荷重寸法線位置(1) * (1 - (Abs(max(Abs(連続荷重_P1(1)), Abs(連続荷重_P2(1)))) / Max荷重) ^ 0.25) ////// 06/02/23

            //                    gHosei = gHosei / 3
            //                    if ( gHosei < -1.5 ) { ////////////06/04/06
            //                    gHosei = -1.2
            //                    }
                            if ( (Mark111 = 2 $$ GHOSEI < -2) || (Mark111 = 3 $$ GHOSEI > -2) ) {
                                if ( (Mark111 = 2 $$ GHOSEI < -2) ) { //////08/06/17
                                    GHOSEI = 2.5 //////08/06/17
                                } else {
                                    GHOSEI = -荷重寸法線位置(1) * (1 - (PPPP / Max荷重) ^ 0.25) ////// 06/02/23
                                }
                            } else {
                                GHOSEI = GHOSEI / 2.5
                            }
                            if ( UUUU = 0 ) { ////////////////////////////////////////////////////////////06/12/14
                                if ( ((PPPP / Max荷重) ^ 0.5) > 0.8 ) {
                                    GHOSEI = max(GHOSEI, 2.5)
                                } else {
                                    GHOSEI = max(GHOSEI, 1)
                                }
                            } else {
                                GHOSEI = GHOSEI + IIf(((PPPP / Max荷重) ^ 0.5) > 0.8, 1.5, 0)
                                GHOSEI = GHOSEI + ((PPPP / Max荷重) ^ 0.6) * 1.3 ////////////////06/12/14
                                if ( GHOSEI < hosei ) {
                                    GHOSEI = max(hosei, 9)
                                }
                            }
                            if ( GHOSEI < -5 ) { ////////////06/09/06
                                GHOSEI = -5
                                if ( FLG記号 = 1 ) { ////////////// ////////08/06/17
                                    GHOSEI = GHOSEI + 5.5
                                }
                            } else {if ( GHOSEI > -0.8 $$ Mark111 = 3 ) { ////////////06/09/06
                                GHOSEI = -1
                                if ( FLG記号 = 1 ) { ////////////// ////////08/06/17
                                    GHOSEI = GHOSEI + 5.5
                                }
                            }
                            if ( BX0 = BXE ) { //////////////08/06/17
                                GHOSEI = GHOSEI + 4
                            }
                        } else { ////// 05/09/20
                            GHOSEI = 0
                        }
            //                }
                    }
                }
            }
            ////////////////////////////////////////////////////////////////////////// 05/02/05
            CNum = 0
            if ( yiKozo = 1 ) {
            i = 節点S
            Do
                        GGII = i
                        GGjj = (i + 1)
                        if ( GGII * GGjj = 0 || GGII > 1000 ) { Exit Do ////////05/04/26
                        j = 0
                        HIH = 0
                        Do
                            j = j + 1
                            if ( j > 部材_max ) { Exit Do
                            if ( GGII = 部I(j) $$ GGjj = 部J(j) ) {
                                HIH = j
                                Exit Do
                            }
                        Loop
                        if ( HIH > 0 ) {
                            if ( ZFAngle(HIH) = 0 $$ 部材正荷重数(HIH) > 20 ) {
                                CNum = 1
                                Exit Do
                            }
                        }
                i = i + 1
                if ( i = 節点E ) { Exit Do
             Loop
                if ( CNum = 0 $$ g連続Mod ) {
                GHOSEI = max(GHOSEI, 8) ////////////////////連続梁 05/02/06
                }
            }
            //    if ( g荷重表記縦 = 1 ) { gHosei = 0 //////09/04/02
            //
            Select Case 荷重方向
            Case "V", "M", "S"
                BSPAN = Round(Abs(節X0(節点S) - 節X0(節点E)), 3)
                BY0 = max(BY0, BYE)
                BYE = BY0
            Case "H"
                BSPAN = Round(Abs(節Y0(節点S) - 節Y0(節点E)), 3)
                if ( (節X0(節点S) + 節X0(節点E)) / 2 < (JX_max + JX_min) / 2 ) { ////////////07/01/08
                    if ( s斜めFLG = 0 ) {
                    BX0 = min(BX0, BXE)
                    } else {
                    BX0 = min(BX0, BXE)
                    }
                } else {
                    if ( s斜めFLG = 0 ) {
                    BX0 = max(BX0, BXE)
                    } else {
                    BX0 = max(BX0, BXE)
                    }
                }
                BXE = BX0
            Case } else {
            End Select
            図BSPAN = Sqr((BXE - BX0) ^ 2 + (BYE - BY0) ^ 2)
            if ( 図BSPAN <= 0 ) {
                図BSPAN = 1
            }
            if ( BSPAN <= 0 ) {
                BSPAN = 1
            }
            図倍率 = 図BSPAN / BSPAN
            BSN = (BYE - BY0) / 図BSPAN
            BCS = (BXE - BX0) / 図BSPAN
            if ( 荷重方向 = "V" ) { //////And 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) + 連続荷重_P2(1) > 0 ) { //////10/03/07
            //        BCS = Abs(BCS)
            }
            //    水平垂直 = 9////////////////////////////////////////08/07/02
            //    if ( BX0 = BXE ) {
            //        水平垂直 = 1 // 垂直
            //    }
            //    if ( BY0 = BYE ) {
            //        水平垂直 = 0 // 水平
            //    }
            BTAN = 0
            if ( BX0 != BXE ) {
                BTAN = (BYE - BY0) / (BXE - BX0)
            }
            B角度 = 180 * Atn(BTAN) / π
            if ( BX0 > BXE ) {
                B角度 = B角度 + 180
            }
            if ( BX0 = BXE ) {
                B角度 = 90
            }
            if ( BYE < BY0 ) {
                B角度 = 270
            }
            //
            Flg3 = 0
            Select Case 荷重方向 ////////////////////07/01/08
            Case "V", "M", "S"
                    PX0 = HEN_X(wXs) - 荷重図開き * BSN
                    PY0 = min(HEN_Y(wYs), HEN_Y(wYe)) - 荷重図開き * Abs(BCS) ////////////07/01/09
            Case "H"
                if ( (節X0(節点S) + 節X0(節点E)) / 2 < (JX_max + JX_min) / 2 ) { ////////////07/01/08
                    if ( 連続荷重_P1(1) + 連続荷重_P2(1) > 0 $$ s斜めFLG = 0 ) { ////////09/10/24
                        PX0 = min(HEN_X(wXs), HEN_X(wXe)) - 荷重図開き * BSN * 1 ////////09/10/24
                    } else {
                        if ( s斜めFLG = 0 ) {
                            PX0 = min(HEN_X(wXs), HEN_X(wXe)) - 荷重図開き * BSN * 13 ////////09/08/24
                        } else {
                            PX0 = min(HEN_X(wXs), HEN_X(wXe)) - Abs(荷重図開き * BSN) * 10 ////////09/08/24
                            Flg3 = 1
                        }
                    }
                    PY0 = HEN_Y(wYs) - 荷重図開き * BCS
                } else {
                    if ( 連続荷重_P1(1) + 連続荷重_P2(1) > 0 $$ s斜めFLG = 0 ) { ////////09/10/24
                    PX0 = min(HEN_X(wXs), HEN_X(wXe)) // + 荷重図開き * BSN * 0.3
                    } else {
                        PX0 = max(HEN_X(wXs), HEN_X(wXe)) - 荷重図開き * BSN * IIf(s斜めFLG = 0, 0, 10) ////////09/10/24
                        if ( s斜めFLG != 0 ) {
                            Flg3 = 1 ////////////07/07/26//////////////////////////////09/10/24 コメントにした
                        }
                    }
                    PY0 = HEN_Y(wYs) - 荷重図開き * BCS
                }
            Case } else {
                PX0 = HEN_X(wXs) - 荷重図開き * BSN
                if ( yiKozo = 1 $$ 水平垂直 = 0 $$ N段数 = 1 $$ 連続荷重数 = 1 $$ _
                   Abs(YY_max - wYs) > (YY_max - YY_min) / 5 ) { //////////////////////////////////07/06/177
                    PY0 = HEN_Y(wYs) + 荷重図開き * BCS
                } else {
                    if ( 連続荷重数 = 1 $$ Mark111 = 11 $$ _
                                Abs(YY_max - wYs) <= (YY_max - YY_min) / 10 ) { //////08/06/16
                        PY0 = HEN_Y(wYs) + 荷重図開き * BCS
                    } else {
                        PY0 = HEN_Y(wYs) - 荷重図開き * BCS
                    }
                }
            //        PX0 = (HEN_X(wXs) + HEN_X(wXe)) / 2 - 荷重図開き * BSN //////////////////07/01/077
            //        PY0 = (HEN_Y(wYs) + HEN_Y(wYe)) / 2 - 荷重図開き * BCS
            End Select
            //
            //////////////////////////////////////////06/01/29
            UUUU = 0: PPPP = 0
            For( i = 1 To 連続荷重数
                if ( 連続荷重mark(i) = 2 $$ 連続荷重_P1(i) = 連続荷重_P2(i) ) {
                    PPPP = max(PPPP, Abs(連続荷重_P1(i)))
                } else {
                    UUUU = 1
            //            Exit For////////09/04/02
                }
            }
            //////////////////////////////////////////06/01/29
            XL(1) = 0
            NN = 1
            集中有無 = 0
            HV = 0
            HV5 = 0
            N55 = 1
            j = 0
            //
            For( i = 1 To 連続荷重数
                if ( 連続荷重_L1(i) - XL(NN) > 0.001 ) {
                    NN = NN + 1
                    XL(NN) = 連続荷重_L1(i)
                }
                if ( s斜めFLG = 2 ) { ////////09/10/24
                    連続荷重_P1(i) = Abs(連続荷重_P1(i))
                    連続荷重_P2(i) = Abs(連続荷重_P2(i))
                }
                Select Case 連続荷重mark(i)
                Case 1, 5, 11
            //            if ( 連続荷重_P2(I) != 0 ) {
                        if ( Not (連続荷重_P2(i) = 0 $$ 連続荷重_L2(i) = 0) ) { ////////if ( 連続荷重_P2(I) != 0  07/06/11
                        if ( 連続荷重_L2(i) != XL(NN) ) { //////////10/01/03
                            XL2 = Round(連続荷重_L2(i), 3)
                            NN = NN + 1
                            XL(NN) = XL2
                        }
                        }
                        if ( 連続荷重mark(i) != 5 ) {
                            集中有無 = 1
                        }
                Case 2, 4, 6, 7
                        if ( 連続荷重_L2(i) != 0 ) {
                            XL2 = Round(BSPAN - 連続荷重_L2(i), 3)
                            NN = NN + 1
                            XL(NN) = XL2
                        }
                        if ( 連続荷重_P1(i) != 連続荷重_P2(i) $$ 連続荷重_P1(i) != 0 $$ 連続荷重_P2(i) != 0 ) {
                            HV = 1
                            HV5 = 1
                        }
                Case 3
                    XL2 = Round(連続荷重_L1(i) + (BSPAN - 連続荷重_L1(i) - 連続荷重_L2(i)) / 2, 3)
                    NN = NN + 1
                    XL(NN) = XL2
                    if ( 連続荷重_L2(i) != 0 ) {
                        XL2 = Round(BSPAN - 連続荷重_L2(i), 3)
                        NN = NN + 1
                        XL(NN) = XL2
                    }
                Case } else {
                    if ( 連続荷重_L2(i) != 0 ) {
                        XL2 = Round(BSPAN - 連続荷重_L2(i), 3)
                        NN = NN + 1
                        XL(NN) = XL2
                    }
                End Select
            }

            if ( 連続荷重数 = 1 $$ 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) + 連続荷重_P2(1) = 0 $$ _
                                                          連続荷重_L1(1) + 連続荷重_L2(1) = 0 ) {
                NN = NN + 1
                XL(NN) = BSPAN / 2 ////////12/11/27 逆対称の分布荷重

            } else {if ( XL2 != BSPAN ) { //////12/12/15
            //        j = 0
            //        if ( 水平垂直 = 1 || 連続荷重mark(1) = 1 || 連続荷重mark(1) = 5 || 連続荷重mark(1) = 11 ) { j = 1
            //        if ( (水平部材最下端 = (wYs + wYe) / 2 || YY_max = (wYs + wYe) / 2) ) {
            //            if ( XL(NN) < BSPAN ) { j = 1
            //        }
                if ( XL(NN) < BSPAN ) {
                    NN = NN + 1
                    XL(NN) = BSPAN //////12/12/15
                }
            }
                    //////////////////////////////08/07/06
            if ( iKozo = 1 $$ 連続荷重数 = 1 $$ NN <= 2 $$ 連続荷重mark(1) = 2 $$ wYs = wYe $$ _
                        (Abs((YY_max + YY_min) / 2 - wYs) < 1 || _
                        (Abs(水平部材最下端 - wYs) < 1 $$ 連続荷重_P1(1) + 連続荷重_P2(1) > 0)) ) {
                GoTo GRF777 ////////////13/04/08
            }

            N55 = 1
            j = 0
            For( i = 1 To 連続荷重数
                if ( 連続荷重_L1(i) - XL(N55) > 0.001 ) {
                    N55 = N55 + 1
                }
                Select Case 連続荷重mark(i)
                Case 1, 5, 11
                    if ( Not (連続荷重_P2(i) = 0 $$ 連続荷重_L2(i) = 0) ) {
                        N55 = N55 + 1
                    }
                    if ( 連続荷重mark(i) != 5 ) {
                        j = 1
                    }
                Case 2, 6, 7
                    if ( 連続荷重_L2(i) != 0 ) {
                        N55 = N55 + 1
                    }
                    if ( i = 連続荷重数 ) {
                        AALL = (XL(N55) - XL(N55 - 1))
                    } else {
                        AALL = (XL(N55 + 1) - XL(N55))
                    }
                    if ( 連続荷重mark(i) = 2 $$ (連続荷重_P1(i) != 連続荷重_P2(i)) ) {
                        if ( (yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) ) {
            //                    j = 2 //////08/10/29
                        }
                    }
                Case 3
                    N55 = N55 + 1
                    if ( 連続荷重_L2(i) != 0 ) {
                        N55 = N55 + 1
                    }
                    if ( (max(Abs(連続荷重_P1(i)), Abs(連続荷重_P2(i))) / Max荷重) < 0.2 ) { //////09/11/09
                        j = 3
                    }
                Case 4
                    N55 = N55 + 1
                    if ( (max(Abs(連続荷重_P1(i)), Abs(連続荷重_P2(i))) / Max荷重) < 0.2 ) { //////09/11/09
                        j = 4
                    }
                Case } else {
                    if ( 連続荷重_L2(i) != 0 ) {
                        N55 = N55 + 1
                    }
                End Select
            }
            if ( 集中有無 != 1 $$ J7 = 0 ) {
                GHOSEI = 1.5 + 1
                if ( j = 2 ) {
                    GHOSEI = 9.5 * (P6 / Max荷重)
                }
            }
            //////////////////////////////08/07/06
            //
            var gY55 As Single, GOUKEI As Single, J55 As Single, J88 As Single
            if ( (Mark111 = 2 || Mark111 = 3 || Mark111 = 4) ) {
                if ( ((P7 / Max荷重) ^ 1.2) < 0.3 ) {
                    P7 = Round(0.35 * Max荷重, 1)
                    P6 = P7 //////09/11/13
                    if ( ((P7 / Max荷重) ^ 1.2) < 0.2 ) {
                        P7 = Round(0.2 * Max荷重, 1)
                        P6 = P7 //////09/11/13
                    } else {if ( ((P7 / Max荷重) ^ 1.2) < 0.15 ) {
                        P7 = Round(0.12 * Max荷重, 1)
                        P6 = P7 //////09/11/13
                    }
                    GHOSEI = 0
                    hosei = 0
                } else {if ( (P7 / Max荷重) > 0.8 ) {
                    P7 = Max荷重
            //            gHosei = 0
            //            hosei = 0
                    J6 = -0.5
                }

            }
            gY55 = 0
            if ( FLG_列車_衝撃 ) {
                if ( N段数 = 1 ) {
                    gY55 = -51
                } else {
                    gY55 = -120
                }
                if ( 荷重方向 = "M" ) { //////12/12/17
                    gY55 = -80
                }
            } else {if ( J5 = 0 $$ J10 = 連続荷重数 ) {
                gY55 = 150 * (P7 / Max荷重)
                if ( P7 < 100 $$ Not (yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) ) {
                gY55 = gY55 - 100
                }
            } else {if ( J5 = 0 $$ J7 = 1 $$ J9 = 1 ) {
                if ( (P7 / Max荷重) > 0.6 ) {
                    J7 = 1
                    if ( (P7 / Max荷重) > 0.9 ) { J7 = 0
                } else {
                    J6 = 1
                }
            }
            if ( J5 != 0 ) {
                J55 = J5
                if ( SS1 = SE2 ) {
                    if ( N段数 > 1 ) {
                        if ( (P7 / BP荷重MAX) > 0.9 ) {
                            if ( P7 >= 100 ) {
                                J55 = 1
                            } else {if ( P7 < 33 ) {
                                J55 = 0.5
                            }
                        } else {
                            J55 = 1.5
                        }
                    } else {
                        if ( P7 >= 100 ) { J55 = 1
                    }
                } else {
                    if ( Len(鉛直文字列) >= 9 ) {
                        if ( P7 >= 100000 ) {
                            J55 = 0.1
                            GHOSEI = GHOSEI - 2
                        } else {
                            J55 = 1.2
                        }
                    } else {if ( Len(鉛直文字列) = 8 ) {
                        if ( P7 >= 10000 ) {
                            J55 = 0.1
                            GHOSEI = GHOSEI - 2
                        } else {
                            J55 = 1.2
                        }
                    } else {if ( Len(鉛直文字列) = 7 ) {
                        if ( P7 >= 1000 ) {
                            J55 = 0.4
                        } else {
                            J55 = 1.3
                        }
                    } else {if ( Len(鉛直文字列) = 6 ) {
                        if ( P7 >= 100 ) {
                            if ( N段数 = 1 ) {
                                J55 = 0.1
                            } else {
                                if ( (P7 / Max荷重) > 0.99 ) {
                                    J55 = 0.5
                                } else {
                                    J55 = -0.3
                                }
                            }
                        } else {
                            J55 = 0.7
                        }
                    } else {if ( Len(鉛直文字列) >= 5 ) {
                        J55 = 0
                    }
                }
                if ( (GHOSEI = 0.5 || GHOSEI = 2.5) $$ Abs(YY_max - wYs) > (YY_max - YY_min) / 5 ) { ////////08/11/27
                    J55 = J5
                }
                GOUKEI = (J7 * 60 + J88 * 160 - J55 * 120 - J6 * 80 + GHOSEI * 20) // - gY55
                if ( Mark111 = 5 ) { ////////09/11/17
                    GOUKEI = 50
                }
                GoTo YNEXT
            }
            if ( g荷重表記縦 = 0 $$ g荷重表記高 != 0 ) { ////////08/10/29
                if ( Mark111 = 4 $$ g荷重表記縦 = 0 ) { //////09/11/202
                    g荷重表記高 = 220
                    GOUKEI = 150
                } else {
                    if ( g荷重表記高 < 100 ) { // g荷重表記高 = 100
            //            GOUKEI = 260 - 100 - gY55 + 60  //////06/10/29
                            GOUKEI = 260 / 2 - g荷重表記高 - gY55 + 60 //////////////09/03/10
                    } else {
                        GOUKEI = 260 - g荷重表記高 - gY55 + 60
                        if ( (P7 / Max荷重) > 0.9 ) { //////09/11/12
                            if ( g荷重表記高 < 260 ) {
                                if ( g荷重表記高 = 180 $$ gY55 = 0 $$ N段数 = 1 ) { ////////10/01/03
                                    GOUKEI = 260 ////////10/02/03//////720 ////////10/01/03
                                } else {
                                    GOUKEI = 260 ////////10/01/03
                                }
                            } else {
                                GOUKEI = 260 ////////10/01/03
                            }
                        } else {
                            if ( g荷重表記高 > 140 $$ GOUKEI < 220 ) { ////////09//11/199
                                GOUKEI = 220
                            } else {
                                GOUKEI = 280 + GOUKEI
                                if ( ((P7 / Max荷重) ^ 1.3) < 0.3 ) { //////09/11/13
                                    GOUKEI = 0
                                }
                            }
                        }
                    }
                }
            } else {
                if ( g荷重表記縦 = 0 $$ (P7 / Max荷重) < 0.3 $$ N段数 != 1 $$ gY55 = 0 ) {  //////08/10/29
                    if ( (J7 = 1 $$ J9 = 1) $$ J8 = 0 ) {
                        if ( (P7 / Max荷重) < 0.2 ) {
                            GOUKEI = -20
                        } else {
                            GOUKEI = 0
                        }
                    } else {if ( J7 = 1 $$ J8 = 0 ) {
                        GOUKEI = 120 * (1 - (P7 / Max荷重) ^ 1.5)
                    } else {
                        GOUKEI = 300 * (1 - (P7 / Max荷重) ^ 0.7)
                    }
                } else {
                    J55 = J5
                    J88 = J8
                    if ( J5 + J6 + J7 + J8 + gY55 = 0 ) {
                        if ( (P7 / Max荷重) < 0.6 ) {
                            J88 = Round((P7 / Max荷重), 1)
                            if ( (P7 / Max荷重) < 0.1 ) {
                                J88 = 1.5
                            }
                        }
                            if ( Mark111 = 4 $$ g荷重表記縦 = 1 $$ hosei > 0 ) {
                                J55 = 1.5 //+ (g荷重表記高 / 300)
                            }
                    } else {if ( g荷重表記縦 = 1 || (P7 / Max荷重) > 0.85 ) {
                        if ( (yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) ) {
                            if ( (P7 / Max荷重) < 0.5 $$ P7 >= 10 ) {
                            J55 = Round(5 * (P7 / Max荷重) ^ 0.5, 1)
                            } else {
                            J55 = Round(3 * (P7 / Max荷重) ^ 0.5, 1) ////////09/11/199
                            if ( 下床文字表示 = 0 $$ 連続荷重_P1(1) * 連続荷重_P2(1) < 0 $$ g荷重表記高 > 260 ) {
            //                        J55 = J55 - Round(g荷重表記高 / 20, 1) //////09/12/04
                            }
                            }
            //                    J6 = 0 //-0.5
                            if ( J6 = 0 ) {
                                J6 = -0.5
                                J7 = 0
                            } else {if ( J6 > 0 ) { //////08/11/05
                                J6 = 2
                            } else {
                                if ( (P7 / Max荷重) > 0.95 ) { ////////////////////08/11/09////08/12/06
                                    J6 = J6 + 2.5 ////////08/11/09
                                } else {
                                    J6 = J6 + 2 ////////08/11/13
                                }
                            }
                        } else {
            //                    J55 = Round(2 * (P7 / Max荷重), 1)
                            J55 = Round(5.5 * (P7 / Max荷重) ^ 0.5, 1) ////////////08/12/07 //////09/04/06
                            if ( g荷重表記縦 = 1 $$ J55 < 4 ) { ////////09/11/11
                                J55 = J55 + 1.5
                            }
                            if ( (P7 / Max荷重) > 0.9 ) { //////09/04/06
                                if ( J6 < 0 ) { J6 = J6 / 2
                            } else {
                                if ( J6 < 0 ) { J6 = 2.5 ////////////J6 = 0//////////////////08/11/17
                                if ( (P7 / Max荷重) < 0.2 ) { J55 = J55 + 0.8 //////09/04/06
                            }
                            J7 = 0
                        }
                    } else {if ( (P7 / Max荷重) > 0.8 ) {
                        J6 = J6 + 2
                    } else {if ( (P7 / Max荷重) < 0.15 $$ J8 = 0 ) {
                        if ( J6 = 1 ) {
                            J6 = 0
                            J88 = 1.8
                        } else {
                            J7 = 2
                        }
                    }
                    GOUKEI = (J7 * 60 + J88 * 160 - J55 * 120 - J6 * 80 - gY55)
                    if ( g荷重表記縦 = 1 $$ g荷重表記高 < 120 $$ GOUKEI < -560 ) { ////09/12/25////09/11/199
                        GOUKEI = -560 ////////09/12/25//////-450
                    }
                }
            } ////////08/10/29
            YNEXT:
            if ( 水平垂直 = 0 $$ (Mark111 = 2 || Mark111 = 3 || Mark111 = 4) ) { ////////09/11/11
                if ( 荷重図開き < 0 ) {
                    GOUKEI = GOUKEI - 180 //09/11/16
                } else {if ( (g荷重表記縦 = 1 $$ GOUKEI * 1.3 > -400 $$ GOUKEI < 0) ) { ////////09/11/11
                    GOUKEI = GOUKEI * 1.3
                } else {if ( (g荷重表記縦 = 1 $$ GOUKEI < -630 $$ GOUKEI < 0) ) { ////////09/11/11 $$ GOUKEI < -650 ////10/01/14
                    GOUKEI = -550
                }
                if ( 下床文字表示 = 0 $$ 連続荷重_P1(1) * 連続荷重_P2(1) < 0 $$ g荷重表記高 > 250 ) { //////09/12/04
                    GOUKEI = -650 - Round(g荷重表記高 / 2, 1) //////09/12/04
                }
                if ( g荷重表記縦 = 0 $$ iKozo = 3 $$ g連続Mod = False $$ (P7 / Max荷重) < 0.75 $$ 荷重図開き > 0 ) { //////13/04/19
                    if ( 連続荷重数 = 1 $$ 連続荷重_L1(1) + 連続荷重_L2(1) = 0 $$ wXs = XXYY(2) $$ wXe = XXYY(1) $$ wYs != YY_max ) {
                        NN = 1
                    }
                }
            } else {if ( 水平垂直 = 0 $$ GOUKEI < -500 $$ (Mark111 = 5 || Mark111 = 11) ) {
                GOUKEI = -180 ////////09/11/11
            }
            GOUKEI = Round(GOUKEI, 0) ////////08/10/29//////08/11/27
            ////////09/02/20
            var yyF5 As Single, yyF6 As Single //////09/08/05
            yyF5 = 0
            if ( Not (水平垂直 = 1 $$ Mark111 = 1) ) { //////09/09/25
                if ( (水平垂直 = 1 $$ (連続荷重_P1(1) < 0)) ) { ////////09/08/03
                    if ( Mark111 = 1 ) {
                        if ( Len(Format(P7, "0.00")) > 6 ) {
                            yyF5 = 450
                        } else {
                            yyF5 = 350
                        }
                    } else {
                        if ( g荷重表記縦 = 0 $$ N段数 = 1 $$ 連続荷重_P1(1) = 連続荷重_P2(1) ) {
                            if ( FLG杭杭 || yiKozo != 3 ) { ////////09/08/03 09/08/05
                                yyF5 = -70
                            } else {
                                yyF5 = -130
                            }
                        }
                    }
                }
            } else {if ( (水平垂直 = 1 $$ Mark111 = 1) ) {
                    if ( 連続荷重_P1(1) > 0 ) {
                        寸法線位置 = -10 ////////14/11/16
                        寸法補助線 = 3
                        yyF5 = -100
                        f寸法FLG = -1
                    } else {
                        寸法線位置 = 2.5 ////////14/11/16
                        寸法補助線 = 3
                        yyF5 = 0
                        f寸法FLG = 1
                    }
                    For( i = 1 To NN
                        寸法(i) = F2(XL(i + 1) - XL(i))
                        XL(i) = 図倍率 * XL(i)
                        X(i) = PX0 + XL(i) * BCS + yyF5
                        Y(i) = PY0 - XL(i) * BSN + GOUKEI * BCS
                    }
                    this.SunPou2("<", NN, 寸法線位置, 寸法補助線, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, 1, 荷重図開き): GoTo ABC
                    寸法線位置 = -5.5: 寸法補助線 = -2
            //            GoTo Next_GRF ////////09/11/12
            } //////09/09/25
            if ( Mark111 = 2 $$ g荷重表記縦 = 0 $$ 水平垂直 = 0 $$ g荷重表記高5 > 180 $$ 荷重図開き > 0 ) {
                GOUKEI = Round(g荷重表記高5, 0) //////13/04/25
                寸法線位置 = -16.5
                寸法補助線 = -3.5
            }
            For( i = 1 To NN
                寸法(i) = F2(XL(i + 1) - XL(i))
                XL(i) = 図倍率 * XL(i)
                X(i) = PX0 + XL(i) * BCS + yyF5 //////09/02/20
                if ( 荷重方向 = "V" || 荷重方向 = "M" || 荷重方向 = "S" ) {
                    Y(i) = PY0 - XL(i) * BSN + GOUKEI * Abs(BCS)
                } else {
                    Y(i) = PY0 - XL(i) * BSN + GOUKEI * BCS
                }
            }
            if ( s荷重位置 != 999999 ) { //////13/04/20
                For( i = 1 To NN
                    Y(i) = s荷重位置 // - 800
                }
                if ( g荷重表記縦 = 0 ) {
                    寸法線位置 = -6
                    寸法補助線 = -4
                } else {
                    寸法線位置 = -16
                    寸法補助線 = -4
                }
                GoTo GRF9
            }
            if ( X(1) = X(連続荷重数) ) {
                HV = 0
            }
            //////////
            obj.FontSize = 荷重寸法Fontsize
            obj.PenWidth = 部材荷重寸法Pen幅
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(obj.PenWidth))
            }
            obj.PenColor = QBColor(部材荷重寸法Pen色)

            if ( Mark111 = 2 $$ g荷重表記縦 = 0 $$ 水平垂直 = 0 $$ g荷重表記高5 > 180 $$ 荷重図開き > 0 ) { GoTo GRF9 //////13/04/25
            if ( 寸法線位置 = -7.07 ) { GoTo GRF9 //////13/04/19
            Select Case Mark111
            Case 1, 2, 3, 4, 5, 6, 7, 11
                //寸法線位置  寸法補助線 mm
                if ( Mark111 = 1 || Mark111 = 11 || Mark111 = 5 ) {
                    寸法線位置 = -(荷重寸法線位置(1) + GHOSEI) * Sgn(荷重図開き)
                    if ( (yiKozo = 1 || yiKozo = 3) $$ 水平垂直 = 0 $$ N段数 = 1 $$ 連続荷重数 = 1 $$ _
                       Abs(YY_max - wYs) > (YY_max - YY_min) / 5 ) { //////////////////////////////////07/06/177//////////////////////////12/12/15
                        寸法線位置 = 3.001
                    }
            //////09/11/09
                    if ( 水平垂直 = 1 $$ Mark111 = 5 ) { //////Not (節X(節点S) = g柱X座標(g柱本数, 1) || 節X(節点S) = g柱X座標(1, 1)) ) {
                        if ( 節X0(節点S) < (JX_max + JX_min) / 2 ) {
                            寸法線位置 = -7
                            寸法補助線 = 寸法線位置 + 1
                            yyF5 = -150
                            f寸法FLG = -1
                        } else {
                            寸法線位置 = 3
                            寸法補助線 = 寸法線位置 - 1
                            yyF5 = 50
                            f寸法FLG = 1
                        }
                        For( i = 1 To NN
                            X(i) = PX0 + XL(i) * BCS + yyF5
                        }
                        GoTo GRF
                    }
            //////09/11/09
                } else {
                    if ( FLG杭杭 || (yiKozo != 2 $$ 水平垂直 = 1) ) { //////////////09/01/28////Or (yiKozo != 3 $$ 水平垂直 = 1)////07/06/11
                        if ( 荷重図開き > 0 ) {
                        寸法線位置 = -(荷重寸法線位置(2) + GHOSEI - 7 - 6 + 1) * Sgn(荷重図開き) ////////08/08/15
                        } else {
                        寸法線位置 = -(荷重寸法線位置(2) + GHOSEI - 9 - 6 + 1) * Sgn(荷重図開き) ////////08/08/15
                        }
                        if ( 水平垂直 = 1 ) { //////10/01/18////////And InStr(部材名(SS部材), "杭") = 0 ) { ////////09/11/199
                            if ( (FLG杭杭 = False $$ yiKozo = 3) || 連続荷重_P1(1) != 連続荷重_P2(1) ) { ////////09/05/03 09/08/05
                                寸法線位置 = 寸法線位置 + IIf(P7 >= 1000, -16, -14) * Sgn(荷重図開き)
                            }
            //                        yyF6 = 1 * Sgn(連続荷重_P1(1))  //////09/08/05
                                yyF6 = Sgn(荷重図開き) //////09/11/06
                                if ( yyF6 = 1 ) {
                                    if ( FLG杭杭 ) { ////////09/11/07
                                        if ( N段数 > 1 ) { ////7g荷重表記高 > 300
                                            寸法線位置 = -7 - 14 * Sgn(荷重図開き)
                                        } else {
                                            寸法線位置 = -7 //寸法線位置 - (5 + 1.5 * (P7 / Max荷重)) * Sgn(荷重図開き)
                                            寸法補助線 = 寸法線位置 + 1
                                            GoTo GRF
                                        }
                                    } else {
                                        if ( FLG杭杭 = False $$ 節X(節点S) = g柱X座標(g柱本数, 1) ) { //////09/11/09//////And g荷重表記縦 = 1 ) { //////09/11/06
                                        //////右側土圧
                                            if ( g荷重表記縦 = 1 ) { //////09/11/09
                                            //////////////////////////////////////////////////////////////////////09/12/25
                                            寸法線位置 = (3 + 2 * (P7 / Max荷重) * 2) + max(Len(Format(P7, "0.00")), 6) * (荷重文字サイズ * Twip / 160)
                                            } else {
                                            寸法線位置 = (5 + 2 * (P7 / Max荷重)) + 荷重文字サイズ / 2 //////09/11/09
                                            }
                                            寸法補助線 = 寸法線位置 - 1
                                            GoTo GRF
                                        } else {
                                            if ( (yiKozo = 2 $$ FLG杭杭 = False) || g荷重表記高 > 300 ) { ////////09/08/07
                                            寸法線位置 = 寸法線位置 - (16 + 1.5 * (P7 / Max荷重)) * Sgn(荷重図開き)
                                            } else {
                                            寸法線位置 = 寸法線位置 - (5 + 1.5 * (P7 / Max荷重)) * Sgn(荷重図開き) //////////07/06/11 09/08/05
                                            }
                                        }
                                    }
                                } else {
                                    if ( FLG杭杭 ) {
                                        if ( N段数 > 1 ) { ////////g荷重表記高 > 300 ) {
                                            if ( yiKozo = 2 ) {
                                                寸法線位置 = (16.5 + 1.5 * (P7 / Max荷重))
                                                寸法補助線 = 4 ////寸法線位置 - 1
                                            } else {
                                                寸法線位置 = (16.5 + 1.5 * (P7 / Max荷重))
                                                寸法補助線 = 4 ////寸法線位置 - 1
                                            }
                                            GoTo GRF
                                        } else {
                                            if ( Sgn(荷重図開き) < 0 $$ 連続荷重mark(1) = 2 ) { ////////11/12/15
                                                寸法線位置 = (5 - 10 * Sgn(荷重図開き)) / 2
                                                寸法補助線 = 寸法線位置 - 1
                                            } else {
                                                寸法線位置 = 寸法線位置 - 10 * Sgn(荷重図開き) ////////09/11/088
                                                寸法補助線 = 寸法線位置 - 1
                                            }
                                            GoTo GRF
                                        }
                                    } else {
                                        if ( FLG杭杭 = False $$ 節X(節点S) = g柱X座標(1, 1) ) { //////09/11/09//////And g荷重表記縦 = 1 ) { //////09/11/06
                                        //////左側土圧
                                            if ( g荷重表記縦 = 1 ) { //////09/11/09
                                            //////////////////////////////////////////////////////////////////////////09/12/25
                                            寸法線位置 = -(3 + 2 * (P7 / Max荷重) * 2) - max(Len(Format(P7, "0.00")), 5.5) * (荷重文字サイズ * Twip / 160)
                                            } else {
                                            寸法線位置 = -(3 + 4 * (P7 / Max荷重)) - 荷重文字サイズ / 4 //////09/11/09
                                            }
                                            寸法補助線 = 寸法線位置 + 1
                                            GoTo GRF
                                        } else {
                                            if ( (yiKozo = 2 $$ FLG杭杭 = False) || g荷重表記高 > 300 ) {
                                                寸法線位置 = 寸法線位置 - (12 + 1.5 * (P7 / Max荷重)) * Sgn(荷重図開き)
                                            } else {
                                                if ( Not (iKozo = 3 $$ FLG杭杭 = False $$ Mark111 = 2 $$ 水平垂直 = 1 $$ 寸法線位置 > 0 $$ 荷重図開き < 0) ) {
                                                寸法線位置 = 寸法線位置 - (12 + 1.5 * (P7 / Max荷重)) * Sgn(荷重図開き)
                                                }
                                                寸法補助線 = 寸法線位置 - 5
                                                GoTo GRF
                                            }
                                        }
                                    }
                                }
                        }
                    } else {
                        if ( 水平垂直 = 0 $$ yFR橋脚 = 2 ) {
                            寸法線位置 = -(荷重寸法線位置(2) + GHOSEI + 4) * Sgn(荷重図開き) ////////////////06/02/12
                        } else {
                            ////////////////////////////////////////////////////////////////////////////////////////////////////////10/02/03
                            寸法線位置 = -(荷重寸法線位置(2) + GHOSEI + 2 + IIf(連続荷重_P1(1) * 連続荷重_P2(1) < 0, 4, 0)) * Sgn(荷重図開き)
                            if ( 荷重図開き < 0 $$ (YY_max = wYs || YY_max = wYe) ) { //////13/01/30
                                寸法線位置 = -(寸法線位置)
                                寸法補助線 = -3.5
                                GoTo GRF8
                            }
                            if ( 荷重図開き > 0 $$ (YY_min = wYs || YY_min = wYe) ) { //////13/01/30
            //                        寸法線位置 = -9
                                寸法補助線 = -3.5
                                GoTo GRF8
                            }
                            if ( J4 = 連続荷重数 ) { ////////08/07/08
                                寸法線位置 = 寸法線位置 * 0.9
                            }
                        }
                        if ( 水平垂直 = 1 $$ yFR橋脚 != 2 ) {
                            if ( g荷重表記縦 = 0 ) { //09/04/17
                                if ( 連続荷重_P1(1) > 0 ) {
                                    寸法線位置 = 寸法線位置 + 4.5 * Sgn(荷重図開き)
                                }
                            } else {
                                if ( yiKozo = 3 ) { //カルバートボックス 05/05/12//////////09/11/09
            //                            if ( ((wXe != JX_min $$ wXe != JX_max) || _
            //                               (wXe = JX_min $$ 荷重図開き > 0) || _
            //                               (wXe != JX_max $$ 荷重図開き < 0)) _
            //                                $$ N段数 = 1 $$ 連続荷重mark(1) = 2 ) { ////////09/08/14
            //                                //寸法線位置 = 6 * Sgn(荷重図開き)
            //                                f寸法FLG = Sgn(荷重図開き) ////////09/08/14
            //                            } else {
                                        寸法線位置 = 寸法線位置 - 2 * Sgn(荷重図開き) //////09/04/17
            //                            }
                                } else {
                                    寸法線位置 = 寸法線位置 - 7 * Sgn(荷重図開き)
                                }
                            }
                        }
                    }
                }
                if ( yFR橋脚 = 2 $$ HV = 1 $$ FLG杭杭 = False ) { ////////08/08/17
                    寸法線位置 = 寸法線位置 - 2
                } else {
                }
                if ( Mark111 = 3 || Mark111 = 4 ) {
                    if ( yFR橋脚 = 2 ) {
                        寸法線位置 = 寸法線位置 + 4 * Sgn(荷重図開き) //////09/11/16
                    } else {
                        寸法線位置 = 寸法線位置 + 5 * Sgn(荷重図開き) //////09/11/16
                    }
                }
                if ( X(1) = X(2) ) { //////Or (水平垂直 = 9 $$ 荷重方向 = "H") ) { // 鉛直部材の場合//////09/08/23
                    if ( yFR橋脚 = 1 || FLG杭杭 || (yiKozo != 3 $$ 水平垂直 = 1) ) { //////08/08/17 09/08/05
                        if ( 荷重図開き > 0 ) {
                            if ( 集中有無 = 1 ) {
                                寸法線位置 = 寸法線位置 - 4 * Sgn(寸法線位置)
                            } else {
                                寸法線位置 = 寸法線位置 - 4 * Sgn(寸法線位置)
                            }
                        } else {
                            if ( 集中有無 = 1 ) {
                                寸法線位置 = 寸法線位置 - 6 * Sgn(寸法線位置)
                            } else {
                                寸法線位置 = 寸法線位置 - 6 * Sgn(寸法線位置)
                            }
                        }
                        if ( Mark111 = 2 ) {
                            if ( 集中有無 = 0 $$ 荷重図開き < 0 ) {
                                寸法線位置 = 寸法線位置 + 2 * Sgn(寸法線位置)
                            }
                        } else {
                            if ( 集中有無 = 0 $$ 荷重図開き < 0 ) {
                                寸法線位置 = 寸法線位置 - 1 * Sgn(寸法線位置)
                            }
                        }
                    }
                }
                if ( FLG杭杭 $$ g荷重表記縦 = 1 ) { ////////09/11/199
                    if ( 荷重図開き > 0 ) {
                        寸法線位置 = -5.5
                        寸法補助線 = -荷重寸法線位置(1) / 5
                    } else {
                        寸法線位置 = 7.5
                        寸法補助線 = 荷重寸法線位置(1) / 5
                    }
                    GoTo GRF ////////09/11/199
                }
                寸法補助線 = -荷重寸法補助線 * Sgn(荷重図開き)
                if ( yFR橋脚 = 1 $$ 水平垂直 = 1 $$ Mark111 = 1 ) { //02/04/18
                    寸法線位置 = 荷重寸法線位置(1) / 2.5 //0 //寸法線位置 - 1 * Sgn(寸法線位置)
                    寸法補助線 = 荷重寸法線位置(1) / 5 //-荷重寸法補助線 * Sgn(荷重図開き)
                }
                if ( 水平垂直 = 1 $$ Mark111 = 5 ) {
                    寸法線位置 = 寸法線位置 - 4 * Sgn(寸法線位置)
                } else {
                    if ( 水平垂直 = 0 $$ Mark111 = 2 ) { //And gHosei != 0 ) { //And 荷重_P1 = 荷重_P2 ) {
                    if ( UUUU = 0 ) {
                        if ( (PPPP / Max荷重) < 0.2 ) { //And hosei >= 0 ) {
                        寸法線位置 = 寸法線位置 - 8.5 * Sgn(寸法線位置) * IIf(FR橋脚 = 1, Sgn(荷重図開き), 1) //////10/05/12
                        } else {
                        寸法線位置 = 寸法線位置 - 6 * Sgn(寸法線位置) * IIf(FR橋脚 = 1, Sgn(荷重図開き), 1) //////10/05/12
                        }
                    } else {
                        if ( hosei < 0 ) {
                            寸法線位置 = 寸法線位置 - 5.5 * Sgn(寸法線位置) * IIf(FR橋脚 = 1, Sgn(荷重図開き), 1) //////10/05/12
                        } else {
                            if ( hosei = 0 ) {
                            寸法線位置 = 寸法線位置 - 5 * Sgn(寸法線位置) * IIf(FR橋脚 = 1, Sgn(荷重図開き), 1) //////10/05/12
                            } else {
                            寸法線位置 = 寸法線位置 - 6 * Sgn(寸法線位置) * IIf(FR橋脚 = 1, Sgn(荷重図開き), 1) //////10/05/12
                            }
                        }
                    }
                    }
                }
                if ( 寸法線位置 = 3.001 ) { //////////////////07/06/177
                    寸法補助線 = 寸法線位置 + 1
                }
                if ( Flg3 = 1 ) { //////////////////////////////07/07/26
                    寸法補助線 = -寸法線位置
                }
                if ( g荷重表記縦 = 0 $$ g荷重表記高 != 0 ) { ////////08/10/29
                    if ( 水平垂直 != 1 ) { //////09/04/17
                        寸法線位置 = -Round((GOUKEI / 30) + (g荷重表記高 / 30), 2) _
                                     + IIf(yyF6 = 1, 1 - Round(1 * (P7 / Max荷重), 2), 0)
                        if ( g荷重表記高 < 145 $$ gY55 != -51 ) { //////10/02/07
                            if ( Abs(寸法線位置) > 16 ) {
                                寸法線位置 = 寸法線位置 + 3 //////10/02/07
                            }
                        }
                        if ( gY55 = -51 || gY55 = -80 ) { //////////////10/01/30 12/12/17
                            if ( Abs(寸法線位置) < 20 ) {
                            寸法線位置 = 寸法線位置 - 5
                            } else {
                            寸法線位置 = 寸法線位置
                            }
                            GoTo GRF8
                        } else {if ( yiKozo = 1 $$ (節Y0(節点S) + 節Y0(節点E)) / 2 < ((YY_max + 水平部材最下端) / 2 * 0.8) ) {
                            if ( Not (iKozo = 3 $$ (P7 / Max荷重) < 0.44) ) { //////13/02/30
                            寸法線位置 = 寸法線位置 - 3 - IIf((PPPP / Max荷重) > 0.75, 1.5, 0) //////13/04/08
                            }
                        }
                    }
                } else {
                    寸法線位置 = Round(寸法線位置 + 0.5 * Sgn(寸法線位置), 1)
                    if ( 水平垂直 = 1 $$ iKozo = 3 $$ 寸法線位置 < -16 ) { //////////////////////////////////Box 内水圧
                        寸法線位置 = 16 * Sgn(寸法線位置) ////寸法線位置 - 10 * Sgn(寸法線位置)
                        寸法補助線 = -4
                    }
                    if ( 水平垂直 = 1 $$ iKozo = 3 $$ 寸法線位置 > 17 ) {
                        寸法線位置 = 17 //寸法線位置 - 10 * Sgn(寸法線位置)
                        寸法補助線 = 4
                    }
                }
            GRF: //////////////////////09/11/06
                if ( 水平垂直 != 1 $$ 荷重図開き < 0 ) { //////09/11/16
                    寸法線位置 = Abs(寸法線位置) ////////////10/05/12寸法線位置 * Sgn(荷重図開き) //////09/11/16
                }
            //////08/11/06
            var M As Integer, Atta As Integer
                Atta = 0
                //////////09/11/09
                if ( 水平垂直 != 1 $$ (Mark111 = 1 || Mark111 = 5 || Mark111 = 6 || Mark111 = 11) $$ N段数 = 1 ) { ////////08/11/06
                    if ( 下層BUZAI(1, 1) != 0 ) {
                        For( M = 1 To 部材_max
                            if ( 下層BUZAI(M, 1) = 0 ) { Exit For
            //                    if ( 下層BUZAI(M, 2) >= 節点S $$ 下層BUZAI(M, 2) <= 節点E ) {
                            if ( 下層BUZAI(M, 2) = 節点S || 下層BUZAI(M, 2) = 節点E ) { //////////////14/11/177
                                Atta = 1
                                Exit For
                            }
            //                    if ( 下層BUZAI(M, 3) >= 節点S $$ 下層BUZAI(M, 3) <= 節点E ) {
                            if ( 下層BUZAI(M, 3) = 節点S || 下層BUZAI(M, 3) = 節点E ) { //////////////14/11/177
                                Atta = 1
                                Exit For
                            }
                        Next M
                    }
                    if ( Atta = 0 $$ yiKozo = 1 $$ (Abs(YY_max - (wYe + wYs) / 2) > 1.6) ) {
                        Atta = 1
                        PY0 = min(HEN_Y(wYs), HEN_Y(wYe)) + 2 * Twip
                    }
                    if ( Atta = 0 $$ yiKozo = 1 $$ (水平部材最下端 = (wYs + wYe) / 2 $$ Mark111 = 6) ) {
                        Atta = 1
                        if ( 連続荷重_P1(1) > 0 $$ 連続荷重_P2(1) > 0 ) {
                        PY0 = min(HEN_Y(wYs), HEN_Y(wYe)) + 10 * Twip ////////下に
                        }
                    }
                }
            //////08/11/06
                if ( Atta = 1 ) {
                    if ( (水平部材最下端 = (wYs + wYe) / 2) $$ (yiKozo = 1 || yiKozo = 3) $$ 水平垂直 = 0 $$ N段数 = 1 ) {
                        For( i = 1 To NN //////////09/10/25
                            Y(i) = PY0 + (XL(i) * BSN - 0 * BCS) - 5 * Twip //////////////09/11/08
                        }
                        this.SunPou2("<", NN, 18, 4, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, 1, 荷重図開き): GoTo ABC //////09/10/20 12/12/15
                    } else {
                        For( i = 1 To NN //////////09/10/25
                            Y(i) = PY0 + (XL(i) * BSN - 95 * BCS) - 5 * Twip //////////////09/11/08
                        }
                        this.SunPou2("<", NN, 10, 4, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, , 荷重図開き): GoTo ABC //////09/10/20 12/12/15
                    }
                } else {
                    if ( Mark111 = 5 ) {
                        if ( 水平垂直 = 1 ) { ////13/04/08
                            寸法線位置 = -10
                            寸法補助線 = -3
                        } else {
                            if ( (水平部材最上端 = (wYs + wYe) / 2) ) { //////14/08/17
                                寸法線位置 = -9
                                寸法補助線 = -3
                            } else {
                                寸法線位置 = 4.5
                                寸法補助線 = -4
                            }
                        }
                    } else {if ( Mark111 = 1 $$ 水平垂直 != 1 ) { //////////10/01/19
                        if ( P7 < 1000 ) { //////  $$ 寸法線位置 > -12.1 ) {
                            if ( P7 / Max荷重 < 0.3 ) {
                                寸法線位置 = 寸法線位置 - 3.5 - 1 ////////////10/06/02
                            } else {
                                if ( ((P7 / Max荷重) > 0.8 $$ P7 < 30) || (P7 / Max荷重) >= 0.9 ) { ////////////10/06/02
                                    寸法線位置 = 寸法線位置 - 3.5
                                } else {
                                    寸法線位置 = 寸法線位置 - 2.5 * max((1 - P7 / Max荷重), 0.5)
                                }
                            }
                        } else {if ( P7 > 2000 $$ 寸法線位置 > -15.1 ) { //////////10/01/19
                            if ( P7 < 3000 ) { ////////////10/04/100
                                寸法線位置 = 寸法線位置 - 3 + (max((3100 - P7), 0) / 250)
                            }
                        } else {if ( 寸法線位置 = -15 ) {
                            寸法線位置 = -17
                        }
                        if ( 荷重文字サイズ > 9.5 $$ 寸法線位置 < -16 ) { //////12/09/25
                            寸法線位置 = 寸法線位置 - (荷重文字サイズ - 9.5) * 2
                        }
                    }
            if ( (Mark111 = 2 $$ 水平垂直 != 1 $$ (P7 / Max荷重) > 0.9 $$ 寸法線位置 < -8) ) {  //////10/10/14
                if ( g荷重表記縦 = 1 ) {
                    寸法線位置 = 寸法線位置 - 1 ////// 12/11/22
                } else {
                    if ( ((部材正荷重数(SS1) < 30 $$ N段数 != 1) || (部材正荷重数(SS1) < 20 $$ N段数 = 1)) $$ yyF6 = 0 ) { //////10/11/11
                        if ( (部材正荷重数(SS1) < 18 $$ N段数 = 1) ) {
                        寸法線位置 = 寸法線位置 - 0 - IIf((P7 / Max荷重) > 0.9, 5, 0) //////10/11/11 12/11/22
                        } else {
                        寸法線位置 = 寸法線位置 - IIf((P7 / Max荷重) > 0.95, 1, 4) //////12/12/15
                        }
                        m調整高 = 4
                    } else {
                        if ( N段数 = 1 ) {
                            if ( YY_max - max(wYs, wYe) > 1 $$ 部材正荷重数(SS1) < 24 ) { ////////12/12/12
                                寸法線位置 = 1
                                寸法補助線 = 4
                            }
                        } else {if ( 水平垂直 != 1 ) {
                            寸法線位置 = 寸法線位置 - IIf((P7 / Max荷重) > 0.95, 2, 0.5)
                        }
                    }
                }
            }
                    if ( Mark111 = 3 ) {
                        if ( g荷重表記高 > 200 ) {
                            寸法線位置 = -12
                        } else {
                            寸法線位置 = -(10 + Round((g荷重表記高 * 2.8 / 100), 1))
                            if ( 寸法線位置 > -15 ) { 寸法線位置 = -15
                        }
                        if ( g荷重表記高 < 100 ) {
                            寸法線位置 = Round(g荷重表記高 / 8, 1) * Sgn(寸法線位置)
                        }
                        g荷重表記高 = 0
                    }
                    if ( Mark111 = 2 $$ 連続荷重数 = 1 $$ g荷重表記縦 = 0 $$ 寸法線位置 < 0 $$ 寸法線位置 > -18 ) {
                        if ( g荷重表記縦 = 0 ) {
                        } else {
                            寸法線位置 = 寸法線位置 - 3
                        }
                    }
                    //
                    if ( f寸法FLG = 0 ) { //////09/08/14
                        if ( Mark111 = 1 $$ 寸法線位置 < -16 ) {

                            寸法線位置 = -17
                            寸法補助線 = -3

                        }
                        if ( g荷重表記縦 = 0 $$ 連続荷重数 = 1 $$ 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) + 連続荷重_P2(1) = 0 ) {
                            寸法線位置 = min(Abs(寸法線位置) + 9, 30) * Sgn(寸法線位置) ////////12/11/22
                        } else {if ( g荷重表記縦 = 0 $$ 連続荷重数 > 1 $$ 連続荷重mark(1) = 2 $$ 水平垂直 = 0 ) {
                            if ( ((BXE - BX0) / 連続荷重数) < 220 ) { ////////////////12/12/12
                                寸法線位置 = 寸法線位置 - 3 //////12/12/16
                                寸法補助線 = -2.5
                            } else {if ( ((BXE - BX0) / 連続荷重数) < 350 ) {
                                寸法線位置 = 寸法線位置 - 1.5
                                寸法補助線 = -3
                            }
                        }
                        if ( NN = 2 $$ g荷重表記縦 = 0 $$ (Mark111 = 2 $$ 水平垂直 != 1 $$ (P7 / Max荷重) > 0.9 $$ 寸法線位置 < -15) ) {
                            寸法線位置 = -15
                        } else {if ( (P7 / Max荷重) < 0.44 $$ g荷重表記縦 = 0 $$ 水平垂直 != 1 $$ 寸法線位置 < -12 $$ ((BXE - BX0) / 連続荷重数) >= 350 ) {
                            寸法線位置 = -13 - 2
                        } else {if ( yyF6 = 0 $$ 水平垂直 = 0 $$ (水平部材最下端 = (wYs + wYe) / 2) ) { //////13/11/06
                            if ( 寸法線位置 > 0 ) {
                                寸法線位置 = 寸法線位置 + 2
                                寸法補助線 = 4
                                if ( (連続荷重_P1(1) + 連続荷重_P2(1)) / 2 < 0 ) {
                                    寸法線位置 = 寸法線位置 + 2
                                }
                            }
                        }
                        if ( (水平部材最下端 = (wYs + wYe) / 2) $$ (yiKozo = 1 || yiKozo = 3) $$ _
                                                   水平垂直 = 0 $$ N段数 = 1 $$ 寸法線位置 < 0 ) { //////12/12/15
                        } else {if ( Mark111 = 4 $$ (P7 / Max荷重) < 0.5 $$ 寸法線位置 < 0 $$ g荷重表記縦 = 0 ) { //////12/12/17
                            寸法線位置 = 寸法線位置 + 2
                        }

            GRF8: //////12/12/17
            //            if ( 連続荷重数 = 1 $$ NN = 2 $$ (YY_max = wYs $$ YY_max = wYe) ) {
            //                if ( LLL789 = 寸法(1) & Format((節点S + 節点E) * 10) ) {
            //                    GoTo ABC
            //                }
            //            }
                    if ( LLL789 = 寸法(1) & Format((節点S + 節点E) * 10) ) { GoTo ABC //////14/11/16
                    if ( 連続荷重mark(1) = 6 $$ wXs = wXe $$ g柱本数 > 0 $$ RR橋脚 = 1 ) {
                        if ( 節X(節点S) = g柱X座標(1, 1) ) {
                            寸法線位置 = -10
                        } else {if ( 節X(節点S) = g柱X座標(g柱本数, 1) ) {
                        } else {
                            if ( (Abs(寸法線位置) / 図X_SCALE) < 600 ) {
                            寸法線位置 = -Round((600 * 図X_SCALE), 1)
                            }
                            if ( FLG柱軸重 = True ) {
                                寸法線位置 = 5.5
                                寸法補助線 = 6.5
                            }
                        }
                    }
                    if ( (P7 / Max荷重) < 0.35 $$ 連続荷重_P1(1) != 連続荷重_P2(1) $$ (Mark111 = 2 $$ 水平垂直 = 0) $$ _
                                    (Abs(YY_max - wYs) > (YY_max - YY_min) / 5) ) { //////13/020/27
                        寸法線位置 = -1
                    }
                        if ( NN = 2 $$ Abs(連続荷重_P1(1) / Max荷重) < 0.23 $$ g荷重表記高 < 130 $$ 連続荷重_P1(1) = 連続荷重_P2(1) ) {
                            寸法線位置 = -12 ////////13/02/27
                        }
                        if ( 連続荷重_P1(1) + 連続荷重_P2(1) = 0 $$ Mark111 = 2 ) { //////13/04/12
                            寸法線位置 = 寸法線位置 + 5 * Sgn(寸法線位置)
                        }
            GRF9:
               if ( (Mark111 = 5 || Mark111 = 11) $$ g連続Mod ) { //////13/04/25
                    寸法線位置 = -11.01
                    寸法補助線 = -4
               } else {if ( 連続荷重mark(1) = 11 $$ 寸法線位置 > 0 ) {
                    寸法線位置 = 寸法線位置 + 5
                    寸法補助線 = 4
               }
               if ( FLG_列車_衝撃 ) { ////////14/08/28
                    寸法線位置 = -18
               }
               if ( (Mark111 = 5 || Mark111 = 11) $$ g連続Mod = False ) { //////14/09/27
                    寸法線位置 = -9
                    寸法補助線 = -3
               }
                        this.SunPou2("<", NN, 寸法線位置, 寸法補助線, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, 1, 荷重図開き)

                    } else {if ( f寸法FLG = -1 ) { ////////09/08/14
                        this.SunPou2("<", NN, -7, -4, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, 1, 荷重図開き)
                    } else {if ( f寸法FLG = 1 ) { //////09/08/14
                        this.SunPou2("<", NN, 6, 4, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, 1, 荷重図開き)
                    }
            //            g段上げ = (PY0Y(1) - PY0)
                }
            Case } else {
            End Select
            //   //////////////////////////////////////////////08/07/06
            ABC:
            if ( Not (Mark111 = 6 || Mark111 = 7 || Mark111 = 8 || Mark111 = 9 || _
                    Mark111 = 10 || Mark111 > 11 || g段上げ = -99999) ) { //////13/04/13
                if ( 連続荷重mark(1) = 5 ) {
                    J5 = 9999
                    J6 = 0
                    For( i = 1 To MQM
                        J4 = 上層Buzai(i)
                        J5 = min(J5, 部材正荷重数(J4))
                        J6 = max(J6, 部材正荷重数(J4))
                    }
                    if ( J6 < 5 ) { J6 = 5
                    if ( J5 != J6 ) {
                        For( i = 1 To MQM
                            J4 = 上層Buzai(i)
                            部材正荷重数(J4) = J6
                        }
                    }
                } else {
                    yyF6 = max(図Y(節Y(節点S)), 図Y(節Y(節点E)))
                    yyF5 = (g段上げ - yyF6) / Twip + 2 + IIf(s寸法文字2段, 2.3, 0)
                    if ( yyF5 < 0 ) {
                        yyF5 = IIf(g荷重表記縦 = 0, 10, 17) + IIf(s寸法文字2段, 2, 0)
                    } else {
                        yyF5 = max(Round(yyF5, 2), 0)
                        if ( g荷重表記縦 = 0 ) {
                                yyF5 = min(yyF5 / 2, IIf(g荷重表記高 = 0, 0, 4))
                            if ( g荷重表記高 > 180 ) {
                                yyF5 = yyF5 + 5
                            } else {if ( g荷重表記高 > 150 $$ g荷重表記高 < 180 $$ g荷重表記縦 = 0 ) {
                            if ( 部材正荷重数(SS1) < 8 ) {
                                    yyF5 = 12
                                } else {
            //                        yyF5 = 12
                                }
                            }
                        } else {if ( yyF5 > 40 ) {
                            if ( Mark111 = 1 ) {
                                yyF5 = 8
                            } else {
                                yyF5 = 24
                            }
                        }
                    }
                    if ( Mark111 = 1 ) { ////////////And N段数 = 1 ) {
                        yyF5 = -3.5 + IIf(s寸法文字2段, 2.3, 0)
                    }
                    if ( FLG_列車_衝撃 $$ Mark111 != 1 ) {
                        if ( N段数 = 1 ) {
                            yyF5 = 20
                        } else {
                            yyF5 = 3
                        }
                    }

                    if ( yBuzaiFF > 0 ) {
                        For( i8 = 1 To yBuzaiFF
                            i = yGGGGG(i8)
                            部材正荷重数(i) = IIf(Mark111 = 1, yyF5, 部材正荷重数(i) + yyF5)
                        }8
                    } else {
                        For( i = SS1 To SE2
                            部材正荷重数(i) = 部材正荷重数(i) + yyF5
                            if ( ((BXE - BX0) / 連続荷重数) < 220 ) {
                            } else {
                                if ( 荷重方向 = "V" ) {
                                    部材正荷重数(i) = 部材正荷重数(i) + 1.5
                                }
                            }
                        }
                    }

                }
            } //////12/12/299
            End_GRF:
            GRF777:
                                                                                                            */
        }

        private void 部材連続寸法_1(object obj, int 連続荷重数, int 節点S, int 節点E,
                                    double 荷重図開き, string 荷重方向5, int[] 連続荷重mark, double[] 連続荷重_L1, double[] 連続荷重_L2, double[] 連続荷重_P1, double[] 連続荷重_P2,
                                    string dhosei, int SS1, int SE2, bool Mark_Flg, int CASU, int yBuzaiFF, int[] yGGGGG)
        {
            /*/
            var 寸法補助線
            var BSPAN
            var BX0
            var BY0
            var BXE
            var BYE
            var 図BSPAN
            var 図倍率
            var BSN
            var BCS
            var BTAN
            var B角度
            var XX1
            var XX2
            var XX3
            var YY1
            var Yy2
            var YY3
            var PX0
            var PY0
            var PXE
            var PYE
            var PX1D
            var PY1D
            var PX2D
            var PY2D
            var PX3D
            var PY3D
            var 寸法(100) //////09/10/25
            double var X(100)
            double var Y(100)
            var i                       As Integer
            var j                       As Integer
            double var GGII
            double var GGjj
            var HIH                       As Integer
            var XL2
            var NN                      As Integer
            var HV                      As Integer
            var HV5                     As Integer
            var N55                     As Integer
            var XL(100)                 As Single
            var CNum As Integer
            var GHOSEI As Single
            var UUUU As Integer, PPPP As Single
            var Flg3 As Integer //////////////////////////////////////////////////07/07/26
            var AALL As Single ////////////08/07/02
            var J4 As Integer ////////08/07/08
            var J5 As Single ////////08/09/26
            var J6 As Single ////////08/09/26
            var P6 As Single ////////08/09/26
            var J7 As Single ////////08/09/26
            var P7 As Single ////////08/09/26
            var P8 As Single ////////////////////////////09/11/199
            var J8 As Single ////////08/09/26
            var J9 As Single, J10 As Single //////////////////08/10/095
            var yFR橋脚 As Integer
            var yiKozo As Integer
            var 寸法線位置 //////////////////////////////08/10/29
            var wXs As Single, wXe As Single, wYs As Single, wYe As Single //////09/09/300
            var f寸法FLG As Integer //////09/08/14
            var s寸法文字2段 As Boolean ////////////////09/10/20
            var s斜めFLG As Integer //////09/10/24
            var Max荷重 As Single //////09/10/299
            var MK5 As Integer //////09/11/09
            var m調整高 As Single //////10/11/11
            var FLG杭杭 As Boolean //////////////////////////////////11/12/166
            var 鉛直文字列 As String //////////////09/11/16
            鉛直文字列 = "1"
            //
            FLG杭杭 = False //////////////11/12/166
            if ( InStr(部材名(SS部材), "杭") != 0 ) {
                FLG杭杭 = True
            }

            if ( FLG杭杭 = False ) {
                if ( yBuzaiFF > 0 ) { ////////12/12/15
                    For( j = 1 To yBuzaiFF
                        i = yGGGGG(j)
                        if ( InStr(部材名(i), "杭") = 1 ) {
                            FLG杭杭 = True
                            Exit For
                        }
                    }
                } else {
                    For( i = SS1 To SE2
                        if ( InStr(部材名(i), "杭") = 1 ) {
                           FLG杭杭 = True
                           Exit For
                        }
                    }
                }
            }
            if ( FLG杭杭 = True $$ 連続荷重mark(1) = 6 ) { //////12/02/15
                s斜めFLG = 0
                For( i = 1 To 連続荷重数
                    if ( 連続荷重_L1(i) != 0 || 連続荷重_L2(i) != 0 ) {
                        s斜めFLG = 1
                        Exit For
                    }
                }
                if ( s斜めFLG = 0 ) {
                    GoTo ABC //////return;
                }
            }
            if ( Flg_PRESTRES(1) = 1 || Flg_PRESTRES(2) = 1 ) { //////12/02/15
                GoTo ABC //////return;
            }
            s斜めFLG = 0 //////09/10/24
            f寸法FLG = 0
            m調整高 = 0 //////////////10/11/11
            yFR橋脚 = FR橋脚
            yiKozo = iKozo
            //
            if ( Not (yiKozo = 3 $$ g連続Mod) ) {
                    yiKozo = 1 ////////10/01/24 12/12/15
            }
                    yFR橋脚 = 1
            //
            BSPAN = 部材Span(節点S, 節点E)
            ////////09/09/300
            var ii As Integer, i7 As Integer, i8 As Integer //////09/10/14
            wXs = 節X(節点S)
            wXe = 節X(節点E)
            wYs = 節Y(節点S)
            wYe = 節Y(節点E)
            var 荷重方向
            荷重方向 = 荷重方向5 ////////09/10/20
            if ( wYs = wYe $$ (荷重方向 = "V" || 荷重方向 = "M") $$ yBuzaiFF = 0 ) {
                荷重方向 = ""
            }
            if ( SS1 = SE2 $$ 荷重方向 = "H" $$ 連続荷重mark(1) = 2 ) { //////////09/10/24
                s斜めFLG = 2
            }
            ////////////////////////////////////////////////////////////////////////////////09/10/24
            //////10/03/07
            if ( (Abs(SE2 - SS1) > 1 || yBuzaiFF > 0) $$ _
                                (荷重方向 = "V" || 荷重方向 = "M") ) { ////////09/09/301
                if ( 荷重方向 = "V" $$ 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) + 連続荷重_P2(1) < 0 ) {
                    PPPP = min(wYs, wYe)
                    if ( yBuzaiFF > 0 ) { //////////////////09/10/14
                        For( i8 = 1 To yBuzaiFF
                            i7 = yGGGGG(i8)
                            J4 = 部I(i7): PPPP = min(PPPP, 節Y(J4))
                            J4 = 部J(i7): PPPP = min(PPPP, 節Y(J4))
                        }8
                    } else {
                        For( i7 = SS1 To SE2
                            J4 = 部I(i7): PPPP = min(PPPP, 節Y(J4))
                            J4 = 部J(i7): PPPP = min(PPPP, 節Y(J4))
                        }7
                    }
                } else {
                    PPPP = max(wYs, wYe)
                    if ( yBuzaiFF > 0 ) { //////////////////09/10/14
                        For( i8 = 1 To yBuzaiFF
                            i7 = yGGGGG(i8)
                            J4 = 部I(i7): PPPP = max(PPPP, 節Y(J4))
                            J4 = 部J(i7): PPPP = max(PPPP, 節Y(J4))
                        }8
                    } else {
                        For( i7 = SS1 To SE2
                            J4 = 部I(i7): PPPP = max(PPPP, 節Y(J4))
                            J4 = 部J(i7): PPPP = max(PPPP, 節Y(J4))
                        }7
                    }
                }
                wYs = PPPP
                wYe = PPPP
            }
            BX0 = 図X(wXs)
            BY0 = 図Y(wYs)
            BXE = 図X(wXe)
            BYE = 図Y(wYe)
            ////////09/09/300
            水平垂直 = 9 //////////////////////////08/07/02
            if ( BX0 = BXE ) {
                水平垂直 = 1 // 垂直
                AALL = 図Y_SCALE
            }
            if ( BY0 = BYE ) {
                水平垂直 = 0 // 水平
                AALL = 図X_SCALE
            }
            if ( BX0 != BXE ) {
                if ( (Abs(BY0 - BYE) / Abs(BX0 - BXE)) < 0.05 ) { ////////10/10/13
                    水平垂直 = 0 // 水平
                    AALL = 図X_SCALE
                }
            }

            //    if ( 水平垂直 = 9 $$ 荷重方向 = "H" $$ Mark111 = 2 ) { //////09/08/23
            //    For( i = 1 To 連続荷重数
            //        連続荷重_P1(i) = 連続荷重_P1(i) * (-1)
            //        連続荷重_P2(i) = 連続荷重_P2(i) * (-1)
            //    }
            //    }
            if ( dhosei = "" || dhosei = 0 ) { ////////08/10/29
                GHOSEI = hosei
            } else {
                GHOSEI = dhosei //////////hosei////////08/10/29
            }
            if ( g荷重連寸法補正 = 1 ) { //////////////////////////////07/01/17
                GHOSEI = GHOSEI + 3.5
                g荷重連寸法補正 = 0
            }
            if ( BX0 != BXE $$ (節Y0(節点S) + 節Y0(節点E)) / 2 > (YY_max * 0.8) ) { ////////////07/01/177
                g荷重連寸法回数 = g荷重連寸法回数 + 1 ////////////07/01/177
            }
            if ( (水平垂直 = 1 $$ iKozo = 3 $$ 連続荷重数 = 1 $$ 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) != 連続荷重_P2(1)) ) {
                g荷重表記縦 = 1 //////13/02/01
            }
            ////////////////////////////07/11/03
            j = 0
            J4 = 0: J5 = 0: J6 = 0: J7 = 0: P6 = 0: J7 = 0 ////////08/09/26
            J8 = 0: J9 = 0: J10 = 0 ////////08/10/095
            P6 = 0: P7 = 0: P8 = 0 //////09/11/199
            MK5 = 0 //////09/11/09
            For( i = 1 To 連続荷重数
                if ( 連続荷重mark(i) = 1 ) { ////////09/11/16//////Or 連続荷重mark(i) = 11 ) {
                    j = j + 1
                ////////////////////////////////////////09/11/16
                    if ( Len(鉛直文字列) < Len(Format(連続荷重_P1(i), "0.00")) ) { 鉛直文字列 = Format(連続荷重_P1(i), "0.00")
                    if ( Len(鉛直文字列) < Len(Format(連続荷重_P2(i), "0.00")) ) { 鉛直文字列 = Format(連続荷重_P2(i), "0.00")
            //                Exit For
                }
                if ( 連続荷重mark(i) = 4 ) { ////////08/07/08
                  J4 = J4 + 1
                }
                if ( 連続荷重mark(i) = 5 || 連続荷重mark(i) = 11 ) { ////////09/11/16
                  MK5 = MK5 + 1
                }
                ////////////////////////////////////////////////////////////////////////////////////////////////////
                if ( (連続荷重_P1(i) >= 0 || 連続荷重_P2(i) >= 0) ) { //////08/09/26
                    if ( 連続荷重mark(i) = 1 ) {
                        J5 = 1
                        P6 = max(P6, 連続荷重_P1(i))
                        P6 = max(P6, 連続荷重_P2(i))
                   } //////////////////////////////////////////////////////////////////////////////////////////////////////////////!= 09/12/02
                    if ( 連続荷重mark(i) = 2 $$ (連続荷重_P1(i) * 連続荷重_P2(i) != 0 $$ 連続荷重_P1(i) != 連続荷重_P2(i)) ) {
                        J6 = 1
            //                g荷重表記縦 = 1 ////////08/11/28//////09/03/10 コメントにした
                    }
                    if ( 連続荷重mark(i) = 2 $$ (連続荷重_P1(i) * 連続荷重_P2(i) = 0 || 連続荷重_P1(i) = 連続荷重_P2(i)) ) {
                        J7 = J7 + 1
                    }
                    if ( 連続荷重mark(i) = 2 $$ 連続荷重_P1(i) = 連続荷重_P2(i) ) { //////08/10/09
                        J9 = J9 + 1 //////08/10/09
                    }
                    if ( 連続荷重mark(i) = 2 $$ 連続荷重_P1(i) * 連続荷重_P2(i) = 0 ) { //////08/10/09
                        J10 = J10 + 1 //////08/10/09
                    }
                    if ( (連続荷重mark(i) = 4 $$ 連続荷重_P1(i) = 連続荷重_P2(i)) _
                        || (連続荷重mark(i) = 3 $$ 連続荷重_P1(i) * 連続荷重_P2(i) = 0) ) { //////////08/10/09
                        J8 = J8 + 1
                    }
                    if ( 連続荷重mark(i) = 2 || 連続荷重mark(i) = 4 || 連続荷重mark(i) = 3 ) { //////////08/10/09
                        P6 = max(P6, Abs(連続荷重_P1(i))) ////08/10/29
                        P6 = max(P6, Abs(連続荷重_P2(i))) ////08/10/29
                    }
                }
                if ( g荷重表記縦 = 0 || (g荷重表記縦 = 1 $$ 連続荷重_P1(i) != 連続荷重_P2(i)) || 連続荷重mark(i) = 1 ) {  //////08/11/17
                    P7 = max(P7, Abs(連続荷重_P1(i))) ////08/10/29
                    P7 = max(P7, Abs(連続荷重_P2(i))) ////08/10/29
                }
            } ////////////////////////////07/11/03
            //
            var Mark111 As Integer
            //
            if ( FLG車両ZU $$ g荷重表記縦 = 1 $$ J5 = 1 $$ BU荷重MAX > 0 ) { //////14/10/18
                g荷重表記縦 = 0
                J5 = 0
            }
            if ( J5 = 1 $$ FLG車両ZU = False ) { ////////////////////14/10/18
                g荷重表記高 = 0
                Mark111 = 1
            } else {
                if ( g荷重表記縦 = 1 ) {
                    For( i = 1 To 連続荷重数 //////09/11/199
                        if ( (連続荷重mark(i) = 2 || 連続荷重mark(i) = 4) $$ _
                            (連続荷重_P1(i) * 連続荷重_P2(i) = 0 || 連続荷重_P1(i) != 連続荷重_P2(i)) ) {
            //                    if ( P7 != Abs(連続荷重_P1(i)) ) { P8 = max(P8, Abs(連続荷重_P1(i))) //////09/11/199
            //                    if ( P7 != Abs(連続荷重_P2(i)) ) { P8 = max(P8, Abs(連続荷重_P2(i)))
                            P8 = max(P8, Abs(連続荷重_P1(i))) //////09/11/30
                            P8 = max(P8, Abs(連続荷重_P2(i)))
                        }
                    }
                    if ( P8 != 0 ) {
                        P7 = P8
                    }
                    if ( g荷重表記高 < g荷重表記高5 / 1.5 ) {
                        g荷重表記高 = g荷重表記高5 / 1.5
                    } //////09/11/199
                } else {
                    if ( 水平垂直 = 0 $$ g荷重表記高5 > 180 ) { //////10/01/03
            //                g荷重表記高5 = 180
                        g荷重表記高 = 180
                    }
            //            g荷重表記高 = g荷重表記高5
                }
                if ( (MK5 != 0 $$ MK5 = 連続荷重数 $$ 連続荷重mark(1) != 11) ) { //////13/12/15
                    Mark111 = 5
                } else {
                    Mark111 = 連続荷重mark(1)
                }
            }
            if ( (Mark111 = 1 || Mark111 = 5 || Mark111 = 11) $$ 連続荷重数 = 1 ) { //////13/12/15
                if ( 連続荷重_L1(1) = 0 || 連続荷重_L1(1) = BSPAN || 連続荷重_L1(2) = BSPAN ) {
                    if ( 連続荷重_L1(1) = 0 $$ 連続荷重_L2(1) = 0 ) { GoTo ABC
                }
            }
            //////////////////////////////////////////////////////////////
            if ( Mark111 = 6 ) { //////////////////////12/02/15
                if ( 連続荷重数 = 1 ) {
                    if ( 連続荷重_L1(1) = 0 $$ 連続荷重_L2(1) = 0 ) {
                        GoTo ABC //////return;
                    }
                    if ( InStr(部材名(SS部材), "柱") != 0 || InStr(部材名(SS部材), "壁") != 0 ) { //////////////////12/02/15
                        if ( 節X(節点S) != g柱X座標(g柱本数, 1) $$ 連続荷重_L1(1) = 0 $$ 連続荷重_L2(1) = 0 ) {
                            GoTo ABC //////return;
                        }
                    }
                } else {if ( InStr(部材名(SS部材), "杭") != 0 ) { //////////////////12/02/15
                    荷重図開き = Abs(荷重図開き) //////136
                    KUIDAN = 0
            //            Mark111 = 2
            //            For( i = 1 To 連続荷重数
            //                連続荷重mark(i) = 2
            //            }
                }
            }
            Max荷重 = BU荷重MAX //////////////////////////////////////09/10/299
            if ( (J5 = 1 || Mark111 = 5) $$ FLG車両ZU = False ) { //////08/09/26//////09/11/09
                J6 = 0
                J7 = 0
                J8 = 0
                J9 = 0 //////08/10/09
                J5 = IIf(yFR橋脚 = 1, -0.7, 1)
                GHOSEI = 0
                Max荷重 = BP荷重MAX ////////////////09/10/299
                if ( Max荷重 = 0 ) { Max荷重 = P7 ////////////09/11/30
            } else {
                if ( J10 = 連続荷重数 ) {
                    J6 = 1 //////08/10/095
                    J7 = 0 //////08/10/096
                }
                if ( J6 = 1 ) {
                    if ( (P6 / Max荷重) < 0.7 ) {
                        if ( J10 = 連続荷重数 ) { //////08/10/096
                            J6 = 0
                        } else {
            //                    J6 = min(1 / (P6 / Max荷重), 3) //////////09/04/06
                            J6 = 0.3 //////////09/04/06
                        }
                    } else {if ( (P6 / Max荷重) > 0.9 ) {
                        if ( yFR橋脚 = 1 ) {
                            if ( 部材正荷重数(SS1) < 20 ) {
                                J6 = -1.5
                            } else {
                                J6 = -2.2
                            }
                        } else {
                            J6 = 2.5
                        }
                    } else {
                        J6 = -0.5
                    }
                    if ( yiKozo = 3 || g連続Mod ) {
                        J6 = -1.5
                    }
                }
            }
            if ( J7 = 連続荷重数 ) { J7 = 1 } else { J7 = 0
            if ( J9 = 連続荷重数 ) { J9 = 1 } else { J9 = 0 //////08/10/09
            if ( J8 = 連続荷重数 ) {
                if ( ((P6 / Max荷重) ^ 0.7) < 0.6 ) { //////08/10/09
                    J8 = 1.5
                } else {if ( (P6 / Max荷重) > 0.95 ) {
                    J8 = 1.3
                } else {
                    J8 = Round((Max荷重 / P6) ^ 0.5, 1) //////1//////08/10/29
                }
            } else {
                J8 = 0
            }
            //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////08/09/26
            //    if ( (Mark111 = 1 || Mark111 = 11) ) {
            if ( j != 0 ) {
                if ( FLG記号 = 1 ) { ////////////////07/05/13
                    GHOSEI = GHOSEI + IIf(j = 連続荷重数, 0.5, 1) //////+ 3
                }
            } else {
                if ( g連続Mod ) {
                    j = 2 ////////////////////06/12/14
                    GHOSEI = max(GHOSEI, 0) ////////////////////連続梁 05/02/06
                        For( i = 1 To 連続荷重数
                              if ( (連続荷重mark(i) = 2 || 連続荷重mark(i) = 3 || 連続荷重mark(i) = 4) $$ _
                                 (連続荷重_P1(i) != 連続荷重_P2(i)) $$ ((連続荷重_L2(i) - 連続荷重_L1(i)) * AALL * Twip) < 0.5 ) {
                                    j = 0
                                    Exit For
                              }
                        }
                        if ( FLG記号 = 1 ) { ////////////////07/05/13
                            if ( j = 0 ) {
                                GHOSEI = GHOSEI + 5.5
                            }
                        }
                } else {
                    if ( yFR橋脚 = 2 ) {
                        GHOSEI = max(GHOSEI, 0) ////////////////////////////// 05/09/20
                    } else {
                        j = 2 ////////////////////06/12/14
                        For( i = 1 To 連続荷重数
                              if ( 連続荷重mark(i) != 2 ) { j = 0
                        }
                    if ( j = 2 ) { // if ( 連続荷重mark(1) = 2 ) {
                        UUUU = 0: PPPP = 0 ////////////////////06/12/14
                        For( i = 1 To 連続荷重数
                              if ( (連続荷重_P1(i) != 連続荷重_P2(i)) ) { UUUU = 1
                              PPPP = max(PPPP, Abs(連続荷重_P1(i)))
                              PPPP = max(PPPP, Abs(連続荷重_P2(i)))
                        }
            //                if ( (連続荷重mark(1) = 2 || 連続荷重mark(1) = 3) ) {
            //                    gHosei = -荷重寸法線位置(1) * (1 - (Abs(max(Abs(連続荷重_P1(1)), Abs(連続荷重_P2(1)))) / Max荷重) ^ 0.25) ////// 06/02/23

            //                    gHosei = gHosei / 3
            //                    if ( gHosei < -1.5 ) { ////////////06/04/06
            //                    gHosei = -1.2
            //                    }
                            if ( (Mark111 = 2 $$ GHOSEI < -2) || (Mark111 = 3 $$ GHOSEI > -2) ) {
                                if ( (Mark111 = 2 $$ GHOSEI < -2) ) { //////08/06/17
                                    GHOSEI = 2.5 //////08/06/17
                                } else {
                                    GHOSEI = -荷重寸法線位置(1) * (1 - (PPPP / Max荷重) ^ 0.25) ////// 06/02/23
                                }
                            } else {
                                GHOSEI = GHOSEI / 2.5
                            }
                            if ( UUUU = 0 ) { ////////////////////////////////////////////////////////////06/12/14
                                if ( ((PPPP / Max荷重) ^ 0.5) > 0.8 ) {
                                    GHOSEI = max(GHOSEI, 2.5)
                                } else {
                                    GHOSEI = max(GHOSEI, 1)
                                }
                            } else {
                                GHOSEI = GHOSEI + IIf(((PPPP / Max荷重) ^ 0.5) > 0.8, 1.5, 0)
                                GHOSEI = GHOSEI + ((PPPP / Max荷重) ^ 0.6) * 1.3 ////////////////06/12/14
                                if ( GHOSEI < hosei ) {
                                    GHOSEI = max(hosei, 9)
                                }
                            }
                            if ( GHOSEI < -5 ) { ////////////06/09/06
                                GHOSEI = -5
                                if ( FLG記号 = 1 ) { ////////////// ////////08/06/17
                                    GHOSEI = GHOSEI + 5.5
                                }
                            } else {if ( GHOSEI > -0.8 $$ Mark111 = 3 ) { ////////////06/09/06
                                GHOSEI = -1
                                if ( FLG記号 = 1 ) { ////////////// ////////08/06/17
                                    GHOSEI = GHOSEI + 5.5
                                }
                            }
                            if ( BX0 = BXE ) { //////////////08/06/17
                                GHOSEI = GHOSEI + 4
                            }
                        } else { ////// 05/09/20
                            GHOSEI = 0
                        }
            //                }
                    }
                }
            }
            ////////////////////////////////////////////////////////////////////////// 05/02/05
            CNum = 0
            if ( yiKozo = 1 ) {
            i = 節点S
            Do
                        GGII = i
                        GGjj = (i + 1)
                        if ( GGII * GGjj = 0 || GGII > 1000 ) { Exit Do ////////05/04/26
                        j = 0
                        HIH = 0
                        Do
                            j = j + 1
                            if ( j > 部材_max ) { Exit Do
                            if ( GGII = 部I(j) $$ GGjj = 部J(j) ) {
                                HIH = j
                                Exit Do
                            }
                        Loop
                        if ( HIH > 0 ) {
                            if ( ZFAngle(HIH) = 0 $$ 部材正荷重数(HIH) > 20 ) {
                                CNum = 1
                                Exit Do
                            }
                        }
                i = i + 1
                if ( i = 節点E ) { Exit Do
             Loop
                if ( CNum = 0 $$ g連続Mod ) {
                GHOSEI = max(GHOSEI, 8) ////////////////////連続梁 05/02/06
                }
            }
            //    if ( g荷重表記縦 = 1 ) { gHosei = 0 //////09/04/02
            //
            Select Case 荷重方向
            Case "V", "M", "S"
                BSPAN = Round(Abs(節X0(節点S) - 節X0(節点E)), 3)
                BY0 = max(BY0, BYE)
                BYE = BY0
            Case "H"
                BSPAN = Round(Abs(節Y0(節点S) - 節Y0(節点E)), 3)
                if ( (節X0(節点S) + 節X0(節点E)) / 2 < (JX_max + JX_min) / 2 ) { ////////////07/01/08
                    if ( s斜めFLG = 0 ) {
                    BX0 = min(BX0, BXE)
                    } else {
                    BX0 = min(BX0, BXE)
                    }
                } else {
                    if ( s斜めFLG = 0 ) {
                    BX0 = max(BX0, BXE)
                    } else {
                    BX0 = max(BX0, BXE)
                    }
                }
                BXE = BX0
            Case } else {
            End Select
            図BSPAN = Sqr((BXE - BX0) ^ 2 + (BYE - BY0) ^ 2)
            if ( 図BSPAN <= 0 ) {
                図BSPAN = 1
            }
            if ( BSPAN <= 0 ) {
                BSPAN = 1
            }
            図倍率 = 図BSPAN / BSPAN
            BSN = (BYE - BY0) / 図BSPAN
            BCS = (BXE - BX0) / 図BSPAN
            if ( 荷重方向 = "V" ) { //////And 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) + 連続荷重_P2(1) > 0 ) { //////10/03/07
            //        BCS = Abs(BCS)
            }
            //    水平垂直 = 9////////////////////////////////////////08/07/02
            //    if ( BX0 = BXE ) {
            //        水平垂直 = 1 // 垂直
            //    }
            //    if ( BY0 = BYE ) {
            //        水平垂直 = 0 // 水平
            //    }
            BTAN = 0
            if ( BX0 != BXE ) {
                BTAN = (BYE - BY0) / (BXE - BX0)
            }
            B角度 = 180 * Atn(BTAN) / π
            if ( BX0 > BXE ) {
                B角度 = B角度 + 180
            }
            if ( BX0 = BXE ) {
                B角度 = 90
            }
            if ( BYE < BY0 ) {
                B角度 = 270
            }
            //
            Flg3 = 0
            Select Case 荷重方向 ////////////////////07/01/08
            Case "V", "M", "S"
                    PX0 = HEN_X(wXs) - 荷重図開き * BSN
                    PY0 = min(HEN_Y(wYs), HEN_Y(wYe)) - 荷重図開き * Abs(BCS) ////////////07/01/09
            Case "H"
                if ( (節X0(節点S) + 節X0(節点E)) / 2 < (JX_max + JX_min) / 2 ) { ////////////07/01/08
                    if ( 連続荷重_P1(1) + 連続荷重_P2(1) > 0 $$ s斜めFLG = 0 ) { ////////09/10/24
                        PX0 = min(HEN_X(wXs), HEN_X(wXe)) - 荷重図開き * BSN * 1 ////////09/10/24
                    } else {
                        if ( s斜めFLG = 0 ) {
                            PX0 = min(HEN_X(wXs), HEN_X(wXe)) - 荷重図開き * BSN * 13 ////////09/08/24
                        } else {
                            PX0 = min(HEN_X(wXs), HEN_X(wXe)) - Abs(荷重図開き * BSN) * 10 ////////09/08/24
                            Flg3 = 1
                        }
                    }
                    PY0 = HEN_Y(wYs) - 荷重図開き * BCS
                } else {
                    if ( 連続荷重_P1(1) + 連続荷重_P2(1) > 0 $$ s斜めFLG = 0 ) { ////////09/10/24
                    PX0 = min(HEN_X(wXs), HEN_X(wXe)) // + 荷重図開き * BSN * 0.3
                    } else {
                        PX0 = max(HEN_X(wXs), HEN_X(wXe)) - 荷重図開き * BSN * IIf(s斜めFLG = 0, 0, 10) ////////09/10/24
                        if ( s斜めFLG != 0 ) {
                            Flg3 = 1 ////////////07/07/26//////////////////////////////09/10/24 コメントにした
                        }
                    }
                    PY0 = HEN_Y(wYs) - 荷重図開き * BCS
                }
            Case } else {
                PX0 = HEN_X(wXs) - 荷重図開き * BSN
                if ( yiKozo = 1 $$ 水平垂直 = 0 $$ N段数 = 1 $$ 連続荷重数 = 1 $$ _
                   Abs(YY_max - wYs) > (YY_max - YY_min) / 5 ) { //////////////////////////////////07/06/177
                    PY0 = HEN_Y(wYs) + 荷重図開き * BCS
                } else {
                    if ( 連続荷重数 = 1 $$ Mark111 = 11 $$ _
                                Abs(YY_max - wYs) <= (YY_max - YY_min) / 10 ) { //////08/06/16
                        PY0 = HEN_Y(wYs) + 荷重図開き * BCS
                    } else {
                        if ( 水平垂直 = 0 $$ Mark111 = 6 ) {
                            PY0 = HEN_Y(wYs) - Abs(荷重図開き) * BCS
                        } else {
                            PY0 = HEN_Y(wYs) - 荷重図開き * BCS
                        }
                    }
                }
            //        PX0 = (HEN_X(wXs) + HEN_X(wXe)) / 2 - 荷重図開き * BSN //////////////////07/01/077
            //        PY0 = (HEN_Y(wYs) + HEN_Y(wYe)) / 2 - 荷重図開き * BCS
            End Select
            //
            //////////////////////////////////////////06/01/29
            UUUU = 0: PPPP = 0
            For( i = 1 To 連続荷重数
                if ( 連続荷重mark(i) = 2 $$ 連続荷重_P1(i) = 連続荷重_P2(i) ) {
                    PPPP = max(PPPP, Abs(連続荷重_P1(i)))
                } else {
                    UUUU = 1
            //            Exit For////////09/04/02
                }
            }
            //////////////////////////////////////////06/01/29
            XL(1) = 0
            NN = 1
            集中有無 = 0
            HV = 0
            HV5 = 0
            N55 = 1
            j = 0
            //
            For( i = 1 To 連続荷重数
                if ( 連続荷重_L1(i) - XL(NN) > 0.001 ) {
                    NN = NN + 1
                    XL(NN) = 連続荷重_L1(i)
                }
                if ( s斜めFLG = 2 ) { ////////09/10/24
                    連続荷重_P1(i) = Abs(連続荷重_P1(i))
                    連続荷重_P2(i) = Abs(連続荷重_P2(i))
                }
                Select Case 連続荷重mark(i)
                Case 1, 5, 11
            //            if ( 連続荷重_P2(I) != 0 ) {
                        if ( Not (連続荷重_P2(i) = 0 $$ 連続荷重_L2(i) = 0) ) { ////////if ( 連続荷重_P2(I) != 0  07/06/11
                        if ( 連続荷重_L2(i) != XL(NN) ) { //////////10/01/03
                            XL2 = Round(連続荷重_L2(i), 3)
                            NN = NN + 1
                            XL(NN) = XL2
                        }
                        }
                        if ( 連続荷重mark(i) != 5 ) {
                            集中有無 = 1
                        }
                Case 2, 4, 6, 7
                        if ( 連続荷重_L2(i) != 0 ) {
                            XL2 = Round(BSPAN - 連続荷重_L2(i), 3)
                            NN = NN + 1
                            XL(NN) = XL2
                        }
                        if ( 連続荷重_P1(i) != 連続荷重_P2(i) $$ 連続荷重_P1(i) != 0 $$ 連続荷重_P2(i) != 0 ) {
                            HV = 1
                            HV5 = 1
                        }
                Case 3
                    XL2 = Round(連続荷重_L1(i) + (BSPAN - 連続荷重_L1(i) - 連続荷重_L2(i)) / 2, 3)
                    NN = NN + 1
                    XL(NN) = XL2
                    if ( 連続荷重_L2(i) != 0 ) {
                        XL2 = Round(BSPAN - 連続荷重_L2(i), 3)
                        NN = NN + 1
                        XL(NN) = XL2
                    }
                Case } else {
                    if ( 連続荷重_L2(i) != 0 ) {
                        XL2 = Round(BSPAN - 連続荷重_L2(i), 3)
                        NN = NN + 1
                        XL(NN) = XL2
                    }
                End Select
            }

            if ( 連続荷重数 = 1 $$ 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) + 連続荷重_P2(1) = 0 $$ _
                                                          連続荷重_L1(1) + 連続荷重_L2(1) = 0 ) {
                NN = NN + 1
                XL(NN) = BSPAN / 2 ////////12/11/27 逆対称の分布荷重

            } else {if ( XL2 != BSPAN ) { //////12/12/15
            //        j = 0
            //        if ( 水平垂直 = 1 || 連続荷重mark(1) = 1 || 連続荷重mark(1) = 5 || 連続荷重mark(1) = 11 ) { j = 1
            //        if ( (水平部材最下端 = (wYs + wYe) / 2 || YY_max = (wYs + wYe) / 2) ) {
            //            if ( XL(NN) < BSPAN ) { j = 1
            //        }
                if ( XL(NN) < BSPAN ) {
                    NN = NN + 1
                    XL(NN) = BSPAN //////12/12/15
                }
            }
                    //////////////////////////////08/07/06
            if ( iKozo = 1 $$ 連続荷重数 = 1 $$ NN <= 2 $$ 連続荷重mark(1) = 2 $$ wYs = wYe $$ _
                        (Abs((YY_max + YY_min) / 2 - wYs) < 1 || _
                        (Abs(水平部材最下端 - wYs) < 1 $$ 連続荷重_P1(1) + 連続荷重_P2(1) > 0)) ) {
                GoTo GRF777 ////////////13/04/08
            }

            N55 = 1
            j = 0
            For( i = 1 To 連続荷重数
                if ( 連続荷重_L1(i) - XL(N55) > 0.001 ) {
                    N55 = N55 + 1
                }
                Select Case 連続荷重mark(i)
                Case 1, 5, 11
                    if ( Not (連続荷重_P2(i) = 0 $$ 連続荷重_L2(i) = 0) ) {
                        N55 = N55 + 1
                    }
                    if ( 連続荷重mark(i) != 5 ) {
                        j = 1
                    }
                Case 2, 6, 7
                    if ( 連続荷重_L2(i) != 0 ) {
                        N55 = N55 + 1
                    }
                    if ( i = 連続荷重数 ) {
                        AALL = (XL(N55) - XL(N55 - 1))
                    } else {
                        AALL = (XL(N55 + 1) - XL(N55))
                    }
                    if ( 連続荷重mark(i) = 2 $$ (連続荷重_P1(i) != 連続荷重_P2(i)) ) {
                        if ( (yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) ) {
            //                    j = 2 //////08/10/29
                        }
                    }
                Case 3
                    N55 = N55 + 1
                    if ( 連続荷重_L2(i) != 0 ) {
                        N55 = N55 + 1
                    }
                    if ( (max(Abs(連続荷重_P1(i)), Abs(連続荷重_P2(i))) / Max荷重) < 0.2 ) { //////09/11/09
                        j = 3
                    }
                Case 4
                    N55 = N55 + 1
                    if ( (max(Abs(連続荷重_P1(i)), Abs(連続荷重_P2(i))) / Max荷重) < 0.2 ) { //////09/11/09
                        j = 4
                    }
                Case } else {
                    if ( 連続荷重_L2(i) != 0 ) {
                        N55 = N55 + 1
                    }
                End Select
            }
            if ( 集中有無 != 1 $$ J7 = 0 ) {
                GHOSEI = 1.5 + 1
                if ( j = 2 ) {
                    GHOSEI = 9.5 * (P6 / Max荷重)
                }
            }
            //////////////////////////////08/07/06
            var gY55 As Single, GOUKEI As Single, J55 As Single, J88 As Single
            if ( (Mark111 = 2 || Mark111 = 3 || Mark111 = 4) ) {
                if ( ((P7 / Max荷重) ^ 1.2) < 0.3 ) {
                    P7 = Round(0.35 * Max荷重, 1)
                    P6 = P7 //////09/11/13
                    if ( ((P7 / Max荷重) ^ 1.2) < 0.2 ) {
                        P7 = Round(0.2 * Max荷重, 1)
                        P6 = P7 //////09/11/13
                    } else {if ( ((P7 / Max荷重) ^ 1.2) < 0.15 ) {
                        P7 = Round(0.12 * Max荷重, 1)
                        P6 = P7 //////09/11/13
                    }
                    GHOSEI = 0
                    hosei = 0
                } else {if ( (P7 / Max荷重) > 0.8 ) {
                    P7 = Max荷重
                    J6 = -0.5
                }
            }
            gY55 = 0
            if ( FLG_列車_衝撃 ) {
                if ( N段数 = 1 ) {
                    gY55 = -51
                } else {
                    gY55 = -120
                }
                if ( 荷重方向 = "M" ) { //////12/12/17
                    gY55 = -80
                }
            } else {if ( J5 = 0 $$ J10 = 連続荷重数 ) {
                gY55 = 150 * (P7 / Max荷重)
                if ( P7 < 100 $$ Not (yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) ) {
                gY55 = gY55 - 100
                }
            } else {if ( J5 = 0 $$ J7 = 1 $$ J9 = 1 ) {
                if ( (P7 / Max荷重) > 0.6 ) {
                    J7 = 1
                    if ( (P7 / Max荷重) > 0.9 ) { J7 = 0
                } else {
                    J6 = 1
                }
            }
            if ( J5 != 0 ) {
                J55 = J5
                if ( SS1 = SE2 ) {
                    if ( N段数 > 1 ) {
                        if ( (P7 / BP荷重MAX) > 0.9 ) {
                            if ( P7 >= 100 ) {
                                J55 = 1
                            } else {if ( P7 < 33 ) {
                                J55 = 0.5
                            }
                        } else {
                            J55 = 1.5
                        }
                    } else {
                        if ( P7 >= 100 ) { J55 = 1
                    }
                } else {
                    if ( Len(鉛直文字列) >= 9 ) {
                        if ( P7 >= 100000 ) {
                            J55 = 0.1
                            GHOSEI = GHOSEI - 2
                        } else {
                            J55 = 1.2
                        }
                    } else {if ( Len(鉛直文字列) = 8 ) {
                        if ( P7 >= 10000 ) {
                            J55 = 0.1
                            GHOSEI = GHOSEI - 2
                        } else {
                            J55 = 1.2
                        }
                    } else {if ( Len(鉛直文字列) = 7 ) {
                        if ( P7 >= 1000 ) {
                            J55 = 0.4
                        } else {
                            J55 = 1.3
                        }
                    } else {if ( Len(鉛直文字列) = 6 ) {
                        if ( P7 >= 100 ) {
                            if ( N段数 = 1 ) {
                                J55 = 0.1
                            } else {
                                if ( (P7 / Max荷重) > 0.99 ) {
                                    J55 = 0.5
                                } else {
                                    J55 = -0.3
                                }
                            }
                        } else {
                            J55 = 0.7
                        }
                    } else {if ( Len(鉛直文字列) >= 5 ) {
                        J55 = 0
                    }
                }
            if ( FLG車両ZU = True ) {
            J55 = 1
            GHOSEI = 0.5
            }
                if ( (GHOSEI = 0.5 || GHOSEI = 2.5) $$ Abs(YY_max - wYs) > (YY_max - YY_min) / 5 ) { ////////08/11/27
                    J55 = J5
                }
                GOUKEI = (J7 * 60 + J88 * 160 - J55 * 120 - J6 * 80 + GHOSEI * 20) // - gY55
                if ( Mark111 = 5 || Mark111 = 11 ) { ////////09/11/17
                    if ( g連続Mod = False ) { //////13/04/25
                    GOUKEI = 50
                    } else {
                    GOUKEI = 180 //////13/04/25
                    }
                }
                GoTo YNEXT
            }
            if ( g荷重表記縦 = 0 $$ g荷重表記高 != 0 ) { ////////08/10/29
                if ( Mark111 = 4 $$ g荷重表記縦 = 0 ) { //////09/11/202
                    g荷重表記高 = 220
                    GOUKEI = 150
                } else {
                    if ( g荷重表記高 < 100 ) { // g荷重表記高 = 100
            //            GOUKEI = 260 - 100 - gY55 + 60  //////06/10/29
                        GOUKEI = 260 - g荷重表記高 - gY55 + 60 //////////////09/03/10
                    } else {
                        GOUKEI = 260 - g荷重表記高 - gY55 + 60
                        if ( (P7 / Max荷重) > 0.9 ) { //////09/11/12
                            if ( g荷重表記高 < 260 ) {
                                if ( g荷重表記高 = 180 $$ gY55 = 0 $$ N段数 = 1 ) { ////////10/01/03
                                    GOUKEI = 260 ////////10/02/03//////720 ////////10/01/03
                                } else {
            //                            if ( g荷重表記高 = 180 ) { ////////////13/04/177
            //                            GOUKEI = 60
            //                            } else {
                                    GOUKEI = 160
            //                            }
                                }
                            } else {
                                GOUKEI = 260 ////////10/01/03
                            }
                        } else {
                            if ( g荷重表記高 > 140 $$ GOUKEI < 220 ) { ////////09//11/199
                                GOUKEI = 220
                            } else {
                                GOUKEI = 280 + GOUKEI
                                if ( ((P7 / Max荷重) ^ 1.3) < 0.3 ) { //////09/11/13
                                    GOUKEI = 260
                                }
                            }
                        }
                    }
                }
            } else {
                if ( g荷重表記縦 = 0 $$ (P7 / Max荷重) < 0.3 $$ N段数 != 1 $$ gY55 = 0 ) {  //////08/10/29
                    if ( (J7 = 1 $$ J9 = 1) $$ J8 = 0 ) {
                        if ( (P7 / Max荷重) < 0.2 ) {
                            GOUKEI = -20
                        } else {
                            GOUKEI = 0
                        }
                    } else {if ( J7 = 1 $$ J8 = 0 ) {
                        GOUKEI = 120 * (1 - (P7 / Max荷重) ^ 1.5)
                    } else {
                        GOUKEI = 300 * (1 - (P7 / Max荷重) ^ 0.7)
                    }
                } else {
                    J55 = J5
                    J88 = J8
                    if ( J5 + J6 + J7 + J8 + gY55 = 0 ) {
                        if ( (P7 / Max荷重) < 0.6 ) {
                            J88 = Round((P7 / Max荷重), 1)
                            if ( (P7 / Max荷重) < 0.1 ) {
                                J88 = 1.5
                            }
                        }
                            if ( Mark111 = 4 $$ g荷重表記縦 = 1 $$ hosei > 0 ) {
                                J55 = 1.5 //+ (g荷重表記高 / 300)
                            }
                    } else {if ( g荷重表記縦 = 1 || (P7 / Max荷重) > 0.85 ) {
                        if ( (yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) ) {
                            if ( (P7 / Max荷重) < 0.5 $$ P7 >= 10 ) {
                                J55 = Round(5 * (P7 / Max荷重) ^ 0.5, 1)
                            } else {
                                J55 = Round(3 * (P7 / Max荷重) ^ 0.5, 1) ////////09/11/199
                                if ( 下床文字表示 = 0 $$ 連続荷重_P1(1) * 連続荷重_P2(1) < 0 $$ g荷重表記高 > 260 ) {
            //                        J55 = J55 - Round(g荷重表記高 / 20, 1) //////09/12/04
                                }
                            }
            //                    J6 = 0 //-0.5
                            if ( J6 = 0 ) {
                                J6 = -0.5
                                J7 = 0
                            } else {if ( J6 > 0 ) { //////08/11/05
                                J6 = 2
                            } else {
                                if ( (P7 / Max荷重) > 0.95 ) { ////////////////////08/11/09////08/12/06
                                    J6 = J6 + 2.5 ////////08/11/09
                                } else {
                                    J6 = J6 + 2 ////////08/11/13
                                }
                            }
                        } else {
            //                    J55 = Round(2 * (P7 / Max荷重), 1)
                            J55 = Round(5.5 * (P7 / Max荷重) ^ 0.5, 1) ////////////08/12/07 //////09/04/06
                            if ( g荷重表記縦 = 1 $$ J55 < 4 ) { ////////09/11/11
                                J55 = J55 + 1.5
                            }
                            if ( (P7 / Max荷重) > 0.9 ) { //////09/04/06
                                if ( J6 < 0 ) { J6 = J6 / 2
                            } else {
                                if ( J6 < 0 ) { J6 = 2.5 ////////////J6 = 0//////////////////08/11/17
                                if ( (P7 / Max荷重) < 0.2 ) { J55 = J55 + 0.8 //////09/04/06
                            }
                            J7 = 0
                        }
                    } else {if ( (P7 / Max荷重) > 0.8 ) {
                        J6 = J6 + 2
                    } else {if ( (P7 / Max荷重) < 0.15 $$ J8 = 0 ) {
                        if ( J6 = 1 ) {
                            J6 = 0
                            J88 = 1.8
                        } else {
                            J7 = 2
                        }
                    }
                    GOUKEI = (J7 * 60 + J88 * 160 - J55 * 120 - J6 * 80 - gY55)
                    if ( g荷重表記縦 = 1 $$ g荷重表記高 < 120 $$ GOUKEI < -560 ) { ////09/12/25////09/11/199
                        GOUKEI = -560 ////////09/12/25//////-450
                    }
                }
            } ////////08/10/29
            YNEXT:
            if ( 水平垂直 = 0 $$ (Mark111 = 2 || Mark111 = 3 || Mark111 = 4) ) { ////////09/11/11
                if ( 荷重図開き < 0 ) {
                    GOUKEI = GOUKEI - 180 //09/11/16
                } else {if ( (g荷重表記縦 = 1 $$ GOUKEI * 1.3 > -400 $$ GOUKEI < 0) ) { ////////09/11/11
                    GOUKEI = GOUKEI * 1.3
                } else {if ( (g荷重表記縦 = 1 $$ GOUKEI < -630 $$ GOUKEI < 0) ) { ////////09/11/11 $$ GOUKEI < -650 ////10/01/14
                    GOUKEI = -600
                }
                if ( 下床文字表示 = 0 $$ 連続荷重_P1(1) * 連続荷重_P2(1) < 0 $$ g荷重表記高 > 250 ) { //////09/12/04
                    GOUKEI = -650 - Round(g荷重表記高 / 2, 1) //////09/12/04
                }
                if ( g荷重表記縦 = 0 $$ iKozo = 3 $$ g連続Mod = False $$ (P7 / Max荷重) < 0.75 $$ 荷重図開き > 0 ) { //////13/04/19
                    if ( 連続荷重数 = 1 $$ 連続荷重_L1(1) + 連続荷重_L2(1) = 0 $$ wXs = XXYY(2) $$ wXe = XXYY(1) $$ wYs != YY_max ) {
                        NN = 1
                    }
                }
            //            GOUKEI = g荷重表記高 + 50
            //            寸法線位置 = -7.07
            //            寸法補助線 = -3.5
            //        }
            } else {if ( 水平垂直 = 0 $$ GOUKEI < -500 $$ (Mark111 = 5 || Mark111 = 11) ) {
                GOUKEI = -180 ////////09/11/11
            }

            GOUKEI = Round(GOUKEI, 0) ////////08/10/29//////08/11/27
            ////////09/02/20
            var yyF5 As Single, yyF6 As Single //////09/08/05
            yyF5 = 0
            if ( Not (水平垂直 = 1 $$ Mark111 = 1) ) { //////14/11/16
                if ( (水平垂直 = 1 $$ (連続荷重_P1(1) < 0)) ) { ////////09/08/03
                    if ( Mark111 = 1 ) {
                        if ( Len(Format(P7, "0.00")) > 6 ) {
                            yyF5 = 450
                        } else {
                            yyF5 = 350
                        }
                    } else {
                        if ( g荷重表記縦 = 0 $$ N段数 = 1 $$ 連続荷重_P1(1) = 連続荷重_P2(1) ) {
                            if ( FLG杭杭 || yiKozo != 3 ) {
                                yyF5 = -100 ////////17/02/28
                            } else {
                                yyF5 = -130
                            }
                        }
                    }
                } else {if ( (水平垂直 = 1 $$ (連続荷重_P1(1) > 0)) ) { ////////17/02/28
                        if ( g荷重表記縦 = 0 $$ N段数 = 1 $$ 連続荷重_P1(1) = 連続荷重_P2(1) ) {
                            if ( FLG杭杭 || yiKozo != 3 ) {
                                yyF5 = 50
                            } else {
                                yyF5 = 50
                            }
                        }
                }
            } else {if ( (水平垂直 = 1 $$ Mark111 = 1) ) {
                    if ( 連続荷重_P1(1) > 0 ) {
                        寸法線位置 = IIf(N段数 = 1, -3, -9) ////////14/11/16
                        寸法補助線 = 3
                        yyF5 = -150
                        f寸法FLG = -1
                        if ( FR橋脚 = 2 ) { //////////17/03/12
                            yyF5 = -1700
                            寸法線位置 = 10
                            寸法補助線 = -5
                        }
                    } else {
                        寸法線位置 = 2.5 + 15.5 ////////14/11/16
                        寸法補助線 = 4
                        yyF5 = 0
                        f寸法FLG = 1
                    }

                    For( i = 1 To NN
                        寸法(i) = F2(XL(i + 1) - XL(i))
                        XL(i) = 図倍率 * XL(i)
                        X(i) = PX0 + XL(i) * BCS + yyF5
                        Y(i) = PY0 - XL(i) * BSN + GOUKEI * BCS
                    }
                    this.SunPou2("<", NN, 寸法線位置, 寸法補助線, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, , 荷重図開き)
                    寸法線位置 = -5.5: 寸法補助線 = -2
                    GoTo Next_GRF ////////09/11/12
            } //////09/09/25
            if ( Mark111 = 2 $$ g荷重表記縦 = 0 $$ 水平垂直 = 0 $$ g荷重表記高5 > 180 $$ 荷重図開き > 0 ) {
                GOUKEI = Round(g荷重表記高5, 0) //////13/04/25
                寸法線位置 = -16.5
                寸法補助線 = -3.5
                if ( (P7 / Max荷重) < 0.4 ) {
                寸法線位置 = -14.5
                }
            }
               if ( FLG車両ZU = True $$ BU荷重MAX > 0 ) { ////////14/10/18
                    if ( Mark111 = 1 ) {
                        if ( 連続荷重_P1(1) < 100 ) { GOUKEI = 50 } else { GOUKEI = -20
                    } else {
                        GOUKEI = 111
                    }
               } else {if ( Mark111 = 2 $$ g荷重表記縦 = 0 $$ 水平垂直 = 0 $$ g荷重表記高5 < 120 $$ 荷重図開き > 0 ) {
            //            GOUKEI = 30 ////////14/11/26
               }
            if ( FLG車両ZU ) {
                GOUKEI = 0
            }
            For( i = 1 To NN
                寸法(i) = F2(XL(i + 1) - XL(i))
                XL(i) = 図倍率 * XL(i)
                X(i) = PX0 + XL(i) * BCS + yyF5 //////09/02/20
                if ( 荷重方向 = "V" || 荷重方向 = "M" || 荷重方向 = "S" ) {
                    Y(i) = PY0 - XL(i) * BSN + GOUKEI * Abs(BCS)
                } else {
                    Y(i) = PY0 - XL(i) * BSN + GOUKEI * BCS
                }
            }
            if ( X(1) = X(連続荷重数) ) {
                HV = 0
            }
            //////////
            obj.FontSize = 荷重寸法Fontsize
            obj.PenWidth = 部材荷重寸法Pen幅
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(obj.PenWidth))
            }
            obj.PenColor = QBColor(部材荷重寸法Pen色)
            //
            if ( Mark111 = 2 $$ g荷重表記縦 = 0 $$ 水平垂直 = 0 $$ g荷重表記高5 > 180 $$ 荷重図開き > 0 ) { GoTo GRF9 //////13/04/25
            if ( 寸法線位置 = -7.07 ) { GoTo GRF9 //////13/04/19
            Select Case Mark111
            Case 1, 2, 3, 4, 5, 6, 7, 11
                //寸法線位置  寸法補助線 mm
                if ( Mark111 = 1 || Mark111 = 11 || Mark111 = 5 ) {
                    寸法線位置 = -(荷重寸法線位置(1) + GHOSEI) * Sgn(荷重図開き)
                    if ( (yiKozo = 1 || yiKozo = 3) $$ 水平垂直 = 0 $$ N段数 = 1 $$ 連続荷重数 = 1 $$ _
                       Abs(YY_max - wYs) > (YY_max - YY_min) / 5 ) { //////////////////////////////////07/06/177//////////////////////////12/12/15
                        寸法線位置 = 3.001
                    }
            //////09/11/09
                    if ( 水平垂直 = 1 $$ Mark111 = 5 ) { //////Not (節X(節点S) = g柱X座標(g柱本数, 1) || 節X(節点S) = g柱X座標(1, 1)) ) {
                        if ( 節X0(節点S) < (JX_max + JX_min) / 2 ) {
                            寸法線位置 = -7
                            寸法補助線 = 寸法線位置 + 1
                            yyF5 = -150
                            f寸法FLG = -1
                        } else {
                            寸法線位置 = 3
                            寸法補助線 = 寸法線位置 - 1
                            yyF5 = 50
                            f寸法FLG = 1
                        }
                        For( i = 1 To NN
                            X(i) = PX0 + XL(i) * BCS + yyF5
                        }
                        GoTo GRF
                    }
            //////09/11/09
                } else {
                    if ( FLG杭杭 || (yiKozo != 2 $$ 水平垂直 = 1) ) { //////////////09/01/28////Or (yiKozo != 3 $$ 水平垂直 = 1)////07/06/11
                        if ( 荷重図開き > 0 ) {
                        寸法線位置 = -(荷重寸法線位置(2) + GHOSEI - 7 - 6 + 1) * Sgn(荷重図開き) ////////08/08/15
                        } else {
                        寸法線位置 = -(荷重寸法線位置(2) + GHOSEI - 9 - 6 + 1) * Sgn(荷重図開き) ////////08/08/15
                        }
                        if ( 水平垂直 = 1 ) { //////10/01/18////////And InStr(部材名(SS部材), "杭") = 0 ) { ////////09/11/199
                            if ( (FLG杭杭 = False $$ yiKozo = 3) || 連続荷重_P1(1) != 連続荷重_P2(1) ) { ////////09/05/03 09/08/05
                                寸法線位置 = 寸法線位置 + IIf(P7 >= 1000, -16, -14) * Sgn(荷重図開き)
                            }
            //                        yyF6 = 1 * Sgn(連続荷重_P1(1))  //////09/08/05
                                yyF6 = Sgn(荷重図開き) //////09/11/06
                                if ( yyF6 = 1 ) {
                                    if ( FLG杭杭 ) { ////////09/11/07
                                        if ( N段数 > 1 ) { ////7g荷重表記高 > 300
                                            寸法線位置 = -7 - 14 * Sgn(荷重図開き)
                                        } else {
                                            寸法線位置 = -7 //寸法線位置 - (5 + 1.5 * (P7 / Max荷重)) * Sgn(荷重図開き)
                                            寸法補助線 = 寸法線位置 + 1
                                            GoTo GRF
                                        }
                                    } else {
                                        if ( FLG杭杭 = False $$ 節X(節点S) = g柱X座標(g柱本数, 1) ) { //////09/11/09//////And g荷重表記縦 = 1 ) { //////09/11/06
                                        //////右側土圧
                                            if ( g荷重表記縦 = 1 ) { //////09/11/09
                                            //////////////////////////////////////////////////////////////////////09/12/25
                                            寸法線位置 = (3 + 2 * (P7 / Max荷重) * 2) + max(Len(Format(P7, "0.00")), 6) * (荷重文字サイズ * Twip / 160)
                                            } else {
                                            寸法線位置 = (5 + 2 * (P7 / Max荷重)) + 荷重文字サイズ / 2 //////09/11/09
                                            }
                                            寸法補助線 = 寸法線位置 - 1
                                            GoTo GRF
                                        } else {
                                            if ( (yiKozo = 2 $$ FLG杭杭 = False) || g荷重表記高 > 300 ) { ////////09/08/07
                                            寸法線位置 = 寸法線位置 - (16 + 1.5 * (P7 / Max荷重)) * Sgn(荷重図開き)
                                            } else {
                                            寸法線位置 = 寸法線位置 - (5 + 1.5 * (P7 / Max荷重)) * Sgn(荷重図開き) //////////07/06/11 09/08/05
                                            }
                                        }
                                    }
                                } else {
                                    if ( FLG杭杭 ) {
                                        if ( N段数 > 1 ) { ////////g荷重表記高 > 300 ) {
                                            if ( yiKozo = 2 ) {
                                                寸法線位置 = (16.5 + 1.5 * (P7 / Max荷重))
                                                寸法補助線 = 4 ////寸法線位置 - 1
                                            } else {
                                                寸法線位置 = (16.5 + 1.5 * (P7 / Max荷重))
                                                寸法補助線 = 4 ////寸法線位置 - 1
                                            }
                                            GoTo GRF
                                        } else {
                                            if ( Sgn(荷重図開き) < 0 $$ 連続荷重mark(1) = 2 ) { ////////11/12/15
                                                寸法線位置 = (5 - 10 * Sgn(荷重図開き)) / 2
                                                寸法補助線 = 寸法線位置 - 1
                                            } else {
                                                寸法線位置 = 寸法線位置 - 10 * Sgn(荷重図開き) ////////09/11/088
                                                寸法補助線 = 寸法線位置 - 1
                                            }
                                            GoTo GRF
                                        }
                                    } else {
                                        if ( FLG杭杭 = False $$ 節X(節点S) = g柱X座標(1, 1) ) { //////09/11/09//////And g荷重表記縦 = 1 ) { //////09/11/06
                                        //////左側土圧
                                            if ( g荷重表記縦 = 1 ) { //////09/11/09
                                            //////////////////////////////////////////////////////////////////////////09/12/25
                                            寸法線位置 = -(3 + 2 * (P7 / Max荷重) * 2) - max(Len(Format(P7, "0.00")), 5.5) * (荷重文字サイズ * Twip / 160)
                                            } else {
                                            寸法線位置 = -(3 + 4 * (P7 / Max荷重)) - 荷重文字サイズ / 4 //////09/11/09
                                            }
                                            寸法補助線 = 7 * Sgn(寸法線位置) //////// + 1
                                            GoTo GRF
                                        } else {
                                            if ( (yiKozo = 2 $$ FLG杭杭 = False) || g荷重表記高 > 300 ) {
                                                寸法線位置 = 寸法線位置 - (12 + 1.5 * (P7 / Max荷重)) * Sgn(荷重図開き)
                                            } else {
                                                if ( Not (iKozo = 3 $$ FLG杭杭 = False $$ Mark111 = 2 $$ 水平垂直 = 1 $$ 寸法線位置 > 0 $$ 荷重図開き < 0) ) {
                                                寸法線位置 = 寸法線位置 - (12 + 1.5 * (P7 / Max荷重)) * Sgn(荷重図開き)
                                                寸法線位置 = -(12 + 1.5 * (P7 / Max荷重)) ////////16/10/20
                                                }
                                                寸法補助線 = 寸法線位置 - 5
                                                GoTo GRF
                                            }
                                        }
                                    }
                                }
                        }
                    } else {
                        if ( 水平垂直 = 0 $$ yFR橋脚 = 2 ) {
                            寸法線位置 = -(荷重寸法線位置(2) + GHOSEI + 4) * Sgn(荷重図開き) ////////////////06/02/12
                        } else {
                            ////////////////////////////////////////////////////////////////////////////////////////////////////////10/02/03
                            寸法線位置 = -(荷重寸法線位置(2) + GHOSEI + IIf(g連続Mod, 1, 2) + IIf(連続荷重_P1(1) * 連続荷重_P2(1) < 0, 4, 0)) * Sgn(荷重図開き)
                            if ( 水平垂直 = 0 $$ g荷重表記縦 = 1 ) { //////13/12/15
                                if ( Mark111 = 2 ) {
                                    寸法線位置 = 寸法線位置 + GHOSEI
                                } else {
                                    if ( Mark111 = 4 ) {
                                        if ( g荷重表記高 > 225 ) {
                                            寸法線位置 = 寸法線位置 + GHOSEI * 1.5
                                        } else {
                                            寸法線位置 = 寸法線位置 - GHOSEI / 2
                                        }
                                    }
                                }
                            } //////13/12/15
                            if ( 荷重図開き < 0 $$ (YY_max = wYs || YY_max = wYe) ) { //////13/01/30
                                if ( N段数 > 1 ) {
                                    寸法線位置 = -Abs(寸法線位置)
                                    寸法補助線 = -3.5
                                } else {
                                    if ( InStr(荷重名称(逆実荷重NO(CASU)), "死荷重") != 0 $$ InStr(荷重名称(逆実荷重NO(CASU)), "地震") = 0 ) {
                                        寸法線位置 = -5
                                        寸法補助線 = -3.5
                                    } else {
                                        寸法線位置 = 13
                                        寸法補助線 = 3.5
                                    }
                                    if ( 水平垂直 = 0 $$ Mark111 = 6 ) {
                                        寸法線位置 = -10 - 2 * (N段数 - 1)
                                        寸法補助線 = -3.5
                                    }
                                }
                                GoTo GRF8
                            }
                            if ( 荷重図開き > 0 $$ (YY_min = wYs || YY_min = wYe) ) { //////13/01/30
                                if ( 水平垂直 = 0 $$ g荷重表記縦 = 0 $$ g荷重表記高 = 0 $$ (P7 / Max荷重) < 0.4 ) {
                                    寸法線位置 = -9
                                }
                                寸法補助線 = -3.5
                                GoTo GRF8
                            }
                            if ( J4 = 連続荷重数 ) { ////////08/07/08
                                寸法線位置 = 寸法線位置 * 0.9
                            }
                        }
                        if ( 水平垂直 = 1 $$ yFR橋脚 != 2 ) {
                            if ( g荷重表記縦 = 0 ) { //09/04/17
                                if ( 連続荷重_P1(1) > 0 ) {
                                    寸法線位置 = 寸法線位置 + 4.5 * Sgn(荷重図開き)
                                }
                            } else {
                                if ( yiKozo = 3 ) { //カルバートボックス 05/05/12//////////09/11/09
            //                            if ( ((wXe != JX_min $$ wXe != JX_max) || _
            //                               (wXe = JX_min $$ 荷重図開き > 0) || _
            //                               (wXe != JX_max $$ 荷重図開き < 0)) _
            //                                $$ N段数 = 1 $$ 連続荷重mark(1) = 2 ) { ////////09/08/14
            //                                //寸法線位置 = 6 * Sgn(荷重図開き)
            //                                f寸法FLG = Sgn(荷重図開き) ////////09/08/14
            //                            } else {
                                        寸法線位置 = 寸法線位置 - 2 * Sgn(荷重図開き) //////09/04/17
            //                            }
                                } else {
                                    寸法線位置 = 寸法線位置 - 7 * Sgn(荷重図開き)
                                }
                            }
                        }
                    }
                }
                if ( yFR橋脚 = 2 $$ HV = 1 $$ FLG杭杭 = False ) { ////////08/08/17
                    寸法線位置 = 寸法線位置 - 2
                } else {
                }
                if ( Mark111 = 3 || Mark111 = 4 ) {
                    if ( yFR橋脚 = 2 ) {
                        寸法線位置 = 寸法線位置 + 4 * Sgn(荷重図開き) //////09/11/16
                    } else {
                        寸法線位置 = 寸法線位置 + 5 * Sgn(荷重図開き) //////09/11/16
                    }
                }
                if ( X(1) = X(2) ) { //////Or (水平垂直 = 9 $$ 荷重方向 = "H") ) { // 鉛直部材の場合//////09/08/23
                    if ( yFR橋脚 = 1 || FLG杭杭 || (yiKozo != 3 $$ 水平垂直 = 1) ) { //////08/08/17 09/08/05
                        if ( 荷重図開き > 0 ) {
                            if ( 集中有無 = 1 ) {
                                寸法線位置 = 寸法線位置 - 4 * Sgn(寸法線位置)
                            } else {
                                寸法線位置 = 寸法線位置 - 4 * Sgn(寸法線位置)
                            }
                        } else {
                            if ( 集中有無 = 1 ) {
                                寸法線位置 = 寸法線位置 - 6 * Sgn(寸法線位置)
                            } else {
                                寸法線位置 = 寸法線位置 - 6 * Sgn(寸法線位置)
                            }
                        }
                        if ( Mark111 = 2 ) {
                            if ( 集中有無 = 0 $$ 荷重図開き < 0 ) {
                                寸法線位置 = 寸法線位置 + 2 * Sgn(寸法線位置)
                            }
                        } else {
                            if ( 集中有無 = 0 $$ 荷重図開き < 0 ) {
                                寸法線位置 = 寸法線位置 - 1 * Sgn(寸法線位置)
                            }
                        }
                    }
                }
                if ( FLG杭杭 $$ g荷重表記縦 = 1 ) { ////////09/11/199
                    if ( 荷重図開き > 0 ) {
                        寸法線位置 = -5.5
                        寸法補助線 = -荷重寸法線位置(1) / 5
                    } else {
                        寸法線位置 = 7.5
                        寸法補助線 = 荷重寸法線位置(1) / 5
                    }
                    GoTo GRF ////////09/11/199
                }
                寸法補助線 = -荷重寸法補助線 * Sgn(荷重図開き)
                if ( yFR橋脚 = 1 $$ 水平垂直 = 1 $$ Mark111 = 1 ) { //02/04/18
                    寸法線位置 = 荷重寸法線位置(1) / 2.5 //0 //寸法線位置 - 1 * Sgn(寸法線位置)
                    寸法補助線 = 荷重寸法線位置(1) / 5 //-荷重寸法補助線 * Sgn(荷重図開き)
                }
                if ( 水平垂直 = 1 $$ Mark111 = 5 ) {
                    寸法線位置 = 寸法線位置 - 4 * Sgn(寸法線位置)
                } else {
                    if ( 水平垂直 = 0 $$ Mark111 = 2 ) { //And gHosei != 0 ) { //And 荷重_P1 = 荷重_P2 ) {
                    if ( UUUU = 0 ) {
                        if ( (PPPP / Max荷重) < 0.2 ) { //And hosei >= 0 ) {
                            寸法線位置 = 寸法線位置 - 8.5 * Sgn(寸法線位置) * IIf(FR橋脚 = 1, Sgn(荷重図開き), 1) //////10/05/12
                        } else {
                            寸法線位置 = 寸法線位置 - 6 * Sgn(寸法線位置) * IIf(FR橋脚 = 1, Sgn(荷重図開き), 1) //////10/05/12
                        }
                    } else {
                        if ( hosei < 0 ) {
                            寸法線位置 = 寸法線位置 - 5.5 * Sgn(寸法線位置) * IIf(FR橋脚 = 1, Sgn(荷重図開き), 1) //////10/05/12
                        } else {
                            if ( hosei = 0 ) {
                            寸法線位置 = 寸法線位置 - 5 * Sgn(寸法線位置) * IIf(FR橋脚 = 1, Sgn(荷重図開き), 1) //////10/05/12
                            } else {
                            寸法線位置 = 寸法線位置 - 6 * Sgn(寸法線位置) * IIf(FR橋脚 = 1, Sgn(荷重図開き), 1) //////10/05/12
                            }
                        }
                    }
                    }
                }
                if ( 寸法線位置 = 3.001 ) { //////////////////07/06/177
                    寸法補助線 = 寸法線位置 + 1
                }
                if ( Flg3 = 1 ) { //////////////////////////////07/07/26
                    寸法補助線 = -寸法線位置
                }
                if ( g荷重表記縦 = 0 $$ g荷重表記高 != 0 ) { ////////08/10/29
                    if ( 水平垂直 != 1 ) { //////09/04/17
                        寸法線位置 = -Round((GOUKEI / 30) + (g荷重表記高 / 30), 2) _
                                     + IIf(yyF6 = 1, 1 - Round(1 * (P7 / Max荷重), 2), 0)
                        if ( g荷重表記高 < 145 $$ gY55 != -51 ) { //////10/02/07
                            if ( Abs(寸法線位置) > 16 ) {
                                寸法線位置 = 寸法線位置 + 3 //////10/02/07
                            }
                        }
                        if ( gY55 = -51 || gY55 = -80 ) { //////////////10/01/30 12/12/17
                            if ( Abs(寸法線位置) < 20 ) {
                            寸法線位置 = 寸法線位置 - 5
                            } else {
                            寸法線位置 = 寸法線位置
                            }
                            GoTo GRF8
                        } else {if ( yiKozo = 1 $$ (節Y0(節点S) + 節Y0(節点E)) / 2 < ((YY_max + 水平部材最下端) / 2 * 0.8) ) {
                            if ( Not (iKozo = 3 $$ (P7 / Max荷重) < 0.44) ) { //////13/02/30
                            寸法線位置 = 寸法線位置 - 3 - IIf((PPPP / Max荷重) > 0.75, 1.5, 0) //////13/04/08
                            }
                        }
                    }
                } else {
                    寸法線位置 = Round(寸法線位置 + 0.5 * Sgn(寸法線位置), 1)
                    if ( 水平垂直 = 1 $$ iKozo = 3 ) {
                        if ( 寸法線位置 < -16 ) { ////////////////////////Box 内水圧
                            寸法線位置 = 16 * Sgn(寸法線位置)
                            寸法補助線 = -4
                        }
                        if ( 寸法線位置 > 17 ) {
                            寸法線位置 = 17
                            寸法補助線 = 4
                        }
                    }
                }
                if ( g荷重表記縦 = 1 $$ 水平垂直 = 1 $$ Mark111 = 2 $$ ((BSN = -1 $$ 連続荷重_P1(1) + 連続荷重_P2(1) > 0) || (荷重方向5 = "H") $$ 連続荷重_P1(1) + 連続荷重_P2(1) < 0) ) {
                    寸法線位置 = 16 + IIf(iKozo = 2, 10, 0) //////17/03/12
                    寸法補助線 = 6 + IIf(iKozo = 2, 3, 0)
                }
            GRF: //////////////////////09/11/06
                if ( 水平垂直 != 1 $$ 荷重図開き < 0 ) { //////09/11/16
                    寸法線位置 = Abs(寸法線位置) ////////////10/05/12寸法線位置 * Sgn(荷重図開き) //////09/11/16
                    if ( (PPPP / Max荷重) > 1.1 ) {
                        寸法線位置 = 寸法線位置 * 1.2 //////15/02/02
                    }
                }
            //////08/11/06
            var M As Integer, Atta As Integer
                Atta = 0
                //////////09/11/09
                if ( 水平垂直 != 1 $$ (Mark111 = 1 || Mark111 = 5 || Mark111 = 6 || Mark111 = 11) $$ N段数 = 1 ) { ////////08/11/06
                    if ( 下層BUZAI(1, 1) != 0 ) {
                        For( M = 1 To 部材_max
                            if ( 下層BUZAI(M, 1) = 0 ) { Exit For
                            if ( 下層BUZAI(M, 2) >= 節点S $$ 下層BUZAI(M, 2) <= 節点E ) {
                                Atta = 1
                                Exit For
                            }
                            if ( 下層BUZAI(M, 3) >= 節点S $$ 下層BUZAI(M, 3) <= 節点E ) {
                                Atta = 1
                                Exit For
                            }
                        Next M
                    }
                    if ( Atta = 0 $$ yiKozo = 1 $$ Abs(YY_max - (wYe + wYs) / 2) > 1.6 ) {
                        Atta = 1
                        PY0 = min(HEN_Y(wYs), HEN_Y(wYe)) + 2 * Twip
                    }
                    if ( Atta = 0 $$ yiKozo = 1 $$ (水平部材最下端 = (wYs + wYe) / 2 $$ Mark111 = 6) ) { //////13/11/15
                        Atta = 1
                        PY0 = min(HEN_Y(wYs), HEN_Y(wYe)) + 2 * Twip
                    }
                }
            //////08/11/06
                if ( Atta = 1 ) {
                    if ( (水平部材最下端 = (wYs + wYe) / 2) $$ (yiKozo = 1 || yiKozo = 3) $$ 水平垂直 = 0 $$ N段数 = 1 ) {
                        For( i = 1 To NN //////////09/10/25
                            Y(i) = PY0 + (XL(i) * BSN - 0 * BCS) - 5 * Twip //////////////09/11/08
                        }
                        this.SunPou2("<", NN, 10, 4, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, , 荷重図開き) //////09/10/20 12/12/15
                        寸法線位置 = 10: 寸法補助線 = 4
                    } else {
                        For( i = 1 To NN //////////09/10/25
                            Y(i) = PY0 + (XL(i) * BSN - 95 * BCS) - 5 * Twip //////////////09/11/08
                        }
                        this.SunPou2("<", NN, 10, 4, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, , 荷重図開き) //////09/10/20 12/12/15
                        寸法線位置 = 10: 寸法補助線 = 4
                    }
                } else {
                    if ( Mark111 = 5 ) {
                        if ( 水平垂直 = 1 ) { ////13/04/08
                            寸法線位置 = -10
                            寸法補助線 = -3
                        } else {
                            寸法線位置 = 4.5
                            寸法補助線 = -4
                        }
                    } else {if ( Mark111 = 1 $$ 水平垂直 != 1 ) { //////////10/01/19
                        if ( P7 < 1000 ) { //////  $$ 寸法線位置 > -12.1 ) {
                            if ( P7 / Max荷重 < 0.3 ) {
                                寸法線位置 = 寸法線位置 - 3.5 - 1 ////////////10/06/02
                            } else {
                                if ( ((P7 / Max荷重) > 0.8 $$ P7 < 30) || (P7 / Max荷重) >= 0.9 ) { ////////////10/06/02
                                    寸法線位置 = 寸法線位置 - 3.5
                                } else {
                                    if ( (P7 / Max荷重) < 0.45 ) {
                                    寸法線位置 = 寸法線位置 + 2
                                    } else {
                                    寸法線位置 = 寸法線位置 - 2.5 * max((1 - P7 / Max荷重), 0.5)
                                    }
                                }
                            }
                        } else {if ( P7 > 2000 $$ 寸法線位置 > -15.1 ) { //////////10/01/19
                            if ( P7 < 3000 ) { ////////////10/04/100
                                寸法線位置 = 寸法線位置 - 3 + (max((3100 - P7), 0) / 250)
                            }
                        } else {if ( 寸法線位置 = -15 ) {
                            寸法線位置 = -17
                        }
                        if ( 荷重文字サイズ > 9.5 $$ 寸法線位置 < -16 ) { //////12/09/25
                            寸法線位置 = 寸法線位置 - (荷重文字サイズ - 9.5) * 2
                        }
                    }
            if ( (Mark111 = 2 $$ 水平垂直 != 1 $$ (P7 / Max荷重) > 0.9 $$ 寸法線位置 < -8) ) {  //////10/10/14
                if ( g荷重表記縦 = 1 ) {
                    寸法線位置 = 寸法線位置 - 1 ////// 12/11/22
                } else {
                    if ( ((部材正荷重数(SS1) < 30 $$ N段数 != 1) || (部材正荷重数(SS1) < 20 $$ N段数 = 1)) $$ yyF6 = 0 ) { //////10/11/11
                        if ( (部材正荷重数(SS1) < 18 $$ N段数 = 1) ) {
                        寸法線位置 = 寸法線位置 - 0 - IIf((P7 / Max荷重) > 0.9, 5, 0) //////10/11/11 12/11/22
                        } else {
                        寸法線位置 = 寸法線位置 - IIf((P7 / Max荷重) > 0.95, 1, 4) //////12/12/15
                        }
                        m調整高 = 4 //////10/11/11
                    } else {
                        if ( N段数 = 1 ) { //////////12/08/21
                            if ( YY_max - max(wYs, wYe) > 1 $$ 部材正荷重数(SS1) < 24 ) { ////////12/12/12
                                寸法線位置 = 1
                                寸法補助線 = 4
                            }
                        } else {if ( 水平垂直 != 1 ) {
                            寸法線位置 = 寸法線位置 - IIf((P7 / Max荷重) > 0.95, 2, 0.5)
                        }
                    }
                }
            }
                    if ( Mark111 = 3 ) { //////////////////////10/10/21
                        if ( g荷重表記高 > 200 ) {
                            寸法線位置 = -12
                        } else {
                            寸法線位置 = -(10 + Round((g荷重表記高 * 2.8 / 100), 1))
                            if ( 寸法線位置 > -15 ) { 寸法線位置 = -15
                        }
                        if ( g荷重表記高 < 100 ) {
                            寸法線位置 = Round(g荷重表記高 / 8, 1) * Sgn(寸法線位置) //////13/04/08
                        }
                        g荷重表記高 = 0
                    }
                    if ( Mark111 = 2 $$ 連続荷重数 = 1 $$ g荷重表記縦 = 0 $$ 寸法線位置 < 0 $$ 寸法線位置 > -18 ) { //////11/11/18
                        if ( g荷重表記縦 = 0 ) {
                            if ( (P7 / Max荷重) > 0.75 ) {
                            寸法線位置 = IIf(Abs(寸法線位置) > 15 $$ 水平垂直 = 0, 寸法線位置 + IIf(N段数 = 1, 1, 4), 寸法線位置) ////////////13/04/177
                            } else {
                            寸法線位置 = 寸法線位置 - 0.5 ////////////13/04/177
                            }
                        } else {
                            寸法線位置 = 寸法線位置 - 3
                        }
                    }
                    //
                    if ( f寸法FLG = 0 ) { //////09/08/14
                        if ( Mark111 = 1 $$ 寸法線位置 < -16 ) {

                            寸法線位置 = -17
                            寸法補助線 = -3

            //                    寸法線位置 = -16
            //                    寸法補助線 = -3

                        }
                        if ( g荷重表記縦 = 0 $$ 連続荷重数 = 1 $$ 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) + 連続荷重_P2(1) = 0 ) {
                            寸法線位置 = min(Abs(寸法線位置) + 9, 30) * Sgn(寸法線位置) ////////12/11/22
                        } else {if ( g荷重表記縦 = 0 $$ 連続荷重数 > 1 $$ 連続荷重mark(1) = 2 $$ 水平垂直 = 0 ) { //////12/12/12
                            if ( ((BXE - BX0) / 連続荷重数) < 220 ) { ////////////////12/12/12
                                寸法線位置 = 寸法線位置 - 3 //////12/12/16
                                寸法補助線 = -2.5
                            } else {if ( ((BXE - BX0) / 連続荷重数) < 350 ) {
                                寸法線位置 = 寸法線位置 - 1.5
                                寸法補助線 = -3
                            }
                        }
                         //////12/12/12
                        if ( NN = 2 $$ g荷重表記縦 = 0 $$ (Mark111 = 2 $$ 水平垂直 != 1 $$ (P7 / Max荷重) > 0.9 $$ 寸法線位置 < -15) ) {
                            寸法線位置 = -15
                        } else {if ( (P7 / Max荷重) < 0.44 $$ g荷重表記縦 = 0 $$ 水平垂直 != 1 $$ 寸法線位置 < -12 $$ ((BXE - BX0) / 連続荷重数) >= 350 ) {
                            寸法線位置 = -13 - 2 ////713/01/30
                        } else {if ( yyF6 = 0 $$ 水平垂直 = 0 ) { //////12/12/15
                            if ( 荷重図開き < 0 $$ 寸法線位置 > 0 ) {
                                寸法線位置 = 16 + max((部材荷重Fontsize - 9), 0) * 2.5 ////////////14/11/26//////min(寸法線位置, 13) //////////////////////13/04/24
                                if ( ((P7 / Max荷重) > 0.95 $$ g荷重表記高5 > 290) || g荷重表記高5 > 330 ) { ////////(Y(1) - PY0) > 100 And
                                    寸法線位置 = 17.2 //////寸法線位置 + 4
                                    if ( g荷重表記高5 > 320 ) {
                                        寸法線位置 = 19.5
                                    }
                                }
                            } else {
                                if ( 寸法線位置 > 0 ) { //////////////////////13/04/24
                                    寸法線位置 = 寸法線位置 + 2
                                    寸法補助線 = 4
                                    if ( (連続荷重_P1(1) + 連続荷重_P2(1)) / 2 < 0 ) {
                                        寸法線位置 = 寸法線位置 + 2
                                    }
                                }
                            }
                        }
                        if ( (水平部材最下端 = (wYs + wYe) / 2) $$ (yiKozo = 1 || yiKozo = 3) $$ _
                                                   水平垂直 = 0 $$ N段数 = 1 $$ 寸法線位置 < 0 ) { //////12/12/15
            //////コメントにした 13/02/27
            //                    寸法線位置 = 3
            //                    寸法補助線 = 4
            //                    if ( (連続荷重_P1(1) + 連続荷重_P2(1)) / 2 < 0 ) {
            //                        寸法線位置 = 5
            //                    }
                        } else {if ( Mark111 = 4 $$ (P7 / Max荷重) < 0.5 $$ 寸法線位置 < 0 $$ g荷重表記縦 = 0 ) { //////12/12/17
                            寸法線位置 = 寸法線位置 + 2
                        }

            GRF8: //////12/12/17
            //        if ( 連続荷重数 = 1 $$ NN = 2 $$ (YY_max = wYs $$ YY_max = wYe) ) { //////////12/12/29
            ////            if ( LLL789 = val(寸法(1)) + (節点S + 節点E) * 100 ) {
            //            if ( LLL789 = 寸法(1) & Format((節点S + 節点E) * 10) ) { ////////13/04/08
            //                GoTo ABC
            //            }
            //        } ////////13/04/08
            //        if ( 連続荷重数 = 1 $$ NN = 2 $$ (YY_min = wYs $$ YY_min = wYe) $$ iKozo = 3 ) { //////////13/01/30
            //            GoTo ABC
            //        }
                if ( LLL789 = 寸法(1) & Format((節点S + 節点E) * 10) ) { GoTo ABC //////14/11/16
                LLL789 = 寸法(1) & Format((節点S + 節点E) * 10) ////////13/04/08
            //        if ( NN > 2 $$ 寸法線位置 < 0 ) { //////12/12/299
            //            if ( Mark111 = 1 ) {
            //                寸法線位置 = -15
            //                寸法補助線 = -3.5
            //            } else {if ( Mark111 = 2 || Mark111 = 3 || Mark111 = 4 ) {
            //                寸法線位置 = -13.5 + (g荷重表記高5 / 56.7 / 10 * 4)
            //                寸法補助線 = -3.5
            //            }
            //        } //////12/12/299
            if ( 連続荷重mark(1) = 6 $$ wXs = wXe $$ g柱本数 > 0 $$ RR橋脚 = 1 ) { //////13/02/24
            if ( 節X(節点S) = g柱X座標(1, 1) ) {
                寸法線位置 = -10
                寸法補助線 = -3.5 ////////13/11/15
            } else {if ( 節X(節点S) = g柱X座標(g柱本数, 1) ) {
            } else {
                if ( (Abs(寸法線位置) / 図X_SCALE) < 600 ) { ////////if ( (g柱X座標(g柱本数, 1) - g柱X座標(1, 1)) > 100 ) {
                寸法線位置 = -Round((600 * 図X_SCALE), 1) //-max(6.5, Abs(寸法線位置))
                }
                if ( FLG柱軸重 = True ) { //////13/04/08
                    寸法線位置 = 5.5
                    寸法補助線 = 6.5
                }
            }
            }
            if ( (P7 / Max荷重) < 0.35 $$ 連続荷重_P1(1) != 連続荷重_P2(1) $$ (Mark111 = 2 $$ 水平垂直 = 0) $$ _
                        (Abs(YY_max - wYs) > (YY_max - YY_min) / 5) ) { //////13/020/27
            寸法線位置 = -1
            }
            if ( NN = 2 $$ ((Abs(連続荷重_P1(1) / Max荷重) < 0.23 $$ g荷重表記高 < 130 $$ 連続荷重_P1(1) = 連続荷重_P2(1))) ) {
                寸法線位置 = -12 ////////13/02/27
            }
            if ( 連続荷重_P1(1) + 連続荷重_P2(1) = 0 ) { //////13/04/12
                寸法線位置 = 寸法線位置 + 5 * Sgn(寸法線位置)
            }
            if ( NN = 2 $$ g荷重表記縦 = 0 $$ iKozo = 3 $$ g連続Mod = False $$ (水平部材最下端 = (wYs + wYe) / 2) ) { //////13/04/17
                yyF5 = 2
                GoTo GRF_ABC
            }
            GRF9: //////18/04/19
               if ( (Mark111 = 5 || Mark111 = 11) $$ g連続Mod ) { //////13/04/25
                    寸法線位置 = -11.01
                    寸法補助線 = -4
               }
               if ( NN = 2 $$ g連続Mod $$ g荷重表記高 = 0 $$ Abs(連続荷重_P1(1) / Max荷重) < 0.5 ) { //////13/06/97
                    寸法線位置 = -8.5
               }
               if ( 荷重図開き < 0 $$ 寸法線位置 > 0 $$ 連続荷重_P1(1) < 0 $$ 連続荷重_P2(1) < 0 ) {
                    寸法補助線 = 4
                    寸法線位置 = 18
               }
               if ( 連続荷重mark(1) = 6 $$ wXs = wXe $$ g柱本数 > 0 $$ RR橋脚 = 1 ) { //////14/01/09
                    if ( 節X(節点S) < (g柱X座標(1, 1) + g柱X座標(g柱本数, 1)) / 2 || FLG杭杭 ) {
                        寸法線位置 = -5.5
                        寸法補助線 = -3
                    } else {
                        寸法線位置 = 3.7
                        寸法補助線 = 3
                        if ( JX_max = JX_min || g柱本数 = 1 ) { ////////14/09/16//////15/04/08
                            寸法線位置 = 寸法線位置 + 4 + IIf(g柱本数 = 1, 5, 0) + IIf(FLG_左右接点(3), 10, 0)
                            寸法補助線 = 8
                        }
                    }
               }
               if ( (Mark111 = 5 || Mark111 = 11) $$ g連続Mod = False $$ 水平垂直 != 1 $$ 寸法線位置 < 0 ) {
                        寸法線位置 = -9
                        寸法補助線 = -3
               }
               if ( FLG車両ZU = True ) {
                    if ( N段数 = 1 ) {
                         寸法線位置 = -15.5
                         寸法補助線 = -3
                    } else {
                         寸法線位置 = -14
                         寸法補助線 = -3
                    }
               }
               if ( wXe = JX_max $$ 水平垂直 = 1 $$ 荷重図開き > 0 ) {
                寸法線位置 = Abs(寸法線位置)
               }
               this.SunPou2("<", NN, 寸法線位置, 寸法補助線, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, , 荷重図開き)

            if ( 連続荷重mark(1) = 5 || 連続荷重mark(1) = 11 ) { GoTo ABC //////13/04/12
                        if ( NN = 2 || ((P7 / Max荷重) > 0.9) || (水平部材最下端 = (wYs + wYe) / 2) ) { //////12/12/15
                            if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                                For( i8 = 1 To yBuzaiFF
                                    i = yGGGGG(i8)
                                    部材正荷重数(i) = 部材正荷重数(i) + IIf(寸法線位置 < 0, Abs(Round(寸法線位置 / 1.1, 1)), 2)
                                }8
                            } else { //////////////////////////////////////////////////12/12/15
                                if ( ((BXE - BX0) / 連続荷重数) < 220 ) {
                                    yyF5 = IIf(寸法線位置 < 0, Abs(Round(寸法線位置 / 1.3, 1)), 2)
                                } else {
                                    yyF5 = IIf(寸法線位置 < 0, Abs(Round(寸法線位置 / 2 * 1.6, 1)), 2)
                                }
                                if ( (P7 / Max荷重) > 0.9 || g荷重表記高 > 130 ) {
                                    if ( g荷重表記縦 = 1 $$ g荷重表記高 > 260 ) {
                                        yyF5 = 18 + IIf(g荷重表記高 > 285, 5, 0) + IIf(s寸法文字2段, 0.5, 0)
                                        if ( s寸法文字2段 ) { GoTo GRF_ABC
                                    } else {
                                        yyF5 = IIf(Abs(寸法線位置) > 15, 19, 17)
                                        if ( g荷重表記縦 = 0 ) {
                                            if ( (P7 / Max荷重) > 0.8 ) {
                                                yyF5 = Abs(Round(寸法線位置 / 1.1, 1))
                                            } else {
                                                yyF5 = IIf(s寸法文字2段, 0.5, 0) //////14/10/14
                                                if ( (P7 / Max荷重) < 0.4 $$ 寸法線位置 = -14.5 ) {
                                                    yyF5 = -1 + IIf(s寸法文字2段, 0.5, 0)
                                                }
                                            }
                                        }
                                    }
                                    if ( GOUKEI < 0 ) { ////////////13/04/12
                                       if ( g荷重表記高 < 220 ) { //////13/12/15  < 220
                                            if ( Abs(寸法線位置) > 16 ) {
            //                                        yyF5 = 10
                                            } else {
                                                if ( g荷重表記縦 = 0 ) { //////13/12/15
                                                    yyF5 = 5
                                                } else {
                                                    yyF5 = Abs(Round(寸法線位置 / 1.5, 1)) //////13/12/15
                                                }
                                            }
                                        } else {
                                            yyF5 = 16 + IIf(g荷重表記縦 = 1, GHOSEI * 2, 0) //////13/12/15
                                        }
                                    }
                                    yyF5 = yyF5 + IIf(s寸法文字2段, 1, 0) //////13/12/15
                                } else {if ( g荷重表記高 < 100 ) {
                                    if ( GOUKEI > 0 ) {
                                        yyF5 = 0
                                    } else {
                                        yyF5 = 8 ////////13/04/12
                                    }
                                } else {if ( g荷重表記高 > 150 $$ GOUKEI < 0 ) { ////////////13/04/12
                                    yyF5 = 0
                                }
                                if ( (Mark111 = 1 $$ yyF5 > 4) ) { //////13/04/12////// $$ N段数 = 1) ) { ////////////13/04/08
                                    yyF5 = 2 //////14/01/01
                                } else {if ( (Mark111 = 2 $$ g荷重表記縦 = 0) ) { //////13/04/177
                                    if ( iKozo = 3 ) { //////13/04/08
                                        if ( (水平部材最下端 = (wYs + wYe) / 2) $$ ((P7 / Max荷重) > 0.8 || g連続Mod) ) { //////13/04/177
                                            if ( Not g連続Mod ) { //////13/06/07
                                                yyF5 = 2
                                            }
                                        } else {
                                            yyF5 = IIf((P7 / Max荷重) > 0.8, 4, 10) //////13/04/177
                                        }
                                    } else {
                                        yyF5 = IIf((P7 / Max荷重) > 0.9, 7, 4)
                                    }
                                } ////////////13/04/08
                                if ( 寸法線位置 = -11.01 ) { //////13/04/25
                                    yyF5 = 9.5 + IIf(s寸法文字2段, 0.5, 0)
                                }
            GRF_ABC:
                                if ( 荷重図開き < 0 $$ 水平垂直 = 0 ) { ////////13/12/31
                                    For( i = SS1 To SE2
                                        部材負荷重数(i) = 部材負荷重数(i) - yyF5
            //                                if ( ((BXE - BX0) / 連続荷重数) < 220 ) {
            //                                } else {
            //                                    if ( 荷重方向 = "V" ) {
            //                                        部材正荷重数(I) = 部材正荷重数(I) + 1.5 ////////12/12/17
            //                                    }
            //                                }
                                    }
                                } else {
               if ( FLG車両ZU = True $$ BU荷重MAX > 0 ) { ////////14/10/18
                    if ( yyF5 < 13 ) {
                        yyF5 = 13
                    }
               } else { //////////////////14/11/26
                    yyF6 = min(HEN_Y(節Y(節点S)), HEN_Y(節Y(節点E)))
                    yyF5 = ((yyF6 - ((yyHH1 + yyHH2) / 2)) / 56.7) + 5.5 + IIf(s寸法文字2段, 2.3, 0)
                    yyF5 = Round(yyF5, 2)
                    For( i = SS1 To SE2
                        部材正荷重数(i) = yyF5
                    }
                    GoTo ABC
               }

                                    For( i = SS1 To SE2
                                        部材正荷重数(i) = 部材正荷重数(i) + yyF5
                                        if ( ((BXE - BX0) / 連続荷重数) < 220 ) {
                                        } else {
                                            if ( 荷重方向 = "V" ) {
                                                部材正荷重数(i) = 部材正荷重数(i) + 1.5 ////////12/12/17
                                            }
                                        }
                                    }
                                }
                            }
                            GoTo ABC //////12/12/12
                        }
                    } else {if ( f寸法FLG = -1 ) { ////////09/08/14
                        this.SunPou2("<", NN, -7, -4, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, , 荷重図開き)
                        寸法線位置 = -7: 寸法補助線 = -4
                    } else {if ( f寸法FLG = 1 ) { //////09/08/14
                        this.SunPou2("<", NN, 6, 4, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, , 荷重図開き)
                        寸法線位置 = 6: 寸法補助線 = 4
                    }
                }
            Case } else {
            End Select
            Next_GRF: ////////09/11/12
            //   //////////////////////////////////////////////08/07/06
            var SES As Single //////08/09/26
            double var d分布集中 As Single, GFGF As Single, DumyG ////////////09/03/25
            //
            var s段補正 As Single //////09/10/20
            s段補正 = 0
            if ( s寸法文字2段 ) { //////12/12/299//////And SS1 != SE2 ) { //////09/11/08
               s段補正 = 1
            }
            d分布集中 = 0
            SES = 0 ////////08/10/29
            ////////////////////////////////////////////////////////////////////////09/01/28
            if ( 水平垂直 = 1 ) {
            if ( yyF6 != 0 ) { //////09/08/05
                if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                    For( i8 = 1 To yBuzaiFF
                        i = yGGGGG(i8)
                        if ( yyF6 = 1 ) {
                             if ( FLG杭杭 $$ N段数 = 1 ) { //////09/11/07
                                部材正荷重数(i) = 8 + s段補正
                             } else {
                                部材正荷重数(i) = 部材正荷重数(i) - 5 + s段補正
                             }
                        } else {
                             if ( FLG杭杭 $$ N段数 = 1 ) { //////09/11/07
                                部材負荷重数(i) = 8 + s段補正
                             } else {
                                部材負荷重数(i) = 部材負荷重数(i) - 5 + s段補正
                             }
                        }
                    }8
                } else { //////////////////////////////////////////////////12/12/15
                    For( i = SS1 To SE2
                        if ( yyF6 = 1 ) {
                             if ( FLG杭杭 $$ N段数 = 1 ) { //////09/11/07
                                部材正荷重数(i) = 8 + s段補正
                             } else {
                                部材正荷重数(i) = 部材正荷重数(i) - 5 + s段補正
                             }
                        } else {
                             if ( FLG杭杭 $$ N段数 = 1 ) { //////09/11/07
                                部材負荷重数(i) = 8 + s段補正
                             } else {
                                部材負荷重数(i) = 部材負荷重数(i) - 5 + s段補正
                             }
                        }
                    }
                } //////12/12/15
            }
            GoTo ABC
            }
            if ( (連続荷重_P1(1) < 0 $$ 連続荷重_P2(1) < 0) $$ _
                (Mark111 = 2 || Mark111 = 3 || Mark111 = 4) $$ 荷重方向 != "H" ) { GoTo ABC
            //
            ////////////////////////////////////////////////////////////////////////09/01/28
            //
            if ( (g荷重表記縦 = 0 $$ (P7 / Max荷重) < 0.37) || g荷重表記縦 = 1 ) { //////10/04/07 < 0.4
            if ( g荷重表記縦 = 0 ) {
                SES = -0.7 ////////09/12/04//////0.3
                if ( yiKozo = 3 $$ (P7 / Max荷重) < 0.5 ) { SES = -4.5 //////12/05/14
                if ( (P7 / Max荷重) < 0.15 ) {
                    if ( J7 = 1 $$ J9 = 1 ) { //////if ( g荷重表記高 < 90 ) {
                        SES = -0.3 //////08/10/29
                    } else {
                        if ( (P7 / Max荷重) < 0.07 ) { //////09/10/20
                            SES = 3 - IIf(s段補正 > 0, 1, 0)
                        } else {
                            SES = 1 ////-0.3 //////08/10/29
                        }
                    }
                } else {if ( (P7 / Max荷重) < 0.3 ) { //////09/10/20
                    if ( s寸法文字2段 ) {
                        SES = -5.5 //////09/11/13
                    } else {
                        SES = -4 //////09/11/13
                    }
                }
            } else {if ( J5 = 0 $$ (yiKozo = 3 || g連続Mod) $$ J6 = -1.5 $$ g荷重表記縦 = 1 $$ (P7 / Max荷重) < 0.5 ) {
                SES = 0
                if ( (P7 / Max荷重) < 0.1 ) { ////////08/11/28
                    SES = -12
                } else {if ( (P7 / Max荷重) < 0.4 ) { ////////08/11/28
                    SES = -7
                }
            } else {
                if ( J5 = 0 ) {
                    SES = 寸法線位置 - 寸法補助線 - IIf((yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1), 6, 0) ////////08/11/277
                    if ( g荷重表記縦 = 1 ) { ////////And Not (yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) ) {
                        if ( (yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) ) {
                            J5 = -Round(((300 + GOUKEI) / 20) + ((250 - g荷重表記高) / 12) - 9, 1)
                            if ( J5 > 0 ) { ////////08/11/044
                                if ( N段数 = 1 ) {
                                    if ( J5 >= 5 $$ J5 < 13 ) { ////////10/03/18
                                        SES = -11 + (10 + 寸法線位置) * 5
                                        J5 = 0
                                        J55 = 0
                                        GoTo ABCF
                                    } else {
                                    J5 = 0 //J5 / 100 //////////09/11/13
                                    SES = SES - 3 //////////09/12/04
                                    }
                                } else {
                                    if ( g荷重表記高 > 260 ) {
                                        J5 = J5 / 5
                                    } else {
                                        J5 = J5 / 10 ////////10/04/18//////// + s段補正 //////////09/11/13
                                    }
                                }
                            }
                        } else {
                            SES = -Round((max(g荷重表記高, IIf(GOUKEI < -550, 0, 260)) / 50 + Abs(GOUKEI / 50)) + 0, 1) //////////////09/11/199
                            if ( g荷重表記高 > 290 ) {
                                if ( hosei != 0 || GOUKEI = -600 ) { //////////////10/04/18
                                    SES = Round(SES + hosei, 2)
                                    if ( GOUKEI = -600 ) {
                                        if ( hosei < 0 ) {
                                            SES = SES - 1 //////10/04/18
                                        } else {
                                            SES = SES - 0.5 + s段補正 //////10/04/18
                                        }
                                        hosei = 0
                                    }
                                } else {if ( SES > 0 ) { //////09/11/13
                                    SES = -15
                                }
                            } else {
                                if ( SES > -18 ) { ////////09/04/02
                                    if ( hosei <= 0 ) {
                                    if ( SES < -14 ) {
                                        if ( Abs(GOUKEI / 50) > 5 ) { //////09/10/23
            //                                    SES = -18 + min(7, Abs(GOUKEI / 50))
                                            SES = -18 + min(5, Abs(GOUKEI / 50)) //////09/11/30
                                            if ( g荷重表記高 > 120 ) { //////09/11/30
                                                SES = -18 + hosei //////////////09/11/30
                                                if ( hosei = 0 $$ (P7 / Max荷重) < 0.4 ) { //////////////09/12/03
                                                    SES = -15.1
                                                    if ( GOUKEI = -600 $$ g荷重表記高 > 135 ) { //////09/12/09
                                                        SES = -16.5
                                                    }
                                                }
                                            } else {
                                                //////////09/11/30
                                                SES = 寸法線位置 - 寸法補助線 - IIf((yiKozo = 3 $$ _
                                                                    g連続Mod $$ g荷重表記縦 = 1), 6, 0)
                                            }
                                        } else {
                                            SES = -18
                                        }
                                    } else {
                                        if ( Abs(GOUKEI / 50) > 5 $$ g荷重表記高 > 100 ) { //////09/11/11
                                            if ( s寸法文字2段 ) { ////////09/11/10
                                                SES = -18.2
                                            } else {
                                                if ( SES > 0 ) { ////////////////////////////////09/11/13
                                                    SES = -19 //////-Abs(GOUKEI / 50)
                                                } else {
                                                    SES = -16
                                                }
                                            }
                                        } else {
                                            SES = SES - 1 //////09/11/11
                                        }
                                    }
                                    }
                                    if ( (SES > -15 $$ Abs(GOUKEI / 50) > 7) $$ g荷重表記高 > 100 ) { //////09/11/11
                                        if ( s寸法文字2段 ) { ////////09/11/10
                                            SES = -18.2
                                        } else {
                                            SES = -16 //////SES - Abs(GOUKEI / 50 / 2)
                                        }
                                    }
                                }
                                if ( SES < -22 ) { ////////09/04/02
                                    SES = -22 //Round((g荷重表記高 / 50 - (GOUKEI / 100)) + 1.5, 1) ////////09/04/02
                                } else {if ( 寸法線位置 < -10 ) { //////10/01/14
                                    SES = -20
                                }
                            }
                            if ( hosei > 0 ) {
            //                        if ( (hosei ^ 1.5 - 15) < 0 ) {
                                 if ( hosei > 5 $$ g荷重表記高 > 250 ) {
                                    SES = SES + hosei
                                 } else {
                                    SES = SES + hosei / 2 ////////09/11/199
                                 }
                                    if ( N段数 = 1 ) { //////////////08/12/06
                                        SES = min(SES, -8.5) ////////////////////////////////////08/11/17
                                    }
            //                        }
                            }
                            J5 = 0
                        }
                        if ( hosei <= 0 ) { ////////////////////////////////////08/11/033 08/11/05
                            if ( J5 < 5 ) { //////08/12/07
                                if ( (g荷重表記高 / 180) < 0.8 $$ (g荷重表記高 / 180) > 0.6 $$ GOUKEI != -600 ) { //////((yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) || GOUKEI != -600) ) { ////09/12/09//////09/11/11
            //                            J5 = 3 * Round(g荷重表記高 / 180, 1) //////08/12/07
                                    J5 = (12 + SES) //////09/11/11
                                }
                            }
                        }
                        if ( J5 = 0 $$ J10 = 連続荷重数 $$ P7 < 100 $$ Not FLG_列車_衝撃 ) {
                            if ( (g荷重表記高 < 290 $$ SES > -18) $$ g荷重表記高 > 100 ) {  //////09/11/11
                                J5 = 3
                            } else {
                                if ( GOUKEI < -800 ) { ////////09/04/02
                                    J5 = -3
                                }
                            }
                        }
                        SES = SES - J5
                        if ( Mark111 = 4 ) { //////08/10/292
                            if ( Abs(GOUKEI) > 140 ) {
                                SES = -(g荷重表記高 / 50 + 9.5)
                            } else {
                                SES = -((g荷重表記高 + GOUKEI / 2) / 8)
                            }
                            J5 = 0
                        } else {if ( (J10 = 連続荷重数 $$ ((P6 / Max荷重) ^ 0.7) < 0.6 _
                                        $$ Abs(SES) < 9) || (yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) _
                                        || (g荷重表記縦 = 1 $$ Abs(SES) < 9) ) { ////////08/11/277 08/12/05
                            SES = SES - 1.5 - IIf(P6 >= 10, 2.5, 0)
                            if ( Abs(SES) < 10 $$ (P6 / Max荷重) > 0.8 ) {
                                if ( s寸法文字2段 ) { //////09/11/11
                                    SES = -13
                                } else {
                                    SES = -11
                                }
                            } else {if ( (P6 / Max荷重) < 0.3 || 部材正荷重数(SS1) > 60 ) { ////09/11/04 < 0.5 ) {
                                if ( Not (g荷重表記縦 = 1 $$ g荷重表記高 < 60) ) { SES = -6 ////////10/01/03
                            } else {if ( g荷重表記高 < 220 ) { //////////////////09/11/13
            //                        SES = -max(Abs(SES), (g荷重表記高 / 50 + 9.5 + s段補正)) //////////////////09/11/13
                                if ( g荷重表記高 > 210 ) { //////////////////////10/04/05
                                    SES = 寸法線位置 ////////10/03/21
                                    GoTo ABCF ////////10/03/21
                                }
                            }
                        }
                    }
                } else {
                    SES = -3.7 - 6 + 5 + IIf((P6 / Max荷重 < 0.5) || J5 != 0, 3, 0) ////////08/11/033 09/02/20 || J5 != 0
                    if ( N段数 = 1 || 部材正荷重数(SS1) < 35 ) { ////////////08/12/06
                        if ( (P6 / Max荷重) < 0.8 $$ SES > 0 ) { //////09/10/30
                            SES = 0
                        }
                    } else {
            //                if ( (P6 / Max荷重 > 0.95) ) { ////////09/10/30////////09/11/06
            //                    SES = 0
            //                } else {
                            SES = SES - 3 - IIf(部材正荷重数(SS1) < 40, 1, -2) ////////09/10/30
            //                }
                    }
                    if ( J55 < 0 ) {
                        if ( 部材正荷重数(SS1) < 40 ) { //////////////////////////////////09/11/199
                            SES = SES - 7 - IIf(s寸法文字2段, 0.7, 0)
                        } else {
                            SES = SES + 3
                        }
                    }
            //            d分布集中 = 1 //////09/03/25//////09/11/18 コメント
                }
            }
            if ( Mark111 != 1 $$ (部材正荷重数(SS1) >= 24 || SES > -2) $$ SES > -17 $$ g荷重表記高 > 100 ) { ////09/12/25////09/12/26
                if ( hosei <= 0 ) { ////////////10/01/03
                    if ( s寸法文字2段 || s段補正 = 1 ) { //////09/12/13
                        SES = IIf(N段数 = 1 || (g荷重表記縦 = 0 $$ (160 > g荷重表記高)), -1.5, -8.5) - IIf(s段補正 = 1, 1, 0) //////////12/12/29
                        if ( N段数 = 2 $$ 寸法線位置 < -10 $$ SES = -1.5 - IIf(s段補正 = 1, 1, 0) $$ 部材正荷重数(SS1) < 52 ) { //////12/12/29
                            SES = -7.5 - IIf(s段補正 = 1, 1.5, 0)
                        }
                    } else {
                        if ( g荷重表記縦 = 0 $$ Mark111 = 3 $$ g荷重表記高 < 150 ) { ////////10/01/30
                        SES = IIf(N段数 = 1, -0.5, -2)
                        } else {
                        SES = IIf(N段数 = 1, -0.5, -12) ////////09/12/10//////12/02/15
                        }
                    }
                    if ( g荷重表記縦 = 1 ) {
                        if ( (160 > g荷重表記高) ) {
                            if ( hosei = 0 $$ Not (GOUKEI = -560 || GOUKEI = -600) ) { ////09/12/26
                                SES = SES - max(Round((160 - g荷重表記高) / 20, 1), 0) ////09/12/25
                            } else {
            //                        if ( hosei = 0 ) { SES = -5 //////-8.5////////12/02/15  -6.5
                            }
                        } else {
                            SES = SES - (Round((g荷重表記高 - 160) / 20, 1) - hosei / 4) ////09/12/25
                        }
                    }
                } ////////////10/01/03
            } else {if ( g荷重表記縦 = 1 $$ g荷重表記高 < 110 ) { //////////////////10/01/27
                if ( g荷重表記高 = 0 ) {
            //        if ( N段数 = 1 ) {
                SES = IIf(N段数 = 1, IIf(Mark111 = 1, IIf(GOUKEI < 0, -5, -3.5), -0.5), -7.5 + 3) //////10/03/27////// - 6) //////////10/01/30
                } else {
                SES = IIf(N段数 = 1, -0.5, IIf(g荷重表記高 < 80, -8, -5)) //////13/04/08

                }
                if ( g荷重表記高 = 0 $$ 部材正荷重数(SS1) > 43 ) { ////////////////////////////////////10/01/30
                    if ( 寸法線位置 < -17 ) { ////////10/02/05
                        if ( Mark111 = 1 $$ (P7 / Max荷重) < 0.4 ) { //////10/04/100
                            SES = -6
                        } else {
                            SES = -Round(6 * (P7 / Max荷重) ^ 0.5, 2) //////10/04/100
                        }
                    } else {
                        SES = -2
                    }
                }
            }
            if ( N段数 = 1 $$ SES < -19 $$ 部材正荷重数(SS1) > 20 $$ g荷重表記高 > 220 ) { ////////09/12/04
                if ( s寸法文字2段 || s段補正 = 1 ) { //////09/12/13
                    SES = -7.5
                } else {
                    SES = -6.5
                }
            } else {if ( Mark111 = 1 ) { //////09/12/25
                if ( 部材正荷重数(SS1) < 30 ) {
                    if ( SES < -2 $$ Not (GOUKEI > 0 $$ GOUKEI < 11) ) { //////10/03/27
                        if ( (P7 / Max荷重) < 0.4 ) { //////10/04/100
                            SES = -6
                        } else {
                            if ( P7 < 350 $$ (P7 / Max荷重) > 0.99 ) { ////////10/04/18
                                SES = -1
                            } else {
                                if ( 水平垂直 = 0 $$ Mark111 = 1 $$ N段数 > 1 $$ 部材正荷重数(SS1) < 20 ) {
                                    SES = -6.7 //////12/08/17
                                    GoTo ABCF
                                } else {
                                    SES = -Round(6 * (P7 / Max荷重) ^ 0.5, 2) //////10/04/100//////// - s段補正
                                }
                            }
                        }
                    }
                }
            }
            if ( g荷重表記縦 = 0 $$ Mark111 != 3 ) { //////09/12/26////////10/01/30
                if ( (P6 / Max荷重) < 0.4 $$ SES < -1 ) { //////////////////10/01/30 10/02/03 12/12/17
                    if ( Mark111 = 4 ) { ////////////////////////////////////////// 10/02/03
                        if ( Abs(SES) > 10 $$ (P7 / Max荷重) > 0.36 ) {
                            SES = -5 - IIf(s寸法文字2段, 1, 0) //////12/12/17
                        } else {
                        SES = -3 - IIf(s寸法文字2段, 1, 0)  //////12/12/17
                        }
                    } else {
                         if ( g荷重表記高 < 120 ) { ////////09/12/04
                         } else {
                            if ( yiKozo = 1 $$ s段補正 = 0 ) {  //////////////////////12/11/27
                                if ( (P6 / Max荷重) < 0.36 ) { //////12/11/27
                                    if ( 部材正荷重数(SS1) > 70 ) {
                                    SES = -8.5 - IIf(s寸法文字2段, 1, 0) ////////////12/02/15
                                    } else {
                                    SES = -4.5 - IIf(s寸法文字2段, 1, 0) ////////////12/02/15
                                    }
                                }
                            } else {
                                SES = -5 - IIf(s寸法文字2段, 1, 0)
                            }
                         }
                    }
                } else {if ( (P6 / Max荷重) < 0.36 $$ SES = -0.7 $$ g荷重表記高 < 110 ) { //////////// 10/02/03
                    if ( g荷重表記高 < 75 ) { //////////// 10/08/01
                        SES = 4 - IIf(s寸法文字2段, 1, 0) //////////// 10/08/01
                    } else {if ( g荷重表記高 < 90 ) { //////////// 10/02/03
                        SES = -5 - IIf(s寸法文字2段, 1, 0)
                        if ( g荷重表記高 < 65 ) { //////////// 10/02/23
                            SES = -3 - IIf(s寸法文字2段, 1, 0)
                        }
                    } else {
                        SES = -7 //- IIf(s寸法文字2段, 1, 0) //////12/11/22
                    }
                }
            }
            if ( g荷重表記縦 = 1 ) { //////10/01/30
                if ( 部材正荷重数(SS1) > 35 $$ g荷重表記高 < 210 ) { //////10/04/20
                    if ( SES = -20 $$ g荷重表記高 > 170 $$ g荷重表記高 < 200 ) {
                        if ( 部材正荷重数(SS1) > 80 ) {
                            SES = -10
                        } else {
                            SES = -8 //////10/04/20//////-Round(g荷重表記高 / 14, 2) - 4 //////-10
                        }
                    } else {if ( SES = -20 $$ g荷重表記高 > 200 ) {
                        SES = -18
                    } else {if ( g荷重表記高 > 170 $$ Not (yiKozo = 3 $$ g連続Mod) ) { //////10/04/18
                        if ( GOUKEI != -600 ) { SES = -Round(g荷重表記高 / 20, 2) ////// - 2//////10/11/11//////12/02/15
                    } else {if ( g荷重表記高 < 95 $$ g荷重表記高 > 70 $$ yiKozo = 1 ) { //////////////////////10/02/07
                        SES = -16 //////Round(g荷重表記高 / 10, 2) ////// - 2
                    }
                } else {if ( SES > -6 $$ 部材正荷重数(SS1) < 30 $$ g荷重表記高 > 130 ) {
                    SES = -18
                } else {if ( GOUKEI = -395 $$ 部材正荷重数(SS1) < 30 $$ g荷重表記高 > 130 ) { ////////10/02/03
                    SES = -7
                } else {if ( SES > -12 $$ g荷重表記高 > 280 ) {
                    SES = -12
                } else {if ( SES = -20 $$ g荷重表記高 < 280 $$ g荷重表記高 > 245 ) { //////10/04/03
                    if ( g荷重表記高 > 260 ) { //////10/04/04////10/04/17
                        SES = -18
                    } else {
                        SES = -12 - s段補正
                    }
                } else {if ( SES = -20 $$ g荷重表記高 < 200 $$ g荷重表記高 > 165 ) { //////10/04/18 10/10/21
                    SES = -15 - s段補正
                }
                if ( SES >= -6 ) { ////////10/04/18//////10/04/18
                    if ( Mark111 = 1 ) {
                        if ( (GOUKEI > 20 $$ GOUKEI < 100 $$ Abs(寸法線位置) > 15) || Len(鉛直文字列) <= 4 ) { //////10/04/05
                            if ( Len(鉛直文字列) > 6 || (Abs(寸法線位置) > 15 $$ GOUKEI > 80) ) { //////10/04/20
            //                        SES = 寸法線位置 //////10/10/14
                            } else {
                                SES = -5
                            }
                        } else {
                            if ( SES = -6 ) { //////10/04/18
                                SES = -5
                            } else {
                                SES = -3.5 - s段補正 - 3 ////////////////////10/03/27//////10/04/18//////10/10/14//////12/02/15
                            }
                        }
                        if ( 荷重文字サイズ > 9.5 ) { //////12/09/25
                            SES = SES - Round((荷重文字サイズ - 9.5) * 2.5, 2)
                        }
                    } else {
                        if ( SES >= -5 ) { SES = -5  ////////12/02/15////////////////////////10/02/23
                    }
                }
                if ( g荷重表記縦 = 1 $$ g荷重表記高 != 0 $$ g荷重表記高 <= 80 $$ Abs(SES) > 8 ) { //////10/04/09
                    if ( g荷重表記高 < 60 ) { ////////10/04/10
                        SES = -5.5
                    } else {
                        SES = -2
                    }
                } else {if ( g荷重表記縦 = 1 $$ g荷重表記高 > 260 ) { //////12/02/15
            //            if ( SES < -22 ) {
            //                SES = SES + 5
            //            } else {
                        SES = SES + 5
            //            }
                }
            } //////////////////////////////////////////////////10/01/30
            ABCF:
            if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                For( i8 = 1 To yBuzaiFF
                    i = yGGGGG(i8)
                        GFGF = 0
                        if ( 部材正荷重数(i) < 23 ) {
                            DumyG = 部材正荷重数(i)
                            if ( g荷重表記高 < 260 ) {
                                if ( J55 < 0 ) {
                                    GFGF = 2.6
                                } else {
                                    if ( s段補正 = 0 ) {
                                        GFGF = 0
                                        if ( SES > -6 ) { SES = -6
                                    } else {
                                        GFGF = -4
                                        if ( SES >= -6 ) { GFGF = -2 + s段補正
                                    }
                                }
                            }
                        }
                        if ( 寸法線位置 < -10 $$ SES < 4.5 $$ SES > 0 $$ GFGF + s段補正 = 0 ) {
                            SES = 0
                        } else {if ( SES < 0 $$ Abs(SES) > 6 ) {
                            if ( Mark111 = 1 ) { SES = -2
                        }
                        部材正荷重数(i) = 部材正荷重数(i) - 1.7 - SES - 2 + GFGF + s段補正
                    }8
            } else { //////////////////////////////////////////////////12/12/15
                For( i = SS1 To SE2
                    GFGF = 0
                    if ( 部材正荷重数(i) < 23 ) { //////////////09/11/199//////10/04/18
                        DumyG = 部材正荷重数(i)
                        if ( g荷重表記高 < 260 ) { ////////09/12/26
                            if ( J55 < 0 ) {
                                GFGF = 2.6  //////8.6 //////12/09/10
                            } else {
                                if ( s段補正 = 0 ) { ////////09/11/088
                                    GFGF = 0
                                    if ( SES > -6 ) { SES = -6 ////////10/03/03
                                } else {
                                    GFGF = -4 ////////09/12/04 -2
                                    if ( SES >= -6 ) { GFGF = -2 + s段補正 ////////10/01/188
                                }
                            }
                        }
                    }
                    if ( 寸法線位置 < -10 $$ SES < 4.5 $$ SES > 0 $$ GFGF + s段補正 = 0 ) {
            //                SES = 0
                    } else {if ( SES < 0 $$ Abs(SES) >= 6 ) {
                        if ( Mark111 = 1 || Mark111 = 2 ) {
                            if ( g荷重表記縦 = 0 ) { //////13/04/08
                                SES = -2
                            } else {
                                if ( g荷重表記高 >= 80 ) { SES = max(Abs(SES), 20 + ((300 - g荷重表記高) / 20)) * Sgn(SES)
                            } //////////////13/04/08
                        }
                    }
                    部材正荷重数(i) = 部材正荷重数(i) - 1.7 - SES - 2 + GFGF + s段補正 //////09/10/20
                }
            } //////12/12/15
            } else {
            Select Case j
            Case 1
                SES = -(-2 + IIf(yFR橋脚 = 1 $$ J5 != 0, 2, 0) - max(hosei, 0) + s段補正) //////10/10/14
                if ( 連続荷重mark(1) = 11 $$ g荷重表記高 = 0 $$ 部材正荷重数(SS1) < 16 ) {
                    SES = -6.5
                }
                if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                    For( i8 = 1 To yBuzaiFF
                        i = yGGGGG(i8)
                        部材正荷重数(i) = 部材正荷重数(i) - SES
                    }8
                } else { //////////////////////////////////////////////////12/12/15
                    For( i = SS1 To SE2
                        部材正荷重数(i) = 部材正荷重数(i) - SES
                    }
                }
            Case 2
                if ( GHOSEI = 0 ) {
                    SES = Round(-寸法線位置 / 2.2, 1) ////08/10/07////08/10/29
                    if ( J10 = 連続荷重数 ) {
                        SES = SES + 4 //////////08/10/15
                    }
                    if ( (P7 / Max荷重) > 0.8 ) { SES = Round(SES / 1.5, 1) ////08/10/29
                } else {if ( J10 = 連続荷重数 $$ GHOSEI < 0 ) {
                    SES = (-寸法線位置 / 1) ////08/10/095
                } else {if ( J10 = 連続荷重数 ) {
                    GHOSEI = GHOSEI * ((P7 / Max荷重) ^ 0.7) //////08/10/099
                }
                if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                    For( i8 = 1 To yBuzaiFF
                        i = yGGGGG(i8)
                        部材正荷重数(i) = 部材正荷重数(i) + 0.5 + max(GHOSEI, SES) + s段補正
                    }8
                } else { //////////////////////////////////////////////////12/12/15
                    For( i = SS1 To SE2
                        部材正荷重数(i) = 部材正荷重数(i) + 0.5 + max(GHOSEI, SES) + s段補正
                    }
                }
            Case 3
                if ( Mark111 = 3 ) { //////09/11/13
                    SES = Round(4 * (P7 / Max荷重) ^ 0.8 + min(hosei, 0), 1) //////10/03/21
                } else {
                    SES = Round(4 * (P7 / Max荷重), 1) //////10/03/21
                }
                if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                    For( i8 = 1 To yBuzaiFF
                        i = yGGGGG(i8)
                        部材正荷重数(i) = 部材正荷重数(i) + SES + s段補正
                    }8
                } else { //////////////////////////////////////////////////12/12/15
                    For( i = SS1 To SE2
                        部材正荷重数(i) = 部材正荷重数(i) + SES + s段補正
                    }
                }
            Case 4
                if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                    For( i8 = 1 To yBuzaiFF
                        i = yGGGGG(i8)
                        部材正荷重数(i) = 部材正荷重数(i) + 2 + s段補正
                    }8
                } else { //////////////////////////////////////////////////12/12/15
                    For( i = SS1 To SE2
                        部材正荷重数(i) = 部材正荷重数(i) + 2 + s段補正
                    }
                }
            Case } else {
                if ( J9 = 1 $$ GHOSEI > 0 ) {
                    if ( (P7 / Max荷重) >= 0.98 ) {
                        if ( (P7 / Max荷重) < 1.5 ) {
                            SES = max(4, GHOSEI * 0.6)
                        } else {
                            SES = max(10, GHOSEI * 0.6)
                        }
                    } else {
                        SES = max(8 * (1 - P7 / Max荷重), GHOSEI * 0.6)
                    }
                    if ( FLG_列車_衝撃 ) {
                        if ( N段数 = 1 ) {
            //                    SES = SES + 3 //////////08/10/15 //////009/02/20 コメントにした
                        } else {
                            SES = SES + 4.5 - m調整高 //////10/11/11//////hosei / 2 //////////08/10/292
                        }
            //            }
                    } else { //////J7 = 1 $$ J9 = 1 ) { //////08/10/292////////08/11/25
                        if ( J7 != 1 ) { ////////08/11/25
                            if ( (P7 / Max荷重) > 0.95 ) {
                                if ( g荷重表記縦 = 0 $$ g荷重表記高 = 180 $$ GOUKEI = 260 ) { //////12/08/21
                                    SES = max(SES / 2, 2)
                                } else {
                                    SES = max(SES / 1, 5)
                                }
                            } else {
                                SES = max(SES / 1.5, 2)
                            }
                        } else {
                           SES = max(SES, GHOSEI) ////////09/11/199
                        }
                    }
                } else {
                    if ( FLG_列車_衝撃 ) {
                        SES = IIf(yFR橋脚 = 1, 0, 4 * (P7 / Max荷重))
                        if ( N段数 = 1 ) {
                            SES = SES + 2 //////////08/10/292
                        } else {
                            SES = SES + 4.5
                        }
                    } else {
                        if ( N段数 = 1 ) { //////08/10/29
                            if ( J8 = 0 ) {
                                if ( g荷重表記縦 = 0 ) {
                                SES = 0
                                } else {
                                SES = 1 ////////0 - 1.3 //09/04/07//////(g荷重表記高 / 100) //////1.5 // + Round((P7 / Max荷重), 1) + g荷重表記高
                                }
                            } else {
                                SES = 0 + IIf(J8 = 0, 0, 2)
                            }
                        } else {
                            if ( yFR橋脚 = 1 $$ Not (g連続Mod = True $$ yiKozo = 3) ) { ////////09/07/30
                                SES = 0
                                if ( (P7 / Max荷重) > 0.9 || g荷重表記高 > 280 ) { //////09/08/03
                                    SES = 5 * (P7 / Max荷重)
                                } else {if ( (P7 / Max荷重) > 0.6 $$ g荷重表記高 < 220 ) { //////09/10/14
                                    SES = (1.5 * min(Max荷重 / P7, 2))
                                } else {
                                    SES = 3.5 ////////09/11/08
                                }
                            } else {
                                if ( (P7 / Max荷重) > 0.9 || g荷重表記高 >= 180 ) { //////10/04/09
                                    if ( 部材正荷重数(SS1) > 30 ) {
                                        SES = 5 * (P7 / Max荷重) //////////08/11/25
                                    } else {
                                        SES = 6 * (P7 / Max荷重) //////////08/11/25 10/04/09
                                    }
                                } else {
                                    if ( (P7 / Max荷重) > 0.7 ) {
                                        SES = 0
                                    } else {
                                        if ( (P7 / Max荷重) < 0.4 ) { //////08/11/044//////08/11/25
                                            if ( yiKozo = 3 ) { //////08/11/277
                                                SES = -3.2
                                                if ( g連続Mod = True $$ g荷重表記縦 = 0 ) { ////////09/07/30
                                                    if ( (P7 / Max荷重) > 0.4 ) { SES = 0 } else { SES = -1 //////////09/12/04
                                                }
                                            } else {
                                                SES = 0 //////08/11/25//////08/11/277
                                            }
                                        } else {
                                            SES = 2
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if ( (g荷重表記縦 = 0 $$ N段数 = 1 $$ Mark111 = 2) $$ _
                   Not (g連続Mod = True $$ yiKozo = 3) ) { //////////////////////////////////////////////09/08/03
                         if ( (P7 / Max荷重) < 0.6 $$ SES = 0 ) { ////////09/11/199
                         SES = max(17, Round((g荷重表記高 / 20), 2)) + s段補正 + IIf(s寸法文字2段, 1, 0.5)
                         } else {
                         SES = max(12.8, Round((g荷重表記高 / 18), 2)) + SES + s段補正 + IIf(s寸法文字2段, 1, 0.5)
                            if ( (P7 / Max荷重) > 0.9 $$ SES < 18 ) { //////////10/02/23
                                SES = 18 * (P7 / Max荷重) + s段補正
                            }
                         }
                    if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                        For( i8 = 1 To yBuzaiFF
                            i = yGGGGG(i8)
                            if ( SES > 部材正荷重数(i) ) {
                                部材正荷重数(i) = 部材正荷重数(i) + IIf(g背割れ = 2 $$ SES > 15, 15, 9) + s段補正
                            } else {
                                部材正荷重数(i) = 部材正荷重数(i) + 1 + s段補正
                            }
                        }8
                    } else { //////////////////////////////////////////////////12/12/15
                        For( i = SS1 To SE2
                            if ( SES > 部材正荷重数(i) ) {
                                部材正荷重数(i) = 部材正荷重数(i) + IIf(SES > 15, 15, 9) + s段補正 ////12/12/15//////IIf(g背割れ = 2 $$ SES > 15, 15, 9) + s段補正
                            } else {
                                部材正荷重数(i) = 部材正荷重数(i) + 1 + s段補正
                            }
                        }
                    }
                } else {
                    if ( g荷重表記高 = 220 $$ GOUKEI = 150 $$ SES < 6 ) { //////09/11/202
                        if ( Not 連続荷重mark(1) = 4 $$ (P7 / Max荷重) < 0.6 ) { //////10/10/13
                        SES = 3 + Round(SES, 0)
                        }
                        if ( 連続荷重mark(1) = 4 $$ (P7 / Max荷重) > 0.95 ) { //////10/10/20
                        SES = 3 + Round(SES, 0)
                        }
                    }
            //            if ( ((g荷重表記縦 = 0 $$ N段数 = 1 $$ (Mark111 = 2 || Mark111 = 3)) $$ SES = 0) ) { //////10/03/21
                    if ( ((g荷重表記縦 = 0 $$ (Mark111 = 2 || Mark111 = 3)) $$ SES < 14 * (P7 / Max荷重) ^ 0.5) ) { //////12/11/22
                            if ( (J9 = 1 $$ (GHOSEI = 1 || GHOSEI = 2.5)) ) { //////12/12/16
                                SES = 2
                                if ( 部材正荷重数(SS1) < 25 ) {
                                    SES = 16 * ((P7 / Max荷重) ^ 0.5) //////12/12/16
                                }
                            } else {
                                if ( 部材正荷重数(SS1) < 80 ) { //////12/12/299
                                SES = 14 * ((P7 / Max荷重) ^ 0.5) //////////12/11/22
                                }
                            }
                    }
                    if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                        For( i8 = 1 To yBuzaiFF
                            i = yGGGGG(i8)
                            部材正荷重数(i) = 部材正荷重数(i) + SES + s段補正
                        }8
                    } else { //////////////////////////////////////////////////12/12/15
                        For( i = SS1 To SE2
                             部材正荷重数(i) = 部材正荷重数(i) + SES + s段補正
                        }
                    }
                }
            End Select
            }

            ABC:

            if ( 上層Buzai(MQM) = SE2 $$ 荷重図開き > 0 $$ yBuzaiFF = 0 ) { //////12/12/299
                J5 = 9999
                J6 = 0
                For( i = 1 To MQM
                    J4 = 上層Buzai(i)
                    J5 = min(J5, 部材正荷重数(J4))
                    J6 = max(J6, 部材正荷重数(J4))
                }
                if ( 連続荷重mark(1) = 5 ) { //////13/04/12
                    if ( J6 < 5 ) { J6 = 5
                }
                if ( J5 != J6 ) {
                    For( i = 1 To MQM
                        J4 = 上層Buzai(i)
                        部材正荷重数(J4) = J6
                    }
                }
            } //////12/12/299
            //    //////////////////////////////////////////////
            //    連続荷重数 = 0
            //    gHosei = 0
            //    寸法線位置 = 0
            //    g荷重表記縦 = 0 //////08/10/29
            //    g荷重表記高 = 0
            //    g荷重表記高5 = 0 //////09/11/13
            //    //
            GRF777:
                                                    */
        }


        ////////////////////////////////////////////////////////////////////////09/10/20 荷重方向
        private void 部材連続寸法_2(object obj, int 連続荷重数, int 節点S, int 節点E,
                                    double 荷重図開き, string 荷重方向5, int[] 連続荷重mark, double[] 連続荷重_L1, double[] 連続荷重_L2, double[] 連続荷重_P1, double[] 連続荷重_P2,
                                    string dhosei, int SS1, int SE2, bool Mark_Flg, int CASU, int yBuzaiFF, int[] yGGGGG)
        {
            /*
            //
            var 寸法補助線
            var BSPAN
            var BX0
            var BY0
            var BXE
            var BYE
            var 図BSPAN
            var 図倍率
            var BSN
            var BCS
            var BTAN
            var B角度
            var XX1
            var XX2
            var XX3
            var YY1
            var Yy2
            var YY3
            var PX0
            var PY0
            var PXE
            var PYE
            var PX1D
            var PY1D
            var PX2D
            var PY2D
            var PX3D
            var PY3D
            var 寸法(100) //////09/10/25
            double var X(100)
            double var Y(100)
            var i                       As Integer
            var j                       As Integer
            double var GGII
            double var GGjj
            var HIH                       As Integer
            var XL2
            var NN                      As Integer
            var HV                      As Integer
            var HV5                     As Integer
            var N55                     As Integer
            var XL(100)                 As Single
            var CNum As Integer
            var GHOSEI As Single
            var UUUU As Integer, PPPP As Single
            var Flg3 As Integer //////////////////////////////////////////////////07/07/26
            var AALL As Single ////////////08/07/02
            var J4 As Integer ////////08/07/08
            var J5 As Single ////////08/09/26
            var J6 As Single ////////08/09/26
            var P6 As Single ////////08/09/26
            var J7 As Single ////////08/09/26
            var P7 As Single ////////08/09/26
            var P8 As Single ////////////////////////////09/11/199
            var J8 As Single ////////08/09/26
            var J9 As Single, J10 As Single //////////////////08/10/095
            var yFR橋脚 As Integer
            var yiKozo As Integer
            var 寸法線位置 //////////////////////////////08/10/29
            var wXs As Single, wXe As Single, wYs As Single, wYe As Single //////09/09/300
            var f寸法FLG As Integer //////09/08/14
            var s寸法文字2段 As Boolean ////////////////09/10/20
            var s斜めFLG As Integer //////09/10/24
            var Max荷重 As Single //////09/10/299
            var MK5 As Integer //////09/11/09
            var m調整高 As Single //////10/11/11
            var FLG杭杭 As Boolean //////////////////////////////////11/12/166
            var 鉛直文字列 As String //////////////09/11/16
            鉛直文字列 = "1"
            //
            階段Mod = 階段Mod
            FLG杭杭 = False //////////////11/12/166
            if ( InStr(部材名(SS部材), "杭") != 0 ) {
                FLG杭杭 = True
            }
            if ( FLG杭杭 = False ) {
                if ( yBuzaiFF > 0 ) { ////////12/12/15
                    For( j = 1 To yBuzaiFF
                        i = yGGGGG(j)
                        if ( InStr(部材名(i), "杭") = 1 ) {
                            FLG杭杭 = True
                            Exit For
                        }
                    }
                } else {
                    For( i = SS1 To SE2
                        if ( InStr(部材名(i), "杭") = 1 ) {
                           FLG杭杭 = True
                           Exit For
                        }
                    }
                }
            }
            if ( FLG杭杭 = True $$ 連続荷重mark(1) = 6 ) { //////12/02/15
                s斜めFLG = 0
                For( i = 1 To 連続荷重数
                    if ( 連続荷重_L1(i) != 0 || 連続荷重_L2(i) != 0 ) {
                        s斜めFLG = 1
                        Exit For
                    }
                }
                if ( s斜めFLG = 0 ) {
                    GoTo ABC //////return;
                }
            }
            if ( Flg_PRESTRES(1) = 1 || Flg_PRESTRES(2) = 1 ) { //////12/02/15
                GoTo ABC //////return;
            }
            s斜めFLG = 0 //////09/10/24
            f寸法FLG = 0
            m調整高 = 0 //////////////10/11/11
            yFR橋脚 = FR橋脚
            yiKozo = iKozo
            //
            if ( Not (yiKozo = 3 $$ g連続Mod) ) {
                    yiKozo = 1 ////////10/01/24 12/12/15
            }
                    yFR橋脚 = 1
            //
            BSPAN = 部材Span(節点S, 節点E)
            ////////09/09/300
            var ii As Integer, i7 As Integer, i8 As Integer //////09/10/14
            wXs = 節X(節点S)
            wXe = 節X(節点E)
            wYs = 節Y(節点S)
            wYe = 節Y(節点E)
            var 荷重方向
            荷重方向 = 荷重方向5 ////////09/10/20
            if ( wYs = wYe $$ (荷重方向 = "V" || 荷重方向 = "M") $$ yBuzaiFF = 0 ) {
                荷重方向 = ""
            }
            if ( SS1 = SE2 $$ 荷重方向 = "H" $$ 連続荷重mark(1) = 2 ) { //////////09/10/24
            //        s斜めFLG = 2
                水平垂直 = 1 //////13/12/26
                荷重図開き = Abs(荷重図開き) //////13/12/26
            }
            ////////////////////////////////////////////////////////////////////////////////09/10/24
            //    if ( yBuzaiFF > 0 $$ 荷重方向 = "" $$ wXs != wXe $$ wYs != wYe ) { //////13/04/07//////13/04/08
            //        荷重方向 = "V"
            //    }
            //////10/03/07
            if ( (Abs(SE2 - SS1) > 1 || yBuzaiFF > 0) $$ _
                                (荷重方向 = "V" || 荷重方向 = "M") ) { ////////09/09/301
                if ( 荷重方向 = "V" $$ 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) + 連続荷重_P2(1) < 0 ) {
                    PPPP = min(wYs, wYe)
                    if ( yBuzaiFF > 0 ) { //////////////////09/10/14
                        For( i8 = 1 To yBuzaiFF
                            i7 = yGGGGG(i8)
                            J4 = 部I(i7): PPPP = min(PPPP, 節Y(J4))
                            J4 = 部J(i7): PPPP = min(PPPP, 節Y(J4))
                        }8
                    } else {
                        For( i7 = SS1 To SE2
                            J4 = 部I(i7): PPPP = min(PPPP, 節Y(J4))
                            J4 = 部J(i7): PPPP = min(PPPP, 節Y(J4))
                        }7
                    }
                } else {
                    PPPP = max(wYs, wYe)
                    if ( yBuzaiFF > 0 ) { //////////////////09/10/14
                        For( i8 = 1 To yBuzaiFF
                            i7 = yGGGGG(i8)
                            J4 = 部I(i7): PPPP = max(PPPP, 節Y(J4))
                            J4 = 部J(i7): PPPP = max(PPPP, 節Y(J4))
                        }8
                    } else {
                        For( i7 = SS1 To SE2
                            J4 = 部I(i7): PPPP = max(PPPP, 節Y(J4))
                            J4 = 部J(i7): PPPP = max(PPPP, 節Y(J4))
                        }7
                    }
                }
                wYs = PPPP
                wYe = PPPP
            }
            BX0 = 図X(wXs)
            BY0 = 図Y(wYs)
            BXE = 図X(wXe)
            BYE = 図Y(wYe)
            ////////09/09/300
            水平垂直 = 9 //////////////////////////08/07/02
            if ( BX0 = BXE ) {
                水平垂直 = 1 // 垂直
                AALL = 図Y_SCALE
            }
            if ( BY0 = BYE ) {
                水平垂直 = 0 // 水平
                AALL = 図X_SCALE
            }
            if ( BX0 != BXE ) {
                if ( (Abs(BY0 - BYE) / Abs(BX0 - BXE)) < 0.05 ) { ////////10/10/13
                    水平垂直 = 0 // 水平
                    AALL = 図X_SCALE
                }
            }

            //    if ( 水平垂直 = 9 $$ 荷重方向 = "H" $$ Mark111 = 2 ) { //////09/08/23
            //    For( i = 1 To 連続荷重数
            //        連続荷重_P1(i) = 連続荷重_P1(i) * (-1)
            //        連続荷重_P2(i) = 連続荷重_P2(i) * (-1)
            //    }
            //    }
            if ( dhosei = "" || dhosei = 0 ) { ////////08/10/29
                GHOSEI = hosei
            } else {
                GHOSEI = dhosei //////////hosei////////08/10/29
            }
            if ( g荷重連寸法補正 = 1 ) { //////////////////////////////07/01/17
                GHOSEI = GHOSEI + 3.5
                g荷重連寸法補正 = 0
            }
            if ( BX0 != BXE $$ (節Y0(節点S) + 節Y0(節点E)) / 2 > (YY_max * 0.8) ) { ////////////07/01/177
                g荷重連寸法回数 = g荷重連寸法回数 + 1 ////////////07/01/177
            }
            if ( (水平垂直 = 1 $$ iKozo = 3 $$ 連続荷重数 = 1 $$ 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) != 連続荷重_P2(1)) ) {
                g荷重表記縦 = 1 //////13/02/01
            }
            ////////////////////////////07/11/03
            j = 0
            J4 = 0: J5 = 0: J6 = 0: J7 = 0: P6 = 0: J7 = 0 ////////08/09/26
            J8 = 0: J9 = 0: J10 = 0 ////////08/10/095
            P6 = 0: P7 = 0: P8 = 0 //////09/11/199
            MK5 = 0 //////09/11/09
            For( i = 1 To 連続荷重数
                if ( 連続荷重mark(i) = 1 ) { ////////09/11/16//////Or 連続荷重mark(i) = 11 ) {
                    j = j + 1
                ////////////////////////////////////////09/11/16
                    if ( Len(鉛直文字列) < Len(Format(連続荷重_P1(i), "0.00")) ) { 鉛直文字列 = Format(連続荷重_P1(i), "0.00")
                    if ( Len(鉛直文字列) < Len(Format(連続荷重_P2(i), "0.00")) ) { 鉛直文字列 = Format(連続荷重_P2(i), "0.00")
            //                Exit For
                }
                if ( 連続荷重mark(i) = 4 ) { ////////08/07/08
                  J4 = J4 + 1
                }
                if ( 連続荷重mark(i) = 5 || 連続荷重mark(i) = 11 ) { ////////09/11/16
                  MK5 = MK5 + 1
                }
                ////////////////////////////////////////////////////////////////////////////////////////////////////
                if ( (連続荷重_P1(i) >= 0 || 連続荷重_P2(i) >= 0) ) { //////08/09/26
                    if ( 連続荷重mark(i) = 1 ) {
                        J5 = 1
                        P6 = max(P6, 連続荷重_P1(i))
                        P6 = max(P6, 連続荷重_P2(i))
                   } //////////////////////////////////////////////////////////////////////////////////////////////////////////////!= 09/12/02
                    if ( 連続荷重mark(i) = 2 $$ (連続荷重_P1(i) * 連続荷重_P2(i) != 0 $$ 連続荷重_P1(i) != 連続荷重_P2(i)) ) {
                        J6 = 1
            //                g荷重表記縦 = 1 ////////08/11/28//////09/03/10 コメントにした
                    }
                    if ( 連続荷重mark(i) = 2 $$ (連続荷重_P1(i) * 連続荷重_P2(i) = 0 || 連続荷重_P1(i) = 連続荷重_P2(i)) ) {
                        J7 = J7 + 1
                    }
                    if ( 連続荷重mark(i) = 2 $$ 連続荷重_P1(i) = 連続荷重_P2(i) ) { //////08/10/09
                        J9 = J9 + 1 //////08/10/09
                    }
                    if ( 連続荷重mark(i) = 2 $$ 連続荷重_P1(i) * 連続荷重_P2(i) = 0 ) { //////08/10/09
                        J10 = J10 + 1 //////08/10/09
                    }
                    if ( (連続荷重mark(i) = 4 $$ 連続荷重_P1(i) = 連続荷重_P2(i)) _
                        || (連続荷重mark(i) = 3 $$ 連続荷重_P1(i) * 連続荷重_P2(i) = 0) ) { //////////08/10/09
                        J8 = J8 + 1
                    }
                    if ( 連続荷重mark(i) = 2 || 連続荷重mark(i) = 4 || 連続荷重mark(i) = 3 ) { //////////08/10/09
                        P6 = max(P6, Abs(連続荷重_P1(i))) ////08/10/29
                        P6 = max(P6, Abs(連続荷重_P2(i))) ////08/10/29
                    }
                }
                if ( g荷重表記縦 = 0 || (g荷重表記縦 = 1 $$ 連続荷重_P1(i) != 連続荷重_P2(i)) || 連続荷重mark(i) = 1 ) {  //////08/11/17
                    P7 = max(P7, Abs(連続荷重_P1(i))) ////08/10/29
                    P7 = max(P7, Abs(連続荷重_P2(i))) ////08/10/29
                }
            }
            //
            var Mark111 As Integer
            //
            if ( J5 = 1 ) {
                g荷重表記高 = 0
                Mark111 = 1
            } else {
                if ( g荷重表記縦 = 1 ) {
                    For( i = 1 To 連続荷重数
                        if ( (連続荷重mark(i) = 2 || 連続荷重mark(i) = 4) $$ _
                            (連続荷重_P1(i) * 連続荷重_P2(i) = 0 || 連続荷重_P1(i) != 連続荷重_P2(i)) ) {
                            P8 = max(P8, Abs(連続荷重_P1(i))) //////09/11/30
                            P8 = max(P8, Abs(連続荷重_P2(i)))
                        }
                    }
                    if ( P8 != 0 ) {
                        P7 = P8
                    }
                    if ( g荷重表記高 < g荷重表記高5 / 1.5 ) {
                        g荷重表記高 = g荷重表記高5 / 1.5
                    } //////09/11/199
                } else {
                    if ( 水平垂直 = 0 $$ g荷重表記高5 > 180 ) {
                        if ( 連続荷重数 = 1 $$ 連続荷重mark(1) = 2 $$ (連続荷重_P1(1) = 連続荷重_P2(1)) $$ 荷重方向5 = "" ) { //////13/04/08
                            g荷重表記高5 = 600 - Round(g荷重表記高5, 0) //////13/04/07//////13/04/08
                        } else {
                            g荷重表記高5 = 180
                        }
                    }
                    g荷重表記高 = g荷重表記高5
                }
                if ( (MK5 != 0 $$ MK5 = 連続荷重数) ) {
                    Mark111 = 5
                } else {
                    Mark111 = 連続荷重mark(1)
                }
            }
            //////////////////////////////////////////////////////////////
            if ( Mark111 = 6 ) { //////////////////////12/02/15
                if ( 連続荷重数 = 1 ) {
                    if ( 連続荷重_L1(1) = 0 $$ 連続荷重_L2(1) = 0 ) {
                        GoTo ABC //////return;
                    }
                    if ( InStr(部材名(SS部材), "柱") != 0 ) { //////////////////12/02/15
                        if ( 節X(節点S) != g柱X座標(g柱本数, 1) ) {
                            GoTo ABC //////return;
                        }
                    }
                } else {if ( InStr(部材名(SS部材), "杭") != 0 ) { //////////////////12/02/15
                    荷重図開き = Abs(荷重図開き) //////136
                    KUIDAN = 0
            //            Mark111 = 2
            //            For( i = 1 To 連続荷重数
            //                連続荷重mark(i) = 2
            //            }
                }
            }
            Max荷重 = BU荷重MAX //////////////////////////////////////09/10/299
            if ( J5 = 1 || Mark111 = 5 ) { //////08/09/26//////09/11/09
                J6 = 0
                J7 = 0
                J8 = 0
                J9 = 0 //////08/10/09
                J5 = IIf(yFR橋脚 = 1, -0.7, 1)
                GHOSEI = 0
                Max荷重 = BP荷重MAX ////////////////09/10/299
                if ( Max荷重 = 0 ) { Max荷重 = P7 ////////////09/11/30
            } else {
                if ( J10 = 連続荷重数 ) {
                    J6 = 1 //////08/10/095
                    J7 = 0 //////08/10/096
                }
                if ( J6 = 1 ) {
                    if ( (P6 / Max荷重) < 0.7 ) {
                        if ( J10 = 連続荷重数 ) { //////08/10/096
                            J6 = 0
                        } else {
            //                    J6 = min(1 / (P6 / Max荷重), 3) //////////09/04/06
                            J6 = 0.3 //////////09/04/06
                        }
                    } else {if ( (P6 / Max荷重) > 0.9 ) {
                        if ( yFR橋脚 = 1 ) {
                            if ( 部材正荷重数(SS1) < 20 ) {
                                J6 = -1.5
                            } else {
                                J6 = -2.2
                            }
                        } else {
                            J6 = 2.5
                        }
                    } else {
                        J6 = -0.5
                    }
                    if ( yiKozo = 3 || g連続Mod ) {
                        J6 = -1.5
                    }
                }
            }
            if ( J7 = 連続荷重数 ) { J7 = 1 } else { J7 = 0
            if ( J9 = 連続荷重数 ) { J9 = 1 } else { J9 = 0 //////08/10/09
            if ( J8 = 連続荷重数 ) {
                if ( ((P6 / Max荷重) ^ 0.7) < 0.6 ) { //////08/10/09
                    J8 = 1.5
                } else {if ( (P6 / Max荷重) > 0.95 ) {
                    J8 = 1.3
                } else {
                    J8 = Round((Max荷重 / P6) ^ 0.5, 1) //////1//////08/10/29
                }
            } else {
                J8 = 0
            }
            //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////08/09/26
            //    if ( (Mark111 = 1 || Mark111 = 11) ) {
            if ( j != 0 ) {
                if ( FLG記号 = 1 ) { ////////////////07/05/13
                    GHOSEI = GHOSEI + IIf(j = 連続荷重数, 0.5, 1) //////+ 3
                }
            } else {
                if ( g連続Mod ) {
                    j = 2 ////////////////////06/12/14
                    GHOSEI = max(GHOSEI, 0) ////////////////////連続梁 05/02/06
                        For( i = 1 To 連続荷重数
                              if ( (連続荷重mark(i) = 2 || 連続荷重mark(i) = 3 || 連続荷重mark(i) = 4) $$ _
                                 (連続荷重_P1(i) != 連続荷重_P2(i)) $$ ((連続荷重_L2(i) - 連続荷重_L1(i)) * AALL * Twip) < 0.5 ) {
                                    j = 0
                                    Exit For
                              }
                        }
                        if ( FLG記号 = 1 ) { ////////////////07/05/13
                            if ( j = 0 ) {
                                GHOSEI = GHOSEI + 5.5
                            }
                        }
                } else {
                    if ( yFR橋脚 = 2 ) {
                        GHOSEI = max(GHOSEI, 0) ////////////////////////////// 05/09/20
                    } else {
                        j = 2 ////////////////////06/12/14
                        For( i = 1 To 連続荷重数
                              if ( 連続荷重mark(i) != 2 ) { j = 0
                        }
                    if ( j = 2 ) { // if ( 連続荷重mark(1) = 2 ) {
                        UUUU = 0: PPPP = 0 ////////////////////06/12/14
                        For( i = 1 To 連続荷重数
                              if ( (連続荷重_P1(i) != 連続荷重_P2(i)) ) { UUUU = 1
                              PPPP = max(PPPP, Abs(連続荷重_P1(i)))
                              PPPP = max(PPPP, Abs(連続荷重_P2(i)))
                        }
            //                if ( (連続荷重mark(1) = 2 || 連続荷重mark(1) = 3) ) {
            //                    gHosei = -荷重寸法線位置(1) * (1 - (Abs(max(Abs(連続荷重_P1(1)), Abs(連続荷重_P2(1)))) / Max荷重) ^ 0.25) ////// 06/02/23

            //                    gHosei = gHosei / 3
            //                    if ( gHosei < -1.5 ) { ////////////06/04/06
            //                    gHosei = -1.2
            //                    }
                            if ( (Mark111 = 2 $$ GHOSEI < -2) || (Mark111 = 3 $$ GHOSEI > -2) ) {
                                if ( (Mark111 = 2 $$ GHOSEI < -2) ) { //////08/06/17
                                    GHOSEI = 2.5 //////08/06/17
                                } else {
                                    GHOSEI = -荷重寸法線位置(1) * (1 - (PPPP / Max荷重) ^ 0.25) ////// 06/02/23
                                }
                            } else {
                                GHOSEI = GHOSEI / 2.5
                            }
                            if ( UUUU = 0 ) { ////////////////////////////////////////////////////////////06/12/14
                                if ( ((PPPP / Max荷重) ^ 0.5) > 0.8 ) {
                                    GHOSEI = max(GHOSEI, 2.5)
                                } else {
                                    GHOSEI = max(GHOSEI, 1)
                                }
                            } else {
                                GHOSEI = GHOSEI + IIf(((PPPP / Max荷重) ^ 0.5) > 0.8, 1.5, 0)
                                GHOSEI = GHOSEI + ((PPPP / Max荷重) ^ 0.6) * 1.3 ////////////////06/12/14
                                if ( GHOSEI < hosei ) {
                                    GHOSEI = max(hosei, 9)
                                }
                            }
                            if ( GHOSEI < -5 ) { ////////////06/09/06
                                GHOSEI = -5
                                if ( FLG記号 = 1 ) { ////////////// ////////08/06/17
                                    GHOSEI = GHOSEI + 5.5
                                }
                            } else {if ( GHOSEI > -0.8 $$ Mark111 = 3 ) { ////////////06/09/06
                                GHOSEI = -1
                                if ( FLG記号 = 1 ) { ////////////// ////////08/06/17
                                    GHOSEI = GHOSEI + 5.5
                                }
                            }
                            if ( BX0 = BXE ) { //////////////08/06/17
                                GHOSEI = GHOSEI + 4
                            }
                        } else { ////// 05/09/20
                            GHOSEI = 0
                        }
            //                }
                    }
                }
            }
            ////////////////////////////////////////////////////////////////////////// 05/02/05
            CNum = 0
            if ( yiKozo = 1 ) {
            i = 節点S
            Do
                        GGII = i
                        GGjj = (i + 1)
                        if ( GGII * GGjj = 0 || GGII > 1000 ) { Exit Do ////////05/04/26
                        j = 0
                        HIH = 0
                        Do
                            j = j + 1
                            if ( j > 部材_max ) { Exit Do
                            if ( GGII = 部I(j) $$ GGjj = 部J(j) ) {
                                HIH = j
                                Exit Do
                            }
                        Loop
                        if ( HIH > 0 ) {
                            if ( ZFAngle(HIH) = 0 $$ 部材正荷重数(HIH) > 20 ) {
                                CNum = 1
                                Exit Do
                            }
                        }
                i = i + 1
                if ( i = 節点E ) { Exit Do
             Loop
                if ( CNum = 0 $$ g連続Mod ) {
                GHOSEI = max(GHOSEI, 8) ////////////////////連続梁 05/02/06
                }
            }
            //    if ( g荷重表記縦 = 1 ) { gHosei = 0 //////09/04/02
            //
            Select Case 荷重方向
            Case "V", "M", "S"
                BSPAN = Round(Abs(節X0(節点S) - 節X0(節点E)), 3)
                BY0 = max(BY0, BYE)
                BYE = BY0
            Case "H"
                BSPAN = Round(Abs(節Y0(節点S) - 節Y0(節点E)), 3)
                if ( (節X0(節点S) + 節X0(節点E)) / 2 < (JX_max + JX_min) / 2 ) { ////////////07/01/08
                    if ( s斜めFLG = 0 ) {
                    BX0 = min(BX0, BXE)
                    } else {
                    BX0 = min(BX0, BXE)
                    }
                } else {
                    if ( s斜めFLG = 0 ) {
                        BX0 = max(BX0, BXE)
                    } else {
                        BX0 = max(BX0, BXE)
                    }
                }
                BXE = BX0
            Case } else {
            End Select
            図BSPAN = Sqr((BXE - BX0) ^ 2 + (BYE - BY0) ^ 2)
            if ( 図BSPAN <= 0 ) {
                図BSPAN = 1
            }
            if ( BSPAN <= 0 ) {
                BSPAN = 1
            }
            図倍率 = 図BSPAN / BSPAN
            BSN = (BYE - BY0) / 図BSPAN
            BCS = (BXE - BX0) / 図BSPAN
            if ( 荷重方向 = "V" ) { //////And 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) + 連続荷重_P2(1) > 0 ) { //////10/03/07
            //        BCS = Abs(BCS)
            }
            //    水平垂直 = 9////////////////////////////////////////08/07/02
            //    if ( BX0 = BXE ) {
            //        水平垂直 = 1 // 垂直
            //    }
            //    if ( BY0 = BYE ) {
            //        水平垂直 = 0 // 水平
            //    }
            BTAN = 0
            if ( BX0 != BXE ) {
                BTAN = (BYE - BY0) / (BXE - BX0)
            }
            B角度 = 180 * Atn(BTAN) / π
            if ( BX0 > BXE ) {
                B角度 = B角度 + 180
            }
            if ( BX0 = BXE ) {
                B角度 = 90
            }
            if ( BYE < BY0 ) {
                B角度 = 270
            }
            //
            Flg3 = 0
            Select Case 荷重方向 ////////////////////07/01/08
            Case "V", "M", "S"
                    PX0 = HEN_X(wXs) - 荷重図開き * BSN
                    PY0 = min(HEN_Y(wYs), HEN_Y(wYe)) - 荷重図開き * Abs(BCS) ////////////07/01/09
            Case "H"
                if ( (節X0(節点S) + 節X0(節点E)) / 2 < (JX_max + JX_min) / 2 ) { ////////////07/01/08
                    if ( 連続荷重_P1(1) + 連続荷重_P2(1) > 0 $$ s斜めFLG = 0 ) { ////////09/10/24
                        PX0 = min(HEN_X(wXs), HEN_X(wXe)) - 荷重図開き * BSN * 1 ////////09/10/24
                    } else {
                        if ( s斜めFLG = 0 ) {
                            PX0 = min(HEN_X(wXs), HEN_X(wXe)) - 荷重図開き * BSN * 13 ////////09/08/24
                        } else {
                            PX0 = min(HEN_X(wXs), HEN_X(wXe)) - Abs(荷重図開き * BSN) * 10 ////////09/08/24
                            Flg3 = 1
                        }
                    }
                    PY0 = HEN_Y(wYs) - 荷重図開き * BCS
                } else {
                    if ( 連続荷重_P1(1) + 連続荷重_P2(1) > 0 $$ s斜めFLG = 0 ) { ////////09/10/24
                        PX0 = min(HEN_X(wXs), HEN_X(wXe)) // + 荷重図開き * BSN * 0.3
                    } else {
                        PX0 = max(HEN_X(wXs), HEN_X(wXe)) - 荷重図開き * BSN * IIf(s斜めFLG = 0, 0, 10) ////////09/10/24
                        if ( s斜めFLG != 0 ) {
                            Flg3 = 1 ////////////07/07/26//////////////////////////////09/10/24 コメントにした
                        }
                    }
                    PY0 = HEN_Y(wYs) - 荷重図開き * BCS
                }
            Case } else {
                PX0 = HEN_X(wXs) + 荷重図開き * BSN //////13/04/08
                if ( yiKozo = 1 $$ 水平垂直 = 0 $$ N段数 = 1 $$ 連続荷重数 = 1 $$ _
                   Abs(YY_max - wYs) > (YY_max - YY_min) / 5 ) { //////////////////////////////////07/06/177
                    PY0 = HEN_Y(wYs) + 荷重図開き * BCS
                } else {
                    if ( 連続荷重数 = 1 $$ Mark111 = 11 $$ _
                                Abs(YY_max - wYs) <= (YY_max - YY_min) / 10 ) { //////08/06/16
                        PY0 = HEN_Y(wYs) + 荷重図開き * BCS
                    } else {
                        PY0 = HEN_Y(wYs) + 荷重図開き * BCS //////13/04/08
                    }
                }
            //        PX0 = (HEN_X(wXs) + HEN_X(wXe)) / 2 - 荷重図開き * BSN //////////////////07/01/077
            //        PY0 = (HEN_Y(wYs) + HEN_Y(wYe)) / 2 - 荷重図開き * BCS
            End Select
            //
            //////////////////////////////////////////06/01/29
            UUUU = 0: PPPP = 0
            For( i = 1 To 連続荷重数
                if ( 連続荷重mark(i) = 2 $$ 連続荷重_P1(i) = 連続荷重_P2(i) ) {
                    PPPP = max(PPPP, Abs(連続荷重_P1(i)))
                } else {
                    UUUU = 1
            //            Exit For////////09/04/02
                }
            }
            //////////////////////////////////////////06/01/29
            XL(1) = 0
            NN = 1
            集中有無 = 0
            HV = 0
            HV5 = 0
            N55 = 1
            j = 0
            //
            For( i = 1 To 連続荷重数
                if ( 連続荷重_L1(i) - XL(NN) > 0.001 ) {
                    NN = NN + 1
                    XL(NN) = 連続荷重_L1(i)
                }
                if ( s斜めFLG = 2 ) { ////////09/10/24
                    連続荷重_P1(i) = Abs(連続荷重_P1(i))
                    連続荷重_P2(i) = Abs(連続荷重_P2(i))
                }
                Select Case 連続荷重mark(i)
                Case 1, 5, 11
            //            if ( 連続荷重_P2(I) != 0 ) {
                        if ( Not (連続荷重_P2(i) = 0 $$ 連続荷重_L2(i) = 0) ) { ////////if ( 連続荷重_P2(I) != 0  07/06/11
                        if ( 連続荷重_L2(i) != XL(NN) ) { //////////10/01/03
                            XL2 = Round(連続荷重_L2(i), 3)
                            NN = NN + 1
                            XL(NN) = XL2
                        }
                        }
                        if ( 連続荷重mark(i) != 5 ) {
                            集中有無 = 1
                        }
                Case 2, 4, 6, 7
                        if ( 連続荷重_L2(i) != 0 ) {
                            XL2 = Round(BSPAN - 連続荷重_L2(i), 3)
                            NN = NN + 1
                            XL(NN) = XL2
                        }
                        if ( 連続荷重_P1(i) != 連続荷重_P2(i) $$ 連続荷重_P1(i) != 0 $$ 連続荷重_P2(i) != 0 ) {
                            HV = 1
                            HV5 = 1
                        }
                Case 3
                    XL2 = Round(連続荷重_L1(i) + (BSPAN - 連続荷重_L1(i) - 連続荷重_L2(i)) / 2, 3)
                    NN = NN + 1
                    XL(NN) = XL2
                    if ( 連続荷重_L2(i) != 0 ) {
                        XL2 = Round(BSPAN - 連続荷重_L2(i), 3)
                        NN = NN + 1
                        XL(NN) = XL2
                    }
                Case } else {
                    if ( 連続荷重_L2(i) != 0 ) {
                        XL2 = Round(BSPAN - 連続荷重_L2(i), 3)
                        NN = NN + 1
                        XL(NN) = XL2
                    }
                End Select
            }

            if ( 連続荷重数 = 1 $$ 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) + 連続荷重_P2(1) = 0 $$ _
                                                          連続荷重_L1(1) + 連続荷重_L2(1) = 0 ) {
                NN = NN + 1
                XL(NN) = BSPAN / 2 ////////12/11/27 逆対称の分布荷重

            } else {if ( XL2 != BSPAN ) { //////12/12/15
            //        j = 0
            //        if ( 水平垂直 = 1 || 連続荷重mark(1) = 1 || 連続荷重mark(1) = 5 || 連続荷重mark(1) = 11 ) { j = 1
            //        if ( (水平部材最下端 = (wYs + wYe) / 2 || YY_max = (wYs + wYe) / 2) ) {
            //            if ( XL(NN) < BSPAN ) { j = 1
            //        }
                if ( XL(NN) < BSPAN ) {
                    NN = NN + 1
                    XL(NN) = BSPAN //////12/12/15
                }
            }
                    //////////////////////////////08/07/06
            N55 = 1
            j = 0
            For( i = 1 To 連続荷重数
                if ( 連続荷重_L1(i) - XL(N55) > 0.001 ) {
                    N55 = N55 + 1
                }
                Select Case 連続荷重mark(i)
                Case 1, 5, 11
                    if ( Not (連続荷重_P2(i) = 0 $$ 連続荷重_L2(i) = 0) ) {
                        N55 = N55 + 1
                    }
                    if ( 連続荷重mark(i) != 5 ) {
                        j = 1
                    }
                Case 2, 6, 7
                    if ( 連続荷重_L2(i) != 0 ) {
                        N55 = N55 + 1
                    }
                    if ( i = 連続荷重数 ) {
                        AALL = (XL(N55) - XL(N55 - 1))
                    } else {
                        AALL = (XL(N55 + 1) - XL(N55))
                    }
                    if ( 連続荷重mark(i) = 2 $$ (連続荷重_P1(i) != 連続荷重_P2(i)) ) {
                        if ( (yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) ) {
            //                    j = 2 //////08/10/29
                        }
                    }
                Case 3
                    N55 = N55 + 1
                    if ( 連続荷重_L2(i) != 0 ) {
                        N55 = N55 + 1
                    }
                    if ( (max(Abs(連続荷重_P1(i)), Abs(連続荷重_P2(i))) / Max荷重) < 0.2 ) { //////09/11/09
                        j = 3
                    }
                Case 4
                    N55 = N55 + 1
                    if ( (max(Abs(連続荷重_P1(i)), Abs(連続荷重_P2(i))) / Max荷重) < 0.2 ) { //////09/11/09
                        j = 4
                    }
                Case } else {
                    if ( 連続荷重_L2(i) != 0 ) {
                        N55 = N55 + 1
                    }
                End Select
            }
            if ( 集中有無 != 1 $$ J7 = 0 ) {
                GHOSEI = 1.5 + 1
                if ( j = 2 ) {
                    GHOSEI = 9.5 * (P6 / Max荷重)
                }
            }
            //////////////////////////////08/07/06
            //
            var gY55 As Single, GOUKEI As Single, J55 As Single, J88 As Single
            if ( (Mark111 = 2 || Mark111 = 3 || Mark111 = 4) ) {
                if ( ((P7 / Max荷重) ^ 1.2) < 0.3 ) {
                    P7 = Round(0.35 * Max荷重, 1)
                    P6 = P7 //////09/11/13
                    if ( ((P7 / Max荷重) ^ 1.2) < 0.2 ) {
                        P7 = Round(0.2 * Max荷重, 1)
                        P6 = P7 //////09/11/13
                    } else {if ( ((P7 / Max荷重) ^ 1.2) < 0.15 ) {
                        P7 = Round(0.12 * Max荷重, 1)
                        P6 = P7 //////09/11/13
                    }
                    GHOSEI = 0
                    hosei = 0
                } else {if ( (P7 / Max荷重) > 0.8 ) {
                    P7 = Max荷重
            //            gHosei = 0
            //            hosei = 0
                    J6 = -0.5
                }
            }

            gY55 = 0
            if ( FLG_列車_衝撃 ) {
                if ( N段数 = 1 ) {
                    gY55 = -51
                } else {
                    gY55 = -120
                }
                if ( 荷重方向 = "M" ) { //////12/12/17
                    gY55 = -80
                }
            } else {if ( J5 = 0 $$ J10 = 連続荷重数 ) {
                gY55 = 150 * (P7 / Max荷重)
                if ( P7 < 100 $$ Not (yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) ) {
                gY55 = gY55 - 100
                }
            } else {if ( J5 = 0 $$ J7 = 1 $$ J9 = 1 ) {
                if ( (P7 / Max荷重) > 0.6 ) {
                    J7 = 1
                    if ( (P7 / Max荷重) > 0.9 ) { J7 = 0
                } else {
                    J6 = 1
                }
            }
            if ( J5 != 0 ) {
                J55 = J5
                if ( SS1 = SE2 ) {
                    if ( N段数 > 1 ) {
                        if ( (P7 / BP荷重MAX) > 0.9 ) {
                            if ( P7 >= 100 ) {
                                J55 = 1
                            } else {if ( P7 < 33 ) {
                                J55 = 0.5
                            }
                        } else {
                            J55 = 1.5
                        }
                    } else {
                        if ( P7 >= 100 ) { J55 = 1
                    }
                } else {
                    if ( Len(鉛直文字列) >= 9 ) {
                        if ( P7 >= 100000 ) {
                            J55 = 0.1
                            GHOSEI = GHOSEI - 2
                        } else {
                            J55 = 1.2
                        }
                    } else {if ( Len(鉛直文字列) = 8 ) {
                        if ( P7 >= 10000 ) {
                            J55 = 0.1
                            GHOSEI = GHOSEI - 2
                        } else {
                            J55 = 1.2
                        }
                    } else {if ( Len(鉛直文字列) = 7 ) {
                        if ( P7 >= 1000 ) {
                            J55 = 0.4
                        } else {
                            J55 = 1.3
                        }
                    } else {if ( Len(鉛直文字列) = 6 ) {
                        if ( P7 >= 100 ) {
                            if ( N段数 = 1 ) {
                                J55 = 0.1
                            } else {
                                if ( (P7 / Max荷重) > 0.99 ) {
                                    J55 = 0.5
                                } else {
                                    J55 = -0.3
                                }
                            }
                        } else {
                            J55 = 0.7
                        }
                    } else {if ( Len(鉛直文字列) >= 5 ) {
                        J55 = 0
                    }
                }
                if ( (GHOSEI = 0.5 || GHOSEI = 2.5) $$ Abs(YY_max - wYs) > (YY_max - YY_min) / 5 ) { ////////08/11/27
                    J55 = J5
                }
                GOUKEI = (J7 * 60 + J88 * 160 - J55 * 120 - J6 * 80 + GHOSEI * 20) // - gY55
                if ( Mark111 = 5 ) { ////////09/11/17
                    GOUKEI = 50
                }
                GoTo YNEXT
            }
            if ( g荷重表記縦 = 0 $$ g荷重表記高 != 0 ) { ////////08/10/29
                if ( Mark111 = 4 $$ g荷重表記縦 = 0 ) { //////09/11/202
                    g荷重表記高 = 220
                    GOUKEI = 150
                } else {
                    if ( g荷重表記高 < 100 ) { // g荷重表記高 = 100
            //            GOUKEI = 260 - 100 - gY55 + 60  //////06/10/29
                        GOUKEI = 260 - g荷重表記高 - gY55 + 60 //////////////09/03/10
                    } else {
                        GOUKEI = 260 - g荷重表記高 - gY55 + 60
                        if ( (P7 / Max荷重) > 0.9 ) { //////09/11/12
                            if ( g荷重表記高 < 260 ) {
                                if ( g荷重表記高 = 180 $$ gY55 = 0 $$ N段数 = 1 ) { ////////10/01/03
                                    GOUKEI = 260 ////////10/02/03//////720 ////////10/01/03
                                } else {
                                    GOUKEI = 260 ////////10/01/03
                                }
                            } else {
            //                        GOUKEI = 260 ////////10/01/03 13/04/07
                                g荷重表記高 = 220 ////////13/04/08
                                GOUKEI = 200
                            }
                        } else {
                            if ( g荷重表記高 > 140 $$ GOUKEI < 220 ) { ////////09//11/199
                                GOUKEI = 220
                            } else {
                                GOUKEI = 280 + GOUKEI
                                if ( ((P7 / Max荷重) ^ 1.3) < 0.3 ) { //////09/11/13
                                    GOUKEI = 260
                                }
                            }
                        }
                    }
                }
            } else {
                if ( g荷重表記縦 = 0 $$ (P7 / Max荷重) < 0.3 $$ N段数 != 1 $$ gY55 = 0 ) {  //////08/10/29
                    if ( (J7 = 1 $$ J9 = 1) $$ J8 = 0 ) {
                        if ( (P7 / Max荷重) < 0.2 ) {
                            GOUKEI = -20
                        } else {
                            GOUKEI = 0
                        }
                    } else {if ( J7 = 1 $$ J8 = 0 ) {
                        GOUKEI = 120 * (1 - (P7 / Max荷重) ^ 1.5)
                    } else {
                        GOUKEI = 300 * (1 - (P7 / Max荷重) ^ 0.7)
                    }
                } else {
                    J55 = J5
                    J88 = J8
                    if ( J5 + J6 + J7 + J8 + gY55 = 0 ) {
                        if ( (P7 / Max荷重) < 0.6 ) {
                            J88 = Round((P7 / Max荷重), 1)
                            if ( (P7 / Max荷重) < 0.1 ) {
                                J88 = 1.5
                            }
                        }
                            if ( Mark111 = 4 $$ g荷重表記縦 = 1 $$ hosei > 0 ) {
                                J55 = 1.5 //+ (g荷重表記高 / 300)
                            }
                    } else {if ( g荷重表記縦 = 1 || (P7 / Max荷重) > 0.85 ) {
                        if ( (yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) ) {
                            if ( (P7 / Max荷重) < 0.5 $$ P7 >= 10 ) {
                            J55 = Round(5 * (P7 / Max荷重) ^ 0.5, 1)
                            } else {
                            J55 = Round(3 * (P7 / Max荷重) ^ 0.5, 1) ////////09/11/199
            //                    if ( 下床文字表示 = 0 $$ 連続荷重_P1(1) * 連続荷重_P2(1) < 0 $$ g荷重表記高 > 260 ) {
            ////                        J55 = J55 - Round(g荷重表記高 / 20, 1) //////09/12/04
            //                    }
                            }
            //                    J6 = 0 //-0.5
                            if ( J6 = 0 ) {
                                J6 = -0.5
                                J7 = 0
                            } else {if ( J6 > 0 ) { //////08/11/05
                                J6 = 2
                            } else {
                                if ( (P7 / Max荷重) > 0.95 ) { ////////////////////08/11/09////08/12/06
                                    J6 = J6 + 2.5 ////////08/11/09
                                } else {
                                    J6 = J6 + 2 ////////08/11/13
                                }
                            }
                        } else {
            //                    J55 = Round(2 * (P7 / Max荷重), 1)
                            J55 = Round(5.5 * (P7 / Max荷重) ^ 0.5, 1) ////////////08/12/07 //////09/04/06
                            if ( g荷重表記縦 = 1 $$ J55 < 4 ) { ////////09/11/11
                                J55 = J55 + 1.5
                            }
                            if ( (P7 / Max荷重) > 0.9 ) { //////09/04/06
                                if ( J6 < 0 ) { J6 = J6 / 2
                            } else {
                                if ( J6 < 0 ) { J6 = 2.5 ////////////J6 = 0//////////////////08/11/17
                                if ( (P7 / Max荷重) < 0.2 ) { J55 = J55 + 0.8 //////09/04/06
                            }
                            J7 = 0
                        }
                    } else {if ( (P7 / Max荷重) > 0.8 ) {
                        J6 = J6 + 2
                    } else {if ( (P7 / Max荷重) < 0.15 $$ J8 = 0 ) {
                        if ( J6 = 1 ) {
                            J6 = 0
                            J88 = 1.8
                        } else {
                            J7 = 2
                        }
                    }
                    GOUKEI = (J7 * 60 + J88 * 160 - J55 * 120 - J6 * 80 - gY55)
                    if ( g荷重表記縦 = 1 $$ g荷重表記高 < 120 $$ GOUKEI < -560 ) { ////09/12/25////09/11/199
                        GOUKEI = -560 ////////09/12/25//////-450
                    }
                }
            } ////////08/10/29
            YNEXT:
            if ( 水平垂直 = 0 $$ (Mark111 = 2 || Mark111 = 3 || Mark111 = 4) ) { ////////09/11/11
                if ( 荷重図開き < 0 ) {
                    GOUKEI = GOUKEI - 180 //09/11/16
                } else {if ( (g荷重表記縦 = 1 $$ GOUKEI * 1.3 > -400 $$ GOUKEI < 0) ) { ////////09/11/11
                    GOUKEI = GOUKEI * 1.3
                } else {if ( (g荷重表記縦 = 1 $$ GOUKEI < -630 $$ GOUKEI < 0) ) { ////////09/11/11 $$ GOUKEI < -650 ////10/01/14
                    GOUKEI = -600
                }
                if ( 下床文字表示 = 0 $$ 連続荷重_P1(1) * 連続荷重_P2(1) < 0 $$ g荷重表記高 > 250 ) { //////09/12/04
                    GOUKEI = -650 - Round(g荷重表記高 / 2, 1) //////09/12/04
                }
            } else {if ( 水平垂直 = 0 $$ GOUKEI < -500 $$ (Mark111 = 5 || Mark111 = 11) ) {
                GOUKEI = -180 ////////09/11/11
            }
            GOUKEI = Round(GOUKEI, 0) ////////08/10/29//////08/11/27
            ////////09/02/20
            var yyF5 As Single, yyF6 As Single //////09/08/05
            yyF5 = 0
            if ( Not (水平垂直 = 1 $$ Mark111 = 1) ) { ////////////14/11/16
                if ( (水平垂直 = 1 $$ (連続荷重_P1(1) < 0)) ) { ////////09/08/03
                    if ( Mark111 = 1 ) {
                        if ( Len(Format(P7, "0.00")) > 6 ) {
                            yyF5 = 450
                        } else {
                            yyF5 = 350
                        }
                    } else {
                        if ( g荷重表記縦 = 0 $$ N段数 = 1 $$ 連続荷重_P1(1) = 連続荷重_P2(1) ) {
                            if ( FLG杭杭 || yiKozo != 3 ) { ////////09/08/03 09/08/05
                                yyF5 = -70
                            } else {
                                yyF5 = -130
                            }
                        }
                    }
                }
            } else {if ( (水平垂直 = 1 $$ Mark111 = 1) ) {
                    if ( 連続荷重_P1(1) > 0 ) {
                        寸法線位置 = -10 ////////14/11/16
                        寸法補助線 = 3
                        yyF5 = -100
                        f寸法FLG = -1
                    } else {
                        寸法線位置 = 2.5 ////////14/11/16
                        寸法補助線 = 3
                        yyF5 = 0
                        f寸法FLG = 1
                    }
                    For( i = 1 To NN
                        寸法(i) = F2(XL(i + 1) - XL(i))
                        XL(i) = 図倍率 * XL(i)
                        X(i) = PX0 + XL(i) * BCS + yyF5
                        Y(i) = PY0 - XL(i) * BSN + GOUKEI * BCS
                    }
                    this.SunPou2("<", NN, 寸法線位置, 寸法補助線, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, , 荷重図開き)
                    寸法線位置 = -5.5: 寸法補助線 = -2
                    GoTo Next_GRF ////////09/11/12
            } //////09/09/25
            For( i = 1 To NN
                寸法(i) = F2(XL(i + 1) - XL(i))
                XL(i) = 図倍率 * XL(i)
                X(i) = PX0 + XL(i) * BCS // + yyF5 //////09/02/20////////13/04/08
                Y(i) = PY0 - XL(i) * BSN ////////13/04/08
                //
            //        if ( 荷重方向 = "V" || 荷重方向 = "M" || 荷重方向 = "S" ) {
            //            Y(i) = PY0 - XL(i) * BSN // + GOUKEI * Abs(BCS)//////13/04/08
            //        } else {
            //            Y(i) = PY0 - XL(i) * BSN // + GOUKEI * BCS//////13/04/08
            //        }
            }
            if ( X(1) = X(連続荷重数) ) {
                HV = 0
            }
            //////////
            obj.FontSize = 荷重寸法Fontsize
            obj.PenWidth = 部材荷重寸法Pen幅
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(obj.PenWidth))
            }
            obj.PenColor = QBColor(部材荷重寸法Pen色)
            Select Case Mark111
            Case 1, 2, 3, 4, 5, 6, 7, 11
                //寸法線位置  寸法補助線 mm
                if ( Mark111 = 1 || Mark111 = 11 || Mark111 = 5 ) {
                    寸法線位置 = -(荷重寸法線位置(1) + GHOSEI) * Sgn(荷重図開き)
                    if ( (yiKozo = 1 || yiKozo = 3) $$ 水平垂直 = 0 $$ N段数 = 1 $$ 連続荷重数 = 1 $$ _
                       Abs(YY_max - wYs) > (YY_max - YY_min) / 5 ) { //////////////////////////////////07/06/177//////////////////////////12/12/15
                        寸法線位置 = 3.001
                    }
            //////09/11/09
                    if ( 水平垂直 = 1 $$ Mark111 = 5 ) { //////Not (節X(節点S) = g柱X座標(g柱本数, 1) || 節X(節点S) = g柱X座標(1, 1)) ) {
                        if ( 節X0(節点S) < (JX_max + JX_min) / 2 ) {
                            寸法線位置 = -7
                            寸法補助線 = 寸法線位置 + 1
                            yyF5 = -150
                            f寸法FLG = -1
                        } else {
                            寸法線位置 = 3
                            寸法補助線 = 寸法線位置 - 1
                            yyF5 = 50
                            f寸法FLG = 1
                        }
                        For( i = 1 To NN
                            X(i) = PX0 + XL(i) * BCS + yyF5
                        }
                        GoTo GRF
                    }
            //////09/11/09
                } else {
                    if ( FLG杭杭 || (yiKozo != 2 $$ 水平垂直 = 1) ) { //////////////09/01/28////Or (yiKozo != 3 $$ 水平垂直 = 1)////07/06/11
                        if ( 荷重図開き > 0 ) {
                        寸法線位置 = -(荷重寸法線位置(2) + GHOSEI - 7 - 6 + 1) * Sgn(荷重図開き) ////////08/08/15
                        } else {
                        寸法線位置 = -(荷重寸法線位置(2) + GHOSEI - 9 - 6 + 1) * Sgn(荷重図開き) ////////08/08/15
                        }
                        if ( 水平垂直 = 1 ) { //////10/01/18////////And InStr(部材名(SS部材), "杭") = 0 ) { ////////09/11/199
                            if ( (FLG杭杭 = False $$ yiKozo = 3) || 連続荷重_P1(1) != 連続荷重_P2(1) ) { ////////09/05/03 09/08/05
                                寸法線位置 = 寸法線位置 + IIf(P7 >= 1000, -16, -14) * Sgn(荷重図開き)
                            }
            //                        yyF6 = 1 * Sgn(連続荷重_P1(1))  //////09/08/05
                                yyF6 = Sgn(荷重図開き) //////09/11/06
                                if ( yyF6 = 1 ) {
                                    if ( FLG杭杭 ) { ////////09/11/07
                                        if ( N段数 > 1 ) { ////7g荷重表記高 > 300
                                            寸法線位置 = -7 - 14 * Sgn(荷重図開き)
                                        } else {
                                            寸法線位置 = -7 //寸法線位置 - (5 + 1.5 * (P7 / Max荷重)) * Sgn(荷重図開き)
                                            寸法補助線 = 寸法線位置 + 1
                                            GoTo GRF
                                        }
                                    } else {
                                        if ( FLG杭杭 = False $$ 節X(節点S) = g柱X座標(g柱本数, 1) ) { //////09/11/09//////And g荷重表記縦 = 1 ) { //////09/11/06
                                        //////右側土圧
                                            if ( g荷重表記縦 = 1 ) { //////09/11/09
                                            //////////////////////////////////////////////////////////////////////09/12/25
                                            寸法線位置 = (3 + 2 * (P7 / Max荷重) * 2) + max(Len(Format(P7, "0.00")), 6) * (荷重文字サイズ * Twip / 160)
                                            } else {
                                            寸法線位置 = (5 + 2 * (P7 / Max荷重)) + 荷重文字サイズ / 2 //////09/11/09
                                            }
                                            寸法補助線 = 寸法線位置 - 1
                                            GoTo GRF
                                        } else {
                                            if ( (yiKozo = 2 $$ FLG杭杭 = False) || g荷重表記高 > 300 ) { ////////09/08/07
                                            寸法線位置 = 寸法線位置 - (16 + 1.5 * (P7 / Max荷重)) * Sgn(荷重図開き)
                                            } else {
                                            寸法線位置 = 寸法線位置 - (5 + 1.5 * (P7 / Max荷重)) * Sgn(荷重図開き) //////////07/06/11 09/08/05
                                            }
                                        }
                                    }
                                } else {
                                    if ( FLG杭杭 ) {
                                        if ( N段数 > 1 ) { ////////g荷重表記高 > 300 ) {
                                            if ( yiKozo = 2 ) {
                                                寸法線位置 = (16.5 + 1.5 * (P7 / Max荷重))
                                                寸法補助線 = 4 ////寸法線位置 - 1
                                            } else {
                                                寸法線位置 = (16.5 + 1.5 * (P7 / Max荷重))
                                                寸法補助線 = 4 ////寸法線位置 - 1
                                            }
                                            GoTo GRF
                                        } else {
                                            if ( Sgn(荷重図開き) < 0 $$ 連続荷重mark(1) = 2 ) { ////////11/12/15
                                                寸法線位置 = (5 - 10 * Sgn(荷重図開き)) / 2
                                                寸法補助線 = 寸法線位置 - 1
                                            } else {
                                                寸法線位置 = 寸法線位置 - 10 * Sgn(荷重図開き) ////////09/11/088
                                                寸法補助線 = 寸法線位置 - 1
                                            }
                                            GoTo GRF
                                        }
                                    } else {
                                        if ( FLG杭杭 = False $$ 節X(節点S) = g柱X座標(1, 1) ) { //////09/11/09//////And g荷重表記縦 = 1 ) { //////09/11/06
                                        //////左側土圧
                                            if ( g荷重表記縦 = 1 ) { //////09/11/09
                                            //////////////////////////////////////////////////////////////////////////09/12/25
                                            寸法線位置 = -(3 + 2 * (P7 / Max荷重) * 2) - max(Len(Format(P7, "0.00")), 5.5) * (荷重文字サイズ * Twip / 160)
                                            } else {
                                            寸法線位置 = -(3 + 4 * (P7 / Max荷重)) - 荷重文字サイズ / 4 //////09/11/09
                                            }
                                            寸法補助線 = 寸法線位置 + 1
                                            GoTo GRF
                                        } else {
                                            if ( (yiKozo = 2 $$ FLG杭杭 = False) || g荷重表記高 > 300 ) {
                                                寸法線位置 = 寸法線位置 - (12 + 1.5 * (P7 / Max荷重)) * Sgn(荷重図開き)
                                            } else {
                                                if ( Not (iKozo = 3 $$ FLG杭杭 = False $$ Mark111 = 2 $$ 水平垂直 = 1 $$ 寸法線位置 > 0 $$ 荷重図開き < 0) ) {
                                                寸法線位置 = 寸法線位置 - (12 + 1.5 * (P7 / Max荷重)) * Sgn(荷重図開き)
                                                }
                                                寸法補助線 = 寸法線位置 - 5
                                                GoTo GRF
                                            }
                                        }
                                    }
                                }
                        }
                    } else {
                        if ( 水平垂直 = 0 $$ yFR橋脚 = 2 ) {
                            寸法線位置 = -(荷重寸法線位置(2) + GHOSEI + 4) * Sgn(荷重図開き) ////////////////06/02/12
                        } else {
                            ////////////////////////////////////////////////////////////////////////////////////////////////////////10/02/03
                            寸法線位置 = -(荷重寸法線位置(2) + GHOSEI + 2 + IIf(連続荷重_P1(1) * 連続荷重_P2(1) < 0, 4, 0)) * Sgn(荷重図開き)
                            if ( 荷重図開き < 0 $$ (YY_max = wYs || YY_max = wYe) ) { //////13/01/30
                                寸法線位置 = -(寸法線位置)
                                寸法補助線 = -3.5
                                GoTo GRF8
                            }
                            if ( 荷重図開き > 0 $$ (YY_min = wYs || YY_min = wYe) ) { //////13/01/30
            //                        寸法線位置 = -9
                                寸法補助線 = -3.5
                                GoTo GRF8
                            }
                            if ( J4 = 連続荷重数 ) { ////////08/07/08
                                寸法線位置 = 寸法線位置 * 0.9
                            }
                        }
                        if ( 水平垂直 = 1 $$ yFR橋脚 != 2 ) {
                            if ( g荷重表記縦 = 0 ) { //09/04/17
                                if ( 連続荷重_P1(1) > 0 ) {
                                    寸法線位置 = 寸法線位置 + 4.5 * Sgn(荷重図開き)
                                }
                            } else {
                                if ( yiKozo = 3 ) { //カルバートボックス 05/05/12//////////09/11/09
            //                            if ( ((wXe != JX_min $$ wXe != JX_max) || _
            //                               (wXe = JX_min $$ 荷重図開き > 0) || _
            //                               (wXe != JX_max $$ 荷重図開き < 0)) _
            //                                $$ N段数 = 1 $$ 連続荷重mark(1) = 2 ) { ////////09/08/14
            //                                //寸法線位置 = 6 * Sgn(荷重図開き)
            //                                f寸法FLG = Sgn(荷重図開き) ////////09/08/14
            //                            } else {
                                        寸法線位置 = 寸法線位置 - 2 * Sgn(荷重図開き) //////09/04/17
            //                            }
                                } else {
                                    寸法線位置 = 寸法線位置 - 7 * Sgn(荷重図開き)
                                }
                            }
                        }
                    }
                }
                if ( yFR橋脚 = 2 $$ HV = 1 $$ FLG杭杭 = False ) { ////////08/08/17
                    寸法線位置 = 寸法線位置 - 2
                } else {
                }
                if ( Mark111 = 3 || Mark111 = 4 ) {
                    if ( yFR橋脚 = 2 ) {
                        寸法線位置 = 寸法線位置 + 4 * Sgn(荷重図開き) //////09/11/16
                    } else {
                        寸法線位置 = 寸法線位置 + 5 * Sgn(荷重図開き) //////09/11/16
                    }
                }
                if ( X(1) = X(2) ) { //////Or (水平垂直 = 9 $$ 荷重方向 = "H") ) { // 鉛直部材の場合//////09/08/23
                    if ( yFR橋脚 = 1 || FLG杭杭 || (yiKozo != 3 $$ 水平垂直 = 1) ) { //////08/08/17 09/08/05
                        if ( 荷重図開き > 0 ) {
                            if ( 集中有無 = 1 ) {
                                寸法線位置 = 寸法線位置 - 4 * Sgn(寸法線位置)
                            } else {
                                寸法線位置 = 寸法線位置 - 4 * Sgn(寸法線位置)
                            }
                        } else {
                            if ( 集中有無 = 1 ) {
                                寸法線位置 = 寸法線位置 - 6 * Sgn(寸法線位置)
                            } else {
                                寸法線位置 = 寸法線位置 - 6 * Sgn(寸法線位置)
                            }
                        }
                        if ( Mark111 = 2 ) {
                            if ( 集中有無 = 0 $$ 荷重図開き < 0 ) {
                                寸法線位置 = 寸法線位置 + 2 * Sgn(寸法線位置)
                            }
                        } else {
                            if ( 集中有無 = 0 $$ 荷重図開き < 0 ) {
                                寸法線位置 = 寸法線位置 - 1 * Sgn(寸法線位置)
                            }
                        }
                    }
                }
                if ( FLG杭杭 $$ g荷重表記縦 = 1 ) { ////////09/11/199
                    if ( 荷重図開き > 0 ) {
                        寸法線位置 = -5.5
                        寸法補助線 = -荷重寸法線位置(1) / 5
                    } else {
                        寸法線位置 = 7.5
                        寸法補助線 = 荷重寸法線位置(1) / 5
                    }
                    GoTo GRF ////////09/11/199
                }
                寸法補助線 = -荷重寸法補助線 * Sgn(荷重図開き)
                if ( yFR橋脚 = 1 $$ 水平垂直 = 1 $$ Mark111 = 1 ) { //02/04/18
                    寸法線位置 = 荷重寸法線位置(1) / 2.5 //0 //寸法線位置 - 1 * Sgn(寸法線位置)
                    寸法補助線 = 荷重寸法線位置(1) / 5 //-荷重寸法補助線 * Sgn(荷重図開き)
                }
                if ( 水平垂直 = 1 $$ Mark111 = 5 ) {
                    寸法線位置 = 寸法線位置 - 4 * Sgn(寸法線位置)
                } else {
                    if ( 水平垂直 = 0 $$ Mark111 = 2 $$ 階段Mod = False ) { //////17/08/15////And gHosei != 0 ) { //And 荷重_P1 = 荷重_P2 ) {
                    if ( UUUU = 0 ) {
                        if ( (PPPP / Max荷重) < 0.2 ) { //And hosei >= 0 ) {
                        寸法線位置 = 寸法線位置 - 8.5 * Sgn(寸法線位置) * IIf(FR橋脚 = 1, Sgn(荷重図開き), 1) //////10/05/12
                        } else {
                        寸法線位置 = 寸法線位置 - 6 * Sgn(寸法線位置) * IIf(FR橋脚 = 1, Sgn(荷重図開き), 1) //////10/05/12
                        }
                    } else {
                        if ( hosei < 0 ) {
                            寸法線位置 = 寸法線位置 - 5.5 * Sgn(寸法線位置) * IIf(FR橋脚 = 1, Sgn(荷重図開き), 1) //////10/05/12
                        } else {
                            if ( hosei = 0 ) {
                            寸法線位置 = 寸法線位置 - 5 * Sgn(寸法線位置) * IIf(FR橋脚 = 1, Sgn(荷重図開き), 1) //////10/05/12
                            } else {
                            寸法線位置 = 寸法線位置 - 6 * Sgn(寸法線位置) * IIf(FR橋脚 = 1, Sgn(荷重図開き), 1) //////10/05/12
                            }
                        }
                    }
                    }
                }
                if ( 寸法線位置 = 3.001 ) { //////////////////07/06/177
                    寸法補助線 = 寸法線位置 + 1
                }
                if ( Flg3 = 1 ) { //////////////////////////////07/07/26
                    寸法補助線 = -寸法線位置
                }
                if ( g荷重表記縦 = 0 $$ g荷重表記高 != 0 ) { ////////08/10/29
                    if ( 水平垂直 != 1 $$ 階段Mod = False ) { //////09/04/17////////////////////////17/08/15
                        寸法線位置 = -Round((GOUKEI / 30) + (g荷重表記高 / 30), 2) _
                                     + IIf(yyF6 = 1, 1 - Round(1 * (P7 / Max荷重), 2), 0)
                        if ( g荷重表記高 < 145 $$ gY55 != -51 ) { //////10/02/07
                            if ( Abs(寸法線位置) > 16 ) {
                                寸法線位置 = 寸法線位置 + 3 //////10/02/07
                            }
                        }
                        if ( gY55 = -51 || gY55 = -80 || gY55 = -120 ) { //////////////10/01/30 12/12/17 13/02/288
                            if ( Abs(寸法線位置) < 20 ) {
                            寸法線位置 = 寸法線位置 - 5
                            } else {
                            寸法線位置 = 寸法線位置
                            }
                            GoTo GRF8
                        } else {if ( yiKozo = 1 $$ (節Y0(節点S) + 節Y0(節点E)) / 2 < ((YY_max + 水平部材最下端) / 2 * 0.8) ) {
                            if ( Not (iKozo = 3 $$ (P7 / Max荷重) < 0.44) ) { //////13/02/30
                            寸法線位置 = 寸法線位置 - 3 //////10/02/07
                            }
                        }
                    }
                } else {
                    寸法線位置 = Round(寸法線位置 + 0.5 * Sgn(寸法線位置), 1)
                    if ( 水平垂直 = 1 $$ iKozo = 3 $$ 寸法線位置 < -16 ) { //////////////////////////////////Box 内水圧
                    寸法線位置 = 16 * Sgn(寸法線位置) ////寸法線位置 - 10 * Sgn(寸法線位置)
                    寸法補助線 = -4
                    }
                    if ( 水平垂直 = 1 $$ iKozo = 3 $$ 寸法線位置 > 17 ) {
                    寸法線位置 = 17 //寸法線位置 - 10 * Sgn(寸法線位置)
                    寸法補助線 = 4
                    }
                }
            GRF: //////////////////////09/11/06
                if ( 水平垂直 != 1 $$ 荷重図開き < 0 ) { //////09/11/16
                    寸法線位置 = Abs(寸法線位置) ////////////10/05/12寸法線位置 * Sgn(荷重図開き) //////09/11/16
                }
            //////08/11/06
            var M As Integer, Atta As Integer
                Atta = 0
                //////////09/11/09
                if ( 水平垂直 != 1 $$ (Mark111 = 1 || Mark111 = 5 || Mark111 = 6 || Mark111 = 11) $$ N段数 = 1 ) { ////////08/11/06
                    if ( 下層BUZAI(1, 1) != 0 ) {
                        For( M = 1 To 部材_max
                            if ( 下層BUZAI(M, 1) = 0 ) { Exit For
                            if ( 下層BUZAI(M, 2) >= 節点S $$ 下層BUZAI(M, 2) <= 節点E ) {
                                Atta = 1
                                Exit For
                            }
                            if ( 下層BUZAI(M, 3) >= 節点S $$ 下層BUZAI(M, 3) <= 節点E ) {
                                Atta = 1
                                Exit For
                            }
                        Next M
                    }
                    if ( Atta = 0 $$ yiKozo = 1 $$ Abs(YY_max - (wYe + wYs) / 2) > 1.6 ) {
                        Atta = 1
                        PY0 = min(HEN_Y(wYs), HEN_Y(wYe)) + 2 * Twip
                    }
                    if ( Atta = 0 $$ yiKozo = 1 $$ (水平部材最下端 = (wYs + wYe) / 2 $$ Mark111 = 6) ) { //////13/11/15
                        Atta = 1
                        PY0 = min(HEN_Y(wYs), HEN_Y(wYe)) + 2 * Twip
                    }
                }
            //////08/11/06
                if ( Atta = 1 ) {
                    if ( (水平部材最下端 = (wYs + wYe) / 2) $$ (yiKozo = 1 || yiKozo = 3) $$ 水平垂直 = 0 $$ N段数 = 1 ) {
                        For( i = 1 To NN //////////09/10/25
                            Y(i) = PY0 + (XL(i) * BSN - 0 * BCS) - 5 * Twip //////////////09/11/08
                        }
                        this.SunPou2("<", NN, 10, 4, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, , 荷重図開き) //////09/10/20 12/12/15
                        寸法線位置 = 10: 寸法補助線 = 4
                    } else {
                        For( i = 1 To NN //////////09/10/25
                            Y(i) = PY0 + (XL(i) * BSN - 95 * BCS) - 5 * Twip //////////////09/11/08
                        }
                        this.SunPou2("<", NN, 10, 4, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, , 荷重図開き) //////09/10/20 12/12/15
                        寸法線位置 = 10: 寸法補助線 = 4
                    }
                } else {
                    if ( Mark111 = 5 ) { ////////09/11/17
                        寸法線位置 = -10
                        寸法補助線 = -3
                    } else {if ( Mark111 = 1 $$ 水平垂直 != 1 ) { //////////10/01/19
                        if ( P7 < 1000 ) { //////  $$ 寸法線位置 > -12.1 ) {
                            if ( P7 / Max荷重 < 0.3 ) {
                                寸法線位置 = 寸法線位置 - 3.5 - 1 ////////////10/06/02
                            } else {
                                if ( ((P7 / Max荷重) > 0.8 $$ P7 < 30) || (P7 / Max荷重) >= 0.9 ) { ////////////10/06/02
                                    寸法線位置 = 寸法線位置 - 3.5
                                } else {
                                    寸法線位置 = 寸法線位置 - 2.5 * max((1 - P7 / Max荷重), 0.5)
                                }
                            }
                        } else {if ( P7 > 2000 $$ 寸法線位置 > -15.1 ) { //////////10/01/19
                            if ( P7 < 3000 ) { ////////////10/04/100
                                寸法線位置 = 寸法線位置 - 3 + (max((3100 - P7), 0) / 250)
                            }
                        } else {if ( 寸法線位置 = -15 ) {
                            寸法線位置 = -17
                        }
                        if ( 荷重文字サイズ > 9.5 $$ 寸法線位置 < -16 ) { //////12/09/25
                            寸法線位置 = 寸法線位置 - (荷重文字サイズ - 9.5) * 2
                        }
                    }
            if ( (Mark111 = 2 $$ 水平垂直 != 1 $$ (P7 / Max荷重) > 0.9 $$ 寸法線位置 < -8) ) {  //////10/10/14
                if ( g荷重表記縦 = 1 ) {
                    寸法線位置 = 寸法線位置 - 1 ////// 12/11/22
                } else {
                    if ( ((部材正荷重数(SS1) < 30 $$ N段数 != 1) || (部材正荷重数(SS1) < 20 $$ N段数 = 1)) $$ yyF6 = 0 ) { //////10/11/11
                        if ( (部材正荷重数(SS1) < 18 $$ N段数 = 1) ) {
                        寸法線位置 = 寸法線位置 - 0 - IIf((P7 / Max荷重) > 0.9, 5, 0) //////10/11/11 12/11/22
                        } else {
                        寸法線位置 = 寸法線位置 - IIf((P7 / Max荷重) > 0.95, 1, 4) //////12/12/15
                        }
                        m調整高 = 4 //////10/11/11
                    } else {
                        if ( N段数 = 1 ) { //////////12/08/21
                            if ( YY_max - max(wYs, wYe) > 1 $$ 部材正荷重数(SS1) < 24 ) { ////////12/12/12
                                寸法線位置 = 1
                                寸法補助線 = 4
                            }
                        } else {if ( 水平垂直 != 1 ) {
                            寸法線位置 = 寸法線位置 - IIf((P7 / Max荷重) > 0.95, 2, 0.5)
                        }
                    }
                }
            }
                    if ( Mark111 = 3 ) { //////////////////////10/10/21
                        if ( g荷重表記高 > 200 ) {
                            寸法線位置 = -12
                        } else {
                            寸法線位置 = -(10 + Round((g荷重表記高 * 2.8 / 100), 1))
                            if ( 寸法線位置 > -15 ) { 寸法線位置 = -15
                        }
                        g荷重表記高 = 0
                    }
                    if ( Mark111 = 2 $$ 連続荷重数 = 1 $$ g荷重表記縦 = 0 $$ 寸法線位置 < 0 $$ 寸法線位置 > -18 ) { //////11/11/18
                        if ( g荷重表記縦 = 0 ) {
                        } else {
                            寸法線位置 = 寸法線位置 - 3
                        }
                    }
                    //
                    if ( f寸法FLG = 0 ) { //////09/08/14
                        if ( Mark111 = 1 $$ 寸法線位置 < -16 ) {

                            寸法線位置 = -17
                            寸法補助線 = -3

            //                    寸法線位置 = -16
            //                    寸法補助線 = -3

                        }
                        if ( g荷重表記縦 = 0 $$ 連続荷重数 = 1 $$ 連続荷重mark(1) = 2 $$ 連続荷重_P1(1) + 連続荷重_P2(1) = 0 ) {
                            寸法線位置 = min(Abs(寸法線位置) + 9, 30) * Sgn(寸法線位置) ////////12/11/22
                        } else {if ( g荷重表記縦 = 0 $$ 連続荷重数 > 1 $$ 連続荷重mark(1) = 2 $$ 水平垂直 = 0 ) { //////12/12/12
                            if ( ((BXE - BX0) / 連続荷重数) < 220 ) { ////////////////12/12/12
                                寸法線位置 = 寸法線位置 - 3 //////12/12/16
                                寸法補助線 = -2.5
                            } else {if ( ((BXE - BX0) / 連続荷重数) < 350 ) {
                                寸法線位置 = 寸法線位置 - 1.5
                                寸法補助線 = -3
                            }
                        }
                         //////12/12/12
                        if ( NN = 2 $$ g荷重表記縦 = 0 $$ (Mark111 = 2 $$ 水平垂直 != 1 $$ (P7 / Max荷重) > 0.9 $$ 寸法線位置 < -15) ) {
                            寸法線位置 = IIf(階段Mod, IIf(N段数 = 1, -g荷重表記高 * 0.12, -54), -15) //////17/08/15
                        } else {if ( (P7 / Max荷重) < 0.44 $$ g荷重表記縦 = 0 $$ 水平垂直 != 1 $$ 寸法線位置 < -12 $$ ((BXE - BX0) / 連続荷重数) >= 350 ) {
                            寸法線位置 = IIf(階段Mod, IIf(N段数 = 1, -25, -54), -15) //////17/08/15   -13 - 2 ////713/01/30
                        } else {if ( yyF6 = 0 $$ 水平垂直 = 0 ) { //////12/12/15
                            if ( 寸法線位置 > 0 ) {
                                寸法線位置 = 寸法線位置 + 2
                                寸法補助線 = 4
                                if ( (連続荷重_P1(1) + 連続荷重_P2(1)) / 2 < 0 ) {
                                    寸法線位置 = 寸法線位置 + 2
                                }
                            }
                        }
                        if ( (水平部材最下端 = (wYs + wYe) / 2) $$ (yiKozo = 1 || yiKozo = 3) $$ _
                                                   水平垂直 = 0 $$ N段数 = 1 $$ 寸法線位置 < 0 ) { //////12/12/15
            //////コメントにした 13/02/27
            //                    寸法線位置 = 3
            //                    寸法補助線 = 4
            //                    if ( (連続荷重_P1(1) + 連続荷重_P2(1)) / 2 < 0 ) {
            //                        寸法線位置 = 5
            //                    }
                        } else {if ( Mark111 = 4 $$ (P7 / Max荷重) < 0.5 $$ 寸法線位置 < 0 $$ g荷重表記縦 = 0 ) { //////12/12/17
                            寸法線位置 = 寸法線位置 + 2
                        }

            GRF8: //////12/12/17
            //        if ( 連続荷重数 = 1 $$ NN = 2 $$ (YY_max = wYs $$ YY_max = wYe) ) { //////////12/12/29
            //            if ( LLL789 = 寸法(1) & Format((節点S + 節点E) * 10) ) { ////////13/04/04
            //                GoTo ABC
            //            }
            //        } ////////13/04/08
            //        if ( 連続荷重数 = 1 $$ NN = 2 $$ (YY_min = wYs $$ YY_min = wYe) $$ iKozo = 3 ) { //////////13/01/30
            //            GoTo ABC
            //        }
                if ( LLL789 = 寸法(1) & Format((節点S + 節点E) * 10) ) { GoTo ABC //////14/11/16
                LLL789 = 寸法(1) & Format((節点S + 節点E) * 10) ////////13/04/04
            //        if ( NN > 2 $$ 寸法線位置 < 0 ) { //////12/12/299
            //            if ( Mark111 = 1 ) {
            //                寸法線位置 = -15
            //                寸法補助線 = -3.5
            //            } else {if ( Mark111 = 2 || Mark111 = 3 || Mark111 = 4 ) {
            //                寸法線位置 = -13.5 + (g荷重表記高5 / 56.7 / 10 * 4)
            //                寸法補助線 = -3.5
            //            }
            //        } //////12/12/299
            if ( 連続荷重mark(1) = 6 $$ wXs = wXe $$ g柱本数 > 0 $$ RR橋脚 = 1 ) { //////13/02/24
            if ( 節X(節点S) = g柱X座標(1, 1) ) {
                寸法線位置 = -10
            } else {if ( 節X(節点S) = g柱X座標(g柱本数, 1) ) {
            } else {
                if ( (Abs(寸法線位置) / 図X_SCALE) < 600 ) { ////////if ( (g柱X座標(g柱本数, 1) - g柱X座標(1, 1)) > 100 ) {
                寸法線位置 = -Round((600 * 図X_SCALE), 1) //-max(6.5, Abs(寸法線位置))
                }
            }
            }
            if ( (P7 / Max荷重) < 0.35 $$ 連続荷重_P1(1) != 連続荷重_P2(1) $$ (Mark111 = 2 $$ 水平垂直 = 0) $$ (Abs(YY_max - wYs) > (YY_max - YY_min) / 5) ) { //////13/020/27
            寸法線位置 = -1
            }
            if ( NN = 2 $$ Abs(連続荷重_P1(1) / Max荷重) < 0.33 $$ g荷重表記高 < 140 $$ 連続荷重_P1(1) = 連続荷重_P2(1) ) {
                寸法線位置 = -12 ////////13/02/27
            }
            if ( (Mark111 = 2 $$ 水平垂直 = 0 $$ (P7 / Max荷重) > 0.9 $$ g荷重表記縦 = 1) ) { //////13/02/288
            //        if ( g荷重表記縦 = 1 ) {
                    寸法線位置 = 寸法線位置 - 1 ////// 12/11/22
            }
            if ( (Mark111 = 2 $$ 水平垂直 = 9 $$ 荷重方向 = "H" $$ g荷重表記縦 = 0) ) { ////////13/12/26
                if ( (連続荷重_P1(1) < 0 || 連続荷重_P2(1) < 0) ) {
                    寸法線位置 = Abs(寸法線位置)
                    寸法補助線 = 5
                } else {
                    寸法線位置 = min(Abs(寸法線位置), 15.5) * (-1)
                    寸法補助線 = -5
                }
            }
                        this.SunPou2("<", NN, 寸法線位置, 寸法補助線, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, , 荷重図開き)

                        if ( NN = 2 || (水平部材最下端 = (wYs + wYe) / 2) ) { //////12/12/15
            //                if ( NN = 2 || ((P7 / Max荷重) > 0.9) || (水平部材最下端 = (wYs + wYe) / 2) ) { //////12/12/15
                            if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                                For( i8 = 1 To yBuzaiFF
                                    i = yGGGGG(i8)
                                    部材正荷重数(i) = 部材正荷重数(i) + IIf(寸法線位置 < 0, Abs(Round(寸法線位置 / 1.1, 1)), 2)
                                }8
                            } else { //////////////////////////////////////////////////12/12/15
                                if ( ((BXE - BX0) / 連続荷重数) < 220 ) {
                                    yyF5 = IIf(寸法線位置 < 0, Abs(Round(寸法線位置 / 1.3, 1)), 2)
                                } else {
                                    yyF5 = IIf(寸法線位置 < 0, Abs(Round(寸法線位置 / 2, 1)), 2)
                                    if ( ((P7 / Max荷重) > 0.9) $$ 寸法線位置 < 0 $$ g荷重表記高 > 150 $$ (Y(1) - BY0 - 荷重図開き) < 3000 ) {
                                        yyF5 = Abs(Round(寸法線位置 / 1.1, 1)) //////13/02/28
                                    }
                                }
                                if ( (P7 / Max荷重) > 0.9 $$ (g荷重表記高 < 140 || (Abs(YY_max - wYs) > (YY_max - YY_min) / 5)) ) { //////13/020/27
                                    yyF5 = IIf(Abs(寸法線位置) > 15, 19, 17)
                                }
                                For( i = SS1 To SE2
                                    部材正荷重数(i) = 部材正荷重数(i) + yyF5
                                    if ( ((BXE - BX0) / 連続荷重数) < 220 ) {
                                    } else {
                                        if ( 荷重方向 = "V" ) {
                                            部材正荷重数(i) = 部材正荷重数(i) + 1.5 ////////12/12/17
                                        }
                                    }
                                }
                            }
                            GoTo ABC //////12/12/12
                        }
                    } else {if ( f寸法FLG = -1 ) { ////////09/08/14
                        this.SunPou2("<", NN, -7, -4, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, , 荷重図開き)
                        寸法線位置 = -7: 寸法補助線 = -4
                    } else {if ( f寸法FLG = 1 ) { //////09/08/14
                        this.SunPou2("<", NN, 6, 4, 寸法(), X(), Y(), Mark111, wXe = JX_max, , s寸法文字2段, , 荷重図開き)
                        寸法線位置 = 6: 寸法補助線 = 4
                    }
                }
            Case } else {
            End Select
            Next_GRF: ////////09/11/12
            //   //////////////////////////////////////////////08/07/06
            var SES As Single //////08/09/26
            double var d分布集中 As Single, GFGF As Single, DumyG ////////////09/03/25
            //
            var s段補正 As Single //////09/10/20
            s段補正 = 0
            if ( s寸法文字2段 ) { //////12/12/299//////And SS1 != SE2 ) { //////09/11/08
               s段補正 = 1
            }
            d分布集中 = 0
            SES = 0 ////////08/10/29
            ////////////////////////////////////////////////////////////////////////09/01/28
            if ( 水平垂直 = 1 ) {
            if ( yyF6 != 0 ) { //////09/08/05
                if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                    For( i8 = 1 To yBuzaiFF
                        i = yGGGGG(i8)
                        if ( yyF6 = 1 ) {
                             if ( FLG杭杭 $$ N段数 = 1 ) { //////09/11/07
                                部材正荷重数(i) = 8 + s段補正
                             } else {
                                部材正荷重数(i) = 部材正荷重数(i) - 5 + s段補正
                             }
                        } else {
                             if ( FLG杭杭 $$ N段数 = 1 ) { //////09/11/07
                                部材負荷重数(i) = 8 + s段補正
                             } else {
                                部材負荷重数(i) = 部材負荷重数(i) - 5 + s段補正
                             }
                        }
                    }8
                } else { //////////////////////////////////////////////////12/12/15
                    For( i = SS1 To SE2
                        if ( yyF6 = 1 ) {
                             if ( FLG杭杭 $$ N段数 = 1 ) { //////09/11/07
                                部材正荷重数(i) = 8 + s段補正
                             } else {
                                部材正荷重数(i) = 部材正荷重数(i) - 5 + s段補正
                             }
                        } else {
                             if ( FLG杭杭 $$ N段数 = 1 ) { //////09/11/07
                                部材負荷重数(i) = 8 + s段補正
                             } else {
                                部材負荷重数(i) = 部材負荷重数(i) - 5 + s段補正
                             }
                        }
                    }
                } //////12/12/15
            }
            GoTo ABC
            }
            if ( (連続荷重_P1(1) < 0 $$ 連続荷重_P2(1) < 0) $$ _
                (Mark111 = 2 || Mark111 = 3 || Mark111 = 4) $$ 荷重方向 != "H" ) { GoTo ABC
            //
            ////////////////////////////////////////////////////////////////////////09/01/28
            //
            if ( (g荷重表記縦 = 0 $$ (P7 / Max荷重) < 0.37) || g荷重表記縦 = 1 ) { //////10/04/07 < 0.4
            if ( g荷重表記縦 = 0 ) {
                SES = -0.7 ////////09/12/04//////0.3
                if ( yiKozo = 3 $$ (P7 / Max荷重) < 0.5 ) { SES = -4.5 //////12/05/14
                if ( (P7 / Max荷重) < 0.15 ) {
                    if ( J7 = 1 $$ J9 = 1 ) { //////if ( g荷重表記高 < 90 ) {
                        SES = -0.3 //////08/10/29
                    } else {
                        if ( (P7 / Max荷重) < 0.07 ) { //////09/10/20
                            SES = 3 - IIf(s段補正 > 0, 1, 0)
                        } else {
                            SES = 1 ////-0.3 //////08/10/29
                        }
                    }
                } else {if ( (P7 / Max荷重) < 0.3 ) { //////09/10/20
                    if ( s寸法文字2段 ) {
                        SES = -5.5 //////09/11/13
                    } else {
                        SES = -4 //////09/11/13
                    }
                }
            } else {if ( J5 = 0 $$ (yiKozo = 3 || g連続Mod) $$ J6 = -1.5 $$ g荷重表記縦 = 1 $$ (P7 / Max荷重) < 0.5 ) {
                SES = 0
                if ( (P7 / Max荷重) < 0.1 ) { ////////08/11/28
                    SES = -12
                } else {if ( (P7 / Max荷重) < 0.4 ) { ////////08/11/28
                    SES = -7
                }
            } else {
                if ( J5 = 0 ) {
                    SES = 寸法線位置 - 寸法補助線 - IIf((yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1), 6, 0) ////////08/11/277
                    if ( g荷重表記縦 = 1 ) { ////////And Not (yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) ) {
                        if ( (yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) ) {
                            J5 = -Round(((300 + GOUKEI) / 20) + ((250 - g荷重表記高) / 12) - 9, 1)
                            if ( J5 > 0 ) { ////////08/11/044
                                if ( N段数 = 1 ) {
                                    if ( J5 >= 5 $$ J5 < 13 ) { ////////10/03/18
                                        SES = -11 + (10 + 寸法線位置) * 5
                                        J5 = 0
                                        J55 = 0
                                        GoTo ABCF
                                    } else {
                                    J5 = 0 //J5 / 100 //////////09/11/13
                                    SES = SES - 3 //////////09/12/04
                                    }
                                } else {
                                    if ( g荷重表記高 > 260 ) {
                                        J5 = J5 / 5
                                    } else {
                                        J5 = J5 / 10 ////////10/04/18//////// + s段補正 //////////09/11/13
                                    }
                                }
                            }
                        } else {
                            SES = -Round((max(g荷重表記高, IIf(GOUKEI < -550, 0, 260)) / 50 + Abs(GOUKEI / 50)) + 0, 1) //////////////09/11/199
                            if ( g荷重表記高 > 290 ) {
                                if ( hosei != 0 || GOUKEI = -600 ) { //////////////10/04/18
                                    SES = Round(SES + hosei, 2)
                                    if ( GOUKEI = -600 ) {
                                        if ( hosei < 0 ) {
                                            SES = SES - 1 //////10/04/18
                                        } else {
                                            SES = SES - 0.5 + s段補正 //////10/04/18
                                        }
                                        hosei = 0
                                    }
                                } else {if ( SES > 0 ) { //////09/11/13
                                    SES = -15
                                }
                            } else {
                                if ( SES > -18 ) { ////////09/04/02
                                    if ( hosei <= 0 ) {
                                    if ( SES < -14 ) {
                                        if ( Abs(GOUKEI / 50) > 5 ) { //////09/10/23
            //                                    SES = -18 + min(7, Abs(GOUKEI / 50))
                                            SES = -18 + min(5, Abs(GOUKEI / 50)) //////09/11/30
                                            if ( g荷重表記高 > 120 ) { //////09/11/30
                                                SES = -18 + hosei //////////////09/11/30
                                                if ( hosei = 0 $$ (P7 / Max荷重) < 0.4 ) { //////////////09/12/03
                                                    SES = -15.1
                                                    if ( GOUKEI = -600 $$ g荷重表記高 > 135 ) { //////09/12/09
                                                        SES = -16.5
                                                    }
                                                }
                                            } else {
                                                //////////09/11/30
                                                SES = 寸法線位置 - 寸法補助線 - IIf((yiKozo = 3 $$ _
                                                                    g連続Mod $$ g荷重表記縦 = 1), 6, 0)
                                            }
                                        } else {
                                            SES = -18
                                        }
                                    } else {
                                        if ( Abs(GOUKEI / 50) > 5 $$ g荷重表記高 > 100 ) { //////09/11/11
                                            if ( s寸法文字2段 ) { ////////09/11/10
                                                SES = -18.2
                                            } else {
                                                if ( SES > 0 ) { ////////////////////////////////09/11/13
                                                    SES = -19 //////-Abs(GOUKEI / 50)
                                                } else {
                                                    SES = -16
                                                }
                                            }
                                        } else {
                                            SES = SES - 1 //////09/11/11
                                        }
                                    }
                                    }
                                    if ( (SES > -15 $$ Abs(GOUKEI / 50) > 7) $$ g荷重表記高 > 100 ) { //////09/11/11
                                        if ( s寸法文字2段 ) { ////////09/11/10
                                            SES = -18.2
                                        } else {
                                            SES = -16 //////SES - Abs(GOUKEI / 50 / 2)
                                        }
                                    }
                                }
                                if ( SES < -22 ) { ////////09/04/02
                                    SES = -22 //Round((g荷重表記高 / 50 - (GOUKEI / 100)) + 1.5, 1) ////////09/04/02
                                } else {if ( 寸法線位置 < -10 ) { //////10/01/14
                                    SES = -20
                                }
                            }
                            if ( hosei > 0 ) {
            //                        if ( (hosei ^ 1.5 - 15) < 0 ) {
                                 if ( hosei > 5 $$ g荷重表記高 > 250 ) {
                                    SES = SES + hosei
                                 } else {
                                    SES = SES + hosei / 2 ////////09/11/199
                                 }
                                    if ( N段数 = 1 ) { //////////////08/12/06
                                        SES = min(SES, -8.5) ////////////////////////////////////08/11/17
                                    }
            //                        }
                            }
                            J5 = 0
                        }
                        if ( hosei <= 0 ) { ////////////////////////////////////08/11/033 08/11/05
                            if ( J5 < 5 ) { //////08/12/07
                                if ( (g荷重表記高 / 180) < 0.8 $$ (g荷重表記高 / 180) > 0.6 $$ GOUKEI != -600 ) { //////((yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) || GOUKEI != -600) ) { ////09/12/09//////09/11/11
            //                            J5 = 3 * Round(g荷重表記高 / 180, 1) //////08/12/07
                                    J5 = (12 + SES) //////09/11/11
                                }
                            }
                        }
                        if ( J5 = 0 $$ J10 = 連続荷重数 $$ P7 < 100 $$ Not FLG_列車_衝撃 ) {
                            if ( (g荷重表記高 < 290 $$ SES > -18) $$ g荷重表記高 > 100 ) {  //////09/11/11
                                J5 = 3
                            } else {
                                if ( GOUKEI < -800 ) { ////////09/04/02
                                    J5 = -3
                                }
                            }
                        }
                        SES = SES - J5
                        if ( Mark111 = 4 ) { //////08/10/292
                            if ( Abs(GOUKEI) > 140 ) {
                                SES = -(g荷重表記高 / 50 + 9.5)
                            } else {
                                SES = -((g荷重表記高 + GOUKEI / 2) / 8)
                            }
                            J5 = 0
                        } else {if ( (J10 = 連続荷重数 $$ ((P6 / Max荷重) ^ 0.7) < 0.6 _
                                        $$ Abs(SES) < 9) || (yiKozo = 3 $$ g連続Mod $$ g荷重表記縦 = 1) _
                                        || (g荷重表記縦 = 1 $$ Abs(SES) < 9) ) { ////////08/11/277 08/12/05
                            SES = SES - 1.5 - IIf(P6 >= 10, 2.5, 0)
                            if ( Abs(SES) < 10 $$ (P6 / Max荷重) > 0.8 ) {
                                if ( s寸法文字2段 ) { //////09/11/11
                                    SES = -13
                                } else {
                                    SES = -11
                                }
                            } else {if ( (P6 / Max荷重) < 0.3 || 部材正荷重数(SS1) > 60 ) { ////09/11/04 < 0.5 ) {
                                if ( Not (g荷重表記縦 = 1 $$ g荷重表記高 < 60) ) { SES = -6 ////////10/01/03
                            } else {if ( g荷重表記高 < 220 ) { //////////////////09/11/13
            //                        SES = -max(Abs(SES), (g荷重表記高 / 50 + 9.5 + s段補正)) //////////////////09/11/13
                                if ( g荷重表記高 > 210 ) { //////////////////////10/04/05
                                    SES = 寸法線位置 ////////10/03/21
                                    GoTo ABCF ////////10/03/21
                                }
                            }
                        }
                    }
                } else {
                    SES = -3.7 - 6 + 5 + IIf((P6 / Max荷重 < 0.5) || J5 != 0, 3, 0) ////////08/11/033 09/02/20 || J5 != 0
                    if ( N段数 = 1 || 部材正荷重数(SS1) < 35 ) { ////////////08/12/06
                        if ( (P6 / Max荷重) < 0.8 $$ SES > 0 ) { //////09/10/30
                            SES = 0
                        }
                    } else {
            //                if ( (P6 / Max荷重 > 0.95) ) { ////////09/10/30////////09/11/06
            //                    SES = 0
            //                } else {
                            SES = SES - 3 - IIf(部材正荷重数(SS1) < 40, 1, -2) ////////09/10/30
            //                }
                    }
                    if ( J55 < 0 ) {
                        if ( 部材正荷重数(SS1) < 40 ) { //////////////////////////////////09/11/199
                            SES = SES - 7 - IIf(s寸法文字2段, 0.7, 0)
                        } else {
                            SES = SES + 3
                        }
                    }
            //            d分布集中 = 1 //////09/03/25//////09/11/18 コメント
                }
            }
            if ( Mark111 != 1 $$ (部材正荷重数(SS1) >= 24 || SES > -2) $$ SES > -17 $$ g荷重表記高 > 100 ) { ////09/12/25////09/12/26
                if ( hosei <= 0 ) { ////////////10/01/03
                    if ( s寸法文字2段 || s段補正 = 1 ) { //////09/12/13
                        SES = IIf(N段数 = 1 || (g荷重表記縦 = 0 $$ (160 > g荷重表記高)), -1.5, -8.5) - IIf(s段補正 = 1, 1, 0) //////////12/12/29
                        if ( N段数 = 2 $$ 寸法線位置 < -10 $$ SES = -1.5 - IIf(s段補正 = 1, 1, 0) $$ 部材正荷重数(SS1) < 52 ) { //////12/12/29
                            SES = -7.5 - IIf(s段補正 = 1, 1.5, 0)
                        }
                    } else {
                        if ( g荷重表記縦 = 0 $$ Mark111 = 3 $$ g荷重表記高 < 150 ) { ////////10/01/30
                        SES = IIf(N段数 = 1, -0.5, -2)
                        } else {
                        SES = IIf(N段数 = 1, -0.5, -12) ////////09/12/10//////12/02/15
                        }
                    }
                    if ( g荷重表記縦 = 1 ) {
                        if ( (160 > g荷重表記高) ) {
                            if ( hosei = 0 $$ Not (GOUKEI = -560 || GOUKEI = -600) ) { ////09/12/26
                                SES = SES - max(Round((160 - g荷重表記高) / 20, 1), 0) ////09/12/25
                            } else {
            //                        if ( hosei = 0 ) { SES = -5 //////-8.5////////12/02/15  -6.5
                            }
                        } else {
                            SES = SES - (Round((g荷重表記高 - 160) / 20, 1) - hosei / 4) ////09/12/25
                        }
                    }
                } ////////////10/01/03
            } else {if ( g荷重表記縦 = 1 $$ g荷重表記高 < 110 ) { //////////////////10/01/27
                if ( g荷重表記高 = 0 ) {
            //        if ( N段数 = 1 ) {
                SES = IIf(N段数 = 1, IIf(Mark111 = 1, IIf(GOUKEI < 0, -5, -3.5), -0.5), -7.5 + 3) //////10/03/27////// - 6) //////////10/01/30
                } else {
                SES = IIf(N段数 = 1, -0.5, IIf(g荷重表記高 < 80, -8, -5)) //////13/04/08
                }
                if ( g荷重表記高 = 0 $$ 部材正荷重数(SS1) > 43 ) { ////////////////////////////////////10/01/30
                    if ( 寸法線位置 < -17 ) { ////////10/02/05
                        if ( Mark111 = 1 $$ (P7 / Max荷重) < 0.4 ) { //////10/04/100
                            SES = -6
                        } else {
                            SES = -Round(6 * (P7 / Max荷重) ^ 0.5, 2) //////10/04/100
                        }
                    } else {
                        SES = -2
                    }
                }
            }
            if ( N段数 = 1 $$ SES < -19 $$ 部材正荷重数(SS1) > 20 $$ g荷重表記高 > 220 ) { ////////09/12/04
                if ( s寸法文字2段 || s段補正 = 1 ) { //////09/12/13
                    SES = -7.5
                } else {
                    SES = -6.5
                }
            } else {if ( Mark111 = 1 ) { //////09/12/25
                if ( 部材正荷重数(SS1) < 30 ) {
                    if ( SES < -2 $$ Not (GOUKEI > 0 $$ GOUKEI < 11) ) { //////10/03/27
                        if ( (P7 / Max荷重) < 0.4 ) { //////10/04/100
                            SES = -6
                        } else {
                            if ( P7 < 350 $$ (P7 / Max荷重) > 0.99 ) { ////////10/04/18
                                SES = -1
                            } else {
                                if ( 水平垂直 = 0 $$ Mark111 = 1 $$ N段数 > 1 $$ 部材正荷重数(SS1) < 20 ) {
                                    SES = -6.7 //////12/08/17
                                    GoTo ABCF
                                } else {
                                    SES = -Round(6 * (P7 / Max荷重) ^ 0.5, 2) //////10/04/100//////// - s段補正
                                }
                            }
                        }
                    }
                }
            }
            if ( g荷重表記縦 = 0 $$ Mark111 != 3 ) { //////09/12/26////////10/01/30
                if ( (P6 / Max荷重) < 0.4 $$ SES < -1 ) { //////////////////10/01/30 10/02/03 12/12/17
                    if ( Mark111 = 4 ) { ////////////////////////////////////////// 10/02/03
                        if ( Abs(SES) > 10 $$ (P7 / Max荷重) > 0.36 ) {
                            SES = -5 - IIf(s寸法文字2段, 1, 0) //////12/12/17
                        } else {
                        SES = -3 - IIf(s寸法文字2段, 1, 0)  //////12/12/17
                        }
                    } else {
                         if ( g荷重表記高 < 120 ) { ////////09/12/04
                         } else {
                            if ( yiKozo = 1 $$ s段補正 = 0 ) {  //////////////////////12/11/27
                                if ( (P6 / Max荷重) < 0.36 ) { //////12/11/27
                                    if ( 部材正荷重数(SS1) > 70 ) {
                                    SES = -8.5 - IIf(s寸法文字2段, 1, 0) ////////////12/02/15
                                    } else {
                                    SES = -4.5 - IIf(s寸法文字2段, 1, 0) ////////////12/02/15
                                    }
                                }
                            } else {
                                SES = -5 - IIf(s寸法文字2段, 1, 0)
                            }
                         }
                    }
                } else {if ( (P6 / Max荷重) < 0.36 $$ SES = -0.7 $$ g荷重表記高 < 110 ) { //////////// 10/02/03
                    if ( g荷重表記高 < 75 ) { //////////// 10/08/01
                        SES = -4 - IIf(s寸法文字2段, 1, 0) //////////// 10/08/01
                    } else {if ( g荷重表記高 < 90 ) { //////////// 10/02/03
                        SES = -5 - IIf(s寸法文字2段, 1, 0)
                        if ( g荷重表記高 < 65 ) { //////////// 10/02/23
                            SES = -3 - IIf(s寸法文字2段, 1, 0)
                        }
                    } else {
                        SES = -7 //- IIf(s寸法文字2段, 1, 0) //////12/11/22
                    }
                }
            }
            if ( g荷重表記縦 = 1 ) { //////10/01/30
                if ( 部材正荷重数(SS1) > 35 $$ g荷重表記高 < 210 ) { //////10/04/20
                    if ( SES = -20 $$ g荷重表記高 > 170 $$ g荷重表記高 < 200 ) {
                        if ( 部材正荷重数(SS1) > 80 ) {
                            SES = -10
                        } else {
                            SES = -8 //////10/04/20//////-Round(g荷重表記高 / 14, 2) - 4 //////-10
                        }
                    } else {if ( SES = -20 $$ g荷重表記高 > 200 ) {
                        SES = -18
                    } else {if ( g荷重表記高 > 170 $$ Not (yiKozo = 3 $$ g連続Mod) ) { //////10/04/18
                        if ( GOUKEI != -600 ) { SES = -Round(g荷重表記高 / 20, 2) ////// - 2//////10/11/11//////12/02/15
                    } else {if ( g荷重表記高 < 95 $$ g荷重表記高 > 70 $$ yiKozo = 1 ) { //////////////////////10/02/07
                        SES = -16 //////Round(g荷重表記高 / 10, 2) ////// - 2
                    }
                } else {if ( SES > -6 $$ 部材正荷重数(SS1) < 30 $$ g荷重表記高 > 130 ) {
                    SES = -18
                } else {if ( GOUKEI = -395 $$ 部材正荷重数(SS1) < 30 $$ g荷重表記高 > 130 ) { ////////10/02/03
                    SES = -7
                } else {if ( SES > -12 $$ g荷重表記高 > 280 ) {
                    SES = -12
                } else {if ( SES = -20 $$ g荷重表記高 < 280 $$ g荷重表記高 > 245 ) { //////10/04/03
                    if ( g荷重表記高 > 260 ) { //////10/04/04////10/04/17
                        SES = -18
                    } else {
                        SES = -12 - s段補正
                    }
                } else {if ( SES = -20 $$ g荷重表記高 < 200 $$ g荷重表記高 > 165 ) { //////10/04/18 10/10/21
                    SES = -15 - s段補正
                }
                if ( SES >= -6 ) { ////////10/04/18//////10/04/18
                    if ( Mark111 = 1 ) {
                        if ( (GOUKEI > 20 $$ GOUKEI < 100 $$ Abs(寸法線位置) > 15) || Len(鉛直文字列) <= 4 ) { //////10/04/05
                            if ( Len(鉛直文字列) > 6 || (Abs(寸法線位置) > 15 $$ GOUKEI > 80) ) { //////10/04/20
            //                        SES = 寸法線位置 //////10/10/14
                            } else {
                                SES = -5
                            }
                        } else {
                            if ( SES = -6 ) { //////10/04/18
                                SES = -5
                            } else {
                                SES = -3.5 - s段補正 - 3 ////////////////////10/03/27//////10/04/18//////10/10/14//////12/02/15
                            }
                        }
                        if ( 荷重文字サイズ > 9.5 ) { //////12/09/25
                            SES = SES - Round((荷重文字サイズ - 9.5) * 2.5, 2)
                        }
                    } else {
                        if ( SES >= -5 ) { SES = -5  ////////12/02/15////////////////////////10/02/23
                    }
                }
                if ( g荷重表記縦 = 1 $$ g荷重表記高 != 0 $$ g荷重表記高 <= 80 $$ Abs(SES) > 8 ) { //////10/04/09
                    if ( g荷重表記高 < 60 ) { ////////10/04/10
                        SES = -5.5
                    } else {
                        SES = -2
                    }
                } else {if ( g荷重表記縦 = 1 $$ g荷重表記高 > 260 ) { //////12/02/15
            //            if ( SES < -22 ) {
            //                SES = SES + 5
            //            } else {
                        SES = SES - 5 ////////Round((g荷重表記高 / 150 - 寸法線位置 / 10), 2) //////13/02/288
            //            }
                }
            } //////////////////////////////////////////////////10/01/30
            ABCF:
            if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                For( i8 = 1 To yBuzaiFF
                    i = yGGGGG(i8)
                        GFGF = 0
                        if ( 部材正荷重数(i) < 23 ) {
                            DumyG = 部材正荷重数(i)
                            if ( g荷重表記高 < 260 ) {
                                if ( J55 < 0 ) {
                                    GFGF = 2.6
                                } else {
                                    if ( s段補正 = 0 ) {
                                        GFGF = 0
                                        if ( SES > -6 ) { SES = -6
                                    } else {
                                        GFGF = -4
                                        if ( SES >= -6 ) { GFGF = -2 + s段補正
                                    }
                                }
                            }
                        }
                        if ( 寸法線位置 < -10 $$ SES < 4.5 $$ SES > 0 $$ GFGF + s段補正 = 0 ) {
                            SES = 0
                        } else {if ( SES < 0 $$ Abs(SES) > 6 ) {
                            if ( Mark111 = 1 ) { SES = -2
                        }
                        部材正荷重数(i) = 部材正荷重数(i) - 1.7 - SES - 2 + GFGF + s段補正
                    }8
            } else { //////////////////////////////////////////////////12/12/15
                For( i = SS1 To SE2
                    GFGF = 0
                    if ( 部材正荷重数(i) < 23 ) { //////////////09/11/199//////10/04/18
                        DumyG = 部材正荷重数(i)
                        if ( g荷重表記高 < 260 ) { ////////09/12/26
                            if ( J55 < 0 ) {
                                GFGF = 2.6  //////8.6 //////12/09/10
                            } else {
                                if ( s段補正 = 0 ) { ////////09/11/088
                                    GFGF = 0
                                    if ( SES > -6 ) { SES = -6 ////////10/03/03
                                } else {
                                    GFGF = -4 ////////09/12/04 -2
                                    if ( SES >= -6 ) { GFGF = -2 + s段補正 ////////10/01/188
                                }
                            }
                        }
                    }
                    if ( 寸法線位置 < -10 $$ SES < 4.5 $$ SES > 0 $$ GFGF + s段補正 = 0 ) {
                        SES = 0
                    } else {if ( SES < 0 $$ Abs(SES) >= 6 ) {
                        if ( Mark111 = 1 || Mark111 = 2 ) {
                            if ( g荷重表記縦 = 0 ) { //////13/04/08
                                SES = -2
                            } else {
                                if ( g荷重表記高 >= 80 ) { SES = max(Abs(SES), 20 + ((300 - g荷重表記高) / 20)) * Sgn(SES)
                            } //////////////13/04/08
                        }
                    }
                    部材正荷重数(i) = 部材正荷重数(i) - 1.7 - SES - 2 + GFGF + s段補正 //////09/10/20
                }
            } //////12/12/15
            } else {
            Select Case j
            Case 1
                SES = -(-2 + IIf(yFR橋脚 = 1 $$ J5 != 0, 2, 0) - max(hosei, 0) + s段補正) //////10/10/14
                if ( 連続荷重mark(1) = 11 $$ g荷重表記高 = 0 $$ 部材正荷重数(SS1) < 16 ) {
                    SES = -6.5
                }
                if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                    For( i8 = 1 To yBuzaiFF
                        i = yGGGGG(i8)
                        部材正荷重数(i) = 部材正荷重数(i) - SES
                    }8
                } else { //////////////////////////////////////////////////12/12/15
                    For( i = SS1 To SE2
                        部材正荷重数(i) = 部材正荷重数(i) - SES
                    }
                }
            Case 2
                if ( GHOSEI = 0 ) {
                    SES = Round(-寸法線位置 / 2.2, 1) ////08/10/07////08/10/29
                    if ( J10 = 連続荷重数 ) {
                        SES = SES + 4 //////////08/10/15
                    }
                    if ( (P7 / Max荷重) > 0.8 ) { SES = Round(SES / 1.5, 1) ////08/10/29
                } else {if ( J10 = 連続荷重数 $$ GHOSEI < 0 ) {
                    SES = (-寸法線位置 / 1) ////08/10/095
                } else {if ( J10 = 連続荷重数 ) {
                    GHOSEI = GHOSEI * ((P7 / Max荷重) ^ 0.7) //////08/10/099
                }
                if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                    For( i8 = 1 To yBuzaiFF
                        i = yGGGGG(i8)
                        部材正荷重数(i) = 部材正荷重数(i) + 0.5 + max(GHOSEI, SES) + s段補正
                    }8
                } else { //////////////////////////////////////////////////12/12/15
                    For( i = SS1 To SE2
                        部材正荷重数(i) = 部材正荷重数(i) + 0.5 + max(GHOSEI, SES) + s段補正
                    }
                }
            Case 3
                if ( Mark111 = 3 ) { //////09/11/13
                    SES = Round(4 * (P7 / Max荷重) ^ 0.8 + min(hosei, 0), 1) //////10/03/21
                } else {
                    SES = Round(4 * (P7 / Max荷重), 1) //////10/03/21
                }
                if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                    For( i8 = 1 To yBuzaiFF
                        i = yGGGGG(i8)
                        部材正荷重数(i) = 部材正荷重数(i) + SES + s段補正
                    }8
                } else { //////////////////////////////////////////////////12/12/15
                    For( i = SS1 To SE2
                        部材正荷重数(i) = 部材正荷重数(i) + SES + s段補正
                    }
                }
            Case 4
                if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                    For( i8 = 1 To yBuzaiFF
                        i = yGGGGG(i8)
                        部材正荷重数(i) = 部材正荷重数(i) + 2 + s段補正
                    }8
                } else { //////////////////////////////////////////////////12/12/15
                    For( i = SS1 To SE2
                        部材正荷重数(i) = 部材正荷重数(i) + 2 + s段補正
                    }
                }
            Case } else {
                if ( J9 = 1 $$ GHOSEI > 0 ) {
                    if ( (P7 / Max荷重) >= 0.98 ) {
                        if ( (P7 / Max荷重) < 1.5 ) {
                            SES = max(4, GHOSEI * 0.6)
                        } else {
                            SES = max(10, GHOSEI * 0.6)
                        }
                    } else {
                        SES = max(8 * (1 - P7 / Max荷重), GHOSEI * 0.6)
                    }
                    if ( FLG_列車_衝撃 ) {
                        if ( N段数 = 1 ) {
            //                    SES = SES + 3 //////////08/10/15 //////009/02/20 コメントにした
                        } else {
                            SES = SES + 4.5 - m調整高 //////10/11/11//////hosei / 2 //////////08/10/292
                        }
            //            }
                    } else { //////J7 = 1 $$ J9 = 1 ) { //////08/10/292////////08/11/25
                        if ( J7 != 1 ) { ////////08/11/25
                            if ( (P7 / Max荷重) > 0.95 ) {
                                if ( g荷重表記縦 = 0 $$ g荷重表記高 = 180 $$ GOUKEI = 260 ) { //////12/08/21
                                    SES = max(SES / 2, 2)
                                } else {
                                    SES = max(SES / 1, 5)
                                }
                            } else {
                                SES = max(SES / 1.5, 2)
                            }
                        } else {
                           SES = max(SES, GHOSEI) ////////09/11/199
                        }
                    }
                } else {
                    if ( FLG_列車_衝撃 ) {
                        SES = IIf(yFR橋脚 = 1, 0, 4 * (P7 / Max荷重))
                        if ( N段数 = 1 ) {
                            SES = SES + 2 //////////08/10/292
                        } else {
                            SES = SES + 4.5
                        }
                    } else {
                        if ( N段数 = 1 ) { //////08/10/29
                            if ( J8 = 0 ) {
                                if ( g荷重表記縦 = 0 ) {
                                SES = 0
                                } else {
                                SES = 1 ////////0 - 1.3 //09/04/07//////(g荷重表記高 / 100) //////1.5 // + Round((P7 / Max荷重), 1) + g荷重表記高
                                }
                            } else {
                                SES = 0 + IIf(J8 = 0, 0, 2)
                            }
                        } else {
                            if ( yFR橋脚 = 1 $$ Not (g連続Mod = True $$ yiKozo = 3) ) { ////////09/07/30
                                SES = 0
                                if ( (P7 / Max荷重) > 0.9 || g荷重表記高 > 280 ) { //////09/08/03
                                    SES = 5 * (P7 / Max荷重)
                                } else {if ( (P7 / Max荷重) > 0.6 $$ g荷重表記高 < 220 ) { //////09/10/14
                                    SES = (1.5 * min(Max荷重 / P7, 2))
                                } else {
                                    SES = 3.5 ////////09/11/08
                                }
                            } else {
                                if ( (P7 / Max荷重) > 0.9 || g荷重表記高 >= 180 ) { //////10/04/09
                                    if ( 部材正荷重数(SS1) > 30 ) {
                                        SES = 5 * (P7 / Max荷重) //////////08/11/25
                                    } else {
                                        SES = 6 * (P7 / Max荷重) //////////08/11/25 10/04/09
                                    }
                                } else {
                                    if ( (P7 / Max荷重) > 0.7 ) {
                                        SES = 0
                                    } else {
                                        if ( (P7 / Max荷重) < 0.4 ) { //////08/11/044//////08/11/25
                                            if ( yiKozo = 3 ) { //////08/11/277
                                                SES = -3.2
                                                if ( g連続Mod = True $$ g荷重表記縦 = 0 ) { ////////09/07/30
                                                    if ( (P7 / Max荷重) > 0.4 ) { SES = 0 } else { SES = -1 //////////09/12/04
                                                }
                                            } else {
                                                SES = 0 //////08/11/25//////08/11/277
                                            }
                                        } else {
                                            SES = 2
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if ( (g荷重表記縦 = 0 $$ N段数 = 1 $$ Mark111 = 2) $$ _
                   Not (g連続Mod = True $$ yiKozo = 3) ) { //////////////////////////////////////////////09/08/03
                         if ( (P7 / Max荷重) < 0.6 $$ SES = 0 ) { ////////09/11/199
                         SES = max(17, Round((g荷重表記高 / 20), 2)) + s段補正 + IIf(s寸法文字2段, 1, 0.5)
                         } else {
                         SES = max(12.8, Round((g荷重表記高 / 18), 2)) + SES + s段補正 + IIf(s寸法文字2段, 1, 0.5)
                            if ( (P7 / Max荷重) > 0.9 $$ SES < 18 ) { //////////10/02/23
                                SES = 18 * (P7 / Max荷重) + s段補正
                            }
                         }
                    if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                        For( i8 = 1 To yBuzaiFF
                            i = yGGGGG(i8)
                            if ( SES > 部材正荷重数(i) ) {
                                部材正荷重数(i) = 部材正荷重数(i) + IIf(g背割れ = 2 $$ SES > 15, 15, 9) + s段補正
                            } else {
                                部材正荷重数(i) = 部材正荷重数(i) + 1 + s段補正
                            }
                        }8
                    } else { //////////////////////////////////////////////////12/12/15
                        For( i = SS1 To SE2
                            if ( SES > 部材正荷重数(i) ) {
                                部材正荷重数(i) = 部材正荷重数(i) + IIf(SES > 15, 15, 9) + s段補正 ////12/12/15//////IIf(g背割れ = 2 $$ SES > 15, 15, 9) + s段補正
                            } else {
                                部材正荷重数(i) = 部材正荷重数(i) + 1 + s段補正
                            }
                        }
                    }
                } else {
                    if ( g荷重表記高 = 220 $$ GOUKEI = 150 $$ SES < 6 ) { //////09/11/202
                        if ( Not 連続荷重mark(1) = 4 $$ (P7 / Max荷重) < 0.6 ) { //////10/10/13
                        SES = 3 + Round(SES, 0)
                        }
                        if ( 連続荷重mark(1) = 4 $$ (P7 / Max荷重) > 0.95 ) { //////10/10/20
                        SES = 3 + Round(SES, 0)
                        }
                    }
                    if ( ((g荷重表記縦 = 0 $$ (Mark111 = 2 || Mark111 = 3)) $$ SES < 14 * (P7 / Max荷重) ^ 0.5) ) { //////12/11/22
                            if ( (J9 = 1 $$ (GHOSEI = 1 || GHOSEI = 2.5)) ) { //////12/12/16
                                SES = 2
                                if ( 部材正荷重数(SS1) < 25 ) {
                                    SES = 16 * ((P7 / Max荷重) ^ 0.5)
                                } else {if ( (Y(1) - BY0 - 荷重図開き) < 0 ) { //////13/02/28
                                    SES = 14 * ((P7 / Max荷重) ^ 0.5)
                                }
                            } else {
                                if ( 部材正荷重数(SS1) < 80 $$ (Y(1) - BY0 - 荷重図開き) > -400 ) { //////13/02/28
                                    if ( (Y(1) - BY0 - 荷重図開き) > 2300 ) { //Or g荷重表記高 > 150 ) {
                                        SES = 4 * ((P7 / Max荷重) ^ 0.5) //////////13/02/28
                                    } else {if ( (Y(1) - BY0 - 荷重図開き) < 2300 $$ (Y(1) - BY0 - 荷重図開き) > 0 ) {
                                        SES = 19 // * ((P7 / Max荷重) ^ 0.5) //////////12/11/22
                                        if ( (P7 / Max荷重) < 0.5 ) {
                                            SES = 2
                                        }
                                    } else {
                                        SES = 14 * ((P7 / Max荷重) ^ 0.5) //////////12/11/22
                                    }
                                }
                            }
                            if ( 連続荷重mark(1) = 2 $$ (P7 / Max荷重) > 0.6 $$ SES < 10 $$ N段数 > 1 ) { //////13/02/288
                                SES = 10
                            }
                    }
                    if ( yBuzaiFF > 0 ) { //////////////////12/12/15
                        For( i8 = 1 To yBuzaiFF
                            i = yGGGGG(i8)
                            部材正荷重数(i) = 部材正荷重数(i) + SES + s段補正
                        }8
                    } else { //////////////////////////////////////////////////12/12/15
                        For( i = SS1 To SE2
                             部材正荷重数(i) = 部材正荷重数(i) + SES + s段補正
                        }
                    }
                }
            End Select
            }

            ABC:

            if ( 上層Buzai(MQM) = SE2 $$ 荷重図開き > 0 $$ yBuzaiFF = 0 ) { //////12/12/299
                J5 = 9999
                J6 = 0
                For( i = 1 To MQM
                    J4 = 上層Buzai(i)
                    J5 = min(J5, 部材正荷重数(J4))
                    J6 = max(J6, 部材正荷重数(J4))
                }
                if ( J5 != J6 ) {
                    For( i = 1 To MQM
                        J4 = 上層Buzai(i)
                        部材正荷重数(J4) = J6
                    }
                }
            } //////12/12/299
            //    //////////////////////////////////////////////
            //    連続荷重数 = 0
            //    gHosei = 0
            //    寸法線位置 = 0
            //    g荷重表記縦 = 0 //////08/10/29
            //    g荷重表記高 = 0
            //    g荷重表記高5 = 0 //////09/11/13
            //    //
                                                                                            */
        }

        private void F2部材荷重高(int 荷重mark, double 荷重_P1, double 荷重_P2, double YY1, double Yy2, double 荷重図初期長さ, double 部材荷重図Scale, int KAJY方向2,
                double 高さ調整, int 水平垂直, float HOSE1, float floatHOSE2, float FMN, float 荷重_L1, float 荷重_L2, int 節点S, int 節点E, int CASU, int BUZAN, int Atta, int BCS, string 荷重方向5)
        {
            /*
//
var M77 As Integer
var YY3 As Single //////14/12/14
if ( 荷重mark = 5 || 荷重mark = 11 ) {
    YY1 = 荷重図初期長さ + Abs(荷重_P1) * 部材荷重図Scale
    Yy2 = 荷重図初期長さ + Abs(荷重_P2) * 部材荷重図Scale
} else {
    Select Case 荷重_P1
    Case 0
        YY1 = 0
    Case Is > 0
        YY1 = 荷重図初期長さ + 荷重_P1 * 部材荷重図Scale
    Case Is < 0
        YY1 = -荷重図初期長さ + 荷重_P1 * 部材荷重図Scale * KAJY方向2
    End Select
    if ( 荷重mark > 5 ) {
        YY1 = 荷重図初期長さ + Abs(荷重_P1) * 部材荷重図Scale
    }
    Select Case 荷重_P2
    Case 0
        Yy2 = 0
    Case Is > 0
        Yy2 = 荷重図初期長さ + 荷重_P2 * 部材荷重図Scale
    Case Is < 0
        Yy2 = -荷重図初期長さ + 荷重_P2 * 部材荷重図Scale * KAJY方向2
    End Select
    if ( 荷重mark > 5 ) {
       Yy2 = 荷重図初期長さ + Abs(荷重_P2) * 部材荷重図Scale
    }
}
Select Case 荷重mark
Case 1
//        if ( BP荷重MAX != 0 ) {
//            HOSE1 = (Abs(荷重_P1) / BP荷重MAX) ^ 0.3 ////////14/08/17   0.4
//            HOSE2 = (Abs(荷重_P2) / BP荷重MAX) ^ 0.3
//        } else {
//            HOSE1 = 0.7 ////////14/08/17
//            HOSE2 = 0.7
//        }
    HOSE1 = 0.65 ////////14/08/17
    HOSE2 = 0.65
    if ( Abs(荷重_P1) >= 0 ) {
        YY1 = 荷重図初期長さ + HOSE1 * 集中荷重Scale * Twip //* 0.8////////14/08/17
        YY1 = min(YY1, 集中荷重長さmax * Twip)
    }
    if ( Abs(荷重_P2) >= 0 ) {
        Yy2 = 荷重図初期長さ + HOSE2 * 集中荷重Scale * Twip //* 0.8 //////14/08/17
        Yy2 = min(Yy2, 集中荷重長さmax * Twip)
    }
//        YY1 = max(YY1, 集中荷重Scale * Twip) ////////14/08/17
//        Yy2 = max(Yy2, 集中荷重Scale * Twip)
Case 2, 4
    高さ調整 = 1
    YY1 = 0: Yy2 = 0 ////////08/11/24
    if ( 水平垂直 = 1 ) {
        if ( Abs(荷重_P1) > 0 ) { YY1 = 部材荷重長さmax / Log(BU荷重MAX * 10 / Log(10) / Abs(荷重_P1)) * Twip * Sgn(荷重_P1) * FMN * (Abs(荷重_P1) / BU荷重MAX) ^ 0.8 * 1.2 * 1.3 * 1.3
        if ( Abs(荷重_P2) > 0 ) { Yy2 = 部材荷重長さmax / Log(BU荷重MAX * 10 / Log(10) / Abs(荷重_P2)) * Twip * Sgn(荷重_P2) * FMN * (Abs(荷重_P2) / BU荷重MAX) ^ 0.8 * 1.2 * 1.3 * 1.3
//            if ( Abs(荷重_P1) = Abs(荷重_P2) $$ Abs(Abs(荷重_P1) - BU荷重MAX) < 0.001 ) {
//                YY1 = YY1 * 0.6
//                Yy2 = Yy2 * 0.6
//            }
        return;
    } else {if ( iKozo = 3 ) {
        if ( 水平垂直 != 0 $$ Round(荷重_P1, 2) != Round(荷重_P2, 2) ) {   //垂直部材
            if ( max(Abs(荷重_P1), Abs(荷重_P2)) / BU荷重MAX > 0.2 || 水平垂直 = 1 ) {
                if ( Abs(荷重_P1) > 0 ) {
                    YY1 = 部材荷重長さmax / Log(BU荷重MAX * 10 / Log(10) / Abs(荷重_P1)) * Twip * Sgn(荷重_P1) * FMN * (Abs(荷重_P1) / BU荷重MAX) ^ 0.8 * 1.2 * 1.3 * 1.3
                }
                if ( Abs(荷重_P2) > 0 ) {
                    Yy2 = 部材荷重長さmax / Log(BU荷重MAX * 10 / Log(10) / Abs(荷重_P2)) * Twip * Sgn(荷重_P2) * FMN * (Abs(荷重_P2) / BU荷重MAX) ^ 0.8 * 1.2 * 1.3 * 1.3
//////13/04/24
                    if ( 水平垂直 = 1 $$ 荷重mark = 2 $$ (iKozo = 3 || 水平垂直 = 1) $$ 荷重_P1 = 0 $$ (Abs(荷重_P2) / BU荷重MAX) < 0.7 ) {
                        Yy2 = 部材荷重長さmax / Log(BU荷重MAX * 10 / Log(10) / BU荷重MAX) * Twip * Sgn(荷重_P2) * FMN * 1.2 * 1.3
                        Yy2 = Yy2 * (Abs(荷重_P2) / BU荷重MAX) + YY1 * (1 - Abs(荷重_P2) / BU荷重MAX)
                    }
////////13/01/31
                    if ( 水平垂直 = 1 $$ 荷重mark = 2 $$ (iKozo = 3 || 水平垂直 = 1) $$ 荷重_P1 = 0 $$ Abs(荷重_P2) / BU荷重MAX > 0.95 $$ (Abs(節Y0(節点S) - 節Y0(節点E)) - 荷重_L1 - 荷重_L2) / Abs(節Y0(節点S) - 節Y0(節点E)) < 0.3 ) { ////////And 荷重_L2 = 0 ) {
                        Yy2 = Yy2 / 2
                    }
                }
            } else {
                if ( Abs(荷重_P1) > 0 ) {
                    YY1 = 部材荷重長さmax / Log(BU荷重MAX * 10 / Log(10) / Abs(荷重_P1)) * Twip * Sgn(荷重_P1) * FMN * (Abs(荷重_P1) / BU荷重MAX) ^ 0.3 * 1.5 * 1.3
                }
                if ( Abs(荷重_P2) > 0 ) {
                    Yy2 = 部材荷重長さmax / Log(BU荷重MAX * 10 / Log(10) / Abs(荷重_P2)) * Twip * Sgn(荷重_P2) * FMN * (Abs(荷重_P2) / BU荷重MAX) ^ 0.3 * 1.5 * 1.3
                }
            }
        } else {
            if ( Abs(荷重_P1) > 0 ) {
                YY1 = 部材荷重長さmax / Log(BU荷重MAX * 10 / Log(10) / Abs(荷重_P1)) * Twip * Sgn(荷重_P1) * FMN * (Abs(荷重_P1) / BU荷重MAX) ^ 0.3 * 1.2
            }
            if ( Abs(荷重_P2) > 0 ) {
                Yy2 = 部材荷重長さmax / Log(BU荷重MAX * 10 / Log(10) / Abs(荷重_P2)) * Twip * Sgn(荷重_P2) * FMN * (Abs(荷重_P2) / BU荷重MAX) ^ 0.3 * 1.2
            }
            if ( FLG車両ZU = False ) {
//                    if ( BU荷重MAX / max(Abs(荷重_P1), Abs(荷重_P2)) > 10 $$ max(Abs(YY1), Abs(Yy2)) < 80 ) {
//                        if ( Abs(YY1) < 80 ) { YY1 = 80 * Sgn(YY1) ////////////08/08/15
//                        if ( Abs(Yy2) < 80 ) { Yy2 = 80 * Sgn(Yy2) ////////////08/08/15
//                    }
// //////////08/07/06
//削除した  if ( 荷重_L1 + 荷重_L2 = 0 ) {
                    if ( (水平垂直 = 0) $$ (BU荷重MAX / max(Abs(荷重_P1), Abs(荷重_P2))) > 3 ) { //////FLG_列車_衝撃 ) {
//                            if ( YY1 < 100 ) {
                            if ( Abs(荷重_P1) != 0 $$ YY1 < 100 ) { YY1 = YY1 * ((BU荷重MAX / Abs(荷重_P1)) ^ 0.2)
                            if ( Abs(荷重_P2) != 0 $$ Yy2 < 100 ) { Yy2 = Yy2 * ((BU荷重MAX / Abs(荷重_P2)) ^ 0.2)
//                            }
                    } else {if ( 水平垂直 = 1 $$ Abs(荷重_P1) != Abs(荷重_P2) ) {
                        YY1 = YY1 * 1.4
                        Yy2 = Yy2 * 1.4
                    }
                if ( BU荷重MAX / max(Abs(荷重_P1), Abs(荷重_P2)) > 10 $$ max(Abs(YY1), Abs(Yy2)) < 80 ) {
                    if ( Abs(YY1) < 80 ) { YY1 = 80 * Sgn(YY1) ////////////08/08/15
                    if ( Abs(Yy2) < 80 ) { Yy2 = 80 * Sgn(Yy2) ////////////08/08/15
                }
//  }
            }
//                高さ調整 = (max(Abs(YY1), Abs(Yy2)) / 部材荷重長さmax / Twip) ^ 0.6
        }
    } else {
        if ( 下層BUZAI(1, 1) != 0 $$ (max(Abs(荷重_P1), Abs(荷重_P2)) / BU荷重MAX) < 0.8 ) { ////////////08/11/17
            For( M77 = 1 To 部材_max
                if ( 下層BUZAI(M77, 1) = 0 ) { Exit For
                if ( 下層BUZAI(M77, 1) = BUZAN ) {
                    Atta = 1
                    Exit For
                }
            Next M77
        }
        if ( Atta = 1 ) { ////////////08/11/17//////08/11/25
            if ( Abs(荷重_P1) > 0 ) {
                YY1 = 部材荷重長さmax / Log(BU荷重MAX * 10 / Log(10) / Abs(荷重_P1)) * Twip * _
                        Sgn(荷重_P1) * FMN * (Abs(荷重_P1) / BU荷重MAX) ^ 0.25 * 1.5 //0.15
            }
            if ( Abs(荷重_P2) > 0 ) {
                Yy2 = 部材荷重長さmax / Log(BU荷重MAX * 10 / Log(10) / Abs(荷重_P2)) * Twip * _
                        Sgn(荷重_P2) * FMN * (Abs(荷重_P2) / BU荷重MAX) ^ 0.25 * 1.5 //0.15
            }
        } else { ////////////08/11/17
                if ( Abs(荷重_P1) > Abs(荷重_P2) ) {
                    YY1 = 部材荷重長さmax / Log(BU荷重MAX * 10 / Log(10) / Abs(荷重_P1)) * Twip * _
                            Sgn(荷重_P1) * FMN * (Abs(荷重_P1) / BU荷重MAX) ^ 0.2 * 1.3
                    if ( Abs(荷重_P2) > 0 ) {
                        Yy2 = 部材荷重長さmax / Log(BU荷重MAX * 10 / Log(10) / Abs(荷重_P2)) * Twip * _
                                 Sgn(荷重_P2) * FMN * (Abs(荷重_P2) / BU荷重MAX) ^ 0.2 * 1.3
                    }
                } else {
                    if ( Abs(荷重_P1) > 0 ) {
                        YY1 = 部材荷重長さmax / Log(BU荷重MAX * 10 / Log(10) / Abs(荷重_P1)) * Twip * _
                                  Sgn(荷重_P1) * FMN * (Abs(荷重_P1) / BU荷重MAX) ^ 0.2 * 1.3
                    }
                    if ( Abs(荷重_P1) = Abs(荷重_P2) ) { ////////13/09/27
                        if ( FR橋脚 = 2 ) { //////14/11/18
                            Yy2 = YY1
                        } else {
                            if ( Abs(荷重_P1) < 2 $$ BU荷重MAX < 2 ) {
                                YY1 = YY1 / 2
                            }
                            if ( Abs(YY1) < 100 $$ 水平垂直 = 1 ) { //////13/11/15
                                YY1 = 100 * Sgn(YY1)
                            }
                            if ( Abs(YY1) > 250 $$ 水平垂直 = 1 $$ (FR橋脚 = 2 || _
                                        InStr(荷重名称(逆実荷重NO(CASU)), "風") != 0) ) { //////14/09/11
                                YY1 = YY1 * 0.75 ////////250 * Sgn(YY1)
                            }
                            if ( 荷重_P1 * 荷重_P2 < 0 ) {
                                Yy2 = YY1 * (-1)
                            } else {
                                Yy2 = YY1
                            }
                            if ( (荷重_P1 = 荷重_P2 $$ 水平垂直 = 0) _
                                $$ ((InStr(荷重名称(逆実荷重NO(CASU)), "列車") != 0 $$ _
                                      InStr(荷重名称(逆実荷重NO(CASU)), "地震") = 0) || _
                                      InStr(荷重名称(逆実荷重NO(CASU)), "衝撃") != 0) || _
                                      InStr(荷重名称(逆実荷重NO(CASU)), "列+衝") != 0 ) {
                                            if ( InStr(荷重名称(逆実荷重NO(CASU)), "風") = 0 $$ (荷重方向5 = "M" || 荷重方向5 = "S") ) {
                                               if ( YY1 > 220 ) { YY1 = 220
                                                Yy2 = YY1
                                            }
                            }
                        } //////14/11/18

                    } else { //////////////////////////////////13/09/27
                        Yy2 = 部材荷重長さmax / Log(BU荷重MAX * 10 / Log(10) / Abs(荷重_P2)) * Twip * _
                                Sgn(荷重_P2) * FMN * (Abs(荷重_P2) / BU荷重MAX) ^ 0.2 * 1.3
                    }
                }
                if ( FR橋脚 != 2 $$ 水平垂直 != 1 ) { //////14/11/18//////15/02/02
                    if ( iKozo = 1 $$ Abs(荷重_P1) = Abs(荷重_P2) $$ (Abs(荷重_P1) / BU荷重MAX) > 0.95 ) { //////13/04/08//////And 荷重方向5 = "V" ) {
                        高さ調整 = Log(BU荷重MAX * 3) / Log(10)
                        高さ調整 = min(高さ調整, 1)
                        if ( 高さ調整 > 0.5 ) { //////////////13/09/27
                        YY1 = YY1 * 高さ調整
                        Yy2 = Yy2 * 高さ調整
                        }
                    } else {if ( iKozo = 1 $$ 水平垂直 = 1 ) { //13/04/08////10/01/18//////And InStr(部材名(BUZAN), "杭") != 0 ) { //////垂直部材 09/04/13
                        YY1 = YY1 * 0.7
                        Yy2 = Yy2 * 0.7
                    }
                }
//                } //////08/11/25////08/11/277
        }
        if ( FR橋脚 != 2 ) { //////14/11/18
        if ( (水平垂直 != 0 $$ FR橋脚 = 2 $$ InStr(部材名(BUZAN), "柱") != 0) ) {  //垂直部材 土圧 09/04/13 10/01/18
            YY1 = YY1 * 1.2
            Yy2 = Yy2 * 1.2
        } else {if ( 水平垂直 = 1 $$ Abs(荷重_P1) != Abs(荷重_P2) $$ 荷重_L1 + 荷重_L2 ) {
            YY1 = YY1 * 1.4
            Yy2 = Yy2 * 1.4
        }
        YY3 = (max(Abs(荷重_P1), Abs(荷重_P2)) / BU荷重MAX) //////14/12/14
        if ( YY3 > 1.5 ) {
            YY1 = YY1 / (YY3 * (YY3 ^ 0.2)) ////////
            Yy2 = Yy2 / (YY3 * (YY3 ^ 0.2))
        }
        if ( YY1 > 400 ) { YY1 = 400
        if ( Yy2 > 400 ) { Yy2 = 400 //////14/12/14
        高さ調整 = (max(Abs(YY1), Abs(Yy2)) / 部材荷重長さmax / Twip) ^ 0.6
//            高さ調整 = 0
        }
    }
    if ( FR橋脚 != 2 ) { //////14/11/18
    if ( BCS = 0 $$ iKozo != 3 $$ Not (iKozo = 1 $$ 水平垂直 != 0) ) { ////////////10/01/18
        YY1 = YY1 * 0.8
        Yy2 = Yy2 * 0.8
    } ////////08/11/24
    }
Case 3
    YY1 = 0
    Yy2 = 0
    if ( Abs(荷重_P1) > 0 ) {
        Yy2 = 部材荷重長さmax / Log(BU荷重MAX * 10 / Log(10) / Abs(荷重_P1)) * Twip * _
               Sgn(荷重_P1) * FMN * (Abs(荷重_P1) / BU荷重MAX) ^ 0.2 * 1.3
    }
    if ( Abs(荷重_P2) > 0 ) {
        YY1 = 部材荷重長さmax / Log(BU荷重MAX * 10 / Log(10) / Abs(荷重_P2)) * Twip * _
                Sgn(荷重_P2) * FMN * (Abs(荷重_P2) / BU荷重MAX) ^ 0.2 * 1.3
    }
    if ( BCS = 0 ) {
        YY1 = YY1 * 0.8
        Yy2 = Yy2 * 0.8
    } ////////08/11/25
    if ( (Abs(荷重_P1) / BU荷重MAX) < 0.35 $$ 荷重_P2 = 0 ) {
        Yy2 = Yy2 * 1.3
    }
Case 5
    if ( BP荷重MAX != 0 ) {
        HOSE1 = max((Abs(荷重_P1) / BP荷重MAX) ^ 0.4, 0.5)
        HOSE2 = max((Abs(荷重_P2) / BP荷重MAX) ^ 0.4, 0.5)
    }
    if ( Abs(荷重_P1) >= 0 ) {
        YY1 = 荷重図初期長さ + HOSE1 * 部材荷重図Scale * Twip * 0.75
        YY1 = min(YY1, 集中荷重長さmax * Twip)
    }
    if ( Abs(荷重_P2) >= 0 ) {
        Yy2 = 荷重図初期長さ + HOSE2 * 部材荷重図Scale * Twip * 0.75
        Yy2 = min(Yy2, 集中荷重長さmax * Twip)
    }
    if ( 水平垂直 = 0 $$ 荷重_P1 < 0 ) {
        YY1 = -YY1 // 水平
    }
    if ( 水平垂直 = 0 $$ 荷重_P2 < 0 ) {
        Yy2 = -Yy2 // 水平
    }
Case 6, 7, 8
    YY1 = 0 //Abs(YY1) * 部材荷重長さmax * Twip
    Yy2 = 0 //Abs(YY2) * 部材荷重長さmax * Twip
Case 9
    if ( Abs(YY1) > 部材荷重長さmax * Twip ) {
        YY1 = Abs(YY1) * 部材荷重長さmax * Twip
    }
    if ( Abs(Yy2) > 部材荷重長さmax * Twip ) {
        Yy2 = Abs(Yy2) * 部材荷重長さmax * Twip
    }
Case } else {
    if ( Abs(YY1) > 部材荷重長さmax * Twip ) {
        YY1 = Sgn(YY1) * 部材荷重長さmax * Twip
    }
    if ( Abs(Yy2) > 部材荷重長さmax * Twip ) {
        Yy2 = Sgn(Yy2) * 部材荷重長さmax * Twip
    }
End Select
*/
        }


        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////09/10/20 荷重方向5
        private void F部材荷重(object obj, int 節点S, int 節点E, double 荷重図開き, string 荷重方向5, int 荷重mark, double 荷重_L1, double 荷重_L2,
                               double 荷重_P1, double 荷重_P2, int BUZAN, int BUZAN9, int TATE_flg, int CASU, double 連続P1, double 連続P2, double 連続P3, int BZA9)
        {   ////////08/06/17 08/07/01
            /*
            // TATE_flg ////// = 1 W1=W2 の時でも縦書きにする
            //
            var 荷重図初期長さ
            var 部材荷重図Scale
            var 荷重図上開き
            var 文字H
            var 文字位置
            var S角度
            var E角度
            var 矢pit
            var 寸法線位置
            var 寸法補助線
            var BSPAN
            var BX0
            var BY0
            var BXE
            var BYE
            var 図BSPAN
            var 図倍率
            var BSN
            var BCS
            var BTAN
            var B角度
            var XX1
            var XX2
            var XX3
            var XXE
            var YY1
            var Yy2
            var YY3
            var PX0
            var PY0
            var PXE
            var PYE
            var PX1D
            var PY1D
            var PX2D
            var PY2D
            var PX3D
            var PY3D
            var PX1
            var PY1
            var PX2
            var PY2
            var PX3
            var PY3
            var LL1
            var SN1
            var CS1
            var LL2
            var SN2
            var CS2
            var LL3
            var SN3
            var CS3
            var PXX1
            var PYY1
            var PXX2
            var PYY2
            var AP12
            var 矢pit2
            var XX
            var JAXX
            var PPXD
            var PPYD
            var PPX
            var PPY
            var YY
            var LL
            var sN
            var CS
            var AP13
            var AP32
            var AP01
            var AP2E
            var YYE
            var PPX1
            var PPY1
            var PPX2
            var PPY2
            var MOJ
            var MR
            var X3
            var Y3
            var X4 As Single
            var Y4 As Single
            var XJ
            var YJ
            var PPX3
            var PPY3
            var PPX4
            var PPY4
            var MOJX
            var MOJY
            var TT
            var DXY
            var w
            var PX13
            var PY13
            var PX23
            var PY23
            var LL13
            var LL23
            var SN13
            var SN23
            var CS13
            var CS23
            var FMN
            var HOSE1
            var HOSE2
            double var GGGF
            var RWR                     As String
            var KEIS                    As Single
            var strAB                   As String
            var PP1                     As Single
            var PP2                     As Single
            var XZ1                     As Single
            var XZ2                     As Single
            var DDDD1                   As Single
            var EnPRM1                  As Single
            var EnPRM2                  As Single
            var EnPRM3                  As Single
            var EnPRM4                  As Single
            var EnPRM5                  As Single
            var EnTYPE1                 As Single
            var 高さ調整                As Single
            var strNum As String //////////07/05/13
            var F88 As String, Hoko As Integer, Hoko8 As Integer, Hoko9 As Integer, Hoko0 As Integer
            var ykuiR As Integer
            var DLA As Single ////////////////07/07/26
            var g文字補正1 As Single, g文字補正2 As Single ////////09/04/02
            var Atta As Integer, M77 As Integer //////////08/11/17
            var wXs As Single, wXe As Single, wYs As Single, wYe As Single //////09/09/300
            var 角度 As Single, 角度FLG As Single, s斜めFLG As Integer //////09/10/20
            var HH率 As Single //////09/10/24
            var y表記FLG As Integer ////////////////09/11/13
            var s斜補正 As Single ////////13/04/07
            //    var k矢印方向 As Integer
            FLG_列車_衝撃 = False
            y表記FLG = 0
            var y荷重高 As Single //////09/11/13
            y荷重高 = 0
            var m荷重表記縦 As Integer ////////10/10/14
            m荷重表記縦 = 0
            //
            Atta = 0
            //
            if ( Abs(荷重_P1) + Abs(荷重_P2) = 0 ) {
                return;
            }
            //
            g文字補正1 = Abs(荷重_P1) / BU荷重MAX ////////09/04/02
            g文字補正2 = Abs(荷重_P2) / BU荷重MAX ////////09/04/02
            obj.PenColor = QBColor(部材荷重Pen色)
            obj.FontSize = 部材荷重Fontsize
            obj.PenWidth = 部材荷重Pen幅
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(obj.PenWidth))
            }
            S角度 = -45 * π / 180
            E角度 = 225 * π / 180
            矢pit = 3 * Twip  //部材荷重矢印のピッチ 3mm
            BSPAN = 部材Span(節点S, 節点E)
            ////////09/09/300
            var ii As Integer, i7 As Integer, i8 As Integer //////09/10/14
            wXs = 節X(節点S)
            wXe = 節X(節点E)
            wYs = 節Y(節点S)
            wYe = 節Y(節点E)
            var 荷重方向 ////////09/10/20
            荷重方向 = 荷重方向5
            var 荷重方向4 //////////////////////////////////13/04/08
            if ( 荷重_P1 = 荷重_P2 ) {
                荷重方向4 = 荷重方向5
            } else {
                荷重方向4 = ""
            }
            var KAJY方向2 As Integer ////////10/03/07
            KAJY方向2 = 1
            s斜めFLG = 0
            //////////////////////////////////////////////////////////////////////////////09/10/20//////////////////////////////////
            if ( 荷重mark = 2 $$ (Abs(BUZAN9 - BUZAN) > 1 || BuzaiFF > 0) $$ _
                                (荷重方向 = "V" || 荷重方向 = "M") ) { ////////09/09/301
                角度FLG = 1 //////09/10/20 ////////12/12/17
                if ( 荷重_P1 + 荷重_P2 > 0 ) {
                    KAJY方向2 = 1
                    Y4 = max(wYs * KAJY方向2, wYe * KAJY方向2)
                    if ( BuzaiFF > 0 ) { //////09/10/14
                        角度 = SuiHeiAngX(GGGGG(1)) //////09/10/20
                        For( i8 = 1 To BuzaiFF
                            i7 = GGGGG(i8)
                            PP1 = 部I(i7): Y4 = max(Y4, 節Y(PP1) * KAJY方向2)
                            PP1 = 部J(i7): Y4 = max(Y4, 節Y(PP1) * KAJY方向2)
                            if ( Abs(角度 - SuiHeiAngX(i7)) > 0.6 ) { //////09/11/22
                                角度FLG = 0 ////////12/12/17
                            }
                            角度 = SuiHeiAngX(i7) //////09/11/22
                        }8
                    } else {
                        角度 = SuiHeiAngX(BUZAN)
                        For( i7 = BUZAN To BUZAN9
                            PP1 = 部I(i7): Y4 = max(Y4, 節Y(PP1) * KAJY方向2)
                            PP1 = 部J(i7): Y4 = max(Y4, 節Y(PP1) * KAJY方向2)
                            if ( Abs(角度 - SuiHeiAngX(i7)) > 0.6 ) { //////09/11/22
                                角度FLG = 0 ////////12/12/17
                            }
                            角度 = SuiHeiAngX(i7) //////09/11/22
                        }7
                    }
                } else {
                    KAJY方向2 = -1
                    Y4 = min(wYs, wYe)
                    角度FLG = 1 ////////////////荷重を水平に12/12/17
                    if ( BuzaiFF > 0 ) { //////09/10/14
                        角度 = SuiHeiAngX(GGGGG(1)) //////09/10/20
                        For( i8 = 1 To BuzaiFF
                            i7 = GGGGG(i8)
                            PP1 = 部I(i7): Y4 = min(Y4, 節Y(PP1))
                            PP1 = 部J(i7): Y4 = min(Y4, 節Y(PP1))
                            if ( Abs(角度 - SuiHeiAngX(i7)) > 0.6 ) { //////09/11/22
                                角度FLG = 0 ////////12/12/17
                            }
                            角度 = SuiHeiAngX(i7) //////09/11/22
                        }8
                    } else {
                        角度 = SuiHeiAngX(BUZAN)
                        For( i7 = BUZAN To BUZAN9
                            PP1 = 部I(i7): Y4 = min(Y4, 節Y(PP1))
                            PP1 = 部J(i7): Y4 = min(Y4, 節Y(PP1))
                            if ( Abs(角度 - SuiHeiAngX(i7)) > 0.6 ) { //////09/11/22
                                角度FLG = 0 ////////12/12/17
                            }
                            角度 = SuiHeiAngX(i7) //////09/11/22
                        }7
                    }
                }

            //
                if ( g角度一連 = True ) {
                    if ( 荷重方向5 != "M" ) { 荷重方向 = "" ////////09/11/13
                    if ( 角度FLG = 0 ) { //////09/10/20
                        s斜めFLG = 1 //////09/10/20
                    } else {
                        if ( (Abs(荷重_P1) / BU荷重MAX) > 0.9 $$ 部材正荷重数(BUZAN) > 25 ) {
                            wYs = Y4 - Round(min(Abs(wYs - wYe) / 2, 0.3), 3)
                            wYe = Y4 - Round(min(Abs(wYs - wYe) / 2, 0.3), 3)
                        } else {
                            if ( 部材正荷重数(BUZAN) < 20 ) {
                                wYs = Y4 + Round(min(Abs(wYs - wYe), 0.6), 3)
                                wYe = Y4 + Round(min(Abs(wYs - wYe), 0.6), 3)
                            } else {
                                wYs = Y4
                                wYe = Y4
                            }
                        }
                        wYs = Y4 //////12/12/17
                        wYe = Y4
                    }
                } else {
            //            if ( 荷重方向5 != "M" ) { 荷重方向 = "" ////////09/11/13
                    if ( 荷重mark = 2 $$ (荷重方向5 = "V" || 荷重方向5 = "M") ) { //////10/03/07
                        s斜めFLG = 1
                    }
                    wYs = Y4 // + (部材正荷重数(BUZAN))
                    wYe = Y4 // + (部材正荷重数(BUZAN)) // / Twip)
                }
            } else {if ( 荷重mark = 2 $$ (荷重方向5 = "V" || 荷重方向5 = "M") ) {
                if ( 角度FLG = 0 ) { //////09/10/20
                    if ( 荷重方向5 = "V" ) { 荷重方向 = "" ////////09/11/13
                    s斜めFLG = 1 //////09/10/20
                }
            } else {if ( 荷重mark = 2 $$ 荷重方向5 = "H" ) { //////////10/03/07
                    if ( 荷重_P1 + 荷重_P2 > 0 ) {
                        X4 = min(wXs, wXe)
                        if ( BuzaiFF > 0 ) {
                            For( i8 = 1 To BuzaiFF
                                i7 = GGGGG(i8)
                                PP1 = 部I(i7): X4 = min(X4, 節X(PP1))
                                PP1 = 部J(i7): X4 = min(X4, 節X(PP1))
                            }8
                        } else {
                            For( i7 = BUZAN To BUZAN9
                                PP1 = 部I(i7): X4 = min(X4, 節X(PP1))
                                PP1 = 部J(i7): X4 = min(X4, 節X(PP1))
                            }7
                        }
                    } else { //////////10/03/07
                        X4 = max(wXs, wXe)
                        if ( BuzaiFF > 0 ) { //////09/10/14
                            For( i8 = 1 To BuzaiFF
                                i7 = GGGGG(i8)
                                PP1 = 部I(i7): X4 = max(X4, 節X(PP1))
                                PP1 = 部J(i7): X4 = max(X4, 節X(PP1))
                            }8
                        } else {
                            For( i7 = BUZAN To BUZAN9
                                PP1 = 部I(i7): X4 = max(X4, 節X(PP1))
                                PP1 = 部J(i7): X4 = max(X4, 節X(PP1))
                            }7
                        }
                    }
                    wXs = X4 //
                    wXe = X4
            }
            BX0 = 図X(wXs)
            BY0 = 図Y(wYs)
            BXE = 図X(wXe)
            BYE = 図Y(wYe)
            図BSPAN = Sqr((BXE - BX0) ^ 2 + (BY0 - BYE) ^ 2)
            s斜補正 = 1
            if ( Abs(BX0 - BXE) > 0 ) { s斜補正 = 図BSPAN / (BX0 - BXE) ////////13/04/07
            HH率 = 1
            if ( BY0 != BYE ) {
                HH率 = 図BSPAN / (BYE - BY0) //////09/10/24
            }
            ////////09/09/300
            if ( 荷重mark = 6 || 荷重mark = 7 || 荷重mark = 8 ) {
                荷重方向 = ""
            }
            Select Case 荷重方向
            Case "V", "M", "S"
                BSPAN = Round(Abs(節X0(節点S) - 節X0(節点E)), 3)
                if ( BY0 = BYE ) {
                    BY0 = max(BY0, 図Y(節Y(Int((節点S + 節点E) / 2)))) ////////////////////06/01/25
                }
                BY0 = max(BY0, BYE)
                BYE = BY0
            Case "H"
                BSPAN = Round(Abs(節Y0(節点S) - 節Y0(節点E)), 3)
                if ( (BX0 + BXE) / 2 < (JX_max + JX_min) / 2 ) {
                    BX0 = min(BX0, BXE)
                } else {
                    BX0 = max(BX0, BXE)
                }
                BXE = BX0
            Case } else {
                if ( s斜めFLG = 1 ) { //////09/10/20 "V"
                    図BSPAN = Abs(BXE - BX0)
                } else {if ( s斜めFLG = 2 ) { //////09/10/24 "H"
                    図BSPAN = Abs(BYE - BY0)
                }
            End Select
            if ( s斜めFLG = 1 ) { //////////09/10/24
                BSPAN = Round(Abs(節X0(節点S) - 節X0(節点E)), 3)
            } else {if ( s斜めFLG = 2 ) {
                BSPAN = Round(Abs(節Y0(節点S) - 節Y0(節点E)), 3)
            }
            水平垂直 = 9
            if ( BX0 = BXE || 荷重方向5 = "H" ) {
                水平垂直 = 1 // 垂直
            }
            if ( BY0 = BYE ) {
                水平垂直 = 0 // 水平
            }
            //
            if ( 水平垂直 = 9 ) {
                if ( Abs((BYE - BY0) / (BXE - BX0)) < 0.02 ) { 水平垂直 = 0 ////// 05/05/21
            }
            //
            DLA = 1
            if ( 水平垂直 = 9 ) {
            //        DLA = min(1, (BYE - BY0) / (BXE - BX0)) //////09/10/20//////////07/07/26
                DLA = min(1, Abs((BYE - BY0) / (BXE - BX0))) //////13/04/08
            }
            //
            if ( (InStr(荷重名称(逆実荷重NO(CASU)), "風圧") != 0 $$ アーチBOX) $$ 水平垂直 != 9 ) { //////10/03/07
                水平垂直 = 9
                if ( (BXE - BX0) != 0 ) {
                    DLA = min(1, Abs((BYE - BY0) / (BXE - BX0))) //////13/04/08
                } else {
                    DLA = 0
                }
            }
            //
            if ( s斜めFLG = 1 || s斜めFLG = 2 ) { ////////09/10/24
                DLA = 1
            }
            //
            //    図BSPAN = Sqr((BXE - BX0) ^ 2 + (BYE - BY0) ^ 2)
            if ( 図BSPAN <= 0 ) {
                図BSPAN = 1
            }
            if ( BSPAN = 0 ) {
                図倍率 = 0
            } else {
                図倍率 = 図BSPAN / BSPAN
            }
            BSN = (BYE - BY0) / 図BSPAN
            BCS = (BXE - BX0) / 図BSPAN
            BTAN = 0
            if ( BX0 != BXE ) {
                BTAN = (BYE - BY0) / (BXE - BX0)
            }
            B角度 = 180 * Atn(BTAN) / π
            if ( BX0 > BXE ) {
                B角度 = B角度 + 180
            }
            if ( BX0 = BXE ) {
                B角度 = 90
                if ( BYE < BY0 ) {
                    B角度 = 270
                }
            }
            荷重図初期長さ = 部材荷重初期値 * Twip * 1.2
            if ( iKozo = 3 ) {
                部材荷重図Scale = 部材荷重Scale * 0.8
            //        部材荷重図Scale = 集中荷重Scale * 0.8//////14/08/17
            } else {
                部材荷重図Scale = 部材荷重Scale
            //        部材荷重図Scale = 集中荷重Scale
            }
            if ( 荷重mark = 3 $$ 荷重_P1 = 0 ) {
                荷重mark = 2
                荷重_P1 = 荷重_P2
            }
            Select Case 荷重mark
            Case 1, 5, 11
                XX1 = 図倍率 * Abs(荷重_L1)
                XX2 = 図倍率 * Abs(荷重_L2)
                XX3 = (XX1 + XX2) / 2
            Case 2, 3, 4
                XX1 = 図倍率 * 荷重_L1
                XX2 = 図BSPAN - 図倍率 * 荷重_L2
                XX3 = (XX1 + XX2) / 2
            Case 6, 7, 8
                if ( 荷重_L1 + 荷重_L2 = 0 ) {
                    XX1 = 0.35 * 図BSPAN
                    XX2 = 0.65 * 図BSPAN
                    XX3 = (XX1 + XX2) / 2
                } else {
                    w = frmPrint.vsPrt1.TextWidth(F2(荷重_P1)) //kore
                    XX1 = 図倍率 * Abs(荷重_L1)
                    XX2 = 図BSPAN - 図倍率 * Abs(荷重_L2)
                    if ( w * 3 < Abs(XX2 - XX1) ) {
                        XX3 = (XX1 + XX2) / 2
                        XX1 = XX3 - w * 1.2
                        XX2 = XX3 + w * 1.2
                    }
                }
            Case } else {
                XX1 = 0
                XX2 = 0
                XX3 = 0
            End Select
            if ( FR橋脚 = 1 ) {
                FMN = 1.47
            } else {
                if ( InStr(部材名(BUZAN), "杭") != 0 ) { //////08/11/17
                    FMN = 1.55
                } else {
                    FMN = 2
                }
            }
            XXE = 図BSPAN
            YY1 = 0
            Yy2 = 0
            this.F2部材荷重高(荷重mark, 荷重_P1, 荷重_P2, YY1, Yy2, 荷重図初期長さ, 部材荷重図Scale, KAJY方向2, _
                              高さ調整, 水平垂直, HOSE1, HOSE2, FMN, 荷重_L1, 荷重_L2, 節点S, 節点E, CASU, BUZAN, Atta, BCS, 荷重方向5)
            //
            //    if ( (荷重mark = 2 || 荷重mark = 3 || 荷重mark = 4) $$ (YY1 > 200 || Yy2 > 200) ) { ////////13/11/22
            //        YY1 = YY1 * 0.7
            //        Yy2 = Yy2 * 0.7
            //    }
            if ( InStr(部材名(BUZAN), "杭") != 0 ) { //////17/05/02
                YY1 = YY1 * 0.6
                Yy2 = Yy2 * 0.6
            }
            ////////////////////////////////////////////////////////////
            YY3 = YY1 + Yy2
            if ( 荷重mark = 3 ) { ////////09/11/13
                Yy2 = YY1
                y荷重高 = Abs(YY3)
            } else {if ( 荷重mark = 2 || 荷重mark = 4 ) {
                y荷重高 = max(y荷重高, Abs(YY1))
                y荷重高 = max(y荷重高, Abs(Yy2)) ////////09/11/13
            }
            //------------------------------
            if ( 荷重mark = 5 ) {
                PX0 = HEN_X(wXs)
                PY0 = HEN_Y(wYs) - IIf(N段数 = 1 $$ 水平垂直 = 0, 0, 荷重図開き - 荷重図上盛上げ初期値 * Twip) ////////10/04/04
                if ( 水平垂直 = 1 $$ RR橋脚 = 1 ) {
                    PX0 = HEN_X(wXs) - 荷重図開き * BCS
                    PY0 = HEN_Y(wYs) - 荷重図開き * BCS
                }
                PXE = HEN_X(wXe) - 荷重図開き * BSN ////////08/09/26
                PYE = HEN_Y(wYe) - 荷重図開き * BCS
            } else {
                if ( s斜めFLG = 1 ) { //////09/10/20
                    PX0 = HEN_X(wXs) - 荷重図開き * 0 ////////08/09/26
                    PY0 = HEN_Y(wYs) - 荷重図開き * 1 // * KAJY方向2
                    PXE = HEN_X(wXe) - 荷重図開き * 0
                    PYE = HEN_Y(wYe) - 荷重図開き * 1 // * KAJY方向2
                } else {if ( s斜めFLG = 2 ) { //////09/10/24
                    PX0 = HEN_X(wXs) - 荷重図開き * HH率
                    PY0 = HEN_Y(wYs) - 荷重図開き * 0
                    PXE = HEN_X(wXe) - 荷重図開き * HH率
                    PYE = HEN_Y(wYe) - 荷重図開き * 0
                } else {
                    PX0 = HEN_X(wXs) - 荷重図開き * BSN / IIf(荷重mark = 6, 1.5, 1) ////////08/09/26
                    PY0 = HEN_Y(wYs) - 荷重図開き * BCS / IIf(荷重mark = 6, 1.5, 1)
                    PXE = HEN_X(wXe) - 荷重図開き * BSN / IIf(荷重mark = 6, 1.5, 1)
                    PYE = HEN_Y(wYe) - 荷重図開き * BCS / IIf(荷重mark = 6, 1.5, 1)
                }
            }
            if ( 荷重方向 = "V" || 荷重方向 = "M" || 荷重方向 = "S" ) {
            //        if ( PY0 = PYE $$ s斜めFLG != 1 ) { ////////10/03/07
            //        if ( (BY0 = BYE $$ Round((BY0 + BYE) / 2, 3) != 図Y(節Y(Int((節点S + 節点E) / 2)))) ) { //////////06/01/26
            //            PY0 = min(PY0, HEN_Y(節Y(Int((節点S + 節点E) / 2))) - 荷重図開き * BCS * 3) //////////06/01/26
            //            PYE = min(PYE, HEN_Y(節Y(Int((節点S + 節点E) / 2))) - 荷重図開き * BCS * 3)
            //        }
                if ( (荷重_P1 >= 0 $$ 荷重_P2 >= 0) || 荷重mark = 1 ) { ////////////07/01/09
                    PY0 = min(PY0, PYE)
                    PYE = min(PY0, PYE)
                } else {
                    PY0 = max(PY0, PYE)
                    PYE = max(PY0, PYE)
                }
            }
            if ( 荷重方向 = "H" ) {
                if ( 荷重_P1 > 0 $$ 荷重_P2 > 0 ) {
                    PX0 = min(PX0, PXE) - 荷重図開き - 80 //////10/03/03  10/03/07
                    PXE = min(PX0, PXE) - 荷重図開き - 80
                } else {
                    if ( (JX_max + JX_min) / 2 < (wXs + wXe) / 2 ) { //////09/10/24
                        PX0 = max(PX0, PXE) + 部材荷重長さmax * Twip
                        PXE = max(PX0, PXE) + 部材荷重長さmax * Twip
                    } else {
                        PX0 = max(PX0, PXE)
                        PXE = max(PX0, PXE)
                    }
                }
            } else {if ( s斜めFLG = 2 ) { //////////////09/10/24
                if ( (JX_max + JX_min) / 2 < (wXs + wXe) / 2 $$ 荷重_P1 + 荷重_P2 > 0 ) { //////09/10/24
                    PX0 = PX0 - max(YY1, Yy2) - 40
                    PXE = PX0 - max(YY1, Yy2) - 40
                }
            }
            if ( 水平垂直 != 1 $$ 荷重mark = 2 $$ 荷重_P1 * 荷重_P2 < 0 ) { //////////逆符号 07/02/04
            //        if ( (YY_max + YY_min) / 2 <= (wYs + wYe) / 2 ) { //////08/10/29
            //            PY0 = PY0 - max(Abs(YY1), Abs(Yy2)) //////09/12/04
            //            PYE = PYE - max(Abs(YY1), Abs(Yy2))
            //        } else {
            //            PY0 = PY0 + max(YY1, Yy2)
            //            PYE = PYE + max(YY1, Yy2)
            //        }
                YY = 部材荷重長さmax / Log(BU荷重MAX * 10 / Log(10) / BU荷重MAX) * Twip * 1.5 //////11/12/155
                PY0 = PY0 - YY * Sgn(荷重図開き)
                PYE = PYE - YY * Sgn(荷重図開き)
            }

            if ( (荷重mark = 6 || 荷重mark = 7 || 荷重mark = 8) $$ 水平垂直 = 9 $$ BCS * BSN > 0 ) { ////// 08/05/22
                PX1D = XX1
                XX1 = XX2
                XX2 = PX1D
            }
            //    if ( s斜めFLG = 1 ) { //////And s斜めFLG != 1 ) { //////09/10/20
            //        PX1D = PX0 + XX1 * 1
            //        PY1D = PY0 - XX1 * BSN
            //        PX2D = PX0 + XX2 * 1
            //        PY2D = PY0 - XX2 * BSN
            //        PX3D = PX0 + XX3 * 1
            //        PY3D = PY0 - XX3 * BSN
            //    } else {
            //        PX1D = PX0 + XX1 * BCS
            //        PY1D = PY0 - XX1 * BSN
            //        PX2D = PX0 + XX2 * BCS
            //        PY2D = PY0 - XX2 * BSN
            //        PX3D = PX0 + XX3 * BCS
            //        PY3D = PY0 - XX3 * BSN
            //    }
            if ( s斜めFLG = 1 || s斜めFLG = 0 ) { //////////10/03/07
                PX1D = PX0 + XX1 * BCS
                PY1D = PY0 - XX1 * BSN
                PX2D = PX0 + XX2 * BCS
                PY2D = PY0 - XX2 * BSN
                PX3D = PX0 + XX3 * BCS
                PY3D = PY0 - XX3 * BSN
            } else {
                PX1D = PX0 + XX1 * 1
                PY1D = PY0 - XX1 * BSN
                PX2D = PX0 + XX2 * 1
                PY2D = PY0 - XX2 * BSN
                PX3D = PX0 + XX3 * 1
                PY3D = PY0 - XX3 * BSN //////////10/03/07
            }
            //
            if ( 荷重方向 = "S" $$ 荷重_P1 = 荷重_P2 ) {
                PY0 = PY0 - 部材荷重Fontsize
                PY1D = PY1D + 荷重図開き - 部材荷重Fontsize * Twip / 2
                PY2D = PY2D + 荷重図開き - 部材荷重Fontsize * Twip / 2
                PY3D = PY3D + 荷重図開き - 部材荷重Fontsize * Twip / 2
            }
            Select Case 荷重方向
            Case "V", "M", "S"
                PX1 = PX1D
                PY1 = PY1D - YY1
                PX2 = PX2D
                PY2 = PY2D - Yy2
                PX3 = PX3D
                PY3 = PY3D - YY3
                PX13 = PX1D
                PY13 = PY1D - YY3
                PX23 = PX2D
                PY23 = PY2D - YY3
            Case "H"
                PX1 = PX1D - YY1
                PY1 = PY1D
                PX2 = PX2D - Yy2
                PY2 = PY2D
                PX3 = PX3D - YY3
                PY3 = PY3D
                PX13 = PX1D - YY3
                PY13 = PY1D
                PX23 = PX2D - YY3
                PY23 = PY2D
            Case } else {
                if ( s斜めFLG = 1 ) { //////09/10/20
                    LL1 = max(1, (Abs(BSN) ^ 0.5))
                    PX1 = PX1D
                    PY1 = PY1D - YY1 * LL1
                    PX2 = PX2D
                    PY2 = PY2D - Yy2 * LL1
                    PX3 = PX3D
                    PY3 = PY3D - YY3 * LL1
                    PX13 = PX1D
                    PY13 = PY1D - YY3 * LL1
                    PX23 = PX2D
                    PY23 = PY2D - YY3 * LL1
                } else {if ( s斜めFLG = 2 ) { ////////////////09/10/24
                    LL1 = max(0.8, (Abs(BCS)) ^ 0.5)
                    PX1 = PX1D - YY1 * LL1
                    PY1 = PY1D
                    PX2 = PX2D - Yy2 * LL1
                    PY2 = PY2D
                    PX3 = PX3D - YY3 * LL1
                    PY3 = PY3D
                    PX13 = PX1D - YY3 * LL1
                    PY13 = PY1D
                    PX23 = PX2D - YY3 * LL1
                    PY23 = PY2D
                } else {
                    LL1 = Sqr(XX1 ^ 2 + YY1 ^ 2)
                    if ( LL1 != 0 ) {
                        SN1 = YY1 / LL1
                        CS1 = XX1 / LL1
                    }
                    LL2 = Sqr(XX2 ^ 2 + Yy2 ^ 2)
                    if ( LL2 != 0 ) {
                        SN2 = Yy2 / LL2
                        CS2 = XX2 / LL2
                    }
                    LL3 = Sqr(XX3 ^ 2 + YY3 ^ 2)
                    if ( LL3 != 0 ) {
                        SN3 = YY3 / LL3
                        CS3 = XX3 / LL3
                    }
                    LL13 = Sqr(XX1 ^ 2 + YY3 ^ 2)
                    if ( LL13 != 0 ) {
                        SN13 = YY3 / LL13
                        CS13 = XX1 / LL13
                    }
                    LL23 = Sqr(XX2 ^ 2 + YY3 ^ 2)
                    if ( LL23 != 0 ) {
                        SN23 = YY3 / LL23
                        CS23 = XX2 / LL23
                    }
                    PX1 = PX0 + LL1 * (BCS * CS1 - BSN * SN1)
                    PY1 = PY0 - LL1 * (BSN * CS1 + BCS * SN1)
                    PX2 = PX0 + LL2 * (BCS * CS2 - BSN * SN2)
                    PY2 = PY0 - LL2 * (BSN * CS2 + BCS * SN2)
                    PX3 = PX0 + LL3 * (BCS * CS3 - BSN * SN3)
                    PY3 = PY0 - LL3 * (BSN * CS3 + BCS * SN3)
                    PX13 = PX0 + LL13 * (BCS * CS13 - BSN * SN13)
                    PY13 = PY0 - LL13 * (BSN * CS13 + BCS * SN13)
                    PX23 = PX0 + LL23 * (BCS * CS23 - BSN * SN23)
                    PY23 = PY0 - LL23 * (BSN * CS23 + BCS * SN23)
                }
            End Select
            if ( Flg_PRESTRES(1) = 1 || Flg_PRESTRES(2) = 1 ) { hosei = 0 //////08/06/055
            if ( 荷重mark = 1 $$ hosei = 0 ) {
                荷重図上開き = Abs((荷重寸法線位置(1) + hosei) * Twip) - Abs(YY1)
            } else {
                荷重図上開き = Abs((荷重寸法線位置(2) + hosei) * Twip) - Abs(YY1)
            }
            文字H = obj.TextHeight("W") //if ( 荷重図開き < 0 ) { 文字H = 2 * 文字H
            PP1 = Abs(荷重_P1)
            PP2 = Abs(荷重_P2)
            Select Case 荷重mark
            Case 1   // 部材直角方向集中荷重 1111
            //////////////////////////////////////////////////////////////////////////////////////////////////////09/11/15
            var X77 As Single ////////14/11/16
                if ( (FR橋脚 = 1 || iKozo = 2) $$ 水平垂直 = 1 ) { //02/04/18
                    if ( 荷重_P1 > 0 ) {
                        X77 = (PX1 - PX1D) * 1.8 + 1600 * 0
                        PX1 = PX1 - X77
                        PX2 = PX2 - X77
                        PX1D = PX1D - X77
                        PX2D = PX2D - X77
                    } else {
                        PX1 = PX1 + 1.5 * Twip
                        PX2 = PX2 + 1.5 * Twip
                        PX1D = PX1D + 1.5 * Twip
                        PX2D = PX2D + 1.5 * Twip
                    }
                }
                if ( InStr(荷重名称(逆実荷重NO(CASU)), "電柱") != 0 $$ iKozo = 1 $$ 水平垂直 != 1 $$ N段数 = 1 ) { //////13/04/30
                    PY1 = PY1 - 350
                    PY1D = PY1D - 250
                    PY2 = PY2 - 350
                    PY2D = PY2D - 250
                }
                if ( 荷重_P1 != 0 ) {
                    obj.PenWidth = 部材荷重Pen幅 + 6
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(obj.PenWidth))
                    }
                    DrawLinePrt obj, PX1, PY1, PX1D, PY1D
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(PX1), CSng(PY1), CSng(PX1D), CSng(PY1D))
                    }
                    obj.PenWidth = 部材荷重Pen幅
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(obj.PenWidth))
                    }
                    if ( 荷重_P1 > 0 ) {
                        this.荷重矢印(PX1, PY1, PX1D, PY1D)
                    } else {
                        this.荷重矢印(PX1D, PY1D, PX1, PY1)
                    }
                    if ( 水平垂直 = 1 ) { ////////////////////////////////////09/09/08
            //                if ( strUN = "" ) {
            //                    strNum = " P=" + F2(PP1)
            //                } else {
                            strNum = " " + F2(PP1) & strUN
            //                }
                    } else {
                        if ( 荷重_P1 > 0 ) { //////////////////////////////////////////////12/09/15
                            strNum = " " + F2(荷重_P1) & strUN
                        } else {
                            strNum = F2(荷重_P1) & strUN
                        }
                        if ( (水平垂直 = 0 || 荷重方向5 = "V" || 荷重方向5 = "M") $$ (g連続Mod = False $$ 階段Mod = False) ) {
                            s荷重位置 = min(s荷重位置, PY1) + 300 //////13/04/20
                            s荷重位置 = min(s荷重位置, PY1D) + 300
                        }
                    }
                    if ( 水平垂直 != 1 $$ Abs(PX1D - XY集中(1)) < 100 + ((荷重文字サイズ - 4) * Twip / 4) _
                                            $$ Abs(PY1D - XY集中(2)) < 100 ) { ////////11/12/16
                        PX1 = max((PX1 + 100), (XY集中(1) + 80)) + ((荷重文字サイズ - 4) * Twip / 4)
                        PX1D = max((PX1D + 100), (XY集中(1) + 80)) + ((荷重文字サイズ - 4) * Twip / 4)
                    } else {
                        PX1D = PX1D - 10 //////12/09/25
                        PX1 = PX1 - 10
                    }
                    m荷重表記縦 = 1 //////08/10/29
                    if ( 荷重方向 = "H" $$ PX1D > PX1 ) { ////////////////////////////////////////////////////07/01/08
                        this.MOJ2L("D上", PX1, PY1D, PX1D, PY1, strNum)
                    } else {
                        this.MOJ2L("D上", PX1D, PY1D, PX1, PY1, strNum)
                    }
            //12/08/21　コメントにした
            //            if ( 荷重_L1 = 0 $$ N段数 = 1 ) { //////10/04/04
            //                節点荷重段数(節点S, 1) = 節点荷重段数(節点S, 1) + 1 + (Abs(荷重_P1) / BP荷重MAX) / 4 ////////08/01/311 09/04/13
            //            }
                    if ( 水平垂直 != 1 ) { ////////11/12/16
                        XY集中(1) = PX1D
                        XY集中(2) = PY1D
                    }
                }
                if ( 荷重_P2 != 0 ) {
                    obj.PenWidth = 部材荷重Pen幅 + 6
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(obj.PenWidth))
                    }
                    DrawLinePrt obj, PX2, PY2, PX2D, PY2D
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(PX2), CSng(PY2), CSng(PX2D), CSng(PY2D))
                    }
                    obj.PenWidth = 部材荷重Pen幅
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(obj.PenWidth))
                    }
                    if ( 荷重_P2 > 0 ) {
                        this.荷重矢印(PX2, PY2, PX2D, PY2D)
                    } else {
                        this.荷重矢印(PX2D, PY2D, PX2, PY2)
                    }
                    if ( 水平垂直 = 1 ) { ////////////////////////////////////09/09/08
            //                if ( strUN = "" ) {
            //                    strNum = " P=" + F2(PP2)
            //                } else {
                            strNum = " " + F2(PP2) & strUN
            //                }
                    } else {
                        if ( 荷重_P2 > 0 ) { ////////////////////////////////////12/09/15
                            strNum = " " + F2(荷重_P2) & strUN
                        } else {
                            strNum = F2(荷重_P2) & strUN
                        }
                        if ( (水平垂直 = 0 || 荷重方向5 = "V" || 荷重方向5 = "M") $$ (g連続Mod = False $$ 階段Mod = False) ) {
                            s荷重位置 = min(s荷重位置, PY2) + 300 //////13/04/20
                            s荷重位置 = min(s荷重位置, PY2D) + 300
                        }
                    }
                    if ( 水平垂直 != 1 $$ Abs(PX2D - XY集中(1)) < 100 + ((荷重文字サイズ - 4) * Twip / 3.5) _
                                        $$ Abs(PY2D - XY集中(2)) < 100 ) { ////////11/12/16
                        PX2 = PX2 + 100 + ((荷重文字サイズ - 4) * Twip / 3.5)
                        PX2D = PX2D + 100 + ((荷重文字サイズ - 4) * Twip / 3.5)
                    } else {
                        PX2D = PX2D - 10 //////12/09/25
                        PX2 = PX2 - 10
                    }
                    m荷重表記縦 = 1 //////08/10/29
                    if ( 荷重方向 = "H" $$ PX2D > PX2 ) { ////////////////////////////////////////////////////07/01/08
                        this.MOJ2L("D上", PX2, PY2D, PX2D, PY2, strNum)
                    } else {
                        this.MOJ2L("D上", PX2D, PY2D, PX2, PY2, strNum)
                    }
            //12/08/21　コメントにした
            //            if ( 荷重_L2 = (wXe - wXs) $$ N段数 = 1 ) { //////10/04/04
            //                節点荷重段数(節点E, 1) = 節点荷重段数(節点E, 1) + 1 + (Abs(荷重_P2) / BP荷重MAX) / 4 ////////08/01/311 09/04/13
            //            }
                    if ( 水平垂直 != 1 ) { ////////11/12/16
                        XY集中(1) = PX2D
                        XY集中(2) = PY2D
                    }
                }
                if ( (JX_max = JX_min) ) { ////////////////////////////////////////////////////////////////////04/07/20
                   垂直左右 = 垂直左右 + BSN * (荷重_P1 + 荷重_P2)
                }
            //
            Case 2   // 部材直角方向分布荷重 2222
                var wFlg As Integer
                var yFLG As Integer ////////08/07/01
                var FLGKK As Single ////////10/03/18
                var FLGKK5 As Single
                FLGKK5 = 0
                var strGGG As String //////12/11/27
                var FLG_側圧 As Integer //////13/04/08
                FLG_側圧 = 0
                FLGKK = 0
            //
                if ( (InStr(荷重名称(逆実荷重NO(CASU)), "浮力") != 0 || InStr(荷重名称(逆実荷重NO(CASU)), "揚") != 0) _
                                                $$ 水平垂直 = 0 ) { //////17/02/28
                    PY0 = PY0 + 80
                    PY1 = PY1 + 80
                    PY2 = PY2 + 80
                    PY1D = PY1D + 80
                    PY2D = PY2D + 80
                    PYE = PYE + 80
                }
                if ( ((InStr(荷重名称(逆実荷重NO(CASU)), "列車") != 0 $$ _
                    InStr(荷重名称(逆実荷重NO(CASU)), "地震") = 0) || _
                    InStr(荷重名称(逆実荷重NO(CASU)), "衝撃") != 0) || _
                    InStr(荷重名称(逆実荷重NO(CASU)), "列+衝") != 0 ) { ////////13/08/08
                        if ( InStr(荷重名称(逆実荷重NO(CASU)), "風") = 0 $$ (荷重方向5 = "M" || 荷重方向5 = "S") ) {
                            FLG_列車_衝撃 = True
                        }
                }
                if ( FLG車両ZU = True ) {
                    FLG_列車_衝撃 = True
                } else {if ( (荷重_P1 != 荷重_P2) ) {
                    FLG_列車_衝撃 = False
                }
                if ( (荷重_P1 = 荷重_P2) $$ (荷重_P1 < 0 $$ 荷重_P2 < 0) $$ _
                            (InStr(荷重名称(逆実荷重NO(CASU)), "風圧") = 0 $$ アーチBOX) ) {
                    FLGKK5 = Abs(PY0 - PY1) / 2
                    PY0 = PY0 + FLGKK5
                    PY1 = PY1 + FLGKK5
                    PY2 = PY2 + FLGKK5
                    PY1D = PY1D + FLGKK5
                    PY2D = PY2D + FLGKK5
                    PYE = PYE + FLGKK5
            //            荷重_P1 = -荷重_P1
            //            荷重_P2 = -荷重_P2
                } else {if ( 荷重図上開き > 0 $$ (荷重_P1 * 荷重_P2 = 0) $$ (wYs = wYe) ) { ////////(荷重_P1 + 荷重_P2 = 0) ) {
            //            FLGKK5 = -130 * 4 //////////17/01/16 コメントにした
            //            PY0 = PY0 + FLGKK5
            //            PY1 = PY1 + FLGKK5
            //            PY2 = PY2 + FLGKK5
            //            PY1D = PY1D + FLGKK5
            //            PY2D = PY2D + FLGKK5
            //            PYE = PYE + FLGKK5
                }
                wFlg = 0
            ////////09/12/02 if ( 下床文字表示 = 1 ) { ////09/12/03
                if ( 水平垂直 != 1 $$ (荷重_P1 != 0 || 荷重_P2 != 0) ) {
                    if ( (InStr(荷重名称(逆実荷重NO(CASU)), "風圧") = 0) ) { ////////10/03/07
                        if ( N段数 = 1 || (部材正荷重数(BUZAN) < 20 $$ FLG_列車_衝撃) ) {
                            For( i7 = BUZAN To BUZAN9
                                if ( DDAN(部I(i7)) = 6 || DDAN(部J(i7)) = 6 ) {
                                    PY0 = PY0 - 2 * Twip
                                    PY1 = PY1 - 2 * Twip
                                    PY1D = PY1D - 2 * Twip
                                    PY2 = PY2 - 2 * Twip
                                    PY2D = PY2D - 2 * Twip
                                    荷重図上開き = 荷重図上開き + 2 * Twip
                                    wFlg = 1
                                    Exit For
                                }
                            }7
                        }
                    }
                    if ( wFlg = 0 $$ (荷重_P1 * 荷重_P2) < 0 ) {
                        if ( 下床文字表示 = 0 ) { //////09/12/04
                            PY0 = PY0 - 3 * Twip
                            PY1 = PY1 - 3 * Twip
                            PY1D = PY1D - 3 * Twip
                            PY2 = PY2 - 3 * Twip
                            PY2D = PY2D - 3 * Twip
                            荷重図上開き = 荷重図上開き + 3 * Twip
                        } else {
                            PY0 = PY0 + 2 * Twip //////09/12/04
                            PY1 = PY1 + 2 * Twip
                            PY1D = PY1D + 2 * Twip
                            PY2 = PY2 + 2 * Twip
                            PY2D = PY2D + 2 * Twip
                            荷重図上開き = 荷重図上開き + 2 * Twip
                        }
                    } else { ////////////////////////////////////////////////////////10/04/09
                        var gvBSN, gvBCS
                        FLGKK = 0
                        gvBSN = BSN: gvBCS = BCS
                        if ( (水平垂直 = 9 $$ (荷重_P1 < 0 $$ 荷重_P2 < 0)) ) {
                            FLGKK = 1
                        } else {if ( (水平垂直 = 0 $$ g連続Mod $$ iKozo = 3 $$ (荷重_P1 < 0 $$ 荷重_P2 < 0)) ) {
                            FLGKK = (PY1 - PY0) / Twip
                        } else {if ( (DLA = 0 $$ (水平垂直 = 9 $$ (荷重_P1 > 0 $$ 荷重_P2 > 0) $$ _
                               (InStr(荷重名称(逆実荷重NO(CASU)), "風圧") != 0 $$ アーチBOX))) ) {
                            FLGKK = 1
                            gvBSN = 1: gvBCS = 1
                        }
                        if ( FLGKK != 0 ) {
                            PX0 = PX0 - FLGKK * Twip * gvBSN
                            PX1 = PX1 - FLGKK * Twip * gvBSN
                            PX1D = PX1D - FLGKK * Twip * gvBSN
                            PX2 = PX2 - FLGKK * Twip * gvBSN
                            PX2D = PX2D - FLGKK * Twip * gvBSN
            //
                            PY0 = PY0 - FLGKK * Twip * gvBCS
                            PY1 = PY1 - FLGKK * Twip * gvBCS
                            PY1D = PY1D - FLGKK * Twip * gvBCS
                            PY2 = PY2 - FLGKK * Twip * gvBCS
                            PY2D = PY2D - FLGKK * Twip * gvBCS
            //                } else {if ( FLG_列車_衝撃 = True ) { //////////////15/04/07
            //                    wFlg = (PY1D - PY1) * 0.2
            ////                    PY0 = PY0 + wFlg
            //                    PY1 = PY1 + wFlg
            //                    PY2 = PY2 + wFlg
            //                    PY1D = PY1D + wFlg
            //                    PY2D = PY2D + wFlg
            ////                    PYE = PYE + wFlg
                        }
                        ////////////////////////////////////////////////////////10/04/09
                    }
                    wFlg = 0
                }
            ////////09/12/02
                if ( (JX_max = JX_min) ) { ////////////////////////////////////////////////////////////////////04/07/20
                   垂直左右 = 垂直左右 + BSN * (荷重_P1 + 荷重_P2)
                }
                if ( X_kajyu位置 != -99999 $$ (Abs(Y_kajyu位置 - PY1) > 1000 || X_kajyu位置 > PX1) ) { //////08/07/08
                    X_kajyu位置 = -99999
                }
                //////////////////////////////// 05/01/29
                if ( 水平垂直 != 0 $$ iKozo = 3 ) {
                    if ( Round(JX_min, 3) = Round(wXs, 3) $$ BSN * (荷重_P1 + 荷重_P2) > 0 ) {
                        垂直寸法位置補正(2) = 1 ////// 左
                    }
                    if ( Round(JX_max, 3) = Round(wXs, 3) $$ BSN * (荷重_P1 + 荷重_P2) < 0 ) {
                        垂直寸法位置補正(1) = 1 ////// 右
                    }
                }
                //////////////////////////////////////////////////////////////////////////////////////////////////////
            ////////10/03/18
            //        if ( strUN = "" ) { ////////////////////////////////////07/05/12
            //            RWR = "W="
            //        } else {
            //            RWR = "W="
            //        }
                RWR = "" ////////////08/11/033
                if ( 荷重方向 = "M" ) { ////////10/08/13
                    RWR = "Wm="
                    FLG_WmWs = 1
                }
                if ( 荷重方向 = "S" ) { ////////10/08/13
                   RWR = "Ws="
                   FLG_WmWs = 1
                }
            ////////10/03/18
                if ( Not FLG_列車_衝撃 $$ FLG_柱軸重 = True $$ 荷重方向5 != "" ) { ////////13/06/03
                    if ( 水平垂直 = 1 || 荷重方向5 = "H" ) {
                        if ( (荷重方向5 != "H" $$ (荷重_P1 + 荷重_P2) * Sgn(wYs - wYe) < 0) || (荷重方向5 = "H" $$ (荷重_P1 + 荷重_P2) > 0) ) {
                            PX1 = PX1 - 250 ////////13/11/22
                            PX1D = PX1D - 250
                            PX2 = PX2 - 250
                            PX2D = PX2D - 250
                            PX0 = PX0 - 250
                        } else {
                            PX1 = PX1 + 250
                            PX1D = PX1D + 250
                            PX2 = PX2 + 250
                            PX2D = PX2D + 250
                            PX0 = PX0 + 250
                        }
                    }
                } ////////13/06/03
                y等分布高 = Abs(HEN_Y(wYs) - PY1) ////////14/11/19
                y等分布高 = max(y等分布高, Abs(HEN_Y(wYe) - PY2))
                yyHH1 = PY1 //////HEN_Y(wYs)
                yyHH2 = PY2 //////HEN_Y(wYe)

            //        y等分布高 = y等分布高 + 50
                if ( 荷重方向 != "S" ) {
                    if ( 荷重_P1 != 0 ) {
                        DrawLinePrt obj, PX1, PY1, PX1D, PY1D
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(PX1), CSng(PY1), CSng(PX1D), CSng(PY1D))
                        }
                        this.荷重矢印(PX1, PY1, PX1D, PY1D)
                    }
                    if ( 荷重_P2 != 0 ) {
                        DrawLinePrt obj, PX2, PY2, PX2D, PY2D
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(PX2), CSng(PY2), CSng(PX2D), CSng(PY2D))
                        }
                        this.荷重矢印(PX2, PY2, PX2D, PY2D)
                    }
                }
            //////////===========================================================ここで荷重値を出力しない
                if ( (階段Mod = False) ) { ////////14/11/27////’if ( (g連続Mod = False $$ 階段Mod = False) ) {
                    if ( ((荷重_P1 > 0 || 荷重_P2 > 0)) $$ (水平垂直 = 0 || 荷重方向5 = "V" || 荷重方向5 = "M") $$ FLG_列車_衝撃 = False ) {
                        s荷重位置 = min(s荷重位置, PY1) //////13/04/20
                        s荷重位置 = min(s荷重位置, PY1D)
                        s荷重位置 = min(s荷重位置, PY2)
                        s荷重位置 = min(s荷重位置, PY2D)
                        if ( Not ((荷重_P1 + 荷重_P2 = 0) || (荷重_P1 = 荷重_P2 $$ (Abs(PX1 - PX2) >= 200) || FLG_列車_衝撃)) ) {

                            W分布荷重 = ""
                            GoTo GRF_ABC
                        }
                    } else {if ( (水平垂直 = 1 || 荷重方向5 = "H") $$ FR橋脚 = 1 $$ 荷重mark = 2 ) { //////14/11/17
                        if ( Not (荷重_L1 + 荷重_L2 = 0 $$ s側圧数 = 0 $$ 荷重_P1 = 荷重_P2) ) {
                            s側圧数 = s側圧数 + 1
                            if ( (荷重方向5 != "H" $$ (荷重_P1 + 荷重_P2) * Sgn(wYs - wYe) < 0) || (荷重方向5 = "H" $$ (荷重_P1 + 荷重_P2) > 0) ) {
                                FLG_側圧9 = 1 ////////左→
                                s各側圧位置(s側圧数, 1) = min(PX1, PX1D)
                                s各側圧位置(s側圧数, 2) = min(PX2, PX2D)
                            } else {
                                FLG_側圧9 = 2 ////////右←
                                s各側圧位置(s側圧数, 1) = max(PX1, PX1D)
                                s各側圧位置(s側圧数, 2) = max(PX2, PX2D)
                            }
                            W分布荷重 = ""
                            GoTo GRF_ABC
                        }
                    }
            //        }
                }

                分布補正 = max(max(Abs(PX1 - PX1D), Abs(PY1 - PY1D)), max(Abs(PX2 - PX2D), Abs(PY2 - PY2D))) / Twip // 9/20
                DXY = 0
            //        if ( TATE_flg = 1 ) { //////////07/06/20
                    w = frmPrint.vsPrt1.TextWidth(F2(PP1))
            //        } else {
            //            w = 0
            //        }
            TATE_flg = 0 //////08/10/01
                if ( (iKozo != 3 $$ 荷重_P1 = 荷重_P2 $$ Abs(PX2 - PX1) < w * 1.2 $$ 水平垂直 = 0) _
                    $$ (Not FLG_列車_衝撃 $$ ((PX1 + PX2) / 2 - X_kajyu位置 < w)) ) {
                    TATE_flg = 1 ////////13/02/24
                }
            ////////////////////////////////09/11/13
            var RT1 As Single, RT2 As Single
            RT1 = (wXs + 荷重_L1)
            RT2 = (wXe - 荷重_L2)
                if ( TATE_flg = 1 $$ (g柱X座標(1, 1) != g柱X座標(g柱本数, 1) $$ 水平垂直 = 0) _
                        $$ ((RT1 <= g柱X座標(1, 1) || RT2 >= g柱X座標(g柱本数, 1)) || (iKozo != 3 $$ 荷重_P1 = 荷重_P2)) ) { //////09/12/15
                    TATE_flg = 0 //////09/11/139
                }
                //
                if ( (荷重_P1 = 荷重_P2 $$ Abs(PX2 - PX1) > w * 1.2) || (PP1 = PP2 $$ TATE_flg != 1 $$ 荷重_P1 * 荷重_P2 >= 0) || _
                   (荷重_P1 = 荷重_P2 $$ 水平垂直 = 1 $$ Abs(PY2 - PY1) > 100) || (荷重_P1 + 荷重_P2) = 0 ) { //////12/11/27
                   //
                    if ( 荷重図上開き > 文字H || 荷重図上開き <= 文字H ) {
                        文字位置 = "D上*"
                        if ( 荷重_P1 < 0 ) {
                            文字位置 = "U上*"
                        }
                        w = frmPrint.vsPrt1.TextWidth(F2(PP1)) //kore
                        if ( (荷重_P1 * 荷重_P2) < 0 ) { ////////////////////////////////////13/11/15
                            RWR = RWR + "±"
                        }
                            strNum = RWR + F2(PP1) & strUN & "/m"
            //                }
                        //
                        w = frmPrint.vsPrt1.TextWidth(strNum)
                        if ( (FR橋脚 = 2 $$ 水平垂直 != 0 $$ Abs(PY1 - PY2) < w * 1.5 $$ InStr(部材名(BUZAN), "杭") = 0) ) {
            ////                    w = frmPrint.vsPrt1.TextWidth(strNum)
                            PXX1 = PX1 - DXY - (1 - Sgn(荷重_P1)) * w / 1.9 + w / Len(strNum) //////09/11/07 //////Len(RWR + F2(PP1))
                            PYY1 = PY1D + Twip
                            PXX2 = PX1 - DXY + PX1D
                            PYY2 = PY1
                            m荷重表記縦 = 1 //////08/10/29
                            y表記FLG = 1 //////09/11/13
                            this.MOJ2L("U上", PXX1, PYY1, PXX2, PYY1, strNum)
            X_kajyu位置 = (PXX1 + PXX2) / 2 //////////08/07/06
            Y_kajyu位置 = PYY1
                        } else {
            yFLG = 0 ////////////08/07/01
            if ( (荷重_P1 != 0 $$ F2(Abs(荷重_P1)) & "-" & Format(PX1, "####0.0") & "-" & Format(PY1, "####0.0") & 荷重方向4 != W分布荷重) ) { yFLG = 1 ////713/04/08
            if ( Abs(PX2 - PX1) > w * 1.5 || FR橋脚 = 2 ) { yFLG = 1
            if ( 荷重_P1 != 荷重_P2 $$ 連続P1 = 荷重_P1 ) { yFLG = 0

                        if ( yFLG = 1 ) {
                                w = frmPrint.vsPrt1.TextWidth(strNum)
                                if ( (RR橋脚 = 2 $$ 水平垂直 = 0 $$ ((PX1 + PX2) / 2 - X_kajyu位置) < w * 1.1) $$ Abs(Y_kajyu位置 - PY1) < 荷重文字サイズ * Twip / 3.5 ) {
                                    if ( Abs(Y_kajyu位置 - PY1) > (荷重文字サイズ * Twip / 3.6) ) { ////////09/03/25
                                        PYY1 = PY1
                                    } else {
                                        PYY1 = Y_kajyu位置 - 荷重文字サイズ * Twip / 3.5 ////////08/07/06
                                    }
                                    PYY2 = PYY1
                                } else {
                                    if ( 水平垂直 = 0 ) {
                                        PYY1 = PY1
                                        PYY2 = PY2 //////////09/11/199
                                        if ( 荷重方向 = "M" || 荷重方向 = "S" || 荷重方向5 = "V" ) { //////09/11/199
                                            if ( 荷重方向 = "M" || 荷重方向5 = "V" ) {
                                                PYY1 = PYY1 - (荷重文字サイズ * Twip / 36)
                                                PYY2 = PYY2 - (荷重文字サイズ * Twip / 36)
                                            } else {
                                                PYY1 = PYY1 - (荷重文字サイズ ^ 1.2 * Twip / 12)
                                                PYY2 = PYY2 - (荷重文字サイズ ^ 1.2 * Twip / 12) //////09/12/16
                                            }
                                        } else { ////////////////////////////////////////05/02/26
            //                                    w = frmPrint.vsPrt1.TextWidth(" W=" + F2(荷重_P1))
                                            if ( (Abs((PX1 + PX2) / 2 - Mark2離れ(1))) < w * 0.9 $$ _
                                                Abs(PY1 - Mark2離れ(2)) < (荷重文字サイズ * Twip / 4) ) {
                                                PYY1 = Mark2離れ(2) - 荷重文字サイズ * Twip / 3
                                                PYY2 = PYY1
                                                wFlg = 1
                                                g荷重連寸法補正 = 1 ////////////////////07/01/17
                                                if ( 水平垂直 = 0 $$ W分布荷重 != "" ) {
                                                y荷重高 = y荷重高 + (荷重文字サイズ * Twip / 2) //////12/11/27
                                                }
                            //////08/10/07
                                            } else {if ( (荷重_P1 = 荷重_P2 $$ Abs(PX2 - PX1) < w * 1.2 $$ 水平垂直 = 0) $$ FLG_列車_衝撃 ) {
            //                                        w = frmPrint.vsPrt1.TextWidth(strNum)
                                                if ( Abs(PX2 - PX1) < (w / 2) ) {
                                                    PYY1 = PYY1 - (荷重文字サイズ * Twip / 6)
                                                    PYY2 = PYY1
                                                }
                                            }
            var i9 As Integer //////08/11/066
            var mDST As Single //////08/11/18
            var ML1 As Single, mPP1 As Single, mPP2 As Single
            mDST = Round((wXe - 荷重_L2 + wXs + 荷重_L1) / 2, 3) ////////////09/10/29
            if ( (YY_max - (wYe + wYs) / 2) > 1 $$ g柱本数 > 0 ) {
                ML1 = (g柱X座標(1, 1) + g柱X座標(g柱本数, 1)) / 2
                if ( g柱本数 = 3 ) {
                    if ( ((g柱X座標(1, 1) + g柱X座標(g柱本数, 1)) / 2 - g柱X座標(2, 1)) < 0 ) {
                        ML1 = (g柱X座標(2, 1) - g柱X座標(1, 1)) / 2 //////13/12/31
                    }
                }
            } else {
                ML1 = (JX_max + JX_min) / 2
            }

            mPP1 = (wYe + wYs) / 2
                                DXY = 0 //////08/11/066
                                if ( g柱本数 > 0 $$ iKozo != 3 ) {
                                    For( i9 = 1 To g柱本数
                                        ////////////08/11/18
                                        if ( Abs(g柱X座標(i9, 3) - (節Y(節点S) + 節Y(節点E)) / 2) < 0.6 || Abs(水平部材最下端 - mPP1) < 1 ) { //////09/11/13
                                        if ( ((YY_max - mPP1) < 1 $$ 部材正荷重数(BUZAN) <= 18 $$ DDAN(g柱X座標(i9, 2)) != 0) _
                                                                || (YY_max - mPP1) >= 1 || Abs(水平部材最下端 - mPP1) < 1 ) { //////13/04 /08
                                            if ( Abs(mDST - g柱X座標(i9, 1)) < ((w * 1.2 * 図X_SCALE / 2) + IIf(mDST > ML1, (w / 5 * 図X_SCALE), 0)) ) {
            //                                        if ( mDST >= g柱X座標(i9, 1) ) {
                                                    if ( (g柱X座標(1, 1) != g柱X座標(g柱本数, 1) $$ (g柱X座標(1, 1) = g柱X座標(i9, 1)) || g柱X座標(g柱本数, 1) = g柱X座標(i9, 1)) ) {
                                                        if ( g柱X座標(1, 1) = g柱X座標(i9, 1) ) {
                                                            if ( g柱X座標(1, 1) >= (wXe - 荷重_L2) ) { //////09/10/29
                                                                DXY = (w * 0.1)
                                                            } else {
                                                                if ( (Abs((wXs + 荷重_L1) - (wXe - 荷重_L2)) / 図X_SCALE) > w ) {
            //                                                            DXY = -(w * 0.3) * 2 //////09/10/29   * 2
                                                                    ////////15/12/24
                                                                    DXY = ((Abs((wXs + 荷重_L1) - (wXe - 荷重_L2)) / 図X_SCALE) - w) / 2
                                                                }
                                                            }
                                                        } else {
                                                            if ( g柱X座標(g柱本数, 1) <= (wXs + 荷重_L1) ) { //////09/10/29
                                                                DXY = -(w * 0.1)
                                                            } else {
                                                                if ( (Abs((wXs + 荷重_L1) - (wXe - 荷重_L2)) / 図X_SCALE) > w ) {
                                                                    DXY = (w * 0.1) //////10/02/07
                                                                }
                                                            }
                                                        }
                                                        Exit For
                                                    } else {if ( (wXe - 荷重_L2 - (wXs + 荷重_L1)) / 2 > (w * 0.6 * 図X_SCALE) ) {
                                                        if ( mDST >= ML1 ) {
                                                            if ( mDST <= g柱X座標(i9, 1) ) { //13/04/08
                                                                DXY = min(w * 0.3, ((g柱X座標(i9, 1) - mDST) / 図X_SCALE - w / 1.5)) //09/11/13
                                                            } else {
                                                                //////09/11/199
                                                                if ( Not (CASU = 1 $$ ((YY_max - g柱X座標(i9, 3)) / 図Y_SCALE) < 2000) _
                                                                            || (ML1 - g柱X座標(i9, 1)) > 2 ) {
                                                                    DXY = -max(w * 0.3, Abs((g柱X座標(i9, 1) - mDST) / 図X_SCALE - w / 1.8))
                                                                } else {
                                                                    DXY = max(w * 0.3, Abs((g柱X座標(i9, 1) - mDST) / 図X_SCALE - w / 1.4))
                                                                }
                                                                //////09/11/199
                                                            }
                                                        } else {
                                                            DXY = -(w * 0.6)
                                                        }
                                                        Exit For
                                                    }
                                                }
                                            }
                                            } //////09/10/29
                                        }9
                                        if ( DXY = 0 $$ 連続P1 != 荷重_P1 ) { //////////09/11/10////09/12/26
                                            if ( (Abs((wXs + 荷重_L1) - (wXe - 荷重_L2)) / 図X_SCALE) < w / 2 ) {
                                                if ( ML1 < (((wXs + 荷重_L1) + (wXe - 荷重_L2)) / 2) ) {
                                                    DXY = -(w / 1.5 - (Abs((wXs + 荷重_L1) - (wXe - 荷重_L2)) / 図X_SCALE)) / 2
                                                } else {
                                                    if ( (ML1 - (((wXs + 荷重_L1) + (wXe - 荷重_L2)) / 2)) > 0.8 ) { //////09/12/15
                                                        DXY = (w / 1.5 - (Abs((wXs + 荷重_L1) - (wXe - 荷重_L2)) / 図X_SCALE)) / 2
                                                    }
                                                }
                                            }
                                        } //////////09/11/10
                                    }
                                            if ( wFlg = 0 ) {
                                                Mark2離れ(1) = (PX1 + PX2) / 2
                                                Mark2離れ(2) = PYY1
                                            } else {
                                                Mark2離れ(1) = -99999999
                                                Mark2離れ(2) = -99999999
                                            }
                                        }
                                    } else {
                                        w = frmPrint.vsPrt1.TextWidth("1")
                                        if ( InStr(部材名(BUZAN), "杭") = 0 ) {
                                            if ( 荷重_P1 * Sgn((PY2 - PY1)) > 0 ) { //////////08/10/23
                                                if ( 水平垂直 = 9 || 荷重方向 = "H" || s斜めFLG = 2 ) { //////09/10/24
                                                    if ( s斜めFLG = 2 $$ 荷重_P1 > 0 ) {
                                                        DXY = (PX1 - PX1D) - 20
                                                    } else {
                                                        DXY = 20 //////09/10/24
                                                    }
                                                } else {
                                                    DXY = min(-(PX1D - PX1) / 1.2, -200) //////08/10/23
                                                }
                                            } else {
                                                if ( 水平垂直 = 9 || 荷重方向 = "H" || s斜めFLG = 2 ) { //////09/10/24
                                                    DXY = 20
                                                } else {
                                                    DXY = max((PX1D - PX1) / 1.2, 200) //////08/10/23
                                                    if ( 荷重文字サイズ > 8 ) { //////09/11/06
                                                        DXY = DXY + ((荷重文字サイズ - 8) * Twip / 3)
                                                    }
                                                }
                                            }
                                        } else {
                                            if ( 荷重_P1 > 0 ) { //////////08/08/15
                                                DXY = min(-(PX1D - PX1) / 1.2, -160) ////08/08/15
                                            } else {
                                                DXY = max((PX1D - PX1) / 1.2, 200) ////08/08/15
                                            }
                                            if ( Abs(PY1 - PY2) < 300 ) { //////////////////////////////07/06/11
                                                strNum = F2(PP1) & strUN & "/m   "
                                            }
                                        }
                                        if ( 水平垂直 = 9 ) { ////////////07/01/077
                                            PYY1 = PY1
                                            PYY2 = PY2
                                        } else {
                                            PYY1 = (PY1 + PY2) / 2
                                            PYY2 = PYY1
                                        }
                                    }
                                }
                                if ( InStr(荷重名称(逆実荷重NO(CASU)), "風圧") != 0 $$ アーチBOX ) { ////////////10/03/07//////10/03/18
                                    if ( N風圧 = 0 ) {
                                        w = frmPrint.vsPrt1.TextWidth(strNum)
                                        PXX1 = HEN_X((JX_max + JX_min) / 2) - w / 10
                                        PYY1 = HEN_Y((YY_max + YY_min) / 2)
                                        PXX2 = PXX1 + 100
                                        PYY2 = PYY1
                                        this.MOJ2C("C上", PXX1, PYY1, PXX2, PYY2, "W = " & strNum)
                                        y等分布高 = Abs(min(HEN_Y(wYs), HEN_Y(wYe)) - PYY1) ////////14/11/19
                                        N風圧 = 1
                                    }
                                } else {
                                    if ( FLGKK5 != 0 ) { ////////////10/03/18
                                        PYY1 = PYY1 + FLGKK5 // * 1.5
                                        PYY2 = PYY2 + FLGKK5 // * 1.5
                                        strNum = "-" & strNum
                                    }
                                    if ( 水平垂直 = 9 ) { //////////And 荷重方向5 = "V" ) { //////13/04/07////13/04/08
                                        DXY = DXY * Sgn(s斜補正)
                                    }
                                    y等分布高 = Abs(min(HEN_Y(wYs), HEN_Y(wYe)) - PYY1) ////////14/11/19
                                    if ( PX1 > PX2 ) { //////10/03/07
                                        this.MOJ2C(文字位置, PX2 - DXY, PYY1, PX1 - DXY, PYY2, "  " & strNum)
                                    } else {
                                        if ( 荷重方向 = "S" ) { //////10/10/20
                                            PYY1 = Y_kajyu位置 - (荷重文字サイズ * Twip / 2.7)
                                            PYY2 = Y_kajyu位置 - (荷重文字サイズ * Twip / 2.7)
                                        }
                                        if ( (荷重_P1 + 荷重_P2) = 0 ) { //////12/11/27
                                            PYY1 = (PY1 + PY2) / 2 - IIf(荷重_P1 > 0, 200, 300) //////12/11/27
                                            PYY2 = (PY1 + PY2) / 2 - IIf(荷重_P1 > 0, 200, 300) //////12/11/27
                                        }
                                        if ( iKozo = 1 $$ 水平垂直 = 0 $$ Abs(PX1 - PX2) < 200 $$ FLG_列車_衝撃 = False ) {
                                            PXX1 = PX1 - IIf(DXY >= 0, 50, 20)  //////DXY / 5
                                            PYY1 = PY1 + 30
                                            PXX2 = PXX1
                                            PYY2 = PYY1
                                            m荷重表記縦 = 1
                                            y表記FLG = 1
                                            this.MOJ2L("U上", PXX1, PYY1, PXX2, PYY1, " " & strNum)
                                        } else {
                                            if ( (荷重_P1 = 荷重_P2) $$ (荷重_P1 < 0 $$ 荷重_P2 < 0) $$ 荷重図開き > 0 ) {
                                                PYY1 = PY0 - (荷重文字サイズ * Twip) * 0.437 //////13/12/25
                                                PYY2 = PYY1
                                            } else {if ( g柱本数 = 3 ) {
                                                if ( ((g柱X座標(1, 1) + g柱X座標(g柱本数, 1)) / 2 - g柱X座標(2, 1)) < 0 ) {
                                                    DXY = w //////13/12/31
                                                } else {if ( g柱X座標(1, 1) = (JX_max - JX_min) / 2 ) { ////////16/12/30
                                                    if ( iKozo = 2 ) {
                                                        if ( (荷重_P1 + 荷重_P2) > 0 ) {
                                                            DXY = -w * 3
                                                        } else {
                                                            DXY = w * 3
                                                        }
                                                    } else {
                                                        DXY = w / 2
                                                    }
                                                }
                                            }
                                            ////////////////////////15/02/17
                                            if ( iKozo = 1 $$ 水平垂直 = 0 $$ Abs(PX1 - PX2) < 200 $$ FLG_列車_衝撃 = True ) {
            //                                        PYY1 = PYY1 - 120
            //                                        PYY2 = PYY2 - 120
                                                DXY = DXY / 2
                                                this.MOJ2C(文字位置, PX1 - DXY, PYY1, PX2 - DXY, PYY2, "  " & strNum)
                                            } else {
                                                if ( (荷重_P1 + 荷重_P2) = 0 $$ 荷重_P1 < 0 $$ DXY = 0 ) { //////15/03/23
                                                    DXY = w / 4
                                                }
                                                this.MOJ2C(文字位置, PX1 - DXY, PYY1, PX2 - DXY, PYY2, "  " & strNum)
                                            }
                                            y等分布高 = Abs(min(HEN_Y(wYs), HEN_Y(wYe)) - PYY1) ////////14/11/19
                                        }
                                    }
                                    X_kajyu位置 = (PX1 + PX2) / 2 - DXY
                                    Y_kajyu位置 = (PYY1 + PYY2) / 2
                                }
                            }
                        }
                    } else {
                        PXX1 = (PX1 + PX1D) / 2
                        PYY1 = (PY1 + PY1D) / 2
                        PXX2 = (PX2 + PX2D) / 2
                        PYY2 = (PY2 + PY2D) / 2
                        this.MOJ2C("C上", PXX1, PYY1, PXX2, PYY2, strNum) ////////RWR + F2(PP1))
                        y等分布高 = Abs(min(HEN_Y(wYs), HEN_Y(wYe)) - PYY1) ////////14/11/19
                    }
                    g段上げ = 図Y(wYs) + YY1 //+ y荷重高 * 0 //////max(g段上げ, max(PY1D, PY2D)) //////13/04/13
            //TATE表示: ////////09/12/26
                    W分布荷重 = F2(Abs(荷重_P2)) & "-" & Format(PX2, "####0.0") & "-" & Format(PY2, "####0.0") & 荷重方向4 //9/19////13/04/08

                    //
            } else { //////////////////////////////////////////////////////////////////////////////////////////////// 荷重_P1 != 荷重_P2
                    var Wn(2) As String
            //            if ( strUN = "" ) { ////////////////////////////////////07/05/12
            //                Wn(1) = " W1=": Wn(2) = " W2="
            //                if ( 荷重_P1 * 荷重_P2 = 0 ) {
            //                    Wn(1) = " W=": Wn(2) = " W="
            //                }
            //                if ( 水平垂直 = 0 ) { ////////////////////////////////////////////////////////////////////////05/02/24
            //                    Wn(1) = "  W1=": Wn(2) = "  W2="
            //                    if ( 荷重_P1 * 荷重_P2 = 0 ) {
            //                        Wn(1) = "  W=": Wn(2) = "  W="
            //                    }
            //                    Wn(1) = "": Wn(2) = "" ////////////08/11/033
            //    //                if ( g連続Mod $$ iKozo = 3 $$ 水平垂直 = 0 ) { //////////05/02/24
            //                    if ( 水平垂直 = 0 ) { ////////////////////////////////////05/02/24
            //                        if ( 荷重_P1 > 0 ) {
            //                            if ( max(Abs(荷重_P1), Abs(荷重_P2)) < 10 ) { //////08/11/266
            //                                Wn(1) = "   ": Wn(2) = "   "
            //                            } else {
            //                                Wn(1) = "    ": Wn(2) = "    " ////////09/03/25//////09/04/06
            //                            }
            //                        } else {
            //                            if ( max(Abs(荷重_P1), Abs(荷重_P2)) < 10 ) { //////08/11/266
            //                                Wn(1) = "": Wn(2) = ""
            //                            } else {
            //                                Wn(1) = " ": Wn(2) = " "
            //                            }
            //                        }
            //                    }
            ////                }
            //                if ( 水平垂直 != 0 ) { ////////////////////////////////////05/05/15
            //                    Wn(1) = " W=": Wn(2) = " W="
            //                }
            //            }
                if ( (Abs(荷重_P1) != Abs(荷重_P2)) $$ 水平垂直 = 1 ) { //////13/04/08
                    if ( (荷重方向5 != "H" $$ (荷重_P1 + 荷重_P2) * Sgn(wYs - wYe) < 0) || (荷重方向5 = "H" $$ (荷重_P1 + 荷重_P2) > 0) ) {
                        FLG_側圧 = 1 ////////左→
                    } else {
                        FLG_側圧 = 2 ////////右←
                    }
                }

                    if ( 荷重方向 = "M" ) {
                        Wn(1) = "      Wm1="
                        Wn(2) = "      Wm2="
                    }
                    if ( 荷重方向 = "S" ) {
                        Wn(1) = "      Ws1="
                        Wn(2) = "      Ws2="
                    }
            ////////08/11/066
            var 表示FLG As Integer
            var strQ2 As String, sNum4 As Single //////09/11/06
            var strQ3 As String //////13/04/12

            表示FLG = 0
            if ( g荷重表記縦 = 1 $$ (iKozo = 3 $$ g連続Mod) ) { ////////14/11/27
            //    表示FLG = 1
            //    m荷重表記縦 = 1
            //    y表記FLG = 1
            }
            if ( W分布荷重 != "" ) { //////08/11/067
            //        if ( (荷重_P1 = 荷重_P2 || 荷重_P1 * 荷重_P2 = 0) $$ 荷重_P1 = val(Mid(W分布荷重, 1, InStr(W分布荷重, "-") - 1)) ) { ////////08/11/066
                if ( 荷重_P1 = val(Mid(W分布荷重, 1, InStr(W分布荷重, "-") - 1)) ) { //////09/11/08
                    strQ2 = Mid(W分布荷重, InStr(W分布荷重, "-") + 1) //////09/11/06
                    sNum4 = val(Mid(strQ2, 1, InStr(strQ2, "-") - 1))
                    if ( Abs(sNum4 - PX1) < 5 ) {
                        表示FLG = 1 ////////13/02/24
                    }
                }
                if ( W分布荷重 != "" $$ FLG_側圧 != 0 ) {
                    strQ2 = Mid(W分布荷重, InStr(W分布荷重, "-") + 1) //////09/11/06
                    sNum4 = val(Mid(strQ2, 1, InStr(strQ2, "-") - 1))
                    if ( Abs(sNum4 - PX1) > 10 ) {
                        W分布荷重 = "" ////////13/04/12
                    }
                }
            }
                    if ( 荷重_L1 = 0 ) {
                        if ( Not (FR橋脚 = 1 $$ 水平垂直 != 0) ) {
                            W分布荷重 = "" //////// 05/05/15
                        }
                    }

                    obj.FontSize = obj.FontSize - 1 //@@@@@@@@@@@@@@@@@@@@
                    RWR = Wn(1) //" W="
                    PYY1 = 0
                    if ( (FR橋脚 = 2 $$ SS部材 = 1 $$ max(Abs(PY1), Abs(PY2)) < 部材荷重Fontsize * Twip * 1.5) ) {
                    } else {
            //                if ( strUN = "" ) { ////////////////////////////////////07/05/12
            //                    strNum = Wn(1) + F2(PP1)
            //                } else {
                            strNum = F2(PP1) & strUN & "/m"
            //                }
            yFLG = 0 ////////////08/07/01
            if ( (荷重_P1 != 0 $$ F2(Abs(荷重_P1)) & "-" & Format(PX1, "####0.0") & "-" & Format(PY1, "####0.0") & 荷重方向4 != W分布荷重) ) { yFLG = 1 //////13/04/08
                        if ( yFLG = 1 ) {
                            if ( 水平垂直 = 1 ) { //////////////////////////////////////if ( 水平垂直 != 0 ) { //////07/07/26
                                w = frmPrint.vsPrt1.TextWidth(strNum)
                                if ( 荷重方向5 = "H" ) { ////////13/04/08
                                    if ( 荷重_P1 > 0 ) {
                                       DXY = w / IIf(iKozo = 3, 1.8, 2.2)
                                       if ( Abs(PY1 - PY2) < 荷重文字サイズ * Twip / 1 ) {
                                       PYY1 = w / Len(strNum) * 2.5
                                       }
                                    } else {
                                       DXY = w / IIf(iKozo = 3, -1.8, -2.2)
                                       if ( Abs(PY1 - PY2) < 荷重文字サイズ * Twip / 1 ) {
                                       PYY1 = w / Len(strNum) * 2.5
                                       }
                                    }
                                } else {
                                    if ( 荷重_P1 * Sgn(wYs - wYe) > 0 || FLG_側圧 = 2 ) { //////13/04/12
                                       DXY = w / IIf(FR橋脚 = 2, 2, IIf(iKozo = 3, 1.8, 2.2))
                                       if ( Abs(PY1 - PY2) < 荷重文字サイズ * Twip / 1 ) {
                                       PYY1 = w / Len(strNum) * 2.5
                                       }
                                    } else {
                                       DXY = w / IIf(FR橋脚 = 2, 2, IIf(iKozo = 3, -1.8, -2.2))
                                       if ( Abs(PY1 - PY2) < 荷重文字サイズ * Twip / 1 ) {
                                       PYY1 = w / Len(strNum) * 2.5
                                       }
                                    }
                                } //////13/04/08
                                if ( 荷重_P1 = 荷重_P2 ) {
                                   if ( Abs(PY1 - PY2) < 荷重文字サイズ * Twip / 2 ) {
                                        PYY1 = 0
                                   } else {
                                        PYY1 = (PY1 - PY2) / 2
                                   }
                                }
                                if ( FR橋脚 = 1 ) {
                                   PYY1 = 0
                                   if ( Abs(Y_kajyu位置 - (PY1 - PYY1)) < (部材荷重Fontsize * Twip / 6) ) {
                                   PYY1 = Round(-(Y_kajyu位置 - PY1), 3) //-(Y_kajyu位置 + (部材荷重Fontsize * Twip / 8) - PY1)
                                   }
                                } else {
                                   if ( Abs(Y_kajyu位置 - (PY1 - PYY1)) < (部材荷重Fontsize * Twip / 3) ) {
                                   PYY1 = (Y_kajyu位置 + (部材荷重Fontsize * Twip / 3) - PY1)
                                   }
                                }
                            } else {
                                if ( iKozo = 3 $$ g連続Mod ) {
                                    PYY1 = 0 //-部材荷重Fontsize * Twip / 3 //////////////////////////////05/02/27
                                    if ( g文字補正1 > 0.4 ) {
                                    PYY1 = (部材荷重Fontsize * Twip / 2.2) * DLA //////09/08/02//////13/04/12
                                    if ( g文字補正1 > 0.9 ) {
                                        PYY1 = PYY1 + 50
                                    }
                                    } else {
                                    PYY1 = (部材荷重Fontsize * Twip / 5) * DLA //////09/08/02
                                    }
                                } else {
                                        PYY1 = 0 //部材荷重Fontsize * Twip / 12 //////////// 06/12/14
                                        if ( g文字補正1 > 0.01 ) { ////////////////09/12/25 g文字補正1 > 0.3 ) {
                                            PYY1 = (部材荷重Fontsize * Twip / 2) * DLA ////////////07/07/26 09/08/03
                                            if ( g文字補正1 > 0.8 ) { ////////////09/11/06
                                                PYY1 = (部材荷重Fontsize * Twip / 1.7) * DLA
                                            }
                                        } else {
                                            PYY1 = (部材荷重Fontsize * Twip / 4) ////////////07/01/06 09/08/03
                                        }
            //                            } else {
            //                                PYY1 = -部材荷重Fontsize * Twip / 2.8 * DLA ////////////07/07/26//////08/10/07
            //                            }
                                }
                            }
            //                    if ( FR橋脚 = 2 $$ 水平垂直 = 0 ) {
            //                        DXY = -部材荷重Fontsize * Twip / 2.2////////08/09/26
            //                    }
                            if ( (荷重_P1 < 0 $$ 荷重_P2 <= 0 $$ 水平垂直 = 0) ) { //////////////// 04/11/11 nagase
                               PYY1 = -300 //-240
                            }
                            if ( 水平垂直 != 1 ) { //////////////if ( 水平垂直 = 0 ) {  07/07/26
                                if ( (荷重方向 = "M" || 荷重方向 = "S") ) {
                                  if ( 荷重方向 = "M" ) {
                                  DXY = 部材荷重Fontsize * Twip / 10 //////////////09/11/13
                                  } else {
                                  DXY = 部材荷重Fontsize * Twip / 3
                                  }
                                } else {
                                    if ( TATE_flg = 1 $$ 荷重_P1 = 荷重_P2 ) { ////// 05/03/02
                                         if ( Abs(PX2 - PX1) < 350 ) {
            //                                 DXY = Abs(PX2 - PX1) / 2.5 - 部材荷重Fontsize * Twip / 8
                                         DXY = (Abs(PX2 - PX1) / 2.5 - 部材荷重Fontsize * Twip / 3) ////////08/07/06
                                         } else {
                                         DXY = Abs(PX2 - PX1) / 5 - 部材荷重Fontsize * Twip / 8
                                         }
                                     } else {if ( ((KAJYUstrEND + 部材荷重Fontsize * Twip / 8 - (PX1 + DXY))) > 0 ) { ////08/10/07
                                            if ( Abs(Y_kajyu位置 - (PY2D + PYY1)) < 部材荷重Fontsize * Twip / 2 || (KAJYUstrEND > (PX1 + DXY)) ) { //////09/12/03//////09/12/26
                                            DXY = ((KAJYUstrEND - (PX1 + DXY)) - 部材荷重Fontsize * Twip / 10) ////08/12/06  /8
                                            }
                                            if ( Abs(DXY) > 500 ) { DXY = 0 //////12/06/04
                                     } else {if ( (PX1 + DXY) - KAJYUstrEND > 600 $$ Abs(PX1 - PX2) < 100 ) {
                                          DXY = -max((部材荷重Fontsize * Twip / 1.3 - Abs(PX1 - PX2)), (部材荷重Fontsize * Twip / 1.5))
                                     } else {if ( (PX1 + DXY) - KAJYUstrEND < 600 $$ Abs(PX1 - PX2) < 100 ) {
                                          if ( Abs(Y_kajyu位置 - (PY2D + PYY1)) < 部材荷重Fontsize * Twip / 2 ) { //////09/12/03
                                          DXY = -(KAJYUstrEND + 部材荷重Fontsize * Twip / 4 - (PX1 + DXY))
                                          }
                                          if ( Abs(DXY) > 500 ) { DXY = 0 //////12/06/04
                                     } else {if ( Abs(PX1 + DXY - KAJYUstrEND) < 部材荷重Fontsize * Twip / 6 $$ Abs(PX1 - PX2) < 350 ) {
                                          DXY = -(部材荷重Fontsize * Twip / 6 - Abs(PX1 + DXY - KAJYUstrEND))
                                     } else {if ( Abs(PX1 + DXY - KAJYUstrEND) < 部材荷重Fontsize * Twip / 6 $$ Abs(PX1 - PX2) > 600 ) {
                                         DXY = max(部材荷重Fontsize * Twip / 6 - Abs(PX1 + DXY - KAJYUstrEND), 0) ////// 05/04/08
                                     } else {if ( 荷重_P2 != 0 $$ Abs(PX1 - PX2) < 600 ) {
                                         if ( Not (荷重_P1 != 荷重_P2 $$ 連続P2 = 荷重_P2 $$ 連続P2 = 連続P3) ) { ////////////08/11/03
                                            if ( s斜めFLG = 1 ) { //////09/10/20
                                                DXY = -(部材荷重Fontsize * Twip / 2.5)
                                                PYY1 = max(0, PYY1) + 400 //Abs(PYY1) * 2
                                            } else {
                                                if ( Abs(PX2 - PX1) < 350 ) { ////////09/12/25
                                                    DXY = -(部材荷重Fontsize * Twip / 2.5)
                                                } else {
                                                    DXY = -40 //////09/12/25
                                                }
                                             }
                                         } //////08/11/03
                                     } else {
                                         DXY = -16 ////////-(部材荷重Fontsize * Twip / 2.5) ////////////08/10/01
                                         if ( 荷重_P1 * 荷重_P2 = 0 $$ 水平垂直 = 0 $$ Abs(PX1 - PX2) < 350 $$ N段数 = 1 ) { ////////08/10/10
                                         DXY = -(部材荷重Fontsize * Twip / 2.5)
                                         }
                                            if ( s斜めFLG = 1 ) { //////09/10/20
                                               PYY1 = max(0, PYY1) + 300 //Abs(PYY1) * 2
                                            }
                                     }
                                }
                            }
                    if ( s斜めFLG = 2 ) { //////09/10/24 荷重_P1
                        if ( 荷重_P1 > 0 ) {
                            if ( 荷重方向 = "H" ) {
                                DXY = 0
                            } else {
                                DXY = -max(20, YY1)
                            }
                        } else {
                            DXY = -YY1 + (部材荷重Fontsize * Twip / 5)
                        }
                        if ( Sgn(wYs - wYe) = 1 ) {
                            PYY1 = -(部材荷重Fontsize * Twip / 2.5) - IIf(荷重_P1 > 0, 0, YY1)
                        } else {
                            PYY1 = -20
                        }
                    }
                            if ( 水平垂直 = 0 $$ 荷重_P1 * 荷重_P2 < 0 ) { //////////07/11/01
                                if ( 荷重_P1 < 0 ) {
                                    strNum = F2(荷重_P1) & strUN & "/m"
                                    w = frmPrint.vsPrt1.TextWidth(strNum & "1")
                                    PYY1 = w + 部材荷重Fontsize * Twip / 4 ////////09/12/04
                                } else {
                                    PYY1 = Abs(PY1 - PY1D) ////////09/12/04
                                }
                            }
                            if ( 表示FLG = 0 ) { ////////08/11/066
                                if ( (iKozo = 3 $$ g連続Mod) $$ iKozo = 1 ) { ////////////14/11/27
            //                            m荷重表記縦 = 1
            //                            y表記FLG = 1
                                } else {
                                if ( Not (iKozo = 1 $$ N段数 = 1 $$ 水平垂直 = 0 $$ Abs(YY_max - (wYe + wYs) / 2) > 1.6) ) { //////10/04/03
                                    m荷重表記縦 = 1 //////08/10/29
                                    y表記FLG = 1 //////09/11/13
                                    if ( (水平垂直 = 0 $$ ((節X(節点S) = JX_min) || Abs(節X(節点S) = JX_min) < 0.5)) ) { //////12/09/14
                                        m荷重表記縦 = 0
                                        y表記FLG = 0
                                        if ( 荷重_L1 = 0 ) {
                                            DXY = -200
                                            PYY1 = (PY1 - 100)
                                            this.MOJ2L(IIf(荷重_P1 > 0, "U上", "D上"), PX1D + DXY, (PYY1), PX1 + DXY, (PYY1 - 500), strNum)
                                        GoTo ABC
                                        }
                                    } else {if ( (水平垂直 = 0 $$ 荷重_P2 = 0 $$ InStr(W分布荷重, Format(Abs(荷重_P1), "0.00")) != 0) ) { //////12/11/22
                                        m荷重表記縦 = 0 ////////水平に表示
                                        y表記FLG = 0
                                    }
                                        //////////////////////////////////////////////////////////13/02/28 PY1
                                    if ( Not 荷重_P1 * 荷重_P2 <= 0 ) {
                                    PYY1 = (PY1 - 200)
                                    this.MOJ2L(IIf(荷重_P1 > 0, "U上", "D上"), PX1D + DXY - 50, (PYY1), PX1 + DXY + 150, (PYY1), strNum)
                                    }
                                    GoTo ABC
                                }
                                } ////////14/11/26
            if ( 水平垂直 = 0 $$ PX1D = PX1 $$ ((iKozo = 3 $$ g連続Mod) || iKozo = 1) ) { //////12/09/14
            if ( Abs(PYY1) < 200 ) { strNum = " " & strNum //////12/11/22
            // }////////////09/11/08
            } else {if ( 水平垂直 = 0 $$ y表記FLG = 1 $$ Not (iKozo = 3 $$ g連続Mod) ) { ////////////09/11/13
            //    if ( g文字補正1 > 0.8 $$ Abs(PYY1) < 270 ) { ////////////09/04/06//// < 100 ) {
            if ( Abs(PYY1) < 270 ) { ////////09/11/10
                strNum = " " & strNum
            //    }////////////09/11/08
            } else {if ( (荷重_P1 > 0 $$ 荷重_P1 < 10) || g文字補正1 > 0.98 ) { ////////////09/11/06//////And 荷重_P2 < 10) ) { ////////09/04/06
                strNum = " " & strNum
            }
            }
                        if ( FLG_側圧 != 0 ) { ////////13/04/08
                            m荷重表記縦 = 1
                            y表記FLG = 1
                            if ( Abs(PY1 - PY2) > 500 || W分布荷重 = "" ) { //////13/04/12
                                PYY1 = (PY1 - 200)
                            } else {
                                PYY1 = (PY1 + 200)
                            }
                            if ( FLG_側圧 = 1 ) {
                                DXY = DXY / 2
                            } else {if ( FLG_側圧 = 2 ) {
                                DXY = DXY / 2
                            }
                            this.MOJ2L(IIf(荷重_P1 > 0, "U上", "D上"), PX1D + DXY, (PYY1), PX1 + DXY, (PYY1), strNum) //////13/04/12
                            GoTo ABC
                        }

            if ( 水平垂直 = 1 $$ wYs >= YY_max * 0.9 $$ y表記FLG = 1 $$ (荷重_P1 != 荷重_P2 $$ 荷重_P1 != 0) ) { ////////09/11/13
            if ( Abs(PY1 - PY2) < (荷重文字サイズ * Twip / 1.6) ) {
                PYY1 = (荷重文字サイズ * Twip / 3)
            }
            }
                    if ( 下床文字表示 = 1 $$ (iKozo != 3 || N段数 = 1) ) { ////12/06/04
                        w = frmPrint.vsPrt1.TextWidth(strNum & "1")
                        if ( 荷重_P1 > 0 ) {
                            PYY1 = 0 //////-w / 5 //////////////13/02/27  / 5
                            DXY = -220 //////13/02/27
                        } else {
                            PYY1 = -Abs(PY1 - PY1D)
                        }
                    }
                    if ( InStr(部材名(BUZAN), "杭") != 0 ) { //////12/02/15
                        DXY = 0
                    }
                    if ( DXY = 0 ) { DXY = -16 ////////09/12/26
                    if ( (Abs(PX1D - PX1) < 0.1 $$ PY1D > PY1) $$ Not g連続Mod $$ Abs(z上層両X座標(1) - RT1) < 0.1 ) { //////10/10/13
                        w = frmPrint.vsPrt1.TextWidth(strNum & "1") / 1.5 //////////12/09/14////// / 2
                        if ( 下床文字表示 = 1 ) {
                        PYY1 = 300 + w
                        } else {
                        PYY1 = PYY1 + 100 + w
                        }
                        DXY = -28
                        this.MOJ2L(IIf(荷重_P1 > 0, "U上", "D上"), PX1D + DXY, PY1D - PYY1, PX1 + DXY, PY1D + 1 - PYY1, strNum)
                        if ( 荷重_P2 = 0 $$ 荷重_L1 = 0 ) { m荷重表記縦 = 0 //////10/10/13
                    } else {
                        if ( 水平垂直 = 1 $$ Abs(PY1D - PY2D) < 300 ) { //////12/06/044
            //                    if ( W分布荷重 != "" ) {
            //                    strQ2 = Mid(W分布荷重, InStr(W分布荷重, "-") + 1)
            //                    sNum4 = val(Mid(strQ2, 1, InStr(strQ2, "-") - 1))
            //                    if ( Abs(sNum4) - Abs(PX1D) > 2000 ) { W分布荷重 = ""
            //                        if ( W分布荷重 != "" ) { //////12/06/044
                                    PYY1 = 0 //////12/06/044
            //                            ZRT = 0
            //                        }
            //                    }
                        }
            ////////////内水圧 13/01/31
            //                if ( FLG_側圧 != 0 ) { ////////13/04/08
            //                    m荷重表記縦 = 1
            //                    y表記FLG = 1
            //                    PYY1 = (PY1 - 200)
            //                    if ( FLG_側圧 = 1 ) {
            //                        PYY1 = (PY1 - 50)
            //                    } else {if ( FLG_側圧 = 2 ) {
            //                        DXY = DXY / 2
            //                    }
            //                    this.MOJ2L(IIf(荷重_P1 > 0, "U上", "D上"), PX1D + DXY - 150, (PYY1), PX1 + DXY + 150, (PYY1), strNum)
            //                } else {
                            if ( 水平垂直 = 1 $$ iKozo = 3 $$ g連続Mod = False $$ (荷重_L1 / 図Y_SCALE) < 450 $$ _
                                    ((JX_min = 節X(節点S) $$ 荷重_P1 > 0) || (JX_max = 節X(節点S) $$ 荷重_P1 < 0)) ) {
                                PYY1 = PY0 - 180
                                if ( JX_min = 節X(節点S) ) {
                                    DXY = PX0 // - DXY - 500
                                    this.MOJ2L(IIf(荷重_P1 > 0, "U上", "D上"), DXY, PYY1, DXY + 1000, PYY1, strNum)
                                } else {
                                    DXY = PX0 // + DXY - 500
                                    this.MOJ2L(IIf(荷重_P1 > 0, "U上", "D上"), DXY, PYY1, DXY - 500, PYY1, strNum)
                                }
                                PYY1 = 0
                                DXY = 0
                            } else {
                                if ( (PY1D != PY1 $$ 荷重_P1 * 荷重_P2 != 0) || g荷重表記縦 = 1 ) { //////13/02/288
                                    if ( (水平垂直 = 0 $$ 節X(節点S) = JX_min) $$ 荷重_L1 = 0 ) {
                                        DXY = DXY - (部材荷重Fontsize * Twip / 2.5) //////13/04/25
                                        y表記FLG = 0
                                    } else {
                                        m荷重表記縦 = 1
                                        y表記FLG = 1
                                    }
                                    PYY1 = PYY1 + IIf(Mid(strNum, 1, 1) = " ", 50, 80) //////13/04/12
                                    this.MOJ2L(IIf(荷重_P1 > 0, "U上", "D上"), PX1D + DXY, PY1D - PYY1, PX1 + DXY, PY1 - PYY1, strNum)
                                } else {
                                    m荷重表記縦 = 0 ////////水平に表示//////////////////13/02/288
                                    y表記FLG = 0
                                    PYY1 = (PY1 - 200)
                                    this.MOJ2L(IIf(荷重_P1 > 0, "U上", "D上"), PX1D + DXY - 150, (PYY1), PX1 + DXY + 150, (PYY1), strNum)
                                }
                            }
            //                }
                    }
                } ////////08/11/066
            ABC:
                    KAJYUstrEND = PX1D + DXY ////////////07/01/07
                    Y_kajyu位置 = (PY1D - PYY1)
                    X_kajyu位置 = PX1D + DXY //////13/01/31
                RWR = Wn(2)
            }
            //================================================================ 荷重_P2
                        DXY = 0
                        if ( RR橋脚 = 2 ) {
                            DXY = 部材荷重Fontsize * Twip / 2.5
                            if ( Abs(PX2D - PX1D) < DXY * 1.6 ) {
                            } else {
                                DXY = 0
                            }
                            if ( 水平垂直 = 0 $$ Abs(荷重_P1) > Abs(荷重_P2) ) {
            //                        荷重_P2 = 0//////////08/09/26
                            }
                            if ( 水平垂直 = 0 ) {
                                DXY = -部材荷重Fontsize * Twip / 2.2
                            }
                        }
                        PYY1 = 0
            //                if ( strUN = "" ) { ////////////////////////////////////07/05/12
            //                    strNum = RWR + F2(PP2)
            //                } else {
                            strNum = F2(PP2) & strUN & "/m" ////////089/04/17//////RWR + F2(PP2) & strUN & "/m"
            //                }
                        if ( 荷重_P2 != 0 $$ 荷重_P1 != 荷重_P2 ) {
                            if ( 水平垂直 != 0 ) {
                                w = frmPrint.vsPrt1.TextWidth(strNum)
                                if ( 荷重方向5 = "H" ) { ////////13/04/08
                                    if ( 荷重_P2 > 0 ) {
                                       DXY = w / IIf(iKozo = 3, 1.8, 2.2)
                                       if ( Abs(PY1 - PY2) < 荷重文字サイズ * Twip / 1 ) {
                                       PYY1 = w / Len(strNum) * 2.5
                                       }
                                    } else {
                                       DXY = w / IIf(iKozo = 3, -1.8, -2.2)
                                       if ( Abs(PY1 - PY2) < 荷重文字サイズ * Twip / 1 ) {
                                       PYY1 = w / Len(strNum) * 2.5
                                       }
                                    }
                                } else {
                                    if ( 荷重_P2 * Sgn(wYs - wYe) > 0 ) { ////////10/03/07
                                        DXY = w / IIf(FR橋脚 = 2, 2, IIf(iKozo = 3, -1.8, -2.2)) ////09/12/25////IIf(FR橋脚 = 2, 2, -2.2)
                                        if ( 水平垂直 = 9 ) {
                                            if ( s斜めFLG = 1 ) { //////09/10/20
                                                PYY1 = -(部材荷重Fontsize * Twip) * 2 ////////////07/07/26
                                                DXY = -w / 5 ////////////07/07/26
                                            } else {
                                                PYY1 = (部材荷重Fontsize * Twip / 3 - w * 1.1 * 0.1) * DLA * Sgn((BYE - BY0) / (BXE - BX0)) ////////////07/07/26//////13/04/08
                                                DXY = -w / 1.5 ////////////07/07/26//////13/04/08
                                                strNum = "   " & strNum //////13/04/08
                                            }
                                        } else {
                                            PYY1 = 0 //-w / Len(RWR + F2(PP2)) * 2.5 //////08/10/25
                                        }
                                    } else {
                                        if ( Abs(PY2 - PY1) < 100 ) {
                                        PYY1 = 0.001
                                        RWR = ""
                                        }
                                        if ( s斜めFLG = 1 ) {
                                            DXY = -16
                                            PYY1 = -(w * 1.1) * DLA
                                        } else {
                                            DXY = w / IIf(FR橋脚 = 2, 2, IIf(iKozo = 3, 1.8, 2.2))
                                        }
                                    }
                                } //////////////////13/04/08
                            } else {
                                if ( iKozo = 3 $$ g連続Mod ) {
                                    PYY1 = 0
                                    if ( g文字補正2 > 0.95 ) { //////09/11/13
                                        PYY1 = -(部材荷重Fontsize * Twip / 1.5) * DLA //////09/11/13
                                    } else {if ( g文字補正2 > 0.4 ) {
                                        PYY1 = -(部材荷重Fontsize * Twip / 2.5) * DLA //////09/08/02
                                    } else {
                                        PYY1 = -(部材荷重Fontsize * Twip / 5) * DLA //////09/08/02
                                    }
                                } else {
            //                            if ( 荷重_P1 * 荷重_P2 != 0 ) {
            //                                PYY1 = 05
            //                                if ( max(Abs(荷重_P1), Abs(荷重_P2)) / BU荷重MAX > 0.3 ) { ////////////07/01/06
            //                                    PYY1 = -(部材荷重Fontsize * Twip / 2) ////////////07/01/06 09/08/03
            //                                } else {
            //                                    PYY1 = -(部材荷重Fontsize * Twip / 4) ////////////07/01/06 09/08/03
            //                                }
            //                            } else {
            //                                PYY1 = -部材荷重Fontsize * Twip / 3 //////////////////////////////06/12/14////////////08/10/07
            //                            }
                                    PYY1 = 0 //////09/11/06
                                    if ( max(Abs(荷重_P1), Abs(荷重_P2)) / BU荷重MAX > 0.3 ) { ////////////07/01/06
                                        if ( (水平垂直 = 0 $$ (節X(節点E) = JX_max || 節X(節点E) = JX_max)) ) { //////12/09/14
                                            PYY1 = -(部材荷重Fontsize * Twip / 4)
                                        } else {
                                            PYY1 = -(部材荷重Fontsize * Twip / 2.2)
                                        }
                                        if ( (max(Abs(荷重_P1), Abs(荷重_P2)) / BU荷重MAX > 0.8) || _
                                                (荷重_P1 = 0 $$ Not g連続Mod) ) { ////////////10/10/13
                                            PYY1 = -(部材荷重Fontsize * Twip / 1.7)
                                        }
                                        if ( 下床文字表示 = 1 $$ 荷重_P2 > 0 ) { //////13/11/19
                                            PYY1 = 0 ////////-(部材荷重Fontsize * Twip / 1.7) / 10 //////13/02/27
                                        }
                                    } else {
                                        if ( (水平垂直 = 0 $$ (節X(節点E) = JX_max || 節X(節点E) = JX_max)) ) { //////12/09/14
                                            PYY1 = -(部材荷重Fontsize * Twip / 4)
                                        } else {
                                            PYY1 = -(部材荷重Fontsize * Twip / 2.2)
                                        }
                                    }
                                }
                if ( (荷重方向 = "M" || 荷重方向 = "S") ) {
                  if ( 荷重方向 = "M" ) {
                        DXY = -部材荷重Fontsize * Twip / 40
                  } else {
                        DXY = 部材荷重Fontsize * Twip / 3.3
                  }
                } else {
            //                    if ( ((PX2 - DXY) - KAJYUstrEND) < 50 ) { ////08/10/07
                            if ( (KAJYUstrEND + 部材荷重Fontsize * Twip / 1.3 - (PX2 - DXY)) > 0 ) { ////08/10/07
                                if ( Abs(PX1 - PX2) < 250 ) { ////////09/12/26
                                    DXY = -(KAJYUstrEND + 部材荷重Fontsize * Twip / 1.3 - (PX2 - DXY)) ////// / 1.5////08/10/07
                                } else {
                                    DXY = -40 //////09/12/25
                                }
                            } else {if ( ((PX2 - DXY - KAJYUstrEND) < 400 $$ Abs(PX1 - PX2) < 150) ) {
            //                        DXY = -(max(KAJYUstrEND + 部材荷重Fontsize * Twip / 1.5, (PX2 - DXY)) - (PX2 - DXY)) ////// 05/04/08
                                DXY = -(max((KAJYUstrEND + 部材荷重Fontsize * Twip / 1.5), (PX2 - DXY) - 部材荷重Fontsize * Twip / 1.5) - (PX1 - DXY)) ////// 07/01/07
                            } else {if ( (荷重_P2 < 0 $$ 水平垂直 = 0 $$ 荷重_P1 * 荷重_P2 > 0) ) { //////////////// 04/11/11 nagase
            //                       PYY1 = 800 //240
            //                       荷重_P2 = -荷重_P2//////13/11/19
                            } else {if ( 水平垂直 = 0 $$ 荷重_P1 != 0 $$ Abs(PX1 - PX2) < 250 ) {
                            } else {if ( 水平垂直 = 0 $$ 荷重_P1 = 0 ) {  ////// 05/04/08
            //                        DXY = 部材荷重Fontsize * Twip / 10 ////// 05/04/08//////////////08/12/06コメント
                                if ( Abs(PX1 - PX2) < 350 $$ N段数 = 1 ) { ////////08/10/10
                                    DXY = -部材荷重Fontsize * Twip / 3
                                }
                            } else {
                                DXY = 6 //-部材荷重Fontsize * Twip / 20  ////////08/10/01’/40 ////////05/02/25
                                if ( (水平垂直 = 0 $$ 節X(節点E) = JX_max $$ 荷重_L2 = 0) ) { //////12/09/14 12/11/24
                                    DXY = -175
                                }
                            }
                }
             }
                            if ( FR橋脚 = 1 ) {
                               if ( Not PYY1 = 800 ) {
                                    if ( 水平垂直 != 0 $$ Abs(Y_kajyu位置 - (PY2D + PYY1)) < 部材荷重Fontsize * Twip / 8 $$ Abs(X_kajyu位置 - PX1) < 1000 ) { //////13/01/31
                                        if ( Abs(PY2D - PY1D) < 500 ) { ////////09/12/25
                                             PYY1 = (Y_kajyu位置 + (部材荷重Fontsize * Twip / 3) - PY2D)
                                        } else {
                                             PYY1 = 0 ////////09/12/25
                                        }
                                    } else {
                                        if ( PYY1 = 0.001 ) { PYY1 = 120
                                    }
                               }
                            } else {
                               if ( 水平垂直 != 0 $$ Abs(Y_kajyu位置 - (PY2D + PYY1)) < 部材荷重Fontsize * Twip / 3 ) {
                                    if ( Abs(PY2D - PY1D) < 500 ) { ////////09/12/25
                                        PYY1 = (Y_kajyu位置 + (部材荷重Fontsize * Twip / 3) - PY2D)
                                    } else {
                                        PYY1 = 0 ////////09/12/25
                                    }
                               } else {
                                    if ( PYY1 = 0.001 ) { PYY1 = 120
                               }
                            }
                    if ( s斜めFLG = 2 ) { //////09/10/24 荷重_P2
                        if ( 荷重_P2 > 0 ) {
                            DXY = frmPrint.vsPrt1.TextWidth(strNum) + (部材荷重Fontsize * Twip / 4)
                        } else {
                            DXY = -(frmPrint.vsPrt1.TextWidth(strNum) + (部材荷重Fontsize * Twip / 4))
                        }
                        if ( Sgn(wYs - wYe) = 1 ) {
                            PYY1 = -(部材荷重Fontsize * Twip / 2.5)
                        } else {
                             PYY1 = 0
                        }
                    }
            var KAF2 As Single ////////09/12/04
            KAF2 = 荷重_P2 ////////09/12/04
            yFLG = 1 ////////////08/07/01
            if ( 荷重_P1 != 荷重_P2 $$ 連続P2 = 荷重_P2 $$ 連続P2 = 連続P3 ) { yFLG = 0 ////////////08/07/01
            //if ( 荷重_P1 = 荷重_P2 ) { yFlg = 0
            if ( yFLG = 1 ) {
            if ( (F2(Abs(荷重_P1)) & "-" & Format(PX1, "####0.0") & "-" & Format(PY1, "####0.0") & 荷重方向4 != W分布荷重) ) { //////08/11/03////13/04/08
            if ( Not (iKozo = 1 $$ N段数 = 1 $$ 水平垂直 = 0 $$ Abs(YY_max - (wYe + wYs) / 2) > 1.6) ) { //////10/04/03
            //        m荷重表記縦 = 1 //////08/10/29//////10/10/13
            //        y表記FLG = 1 ////////////09/11/13//////13/02/24
            }
            }
                            if ( 水平垂直 = 9 ) { //////////07/07/26
                                if ( 水平垂直 = 0 $$ y表記FLG = 1 $$ Not (iKozo = 3 $$ g連続Mod) ) { ////////////09/11/13
                                   if ( g文字補正2 > 0.7 ) { ////////09/11/10
                                       strNum = " " & strNum
                                   } else {if ( (荷重_P2 > 0 $$ 荷重_P2 < 10 $$ 荷重_P1 < 10) ) { ////////09/11/10
                                       strNum = " " & strNum
                                   }
                                }
                                m荷重表記縦 = 1 //////10/10/13
                                this.MOJ2L(IIf(荷重_P2 > 0, "U上", "D上"), PX2 - DXY, PY2 + PYY1, PX2D - DXY, PY2D + PYY1, strNum)  ////////07/07/26
            //                        this.MOJ2L(IIf(荷重_P2 > 0, "U上", "D上"), PX2D - DXY, PY2 + PYY1, PX1 - DXY, PY2D + PYY1, strNum) ////////Wn(1) + F2(PP1))
                            } else {
                                if ( 水平垂直 = 0 $$ 荷重_P1 * 荷重_P2 < 0 ) { //////////07/11/01
                                    DXY = 0
                                    if ( 荷重_P2 < 0 ) {
                                        PYY1 = 0 ////////11/12/155//////Abs(PY2 - PY2D)
                                        strNum = RWR + F2(荷重_P2) & strUN & "/m"
                                        KAF2 = Abs(荷重_P2) ////////////////////////////////////////////09/12/04
                                    } else {
                                        PYY1 = -Abs(PY2 - PY2D) ////////09/12/04
                                    }
                                }
                //////08/11/099
                if ( 水平垂直 = 0 $$ 荷重_P1 * 荷重_P2 = 0 $$ 部材正荷重数(BUZAN) < 25 _
                   $$ (JX_max + JX_min) / 2 < (wXs + wXe) / 2 $$ iKozo = 1 $$ (PX2D - PX1D) < 300 ) {
                    DXY = -170
                }
            y表記FLG = 1 //////////09/11/30//////13/02/24
            if ( 水平垂直 = 0 $$ PX2D = PX2 $$ (iKozo = 3 $$ g連続Mod) ) { //////09/08/02
            strNum = " " & strNum
            // }//////09/11/08
            } else {if ( 水平垂直 = 0 $$ y表記FLG = 1 $$ Not (iKozo = 3 $$ g連続Mod) ) {
            //    if ( g文字補正2 > 0.8 $$ PYY1 < 100 ) { ////////09/04/06//////09/04/06
            if ( PYY1 < 100 ) { ////09/11/10
                strNum = " " & strNum
            //    }//////09/11/08
            } else {if ( (荷重_P2 > 0 $$ 荷重_P2 < 10 $$ 荷重_P1 < 10 $$ 荷重_P1 != 0) ) { ////////////09/04/06//////09/11/08
                strNum = " " & strNum
            }
            }
                     if ( 下床文字表示 = 1 $$ (iKozo != 3 || N段数 = 1) ) { ////12/06/04
                        w = frmPrint.vsPrt1.TextWidth(strNum & "1")
                        if ( InStr(strNum, "-") = 0 ) {
            //                    PYY1 = w//////13/02/27
                            DXY = -180 ////13/02/27
                        } else {
                            PYY1 = w + Abs(PY2 - PY2D)
                        }
                    }
                    if ( InStr(部材名(BUZAN), "杭") != 0 ) { //////12/02/15
                        DXY = 10
                    }
                        if ( ((荷重_P1 = 0 $$ 荷重_P2 = 連続P2 $$ 連続P3 = 0)) $$ Abs(z上層両X座標(2) - RT2) > 0.1 ) {
                                if ( 荷重_P1 = 0 ) {
                                    m荷重表記縦 = 0 //////////10/10/13//////10/10/14
                                    y表記FLG = 0 //////13/02/24
                                }
                                if ( (Abs(PX2D - PX2) < 0.1 $$ PY1D = PY1) $$ 荷重_L2 = 0 $$ Not g連続Mod _
                                                $$ Abs(z上層両X座標(2) - RT2) < 0.1 ) { //////10/10/13
                                    w = frmPrint.vsPrt1.TextWidth(strNum & "1")
                                    PYY1 = PYY1 + 200 + w
                                    DXY = (部材荷重Fontsize * Twip / 2) - 30
                                    this.MOJ2L(IIf(荷重_P2 > 0, "U上", "D上"), PX2D + DXY, PY1D - PYY1, PX2 + DXY, PY1D + 1 - PYY1, strNum)
                                } else {
                                    if ( 水平垂直 = 1 $$ Abs(PY1D - PY2D) < 300 ) { //////12/06/044
                                        PYY1 = 部材荷重Fontsize * Twip / 2.5 //////12/06/044
                                    }
            ////////////内水圧 13/01/31
                                    if ( 水平垂直 = 1 $$ iKozo = 3 $$ g連続Mod = False $$ (荷重_L2 / 図Y_SCALE) < 450 $$ _
                                            ((JX_min = 節X(節点S) $$ 荷重_P2 > 0) || (JX_max = 節X(節点S) $$ 荷重_P2 < 0)) ) {
                                        PYY1 = PYE + 200
                                        if ( JX_min = 節X(節点S) ) {
                                            DXY = PX0 + DXY + 500
                                            this.MOJ2L(IIf(KAF2 > 0, "D上", "U上"), DXY, PYY1, DXY + 1000, PYY1, strNum)
                                        } else {
                                            DXY = PX0 // - DXY - 500
                                            this.MOJ2L(IIf(KAF2 > 0, "D上", "U上"), DXY, PYY1, DXY - 500, PYY1, strNum)
                                        }
                                        PYY1 = 0
                                        DXY = 0
                                    } else {
                                        if ( m荷重表記縦 = 0 ) {
                                        PYY1 = (PY2 - PY2D) - 10 ////////- 230 //PYY1 + 30
                                        this.MOJ2L(IIf(KAF2 > 0, "D上", "U上"), PX2D - DXY - 380, PY2D + PYY1, PX2 - DXY + 50, PY2D + PYY1, strNum)
                                        } else {
                                        this.MOJ2L(IIf(KAF2 > 0, "D上", "U上"), PX2D - DXY, PY2D + PYY1, PX2 - DXY, PY2D + PYY1, strNum)
                                        }
                                    }
                                }
                        } else {
                            if ( FLG_側圧 != 0 ) { ////////13/04/08
                                if ( Abs(PY1 - PY2) > 500 || W分布荷重 = "" ) { //////13/04/12
                                    PYY1 = (PY2) + 10
                                } else {
                                    PYY1 = (PY2 + 200 * 0)
                                }
                                    if ( FLG_側圧 = 1 ) {
                                        DXY = DXY / 2 //////300 //////13/04/12
                                    } else {if ( FLG_側圧 = 2 ) {
                                        DXY = DXY / 1.8 //////-260 //////13/04/12
                                    }
                                    this.MOJ2L(IIf(荷重_P2 > 0, "U上", "D上"), PX2D - DXY, PYY1, PX2 - DXY, PYY1 + 1, strNum)
                            } else {
            //                        表示FLG = 0
            //                        if ( g荷重表記縦 = 1 || (荷重_P1 * 荷重_P2 != 0) ) { 表示FLG = 1
            //                        if ( g荷重表記縦 = 0 $$ iKozo = 1 $$ 水平垂直 = 0 $$ Abs(JX_max - wXe) < 0.5 ) { 表示FLG = 0
                                if ( g荷重表記縦 = 1 || (荷重_P1 * 荷重_P2 != 0) ) {
                                    w = frmPrint.vsPrt1.TextWidth(strNum)
                                    PYY1 = (PY2) - w - 50 - 50 //////////13/04/12
                                    DXY = -30 //100
                                    if ( g荷重表記縦 = 0 $$ iKozo = 1 $$ 水平垂直 = 0 $$ Abs(JX_max - wXe) < 0.5 ) {
            //                                DXY = -200
                                        PYY1 = PYY1 + 50
                                    } else {
                                        if ( (水平垂直 = 0 $$ 節X(節点E) = JX_max $$ 荷重_L2 = 0 $$ 節X(節点S) = JX_min) || _
                                        (g荷重表記縦 = 0 $$ iKozo = 3 $$ 水平垂直 = 0 $$ Abs(JX_max - wXe) < 0.5 $$ (荷重_L2 / (JX_max - JX_min)) < 0.2) ) { //////13/04/25

                                            DXY = -50 //////-175 + 100 ////////13/11/19
                                            y表記FLG = 0
                                        } else {
                                            if ( PY2D != PY2 ) { //////13/02/288
                                                m荷重表記縦 = 1
                                                y表記FLG = 1
                                                if ( (水平垂直 = 0 $$ 節X(節点E) = JX_max $$ 荷重_L2 = 0) ) { //////13/12/14
                                                    if ( 荷重図開き > 0 ) { //////13/12/25
                                                        DXY = -175
                                                    } else {
                                                        DXY = -((部材荷重Fontsize * Twip / 6) - 30)
                                                    }
                                                }
                                            }
                                        }
                                    }
            //                            if ( g荷重表記縦 = 0 $$ 水平垂直 = 0 $$ 荷重_P2 < 0 ) { ////////13/11/19

                                    if ( g荷重表記縦 = 0 $$ 水平垂直 = 0 $$ (((節X(節点E) - 荷重_L2) - JX_max) < 0) _
                                                            $$ (iKozo = 3 $$ g連続Mod) ) { //////14/110/14
                                        m荷重表記縦 = 0
                                        y表記FLG = 0
                                        this.MOJ2L(IIf(荷重_P2 > 0, "U上", "D上"), PX2D - 50, PY2 - 200, PX2 + 50 - 50, PY2 - 200, strNum)
                                    } else {
                                        if ( g荷重表記縦 = 0 $$ 水平垂直 = 0 $$ 荷重_P2 < 0 ) { ////////13/11/19
                                            PYY1 = PYY1 + w
                                        }
                                        this.MOJ2L(IIf(荷重_P2 > 0, "U上", "D上"), PX2D - DXY, PYY1, PX2 - DXY, PYY1 + 1, strNum)
                                        if ( (水平垂直 = 0 $$ 節X(節点E) = JX_max $$ 荷重_L2 = 0) ) { //////12/09/14 12/11/24
                                            表示FLG = 0
                                            m荷重表記縦 = 0
                                        }
                                    }
                                } else {
                                    PYY1 = (PY2 - PY2D) - 10 ////////- 230 //PYY1 + 30
                                    this.MOJ2L(IIf(KAF2 > 0, "D上", "U上"), PX2D - DXY - 380, PY2D + PYY1, PX2 - DXY + 50, PY2D + PYY1, strNum)
                                }
                            } ////////13/04/08
                        }
                    }
                            KAJYUstrEND = PX2 - DXY // + (部材荷重Fontsize * Twip / 8)
                            Y_kajyu位置 = (PY2D + PYY1)
                            X_kajyu位置 = PX2 //////13/01/31
                            W分布荷重 = F2(Abs(荷重_P2)) & "-" & Format(PX2, "####0.0") & "-" & Format(PY2, "####0.0") & 荷重方向4 //////13/04/08  //9/19
            } else {
            W分布荷重 = "" ////////////08/07/01
            } //////08/07/01
                        }
                    }
                }
            GRF_ABC:
                if ( 荷重方向 = "S" ) {
                    return;
                }
                DrawLinePrt obj, PX1, PY1, PX2, PY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(PX1), CSng(PY1), CSng(PX2), CSng(PY2))
                }
                DrawLinePrt obj, PX1D, PY1D, PX2D, PY2D
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(PX1D), CSng(PY1D), CSng(PX2D), CSng(PY2D))
                }
                obj.PenWidth = 部材荷重矢Pen幅
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(obj.PenWidth))
                }
                if ( s斜めFLG = 2 ) { ////////////////09/10/24
                    荷重方向 = "H"
                }
                Select Case 荷重方向
                Case "V", "M", "S"
                    if ( PX1 != PX2 ) {
                        AP12 = (PY2 - PY1) / (PX2 - PX1)
                    } else {
                        AP12 = 99999999999#
                    }
                    if ( BCS != 0 ) {
                        矢pit2 = 矢pit / Abs(BCS)
                    } else {
                        矢pit2 = 矢pit
                    }
                    if ( (-Int(-Abs(XX2 - XX1) / 矢pit)) != 0 ) { //////09/10/14
                    矢pit2 = Abs(XX2 - XX1) / (-Int(-Abs(XX2 - XX1) / 矢pit))
                    }
                    XX = XX1
                    JAXX = XX2 - 矢pit2 / 2
                    Do
                        if ( XX >= JAXX ) {
                            Exit Do
                        }
                        if ( BCS = 0 ) {
                            Exit Do
                        }
                        XX = XX + 矢pit2
                        PPXD = PX0 + XX * BCS
                        PPYD = PY0 - XX * BSN
                        PPX = PPXD
                        PPY = AP12 * PPX + (PY1 - AP12 * PX1)
                        DrawLinePrt obj, PPX, PPY, PPXD, PPYD
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(PPX), CSng(PPY), CSng(PPXD), CSng(PPYD))
                        }
                        this.荷重矢印(PPX, PPY, PPXD, PPYD)
                    Loop
                Case "H"
                    AP12 = 99999999999#
                    if ( PX1 != PX2 ) {
                        AP12 = (PY2 - PY1) / (PX2 - PX1)
                    }
                    矢pit2 = 矢pit
                    if ( BSN != 0 ) {
                        矢pit2 = 矢pit / Abs(BSN)
                    }
                    if ( XX1 != XX2 ) {
                        矢pit2 = Abs(XX2 - XX1) / (-Int(-Abs(XX2 - XX1) / 矢pit))
                    }
                    XX = XX1
                    JAXX = XX2 - 矢pit2 / 2
                    Do
                        if ( XX >= JAXX ) {
                            Exit Do
                        }
                        if ( AP12 = 0 ) {
                            Exit Do
                        }
                        if ( BSN = 0 ) {
                            Exit Do
                        }
                        XX = XX + 矢pit2
                        PPXD = PX0 + XX * BCS
                        PPYD = PY0 - XX * BSN
                        PPY = PPYD
                        PPX = (PPY - (PY1 - AP12 * PX1)) / AP12
                        DrawLinePrt obj, PPX, PPY, PPXD, PPYD
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(PPX), CSng(PPY), CSng(PPXD), CSng(PPYD))
                        }
                        this.荷重矢印(PPX, PPY, PPXD, PPYD)
                    Loop
                Case } else {
                    AP12 = 99999999999#
                    if ( XX1 != XX2 ) {
                        AP12 = (Yy2 - YY1) / (XX2 - XX1)
                    }
            //            if ( s斜めFLG = 1 ) { //////09/10/20
                        矢pit2 = 矢pit
            //            } else {
                        if ( XX1 != XX2 ) {
                            矢pit2 = Abs(XX2 - XX1) / (-Int(-Abs(XX2 - XX1) / 矢pit))
                        }
            //            }
                    XX = XX1
                    JAXX = XX2 - 矢pit2 / 2
                    Do
                        if ( XX + 矢pit2 / 2 >= JAXX ) { //////09/10/20
                            Exit Do
                        }
                        XX = XX + 矢pit2
                        YY = YY1 + AP12 * XX - AP12 * XX1
                        if ( s斜めFLG = 1 ) { //////09/10/20
                            PPXD = PX0 + XX * 1
                            PPYD = PY0 - XX * BSN
                            LL = XX
                            if ( LL != 0 ) {
                                sN = YY / LL
                                CS = XX / LL
                            }
                            PPX = PX0 + LL * (1 * CS - 0 * sN)
                            PPY = PY0 - LL * (BSN * CS + BCS * sN)
                        } else {
                            PPXD = PX0 + XX * BCS
                            PPYD = PY0 - XX * BSN
                            LL = Sqr(XX ^ 2 + YY ^ 2)
                            if ( LL != 0 ) {
                                sN = YY / LL
                                CS = XX / LL
                            }
                            PPX = PX0 + LL * (BCS * CS - BSN * sN)
                            PPY = PY0 - LL * (BSN * CS + BCS * sN)
                        }
                        DrawLinePrt obj, PPX, PPY, PPXD, PPYD
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(PPX), CSng(PPY), CSng(PPXD), CSng(PPYD))
                        }
                        this.荷重矢印(PPX, PPY, PPXD, PPYD)
                    Loop
                End Select
            Case 3  // 部材直角方向三角形分布荷重 3333
                if ( PP1 + PP2 = 0 ) {
                    return;
                }
                if ( (JX_max = JX_min) ) { ////////////////////////////////////////////////////////////////////04/07/20
                   垂直左右 = 垂直左右 + BSN * (荷重_P1 + 荷重_P2)
                }
                if ( 荷重_P1 != 0 ) {
                    DrawLinePrt obj, PX1, PY1, PX1D, PY1D
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(PX1), CSng(PY1), CSng(PX1D), CSng(PY1D))
                    }
                    this.荷重矢印(PX1, PY1, PX1D, PY1D)
                    DrawLinePrt obj, PX2, PY2, PX2D, PY2D
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(PX2), CSng(PY2), CSng(PX2D), CSng(PY2D))
                    }
                    this.荷重矢印(PX2, PY2, PX2D, PY2D)
                    if ( 水平垂直 = 0 || 荷重方向5 = "V" || 荷重方向5 = "M" ) {
                        s荷重位置 = min(s荷重位置, PY1) //////13/04/20
                        s荷重位置 = min(s荷重位置, PY1D)
                    }
                }
                荷重図上開き = Abs((荷重寸法線位置(2) + hosei) * Twip) - Abs(YY3)
                if ( 荷重_P2 != 0 ) {
            //            if ( strUN = "" ) { ////////////////////////////////////07/05/12
            //                strNum = "W2=" + F2(PP2)
            //            } else {
                        strNum = F2(PP2) & strUN & "/m"
            //            }
                    if ( 荷重図上開き > 文字H $$ 荷重_P1 = 0 ) {
                        文字位置 = "D上*"
                        if ( 荷重_P2 < 0 ) {
                            文字位置 = "U上*"
                        }
                        this.MOJ2C(文字位置, PX1, PY1, PX2, PY2, strNum)
                    } else {
                    m荷重表記縦 = 1 //////08/10/29
                    y表記FLG = 1 ////////////09/11/13
                        this.MOJ2L("U上", PX1D - DXY, PY1D, PX1 - DXY, PY1, " " + strNum)
                        this.MOJ2L("D上", PX2D + DXY, PY2D, PX2 + DXY, PY2, " " + strNum)
                    }
                    if ( ((荷重_P1 > 0 || 荷重_P2 > 0)) $$ (水平垂直 = 0 || 荷重方向5 = "V" || 荷重方向5 = "M") ) {
                        s荷重位置 = min(s荷重位置, PY1) //////13/04/20
                        s荷重位置 = min(s荷重位置, PY1D)
                        s荷重位置 = min(s荷重位置, PY2)
                        s荷重位置 = min(s荷重位置, PY2D)
                    }
                }
                if ( 荷重_P1 != 0 ) {
            //            if ( strUN = "" ) { ////////////////////////////////////07/05/12
            //                strNum = "W1=" + F2(Abs(荷重_P1 + 荷重_P2))
            //            } else {
                        strNum = F2(Abs(荷重_P1 + 荷重_P2)) & strUN & "/m"
            //            }
                    if ( 荷重図上開き > 文字H ) {
                        文字位置 = "D上*"
                        if ( 荷重_P1 < 0 ) {
                            文字位置 = "U上*"
                        }
                        this.MOJ2C(文字位置, PX13, PY13, PX23, PY23, " " & strNum) ////08/10/29//////"W1=" + F2(Abs(荷重_P1 + 荷重_P2)))
                    } else {
                        PXX1 = (PX1 + PX3) / 2
                        PYY1 = (PY1 + PY3) / 2
                        PXX2 = (PX2 + PX3) / 2
                        PYY2 = (PY2 + PY3) / 2
                        this.MOJ2C("C上", PXX1, PYY1, PXX2, PYY2, strNum) //////"W1=" + F2(Abs(荷重_P1 + 荷重_P2)))
                    }
                }
                DrawLinePrt obj, PX1, PY1, PX3, PY3
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(PX1), CSng(PY1), CSng(PX3), CSng(PY3))
                }
                DrawLinePrt obj, PX2, PY2, PX3, PY3
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(PX2), CSng(PY2), CSng(PX3), CSng(PY3))
                }
                DrawLinePrt obj, PX1D, PY1D, PX2D, PY2D
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(PX1D), CSng(PY1D), CSng(PX2D), CSng(PY2D))
                }
                obj.PenWidth = 部材荷重矢Pen幅
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(obj.PenWidth))
                }
                Select Case 荷重方向
                Case "V", "M", "S"
                    AP13 = 99999999999#
                    if ( PX1 != PX3 ) {
                        AP13 = (PY3 - PY1) / (PX3 - PX1)
                    }
                    矢pit2 = Abs(XX3 - XX1) / (-Int(-Abs(XX3 - XX1) / 矢pit))
                    XX = XX1
                    JAXX = XX3 - 矢pit2 / 2
                    Do
                        if ( XX >= JAXX ) {
                            Exit Do
                        }
                        if ( BCS = 0 ) {
                            Exit Do
                        }
                        XX = XX + 矢pit2
                        PPXD = PX0 + XX * BCS
                        PPYD = PY0 - XX * BSN
                        PPX = PPXD
                        PPY = AP13 * PPX + (PY1 - AP13 * PX1)
                        DrawLinePrt obj, PPX, PPY, PPXD, PPYD
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(PPX), CSng(PPY), CSng(PPXD), CSng(PPYD))
                        }
                        this.荷重矢印(PPX, PPY, PPXD, PPYD)
                    Loop
                    AP32 = 99999999999#
                    if ( PX3 != PX2 ) {
                        AP32 = (PY2 - PY3) / (PX2 - PX3)
                    }
                    矢pit2 = Abs(XX2 - XX1) / (-Int(-Abs(XX2 - XX1) / 矢pit))
                    XX = XX1
                    JAXX = XX2 - 矢pit2 / 2
                    Do
                        if ( XX >= JAXX ) {
                            Exit Do
                        }
                        if ( BCS = 0 ) {
                            Exit Do
                        }
                        XX = XX + 矢pit2
                        PPXD = PX0 + XX * BCS
                        PPYD = PY0 - XX * BSN
                        PPX = PPXD
                        PPY = AP32 * PPX + (PY3 - AP32 * PX3)
                        DrawLinePrt obj, PPX, PPY, PPXD, PPYD
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(PPX), CSng(PPY), CSng(PPXD), CSng(PPYD))
                        }
                        this.荷重矢印(PPX, PPY, PPXD, PPYD)
                    Loop
                Case "H"
                    AP13 = 99999999999#
                    if ( PX1 != PX3 ) {
                        AP13 = (PY3 - PY1) / (PX3 - PX1)
                    }
                    矢pit2 = Abs(XX3 - XX1) / (-Int(-Abs(XX3 - XX1) / 矢pit))
                    XX = XX1
                    JAXX = XX3 - 矢pit2 / 2
                    Do
                        if ( XX >= JAXX ) {
                            Exit Do
                        }
                        if ( AP13 = 0 ) {
                            Exit Do
                        }
                        if ( BSN = 0 ) {
                            Exit Do
                        }
                        XX = XX + 矢pit2
                        PPXD = PX0 + XX * BCS
                        PPYD = PY0 - XX * BSN
                        PPY = PPYD
                        PPX = (PPY - (PY1 - AP13 * PX1)) / AP13
                        DrawLinePrt obj, PPX, PPY, PPXD, PPYD
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(PPX), CSng(PPY), CSng(PPXD), CSng(PPYD))
                        }
                        this.荷重矢印(PPX, PPY, PPXD, PPYD)
                    Loop
                    AP32 = 99999999999#
                    if ( PX3 != PX2 ) {
                        AP32 = (PY2 - PY3) / (PX2 - PX3)
                    }
                    JAXX = XX2 - 矢pit2 / 2
                    Do
                        if ( XX >= JAXX ) {
                            Exit Do
                        }
                        if ( AP32 = 0 ) {
                            Exit Do
                        }
                        if ( BSN = 0 ) {
                            Exit Do
                        }
                        XX = XX + 矢pit2
                        PPXD = PX0 + XX * BCS
                        PPYD = PY0 - XX * BSN
                        PPY = PPYD
                        PPX = (PPY - (PY3 - AP32 * PX3)) / AP32
                        DrawLinePrt obj, PPX, PPY, PPXD, PPYD
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(PPX), CSng(PPY), CSng(PPXD), CSng(PPYD))
                        }
                        this.荷重矢印(PPX, PPY, PPXD, PPYD)
                    Loop
                Case } else {
                    AP13 = 99999999999#
                    if ( XX1 != XX3 ) {
                        AP13 = (YY3 - YY1) / (XX3 - XX1)
                    }
                    矢pit2 = Abs(XX3 - XX1) / (-Int(-Abs(XX3 - XX1) / 矢pit))
                    XX = XX1
                    JAXX = XX3 - 矢pit2 / 2
                    Do
                        if ( XX > JAXX ) {
                            Exit Do
                        }
                        XX = XX + 矢pit2
                        YY = YY1 + AP13 * XX - AP13 * XX1
                        PPXD = PX0 + XX * BCS
                        PPYD = PY0 - XX * BSN
                        LL = Sqr(XX ^ 2 + YY ^ 2)
                        if ( LL != 0 ) {
                            sN = YY / LL
                        CS = XX / LL
                        }
                        PPX = PX0 + LL * (BCS * CS - BSN * sN)
                        PPY = PY0 - LL * (BSN * CS + BCS * sN)
                        DrawLinePrt obj, PPX, PPY, PPXD, PPYD
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(PPX), CSng(PPY), CSng(PPXD), CSng(PPYD))
                        }
                        this.荷重矢印(PPX, PPY, PPXD, PPYD)
                    Loop
                    AP32 = 99999999999#
                    if ( XX3 != XX2 ) {
                        AP32 = (Yy2 - YY3) / (XX2 - XX3)
                    }
                    JAXX = XX2 - 矢pit2 / 2
                    Do
                        if ( XX >= JAXX ) {
                            Exit Do
                        }
                        XX = XX + 矢pit2
                        YY = YY3 + AP32 * XX - AP32 * XX3
                        PPXD = PX0 + XX * BCS
                        PPYD = PY0 - XX * BSN
                        LL = Sqr(XX ^ 2 + YY ^ 2)
                        if ( LL != 0 ) {
                            sN = YY / LL
                            CS = XX / LL
                        }
                        PPX = PX0 + LL * (BCS * CS - BSN * sN)
                        PPY = PY0 - LL * (BSN * CS + BCS * sN)
                        DrawLinePrt obj, PPX, PPY, PPXD, PPYD
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(PPX), CSng(PPY), CSng(PPXD), CSng(PPYD))
                        }
                        this.荷重矢印(PPX, PPY, PPXD, PPYD)
                    Loop
                End Select
            Case 4  // 部材直角方向台形分布荷重 4444
                if ( PP1 + PP2 = 0 ) {
                    return;
                }
                if ( (JX_max = JX_min) ) { ////////////////////////////////////////////////////////////////////04/07/20
                   垂直左右 = 垂直左右 + BSN * (荷重_P1 + 荷重_P2)
                }
                DrawLinePrt obj, PX0, PY0, PX1, PY1
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(PX0), CSng(PY0), CSng(PX1), CSng(PY1))
                }
                DrawLinePrt obj, PX1, PY1, PX2, PY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(PX1), CSng(PY1), CSng(PX2), CSng(PY2))
                }
                DrawLinePrt obj, PX2, PY2, PXE, PYE
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(PX2), CSng(PY2), CSng(PXE), CSng(PYE))
                }
                DrawLinePrt obj, PX0, PY0, PXE, PYE
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(PX0), CSng(PY0), CSng(PXE), CSng(PYE))
                }
                if ( ((荷重_P1 > 0 || 荷重_P2 > 0)) $$ (水平垂直 = 0 || 荷重方向5 = "V" || 荷重方向5 = "M") ) {
                    s荷重位置 = min(s荷重位置, PY1) //////13/04/20
                    s荷重位置 = min(s荷重位置, PY1D)
                    s荷重位置 = min(s荷重位置, PY2)
                    s荷重位置 = min(s荷重位置, PY2D)
                }
                if ( 荷重_P1 = 荷重_P2 ) {
            //            if ( strUN = "" ) { ////////////////////////////////////07/05/12
            //                strNum = RWR + F2(PP1)
            //            } else {
                        strNum = F2(PP1) & strUN & "/m"
            //            }
                    DXY = 0
                    RWR = " W="
                    if ( RR橋脚 = 2 ) {
                        DXY = -部材荷重Fontsize * Twip / 1.2
                        RWR = "W="
                    }
                    if ( 荷重図上開き > 文字H ) {
                        文字位置 = "D上*"
                        if ( 荷重_P1 < 0 ) {
                            文字位置 = "U上*"
                        }
                        this.MOJ2C(文字位置, PX1 - DXY, PY1, PX2 - DXY, PY2, " " & strNum) ////08/10/29// RWR + F2(PP1))
                    } else {
                        PXX1 = (PX1 + PX1D) / 2
                        PYY1 = (PY1 + PY1D) / 2
                        PXX2 = (PX2 + PX2D) / 2
                        PYY2 = (PY2 + PY2D) / 2
                        this.MOJ2C("C上", PXX1 - DXY, PYY1, PXX2 - DXY, PYY2, strNum) ////// RWR + F2(PP1))
                    }
                } else {
                    if ( 荷重_P1 != 0 ) {
            //                if ( strUN = "" ) { ////////////////////////////////////07/05/12
            //                    strNum = "  W1=" + F2(PP1) //////08/10/29
            //                } else {
                            strNum = "    " & F2(PP1) & strUN & "/m" //////08/07/08 08/10/29
            //                }
                        if ( 水平垂直 = 0 $$ (PX2D - PX1D) > 600 ) { //////08/07/08
                            DXY = 部材荷重Fontsize * Twip / 3
                        } else {
                            DXY = 0
                        }
                        m荷重表記縦 = 1 //////08/10/29
                        y表記FLG = 1 ////////////09/11/13
                        this.MOJ2L("D上", PX1D + DXY, PY1D, PX1 + DXY, PY1, strNum) //////" W1=" + F2(PP1))
                    }
                    if ( 荷重_P2 != 0 ) {
            //                if ( strUN = "" ) { ////////////////////////////////////07/05/12
            //                    strNum = "  W2=" + F2(PP2) //////08/10/29
            //                } else {
                            strNum = "    " & F2(PP2) & strUN & "/m" //////08/07/08 //////08/10/29
            //                }
                        if ( 水平垂直 = 0 $$ (PX2D - PX1D) > 600 ) { //////08/07/08
                            DXY = 0
                        } else {
                            DXY = 部材荷重Fontsize * Twip / 3
                        }
                        m荷重表記縦 = 1 //////08/10/29
                        y表記FLG = 1 ////////////09/11/13
                        this.MOJ2L("D上", PX2D + DXY, PY2D - (PY1 - PY2), PX2 + DXY, PY2, strNum) //////08/10/292
                    }
                }
                obj.PenWidth = 部材荷重矢Pen幅
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(obj.PenWidth))
                }
                Select Case 荷重方向
                Case "V", "M", "S"
                    AP01 = 99999999999#
                    if ( PX0 != PX1 ) {
                        AP01 = (PY1 - PY0) / (PX1 - PX0)
                    }
                    矢pit2 = Abs(XX1) / (-Int(-Abs(XX1) / 矢pit))
                    XX = 0
                    JAXX = XX1 - 矢pit2 / 2
                    Do
                        if ( XX >= JAXX ) {
                            Exit Do
                        }
                        if ( BCS = 0 ) {
                            Exit Do
                        }
                        XX = XX + 矢pit2
                        PPXD = PX0 + XX * BCS
                        PPYD = PY0 - XX * BSN
                        PPX = PPXD
                        PPY = AP01 * PPX + (PY0 - AP01 * PX0)
                        DrawLinePrt obj, PPX, PPY, PPXD, PPYD
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(PPX), CSng(PPY), CSng(PPXD), CSng(PPYD))
                        }
                        this.荷重矢印(PPX, PPY, PPXD, PPYD)
                    Loop
                    AP12 = 99999999999#
                    if ( PX1 != PX2 ) {
                        AP12 = (PY2 - PY1) / (PX2 - PX1)
                    }
                    JAXX = XX2 - 矢pit2
                    Do
                        if ( XX >= JAXX ) {
                            Exit Do
                        }
                        if ( BCS = 0 ) {
                            Exit Do
                        }
                        XX = XX + 矢pit2
                        PPXD = PX0 + XX * BCS
                        PPYD = PY0 - XX * BSN
                        PPX = PPXD
                        PPY = AP12 * PPX + (PY1 - AP12 * PX1)
                        DrawLinePrt obj, PPX, PPY, PPXD, PPYD
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(PPX), CSng(PPY), CSng(PPXD), CSng(PPYD))
                        }
                        this.荷重矢印(PPX, PPY, PPXD, PPYD)
                    Loop
                    AP2E = 99999999999#
                    if ( PX2 != PXE ) {
                        AP2E = (PYE - PY2) / (PXE - PX2)
                    }
                    JAXX = XXE - 矢pit2 / 2
                    Do
                        if ( XX >= JAXX ) {
                            Exit Do
                        }
                        if ( BCS = 0 ) {
                            Exit Do
                        }
                        XX = XX + 矢pit2
                        PPXD = PX0 + XX * BCS
                        PPYD = PY0 - XX * BSN
                        PPX = PPXD
                        PPY = AP2E * PPX + (PY2 - AP2E * PX2)
                        DrawLinePrt obj, PPX, PPY, PPXD, PPYD
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(PPX), CSng(PPY), CSng(PPXD), CSng(PPYD))
                        }
                        this.荷重矢印(PPX, PPY, PPXD, PPYD)
                    Loop
                Case "H"
                    AP01 = 99999999999#
                    if ( PX0 != PX1 ) {
                        AP01 = (PY1 - PY0) / (PX1 - PX0)
                    }
                    矢pit2 = Abs(XX1) / (-Int(-Abs(XX1) / 矢pit))
                    XX = 0
                    JAXX = XX1 - 矢pit2 / 2
                    Do
                        if ( XX >= JAXX ) {
                            Exit Do
                        }
                        if ( AP01 = 0 ) {
                            Exit Do
                        }
                        if ( BSN = 0 ) {
                            Exit Do
                        }
                        XX = XX + 矢pit2
                        PPXD = PX0 + XX * BCS
                        PPYD = PY0 - XX * BSN
                        PPY = PPYD
                        PPX = (PPY - (PY0 - AP01 * PX0)) / AP01
                        DrawLinePrt obj, PPX, PPY, PPXD, PPYD
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(PPX), CSng(PPY), CSng(PPXD), CSng(PPYD))
                        }
                        this.荷重矢印(PPX, PPY, PPXD, PPYD)
                    Loop
                    AP12 = 99999999999#
                    if ( PX1 != PX2 ) {
                        AP12 = (PY2 - PY1) / (PX2 - PX1)
                    }
                    JAXX = XX2 - 矢pit2 / 2
                    Do
                        if ( XX >= JAXX ) {
                            Exit Do
                        }
                        if ( AP12 = 0 ) {
                            Exit Do
                        }
                        if ( BSN = 0 ) {
                            Exit Do
                        }
                        XX = XX + 矢pit2
                        PPXD = PX0 + XX * BCS
                        PPYD = PY0 - XX * BSN
                        PPY = PPYD
                        PPX = (PPY - (PY1 - AP12 * PX1)) / AP12
                        DrawLinePrt obj, PPX, PPY, PPXD, PPYD
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(PPX), CSng(PPY), CSng(PPXD), CSng(PPYD))
                        }
                        this.荷重矢印(PPX, PPY, PPXD, PPYD)
                    Loop
                    AP2E = 99999999999#
                    if ( PX2 != PXE ) {
                        AP2E = (PYE - PY2) / (PXE - PX2)
                    }
                    JAXX = XXE - 矢pit2 / 2
                    Do
                        if ( XX >= JAXX ) {
                            Exit Do
                        }
                        if ( AP2E = 0 ) {
                            Exit Do
                        }
                        if ( BSN = 0 ) {
                            Exit Do
                        }
                        XX = XX + 矢pit2
                        PPXD = PX0 + XX * BCS
                        PPYD = PY0 - XX * BSN
                        PPY = PPYD
                        PPX = (PPY - (PY2 - AP2E * PX2)) / AP2E
                        DrawLinePrt obj, PPX, PPY, PPXD, PPYD
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(PPX), CSng(PPY), CSng(PPXD), CSng(PPYD))
                        }
                        this.荷重矢印(PPX, PPY, PPXD, PPYD)
                    Loop
                Case } else {
                    AP01 = 99999999999#
                    if ( 0 != XX1 ) {
                        AP01 = YY1 / XX1
                        矢pit2 = Abs(XX1) / (-Int(-Abs(XX1) / 矢pit))
                        XX = 0
                        JAXX = XX1 - 矢pit2 / 2
                     }
                    Do
                        if ( XX >= JAXX ) {
                            Exit Do
                        }
                        XX = XX + 矢pit2
                        YY = AP01 * XX
                        PPXD = PX0 + XX * BCS
                        PPYD = PY0 - XX * BSN
                        LL = Sqr(XX ^ 2 + YY ^ 2)
                        if ( LL != 0 ) {
                            sN = YY / LL
                            CS = XX / LL
                        }
                        PPX = PX0 + LL * (BCS * CS - BSN * sN)
                        PPY = PY0 - LL * (BSN * CS + BCS * sN)
                        DrawLinePrt obj, PPX, PPY, PPXD, PPYD
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(PPX), CSng(PPY), CSng(PPXD), CSng(PPYD))
                        }
                        this.荷重矢印(PPX, PPY, PPXD, PPYD)
                    Loop
                    AP12 = 99999999999#
                    if ( XX1 != XX2 ) {
                        AP12 = (Yy2 - YY1) / (XX2 - XX1)
                    }
                    if ( XX2 = XX1 ) {
                        矢pit2 = 矢pit
                    } else {
                        矢pit2 = Abs(XX2 - XX1) / (-Int(-Abs(XX2 - XX1) / 矢pit))
                    }
                    JAXX = XX2 - 矢pit2 / 2
                    Do
                        if ( XX >= JAXX ) {
                            Exit Do
                        }
                        XX = XX + 矢pit2
                        YY = YY1 + AP12 * XX - AP12 * XX1
                        PPXD = PX0 + XX * BCS
                        PPYD = PY0 - XX * BSN
                        LL = Sqr(XX ^ 2 + YY ^ 2)
                        if ( LL != 0 ) {
                            sN = YY / LL
                            CS = XX / LL
                        }
                        PPX = PX0 + LL * (BCS * CS - BSN * sN)
                        PPY = PY0 - LL * (BSN * CS + BCS * sN)
                        DrawLinePrt obj, PPX, PPY, PPXD, PPYD
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(PPX), CSng(PPY), CSng(PPXD), CSng(PPYD))
                        }
                        this.荷重矢印(PPX, PPY, PPXD, PPYD)
                    Loop
                    AP2E = 99999999
                    if ( XX2 != XXE ) {
                        AP2E = (YYE - Yy2) / (XXE - XX2)
                    }
                    if ( XXE = XX2 ) {
                        矢pit2 = 矢pit
                    } else {
                        矢pit2 = Abs(XXE - XX2) / (-Int(-Abs(XXE - XX2) / 矢pit))
                    }
                    XX = XX2
                    JAXX = XXE - 矢pit2 / 2
                    Do
                        if ( XX >= JAXX ) {
                            Exit Do
                        }
                        XX = XX + 矢pit2
                        YY = Yy2 + AP2E * XX - AP2E * XX2
                        PPXD = PX0 + XX * BCS
                        PPYD = PY0 - XX * BSN
                        LL = Sqr(XX ^ 2 + YY ^ 2)
                        if ( LL != 0 ) {
                            sN = YY / LL
                            CS = XX / LL
                        }
                        PPX = PX0 + LL * (BCS * CS - BSN * sN)
                        PPY = PY0 - LL * (BSN * CS + BCS * sN)
                        DrawLinePrt obj, PPX, PPY, PPXD, PPYD
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(PPX), CSng(PPY), CSng(PPXD), CSng(PPYD))
                        }
                        this.荷重矢印(PPX, PPY, PPXD, PPYD)
                    Loop
                End Select
            Case 5  // 部材方向集中荷重 5555
                var F方向 As Integer
                var vFLG As Integer //////08/12/01
                var n柱X As Single
                var HASIRA1 As Single, HASIRA2 As Single
                //
                if ( 水平垂直 = 1 ) {
                    if ( g柱本数 = 0 ) {
                        n柱X = (JX_max + JX_min) / 2
                    } else {
                        HASIRA1 = 99999: HASIRA2 = -99999
                        For( vFLG = 1 To g柱本数
                            HASIRA1 = min(HASIRA1, g柱X座標(vFLG, 1))
                            HASIRA2 = max(HASIRA2, g柱X座標(vFLG, 1))
                        Next
                        n柱X = (HASIRA1 + HASIRA2) / 2
                    } //////08/11/25
                } else {
            ////////
            //        if ( N段数 != 1 ) { ////////09/11/18  V,M,H が一緒の場合
            //            For( i7 = BUZAN To BUZAN9
            //                MAK_5_11 = max(MAK_5_11, 部材正荷重数(i7)) ////////09/11/18
            //            }7
            //            PX1D = PX1D - MAK_5_11 * BSN
            //            PX2D = PX2D - MAK_5_11 * BSN
            //            PY1D = PY1D - MAK_5_11 * BCS
            //            PY2D = PY2D - MAK_5_11 * BCS
            //        }
            ////////
                }
                F方向 = 1
                if ( InStr(部材名(BUZAN), "杭") = 1 || _
                        (水平垂直 = 1 $$ n柱X >= (wXs + wXe) / 2) ) { //////08/12/01 ===
                    F方向 = -1
                }
                //
                if ( 荷重_P1 != 0 ) {
                    DrawCirclePrt obj, PX1D, PY1D, 0.3 * Twip //◯
                    if ( CreateDxfFlag = 1 ) {
                        EnPRM1 = CSng(PX1D)
                        EnPRM2 = CSng(PY1D)
                        EnPRM3 = CSng(0.3 * Twip)
                        EnPRM4 = 0
                        EnPRM5 = 360
                        EnTYPE1 = 7
                        this.PLOTCIRCLE(EnPRM1, EnPRM2, EnPRM3, EnPRM4, EnPRM5, EnTYPE1)
                    }
                    if ( 水平垂直 = 0 ) { // 水平 8/28
                        PY1D = PY1D - 0.4 * Twip
                        PPX1 = PX1D - YY1 * BCS
                        PPY1 = PY1D + YY1 * BSN - 1.6 * Twip
                    }
                    if ( 水平垂直 = 1 || 水平垂直 = 9 ) { // 垂直 斜材 //////////07/01/077
                        PX1D = PX1D + 0.4 * Twip * F方向
                        PPX1 = PX1D - YY1 * BCS + 1.6 * Twip * F方向
                        PPY1 = PY1D + YY1 * BSN
                    }
                    PX1D = PX1D + (PPX1 - PX1D) / 8
                    PY1D = PY1D + (PPY1 - PY1D) / 8
                    obj.PenWidth = 部材荷重Pen幅 + 6
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(obj.PenWidth))
                    }
                    DrawLinePrt obj, PPX1, PPY1, PX1D, PY1D
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(PPX1), CSng(PPY1), CSng(PX1D), CSng(PY1D))
                    }
                    obj.PenWidth = 部材荷重Pen幅
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(obj.PenWidth))
                    }
                    if ( 荷重_P1 > 0 || 水平垂直 = 0 ) {
                        this.荷重矢印(PPX1, PPY1, PX1D, PY1D)
                    } else {
                        this.荷重矢印(PX1D, PY1D, PPX1, PPY1)
                    }
                    if ( Abs(PPY1 - PY1D) < 0.1 ) {
                        PPX1 = PPX1 - 部材荷重Fontsize * Twip
                        PX1D = PX1D - 部材荷重Fontsize * Twip
                    }
                    if ( 水平垂直 = 0 ) {
                        if ( 荷重_P1 > 0 ) {
                                PPX1 = PPX1 - 部材荷重Fontsize * Twip / 3 - 2 * Twip //////09/10/06
                                PX1D = PX1D - 部材荷重Fontsize * Twip / 3 - 2 * Twip
                                PPY1 = PPY1 - 1 * Twip
                                PY1D = PY1D - 1 * Twip
            //                    if ( strUN = "" ) { ////////////////////////////////////07/05/12
            //                    strAB = "P=" + F2(Abs(荷重_P1)) + " "
            //                    } else {
                            strAB = F2(Abs(荷重_P1)) + strUN + " " //////09/10/06
            //                    }
                        } else {
                                PPX1 = PPX1 + 部材荷重Fontsize * Twip / 3 //////09/10/06
                                PX1D = PX1D + 部材荷重Fontsize * Twip / 3
                                PPY1 = PPY1 - 1 * Twip
                                PY1D = PY1D - 1 * Twip
            //                    if ( strUN = "" ) { ////////////////////////////////////07/05/12
            //                    strAB = "   P=" + F2(Abs(荷重_P1))
            //                    } else {
                            strAB = "   " + F2(Abs(荷重_P1)) + strUN
            //                    }
                        }
                        if ( g連続Mod ) { //////13/04/25
                            if ( PPY1 < PY1D ) {
                                PPY1 = PPY1 + 0.8 * Twip
                                PY1D = PPY1
                            } else {
                                PY1D = PY1D + 0.8 * Twip
                                PPY1 = PY1D
                            }
                        } else {
                            PPY1 = max(HEN_Y(wYs), HEN_Y(wYe)) - (部材荷重Fontsize) * Twip / 3 //////13/08/11  + (部材荷重Fontsize) * Twip / 2
                            PY1D = PPY1
                            strAB = F2(Abs(荷重_P1)) + strUN + " "
                        }
                        if ( (PPX1 + PPY1 - Mark5前位置) < -200 ) {
                            PPY1 = PYE - 200 //////+ 500
                            PY1D = PYE - 200 //////+ 500
                        }
                        this.MOJ2C("D上", PPX1, PPY1, PX1D, PY1D, strAB, 6)
                        Mark5前位置 = PPX1 + PPY1 + frmPrint.vsPrt1.TextWidth(strAB)
                    } else {
                        if ( 荷重_P1 > 0 ) {
            //                    if ( strUN = "" ) { ////////////////////////////////////07/05/12
            //                    strAB = " P=" + F2(Abs(荷重_P1)) + " "
            //                    } else {
                            strAB = " " + F2(Abs(荷重_P1)) + strUN
            //                    }
                        } else {
            //                    if ( strUN = "" ) { ////////////////////////////////////07/05/12
            //                    strAB = " P=" + F2(Abs(荷重_P1))
            //                    } else {
                            strAB = " " + F2(Abs(荷重_P1)) + strUN
            //                    }
                        }
                        if ( 水平垂直 = 9 ) { ////////////////////////07/01/077
                            if ( F方向 = 1 ) {
                                this.MOJ2C("D上", PPX1, PPY1 + 50, PX1D, PY1D + 50, strAB, 5)
                            } else {
                                this.MOJ2C("D上", PX1D, PPY1 + 50, PX1D, PY1D + 50, strAB, 5)
                            }
                        } else {
                            if ( F方向 = 1 ) {
                                this.MOJ2C("D上", PPX1, PPY1 - 100, PX1D, PY1D - 100, strAB, 5)
                            } else {
                                this.MOJ2C("D上", PX1D + 80, PPY1 - 200, PX1D + 80, PY1D - 200, strAB, 5) ////////08/12/01
                            }
                        }
                    }
                }
                if ( 荷重_P2 != 0 ) {
                    DrawCirclePrt obj, PX2D, PY2D, 0.3 * Twip //◯
                    if ( CreateDxfFlag = 1 ) {
                        EnPRM1 = CSng(PX2D)
                        EnPRM2 = CSng(PY2D)
                        EnPRM3 = CSng(0.3 * Twip)
                        EnPRM4 = 0
                        EnPRM5 = 360
                        EnTYPE1 = 7
                        this.PLOTCIRCLE(EnPRM1, EnPRM2, EnPRM3, EnPRM4, EnPRM5, EnTYPE1)
                    }
                    if ( 水平垂直 = 0 ) { // 水平 8/28
                        PY2D = PY2D - 0.4 * Twip
                        PPX2 = PX2D - Yy2 * BCS
                        PPY2 = PY2D + Yy2 * BSN - 1.6 * Twip
                    }
                    if ( 水平垂直 = 1 ) { // 垂直 8/28
                        PX2D = PX2D + 0.4 * Twip * F方向
                        PPX2 = PX2D - Yy2 * BCS + 1.6 * Twip * F方向
                        PPY2 = PY2D + Yy2 * BSN
                    }
                    PX2D = PX2D + (PPX2 - PX2D) / 8
                    PY2D = PY2D + (PPY2 - PY2D) / 8
                    obj.PenWidth = 部材荷重Pen幅 + 6
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(obj.PenWidth))
                    }
                    DrawLinePrt obj, PPX2, PPY2, PX2D, PY2D
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(PPX2), CSng(PPY2), CSng(PX2D), CSng(PY2D))
                    }
                    obj.PenWidth = 部材荷重Pen幅
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(obj.PenWidth))
                    }
                    if ( 荷重_P2 > 0 || 水平垂直 = 0 ) {
                        this.荷重矢印(PPX2, PPY2, PX2D, PY2D)
                    } else {
                        this.荷重矢印(PX2D, PY2D, PPX2, PPY2)
                    }
                    if ( Abs(PPY1 - PY1D) < 0.1 ) {
                       PPX2 = PPX2 - 部材荷重Fontsize * Twip
                       PX2D = PX2D - 部材荷重Fontsize * Twip
                    }
            //                if ( strUN = "" ) { ////////////////////////////////////07/05/12
            //                    strNum = " W1=" + F2(PP1)
            //                } else {
            //                    strNum = " " & F2(PP1) & strUN & "/m"
            //                }
                    if ( 水平垂直 = 0 ) {
                        if ( 荷重_P2 > 0 ) {
                                PPX2 = PPX2 + 部材荷重Fontsize * Twip / 1.5
                                PX2D = PX2D + 部材荷重Fontsize * Twip / 1.5
                                PPY2 = PPY2 - 1 * Twip
                                PY2D = PY2D - 1 * Twip
                            strAB = F2(Abs(荷重_P2)) + strUN + "   "
                        } else {
                                PPX2 = PPX2 + (部材荷重Fontsize + 3) * Twip / 1 //////13/04/08
                                PX2D = PX2D + (部材荷重Fontsize + 3) * Twip / 1
                                PPY2 = PPY2 - 1 * Twip
                                PY2D = PY2D - 1 * Twip
                            strAB = "   " + F2(Abs(荷重_P2)) + strUN
                        }
                        if ( g連続Mod ) { //////13/04/25
                            if ( PPY2 < PY2D ) {
                                PPY2 = PPY2 + 0.5 * Twip
                                PY2D = PPY2
                            } else {
                                PY2D = PY2D + 0.5 * Twip
                                PPY2 = PY2D
                            }
                        } else {
                            PPY2 = max(HEN_Y(wYs), HEN_Y(wYe)) - (部材荷重Fontsize) * Twip / 3 //////13/04/08 + (部材荷重Fontsize) * Twip / 2
                            PY2D = PPY2
                            strAB = F2(Abs(荷重_P2)) + strUN
                            if ( 荷重_P1 < 0 $$ 荷重_P2 > 0 $$ Abs(PPX2 - PPX1) < 1000 ) { //////13/08/11
                                PPY2 = PPY2 - 140
                                PY2D = PY2D - 140
                            }
                        }
                        if ( (PPX2 + PPY2 - Mark5前位置) < -200 ) {
                            PPY2 = PYE + 500
                            PY2D = PYE + 500
                        }
                        this.MOJ2C("D上", PPX2, PPY2, PX2D, PY2D, strAB, 6)
                        Mark5前位置 = PPX2 + PPY2 + frmPrint.vsPrt1.TextWidth(strAB)
                    } else {
            //                if ( 荷重_P2 > 0 ) {
            //                    strAB = " P=" + F2(荷重_P2)
            //                } else {
            //                    strAB = " P=" + F2(荷重_P2)
            //                }
            //                if ( strUN = "" ) { ////////////////////////////////////07/05/12
            //                    strAB = " P=" + F2(Abs(Abs(荷重_P2)))
            //                } else {
                            strAB = " " & F2(Abs(荷重_P2)) + strUN
            //                }
            //                this.MOJ2C("D上", PPX2, PPY2 - 100 * F方向, PX2D, PY2D - 100 * F方向, strAB, 5) ////////08/12/01
                        if ( 水平垂直 = 9 ) { ////////////////////////07/01/077
                            if ( F方向 = 1 ) {
                                this.MOJ2C("D上", PPX2, PPY2 + 50, PX2D, PY2D + 50, strAB, 5)
                            } else {
                                this.MOJ2C("D上", PX2D, PPY1 + 50, PX2D, PY2D + 50, strAB, 5)
                            }
                        } else {
                            if ( F方向 = 1 ) {
                                this.MOJ2C("D上", PPX2, PPY2 - 100, PX2D, PY2D - 100, strAB, 5)
                            } else {
                                this.MOJ2C("D上", PX2D + 80, PPY2 - 200, PX2D + 80, PY2D - 200, strAB, 5) ////////08/12/01
                            }
                        }
                    }
                }

            Case 6, 7, 8  //6666 部材方向分布荷重 部材方向三角形分布荷重 部材方向台形分布荷重

                    this.F軸方向分布荷重_678(obj, 節点S, 節点E, 荷重図開き, 荷重方向5, 荷重mark, _
                                 荷重_L1, 荷重_L2, 荷重_P1, 荷重_P2, BUZAN, BUZAN9, CASU, wXs, wXe, wYs, wYe, _
                                 PX0, PY0, PXE, PYE, BCS, BSN, 図BSPAN, YY1, Yy2, PX1D, PX2D, PY1D, PY2D)

            Case 9   // 温度変化①(線膨張) 9999
                //
                    this.F温度変化9_10(obj, 9, 節点S, 節点E, 荷重図開き, 荷重方向5, 荷重mark, 荷重_L1, 荷重_L2, 荷重_P1, 荷重_P2, _
                                        BUZAN, BUZAN9, TATE_flg, CASU, 連続P1, 連続P2, 連続P3, BZA9, _
                                        wXs, wXe, PX0, PY0, PXE, PYE, BCS, 図BSPAN, YY1, Yy2, B角度)

            //            if ( Abs(荷重_P1) * 10 = Int(Abs(荷重_P1) * 10) ) {
            //                MOJ = F1(荷重_P1) + "℃"
            //            } else {
            //                MOJ = F2(荷重_P1) + "℃"
            //            }
            //            DXY = 0
            //            obj.FontSize = 部材荷重Fontsize - 2.5
            //            w = frmPrint.vsPrt1.TextWidth(MOJ)
            //        if ( 図BSPAN > 580 ) { //////////////////////////////////////////////////////////// 05/05/22
            //            PY0 = PY0 - Abs(部材荷重Fontsize * BCS * Twip / 2.5) + 3 * Twip
            //            PYE = PYE - Abs(部材荷重Fontsize * BCS * Twip / 2.5) + 3 * Twip
            //            if ( 水平垂直 = 1 || 水平垂直 = 9 ) { ////////// 05/05/21
            //                if ( (JX_max + JX_min) / 2 < wXs $$ InStr(部材名(BUZAN), "杭") = 0 ) {
            //                    PX0 = PX0 - 3.5 * Twip ////////08/06/11
            //                    PXE = PXE - 3.5 * Twip
            //                } else {
            //                    PX0 = PX0 + 2 * Twip ////////08/06/11
            //                    PXE = PXE + 2 * Twip
            //                }
            //                PY0 = PY0 - 2.5 * Twip
            //                PYE = PYE - 2.5 * Twip
            //            } else {
            //                PY0 = HEN_Y(節Y(節点S)) - 3.5 * Twip //////09/10/28
            //                PYE = HEN_Y(節Y(節点E)) - 3.5 * Twip
            ////                if ( gbolBuZai = 0 ) {
            ////                    PY0 = PY0 - 0.6 * Twip //////// 08/02/01
            ////                    PYE = PYE - 0.6 * Twip
            ////                }
            //            }
            //            if ( wXs != wXe $$ iKozo = 1 ) {
            //                DXY = IIf(垂直中央 = 0, Twip, Twip + 0 + IIf(Len(MOJ) > 4, -w / 6, 40)) //////// 08/01/311
            ////                DXY = IIf(垂直中央 = 0, Twip, Twip + w + IIf(Len(MOJ) > 4, -w / 6, 40)) //////// 05/02/12
            //            }
            //            this.MOJ2C("D上", PX0 + DXY, PY0, PXE + DXY, PYE, MOJ)
            //            if ( OndoHenkaHyoujiYajirusiFlag = 1 ) {
            //                obj.PenWidth = 部材荷重Pen幅 //+ 6
            //                if ( CreateDxfFlag = 1 ) {
            //                    this.PLOTPEN(CSng(obj.PenWidth))
            //                }
            //                DrawLinePrt obj, PX0, PY0, PXE, PYE
            //                if ( CreateDxfFlag = 1 ) {
            //                    this.LINEOUT(CSng(PX0), CSng(PY0), CSng(PXE), CSng(PYE))
            //                }
            //                this.寸法矢印(PX0, PY0, PXE, PYE)
            //                this.寸法矢印(PXE, PYE, PX0, PY0)
            //            }
            //        }
            Case 10  // 温度変化② P1=(下側の温度)-(上側の温度) 1010
                if ( 図BSPAN * Twip > 部材番号Fontsize * 35 ) {
                    this.F温度変化9_10(obj, 10, 節点S, 節点E, 荷重図開き, 荷重方向5, 荷重mark, 荷重_L1, 荷重_L2, 荷重_P1, 荷重_P2, _
                                        BUZAN, BUZAN9, TATE_flg, CASU, 連続P1, 連続P2, 連続P3, BZA9, _
                                        wXs, wXe, PX0, PY0, PXE, PYE, BCS, 図BSPAN, YY1, Yy2, B角度)
                }
            //        if ( 図BSPAN * Twip > 部材番号Fontsize * 35 ) { //////////////////////////////////////////////////////////// 05/05/22
            //            if ( 水平垂直 = 1 ) {
            //                if ( Abs(PY0 - PYE) > 200 ) {
            //                PX0 = PX0 - 3.8 * Twip
            //                PXE = PXE - 3.8 * Twip
            //                MOJ = "温度差 " + F2(荷重_P1) + "℃"
            //                this.MOJ2C("D上", PX0, PY0, PXE, PYE, MOJ, , , 0.7)
            //                MOJ = "上下の間隔 " + F2(荷重_P2) + "m"
            //                this.MOJ2C("D上", PX0 + 2.3 * Twip, PY0, PXE + 2.3 * Twip, PYE, MOJ, , , 0.7)
            //                }
            //            } else {
            //                前PRESUT = 前PRESUT + 1
            //                if ( Abs(PX0 - PXE) > 200 ) {
            //                    if ( Abs(PX0 - PXE) > 800 || (前PRESUT Mod 2) = 1 ) {
            //                        PY0 = PY0 - 4 * Twip
            //                        PYE = PYE - 4 * Twip
            //                    } else {
            //                        PY0 = PY0 - (3 + 7) * Twip
            //                        PYE = PYE - (3 + 7) * Twip
            //                    }
            //                    MOJ = "温度差 " + F2(荷重_P1) + "℃"
            //                    this.MOJ2C("D上", PX0, PY0, PXE, PYE, MOJ, , , 0.7)
            //                    MOJ = "上下の間隔 " + F2(荷重_P2) + "m"
            //                    this.MOJ2C("D上", PX0, PY0 + 2.3 * Twip, PXE, PYE + 2.3 * Twip, MOJ, , , 0.7)
            //                }
            //            }
            //        }
            Case 11 // ﾓｰﾒﾝﾄ荷重 11 11 11

                    this.Fモーメント荷重11(obj, 節点S, 節点E, 荷重図開き, 荷重方向5, 荷重mark, 荷重_L1, 荷重_L2, 荷重_P1, 荷重_P2, _
                                        BUZAN, BUZAN9, TATE_flg, CASU, 連続P1, 連続P2, 連続P3, BZA9, _
                                        wXs, wXe, wYs, wYe, PX0, PY0, PXE, PYE, BCS, BSN, 図BSPAN, _
                                        YY1, Yy2, PX1D, PY1D, PX2D, PY2D, B角度, S角度, E角度, MR)

            //        var f前位置 As Single
            //        f前位置 = -9000000000# ////////////07/06/177
            //////////
            //        Select Case PXE - PX0
            //        Case Is > 0
            //            TT = 0
            //        Case 0
            //            if ( PYE > PY0 ) {
            //                TT = 180
            //            }
            //        Case } else {
            //            TT = 180
            //        End Select
            //        if ( 荷重_P1 != 0 ) {
            //            PX1D = PX1D + 荷重図上盛上げ初期値 * Twip * BSN
            //            PY1D = PY1D + 荷重図上盛上げ初期値 * Twip * BCS
            //            obj.PenWidth = 節点荷重Pen幅 - 2
            //            if ( CreateDxfFlag = 1 ) {
            //                this.PLOTPEN(CSng(obj.PenWidth))
            //            }
            //            MR = Abs(YY1)
            //            if ( 固定部材M荷重長さ > 0 ) {
            //                MR = 固定部材M荷重長さ * Twip
            //            }
            //            if ( MR > 部材M荷重長さmax * Twip ) {
            //                MR = 部材M荷重長さmax * Twip
            //            }
            //            DrawCirclePrt obj, PX1D, PY1D, 0.3 * Twip
            //            if ( CreateDxfFlag = 1 ) {
            //                EnPRM1 = CSng(PX1D)
            //                EnPRM2 = CSng(PY1D)
            //                EnPRM3 = CSng(0.3 * Twip)
            //                EnPRM4 = 0
            //                EnPRM5 = 360
            //                EnTYPE1 = 7
            //                this.PLOTCIRCLE(EnPRM1, EnPRM2, EnPRM3, EnPRM4, EnPRM5, EnTYPE1)
            //            }
            //            DrawCirclePrt obj, PX1D, PY1D, MR, S角度, E角度
            //            if ( CreateDxfFlag = 1 ) {
            //                EnPRM1 = CSng(PX1D)
            //                EnPRM2 = CSng(PY1D)
            //                EnPRM3 = CSng(MR)
            //                EnPRM4 = KAngS(CSng(S角度))
            //                EnPRM5 = KAngS(CSng(E角度))
            //                EnTYPE1 = 7
            //                this.PLOTCIRCLE(EnPRM1, EnPRM2, EnPRM3, EnPRM4, EnPRM5, EnTYPE1)
            //            }
            //            if ( 荷重_P1 > 0 ) {
            //                X3 = PX1D + MR / Sqrt2
            //                Y3 = PY1D + MR / Sqrt2
            //                X4 = X3 + 65
            //                Y4 = Y3 - 100
            //            } else {
            //                X3 = PX1D - MR / Sqrt2
            //                Y3 = PY1D + MR / Sqrt2
            //                X4 = X3 - 65
            //                Y4 = Y3 - 100
            //            }
            //            obj.PenWidth = 節点荷重Pen幅 - 4
            //            if ( CreateDxfFlag = 1 ) {
            //                this.PLOTPEN(CSng(obj.PenWidth))
            //            }
            //            this.荷重矢印L(1, X4, Y4, X3, Y3)
            //            MOJX = PX1D + MR * Cos(π * (45 + B角度 + TT) / 180) - 荷重文字サイズ / IIf(荷重_P1 > 0, 4, 100) * Twip
            //            MOJY = PY1D - MR * Sin(π * (45 + B角度 + TT) / 180) - 荷重文字サイズ / 3 * Twip
            ////            if ( strUN = "" ) { ////////////////////////////////////07/05/12
            ////            strAB = "M=" + F2(荷重_P1) & " "
            ////            } else {
            //            strAB = " " + F2(荷重_P1) + strUN & "･m "
            ////            }
            //            this.MOJ1("D上", MOJX, MOJY, B角度, strAB)
            //            f前位置 = MOJX + frmPrint.vsPrt1.TextWidth(strAB) //////////////////07/06/177
            //        }
            //        if ( 荷重_P2 != 0 ) {
            //            PX2D = PX2D + 荷重図上盛上げ初期値 * Twip * BSN
            //            PY2D = PY2D + 荷重図上盛上げ初期値 * Twip * BCS
            //            obj.PenWidth = 節点荷重Pen幅 - 2
            //            if ( CreateDxfFlag = 1 ) {
            //                this.PLOTPEN(CSng(obj.PenWidth))
            //            }
            //            MR = Abs(Yy2)
            //            if ( 固定部材M荷重長さ > 0 ) {
            //                MR = 固定部材M荷重長さ * Twip
            //            }
            //            if ( MR > 部材M荷重長さmax * Twip ) {
            //                MR = 部材M荷重長さmax * Twip
            //            }
            //            DrawCirclePrt obj, PX2D, PY2D, 0.3 * Twip
            //            if ( CreateDxfFlag = 1 ) {
            //                EnPRM1 = CSng(PX2D)
            //                EnPRM2 = CSng(PY2D)
            //                EnPRM3 = CSng(0.3 * Twip)
            //                EnPRM4 = 0
            //                EnPRM5 = 360
            //                EnTYPE1 = 7
            //                this.PLOTCIRCLE(EnPRM1, EnPRM2, EnPRM3, EnPRM4, EnPRM5, EnTYPE1)
            //            }
            //            DrawCirclePrt obj, PX2D, PY2D, MR, S角度, E角度
            //            if ( CreateDxfFlag = 1 ) {
            //                EnPRM1 = CSng(PX2D)
            //                EnPRM2 = CSng(PY2D)
            //                EnPRM3 = CSng(MR)
            //                EnPRM4 = KAngS(CSng(S角度))
            //                EnPRM5 = KAngS(CSng(E角度))
            //                EnTYPE1 = 7
            //                this.PLOTCIRCLE(EnPRM1, EnPRM2, EnPRM3, EnPRM4, EnPRM5, EnTYPE1)
            //            }
            //            if ( 荷重_P2 > 0 ) {
            //                X3 = PX2D + MR / Sqrt2
            //                Y3 = PY2D + MR / Sqrt2
            //                X4 = X3 + 65
            //                Y4 = Y3 - 100
            //            } else {
            //                X3 = PX2D - MR / Sqrt2
            //                Y3 = PY2D + MR / Sqrt2
            //                X4 = X3 - 65
            //                Y4 = Y3 - 100
            //            }
            //            obj.PenWidth = 節点荷重Pen幅 - 4
            //            if ( CreateDxfFlag = 1 ) {
            //                this.PLOTPEN(CSng(obj.PenWidth))
            //            }
            //            this.荷重矢印L(1, X4, Y4, X3, Y3)
            //            MOJX = PX2D + MR * Cos(π * (45 + B角度 + TT) / 180) - 荷重文字サイズ / IIf(荷重_P2 > 0, 4, 100) * Twip
            //            MOJY = PY2D - MR * Sin(π * (45 + B角度 + TT) / 180) - 荷重文字サイズ / 3 * Twip
            ////            if ( strUN = "" ) { ////////////////////////////////////07/05/12
            ////            strAB = "M=" + F2(荷重_P2) & " "
            ////            } else {
            //            strAB = " " + F2(荷重_P2) + strUN & "･m "
            ////            }
            //            if ( (MOJX - f前位置) < -200 ) { //////////07/06/177
            //                MOJY = MOJY - 140
            //            }
            //            this.MOJ1("D上", MOJX, MOJY, B角度, strAB)
            //        }

            Case 12 // プレストレストによる二次応力①
            //
                    this.Fプレス荷重12(obj, 節点S, 節点E, 荷重図開き, 荷重方向5, 荷重mark, 荷重_L1, 荷重_L2, 荷重_P1, 荷重_P2, _
                                        BUZAN, BUZAN9, TATE_flg, CASU, 連続P1, 連続P2, 連続P3, BZA9, _
                                        wXs, wXe, wYs, wYe, PX0, PY0, PXE, PYE, BCS, BSN, 図BSPAN, YY1, Yy2, B角度, MR)
                前PRESUT = 荷重_P2
            Case 13 // プレストレストによる二次応力②
                    //
                    this.Fプレス荷重13(obj, 節点S, 節点E, 荷重図開き, 荷重方向5, 荷重mark, 荷重_L1, 荷重_L2, 荷重_P1, 荷重_P2, _
                                        BUZAN, BUZAN9, TATE_flg, CASU, 連続P1, 連続P2, 連続P3, BZA9, _
                                        wXs, wXe, wYs, wYe, PX0, PY0, PXE, PYE, BCS, BSN, 図BSPAN, YY1, Yy2, B角度)

                前PRESUT = 荷重_P2 ////////////////07/08/04
                //
            Case 14 // 連行荷重 141414
            //
                    this.F連行荷重F(obj, 節点S, 節点E, 荷重図開き, 荷重方向5, 荷重mark, 荷重_L1, 荷重_L2, 荷重_P1, 荷重_P2, _
                                        BUZAN, BUZAN9, TATE_flg, CASU, 連続P1, 連続P2, 連続P3, BZA9, _
                                        wXs, wXe, wYs, wYe, PX0, PY0, PXE, PYE, BCS, BSN, 図BSPAN)
            Case } else {
            End Select
            if ( 荷重mark = 2 || 荷重mark = 3 || 荷重mark = 4 ) { ////////09/11/13
                if ( y表記FLG = 1 ) {
                    g荷重表記高 = max(g荷重表記高, y荷重高)
                } else {
                    g荷重表記高5 = max(g荷重表記高5, y荷重高)
                }
            }
            if ( m荷重表記縦 = 1 ) { ////////10/10/14
                g荷重表記縦 = 1
            }
            obj.TextAngle = 0
            ////////////////////////////////////////////////////////////
            ///
                                                                    */
        }
        //
        private void F軸方向分布荷重_678(object obj, int 節点S, int 節点E, double 荷重図開き, string 荷重方向5, int 荷重mark,
                 double 荷重_L1, double 荷重_L2, double 荷重_P1, double 荷重_P2, int BUZAN, int BUZAN9, int CASU,
                 float wXs, float wXe, float wYs, float wYe,
                 float PX0, float PY0, float PXE, float PYE, float BCS, float BSN, float 図BSPAN, float YY1, float Yy2, float PX1D, float PX2D, float PY1D, float PY2D)
        {
            /*
    var F88 As String, Hoko As Integer, Hoko8 As Integer, Hoko9 As Integer, Hoko0 As Integer
    var 二重 As Integer ////////10/02/07
    var k As Integer, i8 As Integer
    var k矢印方向 As Integer
    var F方向 As Integer
    var vFLG As Integer //////08/12/01
    var n柱X As Single
    var HASIRA1 As Single, HASIRA2 As Single
    var DDDD1 As Single
    var DDDD2 As Single
    var XZ1 As Single
    var XZ2 As Single
    var GGGF As Single
    var w As Single
    var Eee As Integer //////12/12/29
    var EEE3 As Single //////12/12/29

    FLG柱軸重 = False //////13/04/08
    k矢印方向 = 1 ////////////12/02/15
    if ( 荷重mark = 6 $$ (荷重_P1 < 0 || 荷重_P2 < 0) ) { ////// $$ 水平垂直 != 0 ) {
        k矢印方向 = -1
        if ( InStr(部材名(BUZAN), "杭") != 0 ) {
            荷重_P1 = Abs(荷重_P1)
            荷重_P2 = Abs(荷重_P2)
        }
    } ////////////12/02/15
if ( InStr(部材名(BUZAN), "杭") != 0 ) {
    wYs = 節Y(節点S)
    wYe = 節Y(節点E)
    PX0 = HEN_X(wXs) + 90
    PY0 = HEN_Y(wYs)
    PXE = HEN_X(wXe) + 90
    PYE = HEN_Y(wYe)
//                        KUIDAN = KUIDAN + 1

    PX1D = PX0 //+ XX1 * 1
//        PY1D = PY0 //- XX1 * BSN
    PX2D = PX0 //+ XX2 * 1
//        PY2D = PY0 //- XX2 * BSN

    if ( g柱本数 = 0 ) {
        n柱X = (JX_max + JX_min) / 2
    } else {
        HASIRA1 = 99999: HASIRA2 = -99999
        For( vFLG = 1 To g柱本数
            HASIRA1 = min(HASIRA1, g柱X座標(vFLG, 1))
            HASIRA2 = max(HASIRA2, g柱X座標(vFLG, 1))
        Next
        n柱X = (HASIRA1 + HASIRA2) / 2
    } //////08/11/25
    //
    二重 = 0
    vFLG = 0
    DDDD1 = Sqr((HEN_X(wXs) - HEN_X(wXe)) ^ 2 + (HEN_Y(wYs) - HEN_Y(wYe)) ^ 2)
    if ( InStr(部材名(BUZAN), "剛") != 0 $$ DDDD1 < 500 ) {
        return;
    }
    if ( 図BSPAN > 300 || 図BSPAN < 300 ) { //////////09/08/14////////////// 05/05/22
    if ( 水平垂直 = 1 || 水平垂直 = 9 ) {
        if ( PX1D = PX2D $$ Abs(PY1D - PY2D) > 1000 $$ 水平垂直 != 9 ) {
            PY1D = PY1D + (Abs(PY1D - PY2D) - 800) / 2
            PY2D = PY2D - (Abs(PY1D - PY2D) - 800) / 2
        }

        XZ1 = Abs(HEN_Y(wYs) - HEN_Y(wYe)) / 8 //////10/03/03
        if ( XZ1 > 200 ) { XZ1 = 200
        PY1D = PY1D - XZ1
        PY2D = PY2D - XZ1
        if ( 水平垂直 = 9 ) { ////////////////////17/03/09
            PX2D = PX0 - (PX0 - PXE) / Abs(PY0 - PYE) * Abs(PY1D - PY2D)
            if ( (PX0 - PXE) > 0 ) {
                PX1D = PX1D - 440 - 100
                PX2D = PX2D - 440 - 100
            } else {
                PX1D = PX1D + 500
                PX2D = PX2D + 500
            }
        }

        vFLG = 1
        if ( (wYs - wYe) < 0 ) {
            if ( 荷重_P1 < 0 ) {
                Hoko9 = 1 //////////////////08/01/13
            } else {
                Hoko9 = -1 ////// 04/11/11
            }
        }
    }
    obj.PenWidth = 0
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(obj.PenWidth))
    }
    obj.PenStyle = 1
    if ( CreateDxfFlag = 1 ) {
        frmPrint.vsPrt1.PenStyle = 1
    }
    XZ1 = 0
    XZ2 = 0
        PX1D = PX1D - Abs(HEN_X(wXs) - HEN_X(wXe)) / 30 //+ 荷重文字サイズ * Twip / 4
        PX2D = PX2D - Abs(HEN_X(wXs) - HEN_X(wXe)) / 30 //+ 荷重文字サイズ * Twip / 4
        XZ2 = 荷重文字サイズ * Twip / 10
        if ( iKozo = 2 ) { //////////////////////////////////////////////////////////09/03/25
            XZ1 = 荷重図上盛上げ初期値 * Twip * 1.5 / 2
            PY1D = PY1D - XZ1
            PY2D = PY2D - XZ1
        }
        if ( (YY_max + YY_min) / 2 > wYs ) { ////////08/10/29
            XZ1 = 荷重図上盛上げ初期値 * Twip * 2
        }
    }
    if ( 荷重mark = 6 $$ (水平垂直 = 1 || 水平垂直 = 9) ) {
        DDDD1 = Int(Abs(HEN_Y(wYs) - HEN_Y(wYe)) / 30)
        if ( InStr(部材名(BUZAN), "杭") = 1 || vFLG = 1 ) { ////////08/06/16//////08/10/23
            if ( iKozo = 2 ) { ////////////////////////09/03/25
            DDDD1 = min(DDDD1 * 2, 200) //////12/02/15
            } else {
            DDDD1 = -min(DDDD1 * 2, 200)
            }
        }
        PY1D = PY1D - DDDD1 // * Sgn(wYs - wYe) ////////////////////////////////////////04/11/11
        PY2D = PY2D - DDDD1 // * Sgn(wYs - wYe)
    }
    if ( Hoko0 = -1 $$ 水平垂直 = 0 ) {  ////////08/06/11
        DDDD1 = 荷重図上盛上げ初期値 * Twip * 1.3 //////2////////08/09/26
        PY1D = PY1D - DDDD1
        PY2D = PY2D - DDDD1
    }
    if ( 荷重mark = 6 ) {    // 20040812
        GGGF = CalcLengX(PX1D, PY1D, PX2D, PY2D) / 56.7 / 4
        GGGF = 15 //* Sgn(wYs - wYe)
        if ( GGGF < 10 ) {
            obj.PenWidth = 10
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(obj.PenWidth))
            }
            this.PlotLine1_FG1(CDbl(PX1D), CDbl(PY1D), CDbl(PX2D), CDbl(PY2D), 2, 1)
        }
        if ( GGGF >= 10 $$ GGGF < 15 ) {
            obj.PenWidth = 10
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(obj.PenWidth))
            }
            this.PlotLine1_FG1(CDbl(PX1D), CDbl(PY1D), CDbl(PX2D), CDbl(PY2D), 2, 2)
        }
        if ( GGGF >= 15 ) {
            obj.PenWidth = 10
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(obj.PenWidth))
            }
            if ( Hoko9 = 0 ) {
            this.PlotLine1_FG1(CDbl(PX1D), CDbl(PY1D), CDbl(PX2D), CDbl(PY2D), 2, 3)
            } else {
            this.PlotLine1_FG1(CDbl(PX1D), CDbl(PY2D), CDbl(PX2D), CDbl(PY1D), 2, 3)
            }
        }
        obj.PenWidth = 0
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(obj.PenWidth))
        }
        obj.PenStyle = 1
        if ( CreateDxfFlag = 1 ) {
            frmPrint.vsPrt1.PenStyle = 1
        }
    } else {
        DrawLinePrt obj, PX1D - 2, PY1D, PX2D - 2, PY2D
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(PX1D - 2), CSng(PY1D), CSng(PX2D - 2), CSng(PY2D))
        }
        DrawLinePrt obj, PX1D + 2, PY1D, PX2D + 2, PY2D
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(PX1D + 2), CSng(PY1D), CSng(PX2D + 2), CSng(PY2D))
        }
    }
    obj.PenWidth = Pen幅
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(obj.PenWidth))
    }
    obj.PenStyle = 0
    if ( CreateDxfFlag = 1 ) {
        frmPrint.vsPrt1.PenStyle = 0
    }
//////09/08/14
    F88 = IIf(荷重_P1 = 荷重_P2, F2(Abs(荷重_P1)), IIf(水平垂直 != 0, F2(Abs(荷重_P2)) & _
              "～" & F2(Abs(荷重_P1)), F2(Abs(荷重_P1)) & "～" & F2(Abs(荷重_P2))))
//
    DDDD1 = Sqr((HEN_X(wXs) - HEN_X(wXe)) ^ 2 + (HEN_Y(wYs) - HEN_Y(wYe)) ^ 2)
    //
    if ( DDDD1 > 1300 ) { ////////////////////////////////////////12/09/17
        F88 = " q=" & F88 & strUN & "/m"
    } else {if ( DDDD1 > 500 ) { //////
        F88 = F88 & strUN & "/m"
    }
    w = frmPrint.vsPrt1.TextWidth(F88) //kore
    if ( (図BSPAN * Twip / sNN) > w ) { ////////////05/05/22
        if ( 水平垂直 = 9 ) { //////12/02/15
            if ( (PX0 - PXE) > 0 ) {
                this.荷重矢印(PX1D, PY2D, PX2D, PY1D)
            } else {
                this.荷重矢印(PX1D, PY1D, PX2D, PY2D)
            }
        } else {
            if ( k矢印方向 = -1 ) { //////12/02/15
               this.荷重矢印(PX2D, PY2D, PX1D, PY1D)
            } else {
               this.荷重矢印(PX1D, PY1D, PX2D, PY2D)
            }
        }
        if ( InStr(部材名(BUZAN), "杭") = 1 || iKozo = 2 || vFLG = 1 ) { //////08/06/21//////08/10/23
            PX1D = PX1D + 2 * Twip //////08/06/16 08/07/08 12/09/24
            PX2D = PX2D + 2 * Twip
            XZ2 = 100
            GoTo GGRRFF
        }

        if ( PY1D = PY2D ) {
            PY0 = PY1D - Abs(部材荷重Fontsize * Twip / 2.2) //////08/06/11
            this.MOJ2C("U上", PX1D, PY0 - XZ2, PX2D, PY0 - XZ2, F88)
        } else {
//                if ( Hoko8 = 0 ) {
//                if ( Hoko0 = 1 $$ 水平垂直 != 9 ) { //////08/05/22
//                    PY1D = PY1D - 1 * Twip
//                    if ( InStr(部材名(BUZAN), "杭") = 1 || iKozo = 2 ) { ////////08/06/11  08/06/21
//                        XZ2 = -0.0000002 * Twip
//                    }
//                    this.MOJ2C("U上", PX1D - XZ2, PY1D, PX2D - XZ2, PY2D, F88)
//                } else {
                if ( 水平垂直 = 9 || Hoko9 = 1 ) {
                    if ( 水平垂直 = 9 ) {
                        if ( Hoko != -1 ) { //////////////////////////09/08/23
                            PY1D = PY1D - 4 * Twip
                            PY2D = PY2D - 4 * Twip
                            XZ2 = XZ2 * (-1)
                        } else {
                            XZ2 = 0 ////////07/01/077
                        }
                    }
                } else {
                    PY2D = PY2D - 1 * Twip
                    if ( Hoko0 = -1 $$ HASIRA1 = wXs $$ 水平垂直 = 1 ) {
                        XZ2 = XZ2 + 230
                    }
                    w = frmPrint.vsPrt1.TextWidth(F88) ////////12/02/15
                    if ( Abs(PY1D - PY2D) * 1.2 < w ) {
                        KUIDAN = KUIDAN + 1
                        if ( KUIDAN / 2 = Int(KUIDAN / 2) ) {
                            XZ2 = XZ2 - (20 * 荷重文字サイズ)
                        }
                    } else {
                        KUIDAN = 0
                    }
                }
GGRRFF:
                if ( 水平垂直 = 9 ) {
                    if ( (PX0 - PXE) > 0 ) {
                        XZ2 = XZ2 + 250
                        this.MOJ2C("U上", PX2D - XZ2, PY1D, PX1D - XZ2, PY2D, F88)
                    } else {
                        XZ2 = XZ2 - 250
                        this.MOJ2C("U上", PX1D - XZ2, PY1D, PX2D - XZ2, PY2D, F88)
                    }
                } else {
                this.MOJ2C("U上", PX1D - XZ2, PY1D, PX2D - XZ2, PY2D, F88) ////////07/01/077
                }
//                }
        }
    }
} else {
    if ( g柱本数 = 0 ) {
        n柱X = (JX_max + JX_min) / 2
    } else {
        HASIRA1 = 99999: HASIRA2 = -99999
        For( vFLG = 1 To g柱本数
            HASIRA1 = min(HASIRA1, g柱X座標(vFLG, 1))
            HASIRA2 = max(HASIRA2, g柱X座標(vFLG, 1))
            if ( 節X(節点S) = g柱X座標(vFLG, 1) ) { //////12/12/29
                Eee = vFLG
            }
        Next
        n柱X = (HASIRA1 + HASIRA2) / 2
        //
        if ( iKozo = 1 ) { //////12/12/29
            if ( g柱X座標(Eee, 1) < n柱X ) {
                if ( Eee < g柱本数 ) {
                    EEE3 = HEN_X(g柱X座標(Eee + 1, 1)) - HEN_X(g柱X座標(Eee, 1))
                    if ( EEE3 < 150 ) {
                        n柱X = g柱X座標(Eee, 1) - 1
                    }
                }
            } else {
                if ( Eee > 1 ) {
                    EEE3 = HEN_X(g柱X座標(Eee, 1)) - HEN_X(g柱X座標(Eee - 1, 1))
                    if ( EEE3 < 150 ) {
                        n柱X = g柱X座標(Eee, 1) + 1
                    }
                }
            }
            if ( Eee > 1 ) {
                EEE3 = HEN_X(g柱X座標(Eee, 1)) - HEN_X(g柱X座標(Eee - 1, 1))
                if ( EEE3 < 150 ) {
                    FLG柱軸重 = True
                }
            }
        }
    }
    //
    二重 = 0
    if ( 水平垂直 = 0 ) {
        if ( BuzaiFF = 0 ) {
            For( k = BUZAN To BUZAN9
                Mark6荷重数(k) = Mark6荷重数(k) + 1
                if ( Mark6荷重数(k) > 1 ) {
                    二重 = 1
                }
            }
        } else {
            For( i8 = 1 To BuzaiFF
                k = GGGGG(i8)
                if ( Mark6荷重数(k) > 1 ) {
                    二重 = max(二重, (Mark6荷重数(k) - 1))
                }
            }8
        }
        二重 = 二重 * 260
    }
    if ( (iKozo = 1 || iKozo = 2) $$ 水平垂直 = 0 $$ (水平部材最下端 = (wYs + wYe) / 2) ) {
        二重 = 260 // + 二重
    }
    if ( 二重 = 0 $$ (wYe = YY_min || wYe = 水平部材最下端) $$ (InStr(荷重名称(逆実荷重NO(CASU)), "慣性力") != 0 || InStr(荷重名称(逆実荷重NO(CASU)), "地震") != 0) ) {
        二重 = 125 //////13/11/16
    }
    vFLG = 0
    //////////////////////////09/08/14
    DDDD1 = Sqr((HEN_X(wXs) - HEN_X(wXe)) ^ 2 + (HEN_Y(wYs) - HEN_Y(wYe)) ^ 2)
    if ( InStr(部材名(BUZAN), "剛") != 0 $$ DDDD1 < 500 ) { //////08/06/16 08/06/21
        return;
    }
    if ( 図BSPAN > 300 || 図BSPAN < 300 ) { //////////09/08/14////////////// 05/05/22
    if ( 荷重_P1 < 0 ) { //////And InStr(部材名(BUZAN), "杭") = 0 ) { //////////////////////////////12/02/15
       Hoko0 = -1 ////// 05/04/26
    }
    if ( 水平垂直 = 9 $$ BCS < 0 ) {
        Hoko = -1 ////// 04/10/14
    }
    if ( 水平垂直 = 0 ) {
        Hoko = -1
    }
    if ( 水平垂直 = 1 || 水平垂直 = 9 ) {
        if ( PX1D = PX2D $$ Abs(PY1D - PY2D) > 1000 ) {
            PY1D = PY1D + (Abs(PY1D - PY2D) - 800) / 2
            PY2D = PY2D - (Abs(PY1D - PY2D) - 800) / 2
        }
        XZ1 = Abs(HEN_Y(wYs) - HEN_Y(wYe)) / 8

        if ( 図BSPAN < 1000 ) {
            if ( XZ1 > 120 ) { XZ1 = 120
            PY1D = PY1D - XZ1
            PY2D = PY2D - XZ1
        } else {
            if ( XZ1 > 200 ) { XZ1 = 200
            PY1D = PY1D - XZ1
            PY2D = PY2D - XZ1
        }
        if ( InStr(部材名(BUZAN), "杭") = 1 || iKozo = 2 || (JX_max = JX_min) ) { ////////08/06/11 08/06/21 08/10/23
            vFLG = 1
        }
////////////10/03/03
        if ( (wYs - wYe) < 0 ) {
            if ( 荷重_P1 < 0 ) {
                Hoko9 = 1
            } else {
                Hoko9 = -1
            }
        }
    }
    obj.PenWidth = 0
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(obj.PenWidth))
    }
    obj.PenStyle = 1
    if ( CreateDxfFlag = 1 ) {
        frmPrint.vsPrt1.PenStyle = 1
    }
    XZ1 = 0
    XZ2 = 0
    if ( (InStr(部材名(BUZAN), "杭") = 0 || (JX_max = JX_min)) $$ vFLG = 0 ) { //////08/10/23
        if ( 水平垂直 = 1 || 水平垂直 = 9 ) {
            if ( n柱X < (wXs + wXe) / 2 $$ iKozo != 2 ) {
                if ( Hoko0 = 1 ) { ////////08/06/11
                    XZ1 = 荷重図上盛上げ初期値 * Twip * 2
                    PX1D = PX1D - XZ1
                    PX2D = PX2D - XZ1
                    if ( 水平垂直 != 9 ) {
                    XZ2 = XZ1 - 荷重文字サイズ * Twip / 10
                    }
                } else {
                    XZ2 = XZ1 + 荷重文字サイズ * Twip / 2
                }
                if ( Hoko9 = -1 ) { Hoko8 = -1
                if ( 水平垂直 = 9 $$ 荷重_P1 * Hoko < 0 ) {
                    PX1D = PX1D + Twip * 1
                    PX2D = PX2D + Twip * 1
                }
            }
            if ( Sgn(BCS * BSN) != 0 ) {
                if ( Sgn(BCS * BSN) > 0 ) {
                    XZ1 = 荷重図上盛上げ初期値 * Twip * 2
                } else {
                    XZ1 = 荷重図上盛上げ初期値 * Twip * 1.5 * Sgn(BCS * BSN)
                }
                PX1D = PX1D + XZ1
                PX2D = PX2D + XZ1
                if ( n柱X < (wXs + wXe) / 2 ) {
                    XZ2 = XZ1 - 荷重文字サイズ * Twip / 3.5
                } else {
                    XZ2 = -(荷重文字サイズ * Twip / 4.5)
                }
            }
            }
        } else {
            PX1D = PX1D - Abs(HEN_X(wXs) - HEN_X(wXe)) / 30 //+ 荷重文字サイズ * Twip / 4
            PX2D = PX2D - Abs(HEN_X(wXs) - HEN_X(wXe)) / 30 //+ 荷重文字サイズ * Twip / 4
            XZ2 = 荷重文字サイズ * Twip / 10
            if ( iKozo = 2 ) { //////////////////////////////////////////////////////////09/03/25
                XZ1 = 荷重図上盛上げ初期値 * Twip * 1.5
                PY1D = PY1D - XZ1
                PY2D = PY2D - XZ1
            }
            if ( (YY_max + YY_min) / 2 > wYs ) { ////////08/10/29
                XZ1 = 荷重図上盛上げ初期値 * Twip * 2
            }
            if ( 荷重_P1 * Hoko < 0 $$ InStr(部材名(BUZAN), "杭") = 0 ) { ////////12/02/15
//                if ( Hoko0 < 0 ) {
                PX1D = PX1D + Twip * 1 //////09/08/23
                PX2D = PX2D + Twip * 1 //////09/08/23
                XZ1 = 荷重図上盛上げ初期値 * Twip * 2
                XZ2 = XZ1 + 荷重文字サイズ * Twip / 10
                if ( iKozo != 2 ) { ////////////////////////////////////////////////09/03/25
                    PY1D = PY1D - XZ1
                    PY2D = PY2D - XZ1
                }
            }
        }
    }
    if ( 荷重mark = 6 $$ (水平垂直 = 1 || 水平垂直 = 9) ) {
        DDDD1 = Int(Abs(HEN_Y(wYs) - HEN_Y(wYe)) / 30)
        if ( InStr(部材名(BUZAN), "杭") = 1 || vFLG = 1 ) {
            if ( iKozo = 2 ) {
            DDDD1 = min(DDDD1 * 2, 200)
            } else {
            DDDD1 = -min(DDDD1 * 2, 200)
            }
        }
        PY1D = PY1D - DDDD1 // * Sgn(wYs - wYe)
        PY2D = PY2D - DDDD1 // * Sgn(wYs - wYe)
    }
    if ( (Hoko0 = -1 || Hoko0 = 0) $$ 水平垂直 = 0 ) {
        DDDD1 = 荷重図上盛上げ初期値 * Twip * 1.3
        if ( Abs((wYs + wYe) / 2 - YY_max) < 0.2 ) {
            if ( 二重 > 0 ) {
                DDDD1 = DDDD1 + 6 * Twip
            } else {
                DDDD1 = DDDD1 + 1.5 * Twip
            }
            if ( Hoko0 = 0 ) {
                DDDD1 = DDDD1 - 2 * Twip
            }
        } else {if ( Abs((wYs + wYe) / 2 - 水平部材最下端) > 0.2 ) {
            DDDD1 = DDDD1 + 2 * Twip
            if ( Hoko0 = 0 ) {
                DDDD1 = DDDD1 - 3 * Twip
            }
        } else {if ( Abs((wYs + wYe) / 2 - 水平部材最下端) < 0.2 $$ Hoko0 = 0 ) {
            DDDD1 = DDDD1 - 3 * Twip
        }
        PY1D = PY1D - DDDD1
        PY2D = PY2D - DDDD1
    }
     //////08/10/29 ===
    if ( Hoko0 = 0 $$ n柱X < (wXs + wXe) / 2 $$ _
             InStr(部材名(BUZAN), "杭") = 0 $$ iKozo != 2 $$ vFLG = 0 ) {
        DDDD1 = 荷重図上盛上げ初期値 * Twip * 1.3
        PX1D = PX1D - DDDD1
        PX2D = PX2D - DDDD1
    }
        if ( Hoko0 = 0 $$ iKozo = 3 $$ InStr(部材名(BUZAN), "杭") = 0 $$ 水平垂直 = 1 ) {
            if ( iKozo = 3 ) {
                DDDD1 = 荷重図上盛上げ初期値 * Twip * 0.5
                if ( n柱X > (wXs + wXe) / 2 ) {
                    PX1D = PX1D + DDDD1
                    PX2D = PX2D + DDDD1
                } else {if ( n柱X < (wXs + wXe) / 2 ) {
                    PX1D = PX1D - DDDD1
                    PX2D = PX2D - DDDD1
                }
            } else {
                DDDD1 = 荷重図上盛上げ初期値 * Twip * 1.3 + 20
                if ( n柱X < (wXs + wXe) / 2 ) {
                    PX1D = PX1D + DDDD1
                    PX2D = PX2D + DDDD1
                } else {if ( n柱X > (wXs + wXe) / 2 ) {
                    PX1D = PX1D - DDDD1
                    PX2D = PX2D - DDDD1
                }
            }
        }

    if ( 荷重mark = 6 ) {
        GGGF = CalcLengX(PX1D, PY1D, PX2D, PY2D) / 56.7 / 4
        GGGF = 15 //* Sgn(wYs - wYe)
        if ( GGGF < 10 ) {
            obj.PenWidth = 10
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(obj.PenWidth))
            }
            this.PlotLine1_FG1(CDbl(PX1D), CDbl(PY1D), CDbl(PX2D), CDbl(PY2D), 2, 1)
        }
        if ( GGGF >= 10 $$ GGGF < 15 ) {
            obj.PenWidth = 10
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(obj.PenWidth))
            }
            this.PlotLine1_FG1(CDbl(PX1D), CDbl(PY1D), CDbl(PX2D), CDbl(PY2D), 2, 2)
        }
        if ( GGGF >= 15 ) {
            obj.PenWidth = 10
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(obj.PenWidth))
            }
            if ( 二重 != 0 ) {
                PY1D = PY1D + 二重
                PY2D = PY2D + 二重
            }
            if ( Hoko9 = 0 ) {
                this.PlotLine1_FG1(CDbl(PX1D), CDbl(PY1D), CDbl(PX2D), CDbl(PY2D), 2, 3)
            } else {
                this.PlotLine1_FG1(CDbl(PX1D), CDbl(PY2D), CDbl(PX2D), CDbl(PY1D), 2, 3)
            }
        }
        obj.PenWidth = 0
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(obj.PenWidth))
        }
        obj.PenStyle = 1
        if ( CreateDxfFlag = 1 ) {
            frmPrint.vsPrt1.PenStyle = 1
        }
    } else {
        DrawLinePrt obj, PX1D - 2, PY1D, PX2D - 2, PY2D
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(PX1D - 2), CSng(PY1D), CSng(PX2D - 2), CSng(PY2D))
        }
        DrawLinePrt obj, PX1D + 2, PY1D, PX2D + 2, PY2D
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(PX1D + 2), CSng(PY1D), CSng(PX2D + 2), CSng(PY2D))
        }
    }
    obj.PenWidth = Pen幅
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(obj.PenWidth))
    }
    obj.PenStyle = 0
    if ( CreateDxfFlag = 1 ) {
        frmPrint.vsPrt1.PenStyle = 0
    }
//////09/08/14
    F88 = IIf(荷重_P1 = 荷重_P2, F2(Abs(荷重_P1)), IIf(水平垂直 != 0, F2(Abs(荷重_P2)) & _
              "～" & F2(Abs(荷重_P1)), F2(Abs(荷重_P1)) & "～" & F2(Abs(荷重_P2))))
//
    DDDD1 = Sqr((HEN_X(wXs) - HEN_X(wXe)) ^ 2 + (HEN_Y(wYs) - HEN_Y(wYe)) ^ 2)
    //
    if ( DDDD1 > 3000 ) { ////////////////////////////////////////13/12/26
        F88 = "q=" & F88 & strUN & "/m"
    } else {
        F88 = "q=" & F88 & strUN & "/m"
//
//        } else {if ( DDDD1 > 1300 ) { ////////////////////////////////////////12/09/17
//            F88 = " q=" & F88 & strUN & "/m"
//        } else {if ( DDDD1 > 500 ) { //////
//            F88 = F88 & strUN & "/m"
    }
    w = frmPrint.vsPrt1.TextWidth(F88) //kore
    if ( (図BSPAN * Twip / sNN) > w ) { ////////////05/05/22
//            if ( 荷重_P1 * Hoko > 0 ) {
//            if ( (wYs - wYe) < 0 ) {
//             if ( Hoko0 = -1 || Hoko = -1 ) {
         if ( k矢印方向 = -1 ) { //////12/02/15
            this.荷重矢印(PX2D, PY2D, PX1D, PY1D)
         } else {
            this.荷重矢印(PX1D, PY1D, PX2D, PY2D)
         }
//
        if ( InStr(部材名(BUZAN), "杭") = 1 || iKozo = 1 || iKozo = 2 || vFLG = 1 ) { //////////////////////////////////15/08/28
            if ( (iKozo = 1 || iKozo = 2) $$ 水平垂直 = 0 $$ (水平部材最下端 = (wYs + wYe) / 2) ) {
                XZ2 = -50
                PY1D = PY1D + 30
                PY2D = PY2D + 30
                if ( InStr(F88, "=") > 0 ) {
                    F88 = Mid(F88, InStr(F88, "=") + 1, Len(F88))
                }
            } else {
                if ( g柱X座標(Eee, 1) < n柱X || InStr(部材名(BUZAN), "杭") = 1 ) {
                    PX1D = PX1D + 2 * Twip //////08/06/16 08/07/08 12/09/24
                    PX2D = PX2D + 2 * Twip
                    XZ2 = 100
                } else {
                    if ( g柱X座標(Eee, 1) = n柱X $$ 水平垂直 = 1 ) {
//                            w = -(荷重文字サイズ * Twip / 4.5)
//                            PX1D = PX1D - w //////08/06/16 08/07/08 12/09/24
//                            PX2D = PX2D - w
//                            XZ2 = -w * 2
                        w = -(荷重文字サイズ * Twip / 10)
//                            PX1D = PX1D - w
//                            PX2D = PX2D - w
                        XZ2 = w
                        GoTo GRF777
                    } else {
                        w = frmPrint.vsPrt1.TextWidth("0")
                        PX1D = PX1D - w //////08/06/16 08/07/08 12/09/24
                        PX2D = PX2D - w
                        XZ2 = w * 2
                    }
                }
            }
            GoTo GRF33
        }
        if ( PY1D = PY2D ) {
            if ( 二重 = 125 ) { //////13/11/15
                XZ2 = -240
            }
            PY0 = PY1D - Abs(部材荷重Fontsize * Twip / 2.2) //////08/06/11
            this.MOJ2C("U上", PX1D, PY0 - XZ2, PX2D, PY0 - XZ2, F88)
        } else {
            if ( Hoko0 = 1 $$ 水平垂直 != 9 ) { //////08/05/22
                PY1D = PY1D - 1 * Twip
                if ( InStr(部材名(BUZAN), "杭") = 1 || iKozo = 2 ) { ////////08/06/11  08/06/21
                    XZ2 = -0.0000002 * Twip
                }
                this.MOJ2C("U上", PX1D - XZ2, PY1D, PX2D - XZ2, PY2D, F88)
            } else {
                if ( 水平垂直 = 9 || Hoko9 = 1 ) {
                    if ( 水平垂直 = 9 ) {
                        if ( Hoko != -1 ) { //////////////////////////09/08/23
                            if ( BSN < 0 ) {
                            PX1D = PX1D - (荷重文字サイズ * Twip / 1) * BSN //////////13/12/26
                            PX2D = PX2D - (荷重文字サイズ * Twip / 1) * BSN
                            }
                            PY1D = PY1D - (荷重文字サイズ * Twip / 1) * BCS + 30
                            PY2D = PY2D - (荷重文字サイズ * Twip / 1) * BCS + 30
                            XZ2 = XZ2 * (-1)
                        } else {
                            XZ2 = 0 ////////07/01/077
                        }
                    }
                } else {
                    PY2D = PY2D - 1 * Twip
                    if ( Hoko0 = -1 $$ HASIRA1 = wXs $$ 水平垂直 = 1 ) { //////////10/02/07
                        XZ2 = XZ2 + 230
                    }
                }
GRF33:
        //////15/04/08
var strQ1 As String
var strQ2 As String
                if ( DDDD1 < 900 $$ (iKozo = 2 || g柱本数 = 1) $$ InStr(部材名(BUZAN), "杭") = 0 $$ 水平垂直 = 1 ) {
                    PY1D = PY0 - (荷重文字サイズ * Twip / 5)
                    PY2D = PYE - (荷重文字サイズ * Twip / 5)
                    this.MOJ2C("U上", PX1D - XZ2 + IIf(g柱本数 = 1, 60, 0), (PY1D + PY2D) / 2, PX2D - XZ2 + 400 + Len(F88) * 70, (PY1D + PY2D) / 2, F88) ////////13/11/16
                    FLG_左右接点(3) = True
                } else {
                    if ( g柱本数 = 1 $$ (iKozo = 1 || g柱本数 = 1) $$ InStr(部材名(BUZAN), "杭") = 0 $$ 水平垂直 = 1 ) {
                        XZ2 = -120
                        if ( W分布荷重 != "" ) {
                            strQ1 = Mid(W分布荷重, 1, InStr(W分布荷重, "-") - 1)
                            strQ2 = Mid(W分布荷重, InStr(W分布荷重, "-") + 1)
                            if ( (val(strQ1) > PY1D $$ val(strQ2) > PY2D) ) {
                                XZ2 = -120 - 180
                            }
                        }
                        W分布荷重 = Format(PY1D, "####0.0") & "-" & Format(PY2D, "####0.0")
                    }
                    if ( (Hoko0 = -1 || Hoko0 = 0) $$ 水平垂直 = 0 $$ (Abs((wYs + wYe) / 2 - YY_max) < 0.2 || _
                                                        Abs((wYs + wYe) / 2 - 水平部材最下端) > 0.2) ) {
                        PY1D = PY1D - 4 * Twip
                        PY2D = PY2D - 4 * Twip
                    }
GRF777:
                    this.MOJ2C("U上", PX1D - XZ2, PY1D, PX2D - XZ2, PY2D, F88) ////////07/01/077
                }
            }
        }
    }
}
            */
        }

        //// 温度変化② P1=(下側の温度)-(上側の温度) 1010
        private void F温度変化9_10(object obj, int MARK, int 節点S, int 節点E, double 荷重図開き, string 荷重方向5, int 荷重mark, double 荷重_L1, double 荷重_L2,
                 double 荷重_P1, double 荷重_P2, int BUZAN, int BUZAN9, int TATE_flg, int CASU,
                 double 連続P1, double 連続P2, double 連続P3, int BZA9, float wXs, float wXe,
                 float PX0, float PY0, float PXE, float PYE, float BCS, float 図BSPAN, float YY1, float Yy2, float B角度)
        {
            /*
var MOJ
var DXY As Single, w As Single

Select Case MARK
 Case 9
        if ( Abs(荷重_P1) * 10 = Int(Abs(荷重_P1) * 10) ) {
            MOJ = F1(荷重_P1) + "℃"
        } else {
            MOJ = F2(荷重_P1) + "℃"
        }
        DXY = 0
        obj.FontSize = 部材荷重Fontsize - 2.5
        w = frmPrint.vsPrt1.TextWidth(MOJ)
    if ( 図BSPAN > 500 || (水平垂直 = 1 $$ 図BSPAN > 300) ) {  //////////////////////12/09/17
        PY0 = PY0 - Abs(部材荷重Fontsize * BCS * Twip / 2.5) + 3 * Twip
        PYE = PYE - Abs(部材荷重Fontsize * BCS * Twip / 2.5) + 3 * Twip
        if ( 水平垂直 = 1 || 水平垂直 = 9 ) { ////////// 05/05/21
            if ( (JX_max + JX_min) / 2 < wXs $$ InStr(部材名(BUZAN), "杭") = 0 ) {
                PX0 = PX0 - 2.5 * Twip ////////08/06/11//////12/09/17
                PXE = PXE - 2.5 * Twip
            } else {
                PX0 = PX0 + 2.5 * Twip ////////08/06/11//////12/09/17
                PXE = PXE + 2.5 * Twip
            }
            PY0 = PY0 - 2.5 * Twip
            PYE = PYE - 2.5 * Twip
        } else {
            PY0 = HEN_Y(節Y(節点S)) - 3.5 * Twip //////09/10/28
            PYE = HEN_Y(節Y(節点E)) - 3.5 * Twip
//                if ( gbolBuZai = 0 ) {
//                    PY0 = PY0 - 0.6 * Twip //////// 08/02/01
//                    PYE = PYE - 0.6 * Twip
//                }
        }
        if ( wXs != wXe $$ iKozo = 1 ) {
            DXY = IIf(垂直中央 = 0, Twip, Twip + 0 + IIf(Len(MOJ) > 4, -w / 6, 40)) //////// 08/01/311
//                DXY = IIf(垂直中央 = 0, Twip, Twip + w + IIf(Len(MOJ) > 4, -w / 6, 40)) //////// 05/02/12
        }
        this.MOJ2C("D上", PX0 + DXY, PY0, PXE + DXY, PYE, MOJ)
        if ( OndoHenkaHyoujiYajirusiFlag = 1 ) {
            obj.PenWidth = 部材荷重Pen幅 //+ 6
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(obj.PenWidth))
            }
            DrawLinePrt obj, PX0, PY0, PXE, PYE
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(PX0), CSng(PY0), CSng(PXE), CSng(PYE))
            }
            this.寸法矢印(PX0, PY0, PXE, PYE)
            this.寸法矢印(PXE, PYE, PX0, PY0)
        }
    }
 Case 10
    if ( 図BSPAN * Twip > 部材番号Fontsize * 35 ) { //////////////////////////////////////////////////////////// 05/05/22
        if ( 水平垂直 = 1 ) {
            if ( Abs(PY0 - PYE) > 200 ) {
            PX0 = PX0 - 3.8 * Twip
            PXE = PXE - 3.8 * Twip
            MOJ = "温度差 " + F2(荷重_P1) + "℃"
            this.MOJ2C("D上", PX0, PY0, PXE, PYE, MOJ, , , 0.7)
            MOJ = "上下の間隔 " + F2(荷重_P2) + "m"
            this.MOJ2C("D上", PX0 + 2.3 * Twip, PY0, PXE + 2.3 * Twip, PYE, MOJ, , , 0.7)
            }
        } else {
            前PRESUT = 前PRESUT + 1
            if ( Abs(PX0 - PXE) > 200 ) {
                if ( Abs(PX0 - PXE) > 800 || (前PRESUT Mod 2) = 1 ) {
                    PY0 = PY0 - 4 * Twip
                    PYE = PYE - 4 * Twip
                } else {
                    PY0 = PY0 - (3 + 7) * Twip
                    PYE = PYE - (3 + 7) * Twip
                }
                MOJ = "温度差 " + F2(荷重_P1) + "℃"
                this.MOJ2C("D上", PX0, PY0, PXE, PYE, MOJ, , , 0.7)
                MOJ = "上下の間隔 " + F2(荷重_P2) + "m"
                this.MOJ2C("D上", PX0, PY0 + 2.3 * Twip, PXE, PYE + 2.3 * Twip, MOJ, , , 0.7)
            }
        }
    }
End Select
                */
        }

        //
        // ﾓｰﾒﾝﾄ荷重 11 11 11
        private void Fモーメント荷重11(object obj, int 節点S, int 節点E, double 荷重図開き, string 荷重方向5, int 荷重mark, double 荷重_L1, double 荷重_L2,
                 double 荷重_P1, double 荷重_P2, int BUZAN, int BUZAN9, int TATE_flg, int CASU,
                 double 連続P1, double 連続P2, double 連続P3, int BZA9, float wXs, float wXe, float wYs, float wYe,
                 float PX0, float PY0, float PXE, float PYE, float BCS, float 図BSPAN, float YY1, float Yy2, float PX1D, float PX2D, float PY1D, float PY2D, float B角度, float S角度, float E角度, float MR)
        {
            /*
            //    Case 11 // ﾓｰﾒﾝﾄ荷重 11 11 11
            //    var MR As Single
            var EnPRM1                  As Single
            var EnPRM2                  As Single
            var EnPRM3                  As Single
            var EnPRM4                  As Single
            var EnPRM5                  As Single
            var EnTYPE1                 As Single
            var strAB                   As String
            var MOJX
            var MOJY
            var TT
            var DXY
            var w
            var X3
            var Y3
            var X4 As Single
            var Y4 As Single
            var f前位置 As Single
                f前位置 = -9000000000# ////////////07/06/177
            ////////
                if ( PY1D = PY2D $$ Abs(PY1D - HEN_Y(節Y(節点S))) > 300 ) { ////////15/03/23
                    PY1D = PY1D - 100
                    PY2D = PY2D - 100
                }

                Select Case PXE - PX0
                Case Is > 0
                    TT = 0
                Case 0
                    if ( PYE > PY0 ) {
                        TT = 180
                    }
                Case } else {
                    TT = 180
                End Select
                if ( 荷重_P1 != 0 ) {
                    PX1D = PX1D + 荷重図上盛上げ初期値 * Twip * BSN
                    PY1D = PY1D + 荷重図上盛上げ初期値 * Twip * BCS
                    obj.PenWidth = 節点荷重Pen幅 - 2
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(obj.PenWidth))
                    }
                    MR = Abs(YY1)
                    if ( 固定部材M荷重長さ > 0 ) {
                        MR = 固定部材M荷重長さ * Twip * 0.8
                    }
                    if ( MR > 部材M荷重長さmax * Twip * 0.8 ) {
                        MR = 部材M荷重長さmax * Twip * 0.8
                    }
                    DrawCirclePrt obj, PX1D, PY1D, 0.3 * Twip
                    if ( CreateDxfFlag = 1 ) {
                        EnPRM1 = CSng(PX1D)
                        EnPRM2 = CSng(PY1D)
                        EnPRM3 = CSng(0.3 * Twip)
                        EnPRM4 = 0
                        EnPRM5 = 360
                        EnTYPE1 = 7
                        this.PLOTCIRCLE(EnPRM1, EnPRM2, EnPRM3, EnPRM4, EnPRM5, EnTYPE1)
                    }
                    DrawCirclePrt obj, PX1D, PY1D, MR, S角度, E角度
                    if ( CreateDxfFlag = 1 ) {
                        EnPRM1 = CSng(PX1D)
                        EnPRM2 = CSng(PY1D)
                        EnPRM3 = CSng(MR)
                        EnPRM4 = KAngS(CSng(S角度))
                        EnPRM5 = KAngS(CSng(E角度))
                        EnTYPE1 = 7
                        this.PLOTCIRCLE(EnPRM1, EnPRM2, EnPRM3, EnPRM4, EnPRM5, EnTYPE1)
                    }
                    if ( 荷重_P1 > 0 ) {
                        X3 = PX1D + MR / Sqrt2
                        Y3 = PY1D + MR / Sqrt2
                        X4 = X3 + 65
                        Y4 = Y3 - 100
                    } else {
                        X3 = PX1D - MR / Sqrt2
                        Y3 = PY1D + MR / Sqrt2
                        X4 = X3 - 65
                        Y4 = Y3 - 100
                    }
                    obj.PenWidth = 節点荷重Pen幅 - 4
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(obj.PenWidth))
                    }
                    this.荷重矢印L(1, X4, Y4, X3, Y3)
                    //
                    strAB = " " + F2(荷重_P1) + strUN & "･m "
                    w = frmPrint.vsPrt1.TextWidth(strAB)
                    if ( 荷重文字サイズ > 9.2 ) {
                        w = w + (荷重文字サイズ / 3 * Twip)
                    }
                    if ( InStr(荷重名称(逆実荷重NO(CASU)), "電柱") != 0 ) { //////13/04/30
                        if ( 荷重_P1 > 0 ) {
                            MOJX = PX1D + 30 //////MR * Cos(π * (45 + B角度 + TT) / 180) + 10
                        } else {
                            MOJX = PX1D - MR * Cos(π * (45 + B角度 + TT) / 180) - w
                        }
                        MOJY = PY1D - MR * Sin(π * (45 + B角度 + TT) / 180) - (荷重文字サイズ / 3.5 * Twip)
                    } else {
                        MOJX = PX1D + MR * Cos(π * (45 + B角度 + TT) / 180) - IIf(荷重_P1 > 0, w / 2, w / 2)
                        if ( s側圧数 = 0 $$ (水平部材最下端 = (wYs + wYe) / 2) $$ 水平垂直 = 0 $$ N段数 = 1 ) {
                            MOJY = PYE + 500 //////13/08/11
                        } else {
                            MOJY = PY1D - MR * Sin(π * (45 + B角度 + TT) / 180) - 160

                            if ( Abs(XY集中(1) - PX1D) < 100 ) { //////電柱集中荷重があるので
                                if ( 荷重_P1 > 0 ) {
                                    MOJX = PX1D + MR / Sqrt2 / 2 //////MOJX + w / 3
                                } else {
                                    MOJX = MOJX - MR * Cos(π * (45 + B角度 + TT) / 180) - w / 1.5
                                }
                            }
                        }
                    }
                    this.MOJ1("D上", MOJX, MOJY, B角度, strAB)
                    f前位置 = MOJX + frmPrint.vsPrt1.TextWidth(strAB) //////////////////07/06/177
                }
                if ( 荷重_P2 != 0 ) {
                    PX2D = PX2D + 荷重図上盛上げ初期値 * Twip * BSN
                    PY2D = PY2D + 荷重図上盛上げ初期値 * Twip * BCS
                    obj.PenWidth = 節点荷重Pen幅 - 2
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(obj.PenWidth))
                    }
                    MR = Abs(Yy2)
                    if ( 固定部材M荷重長さ > 0 ) {
                        MR = 固定部材M荷重長さ * Twip
                    }
                    if ( MR > 部材M荷重長さmax * Twip ) {
                        MR = 部材M荷重長さmax * Twip
                    }
                    DrawCirclePrt obj, PX2D, PY2D, 0.3 * Twip
                    if ( CreateDxfFlag = 1 ) {
                        EnPRM1 = CSng(PX2D)
                        EnPRM2 = CSng(PY2D)
                        EnPRM3 = CSng(0.3 * Twip)
                        EnPRM4 = 0
                        EnPRM5 = 360
                        EnTYPE1 = 7
                        this.PLOTCIRCLE(EnPRM1, EnPRM2, EnPRM3, EnPRM4, EnPRM5, EnTYPE1)
                    }
                    DrawCirclePrt obj, PX2D, PY2D, MR, S角度, E角度
                    if ( CreateDxfFlag = 1 ) {
                        EnPRM1 = CSng(PX2D)
                        EnPRM2 = CSng(PY2D)
                        EnPRM3 = CSng(MR)
                        EnPRM4 = KAngS(CSng(S角度))
                        EnPRM5 = KAngS(CSng(E角度))
                        EnTYPE1 = 7
                        this.PLOTCIRCLE(EnPRM1, EnPRM2, EnPRM3, EnPRM4, EnPRM5, EnTYPE1)
                    }
                    if ( 荷重_P2 > 0 ) {
                        X3 = PX2D + MR / Sqrt2
                        Y3 = PY2D + MR / Sqrt2
                        X4 = X3 + 65
                        Y4 = Y3 - 100
                    } else {
                        X3 = PX2D - MR / Sqrt2
                        Y3 = PY2D + MR / Sqrt2
                        X4 = X3 - 65
                        Y4 = Y3 - 100
                    }
                    obj.PenWidth = 節点荷重Pen幅 - 4
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(obj.PenWidth))
                    }
                    this.荷重矢印L(1, X4, Y4, X3, Y3)
                    //
                    strAB = " " + F2(荷重_P2) + strUN & "･m "
                    w = frmPrint.vsPrt1.TextWidth(strAB)
                    if ( 荷重文字サイズ > 9.2 ) {
                        w = w + (荷重文字サイズ / 3 * Twip)
                    }
                    if ( InStr(荷重名称(逆実荷重NO(CASU)), "電柱") != 0 ) { //////13/04/30
                        if ( 荷重_P2 > 0 ) { //////////////14/08/17
                            MOJX = PX2D + 30 ////// MR * Cos(π * (45 + B角度 + TT) / 180) + 10
                        } else {
                            MOJX = PX2D - MR * Cos(π * (45 + B角度 + TT) / 180) - w
                        }
                        MOJY = PY2D - MR * Sin(π * (45 + B角度 + TT) / 180) - (荷重文字サイズ / 3.5 * Twip) ////////115/02/17
                    } else {
                        MOJX = PX2D + MR * Cos(π * (45 + B角度 + TT) / 180) - IIf(荷重_P2 > 0, w / 2, w / 1) // - 荷重文字サイズ / IIf(荷重_P2 > 0, 1, 0.5) * Twip ////13/04/35//, 4, 100) * Twip
                        if ( s側圧数 = 0 $$ (水平部材最下端 = (wYs + wYe) / 2) $$ 水平垂直 = 0 $$ N段数 = 1 ) {
                            MOJY = PYE + 500 //////13/08/11
                        } else {
                            MOJY = PY2D - MR * Sin(π * (45 + B角度 + TT) / 180) - 160 //////13/08/11////// - 荷重文字サイズ / 3 * Twip
                        }
                    }
                    if ( (MOJX - f前位置) < -200 ) {
            //                MOJY = MOJY - 140
                        MOJX = MOJX - (MOJX - f前位置) * 0.7 //////13/08/11
                    }
                    this.MOJ1("D上", MOJX, MOJY, B角度, strAB)
                }
                */
        }

        /*
////////============// プレストレストによる二次応力①
private void Fプレス荷重12(obj, 節点S As Integer, 節点E As Integer, 荷重図開き, 荷重方向5, 荷重mark, 荷重_L1, 荷重_L2, _
         荷重_P1, 荷重_P2, BUZAN As Integer, BUZAN9 As Integer, TATE_flg As Integer, CASU As Integer, _
         連続P1, 連続P2, 連続P3, BZA9 As Integer, wXs As Single, wXe As Single, wYs As Single, wYe As Single, _
         PX0, PY0, PXE, PYE, BCS, BSN, 図BSPAN, YY1, Yy2, B角度, MR)
var PPX1 As Single, PPY1 As Single, PPX2, PPY2
var strAB As String
//    Case 12 // プレストレストによる二次応力①
    YY1 = Abs(YY1)
    Yy2 = Abs(Yy2)
    if ( 荷重_P1 != 0 ) {
        PX0 = HEN_X(wXs)
        PXE = HEN_X(wXe)
        PY0 = HEN_Y(wYs) - 200 ////////08/06/05
        PYE = HEN_Y(wYe) - 200 ////////08/06/05
        if ( 固定部材PURE1荷重長さ > 0 ) {
            YY1 = 固定部材PURE1荷重長さ * Twip
        }
        YY1 = YY1 / 1.5 ////////08/06/05
        PPX1 = PX0 + YY1 * BCS
        PPY1 = PY0 + YY1 * BSN - 150
        DrawLinePrt obj, PX0, PY0 - 150, PPX1, PPY1
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(PX0), CSng(PY0 - 150), CSng(PPX1), CSng(PPY1))
        }
        this.荷重矢印(PX0, PY0 - 150, PPX1, PPY1)
        if ( 前PRESUT != 荷重_P1 ) {
        if ( strUN = "" ) { ////////////////////////////////////07/05/12
            strAB = "  P1=" + F2(荷重_P1) + " "
        } else {
            strAB = "  " + GetUsing(荷重_P1, "#######0.00 ") + strUN
        }
        PX0 = PX0 - 2 * Twip
        PXE = PX0
        PY0 = PY0 - MR * 2
        PYE = PY0 - 1000
        this.MOJ2C("U上", PX0, PY0, PXE, PYE, strAB) ////////07/08/04
        }
    }
    if ( 荷重_P2 != 0 ) {
        PX0 = HEN_X(wXs)
        PXE = HEN_X(wXe)
        PY0 = HEN_Y(wYs) - 200 ////////08/06/05
        PYE = HEN_Y(wYe) - 200 ////////08/06/05
        if ( 固定部材PURE1荷重長さ > 0 ) {
            Yy2 = 固定部材PURE1荷重長さ * Twip
        }
        Yy2 = Yy2 / 1.5 ////////08/06/05
        PPX2 = PXE - Yy2 * BCS
        PPY2 = PYE + Yy2 * BSN - 150
        DrawLinePrt obj, PXE, PYE - 150, PPX2, PPY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(PXE), CSng(PYE - 150), CSng(PPX2), CSng(PPY2))
        }
        this.荷重矢印(PXE, PYE - 150, PPX2, PPY2)
        if ( strUN = "" ) { ////////////////////////////////////07/05/12
            strAB = "  P2=" + F2(荷重_P2) + " "
        } else {
            strAB = "  " + GetUsing(荷重_P2, "#######0.00 ") + strUN
        }
        PX0 = PXE - 2 * Twip
        PXE = PX0
        PY0 = PY0 - MR * 2
        PYE = PY0 - 1000
        this.MOJ2C("U上", PX0, PY0, PXE, PYE, strAB) ////////07/08/04
    }
}
*/

        /*
private void Fプレス荷重13(obj, 節点S As Integer, 節点E As Integer, 荷重図開き, 荷重方向5, 荷重mark, 荷重_L1, 荷重_L2, _
         荷重_P1, 荷重_P2, BUZAN As Integer, BUZAN9 As Integer, TATE_flg As Integer, CASU As Integer, _
         連続P1, 連続P2, 連続P3, BZA9 As Integer, wXs As Single, wXe As Single, wYs As Single, wYe As Single, _
         PX0, PY0, PXE, PYE, BCS, BSN, 図BSPAN, YY1, Yy2, B角度)
var MR As Single
var EnPRM1                  As Single
var EnPRM2                  As Single
var EnPRM3                  As Single
var EnPRM4                  As Single
var EnPRM5                  As Single
var EnTYPE1                 As Single
var strAB                   As String
        PX0 = HEN_X(wXs)
        PXE = HEN_X(wXe)
        PY0 = HEN_Y(wYs)
        PYE = HEN_Y(wYe)
        if ( Flg_PRESTRES(1) = 0 ) { ////////08/06/05
            PY0 = PY0 - 500
            PYE = PYE - 500
        } else {
            PY0 = PY0 - 1800
            PYE = PYE - 1800
        }
    if ( 荷重_P1 != 0 $$ 前PRESUT != 荷重_P1 ) {
        MR = Abs(YY1) / 2 ////////////////////////////////////////07/08/04
        if ( 固定部材PURE2荷重長さ > 0 ) {
            MR = 固定部材PURE2荷重長さ * Twip / 2 ////////////////////////////////////////07/08/04
        }
        DrawCirclePrt obj, PX0, PY0, MR, π * (45 + B角度) / 180, π * (-45 + B角度) / 180
        if ( CreateDxfFlag = 1 ) {
            EnPRM1 = CSng(PX0)
            EnPRM2 = CSng(PY0)
            EnPRM3 = CSng(MR)
            EnPRM4 = KAngS(CSng(π * (45 + B角度) / 180))
            EnPRM5 = KAngS(CSng(π * (-45 + B角度) / 180))
            EnTYPE1 = 7
            this.PLOTCIRCLE(EnPRM1, EnPRM2, EnPRM3, EnPRM4, EnPRM5, EnTYPE1)
        }
        if ( strUN = "" ) { ////////////////////////////////////07/05/12
            strAB = "  M1=" + F2(荷重_P1) + " "
        } else {
            strAB = GetUsing(荷重_P1, "######0.00 ") + strUN & "･m "
        }
        PX0 = PX0 - 2 * Twip
        PXE = PX0
        PY0 = PY0 - MR * 2
        PYE = PY0 - 1000
        this.MOJ2C("U上", PX0, PY0, PXE, PYE, strAB) ////////07/08/04
    }
        PX0 = HEN_X(wXs)
        PXE = HEN_X(wXe)
        PY0 = HEN_Y(wYs)
        PYE = HEN_Y(wYe)
    if ( 荷重_P2 != 0 ) {
        MR = Abs(Yy2) / 2 ////////////////////////////////////////07/08/04
        if ( 固定部材PURE2荷重長さ > 0 ) {
            MR = 固定部材PURE2荷重長さ * Twip / 2 ////////////////////////////////////////07/08/04
        }
        DrawCirclePrt obj, PXE, PYE, MR, π * (-135 + B角度) / 180, π * (135 + B角度) / 180
        if ( CreateDxfFlag = 1 ) {
            EnPRM1 = CSng(PXE)
            EnPRM2 = CSng(PYE)
            EnPRM3 = CSng(MR)
            EnPRM4 = KAngS(CSng(π * (-135 + B角度) / 180))
            EnPRM5 = KAngS(CSng(π * (135 + B角度) / 180))
            EnTYPE1 = 7
            this.PLOTCIRCLE(EnPRM1, EnPRM2, EnPRM3, EnPRM4, EnPRM5, EnTYPE1)
        }
        if ( strUN = "" ) { ////////////////////////////////////07/05/12
            strAB = "  M2=" + F2(荷重_P2) + " "
        } else {
            strAB = GetUsing(荷重_P2, "######0.00 ") + strUN & "･m "
        }
        PX0 = PXE - 2 * Twip
        PXE = PX0
        PY0 = PY0 - MR * 2
        PYE = PY0 - 1000
        this.MOJ2C("U上", PX0, PY0, PXE, PYE, strAB) ////////07/08/04
    }
}
    */

        /*
//private void F連行荷重F() //////連行荷重 141414
private void F連行荷重F(obj, 節点S As Integer, 節点E As Integer, 荷重図開き, 荷重方向5, 荷重mark, 荷重_L1, 荷重_L2, _
         荷重_P1, 荷重_P2, BUZAN As Integer, BUZAN9 As Integer, TATE_flg As Integer, CASU As Integer, _
         連続P1, 連続P2, 連続P3, BZA9 As Integer, wXs As Single, wXe As Single, wYs As Single, wYe As Single, _
         PX0, PY0, PXE, PYE, BCS, BSN, 図BSPAN)
//    Case 14 // 連行荷重 141414
//        var yY01, yYE1, yY02, yYE2
double     var i
double     var X1
double     var y1
double //        var Hx
double //        var Hy
double //        var Hz
double     var Bai
double     var X0
double     var Y0
double     var X2
double     var Y2
double     var CC
double     var SS
double     var AA
    var MOJ
    var Koubai  As Single
    //
    Koubai = (HEN_Y(wYe) - HEN_Y(wYs)) / (HEN_X(wXe) - HEN_X(wXs))
    Bai = 8
    CC = 1
    SS = 0
    AA = 0
    if ( BZA9 = 9999 || BUZAN = BUZAN9 ) {
        MOJ = "連 行"
        PY0 = PY0 - Abs(部材荷重Fontsize * BCS * Twip / 2.5) + 3 * Twip - 2 * Twip - 3.5 * Twip
        PYE = PYE - Abs(部材荷重Fontsize * BCS * Twip / 2.5) + 3 * Twip - 2 * Twip - 3.5 * Twip
//            PY0 = PY0 - 2 * Twip
//            PYE = PYE - 2 * Twip
////
//            PY0 = PY0 - 3.5 * Twip //////08/10/29
//            PYE = PYE - 3.5 * Twip
//            yY01 = PY0: yYE1 = PYE
        if ( 図BSPAN > 300 ) {
        this.MOJ2C("D上", PX0, PY0, PXE, PYE, MOJ)
        }
        //
        MOJ = "α=" & Format(荷重_P1, "0.000") //////////////08/10/25
        PX0 = PX0 - 1.5 * Twip
        PY0 = PY0 + 3.5 * Twip
        PYE = PYE + 3.5 * Twip
//            yY02 = PY0: yYE2 = PYE
        if ( 図BSPAN > 300 ) {
        this.MOJ2C("D上", PX0, PY0, PXE, PYE, MOJ)
        }
    } else {
        var NN As Integer, JJ As Integer, LLL As Single //////, ST1 As Integer, ST2 As Integer
//            var mX1 As Single, mX2 As Single, mY1 As Single, mY2 As Single
//            mX1 = PX0: mX2 = PXE
//            mY1 = PY0: mY2 = PYE
        MOJ = "連 行 (" & Format(BUZAN) & "～" & Format(IIf(BUZAN != BUZAN9, BUZAN9, BZA9)) & ")"
        MOJ = "連 行"
        For( JJ = 1 To BuzaiFF
            NN = GGGGG(JJ)
            PX0 = HEN_X(節X(部I(NN)))
            PXE = HEN_X(節X(部J(NN)))
            PY0 = HEN_Y(節Y(部I(NN)))
            PYE = HEN_Y(節Y(部J(NN)))
            PY0 = PY0 - Abs(部材荷重Fontsize * BCS * Twip / 2.5) + 3 * Twip - 2 * Twip - 3.5 * Twip
            PYE = PYE - Abs(部材荷重Fontsize * BCS * Twip / 2.5) + 3 * Twip - 2 * Twip - 3.5 * Twip
//                PY0 = PY0 - 2 * Twip
//                PYE = PYE - 2 * Twip
//    //
//                PY0 = PY0 - 3.5 * Twip //////08/10/29
//                PYE = PYE - 3.5 * Twip
//                yY01 = PY0: yYE1 = PYE
            if ( PXE - PX0 > 300 ) {
            this.MOJ2C("D上", PX0, PY0, PXE, PYE, "連 行")
            }
            //
            MOJ = "α=" & Format(荷重_P1, "0.000") //////////////08/10/25
            PX0 = PX0 - 1.5 * Twip
            PY0 = PY0 + 3.5 * Twip
            PYE = PYE + 3.5 * Twip
//                yY02 = PY0: yYE2 = PYE
            if ( PXE - PX0 > 300 ) {
            this.MOJ2C("D上", PX0, PY0, PXE, PYE, MOJ)
            }
        }J
        NN = GGGGG(1): 節点S = 部I(NN)
        NN = GGGGG(BuzaiFF): 節点E = 部J(NN)
    }
////////////
        MOJ = ""
//            if ( s連行前(1, 1) = BUZAN $$ s連行前(1, 2) != 0 ) {
        if ( (s連行前(1, 1) = BUZAN $$ s連行前節点(1) = 節点S) $$ s連行前(1, 2) != 0 ) { //////09/10/20
            MOJ = "α=" & Format(s連行前(1, 2), "0.000")
            s連行前(1, 1) = 0: s連行前(1, 2) = 0
        }
        if ( (s連行前(2, 1) = BUZAN $$ s連行前節点(2) = 節点S) $$ s連行前(2, 2) != 0 ) { //////09/10/20
            MOJ = "α=" & Format(s連行前(2, 2), "0.000")
            s連行前(2, 1) = 0: s連行前(2, 2) = 0
        }
        if ( MOJ != "" ) {
            PX0 = HEN_X(wXs) - 15 * Twip
            PXE = HEN_X(wXs) - 3 * Twip
            //
            PYE = HEN_Y(wYs) - Abs(部材荷重Fontsize * BCS * Twip / 2.5) + 3 * Twip - 2 * Twip - 3.5 * Twip ////// + 3 * Twip - 8 * Twip
            PY0 = PYE - (PXE - PX0) * Koubai

            this.MOJ2C("D上", PX0, PY0, PXE, PYE, "連行")
            PY0 = PY0 + 3.5 * Twip
            PYE = PYE + 3.5 * Twip
            this.MOJ2C("D上", PX0, PY0, PXE, PYE, MOJ)
            PX0 = HEN_X(wXs) - 20 * Twip
            PXE = HEN_X(wXs) - 1 * Twip
//////09/07/22 勾配考慮
            PY0 = HEN_Y(wYs) - 15 * Twip * Koubai //(HEN_Y(wYe) - HEN_Y(wYs)) _
                                                / (HEN_X(wXe) - HEN_X(wXs))
            PYE = HEN_Y(wYs)
            obj.PenWidth = 部材荷重Pen幅 + 10
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(obj.PenWidth))
            }
            DrawLinePrt obj, PX0, PY0, PXE, PYE ////////////スラブ桁
            ////////支点マーク
            obj.PenWidth = 部材Pen幅 - 8
                    X0 = PX0 + 1.2 * Twip
                    Y0 = PY0
                    X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                    y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                    X2 = X0 + Xvo(-7 * Bai, 10 * Bai, CC, SS, AA, i)
                    Y2 = Y0 + Yvo(-7 * Bai, 10 * Bai, CC, SS, AA, i)
                    DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                    X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                    y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                    X2 = X0 + Xvo(7 * Bai, 10 * Bai, CC, SS, AA, i)
                    Y2 = Y0 + Yvo(7 * Bai, 10 * Bai, CC, SS, AA, i)
                    DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                    X1 = X0 + Xvo(-7 * Bai, 10 * Bai, CC, SS, AA, i)
                    y1 = Y0 + Yvo(-7 * Bai, 10 * Bai, CC, SS, AA, i)
                    X2 = X0 + Xvo(7 * Bai, 10 * Bai, CC, SS, AA, i)
                    Y2 = Y0 + Yvo(7 * Bai, 10 * Bai, CC, SS, AA, i)
                    DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
        }

        MOJ = ""
        if ( (s連行後(1, 1) = BZA9 $$ s連行後節点(1) = 節点E) $$ s連行後(1, 2) != 0 ) {
            MOJ = "α=" & Format(s連行後(1, 2), "0.000")
            s連行後(1, 1) = 0: s連行後(1, 2) = 0: s連行後節点(1) = 0
        }
        if ( (s連行後(2, 1) = BZA9 $$ s連行後節点(2) = 節点E) $$ s連行後(2, 2) != 0 ) {
            MOJ = "α=" & Format(s連行後(2, 2), "0.000")
            s連行後(2, 1) = 0: s連行後(2, 2) = 0: s連行後節点(2) = 0
        }
        if ( MOJ != "" ) {
            PX0 = HEN_X(wXe) + 3 * Twip
            PXE = HEN_X(wXe) + 15 * Twip
            PY0 = HEN_Y(wYe) - Abs(部材荷重Fontsize * BCS * Twip / 2.5) + 3 * Twip - 2 * Twip - 3.5 * Twip ////// + 3 * Twip - 8 * Twip
            PYE = PY0 + (PXE - PX0) * Koubai
            this.MOJ2C("D上", PX0, PY0, PXE, PYE, "連行")
            PY0 = PY0 + 3.5 * Twip
            PYE = PYE + 3.5 * Twip
            this.MOJ2C("D上", PX0, PY0, PXE, PYE, MOJ)
            PX0 = HEN_X(wXe) + 1 * Twip
            PXE = HEN_X(wXe) + 20 * Twip
            PY0 = HEN_Y(wYe)
//////09/07/22 勾配考慮
            PYE = HEN_Y(wYe) + 15 * Twip * (HEN_Y(wYe) - HEN_Y(wYs)) _
                                                / (HEN_X(wXe) - HEN_X(wXs))
            obj.PenWidth = 部材荷重Pen幅 + 10
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(obj.PenWidth))
            }
            DrawLinePrt obj, PX0, PY0, PXE, PYE
            ////////支点マーク
            obj.PenWidth = 部材Pen幅 - 8
                    X0 = PXE - 1.2 * Twip
                    Y0 = PYE
                    X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                    y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                    X2 = X0 + Xvo(-7 * Bai, 10 * Bai, CC, SS, AA, i)
                    Y2 = Y0 + Yvo(-7 * Bai, 10 * Bai, CC, SS, AA, i)
                    DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                    X1 = X0 + Xvo(0, 0, CC, SS, AA, i)
                    y1 = Y0 + Yvo(0, 0, CC, SS, AA, i)
                    X2 = X0 + Xvo(7 * Bai, 10 * Bai, CC, SS, AA, i)
                    Y2 = Y0 + Yvo(7 * Bai, 10 * Bai, CC, SS, AA, i)
                    DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
                    X1 = X0 + Xvo(-7 * Bai, 10 * Bai, CC, SS, AA, i)
                    y1 = Y0 + Yvo(-7 * Bai, 10 * Bai, CC, SS, AA, i)
                    X2 = X0 + Xvo(7 * Bai, 10 * Bai, CC, SS, AA, i)
                    Y2 = Y0 + Yvo(7 * Bai, 10 * Bai, CC, SS, AA, i)
                    DrawLinePrt frmPrint.vsPrt1, X1, y1, X2, Y2
        }
}
*/

        private double CalcLengX(double PX1D, double PY1D, double PX2D, double PY2D)
        {
            //
            double X1 = PX1D;
            double y1 = PY1D;
            double X2 = PX2D;
            double Y2 = PY2D;

            return Math.Abs(Math.Sqrt((X1 - X2) * (X1 - X2) + (y1 - Y2) * (y1 - Y2)));

        }

        private void F節点荷重(object obj, int CASU, int 節点J, double 荷重_FX, double 荷重_FY, double 荷重_M,
            string strFF, string str鉛直, int HIDAR = 0)
        { //////08/08/28
            /*
//
var i                       As Integer
var S角度
var E角度
var XJ
var YJ
var XX
var X2
var YY
var Y2
var MR
var X3
var Y3
var X4
var Y4
var X5
var Y5
var X右
var X左
var Y上
var Y下
var dLX
var dLY
var DD1
var DD2
var DDD
var MM上
var strHH                   As String
var w
var H向                     As Single
var EnPRM1                  As Single
var EnPRM2                  As Single
var EnPRM3                  As Single
var EnPRM4                  As Single
var EnPRM5                  As Single
var EnTYPE1                 As Single
var 段上げ量                As Single
var 段上げTYP               As Single
var strFV As String ////////////////////////////////////////////////////////////////////////////////07/01/07
var v節点荷重長さ As Single //////08/10/29
var n柱X As Single, HASIRA1 As Single, HASIRA2 As Single //////08/11/25
var Bairitu As Single: Bairitu = 1 //////12/12/12
var rKozo As Integer
    rKozo = iKozo
    if ( g柱本数 = 1 $$ iKozo = 1 ) {
        rKozo = 2
    }
//        if ( iKozo = 2 ) { iKozo = 1 //////09/03/25 10/02/24
//
    if ( g柱本数 = 0 ) {
        n柱X = (JX_max + JX_min) / 2
    } else {
        HASIRA1 = 99999: HASIRA2 = -99999
        For( i = 1 To g柱本数
            HASIRA1 = min(HASIRA1, g柱X座標(i, 1))
            HASIRA2 = max(HASIRA2, g柱X座標(i, 1))
        Next
        n柱X = (HASIRA1 + HASIRA2) / 2
    } //////08/11/25
//
v節点荷重長さ = 節点荷重長さmax * Twip
if ( fMainForm.SICheck = True ) { //SI単位チェック
    荷重_FX = Round(荷重_FX, 2)
    荷重_FY = Round(荷重_FY, 2)
    荷重_M = Round(荷重_M, 2)
}
if ( RR橋脚 = 2 ) {
//        荷重_FX = Round(荷重_FX, 2)
//        荷重_FY = Round(荷重_FY, 2)
//        荷重_M = Round(荷重_M, 2)
} else {
    if ( (1 / 図Y_SCALE / 1000) < 0.5 $$ (節Y(節点J) < (YY_max * 0.8) || rKozo = 3) ) { //////08/11/04  節Y0() ---> 節Y() 13/006/07
        v節点荷重長さ = v節点荷重長さ * 0.8
    }
}
S角度 = -45 * π / 180
E角度 = 225 * π / 180
//    段上げTYP = 0
//    段上げ量 = 節点荷重段数(節点J) * Round(集中荷重長さmax * Twip * 0.6, 0) //500 ////////////// nagase
//    XJ = HEN_X(節X(節点J))
//    YJ = HEN_Y(節Y(節点J)) - 段上げ量
MM上 = 1 //0
obj.PenColor = QBColor(節点荷重Pen色)
obj.FontSize = 節点荷重Fontsize
obj.PenWidth = 節点荷重Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(obj.PenWidth))
}
DDD = Round(2.5 * Twip, 0)
DD1 = DDD * Cos(π * 節点荷重角度 / 180)
DD2 = DDD * Sin(π * 節点荷重角度 / 180)
X右 = ""
X左 = ""
Y上 = ""
Y下 = ""
For( i = 1 To 節点部材角度(節点J, 0)
    Select Case 節点部材角度(節点J, i)
        Case 0 To 5
            X右 = "*"
        Case 85 To 95
            Y上 = "*"
        Case 175 To 185
            X左 = "*"
        Case 265 To 275
            Y下 = "*"
        Case 355 To 365
            X右 = "*"
    End Select
}
if ( 荷重_FX != 0 ) {
//        段上げTYP = 1
    if ( 荷重_FX > 0 ) { //////09/04/14
        段上げ量 = 節点荷重段数(節点J, 2) * Round(集中荷重長さmax * Twip * 0.5, 0)
    } else {
        段上げ量 = 節点荷重段数(節点J, 4) * Round(集中荷重長さmax * Twip * 0.5, 0) //////09/04/14
    }
    XJ = HEN_X(節X(節点J))
    YJ = HEN_Y(節Y(節点J)) - 段上げ量
    obj.PenWidth = 節点荷重Pen幅
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(obj.PenWidth))
    }
    X5 = XJ - DDD * Sgn(荷重_FX)
    Y5 = YJ
    XX = 節点荷重初期値 * Twip + Abs(荷重_FX * 節点荷重Scale) + IIf(str鉛直 = "", 0, Len(str鉛直) * 20)
    if ( XX > 節点荷重長さmax * Twip * 0.7 ) { //////08/10/292
        if ( (節点荷重長さmax * 0.7) > ((JX_max - JX_min) / 図X_SCALE / 1000) ) { //////12/12/12
            XX = (節点荷重長さmax * 0.7)
        } else {
            XX = ((JX_max - JX_min) / 図X_SCALE / 1000) * 0.8
        }
        XX = XX * Twip + IIf(str鉛直 = "", 0, Len(str鉛直) * 20)
    }
    if ( 荷重_FX < 0 ) {
        XX = -XX
    }
            if ( XX > 600 $$ g柱本数 > 10 $$ RR橋脚 = 1 $$ (XX / 図X_SCALE / 1000) > 50 ) { //////13/02/24
                XX = 500
            }

    X2 = X5 - XX
    Y2 = Y5
    dLY = XX * Sin(π * 節点荷重角度 / 180)
    Select Case 荷重_FX
        Case 0
        Case Is > 0
            if ( X左 = "*" ) {
                Y2 = Y2 - dLY - 20 //////08/11/04
                X5 = XJ - DD1 - 20
                Y5 = YJ - DD2 - 20
            }
        Case Is < 0
            if ( X右 = "*" ) {
                Y2 = Y2 + dLY - 20
                X5 = XJ + DD1 - 20
                Y5 = YJ - DD2 - 20
            }
    End Select
    DrawLinePrt obj, X2, Y2, X5, Y5
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(X2), CSng(Y2), CSng(X5), CSng(Y5))
    }
    obj.PenWidth = 節点荷重Pen幅 - 6
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(obj.PenWidth))
    }
    this.荷重矢印L(Sgn(荷重_FX), X2, Y2, X5, Y5)
    MM上 = 1
    if ( rKozo = 2 ) {
        Y2 = Y2 - v節点荷重長さ / 10
    } else {
        if ( Not g連続Mod ) {
//                if ( Not (荷重_FX < 0 $$ Abs(節X(節点J) - 柱間離れ(1)) < 0.5) || (荷重_FX > 0 $$ Abs(節X(節点J) - 柱間離れ(2)) < 0.5) ) {
//                    if ( 荷重_FX * 荷重_M < 0 ) {
//                    Y2 = Y2 - 荷重文字サイズ / 6 * Twip ////////// 05/03/03////// 08/11/039
//                    }
//                }
            Y2 = Y2 - (荷重文字サイズ / 20 * Twip) ////////// 08/11/039
            //
            if ( Abs(M荷重(1) - XJ) < 300 ) { //////12/12/12
                Y2 = Y2 - (荷重文字サイズ / 3 * Twip)
            }
        }
    }
var r水平補正 As Single, X1 As Single, y1 As Single //////////14/11/15
r水平補正 = 9999
    For( i = 1 To Jn_max
        if ( g節点水平荷重座標(i, 1) != 0 ) {
            X1 = g節点水平荷重座標(i, 1)
            y1 = g節点水平荷重座標(i, 2)
            Y3 = Sqr((X1 - HEN_X(節X(節点J))) ^ 2 + (y1 - HEN_Y(節Y(節点J))) ^ 2)
            if ( r水平補正 > Y3 ) {
                r水平補正 = Y3
            }
        }
    }
    if ( r水平補正 < 150 ) {
        Y2 = HEN_Y(節Y(節点J)) + (frmPrint.vsPrt1.FontSize * Twip * 0.45) //////(部材荷重Fontsize * Twip * 0.48)
    }
    g節点水平荷重座標(節点J, 1) = HEN_X(節X(節点J))
    g節点水平荷重座標(節点J, 2) = HEN_Y(節Y(節点J))
    if ( 荷重_FX > 0 ) {
//            if ( 荷重_M != 0 || 節X(節点J) = JX_min ) { ////////08/11/039
            X2 = X2 - v節点荷重長さ / 10 - IIf(rKozo = 2 || RR橋脚 = 2, 100, 30) - IIf(荷重_M != 0, 100, 30) //////12/09/15
            X5 = X5 - v節点荷重長さ / 10 - IIf(rKozo = 2 || RR橋脚 = 2, 100, 30) - IIf(荷重_M != 0, 100, 30)
//            }
        if ( strUN = "" ) {
            strHH = " H=" + F2(Abs(荷重_FX)) + "   "
        } else {
            strHH = IIf(rKozo = 2, " H=", "") + F2(Abs(荷重_FX)) + strUN
            X2 = X2 - 40 ////////07/05/15
            X5 = X5 - 40 ////////07/05/15
        }
//            Y2 = Y2 - 5 //////////////////////////////////////////////////////////////////////////////05/02/23//////08/08/21コメント
        if ( rKozo = 2 $$ X右 = "*" ) {
           if ( strUN = "" ) {
                strHH = " H=" + F2(Abs(荷重_FX)) + "     "
           } else {
                strHH = IIf(rKozo = 2, " H=", "") + F2(Abs(荷重_FX)) + strUN + "     "
//                    X2 = X2 - v節点荷重長さ / 5 ////////07/05/15
//                    X5 = X5 - v節点荷重長さ / 5 ////////07/05/15
           }
           Y2 = Y2 + 130 - IIf(Y2 = Y5, 0, 60) //////08/06/21
        } else {
//                if ( X左 = "*" $$ 節Y(節点J) < YY_基礎 + (YY_max - YY_基礎) / 10 ) {  //////08/08/21////08/11/039
//                    X2 = X2 - 集中荷重長さmax * Twip * 0.3//////08/11/039
//                    X5 = X5 - 集中荷重長さmax * Twip * 0.3
//                    Y2 = Y2 + 80
//                }
        }
        if ( str鉛直 != "" ) {
//                strHH = IIf(rKozo = 2, "H = ", " ") + str鉛直 + strUN + "     " //////13/11/24
//                Y2 = Y5 - 100
        }
        if ( rKozo = 3 $$ g連続Mod = False $$ FLG側圧あり > 0 $$ 節Y(節点J) = 水平部材最下端 $$ (節X(節点J) = g柱X座標(1, 1)) ) {
            Y2 = Y2 + 320 //////14/12/22
        }
        this.MOJ2R("D上", X2, Y2, X5, Y2, strHH)
    } else {
//            if ( 荷重_M != 0 || 節X(節点J) = JX_max ) { ////////08/11/039
//                X2 = X2 + v節点荷重長さ / 3
//                X5 = X5 + v節点荷重長さ / 3
//                X2 = X2 + v節点荷重長さ / 20 + IIf(rKozo = 2, 100, 0) + IIf(X右 = "", 150, IIf(荷重_M != 0, 150, 0))  //////12/09/15
//                X5 = X5 + v節点荷重長さ / 20 + IIf(rKozo = 2, 100, 0) + IIf(X右 = "", 150, IIf(荷重_M != 0, 150, 0))
            X2 = X2 + v節点荷重長さ / 20 + IIf(rKozo = 2, 100, 0) + IIf(X右 = "" || 荷重_M != 0, 150, 0) // IIf(荷重_M != 0, 150, 0))  //////12/09/15
            X5 = X5 + v節点荷重長さ / 20 + IIf(rKozo = 2, 100, 0) + IIf(X右 = "" || 荷重_M != 0, 150, 0) // 150, IIf(荷重_M != 0, 150, 0))
//            }
        if ( strUN = "" ) {
            strHH = "   H = " + F2(Abs(荷重_FX)) + " "
        } else {
            strHH = Space(9 - Len(F2(Abs(荷重_FX)))) + IIf(rKozo = 2, " H = ", " ") + F2(Abs(荷重_FX)) + strUN + " "
//                X2 = X2 + 200
//                X5 = X5 + 200
        }
//            Y2 = Y2 - 5 //////////////////////////////////////////////////////////////////////////////05/02/23//////08/08/21コメント
        if ( rKozo = 2 $$ X右 = "*" ) {
           if ( strUN = "" ) {
           strHH = "         H=" + F2(Abs(荷重_FX)) + " "
           } else {
           strHH = "        " + IIf(rKozo = 2, " H=", " ") + F2(Abs(荷重_FX)) + strUN
           }
           Y2 = Y2 + 130 - IIf(Y2 = Y5, 0, 60) //////08/06/21
        } else {
            if ( X右 = "*" $$ 節Y(節点J) < YY_基礎 + (YY_max - YY_基礎) / 10 ) {  //////08/08/21
                X2 = X2 + 集中荷重長さmax * Twip * 0.1 //////08/11/039
                X5 = X5 + 集中荷重長さmax * Twip * 0.1
//                    Y2 = Y2 + 80
            }
        }
//            if ( str鉛直 != "" ) {
//                strHH = IIf(rKozo = 2, "  H = ", " ") + str鉛直 + strUN //////13/11/24
//                Y2 = Y5 - 100
//            }
        if ( rKozo = 3 $$ g連続Mod = False $$ FLG側圧あり > 0 $$ 節Y(節点J) = 水平部材最下端 $$ 節X(節点J) = g柱X座標(g柱本数, 1) ) {
            Y2 = Y2 + 320 //////14/12/22
        }
        this.MOJ2L("D上", X5, Y2, X2, Y2, strHH)
    }
}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
var M7, L8, L9 As Integer ////13/06/03
var FLG7 As Integer
FLG7 = 0
if ( 荷重_FY != 0 ) {
//        段上げTYP = 2
    段上げ量 = 節点荷重段数(節点J, 1) * Round(集中荷重長さmax * Twip * 0.6, 0)
    ////////
    XJ = HEN_X(節X(節点J))
    YJ = HEN_Y(節Y(節点J)) - 段上げ量
    if ( (n柱X < 節X(節点J) $$ (JX_max = 節X(節点J) || Y上 = "*")) || _
                (JX_max = JX_min $$ rKozo = 1 $$ 段上げ量 = 0 $$ YY_max - 節Y(節点J) < 0.5) ) {
        H向 = -1
    } else {
        H向 = 1
    }
    if ( 荷重_FY < 0 $$ (節X(節点J) = g柱X座標(1, 1) || 節X(節点J) = g柱X座標(g柱本数, 1)) ) { //////09/11/16
        if ( 節点J = 下層BUZAI(1, 2) || 節点J = 下層BUZAI(1, 3) || _
           節点J = 下層BUZAI(y最低CUNT, 2) || 節点J = 下層BUZAI(y最低CUNT, 3) ) {
            H向 = -H向
            FLG7 = 1
        }
    }
////////////13/06/03
    if ( Y上 = "*" $$ FLG7 = 0 $$ g柱本数 >= 2 $$ rKozo = 3 $$ (g柱X座標(g柱本数, 1) != 節X(節点J) || g柱X座標(1, 1) != 節X(節点J)) ) {  //////13/06/03
        if ( FLG_柱軸重 = True ) { ////////13/06/03 if ( InStr(荷重名称(逆実荷重NO(CASU)), "死荷重") != 0 ) {
            if ( n柱X <= 節X(節点J) ) { //////13/08/11
                H向 = 1
            } else {
                H向 = -1
            }
        } else {
            For( M7 = 1 To g柱本数
                if ( g柱X座標(M7, 1) = 節X(節点J) ) {
                    Exit For
                }
            Next M7
            if ( M7 = 1 ) {
                L8 = 0
            } else {
                L8 = (節X(節点J) - g柱X座標(M7 - 1, 1))
            }
            if ( M7 >= g柱本数 ) {
                L9 = 0
            } else {
                L9 = (g柱X座標(M7 + 1, 1) - 節X(節点J))
            }
            if ( L8 <= L9 ) {
                H向 = -1
            } else {
                H向 = 1
            }
        }
    }
////////////13/06/03
//
    obj.PenWidth = 節点荷重Pen幅
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(obj.PenWidth))
    }
    X5 = XJ
    Y5 = YJ - DDD
    YY = 節点荷重初期値 * Twip + Abs(荷重_FY * 節点荷重Scale)
    if ( YY > v節点荷重長さ ) {
        YY = v節点荷重長さ
    }
    X2 = X5
    Y2 = Y5 - YY
    dLX = YY * Sin(π * 節点荷重角度 / 180) * H向
    Select Case 荷重_FY
        Case 0
        Case Is > 0
            if ( Y上 = "*" ) {
                X2 = X2 - dLX - 20 * Sgn(dLX) //////08/11/066
                X5 = XJ - DD2 * H向 - 20 * Sgn(dLX)
                Y5 = YJ - DD1
            }
        Case Is < 0
            if ( Y上 = "*" ) {
                X2 = X2 - dLX - 20 * Sgn(dLX) //////08/11/066
                X5 = XJ - DD2 * H向 - 20 * Sgn(dLX)
                Y5 = YJ - DD1
            }
    End Select

    DrawLinePrt obj, X5, Y5, X2, Y2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(X5), CSng(Y5), CSng(X2), CSng(Y2))
    }
    obj.PenWidth = 節点荷重Pen幅 - 6
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(obj.PenWidth))
    }
    if ( 荷重_FY > 0 ) {
        this.荷重矢印L(1, X2, Y2, X5, Y5)
    } else {
        this.荷重矢印L(1, X5, Y5, X2, Y2)
    }
    DD1 = 0
    if ( rKozo = 2 || (JX_min = 節X(節点J) || JX_max = 節X(節点J)) ) { ////////08/11/03
        DD1 = Round(部材荷重Fontsize * Twip * 0.1, 1)
    }
    if ( rKozo = 3 $$ Y上 = "*" ) { //////13/06/03
        DD1 = 0
    }
    if ( Y上 = "*" ) { ////////////////////////////////////////////////////////////////////////////////07/01/07
        if ( H向 > 0 ) {
            X3 = X2 - 部材荷重Fontsize * Twip * 0.04 - DD1 ////////08/11/03
        } else {
            X3 = X2 + 部材荷重Fontsize * Twip * 0.41 + DD1
        }
    } else {
        ////////////////////////13/04/20
        if ( JX_min = 節X(節点J) || g柱X座標(1, 1) = 節X(節点J) || (n柱X > 節X(節点J) $$ 節点部材数(節点J) <= 2) ) {
            X3 = X2 - 部材荷重Fontsize * Twip * 0.1 - DD1  ////////08/11/03//////10/10/14
        } else {
            X3 = X2 + 部材荷重Fontsize * Twip * 0.45 + DD1 //////12/12/16
        }
    }
    if ( rKozo = 1 $$ Abs(節Y(節点J) - YY_max) < 0.2 $$ 荷重_FX != 0 ) { //////12/09/23
        if ( 荷重_FX > 0 ) {
            X3 = X3 - 30
        } else {
            X3 = X2 - (部材荷重Fontsize * Twip * 0.04 - DD1 + 30)
        }
    }

    if ( str鉛直 = "" ) { //////08/08/28
        if ( strUN = "" ) { //////////////////////////////////////////07/05/14
            strFV = " P=" + F2(荷重_FY) + " "
        } else {
            strFV = IIf(rKozo = 2, "  P=", "  ") + F2(荷重_FY) + strUN
        }
        if ( 節点荷重段数(節点J, 1) = 0 ) {
            if ( 荷重_FX != 0 ) {
                if ( strUN = "" ) {
                strFV = "  P=" + F2(荷重_FY) + " "
                } else {
                strFV = IIf(rKozo = 2, "  P=", "  ") + F2(荷重_FY) + strUN //////08/11/04
                }
            }
            if ( 荷重_M != 0 ) { // || 節点荷重段数(節点J, 1) = 0 ) {
                if ( strUN = "" ) {
                strFV = "   P=" + F2(荷重_FY) + " "
                } else {
                strFV = IIf(rKozo = 2, "  P=", "   ") + F2(荷重_FY) + strUN //////08/11/04
                }
            }
            if ( X2 != X5 ) {
                if ( strUN = "" ) {
                strFV = "     P=" + F2(荷重_FY) + " "
                } else {
                strFV = IIf(rKozo = 2, "    P=", "      ") + F2(荷重_FY) + strUN //////08/11/04
                }
            }
        }
    } else {
        if ( 節Y(節点J) > (YY_max * 0.8) ) { //////09/11/13
            strFV = "    " & str鉛直 + strUN
        } else {
            strFV = "    " & "   " & str鉛直 + strUN
        }
    }
//        if ( H向 = 1 $$ X3 - 前接点X < 300 $$ Abs(節Y(節点J) - YY_max) < 0.5 ) { //////12/12/16
    if ( HIDAR = 1 ) {
        X3 = HEN_X(節X(節点J)) - (部材荷重Fontsize * Twip * 0.08) //////12/12/17
    }
    //
var wHOSEI As Single //////08/11/14
wHOSEI = Round((DDAN(節点J) * 100 - Int(DDAN(節点J) * 100)), 2)
wHOSEI = 0 //////12/12/15
    if ( rKozo = 1 $$ wHOSEI > 0.2 ) { //////////= 13.9 ) { //////////08/11/13
        if ( wHOSEI < 0.6 ) {
            wHOSEI = wHOSEI * 1000
        } else {if ( wHOSEI = 0.7 ) {
            wHOSEI = 200
        } else {
            wHOSEI = 0
        }
        if ( str鉛直 = "" ) {
            strFV = Format(val(strFV), "0.00") + strUN
        } else {
            strFV = str鉛直 + strUN
        }
        if ( Int(DDAN(節点J) * 100) / 100 = 2 ) {
            Y5 = Y5 - 1050 + wHOSEI //////////08/11/13
            Y2 = Y2 - 1050 + wHOSEI
        } else {
            Y5 = Y5 - 1250 + wHOSEI + 400 //////////09/07/22////// + 400
            Y2 = Y2 - 1250 + wHOSEI + 400
        }
        this.MOJ2L("D上", X3, Y5, X3, Y2, strFV)
//            Y5 = Y2 + 50
//            if ( Sgn(dLX) = 1 ) {
//                X3 = X2 - (Len(strFV) * 荷重文字サイズ / 6 * Twip) - 165
//                this.MOJ2L("D上", X3, Y5, X3 + 1, Y5, strFV)
//            } else {
//                X3 = X2 + 100
//                this.MOJ2L("D上", X3, Y5, X3 + 1, Y5, strFV)
//            }
    } else {
        if ( 荷重_M != 0 ) {
//                Y5 = Y5 - 200 //////////////////12/12/12
//                Y2 = Y2 - 200
        }
        if ( rKozo = 2 $$ Abs(節Y(節点J) - YY_max) < 0.2 $$ g柱本数 != 1 ) {
            X3 = HEN_X(節X(節点J)) + 200
            Y2 = (Y2 + Y5) / 2
            this.MOJ2L("D上", X3, Y2, X3 + 1000, Y2, strFV)
        } else {
            ////////////////////////////////////////////////////15/04/05
            if ( Abs(節X(節点J) - JX_min) < 0.1 $$ Abs(節Y(節点J) - YY_max) < 0.2 $$ FLG_左右接点(1) = True ) {
                X3 = HEN_X(節X(節点J)) - 200
                Y2 = Y5 - 180 ////////////(Y2 + Y5) / 2
                this.MOJ2L("D上", X3 - Len(strFV) * (荷重文字サイズ / 6 * Twip), Y2, X3, Y2, strFV)
            } else {if ( Abs(節X(節点J) - JX_max) < 0.1 $$ Abs(節Y(節点J) - YY_max) < 0.2 $$ FLG_左右接点(2) = True ) {
                X3 = HEN_X(節X(節点J)) - 100
                Y2 = Y5 - 180 ////////////(Y2 + Y5) / 2
                this.MOJ2L("D上", X3, Y2, X3 + 500, Y2, strFV)
            } else {
                this.MOJ2L("D上", X3, Y5, X3, Y2, strFV)
            }
        }
    }
}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////
if ( 荷重_M != 0 ) {
//       if ( 段上げTYP != 2 ) { 段上げTYP = 3
    段上げ量 = Int(節点荷重段数(節点J, 3) / 2) * Round(集中荷重長さmax * Twip * 0.3, 0)
    XJ = HEN_X(節X(節点J))
    YJ = HEN_Y(節Y(節点J)) - IIf(段上げ量 = 0, 10, 段上げ量)

    obj.PenWidth = 節点荷重Pen幅 - 3
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(obj.PenWidth))
    }
    MR = 節点荷重初期値 * Twip + Abs(荷重_M * 節点荷重Scale)
    if ( 固定節点M荷重長さ > 0 ) {
        MR = 固定節点M荷重長さ * Twip
    }
    if ( MR > 節点M荷重長さmax * Twip ) {
        MR = 節点M荷重長さmax * Twip
    }
    if ( 節点荷重段数(節点J, 3) - Int(節点荷重段数(節点J, 3) / 2) * 2 = 1 || (図X_SCALE > 0.01) ) { //////12/12/12
        Bairitu = 0.8
        MR = MR * Bairitu
    }
    DrawCirclePrt obj, XJ, YJ, MR, S角度, E角度
    if ( CreateDxfFlag = 1 ) {
        EnPRM1 = CSng(XJ)
        EnPRM2 = CSng(YJ)
        EnPRM3 = CSng(MR)
        EnPRM4 = KAngS(CSng(S角度))
        EnPRM5 = KAngS(CSng(E角度))
        EnTYPE1 = 7
        this.PLOTCIRCLE(EnPRM1, EnPRM2, EnPRM3, EnPRM4, EnPRM5, EnTYPE1)
    }
    if ( 荷重_M > 0 ) { //////////////05/05/28
        X3 = XJ + MR / Sqrt2
        Y3 = YJ + MR / Sqrt2
        X4 = X3 + 65
        Y4 = Y3 - 100
    } else {
        X3 = XJ - MR / Sqrt2 // * 1.05 ////////// 05/04/19
        Y3 = YJ + MR / Sqrt2
        X4 = X3 - 65
        Y4 = Y3 - 100
    }
    obj.PenWidth = 節点荷重Pen幅 - 6
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(obj.PenWidth))
    }
    this.荷重矢印L(1, X4, Y4, X3, Y3)
    w = frmPrint.vsPrt1.TextWidth(" M=" + F2(荷重_M) + IIf(strUN = "", " ", "   "))
    //
    if ( g連続Mod $$ rKozo = 3 ) { ////////////////////////////////////// 05/02/25
//            YJ = YJ - MR / Sqrt2 - 荷重文字サイズ / 6 * Twip
//            if ( Abs(節X(節点J) - 柱間離れ(1)) < 0.5 ) {
//                XJ = XJ - MR / Sqrt2 - w - w / 50
//            } else {if ( Abs(節X(節点J) - 柱間離れ(2)) < 0.5 ) {
//                XJ = XJ + MR / Sqrt2
//            } else {
//                XJ = XJ - MR / Sqrt2
//                YJ = YJ + 2 * MR / Sqrt2 + 荷重文字サイズ * Twip * 0.7
//            }
        YJ = YJ - MR / Sqrt2 - (荷重文字サイズ / 6 * Twip)
        if ( Abs(節X(節点J) - 柱間離れ(1)) < 0.5 ) {
            XJ = XJ - MR / Sqrt2 - w - w / 50
        } else {if ( Abs(節X(節点J) - 柱間離れ(2)) < 0.5 ) {
            XJ = XJ + MR / Sqrt2
        } else {
            XJ = XJ + MR / Sqrt2 / 2 + IIf(荷重_M > 0 $$ FLG記号 = 1, 15, 6) ////////XJ = XJ - MR / Sqrt2 / 8  07/05/12
            if ( JX_min = 節X(節点J) ) { ////////////////06/02/04
                XJ = XJ - w //MR / Sqrt2
            } else {if ( 荷重_FY != 0 ) { //////10/01/30
                XJ = XJ + (荷重文字サイズ * Twip / 16)
            }
//                YJ = YJ - 2 * MR / Sqrt2 // - 荷重文字サイズ * Twip * 0.7XJ = HEN_X(節X(節点J))
        }
    } else { ////////////////////////////////////// 05/02/25
    if ( rKozo != 2 ) { ////////////09/03/25
        if ( (strFF = "N" || (荷重_FY != 0) $$ 荷重_FX = 0) ) {
            if ( Abs(節X(節点J) - 柱間離れ(1)) < 0.5 || (荷重_M < 0 $$ Not Abs(節X(節点J) - 柱間離れ(2)) < 0.5) ) {  ////////06/04/05
//                    XJ = XJ - MR / Sqrt2 - w - w / 50
                if ( Not (Abs(節X(節点J) - 柱間離れ(1)) < 0.5 || Abs(節X(節点J) - 柱間離れ(2)) < 0.5) _
                            $$ (荷重_M < 0 || rKozo = 1) ) {
//                        XJ = XJ - MR / Sqrt2 - w / 50 //////////////////////////////////////////07/07/04
                    XJ = HEN_X(節X(節点J)) - (MR / Sqrt2) * 0.8 - w ////////////12/09/15
                } else {
                    if ( 荷重_M < 0 || Abs(節X(節点J) - 柱間離れ(1)) < 0.5 ) { //////////09/04/02
                        XJ = HEN_X(節X(節点J)) - MR / Sqrt2 - w - w / 50
                    } else {
                        XJ = XJ + MR / Sqrt2 + 70 //////////09/03/25
                    }
                    if ( 荷重_M < 0 ) { ////////And 荷重_FX < 0 ) { //////////////////////////15/02/12
                        XJ = HEN_X(節X(節点J)) - (MR / Sqrt2) * 0.8 - w ////////////12/09/15
                    }
                }
            } else {
                XJ = XJ + MR / Sqrt2 + w / 50 * 2 ////////06/04/05
            }
        } else {
            if ( (Abs(節X(節点J) - 柱間離れ(1)) < 0.5) ) {
                XJ = XJ - MR / Sqrt2 / 10 - w - 50 - 150
            } else {if ( Abs(節X(節点J) - 柱間離れ(2)) < 0.5 ) {
                XJ = XJ + MR / Sqrt2 / 10 + 300 - 50
            } else {if ( 荷重_M > 0 ) { ////////////////////////////////////////////////07/07/04
                XJ = XJ + 200 ////////09/03/16//////12/09/15
            } else {if ( 荷重_M < 0 ) { ////////And 荷重_FX < 0 ) { //////////////////////////15/02/12
                XJ = HEN_X(節X(節点J)) - (MR / Sqrt2) * 0.8 - w ////////////12/09/15
            }
        }
        if ( 荷重_FX != 0 ) {
//                if ( Abs(節X(節点J) - 柱間離れ(1)) < 0.5 || Abs(節X(節点J) - JX_max) < 0.5 || g連続Mod ) {
//                if ( strFF != "N" ) {
                if ( g連続Mod ) {
                    YJ = YJ - 30 ////////////////////05/02/23
                } else {
                    if ( (Abs(節X(節点J) - 柱間離れ(1)) < 0.5) || (Abs(節X(節点J) - 柱間離れ(2)) < 0.5) ) {
//                            YJ = YJ - 160 ////////////////////05/05/28
                        YJ = YJ - 180 - MM上 * Twip * 2 ////////////////////09/03/16
                    } else {
                        if ( 節Y(節点J) < YY_max * 0.9 $$ 節Y(節点J - 1) = 節Y(節点J) $$ 部材正荷重数(節点J - 1) != 0 ) { ////////////07/05/16
                        YJ = HEN_Y(節Y(節点J)) + 340 * Bairitu //////12/12/12
                        } else {
                        YJ = YJ - 180 - MM上 * Twip * 2 ////////////////////05/02/23
                        }
                    }
                }
//                }
        } else {
                    if ( (Abs(節X(節点J) - 柱間離れ(1)) < 0.5) || (Abs(節X(節点J) - 柱間離れ(2)) < 0.5) ) {
                        YJ = YJ - 140
                    } else {
                        if ( 段上げ量 = 0 ) {
                            YJ = YJ + MR / Sqrt2 + MM上 * Twip * 2 ////////////////////05/02/23
                        } else {
                            YJ = YJ - 180 - MM上 * Twip * 2 ////////////////////05/02/23
                        }
                    }
        }
        if ( 荷重_FX != 0 $$ Not g連続Mod ) {
            if ( Not (荷重_FX < 0 $$ Abs(節X(節点J) - 柱間離れ(1)) < 0.5) || (荷重_FX > 0 $$ Abs(節X(節点J) - 柱間離れ(2)) < 0.5) ) {
//                    if ( 荷重_FX * 荷重_M < 0 ) {
//                        YJ = YJ - 荷重文字サイズ / 2 * Twip * 1.2  ////////// 05/03/03
//                    } else {
//                     YJ = YJ - 荷重文字サイズ / 6 * Twip  ////////// 05/03/03
//                    }
            }
        }
        if ( Not (Abs(節X(節点J) - 柱間離れ(1)) < 0.5 || Abs(節X(節点J) - 柱間離れ(2)) < 0.5) ) {
        if ( 荷重_M < 0 || rKozo = 1 || rKozo = 2 ) { //////////07/07/04//////09/03/25
            if ( (XJ - M荷重(1)) < w $$ rKozo = 1 $$ HIDAR = 0 ) {
                XJ = XJ + MR / Sqrt2 ////////12/12/17
            } else {
            if ( Abs((JX_max - JX_min) / 2 = 節X(節点J)) - JX_min ) {
                if ( (節X(節点J) < 柱間離れ(1)) ) {  ////////09/03/16
                    XJ = XJ - MR / Sqrt2 - w - IIf(荷重_M > 0, 200, -150) //////////07/07/04
                    //
                } else {if ( (節X(節点J) != 柱間離れ(1)) $$ (節X(節点J) != 柱間離れ(2)) $$ 柱間離れ(2) > 150 ) { ////////12/12/12
                    if ( Abs(M荷重(1) - XJ) < 300 ) {
                        XJ = XJ + 100
                    } else {
                        XJ = XJ - MR / Sqrt2 - w // - IIf(荷重_M > 0, 200, -150) //////////07/07/04
                    }
                }
            } else {
//                XJ = XJ + MR / Sqrt2 + w //+ 250 + w / 5
                if ( 段上げ量 = 0 ) {
//                XJ = XJ + MR / Sqrt2 * 0 + w //+ 250 + w / 5
                    XJ = HEN_X(節X(節点J)) + MR / Sqrt2
                } else {
                    XJ = XJ + MR / Sqrt2 + w //+ 250 + w / 5
                }
            }
            }
            if ( 段上げ量 != 0 ) { YJ = YJ + 120
        } else {
            if ( Abs((JX_max - JX_min) / 2 = 節X(節点J)) - JX_min ) {
            XJ = XJ + MR / Sqrt2 + 0 //w / 5 //////////////////////////////////////////////////06/11/17
            } else {
            XJ = XJ + MR / Sqrt2 ////////IIf(段上げ量 = 0, 0, MR / Sqrt2 + 0) //- w / 2 //+ 250 + w / 5
            }
            if ( 段上げ量 != 0 ) { YJ = YJ + 120
        }
        }
    } else { // FR橋脚 = 2
         //if ( Abs(節X(節点J) - 柱間離れ(1)) < 0.5 || 荷重_M < 0 ) {
//                if ( 荷重_M < 0 $$ Abs(節X(節点J) - 柱間離れ(2)) < 0.5 ) { //////////////08/02/01
//                    XJ = XJ + MR / Sqrt2
//                } else {
//                    XJ = XJ - MR / Sqrt2 - w - 200
//                }
        if ( 荷重_M < 0 ) { //////////////13/04/08
            XJ = XJ - MR / Sqrt2 - w - 200 ////////13/04/08
        } else {
            XJ = XJ + MR / Sqrt2
        }
        YJ = YJ - MR / Sqrt2 - MM上 * Twip + 2 * Twip //9/19
    }
//////09/03/25
//        if ( 荷重_M > 0 ) {
//            if ( rKozo = 2 ) { XJ = XJ + w / 20 //IIf(rKozo = 2, 5, 10)
//        } else {
//            if ( rKozo = 2 ) {
//                if ( Abs(節X(節点J) - 柱間離れ(2)) < 0.5 ) { //////////////08/02/01
//                    XJ = XJ + w / 10
//                } else {
//                    XJ = XJ - w / 10 //////IIf(rKozo = 2, 5, 10)//////////////08/02/01
//                }
//            }
//        }
////////////////////////08/11/039
//       if ( rKozo != 2 $$ DDAN(節点J) != 0 $$ ((節X(節点J) > JX_min $$ 節X(節点J) < JX_max) Or
    if ( DDAN(節点J) != 0 $$ ((節X(節点J) > JX_min $$ 節X(節点J) < JX_max) || _
            節点荷重段数(節点J, 2) > 0.3) ) {
        YJ = HEN_Y(節Y(節点J)) + 340 * Bairitu ////////////////////////////12/12/12 下側に表示
        if ( rKozo = 2 ) { //////////////////////////////09/03/25
            if ( Not 荷重_FX * 荷重_M < 0 ) {
//                YJ = YJ - MR / Sqrt2 - MM上 * Twip * 2
            YJ = HEN_Y(節Y(節点J)) - 120
            XJ = XJ + MM上 * Twip * 2 ////////////////////////////////////10/02/24
            }
        }
        if ( rKozo = 1 $$ 節Y(節点J) - 水平部材最下端 > 0.1 ) { ////////13/11/15
            YJ = HEN_Y(節Y(節点J)) - MR / Sqrt2 - MM上 * Twip * 2
            XJ = XJ // - MM上 * Twip ////// * 2
        }
        if ( 節点荷重段数(節点J, 3) - Int(節点荷重段数(節点J, 3) / 2) * 2 = 1 ) {
            if ( Not (Abs(節X(節点J) - 柱間離れ(1)) < 0.5 || Abs(節X(節点J) - 柱間離れ(2)) < 0.5) ) {
                YJ = YJ + 荷重文字サイズ * Twip * 0.9
            } else {
                YJ = YJ + 荷重文字サイズ * Twip * 0.4
            }
        }
    } else {
        if ( 節点荷重段数(節点J, 3) - Int(節点荷重段数(節点J, 3) / 2) * 2 = 1 ) {
            if ( Not (Abs(節X(節点J) - 柱間離れ(1)) < 0.5 || Abs(節X(節点J) - 柱間離れ(2)) < 0.5) ) {
                YJ = YJ - 荷重文字サイズ * Twip * 0.9
            } else {
                YJ = YJ - 荷重文字サイズ * Twip * 0.4
            }
        } else {if ( rKozo = 2 $$ 荷重_M < 0 ) { ////////////07/08/31
//                    YJ = YJ - 荷重文字サイズ * Twip * 0.4 ////////////////09/03/25
        }
    }
} ////////////////////////////////////// 05/02/25
if ( strUN = "" ) {
this.MOJ1("D上", XJ, YJ, 0, " M=" + F2(荷重_M) & " ")
} else {
this.MOJ1("D上", XJ, YJ, 0, IIf(rKozo = 2, " M=", " ") + F2(荷重_M) + strUN + "･m ")
}
}
//    M荷重(1) = XJ
//    M荷重(2) = YJ
if ( 荷重_FY != 0 ) { 節点荷重段数(節点J, 1) = 節点荷重段数(節点J, 1) + IIf(strUN = "", 1, 1.05) ////// nagase 07/05/13
if ( 荷重_FX != 0 ) {
    if ( 荷重_FX > 0 ) { //////09/04/14
        節点荷重段数(節点J, 2) = 節点荷重段数(節点J, 2) + 0.3 //////08/11/039
    } else {
        節点荷重段数(節点J, 4) = 節点荷重段数(節点J, 4) + 0.3 //////09/04/14
    }
}
if ( 荷重_M != 0 ) {
    M荷重(1) = XJ
    M荷重(2) = YJ
    節点荷重段数(節点J, 3) = 1
}
//
iKozo = rKozo ////////09/03/25
                                                    */
        }

        private void D_data(string D, string Wda, string[] XS, float[] X, int N, string er1, string strLL = null, int Flg = 0)
        {
            /*
            //
            var dd
            var i                       As Integer
            var T                       As Integer
            // X() は  Xs() の計算結果
            er1 = ""
            N = 1
            dd = Trim(Wda)
            For( i = 1 To 30
                XS(i) = ""
                X(i) = 0
            }
            Do
                T = InStr(dd, D)
                if ( T = 0 ) {
                    Exit Do
                }
                XS(N) = Mid(dd, 1, T - 1)
                dd = Trim(Mid(dd, T + 1))
                if ( N = 5 ) {
                strLL = XS(N) //////////////// 05/02/27
                }
                N = N + 1
            Loop
            XS(N) = dd
            For( i = 1 To N
                if ( Flg = 0 $$ (i = 2 || i = 3) $$ val(XS(i)) > 900 ) {
                    X(i) = 0
                } else {
                    X(i) = val(XS(i))
                }
            }
            //
            }

            private Function F0(XX)
            //
            F0 = Format(XX, "0")
            //
            }

            private Function F1(XX)
            //
            F1 = Format(XX, "0.0")
            //
            }

            private Function F2(XX)
            //
            var FFF
            var N
            //
            FFF = Format(XX, "0.000")
            if ( Right(FFF, 1) = "0" ) {
                N = Len(FFF)
                FFF = Mid(FFF, 1, N - 1)
            }
            F2 = FFF
            //
            }

            private Function F3(XX)
            //
            F3 = Format(XX, "0.000")
            //
            */
        }

        private void MOJ_0(double X1, double y1, double T, double MOJ)
        {
            /*
// T  角度 ﾄﾞ
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
//
var sPos As Integer //////////08/06/21
var strA1 As String, strA2 As String
double var MydrcX As Double, MydrcY
var T2 As Single
//
frmPrint.vsPrt1.TextAngle = 10 * T
MyCurrentX = X1
MyCurrentY = y1
//
sPos = InStr(MOJ, "k") //////////08/06/21
if ( sPos = 0 ) {
    PrintoutPrt frmPrint.vsPrt1, MOJ
} else {
    strA1 = Mid(MOJ, 1, sPos - 1)
    strA2 = " " & Mid(MOJ, sPos, Len(MOJ))
    if ( Abs(T) < 0.9 || Abs(T - 90) < 0.9 || Abs(T - 180) < 0.9 ) { //////////13/04/12//////if ( T = 0 || T = 90 || T = 180 ) {
        PrintoutPrt frmPrint.vsPrt1, strA1
        if ( T = 90 ) {
            MyCurrentX = Int(X1) + frmPrint.vsPrt1.FontSize * 3
            MyCurrentY = Int(y1) + frmPrint.vsPrt1.FontSize * 2 - Len(strA1) * frmPrint.vsPrt1.FontSize * 10
        } else {if ( T = 0 || T = 180 ) {
            MyCurrentX = MyCurrentX - frmPrint.vsPrt1.FontSize * 3
            MyCurrentY = MyCurrentY + frmPrint.vsPrt1.FontSize * 3
        }
        frmPrint.vsPrt1.FontSize = frmPrint.vsPrt1.FontSize - 2.5
        PrintoutPrt frmPrint.vsPrt1, strA2
    } else {
        T2 = π * (T + 90) / 180 //////////???まだ
//            MyCurrentX = MyCurrentX - frmPrint.vsPrt1.FontSize * 3 * Cos(T2)
//            MyCurrentY = MyCurrentY + frmPrint.vsPrt1.FontSize * 3 * Sin(T2)
//            frmPrint.vsPrt1.FontSize = frmPrint.vsPrt1.FontSize - 2.5
        PrintoutPrt frmPrint.vsPrt1, strA1 & strA2
    }
}
if ( CreateDxfFlag = 1 ) {
    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
    ParamXPoint = X1
    ParamYpoint = y1
    ParamText = MOJ
    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
}
//
*/
        }

        private void MOJ_A(double X1, double y1, double T, double MOJ)
        { // T  角度 ﾄﾞ
            /*
            //
            var ParamAngle              As Single
            var ParamFontSize           As Single
            var ParamXPoint             As Single
            var ParamYpoint             As Single
            var ParamText
            //
            var sPos As Integer //////////08/05/22
            var strA1 As String, strA2 As String //////////08/05/22
            double var MydrcX As Double, MydrcY //////////08/05/22
            var T2 As Single //////////08/05/22
            //
            frmPrint.vsPrt1.TextAngle = 10 * T
            MyCurrentX = Int(X1)
            MyCurrentY = Int(y1)

            sPos = InStr(MOJ, "k") //////////08/05/22
            if ( sPos = 0 ) {
            sPos = InStr(MOJ, "t")
            }
            if ( sPos = 0 ) {
                PrintoutPrt frmPrint.vsPrt1, MOJ
            } else {
                strA1 = Mid(MOJ, 1, sPos - 1) ////////////////////////////08/05/22
                strA2 = " " & Mid(MOJ, sPos, Len(MOJ))
                if ( Abs(T) < 0.9 || Abs(T - 90) < 0.9 || Abs(T - 180) < 0.9 ) { //////////13/04/12//////if ( T = 0 || T = 90 || T = 180 ) {
                    PrintoutPrt frmPrint.vsPrt1, strA1
                    if ( T = 90 ) {
                        MyCurrentX = Int(X1) + frmPrint.vsPrt1.FontSize * 3
                        //
                        if ( InStr(strA1, "～") != 0 ) { //////12/02/15
                            MyCurrentY = MyCurrentY - (Len(strA1) + 1) * frmPrint.vsPrt1.FontSize * 10 + 30 //////12/02/15
                        } else {
                            MyCurrentY = MyCurrentY - Len(strA1) * frmPrint.vsPrt1.FontSize * 10 + 30 //////12/02/15
                        }
                        frmPrint.vsPrt1.FontSize = frmPrint.vsPrt1.FontSize - 2.8
                        PrintoutPrt frmPrint.vsPrt1, strA2
                    } else {if ( T = 0 || T = 180 ) {
                        MyCurrentX = MyCurrentX - frmPrint.vsPrt1.FontSize * 3
                        MyCurrentY = MyCurrentY + frmPrint.vsPrt1.FontSize * 3
                        frmPrint.vsPrt1.FontSize = frmPrint.vsPrt1.FontSize - 3
                        PrintoutPrt frmPrint.vsPrt1, strA2
                    }
                } else {
                    T2 = π * (T + 90) / 180 //////////???まだ
            //            MyCurrentX = MyCurrentX - frmPrint.vsPrt1.FontSize * 3 * Cos(T2)
            //            MyCurrentY = MyCurrentY + frmPrint.vsPrt1.FontSize * 3 * Sin(T2)
            //            frmPrint.vsPrt1.FontSize = frmPrint.vsPrt1.FontSize - 2.5
                    PrintoutPrt frmPrint.vsPrt1, strA1 & strA2
                }
            }
            if ( CreateDxfFlag = 1 ) {
                ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                ParamXPoint = X1
                ParamYpoint = y1
                ParamText = MOJ
                this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
            }
            //
            */
        }

        private void MOJ1(double Pos, double X1, double y1, double T, double MOJ)
        {
            /*
//
var pos1
var POS2
var CT
var h
var T2
var sN
var CS
var DX
var DY
var dumサイズ
//
dumサイズ = frmPrint.vsPrt1.FontSize
frmPrint.vsPrt1.FontSize = 荷重文字サイズ
// T  角度 ﾄﾞ  角度は座標形 1
// (X1,Y1) 基点 文字左端
pos1 = Mid(Pos, 1, 1)
POS2 = Mid(Pos, 2, 1)
CT = T
Select Case pos1
Case "D"
    h = frmPrint.vsPrt1.TextHeight(MOJ)
Case "U"
    h = -50
Case } else {
    h = 0
End Select
Select Case POS2
Case "上"
    Select Case CT
    Case Is > 120
        CT = CT - 180
    Case } else {
    End Select
Case } else {
End Select
T2 = π * (CT + 90) / 180
sN = Sin(T2)
CS = Cos(T2)
DX = h * CS
DY = h * sN
this.MOJ_A(X1 + DX, y1 - DY, CT, MOJ)
frmPrint.vsPrt1.FontSize = dumサイズ
//
            */
        }

        private void MOJ2L(double Pos, double X1, double y1, double X2, double Y2, double MOJ)
        {
            /*
//
var pos1
var POS2
var XX1
var YY1
var XX2
var Yy2
var h
var 位置
var w
var BTAN
var 角度
var th
var SNH
var CSH
var Tw
var SNW
var CSW
var DX
var DY
double var T2
var sN
var CS
var dumサイズ
//
dumサイズ = frmPrint.vsPrt1.FontSize
frmPrint.vsPrt1.FontSize = 荷重文字サイズ
// (X1,Y1) 基点 文字左端
pos1 = Mid(Pos, 1, 1)
POS2 = Mid(Pos, 2, 1)
X1 = Round(X1, 5)
y1 = Round(y1, 5)
X2 = Round(X2, 5)
Y2 = Round(Y2, 5)
XX1 = X1
YY1 = y1
XX2 = X2
Yy2 = Y2
Select Case pos1
Case "D"
    h = frmPrint.vsPrt1.TextHeight(MOJ)
Case "U"
    h = IIf(水平垂直 = 1, 0, -30) //////////// 05/05/16
Case } else {
    h = 0
End Select
位置 = ""
Select Case POS2
Case "上"
    Select Case X2 - X1
        Case Is > 0
        Case 0
            if ( Y2 > y1 ) {
                XX1 = X2
                YY1 = Y2
                XX2 = X1
                Yy2 = y1
                位置 = "R"
            }
        Case } else {
            XX1 = X2
            YY1 = Y2
            XX2 = X1
            Yy2 = y1
            位置 = "R"
    End Select
Case } else {
End Select
if ( 位置 = "R" ) {
    Select Case pos1
        Case "D"
            h = 0 //-30
        Case "U"
            h = frmPrint.vsPrt1.TextHeight(MOJ)
        Case } else {
            h = 0
    End Select
}
w = frmPrint.vsPrt1.TextWidth(MOJ)
BTAN = 0
if ( XX1 != XX2 ) {
    BTAN = (YY1 - Yy2) / (XX2 - XX1)  // 角度は座標形 1
}
角度 = 180 * Atn(BTAN) / π
if ( XX1 > XX2 ) {
    角度 = 角度 + 180
}
if ( XX1 = XX2 ) {
    角度 = 90
    if ( Yy2 > YY1 ) {
        角度 = 270
    }
}
Select Case 位置
Case "R"
    th = π * (角度 + 90) / 180
    SNH = Sin(th)
    CSH = Cos(th)
    Tw = π * 角度 / 180
    SNW = Sin(Tw)
    CSW = Cos(Tw)
    DX = h * CSH - w * CSW
    DY = h * SNH - w * SNW
    this.MOJ_A(X1 + DX, y1 - DY, 角度, MOJ)
Case } else {
    T2 = π * (角度 + 90) / 180
    sN = Sin(T2)
    CS = Cos(T2)
    DX = h * CS
    DY = h * sN
    this.MOJ_A(XX1 + DX, YY1 - DY, 角度, MOJ)
End Select
frmPrint.vsPrt1.FontSize = dumサイズ
//
*/
        }

        private void MOJ2C(double Pos, double X1, double y1, double X2, double Y2, double MOJ,
            int G5 = 0, int Flg = 0, float もじさいづ = 1)
        {
            /*
//
var pos1
var POS2
var POS3
var XX1
var YY1
var XX2
var Yy2
var h
var W2
var BTAN
var 角度
var th
var SNH
var CSH
var Tw
var SNW
var CSW
var DX
var DY
var X3
var Y3
var dumサイズ
//
dumサイズ = frmPrint.vsPrt1.FontSize * もじさいづ
frmPrint.vsPrt1.FontSize = 荷重文字サイズ * もじさいづ
// (X3,Y3) 基点 文字中央
pos1 = Mid(Pos, 1, 1)
POS2 = Mid(Pos, 2, 1)
POS3 = Mid(Pos, 3, 1)
X1 = Round(X1, 6)
y1 = Round(y1, 6)
X2 = Round(X2, 6)
Y2 = Round(Y2, 6)
XX1 = X1
YY1 = y1
XX2 = X2
Yy2 = Y2
Select Case pos1
Case "D"
    h = frmPrint.vsPrt1.TextHeight(MOJ)
Case "C"
    h = frmPrint.vsPrt1.TextHeight(MOJ) / 2
Case "U"
    h = -30
Case } else {
    h = 0
End Select
Select Case POS2
Case "上"
    Select Case X2 - X1
    Case Is > 0
    Case 0
        if ( Y2 > y1 ) {
            XX1 = X2
            YY1 = Y2
            XX2 = X1
            Yy2 = y1
        }
    Case } else {
        XX1 = X2
        YY1 = Y2
        XX2 = X1
        Yy2 = y1
    End Select
Case } else {
End Select
Select Case POS3
Case "*"
    Select Case pos1
    Case "D"
        Select Case X2 - X1
        Case Is > 0
        Case 0
            if ( Y2 > y1 ) {
                h = -30
            }
        Case } else {
            h = -30
        End Select
    Case "U"
        Select Case X2 - X1
        Case Is > 0
        Case 0
            if ( Y2 > y1 ) {
                h = frmPrint.vsPrt1.TextHeight(MOJ)
            }
        Case } else {
            h = frmPrint.vsPrt1.TextHeight(MOJ)
        End Select
    End Select
Case } else {
End Select
if ( G5 = 6 ) {
    h = h + 15
}
W2 = frmPrint.vsPrt1.TextWidth(MOJ) / 2
BTAN = 0
if ( XX1 != XX2 ) {
    BTAN = (YY1 - Yy2) / (XX2 - XX1)  // 角度は座標形 1
}
角度 = 180 * Atn(BTAN) / π
if ( XX1 > XX2 ) {
    角度 = 角度 + 180
}
if ( XX1 = XX2 ) {
    角度 = 90
    if ( Yy2 > YY1 ) {
        角度 = 270
    }
}
//    角度 = Abs(角度)
th = π * (角度 + 90) / 180
SNH = Round(Sin(th), 6)
CSH = Round(Cos(th), 6)
Tw = π * 角度 / 180
SNW = Sin(Tw)
CSW = Cos(Tw)
if ( Flg = 0 ) { //if ( CSH >= 0 ) {
DX = (h * CSH - W2 * CSW)
} else {
DX = (-h * CSH * 6 - W2 * CSW) //////////////////////// 04/11/11 nagase
}
DY = h * SNH - W2 * SNW
X3 = (XX1 + XX2) / 2
Y3 = (YY1 + Yy2) / 2
//-------------------------------------------------------------- mark 5 8/27
if ( G5 = 5 ) {
    if ( XX1 >= XX2 ) {
         X3 = X3 - 荷重文字サイズ * Twip / 2.2
    } else {
         X3 = X3 + 荷重文字サイズ * Twip / 2.2
    }
}
//-------------------------------------------------------------- mark 5 8/27
this.MOJ_A(X3 + DX, Y3 - DY, 角度, MOJ)
frmPrint.vsPrt1.FontSize = dumサイズ    //
            */
        }

        private void MOJ2D(double Pos, double X1, double y1, double X2, double Y2, double MOJ)
        {
            /*
            var pos1
            var POS2
            var POS3
            var XX1
            var YY1
            var XX2
            var Yy2
            var h
            var W2
            var BTAN
            var 角度
            var th
            var SNH
            var CSH
            var Tw
            var SNW
            var CSW
            var DX
            var DY
            var X3
            var Y3
            // (X3,Y3) 基点 文字中央
            pos1 = Mid(Pos, 1, 1)
            POS2 = Mid(Pos, 2, 1)
            POS3 = Mid(Pos, 3, 1)
            X1 = Round(X1, 6)
            y1 = Round(y1, 6)
            X2 = Round(X2, 6)
            Y2 = Round(Y2, 6)
            XX1 = X1
            YY1 = y1
            XX2 = X2
            Yy2 = Y2
            Select Case pos1
            Case "D"
                h = frmPrint.vsPrt1.TextHeight(MOJ)
            Case "C"
                h = frmPrint.vsPrt1.TextHeight(MOJ) / 2
            Case "U"
                h = -30
            Case } else {
                h = 0
            End Select
            Select Case POS2
            Case "上"
                Select Case X2 - X1
                Case Is > 0
                Case 0
                    if ( Y2 > y1 ) {
                        XX1 = X2
                        YY1 = Y2
                        XX2 = X1
                        Yy2 = y1
                    }
                Case } else {
                    XX1 = X2
                    YY1 = Y2
                    XX2 = X1
                    Yy2 = y1
                End Select
            Case } else {
            End Select

            Select Case POS3
            Case "*"
                Select Case pos1
                Case "D"
                    Select Case X2 - X1
                    Case Is > 0
                    Case 0
                        if ( Y2 > y1 ) {
                            h = -30
                        }
                    Case } else {
                        h = -30
                    End Select
                Case "U"
                    Select Case X2 - X1
                    Case Is > 0
                    Case 0
                        if ( Y2 > y1 ) {
                            h = frmPrint.vsPrt1.TextHeight(MOJ)
                        }
                    Case } else {
                        h = frmPrint.vsPrt1.TextHeight(MOJ)
                    End Select
                End Select
            Case } else {
            End Select
            W2 = frmPrint.vsPrt1.TextWidth(MOJ) / 2
            BTAN = 0
            if ( XX1 != XX2 ) {
                BTAN = (YY1 - Yy2) / (XX2 - XX1)  // 角度は座標形 1
            }
            角度 = 180 * Atn(BTAN) / π
            if ( XX1 > XX2 ) {
                角度 = 角度 + 180
            }
            if ( XX1 = XX2 ) {
                角度 = 90
                if ( Yy2 > YY1 ) {
                    角度 = 270
                }
            }
            th = π * (角度 + 90) / 180
            SNH = Sin(th)
            CSH = Cos(th)
            Tw = π * 角度 / 180
            SNW = Sin(Tw)
            CSW = Cos(Tw)
            DX = h * CSH - W2 * CSW
            DY = h * SNH - W2 * SNW
            X3 = (XX1 + XX2) / 2
            Y3 = (YY1 + Yy2) / 2
            this.MOJ_0(X3 + DX, Y3 - DY, 角度, MOJ)
            //
            */
        }

        private void MOJ2R(double Pos, double X1, double y1, double X2, double Y2, double MOJ)
        {
            /*
            //
            var pos1
            var POS2
            var XX1
            var YY1
            var XX2
            var Yy2
            var h
            var 位置
            var w
            var BTAN
            var 角度
            var th
            var SNH
            var CSH
            var Tw
            var SNW
            var CSW
            var DX
            var DY
            var dumサイズ
            //
            dumサイズ = frmPrint.vsPrt1.FontSize
            frmPrint.vsPrt1.FontSize = 荷重文字サイズ
            // (X2,Y2) 基点が 文字右端
            pos1 = Mid(Pos, 1, 1)
            POS2 = Mid(Pos, 2, 1)
            X1 = Round(X1, 6)
            y1 = Round(y1, 6)
            X2 = Round(X2, 6)
            Y2 = Round(Y2, 6)
            XX1 = X1
            YY1 = y1
            XX2 = X2
            Yy2 = Y2
            Select Case pos1
            Case "D"
                h = frmPrint.vsPrt1.TextHeight(MOJ)
            Case "U"
                h = -30
            Case } else {
                h = 0
            End Select
            位置 = ""
            Select Case POS2
            Case "上"
                Select Case X2 - X1
                Case Is > 0
                Case 0
                    if ( Y2 > y1 ) {
                        XX1 = X2
                        YY1 = Y2
                        XX2 = X1
                        Yy2 = y1
                        位置 = "R"
                    }
                Case } else {
                    XX1 = X2
                    YY1 = Y2
                    XX2 = X1
                    Yy2 = y1
                    位置 = "R"
                End Select
            Case } else {
            End Select
            w = frmPrint.vsPrt1.TextWidth(MOJ)
            if ( 位置 = "R" ) {
                w = 0
            }
            BTAN = 0
            if ( XX1 != XX2 ) {
                BTAN = (YY1 - Yy2) / (XX2 - XX1)  // 角度は座標形 1
            }
            角度 = 180 * Atn(BTAN) / π
            if ( XX1 > XX2 ) {
                角度 = 角度 + 180
            }
            if ( XX1 = XX2 ) {
                角度 = 90
                if ( Yy2 > YY1 ) {
                    角度 = 270
                }
            }
            th = π * (角度 + 90) / 180
            SNH = Sin(th)
            CSH = Cos(th)
            Tw = π * 角度 / 180
            SNW = Sin(Tw)
            CSW = Cos(Tw)
            DX = h * CSH - w * CSW
            DY = h * SNH - w * SNW
            Select Case 位置
            Case "R"
                this.MOJ_0(XX1 + DX, YY1 - DY, 角度, MOJ)
            Case } else {
                this.MOJ_0(XX2 + DX, Yy2 - DY, 角度, MOJ)
            End Select
            frmPrint.vsPrt1.FontSize = dumサイズ
            //
            */
        }

        private void MOJ軸C(double Pos, double X1, double y1, double X2, double Y2, double MOJ)
        {
            /*
//
var pos1
var POS2
var POS3
var XX1
var YY1
var XX2
var Yy2
var h
var W2
var BTAN
var 角度
var th
var SNH
var CSH
var Tw
var SNW
var CSW
var DX
var DY
var X3
var Y3
// (X3,Y3) 基点 文字中央
pos1 = Mid(Pos, 1, 1)
POS2 = Mid(Pos, 2, 1)
POS3 = Mid(Pos, 3, 1)
X1 = Round(X1, 3)
y1 = Round(y1, 3)
X2 = Round(X2, 3)
Y2 = Round(Y2, 3)
XX1 = X1
YY1 = y1
XX2 = X2
Yy2 = Y2
if ( g連続Mod $$ iKozo = 3 ) { ////////////04/10/18
    W2 = frmPrint.vsPrt1.TextWidth("1")
    h = 50 + W2
} else {
    h = -30
}
//
Select Case POS2
Case "上"
    Select Case X2 - X1
        Case Is > 0
        Case 0
          h = 65
          XX1 = X2 - h
          YY1 = Y2
          XX2 = X1 - h
          Yy2 = y1
    End Select
Case } else {
End Select

W2 = frmPrint.vsPrt1.TextWidth(MOJ) / 2
BTAN = 0
if ( XX1 != XX2 ) {
    BTAN = (YY1 - Yy2) / (XX2 - XX1)  // 角度は座標形 1
}
角度 = 180 * Atn(BTAN) / π
if ( XX1 > XX2 ) {
    角度 = 角度 + 180
}
if ( XX1 = XX2 ) {
    角度 = 90
    if ( Yy2 > YY1 ) {
//            角度 = 270
    }
}
th = π * (角度 + 90) / 180
SNH = Sin(th)
CSH = Cos(th)
Tw = π * 角度 / 180
SNW = Sin(Tw)
CSW = Cos(Tw)
DX = h * CSH - W2 * CSW
DY = h * SNH - W2 * SNW
X3 = (XX1 + XX2) / 2
Y3 = (YY1 + Yy2) / 2
this.MOJ_0(X3 + DX, Y3 - DY, 角度, MOJ)
//
            */
        }

        private void 荷重矢印L(double l, double X2, double Y2, double X1, double y1)
        {
            /*
//
var LL
var RR
var SN1
var CS1
var CS3
var SN3
var XX1
var YY1
// 座標は vsPrt1 の座標で入力
// X1,Y1 点に矢印
// Yの向きは逆で 下が +  なので     CS=-CS
LL = Round(Sqr((X2 - X1) ^ 2 + (Y2 - y1) ^ 2), 3)
if ( LL = 0 ) {
    return;
}
RR = 2.5 * Twip
SN1 = 0.173648785568287
CS1 = -0.984807645822604 // 170度
CS3 = -(X2 - X1) / LL
SN3 = (Y2 - y1) / LL
XX1 = RR * (CS1 * CS3 + SN1 * SN3)  // cos(a+b)
YY1 = RR * (SN1 * CS3 * l + CS1 * SN3) // sin(a+b)
DrawLinePrt frmPrint.vsPrt1, X1 + XX1, y1 - YY1, X1, y1
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(X1 + XX1), CSng(y1 - YY1), CSng(X1), CSng(y1))
}
XX1 = RR * (CS1 * CS3 - SN1 * SN3)  // cos(a+b)
YY1 = RR * (SN1 * CS3 * l + CS1 * SN3) // sin(a+b)
DrawLinePrt frmPrint.vsPrt1, X1 + XX1, y1 - YY1, X1, y1
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(X1 + XX1), CSng(y1 - YY1), CSng(X1), CSng(y1))
}
//
            */
        }

        private void 荷重矢印(double X2, double Y2, double X1, double y1)
        {
            /*
//
var LL
var RR
var SN1
var CS1
var CS3
var SN3
var XX1
var YY1
// 座標は vsPrt1 の座標で入力
// X1,Y1 点に矢印
// Yの向きは逆で 下が +  なので     CS=-CS
LL = Round(Sqr((X2 - X1) ^ 2 + (Y2 - y1) ^ 2), 3)
if ( LL <= 部材荷重矢長さmin * Twip ) {
    return;
}
RR = 1.2 * Twip  //1.2mmm
SN1 = 0.25881158
CS1 = -0.96590384  // 165度
CS3 = -(X2 - X1) / LL
SN3 = (Y2 - y1) / LL
XX1 = RR * (CS1 * CS3 - SN1 * SN3)  // cos(a+b)
YY1 = RR * (SN1 * CS3 + CS1 * SN3)  // sin(a+b)
DrawLinePrt frmPrint.vsPrt1, X1 + XX1, y1 - YY1, X1, y1
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(X1 + XX1), CSng(y1 - YY1), CSng(X1), CSng(y1))
}
SN1 = -0.25881158
CS1 = -0.96590384  // 195度
CS3 = -(X2 - X1) / LL
SN3 = (Y2 - y1) / LL
XX1 = RR * (CS1 * CS3 - SN1 * SN3)  // cos(a+b)
YY1 = RR * (SN1 * CS3 + CS1 * SN3)  // sin(a+b)
DrawLinePrt frmPrint.vsPrt1, X1 + XX1, y1 - YY1, X1, y1
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(X1 + XX1), CSng(y1 - YY1), CSng(X1), CSng(y1))
}
//
            */
        }

        private void 寸法矢印(double X2, double Y2, double X1, double y1)
        {
            /*
//
var LL
var RR
var SN1
var CS1
var CS3
var SN3
var XX1
var YY1
// 座標は vsPrt1 の座標で入力
// X1,Y1 点に矢印
// Yの向きは逆で 下が +  なので     CS=-CS
LL = Round(Sqr((X2 - X1) ^ 2 + (Y2 - y1) ^ 2), 3)
if ( LL = 0 ) {
    return;
}
RR = 1.2 * Twip  //1.2mmm
SN1 = 0.25881158
CS1 = -0.96590384  // 165度
CS3 = -(X2 - X1) / LL
SN3 = (Y2 - y1) / LL
XX1 = RR * (CS1 * CS3 - SN1 * SN3)  // cos(a+b)
YY1 = RR * (SN1 * CS3 + CS1 * SN3)  // sin(a+b)
DrawLinePrt frmPrint.vsPrt1, X1 + XX1, y1 - YY1, X1, y1
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(X1 + XX1), CSng(y1 - YY1), CSng(X1), CSng(y1))
}
SN1 = -0.25881158
CS1 = -0.96590384  // 195度
CS3 = -(X2 - X1) / LL
SN3 = (Y2 - y1) / LL
XX1 = RR * (CS1 * CS3 - SN1 * SN3)  // cos(a+b)
YY1 = RR * (SN1 * CS3 + CS1 * SN3)  // sin(a+b)
DrawLinePrt frmPrint.vsPrt1, X1 + XX1, y1 - YY1, X1, y1
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(X1 + XX1), CSng(y1 - YY1), CSng(X1), CSng(y1))
}
//
            */
        }

        /* private void 荷重寸法P(寸法線位置, 寸法補助線, 荷重_P2, BSPAN, 荷重_L1, 荷重_L2, PX0, PY0, PX1, PY1, PX2, PY2, PXE, PYE)
//
}
        */

        /* private void 荷重寸法W(寸法線位置, 寸法補助線, BSPAN, 荷重_L1, 荷重_L2, PX0, PY0, PX1, PY1, PX2, PY2, PXE, PYE)
//
}
*/

        private void SunPou2(int MARK, int N, double L1, double L2, object[] 寸法, double[] X, double[] Y, double FD,
            bool gFlg5 = false, float g文字位置 = 0,
            bool g文字2段 = false, int g段FLG = 0, int 荷重図開き = 1)
        { ////////09/10/20
            /*
//////08/11/067
var d1
var d2
var LX
var LY
var LL
var SN1
var CS1
var JA                      As Integer
var CC
var sN
var CS
var AA
var dd
var BB
var X2
var Y2
var i                       As Integer
var ii                      As Integer
var j                       As Integer
var XX()                    As Single
var YY()                    As Single
var Xmax                    As Single
var Xmin                    As Single
var w                       As Single
var W2                      As Single
var Y01                     As Single
var Y02                     As Single
var DAN                     As Integer
var SFT()                   As Single
var WDT()                   As Single
var SPN()                   As Single
var sMd()                   As Single
var sp                      As Single
var NN                      As Integer
var WW                      As Single
var GapL                    As Single
var GapR                    As Single
var STP                     As Integer
var st                      As Integer
var ed                      As Integer
var SF                      As Integer
var Gap                     As Single
var SF0                     As Integer
var Gap0                    As Single
var AFX                     As Variant
var AFY                     As Variant
var ZFX                     As Variant
var ZFY                     As Variant
var EnPRM1                  As Single
var EnPRM2                  As Single
var EnPRM3                  As Single
var EnPRM4                  As Single
var EnPRM5                  As Single
var EnTYPE1                 As Single
// n   寸法値数+1
// L1  下,右が(+) 単位 mm
// l2  補助線長さ  単位 mm
// Y=C*X+D   Y=A*X+B
g文字2段 = False ////////////////////////////09/10/20
if ( FD = 99 ) {
//        FD = 1
    if ( N <= 1 ) { return;
} else {
    if ( N <= 1 ) { ////// if ( n <= 2 ) {   05/05/30
        if ( FD = 2 ) {
            分布補正 = Round(荷重寸法線位置(1) - 分布補正 - 荷重寸法Fontsize * 0.35, 2)
            For( i = SS部材 To EE部材
                部材正荷重数(i) = max(部材正荷重数(i) - 分布補正, 0)
            }
            分布補正 = 0 // 9/20
            return; // 全載荷の時出力しない
        }
        return; // 全載荷の時出力しない
    }
}
分布補正 = 0 // 9/20
this.XX(N)
this.YY(N)
this.SFT(N)
this.WDT(N)
this.SPN(N)
this.sMd(N)
sp = frmPrint.vsPrt1.TextWidth(" ")
d1 = L1 * Twip
d2 = L2 * Twip
LX = X(N) - X(1) //節X(n) - 節X(1)
LY = Y(N) - Y(1)  //節Y(n) - 節Y(1)
LL = Sqr(LX ^ 2 + LY ^ 2)
if ( LL = 0 ) { return;
SN1 = LY / LL
CS1 = LX / LL
JA = 0
CC = 9999999999999#
if ( LX = 0 ) {
    JA = 1
} else {
    CC = LY / LX
}
sN = CS1
CS = -SN1
AA = 9999999999999#
if ( LY = 0 ) {
    JA = 2
} else {
    AA = -LX / LY
}
//////
if ( 水平垂直 = 0 $$ 部材荷重Fontsize > 8.5 $$ FD != 99 $$ 荷重図開き > 0 ) { //////14/11/26
    For( i = 1 To N
        Y(i) = Y(i) - (部材荷重Fontsize - 8.5) * Twip * IIf(FD = 2 || FD = 3 || FD = 4, 0.5, 2)
    }
}
//////
Select Case JA
Case 1 // X1=XE
    if ( Y(1) < Y(N) ) {
        d2 = -d2 ////////d1 = -d1  09/10/20
    }
    For( i = 1 To N - 1
        XX(i) = X(1) + d1
        YY(i) = Y(i)
        SPN(i) = Abs(Y(i + 1) - Y(i))
    }
    XX(N) = X(N) + d1
    YY(N) = Y(N)
    g段上げ = (XX(1) + XX(N)) / 2
Case 2 // Y1=YE
    if ( X(1) > X(N) ) {
        d2 = -d2 //////10/03/07  d1 = -d1
    }
    For( i = 1 To N - 1
        XX(i) = X(i)
        YY(i) = Y(1) + d1
        SPN(i) = Abs(X(i + 1) - X(i))
    }
    XX(N) = X(N)
    YY(N) = Y(N) + d1
    g段上げ = (YY(1) + YY(N)) / 2 + Round(荷重寸法Fontsize * 56.7 / 1.5, 3) * Sgn(L1)
Case } else {
    XX(1) = X(1) + d1 * CS
    YY(1) = Y(1) + d1 * sN
    XX(N) = X(N) + d1 * CS
    YY(N) = Y(N) + d1 * sN
    dd = YY(1) - CC * XX(1)
    For( i = 2 To N - 1
        BB = Y(i) - AA * X(i)
        XX(i) = -(BB - dd) / (AA - CC)
        YY(i) = AA * XX(i) + BB
    }
    For( i = 1 To N - 1
        SPN(i) = Sqr((XX(i + 1) - XX(i)) ^ 2 + (YY(i + 1) - YY(i)) ^ 2)
    }
End Select
SPN(N) = 9999 //////////////08/02/07
With frmPrint.vsPrt1
    For( i = 1 To N - 1
        WDT(i) = .TextWidth(寸法(i))
    }
End With
NN = 0
For( i = 1 To N - 1
    w = frmPrint.vsPrt1.TextWidth(寸法(i)) + 50 //////frmPrint.vsPrt1.TextWidth(寸法(i) + "2")////////08/10/07
    if ( N = 2 || (WDT(i) + sp < SPN(i)) || (N > 2 $$ WDT(i) + sp < SPN(i) + SPN(i + 1) - w * 2.3) || _
                (N > 2 $$ WDT(i) + sp < SPN(i) + SPN(i - 1) - w * 2.3) ) {
        if ( (SPN(i) + SPN(i - 1)) > w * 2.3 ) { ////////////08/02/07* 2.3 ) { ////////////08/02/07
            SFT(i) = 1    //スペースを含めてスパンに入れば１段目確定
            sMd(i) = 1
            NN = NN + 1
        }
    }
Next
For( i = 1 To N - 1
    if ( sMd(i) = 0 ) {
        if ( WDT(i) < SPN(i) ) {
            if ( sMd(i - 1) < 2 ) {
                SFT(i) = 1    //ぎりぎり入って、前がぎりぎりでなければ１段目確定
                sMd(i) = 2
                NN = NN + 1
            }
        }
    }
Next
//////////////////////////08/07/06
For( i = 2 To N - 1
    if ( sMd(i) = 0 $$ sMd(i + 1) = 0 ) { ////////連続したら どちらかを//////08/07/06
        if ( SPN(i) >= SPN(i + 1) $$ SFT(i - 1) = 0 ) {
            SFT(i) = 1    //
            sMd(i) = 2
        } else {
//                SFT(i + 1) = 1  //
//                sMd(i + 1) = 2
        }
    }
Next
//
if ( NN = 0 ) {   //どれも入りきらなかったら
    WW = SPN(1)
    i = 1
    NN = 1
    For( i = 1 To N - 1
        ii = IIf(i Mod 2 = 1, Int(i / 2) + 1, N - Int(i / 2))
        if ( WW <= SPN(ii) ) {
            NN = ii
            WW = SPN(ii)
        }
    Next
    SFT(NN) = 1  //幅が最大で中心に近いものを１つだけ１段目に設定する。
    sMd(NN) = 4
}
i = 0
Do While i < N - 1
    i = i + 1
    if ( sMd(i) = 0 ) {
        j = i
        Do While j < N - 1 $$ sMd(j + 1) = 0
            j = j + 1
        Loop
        GapL = GapX(i, -1, N, SPN(), WDT())
        GapR = GapX(j, 1, N, SPN(), WDT())
        if ( GapL > GapR ) {
            if ( GapR < 0 ) {
                STP = -1
            } else {
                STP = 1
            }
        } else {
            if ( GapL < 0 ) {
                STP = 1
            } else {
                STP = -1
            }
        }
        if ( STP = 1 ) {
            st = i
            ed = j
        } else {
            st = j
            ed = i
        }
        For( ii = st To ed Step STP
            SF = 0
            SF0 = 0
            Gap0 = -9000000000#
            Do While SF < 3
                SF = SF + 1
                Gap = GapXX(ii, SF, N, SPN(), WDT(), SFT())
                if ( Gap - sp > 0 ) {
                    SF0 = SF
                    Exit Do
                }
                if ( Gap > Gap0 ) {
                    Gap0 = Gap
                    SF0 = SF
                }
            Loop
            SFT(ii) = SF0
            sMd(i) = 5
        Next
    }
Loop
For( i = 1 To N - 1 //////////////07/05/15
    if ( (i = 1 $$ SFT(1) != 1) || (i > 1 $$ SFT(i - 1) = 1) ) { //////Or val(寸法(i - 1)) / val(寸法(i)) > 2 ) { ////////////////07/05/14
        Select Case JA
            Case 1
                Y01 = 図Y_SCALE
            Case 2
                Y01 = 図X_SCALE
            Case } else {
                Y01 = min(図X_SCALE, 図Y_SCALE)
        End Select
        w = frmPrint.vsPrt1.TextWidth(寸法(i) + "2") + 50
        if ( sMd(i) = 1 ) { w = 0 //////////////////////////////////////////////////07/12/11
        if ( i = 1 ) {
            Y02 = (val(寸法(i)) + val(寸法(i + 1))) / Y01 //////////////07/05/15
            if ( w < Y02 ) {
                SFT(i) = 1
            }
            if ( SFT(i + 1) = 2 ) { //////09/10/20
                SFT(i) = 1
            }
        } else {
            if ( JA = 1 || (i = N - 1 $$ JA = 2 $$ gFlg5) || N > 5 ) { //////////////07/05/15
                Y02 = (val(寸法(i - 1)) + val(寸法(i))) / Y01
            } else {
                Y02 = (val(寸法(i)) / Y01)
            }
            if ( w > Y02 ) {
                if ( Not (i = N - 1 $$ w < (Y02 / 2 + _
                                (val(寸法(i)) + val(寸法(i - 1))) / Y01 / 2)) ) { ////////09/11/30
                    SFT(i) = 2
                }
            }
        }
     } else {
        if ( SFT(i - 1) = 2 ) { SFT(i) = 1 ////////08/11/067
     }
}
For( i = 1 To N - 1
    SFT(i) = SFT(i) - 1
    if ( SFT(i) = 2 ) {
        if ( val(寸法(i)) = 0 ) {
            SFT(i) = 0
        } else {
        if ( SFT(i - 1) = 1 || val(寸法(i - 1)) / val(寸法(i)) > 2 ) { ////////////////07/05/13
           SFT(i) = 0
        } else {
            SFT(i) = IIf(RR橋脚 = 1, 1, -1.3) ////////////////07/05/13
        }
        }
    } else {if ( 垂直左右 < 0 ) {  ////////////////////////////////////////////////////////////////////04/07/20
        SFT(i) = 0
    }
    if ( (N > 2 $$ i > 1 $$ SFT(i) != 0) ) { ////////10/04/18
        if ( (SPN(i) + SPN(i - 1)) > 荷重寸法Fontsize * 88 $$ _
                (SPN(i) + SPN(i + 1)) > 荷重寸法Fontsize * 88 ) {
            SFT(i) = 0
        }
    }
}

With frmPrint.vsPrt1
    For( i = 1 To N
        if ( i < N $$ 寸法(i) != "0.00" ) {
            w = .TextWidth(寸法(i) & "2")
            Select Case JA
            Case 1
                Y01 = XX(i)
                Y02 = XX(i + 1)
                Y01 = Y01 - SFT(i) * 荷重寸法Fontsize * 16
                Y02 = Y02 - SFT(i) * 荷重寸法Fontsize * 16
                DrawLinePrt frmPrint.vsPrt1, XX(i), YY(i), XX(i + 1), YY(i + 1)
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(XX(i)), CSng(YY(i)), CSng(XX(i + 1)), CSng(YY(i + 1)))
                }
                this.MOJ2D("D上", Y01, YY(i), Y02, YY(i + 1), 寸法(i))
                if ( SFT(i) > 0 ) {
                    g文字2段 = True //////09/10/20
                }
            Case 2
                Y01 = YY(i)
                Y02 = YY(i + 1)
                Y01 = Y01 - SFT(i) * 荷重寸法Fontsize * 16
                Y02 = Y02 - SFT(i) * 荷重寸法Fontsize * 16
                DrawLinePrt frmPrint.vsPrt1, XX(i), YY(i), XX(i + 1), YY(i + 1)
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(XX(i)), CSng(YY(i)), CSng(XX(i + 1)), CSng(YY(i + 1)))
                }
                this.MOJ2D("D上", XX(i), Y01, XX(i + 1), Y02, 寸法(i))
                if ( SFT(i) > 0 ) {
                    g文字2段 = True //////09/10/20
                }
            Case } else {
                DrawLinePrt frmPrint.vsPrt1, XX(i), YY(i), XX(i + 1), YY(i + 1)
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(XX(i)), CSng(YY(i)), CSng(XX(i + 1)), CSng(YY(i + 1)))
                }
                this.MOJ2D("D上", XX(i), YY(i), XX(i + 1), YY(i + 1), 寸法(i))
            End Select
            g文字位置 = max(g文字位置, Y01) ////////08/11/067
        }
        if ( d2 != 0 ) {
            X2 = XX(i) - d2 * CS
            Y2 = YY(i) - d2 * sN
            DrawLinePrt frmPrint.vsPrt1, XX(i), YY(i), X2, Y2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(XX(i)), CSng(YY(i)), CSng(X2), CSng(Y2))
            }
        }
        Select Case MARK
        Case "<", ">"
            if ( i < N ) {
                this.寸法矢印(XX(i), YY(i), XX(i + 1), YY(i + 1))
                this.寸法矢印(XX(i + 1), YY(i + 1), XX(i), YY(i))
            }
        Case } else {
            DrawCirclePrt frmPrint.vsPrt1, XX(i), YY(i), 0.2 * Twip
            if ( CreateDxfFlag = 1 ) {
                EnPRM1 = CSng(XX(i))
                EnPRM2 = CSng(YY(i))
                EnPRM3 = CSng(0.2 * Twip)
                EnPRM4 = 0
                EnPRM5 = 360
                EnTYPE1 = 7
                this.PLOTCIRCLE(EnPRM1, EnPRM2, EnPRM3, EnPRM4, EnPRM5, EnTYPE1)
            }
        End Select
//            if ( g段FLG = 1 ) {
//                g段上げ = Y2 ////////max(g段上げ, Y2) //////13/04/13
//            }
    }
End With
yyHH1 = YY(1) ////////14/11/19
yyHH2 = YY(N)
//    if ( g段FLG = 1 ) {
//        g段上げ = YY(1) //////13/10/10
//    }
//
            */
        }

        private void SunPou2G(int MARK, int N, double L1, double L2, object[] 寸法, double[] X, double[] Y, double FD)
        {
            /*
//
var d1
var d2
var LX
var LY
var LL
var SN1
var CS1
var JA                      As Integer
var CC
var sN
var CS
var AA
var dd
var BB
var X2
var Y2
var i                       As Integer
var ii                      As Integer
var j                       As Integer
var XX()                    As Single
var YY()                    As Single
var Xmax                    As Single
var Xmin                    As Single
var w                       As Single
var W2                      As Single
var Y01                     As Single
var Y02                     As Single
var DAN                     As Integer
var SFT()                   As Single
var WDT()                   As Single
var SPN()                   As Single
var sMd()                   As Single
var sp                      As Single
var NN                      As Integer
var WW                      As Single
var GapL                    As Single
var GapR                    As Single
var STP                     As Integer
var st                      As Integer
var ed                      As Integer
var SF                      As Integer
var Gap                     As Single
var SF0                     As Integer
var Gap0                    As Single
var AFX                     As Variant
var AFY                     As Variant
var ZFX                     As Variant
var ZFY                     As Variant
var EnPRM1                  As Single
var EnPRM2                  As Single
var EnPRM3                  As Single
var EnPRM4                  As Single
var EnPRM5                  As Single
var EnTYPE1                 As Single
// n   寸法値数+1
// L1  下,右が(+) 単位 mm
// l2  補助線長さ  単位 mm
// Y=C*X+D   Y=A*X+B
if ( FD = 99 ) {
    FD = 1
} else {
    if ( N <= 2 ) {
        if ( FD = 2 ) {
            分布補正 = Round(荷重寸法線位置(1) - 分布補正 - 荷重寸法Fontsize * 0.35, 2)
            For( i = SS部材 To EE部材
                部材正荷重数(i) = max(部材正荷重数(i) - 分布補正, 0)
            }
            分布補正 = 0 // 9/20
            return; // 全載荷の時出力しない
        }
        return; // 全載荷の時出力しない
    }
}
分布補正 = 0 // 9/20
this.XX(N)
this.YY(N)
this.SFT(N)
this.WDT(N)
this.SPN(N)
this.sMd(N)
sp = frmPrint.vsPrt1.TextWidth(" ")
d1 = L1 * Twip
d2 = L2 * Twip
LX = X(N) - X(1)
LY = Y(N) - Y(1)
LL = Sqr(LX ^ 2 + LY ^ 2)
if ( LL = 0 ) { return;
SN1 = LY / LL
CS1 = LX / LL
JA = 0
CC = 9999999999999#
if ( LX = 0 ) {
    JA = 1
} else {
    CC = LY / LX
}
sN = CS1
CS = -SN1
AA = 9999999999999#
if ( LY = 0 ) {
    JA = 2
} else {
    AA = -LX / LY
}
Select Case JA
Case 1 // X1=XE
    if ( Y(1) < Y(N) ) {
        d1 = -d1
    }
    For( i = 1 To N - 1
        XX(i) = X(1) + d1
        YY(i) = Y(i)
        SPN(i) = Abs(Y(i + 1) - Y(i))
    }
    XX(N) = X(N) + d1
    YY(N) = Y(N)
Case 2 // Y1=YE
    if ( X(1) > X(N) ) {
        d1 = -d1
    }
    For( i = 1 To N - 1
        XX(i) = X(i)
        YY(i) = Y(1) + d1
        SPN(i) = Abs(X(i + 1) - X(i))
    }
    XX(N) = X(N)
    YY(N) = Y(N) + d1
Case } else {
    XX(1) = X(1) + d1 * CS
    YY(1) = Y(1) + d1 * sN
    XX(N) = X(N) + d1 * CS
    YY(N) = Y(N) + d1 * sN
    dd = YY(1) - CC * XX(1)
    For( i = 2 To N - 1
        BB = Y(i) - AA * X(i)
        XX(i) = -(BB - dd) / (AA - CC)
        YY(i) = AA * XX(i) + BB
    }
    For( i = 1 To N - 1
        SPN(i) = Sqr((XX(i + 1) - XX(i)) ^ 2 + (YY(i + 1) - YY(i)) ^ 2)
    }
End Select
With frmPrint.vsPrt1
    For( i = 1 To N - 1
        WDT(i) = .TextWidth(寸法(i))
    }
End With
NN = 0
For( i = 1 To N - 1
    if ( WDT(i) + sp < SPN(i) || i = 1 ) {
        SFT(i) = 1    //スペースを含めてスパンに入れば１段目確定
        sMd(i) = 1
        NN = NN + 1
    }
Next
For( i = 1 To N - 1
    if ( sMd(i) = 0 ) {
        if ( WDT(i) < SPN(i) ) {
            if ( sMd(i - 1) < 2 ) {
                SFT(i) = 1    //ぎりぎり入って、前がぎりぎりでなければ１段目確定
                sMd(i) = 2
                NN = NN + 1
            }
        }
    }
Next
if ( NN = 0 ) {   //どれも入りきらなかったら
    WW = SPN(1)
    i = 1
    NN = 1
    For( i = 1 To N - 1
        ii = IIf(i Mod 2 = 1, Int(i / 2) + 1, N - Int(i / 2))
        if ( WW <= SPN(ii) ) {
            NN = ii
            WW = SPN(ii)
        }
    Next
    SFT(NN) = 1  //幅が最大で中心に近いものを１つだけ１段目に設定する。
    sMd(NN) = 4
}
i = 0
Do While i < N - 1
    i = i + 1
    if ( sMd(i) = 0 ) {
        j = i
        Do While j < N - 1 $$ sMd(j + 1) = 0
            j = j + 1
        Loop
        GapL = GapX(i, -1, N, SPN(), WDT())
        GapR = GapX(j, 1, N, SPN(), WDT())
        if ( GapL > GapR ) {
            if ( GapR < 0 ) {
                STP = -1
            } else {
                STP = 1
            }
        } else {
            if ( GapL < 0 ) {
                STP = 1
            } else {
                STP = -1
            }
        }
        if ( STP = 1 ) {
            st = i
            ed = j
        } else {
            st = j
            ed = i
        }
        For( ii = st To ed Step STP
            SF = 0
            SF0 = 0
            Gap0 = -9000000000#
            Do While SF < 3
                SF = SF + 1
                Gap = GapXX(ii, SF, N, SPN(), WDT(), SFT())
                if ( Gap - sp > 0 ) {
                    SF0 = SF
                    Exit Do
                }
                if ( Gap > Gap0 ) {
                    Gap0 = Gap
                    SF0 = SF
                }
            Loop
            SFT(ii) = SF0
            sMd(i) = 5
        Next
    }
Loop
For( i = 1 To N - 1
    SFT(i) = SFT(i) - 1
    if ( SFT(i) = 2 ) {
//            SFT(I) = IIf(RR橋脚 = 1, 1, -1.3) ////////////////07/05/13
        if ( val(寸法(i)) = 0 ) {
            SFT(i) = 0
        } else {
        if ( SFT(i - 1) = 1 || val(寸法(i - 1)) / val(寸法(i)) > 2 ) { ////////////////07/05/13
           SFT(i) = 0
        } else {
            SFT(i) = IIf(RR橋脚 = 1, 1, -1.3) ////////////////07/05/13
        }
        }
    }
    if ( (N > 2 $$ i > 1 $$ SFT(i) != 0) ) { ////////10/04/18
        if ( (SPN(i) + SPN(i - 1)) > 荷重寸法Fontsize * 88 $$ _
                (SPN(i) + SPN(i + 1)) > 荷重寸法Fontsize * 88 ) {
            SFT(i) = 0
        }
    }
}
With frmPrint.vsPrt1
d2 = d2 + 7 * Twip ////////////////////剛域部材寸法の引き出し位置  06/08/21
    For( i = 1 To N
        if ( GFLAG(i) = 1 ) {
            if ( i < N $$ (寸法(i) != "0.00" $$ 寸法(i) != "") ) {
                w = .TextWidth(寸法(i) & "2")
                Select Case JA
                Case 1
                    Y01 = XX(i)
                    Y02 = XX(i + 1)
                    Y01 = Y01 - SFT(i) * 荷重寸法Fontsize * 16
                    Y02 = Y02 - SFT(i) * 荷重寸法Fontsize * 16
                    DrawLinePrt frmPrint.vsPrt1, XX(i), YY(i), XX(i + 1), YY(i + 1)
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(XX(i)), CSng(YY(i)), CSng(XX(i + 1)), CSng(YY(i + 1)))
                    }
                    this.MOJ2D("D上", Y01, YY(i), Y02, YY(i + 1), 寸法(i))
                Case 2
                    Y01 = YY(i)
                    Y02 = YY(i + 1)
                    Y01 = Y01 - SFT(i) * 荷重寸法Fontsize * 16
                    Y02 = Y02 - SFT(i) * 荷重寸法Fontsize * 16
                    DrawLinePrt frmPrint.vsPrt1, XX(i), YY(i), XX(i + 1), YY(i + 1)
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(XX(i)), CSng(YY(i)), CSng(XX(i + 1)), CSng(YY(i + 1)))
                    }
                    this.MOJ2D("D上", XX(i), Y01, XX(i + 1), Y02, 寸法(i))
                Case } else {
                    DrawLinePrt frmPrint.vsPrt1, XX(i), YY(i), XX(i + 1), YY(i + 1)
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(XX(i)), CSng(YY(i)), CSng(XX(i + 1)), CSng(YY(i + 1)))
                    }
                    this.MOJ2D("D上", XX(i), YY(i), XX(i + 1), YY(i + 1), 寸法(i))
                End Select
            }
            if ( d2 != 0 $$ i < N ) {
                X2 = XX(i) - d2 * CS
                Y2 = YY(i) - d2 * sN
                DrawLinePrt frmPrint.vsPrt1, XX(i), YY(i), X2, Y2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(XX(i)), CSng(YY(i)), CSng(X2), CSng(Y2))
                }
            } else {
                if ( d2 != 0 $$ i = N $$ GFLAG(i - 1) = 1 ) {
                    X2 = XX(i) - d2 * CS
                    Y2 = YY(i) - d2 * sN
                    DrawLinePrt frmPrint.vsPrt1, XX(i), YY(i), X2, Y2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(XX(i)), CSng(YY(i)), CSng(X2), CSng(Y2))
                    }
                }
            }
            Select Case MARK
            Case "<", ">"
                if ( i < N ) {
                    this.寸法矢印(XX(i), YY(i), XX(i + 1), YY(i + 1))
                    this.寸法矢印(XX(i + 1), YY(i + 1), XX(i), YY(i))
                }
            Case } else {
                DrawCirclePrt frmPrint.vsPrt1, XX(i), YY(i), 0.2 * Twip
                if ( CreateDxfFlag = 1 ) {
                    EnPRM1 = CSng(XX(i))
                    EnPRM2 = CSng(YY(i))
                    EnPRM3 = CSng(0.2 * Twip)
                    EnPRM4 = 0
                    EnPRM5 = 360
                    EnTYPE1 = 7
                    this.PLOTCIRCLE(EnPRM1, EnPRM2, EnPRM3, EnPRM4, EnPRM5, EnTYPE1)
                }
            End Select
        } else {
            if ( i > 1 ) {
                if ( GFLAG(i - 1) = 1 $$ i < N ) {
                    if ( d2 != 0 ) {
                        X2 = XX(i) - d2 * CS
                        Y2 = YY(i) - d2 * sN
                        DrawLinePrt frmPrint.vsPrt1, XX(i), YY(i), X2, Y2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(XX(i)), CSng(YY(i)), CSng(X2), CSng(Y2))
                        }
                    }
                }
            }
        }
    }
End With
//
            */
        }

        private float GapXX(int Pos, int SF, int N, float[] SPN, float[] WDT, float[] SFT)
        {
            return 0;
            /*
//
var i                       As Integer
var GapL                    As Single
var GapR                    As Single
//
i = Pos - 1
Do Until i = 0 || SF = SFT(i)
    i = i - 1
Loop
GapL = GapX(Pos, i - Pos, N, SPN(), WDT())
i = Pos + 1
Do Until i = N || SF = SFT(i)
    i = i + 1
Loop
GapR = GapX(Pos, i - Pos, N, SPN(), WDT())
GapXX = min(GapL, GapR)
//
            */
        }

        private float GapX(int Pos, int ofs, int N, float[] SPN, float WDT)
        {
            return 0;
            /*
//
var i                       As Integer
var w                       As Single
//
if ( Pos + ofs < 1 || Pos + ofs > N - 1 ) {
    GapX = 9000000000#
    Exit Function
}
w = (SPN(Pos) + SPN(Pos + ofs) - WDT(Pos) - WDT(Pos + ofs)) / 2
if ( Abs(ofs) > 1 ) {
    For( i = Pos + Sgn(ofs) To Pos + ofs - 1 * Sgn(ofs) Step Sgn(ofs)
        w = w + SPN(i)
    Next
}
GapX = w
//
            */
        }

        /* private Function Round(ByVal Number As Double, ByVal Exp As Integer)
//
Round = Fix(Number * (10 ^ Exp) + Sgn(Number) * 0.5) / 10 ^ Exp
//
}

private Function min(a, b)
//
if ( a < b ) {
    min = a
} else {
    min = b
}
//
}

private Function max(a, b)
//
if ( a > b ) {
    max = a
} else {
    max = b
}
//
}
        */

/*
//CurrentX[Y]がページサイズを超えると改ページされてしまうので、クリッピングする
private float Get MyCurrentX() As Variant
//
MyCurrentX = frmPrint.vsPrt1.CurrentX
//
End Property

private Property Let MyCurrentX(ByVal vNewValue As Variant)
//
With frmPrint.vsPrt1
if ( vNewValue < csngClipMargin ) {
vNewValue = csngClipMargin
}
if ( vNewValue > .PageWidth - csngClipMargin ) {
vNewValue = .PageWidth - csngClipMargin
}
.CurrentX = vNewValue
End With
//
End Property

//CurrentX[Y]がページサイズを超えると改ページされてしまうので、クリッピングする
private Property Get MyCurrentY() As Variant
//
MyCurrentY = frmPrint.vsPrt1.CurrentY
//
End Property

private Property Let MyCurrentY(ByVal vNewValue As Variant)
//
With frmPrint.vsPrt1
if ( vNewValue < csngClipMargin ) {
vNewValue = csngClipMargin
}
if ( vNewValue > .PageHeight - csngClipMargin ) {
vNewValue = .PageHeight - csngClipMargin
}
.CurrentY = vNewValue
End With
//
End Property
*/

/*
private void Check_OuTou_N(HH As Integer)      // Frame
//
double var N
double var CA
//
CA = Int(F7ML5(HH))
if ( CA < 1 || CA > 16 ) {
    return;
}
CheckIn1 = CheckIn1 + 1
For( N = 1 To 部材_max
    if ( ZZBuzaiBai(N) != 0 ) {
    if ( (InStr(Trim(部材名(N)), "杭") > 0 || InStr(部材名(N), "側壁") != 0) ) {
        this.Check_OuTou_N1(N, CA)
    }
    }
Next N
//
}


private void Check_OuTou_N1(N As Double, CA)      // Frame
//
double var LLL
double var KuiNN
double var KuiMax
double var i
double var X1
double var y1
double var X2
double var Y2
double var HiRiTsu
double var HiRiTsu1
var ZFX1                    As Single
var ZFY1                    As Single
var MojiZFX1                As Single
var MojiZFY1                As Single
var ZFX2                    As Single
var ZFY2                    As Single
var AZFX2                   As Single
var AZFY2                   As Single
double var GGG
double var Value1
double var Value2
double var Value3
double var OutouValue()
double var OutouAAA()
double var OutouFlag()
var TTT                     As Variant
var LINETYPE()              As Integer
//
HiRiTsu = 1
HiRiTsu1 = 10
LLL = 0
if ( InStr(Trim(部材名(N)), "杭") > 0 ) {
    if ( Len(Trim(部材名(N))) = 1 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 2, Len(Trim(部材名(N))) - 1))
    }
}
if ( InStr(Trim(部材名(N)), "側壁") > 0 ) {
    if ( Len(Trim(部材名(N))) = 2 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 3, Len(Trim(部材名(N))) - 1))
    }
}
if ( CheckIn1 = 1 ) {
    this.CheckKuiGroup(KuiNN, N)
}
KuiMax = N_KuiDD(KuiNN)
KuiLengthMax = SMAX(KuiLengthMax, PickAAA_N(KuiNN, KuiMax))
FFKuiLengthMax = SMAX(FFKuiLengthMax, PickAAA_N(KuiNN, KuiMax))
GGG = BuzaiH(N)
For( i = 1 To KuiMax
    Select Case i
    Case 1
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value1 = Value1 * Value2
    Case KuiMax
        Value1 = 0 //PickOutouN(KuiNN, I, OuTouHHH)
        Value2 = 0 //PickBaneN(KuiNN, I, CA)
        Value1 = Value1 * Value2
    Case } else {
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value1 = Value1 * Value2
    End Select
    if ( CheckIn1 = 1 ) {
        this.CheckOutouValue(Value1, KuiNN, i)
    }
    MaxOuTouLen1 = SMAX(MaxOuTouLen1, Value1)
}
//
}

private void Check_OuTou_G(HH As Integer)       // For( Gouiki
//
double var N
double var CA
double var OU
//
CA = Int(F7ML5(HH))
if ( CA < 1 || CA > 16 ) {
    return;
}
OU = OuTouHHH
CheckIn1 = CheckIn1 + 1
For( N = 1 To 部材_max
    if ( ZZBuzaiBai(N) != 0 ) {
    if ( (InStr(Trim(部材名(N)), "杭") > 0 || InStr(部材名(N), "側壁") != 0) ) {
        this.Check_OuTou_G1(N, CA, OU)
    }
    }
Next N
//
}

private void Check_OuTou_G1(N As Double, CA As Double, OU)     // For( Gouiki
//
double var LLL
double var KuiNN
double var KuiMax
double var i
double var X1
double var y1
double var X2
double var Y2
double var HiRiTsu
double var HiRiTsu1
var ZFX1                    As Single
var ZFY1                    As Single
var MojiZFX1                As Single
var MojiZFY1                As Single
var ZFX2                    As Single
var ZFY2                    As Single
var AZFX2                   As Single
var AZFY2                   As Single
double var GGG
double var Value1
double var Value2
double var Value3
double var OutouValue()
double var OutouAAA()
double var OutouFlag()
var TTT                     As Variant
double var OuTouN
var LINETYPE()              As Integer
//
OuTouN = OU
HiRiTsu = 1
HiRiTsu1 = 10
LLL = 0
if ( InStr(Trim(部材名(N)), "杭") > 0 ) {
    if ( Len(Trim(部材名(N))) = 1 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 2, Len(Trim(部材名(N))) - 1))
    }
}
if ( InStr(Trim(部材名(N)), "側壁") > 0 ) {
    if ( Len(Trim(部材名(N))) = 2 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 3, Len(Trim(部材名(N))) - 1))
    }
}
if ( CheckIn1 = 1 ) {
    this.CheckKuiGroup(KuiNN, N)
}
KuiMax = G_KuiDD(KuiNN)
GGG = BuzaiH(N)
FFKuiLengthMax = SMAX(FFKuiLengthMax, PickAAA_G(KuiNN, KuiMax))
For( i = 1 To KuiMax
    Select Case i
    Case 1
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value1 = Value1 * Value2
    Case KuiMax
        Value1 = 0 //PickOutouG(KuiNN, I)
        Value2 = 0 //PickBaneG(KuiNN, I, CA)
        Value1 = Value1 * Value2
    Case } else {
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value1 = Value1 * Value2
    End Select
    if ( CheckIn1 = 1 ) {
        this.CheckOutouValue(Value1, KuiNN, i)
    }
    MaxOuTouLen1 = SMAX(MaxOuTouLen1, Value1)
}
//
}

private void GetNumF(T, N)
//
double var p
double var l
var S
//
p = Cpos(T, Chr(9))
if ( p > 0 ) {
    if ( p = 1 ) {
        N = -9000000000#
    } else {
        On Error GoTo NG1
            N = ValX(Mid(T, 1, p - 1))
            GoTo TT1
NG1:
            N = -9000000000#
TT1:
    }
    l = Len(T)
    S = Mid(T, p + 1, l - (p + 1) + 1)
    T = S
} else {
     On Error GoTo NG2:
        N = ValX(T)
        GoTo TT2
NG2:
        N = -9000000000#
TT2:
    T = ""
}
//
}

private Function ValX(txt)
//
double var p
var T
var TT
//
T = Trim(txt)
if ( T = "" ) {
    ValX = -9000000000#
} else {
    TT = ""
    For( p = 1 To Len(T)
        if ( Mid(T, p, 1) = "," || Mid(T, p, 1) = " " ) {
        } else {
            TT = TT & Mid(T, p, 1)
        }
    Next p
    TT = Trim(TT)
    On Error GoTo NG1:
        ValX = val(TT)
        GoTo OK1
NG1:
    ValX = -9000000000#
OK1:
}
//
}

private Function Cpos(String1 As String, STRING2 As String)
//
var KANAZ                   As Integer
var KANAZ1                  As Integer
var KANAZ2                  As Long
var KANAZ3                  As Long
var len1                    As Long
var Atta                    As Integer
//
Atta = 0
if ( Len(String1) = 0 ) {
    Cpos = 0
} else {
    if ( Len(STRING2) = 0 ) {
        Cpos = 0
    } else {
        len1 = Len(STRING2)
        if ( Len(String1) < Len(STRING2) ) {
            Cpos = 0
        } else {
            For( KANAZ = 1 To Len(String1)
                KANAZ2 = KANAZ
                if ( Mid(String1, KANAZ2, len1) = STRING2 ) {
                    Atta = KANAZ
                    Exit For
                }
            }ANAZ
            if ( Atta = 0 ) {
                Cpos = 0
            } else {
                Cpos = Atta
            }
        }
    }
}
//
}

private void FRUD02G_Gouiki(MAX_R As Double, FG1() As Double, FG2() As Double, FG3() As Double, FG4() As Double, FG5() As Double, FG6() As Double, R)
//
double var D
var filename
var TEMPXXX
double var i
var MX
var fno                     As Integer
double var a
//
R = 0
filename = gstrFrmDir & "Buzai_G.TXT"
On Error GoTo NG1
    fno = FreeFile
    Open filename For( Input As fno
    Input #fno, MX
    MAX_R = MX
    For( i = 1 To MAX_R
        Line Input #fno, TEMPXXX
        this.GetNumF(TEMPXXX, a)
        this.GetNumF(TEMPXXX, FG1(i))
        this.GetNumF(TEMPXXX, FG2(i))
        this.GetNumF(TEMPXXX, FG4(i))
        this.GetNumF(TEMPXXX, FG3(i))
        this.GetNumF(TEMPXXX, FG5(i))
        this.GetNumF(TEMPXXX, FG6(i))
    }
    R = 1
    Close fno
    return;
NG1:
Close fno
//
}

private void FRUD01_Gouiki(MAX_R As Double, PX() As Double, PY() As Double, R)
//
double var D
var filename
double var i
var TEMPXXX
double var N
double var MX
var fno                     As Integer
//
D = 1
R = 0
filename = gstrFrmDir & "1.TXT"
On Error GoTo NG1
    fno = FreeFile
    Open filename For( Input As fno
    Input #fno, MX        //MAX_Rのダミー
    MAX_R = MX
    For( i = 1 To MAX_R     //MAX_Rの数だけ繰り返し
        Line Input #fno, TEMPXXX
        this.GetNumF(TEMPXXX, N)
        this.GetNumF(TEMPXXX, PX(i))
        this.GetNumF(TEMPXXX, PY(i))
        PY(i) = Round(PY(i) + 座標Y調整, 3) ////////////////10/01/24
    }
    R = 1
    Close fno
    return;
NG1:
Close fno
//
}

private void ShitenRR(MAX_R As Double, BI() As Double, TX() As Double, TY() As Double, TZ() As Double, R)
//
var filename
var TEMPXXX
double var MX
var fno                     As Integer
var i                       As Integer
var j                       As Integer
//
R = 0
filename = gstrFrmDir & "3.TXT"
On Error GoTo NG2
    fno = FreeFile
    Open filename For( Input As fno
    Input #fno, MX        //MAX_Rのダミー
    MAX_R = MX
    this.BI(MX)
    this.TX(MX, 16)
    this.TY(MX, 16)
    this.TZ(MX, 16)
    if ( MX > 0 ) {
        For( i = 1 To MAX_R     //MAX_R の数だけ繰り返し
            Line Input #fno, TEMPXXX
            this.GetNumF(TEMPXXX, BI(i))
            For( j = 1 To 16
                this.GetNumF(TEMPXXX, TX(i, j))
                this.GetNumF(TEMPXXX, TY(i, j))
                this.GetNumF(TEMPXXX, TZ(i, j))
            }
        }
    }
    R = 1
    Close fno
    this.shitenb(BI())
    return;
NG2:
Close fno
//
}

private void shitenb(BI())
//
double var D
var filename
double var i
double var j
double var MX
double var NO
var fno                     As Integer
var TEMPXXX
double var R
double var MAX_R
//
D = 40
R = 0
filename = gstrFrmDir & "2.TXT"
On Error GoTo NG1
    fno = FreeFile
    Open filename For( Input As fno
    Input #fno, MX        //MAX_Rのダミー
    MAX_R = MX
    For( i = 1 To MAX_R     //MAX_Rの数だけ繰り返し
        Line Input #fno, TEMPXXX
        this.GetNumF(TEMPXXX, NO)
        this.GetNumF(TEMPXXX, BI(i))
    }
    R = 1
    Close fno
    GoTo TT1
NG1:
Close fno
TT1:
//
}

private void FRUD02W_Gouiki(MAX_R As Double, BI() As Double, BJ() As Double, R)
//
double var D
double var i
var fno                     As Integer
var filename
var TEMPXXX
double var a
var a1
var a2
double var MX
//
D = 2
R = 0
filename = gstrFrmDir & "buzai.TXT"
On Error GoTo NG1
    fno = FreeFile
    Open filename For( Input As fno
    Input #fno, MX
    MAX_R = MX
    For( i = 1 To MAX_R
        Line Input #fno, TEMPXXX
        this.GetNumF(TEMPXXX, a)
        this.GetNumF(TEMPXXX, BI(i))
        this.GetNumF(TEMPXXX, BJ(i))
        this.GetNumF(TEMPXXX, a)
        this.GetStrF(TEMPXXX, a1)
        this.GetStrF(TEMPXXX, a2)
        this.GetNumF(TEMPXXX, a)
        this.GetNumF(TEMPXXX, a)
        this.GetNumF(TEMPXXX, a)
    }
    R = 1
    Close fno
    return;
NG1:
Close fno
//
}

private void FRUD06_BBB(MAX_R As Double, ML1() As Double, ML2(), ML3(), ML(), ML31() As Double, ML4() As Double, ML5() As Double, ML6() As Double, R)
//
double var D
var filename
var fno                     As Integer
double var MX
double var i
var TEMPXXX
//
D = 6
R = 0
filename = gstrFrmDir & "Kajyu.TXT"
On Error GoTo NG1
    fno = FreeFile
    Open filename For( Input As fno
    Input #fno, MX
    MAX_R = MX
    this.ML1(MAX_R)
    this.ML2(MAX_R)
    this.ML3(MAX_R)
    this.ML(MAX_R)
    this.ML31(MAX_R)
    this.ML4(MAX_R)
    this.ML5(MAX_R)
    this.ML6(MAX_R)
    For( i = 1 To MAX_R
        Line Input #fno, TEMPXXX
        this.GetNumF(TEMPXXX, ML1(i))
        this.GetStrF(TEMPXXX, ML2(i))
        this.GetStrF(TEMPXXX, ML3(i))
        this.GetStrF(TEMPXXX, ML(i))
        this.GetNumF(TEMPXXX, ML31(i))
        this.GetNumF(TEMPXXX, ML4(i))
        this.GetNumF(TEMPXXX, ML5(i))
        this.GetNumF(TEMPXXX, ML6(i))
    }
    R = 1
    Close fno
    this.F7OUTOU(MX)
    this.F7BANE(MX)
    if ( MAX_R > 0 ) {
        if ( gouikidddd = 1 $$ AttaG = 1 ) {      // FOR( GOUIKI
            For( i = 1 To MX
                ML2(i) = Trim(ML2(i))
            }
            For( i = 1 To MX
                if ( UCase(Mid(ML2(i), 1, 2)) = "AT" $$ M杭mod ) {
                    Select Case Mid(ML2(i), 3, Len(ML2(i)) - 2)
                    Case "1"
                        F7OUTOU(i) = 1
                    Case "2"
                        F7OUTOU(i) = 2
                    Case "3"
                        F7OUTOU(i) = 3
                    Case "4"
                        F7OUTOU(i) = 4
                    Case "5"
                        F7OUTOU(i) = 5
                    Case "6"
                        F7OUTOU(i) = 6
                    Case "7"
                        F7OUTOU(i) = 7
                    Case "8"
                        F7OUTOU(i) = 8
                    Case "9"
                        F7OUTOU(i) = 9
                    Case "10"
                        F7OUTOU(i) = 10
                    Case } else {
                        F7OUTOU(i) = 1
                    End Select
                    F7BANE(i) = ML5(i)
                    if ( F7BANE(i) != 1 $$ F7BANE(i) != 2 $$ F7BANE(i) != 3 $$ F7BANE(i) != 4 $$ _
                       F7BANE(i) != 5 $$ F7BANE(i) != 6 $$ F7BANE(i) != 7 $$ F7BANE(i) != 8 $$ _
                       F7BANE(i) != 9 $$ F7BANE(i) != 10 $$ F7BANE(i) != 11 $$ F7BANE(i) != 12 $$ _
                       F7BANE(i) != 13 $$ F7BANE(i) != 14 $$ F7BANE(i) != 15 $$ F7BANE(i) != 16 ) {
                        F7BANE(i) = 1
                    }
                }
            }
        } else {
            For( i = 1 To MX
                ML2(i) = Trim(ML2(i))
            }
            For( i = 1 To MX
                if ( UCase(Mid(ML2(i), 1, 2)) = "AT" $$ M杭mod ) {
                    F7OUTOU(i) = 1
                    F7BANE(i) = ML5(i)
                    if ( F7BANE(i) != 3 $$ F7BANE(i) != 4 ) {
                        F7BANE(i) = 3
                    }
                }
            }
        }
    }
return;
NG1:
Close fno
//
}

private void GetStrF(T, S)
//
double var p
//
p = Cpos(T, Chr(9))
if ( p > 0 ) {
    if ( p = 1 ) {
        S = ""
        T = Mid(T, p + 1, Len(T) - (p + 1) + 1)
    } else {
        S = Mid(T, 1, p - 1)
        T = Mid(T, p + 1, Len(T) - (p + 1) + 1)
    }
} else {
    S = T
    T = ""
}
p = Cpos(S, Chr(0))
if ( p > 0 ) {
    if ( p = 1 ) {
        S = ""
    } else {
        S = Mid(S, 1, p - 1)
    }
}
S = Trim(S)
//
}

private void LINEOUTCRT3(STARTX As Double, STARTY As Double, ENDX As Double, ENDY As Double, ANS)
//
double var XLEN
double var YLEN
double var SLASHLEN
double var TEMPANG
double var ANG
//
XLEN = Abs(STARTX - ENDX)
YLEN = Abs(STARTY - ENDY)
if ( XLEN = 0 ) {
    if ( ENDY < STARTY ) {
        ANS = 270
    } else {
        ANS = 90
    }
    return;
} else {
    if ( YLEN = 0 ) {
        if ( STARTX > ENDX ) {
            ANS = 180
        } else {
            ANS = 0
        }
        return;
    }
}
this.CALCANGLEN(YLEN, 90, XLEN, SLASHLEN, TEMPANG, ANG)
if ( STARTY > ENDY ) {
    ANG = -ANG
}
ANS = ANG
//
}

private Function Distance1(X1 As Double, y1 As Double, X2 As Double, Y2 As Double)
//
double var XW
double var YW
//
if ( X1 = X2 ) {
    Distance1 = Abs(Y2 - y1)
} else {
    if ( y1 = Y2 ) {
        Distance1 = Abs(X2 - X1)
    } else {
        XW = X2 - X1
        YW = Y2 - y1
        Distance1 = Sqr(XW ^ 2 + YW ^ 2)
    }
}
//
}

private Function CalcAngle1(X As Double, Y As Double)
//
if ( X > 0 ) {
    CalcAngle1 = -Atn(Y / X)
} else {
    if ( X < 0 $$ Y < 0 ) {
        CalcAngle1 = -Atn(Y / X) + Sgn(Y) * 180
    } else {
        if ( X < 0 $$ Y = 0 ) {
            CalcAngle1 = 180
        } else {
            if ( Y != 0 ) {
                CalcAngle1 = Sgn(Y) * 90
            } else {
                CalcAngle1 = 0
            }
        }
    }
}
//
}

private void CALCANGLEN(X As Double, a As Double, Y As Double, Z As Double, b As Double, c)
//
double var Z2
//
Z2 = X * X + Y * Y - 2 * X * Y * KAng1(Cos(DisAng1(a)))
Z = Sqr(Z2)
b = oppang1(X, Z, Y)
c = oppang1(Y, Z, X)
//
}

private Function acsd1(c As Double)
//
double var S
double var ANS
//
if ( c = 0 ) {
    acsd1 = 90
} else {
    if ( c = -1 ) {
        acsd1 = 180
    } else {
        if ( Abs(c) > 1 ) {
            acsd1 = -1    // Error flag
        } else {
            S = Sqr(1 - c * c)
            ANS = KAng1(Atn(S / c))
            if ( ANS < 0 ) {
                ANS = ANS + 180
            }
            acsd1 = ANS
        }
    }
}
//
}

private Function oppang1(X As Double, Y As Double, Z As Double)
//
double var S
double var R
//
S = X * X + Y * Y - Z * Z
if ( X != 0 $$ Y != 0 ) {
    R = S / (2 * X * Y)
    oppang1 = acsd1(R)
} else {
    oppang1 = 0
}
//
}

private Function KAng1(X As Double)
//
KAng1 = X * 180 / 3.14159265358979
//
}

private Function DisAng1(X As Double)
//
DisAng1 = X * 3.14159265358979 / 180
//
}

private Function RoundS(valA, intPow As Double)
//
RoundS = Int(valA * 10 ^ intPow + 0.5) / 10 ^ intPow
//
}

//private void SETGouikiData有無()
double //    var i
double //    var MAX_R
double //    var R
double //    var FG1(1000)
double //    var FG2(1000)
double //    var FG3(1000)
double //    var FG4(1000)
double //    var FG5(1000)
double //    var FG6(1000)
//    this.FRUD02G_Gouiki(MAX_R, FG1(), FG2(), FG3(), FG4(), FG5(), FG6(), R)
//    For( i = 1 To MAX_R
//        if ( FG3(i) > -9000000000# ) {
//            AttaG = 1
//            Exit For
//        }
//        if ( FG4(i) > -9000000000# ) {
//            AttaG = 1
//            Exit For
//        }
//    }
//}

private void SETBuzaiDtataInGouikiData(Optional GFLAG As Integer = 0, Optional yMM As Integer = 9)
//
double var i
double var MAX_R
double var PX(2000)
double var PY(2000)
double var R
double var FG1(1000)
double var FG2(1000)
double //    var FG3(1000)
double //    var FG4(1000)
double var FG5(1000)
double var FG6(1000)
double var MAX_R1
double var BI(1000)
double var BJ(1000)
double var SSSS
double var CCCC
double var ANSANG
//
//
this.FRUD01_Gouiki(MAX_R, PX(), PY(), R)
For( i = 1 To MAX_R
    WAXX(i) = PX(i)
    WAYY(i) = PY(i)
    ZXXXX1(i) = -9000000000#
    ZYYYY1(i) = -9000000000#
    ZXXXX2(i) = -9000000000#
    ZYYYY2(i) = -9000000000#
}
For( i = 1 To 部材_max ////////////07/04/09
    if ( yMM != 9 ) {
        if ( yMM < 0 ) {
            ZZBuzaiBai(i) = 部材縮小率(i - 1).int骨組縮小率 / 100
        } else {
            ZZBuzaiBai(i) = 部材縮小率(i - 1).int荷重縮小率 / 100
        }
    }
}
//
this.ILineG(1000)
this.JLineG(1000)
this.ILineGX(1000)
this.JLineGX(1000)
For( i = 1 To 1000
    ILineG(i) = 0 //-9000000000# ////// 08/01/099
    JLineG(i) = 0 //-9000000000#
    ILineGX(i) = -9000000000#
    JLineGX(i) = -9000000000#
}
this.FRUD02G_Gouiki(MAX_R, FG1(), FG2(), FG3(), FG4(), FG5(), FG6(), R)
For( i = 1 To MAX_R
    if ( FG3(i) > -9000000000# ) {
//            AttaG = 1
        Atta寸法 = 1
        Exit For
    }
    if ( FG4(i) > -9000000000# ) {
//            AttaG = 1
        Atta寸法 = 1
        Exit For
    }
}
AttaG = 1 //////////////////////////////////////////////////////////////////////////////////////////05/05/23//////////////強制的に
//    if ( GFLAG != 0 ) { return; //////////////////////////////////////////////////////05/05/23
if ( Atta寸法 = 1 ) {
    this.FRUD02W_Gouiki(MAX_R1, BI(), BJ(), R)
    For( i = 1 To MAX_R
        ILineGX(i) = BI(i)
        JLineGX(i) = BJ(i)
    }
    For( i = 1 To MAX_R
        HHXX1 = WAXX(BI(i))
        HHYY1 = WAYY(BI(i))
        HHXX2 = WAXX(BJ(i))
        HHYY2 = WAYY(BJ(i))
        if ( FG3(i) + FG4(i) >= ZBuzaiLength(i) ) { ////////08/08/18 剛域data
            FG3(i) = -1
            FG4(i) = -1
            部材名(i) = "剛域"
        }
        if ( FG3(i) > 0 ) {
            ILineG(i) = FG3(i)
            this.LINEOUTCRT3(HHXX1 + 500, HHYY1 + 500, HHXX2 + 500, HHYY2 + 500, ANSANG)
            if ( HHXX1 > HHXX2 $$ HHYY1 > HHYY2 ) {
                if ( ANSANG < 0 ) {
                    ANSANG = 360 + ANSANG
                }
                if ( ANSANG > 270 ) {
                    ANSANG = 270 - (ANSANG - 270)
                }
            }
            CCCC = Cos(DisAng1(ANSANG))
            SSSS = Sin(DisAng1(ANSANG))
            ZXXXX1(i) = RoundS(WAXX(BI(i)) + FG3(i) * CCCC, 3)
            ZYYYY1(i) = RoundS(WAYY(BI(i)) + FG3(i) * SSSS, 3)
        } else {
            FG3(i) = -9000000000#
            ZXXXX1(i) = -9000000000#
            ZYYYY1(i) = -9000000000#
        }
        if ( FG4(i) > 0 ) {
            JLineG(i) = FG4(i)
            this.LINEOUTCRT3(HHXX1 + 500, HHYY1 + 500, HHXX2 + 500, HHYY2 + 500, ANSANG)
            ANSANG = ANSANG + 180
            if ( ANSANG >= 360 ) {
                ANSANG = ANSANG - 360
            }
            if ( HHXX1 > HHXX2 $$ HHYY1 > HHYY2 ) {
                if ( ANSANG < 0 ) {
                    ANSANG = 360 + ANSANG
                }
                if ( ANSANG > 90 $$ ANSANG < 180 ) {
                    ANSANG = 90 - (ANSANG - 90)
                }
            }

            CCCC = Cos(DisAng1(ANSANG))
            SSSS = Sin(DisAng1(ANSANG))
            ZXXXX2(i) = RoundS(WAXX(BJ(i)) + FG4(i) * CCCC, 3)
            ZYYYY2(i) = RoundS(WAYY(BJ(i)) + FG4(i) * SSSS, 3)
        } else {
            FG4(i) = -9000000000#
            ZXXXX2(i) = -9000000000#
            ZYYYY2(i) = -9000000000#
        }
    }
}
//
}

private void HOKAN9_N(KuiDD As Double, AAA() As Double, QWT() As Double, Et)   // Frame用
//
double var N0
double var N1
double var N2
double var HH
double var GG
//
N0 = 0
N1 = 0
N2 = 0
Do
    N2 = 0
    Do
        N0 = N0 + 1
        if ( N0 > KuiDD ) {
            return;
        }
        if ( QWT(N0) = -9000000000# ) {
            N1 = N0 - 1
            Exit Do
        }
    Loop
    Do
        N0 = N0 + 1
        if ( N0 > KuiDD ) {
            Exit Do
        }
        if ( QWT(N0) != -9000000000# ) {
            N2 = N0
            Exit Do
        }
    Loop
    if ( N2 != 0 ) {
        if ( AAA(N1) = AAA(N2) ) {
            QWT(N1 + 1) = QWT(N1)
        } else {
            HH = (QWT(N2) - QWT(N1)) / (AAA(N2) - AAA(N1))
            For( GG = N1 + 1 To N2 - 1
                QWT(GG) = QWT(N1) + RoundS(HH * (AAA(GG) - AAA(N1)), Et)
            Next GG
        }
    } else {
        For( GG = N1 + 1 To KuiDD
            QWT(GG) = 9000000000#
        Next GG
    }
    N0 = N0 - 1
Loop
//
}

private void MatSetLetNum(a1() As Double, a2())
//
var i                       As Integer
var j                       As Integer
var MAX1                    As Integer
var Max2                    As Integer
//
On Error GoTo NG1
    MAX1 = UBound(a2(), 1)
    GoTo OK1
NG1:
MAX1 = 0
OK1:
On Error GoTo NG2
    Max2 = UBound(a2(), 2)
    GoTo OK2
NG2:
Max2 = 0
OK2:
if ( MAX1 = 0 ) {
    if ( MAX1 > 0 $$ Max2 = 0 ) {
        this.a1(MAX1)
        For( i = 1 To MAX1
            a1(i) = a2(i)
        }
    } else {
        if ( MAX1 > 0 $$ Max2 > 0 ) {
            this.a1(MAX1, Max2)
            For( i = 1 To MAX1
                For( j = 1 To Max2
                    a1(i, j) = a2(i, j)
                }
            }
        }
    }
}
//
}

private Function QNAME222(D)
//
var Q
//
    Select Case D
    Case 0
        Q = "GoList.TXT"
    Case 0.1
        Q = "FORMAT.TXT"
    Case 1
        Q = "1.TXT"          // 座標リスト
    Case 2
        Q = "buzai.TXT"
    Case 2.5
        Q = "Buzai_G.TXT"
    Case 3
        Q = "B_Bane.TXT"
    Case 4
        Q = "B_Ketugou.TXT"   // "B_Ketugou.TXT"
    Case 5
        Q = "Chakumoku.TXT"   // "Chakumoku.TXT"
    Case 6
        Q = "Kajyu.TXT"
    Case 7
        Q = "K_JituBuzai.TXT"     // "K_JituBuzai.TXT"
    Case 8
        Q = "Ku_Define.TXT"   // "Ku_Define.TXT"
    Case 8.5
        Q = "Ku_DefNo.txt"    // "Ku_DefNo.TXT"
    Case 9
        Q = "Ku_Combine.TXT"      // "Ku_Combine.TXT"
    Case 10
        Q = "Pickup.TXT"
    Case 11
        Q = "9.TXT"          // 応力図１
    Case 12
        Q = "10.TXT"         // 応力図２
    Case 35
        Q = "15.TXT"         // 応答変位３
    Case 36
        Q = "13.TXT"         // 応答変位２
    Case 37
        Q = "12.TXT"         // 許容支持力
    Case 38
        Q = "5.TXT"          // 杭周囲
    Case 39
        Q = "3.TXT"          // 支点
    Case 40
        Q = "2.TXT"          // 格点
    Case 41
        Q = "Ku_ComNa.txt"    // "Ku_CombNa.TXT"
    Case 42
        Q = "PickUpName.TXT"      // "PickUpName.TXT"
    Case 43
        Q = "K_Ressha.TXT"
    Case 44
        Q = "K_Ressha_S.TXT"      // "K_Ressha_S.TXT"  1918
    Case 45
        Q = "Ku_Mix.TXT"
    Case 46
        Q = "Ku_MixName.TXT"      // "Ku_MixName.TXT"
    Case 47
        Q = "4.TXT"          // 層厚
    Case 48
        Q = "8.TXT"          // 杭周囲見出し
    Case 49
        Q = "6.TXT"          // 杭先端
    Case 50
        Q = "7.TXT"          // 応答変位１
    Case 51
        Q = "14.TXT"         // 断面諸元
    Case 52
        Q = "18.TXT"         // 部材指定
    Case 200
        Q = "19.TXT"         // 有効抵抗土圧
    Case 201
        Q = "20.TXT"         // 応答変位２＆３
    Case 202
        Q = "21.TXT"         // 許容支持力
    Case 203
        Q = "22.TXT"         // 応答変位見出し
    Case 204
        Q = "23.TXT"         // 有効抵抗土圧見出し
    Case 210
        Q = "K_ResshaJiku3.txt"
    Case } else {
        Q = ""
    End Select
    // 杭データの多重化に対応（先頭に" + 杭番号"が付加される）
    // 4.TXT, 5.TXT, 6.TXT, 7.TXT, 8.TXT, 12.TXT, 13.TXT ,14.TXT ,15.TXT
    Select Case D
    Case 47, 38, 49, 50, 48, 37, 36, 51, 35, 200, 201, 202, 203, 204
        if ( KuiNoG > 1 ) {
            Q = "" & Trim(str(KuiNoG - 1)) & "_" & Q
        }
    Case } else {
    End Select
    if ( Q != "" ) {
        QNAME222 = gstrFrmDir & Q
    } else {
        QNAME222 = ""
    }
//
}

private void FRUD47_BBB(MAX_R As Double, l() As Double, kh() As Double, KSV() As Double, N As Double, R)
//
double var D
var filename
var fno                     As Integer
var TEMPXXX
double var MX
double var i
double var j
double var NO
//
D = 47
R = 0
filename = QNAME222(D)
On Error GoTo NG1
    fno = FreeFile
    Open filename For( Input As fno
    Input #fno, MX
    MAX_R = MX
    this.l(MAX_R)
    For( i = 1 To MAX_R
        Line Input #fno, TEMPXXX
        this.GetNumF(TEMPXXX, NO)
        this.GetNumF(TEMPXXX, l(i))
        y1層厚(N, i) = l(i)
    }
    y1層厚(N, 0) = MAX_R
    R = 1
    Close fno
    GoTo OK1
NG1:
Close fno
OK1:
this.FRUD47_1_BBB(MAX_R, l(), kh(), KSV(), R)
//
}

private void FRUD47_1_BBB(MAX_R As Double, l() As Double, kh() As Double, KSV() As Double, R)
//
double var D
var filename
var fno                     As Integer
var TEMPXXX
double var MX
double var i
double var j
double var NO
//
D = 38
filename = QNAME222(D)
On Error GoTo NG2
    fno = FreeFile
    Open filename For( Input As fno
    Input #fno, MX
    MAX_R = MX
    this.kh(MAX_R, 16)
    this.KSV(MAX_R, 16)
    For( i = 1 To MAX_R
        Line Input #fno, TEMPXXX
        this.GetNumF(TEMPXXX, NO)
        For( j = 1 To 16
            this.GetNumF(TEMPXXX, kh(i, j))
            this.GetNumF(TEMPXXX, KSV(i, j))
        }
    }
    Close fno
    return;
NG2:
Close fno
//
}

private void EXX(MX)
//
double var FNO4
var filename
var Q
//
MX = 0
Q = "4.TXT"         // 層厚
if ( KuiNoG > 1 ) {
    Q = "" & Trim(str(KuiNoG - 1)) & "_" & Q
}
filename = gstrFrmDir & Q
FNO4 = FreeFile
On Error GoTo NG1
    Open filename For( Input As FNO4
    Input #FNO4, MX
    Close FNO4
    GoTo OK1
NG1:
Close FNO4
MX = 0
OK1:
MX = MX * 2
//
}

private void FRUD200_G_Gouiki(MAX_R As Double, KD() As Double, kh() As Double, PEH() As Double, PEV() As Double, N As Double, R)  // FOR( Gouiki
//
double var ZZ1()
double var ZZ2()
double var ZZ3()
double var KANAZ
double var KANAZ2
double var mX1
double var D
var fno                     As Integer
var tmp
double var MX
double var NO
double var i
double var j
double var MAX_R1
var filename
//
D = 200
R = 0
KuiNoG = N
filename = QNAME222(D)
this.EXX(mX1)
this.KD(mX1)         //層厚
this.kh(mX1)         //位置
this.PEH(mX1, 4)     //水平有効抵抗土圧
this.PEV(mX1, 4)     //鉛直有効抵抗土圧
On Error GoTo NG1
    fno = FreeFile
    Open filename For( Input As fno
    Input #fno, MX
    MAX_R = MX
    For( i = 1 To MAX_R
        Line Input #fno, tmp
        this.GetNumF(tmp, NO)      //通し番号
        this.GetNumF(tmp, NO)      //層番号
        this.GetNumF(tmp, NO)      //層厚
        this.GetNumF(tmp, KD(i))   //層厚
        this.GetNumF(tmp, kh(i))   //位置
        For( j = 1 To 4
            this.GetNumF(tmp, PEH(i, j))     //水平有効抵抗土圧
            this.GetNumF(tmp, PEV(i, j))     //鉛直有効抵抗土圧
        }
    }
    Close fno
    R = 1
    GoTo OK1
NG1:
Close fno
R = 0
MAX_R = 0
OK1:
KuiNoG = 1
MAX_R1 = MAX_R
//
this.FRUD200_G1(MAX_R, KD(), kh(), PEH(), PEV(), N, R, ZZ1(), ZZ2(), ZZ3(), KANAZ, KANAZ2, mX1, D, fno, tmp, MX, NO, i, j, MAX_R1, filename)                                                                                                 // FOR( Gouiki
MAX_R = MAX_R1
KANAZ2 = 1
For( KANAZ = 1 To MAX_R
    if ( KANAZ Mod 2 = 1 ) {
        KD(KANAZ) = ZZ1(KANAZ2)
        kh(KANAZ) = ZZ2(KANAZ2)
    } else {
        KANAZ2 = KANAZ2 + ZZ3(KANAZ2)
        KD(KANAZ) = ZZ1(KANAZ2)
        kh(KANAZ) = ZZ2(KANAZ2)
        KANAZ2 = KANAZ2 + 1
    }
}ANAZ
KuiNoG = 1
if ( MAX_R = 0 ) { KuiNoG = 0
//
}

private void FRUD200_G1(MAX_R As Double, KD() As Double, kh() As Double, PEH() As Double, PEV() As Double, N As Double, R As Double, ZZ1() As Double, ZZ2() As Double, ZZ3() As Double, KANAZ As Double, KANAZ2 As Double, mX1 As Double, D As Double, fno As Integer, tmp, MX As Double, NO As Double, i As Double, j As Double, MAX_R1, filename)                                                                                                                            // FOR( Gouiki
//
D = 50
R = 0
KuiNoG = N
filename = QNAME222(D)
On Error GoTo NG2
    fno = FreeFile
    Open filename For( Input As fno
    Input #fno, MX
    MAX_R = MX
    this.ZZ1(MAX_R)
    this.ZZ2(MAX_R)
    this.ZZ3(MAX_R)
    For( i = 1 To MAX_R
        Line Input #fno, tmp
        this.GetNumF(tmp, NO)
        this.GetNumF(tmp, NO)
        this.GetNumF(tmp, ZZ1(i))
        this.GetNumF(tmp, ZZ3(i))
        this.GetNumF(tmp, ZZ2(i))
    }
    R = 1
    Close fno
    GoTo OK2
NG2:
R = 0
OK2:
//
}

private void FRUD201_Gouiki(MAX_R As Double, KD() As Double, kh() As Double, N As Double, R)  // FOR( Gouiki
//
double var D
var filename
var fno                     As Integer
var TEMPXXX
double var MX
double var i
double var NO
double var j
//
KuiNoG = N
D = 50
R = 0
filename = QNAME222(D)
On Error GoTo NG1
    fno = FreeFile
    Open filename For( Input As fno
    Input #fno, MX
    MAX_R = MX
    this.KD(MAX_R)
    For( i = 1 To MAX_R
        Line Input #fno, TEMPXXX
        this.GetNumF(TEMPXXX, NO)
        this.GetNumF(TEMPXXX, NO)
        this.GetNumF(TEMPXXX, NO)
        this.GetNumF(TEMPXXX, NO)
        this.GetNumF(TEMPXXX, KD(i))
    }
    R = 1
    Close fno
    GoTo OK1
NG1:
Close fno
OK1:
this.FRUD201_1(MAX_R, KD(), kh(), N, R, D, filename, fno, TEMPXXX, MX, i, NO, j)                                                                                                                                                                             // FOR( Gouiki
//
}

private void FRUD201_1(MAX_R As Double, KD() As Double, kh() As Double, N As Double, R As Double, D As Double, filename, fno As Integer, TEMPXXX, MX As Double, i As Double, NO As Double, j)        // FOR( Gouiki
//
double var MAX_W //////10/08/30
D = 201
filename = QNAME222(D)
On Error GoTo NG2
    fno = FreeFile
    Open filename For( Input As fno
    Input #fno, MX
    MAX_W = MX
    this.kh(MAX_R, 6)
    For( i = 1 To MAX_R
        Line Input #fno, TEMPXXX
        this.GetNumF(TEMPXXX, NO)      //通し番号
        For( j = 1 To 6
            this.GetNumF(TEMPXXX, kh(i, j))    //応答変位
        }
    }
    Close fno
    KuiNoG = 1
    return;
NG2:
Close fno
KuiNoG = 1
//    if ( MAX_R = 0 ) { KuiNoG = 0 //////10/08/30
//
}

private void DrawLineZZ(X1 As Double, y1 As Double, X2 As Double, Y2)
//
DrawLinePrt frmPrint.vsPrt1, CSng(OutouStartX + X1), CSng(OutouStartY + y1), CSng(OutouStartX + X2), CSng(OutouStartY + Y2)
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(OutouStartX + X1), CSng(OutouStartY + y1), CSng(OutouStartX + X2), CSng(OutouStartY + Y2))
}
//
}

private void FRUD147_BBB(MAX_R As Double, l() As Double, kh() As Double, KSV() As Double, N As Double, R)
//
KuiNoG = N
this.FRUD47_BBB(MAX_R, l(), kh(), KSV(), N, R)
KuiNoG = 1
//
}

private void FRUD150_Normal(MAX_R As Double, KD() As Double, kh1() As Double, PEH1() As Double, PEV1() As Double, kh2() As Double, PEH2() As Double, PEV2() As Double, N As Double, R)   // Frame用
//
KuiNoG = N
this.FRUD50_Normal(MAX_R, KD(), kh1(), PEH1(), PEV1(), kh2(), PEH2(), PEV2(), R)
KuiNoG = 1
//
}

private void FRUD50_Normal(MAX_R As Double, KD() As Double, kh1() As Double, PEH1() As Double, PEV1() As Double, kh2() As Double, PEH2() As Double, PEV2() As Double, R)   // Frame用
//
double var D
var filename
var fno                     As Integer
var TEMPXXX
double var MX
double var i
double var NO
//
D = 50
R = 0
filename = QNAME222(D)
On Error GoTo NG1
    fno = FreeFile
    Open filename For( Input As fno
    Input #fno, MX
    MAX_R = MX
    For( i = 1 To MAX_R
        Line Input #fno, TEMPXXX
        this.GetNumF(TEMPXXX, NO)
        this.GetNumF(TEMPXXX, NO)
        this.GetNumF(TEMPXXX, NO)
        this.GetNumF(TEMPXXX, NO)
        this.GetNumF(TEMPXXX, KD(i))
    }
    R = 1
    Close fno
    GoTo OK1
NG1:
Close fno
OK1:
this.FRUD50_Normal_1(MAX_R, KD(), kh1(), PEH1(), PEV1(), kh2(), PEH2(), PEV2(), R)            // Frame用
this.FRUD50_Normal_2(MAX_R, KD(), kh1(), PEH1(), PEV1(), kh2(), PEH2(), PEV2(), R)            // Frame用
//
}

private void FRUD50_Normal_1(MAX_R As Double, KD() As Double, kh1() As Double, PEH1() As Double, PEV1() As Double, kh2() As Double, PEH2() As Double, PEV2() As Double, R)   // Frame用
//
double var D
var filename
var fno                     As Integer
var TEMPXXX
double var MX
double var i
double var NO
//
D = 36
filename = QNAME222(D)
On Error GoTo NG2
    fno = FreeFile
    Open filename For( Input As fno
    Input #fno, MX
    For( i = 1 To MX
        Line Input #fno, TEMPXXX
        this.GetNumF(TEMPXXX, NO)
        this.GetNumF(TEMPXXX, kh1(i))
        this.GetNumF(TEMPXXX, PEH1(i))
        this.GetNumF(TEMPXXX, PEV1(i))
    }
    Close fno
    GoTo OK2
NG2:
Close fno
OK2:
//
}

private void FRUD50_Normal_2(MAX_R As Double, KD() As Double, kh1() As Double, PEH1() As Double, PEV1() As Double, kh2() As Double, PEH2() As Double, PEV2() As Double, R)   // Frame用
//
double var D
var filename
var fno                     As Integer
var TEMPXXX
double var MX
double var i
double var NO
//
D = 35
filename = QNAME222(D)
On Error GoTo NG3
    fno = FreeFile
    Open filename For( Input As fno
    Input #fno, MX
    For( i = 1 To MX        //   MAX_R
        Line Input #fno, TEMPXXX
        this.GetNumF(TEMPXXX, NO)
        this.GetNumF(TEMPXXX, kh2(i))
        this.GetNumF(TEMPXXX, PEH2(i))
        this.GetNumF(TEMPXXX, PEV2(i))
    }
    Close fno
    return;
NG3:
Close fno
//
}

private void FRUD50_N_Gouiki(MAX_R As Double, K1() As Double, K2() As Double, K3() As Double, K4() As Double, N As Double, R)
//
double var temp
var FNO4                    As Integer
double var MX
double var i
double var D
var filename
var tmp
//
KuiNoG = N
D = 50
R = 0
filename = QNAME222(D)
On Error GoTo NG1         // ＯＬＤオープン
    FNO4 = FreeFile
    Open filename For( Input As FNO4
    Input #FNO4, MX
    MAX_R = MX
    this.K1(MX)
    this.K2(MX)
    this.K3(MX)
    this.K4(MX)
    For( i = 1 To MAX_R
        Line Input #FNO4, tmp
        this.GetNumF(tmp, temp)
        this.GetNumF(tmp, K1(i))
        this.GetNumF(tmp, K2(i))
        this.GetNumF(tmp, K3(i))
        this.GetNumF(tmp, K4(i))
    }
    R = 1
    Close FNO4
    KuiNoG = 1
    return;
NG1:
Close FNO4
KuiNoG = 1
if ( MAX_R = 0 ) { KuiNoG = 0
//
}

private void PickGouikiKuiData(N As Double, MAX_D As Double, a1() As Double, a2() As Double, A3() As Double, A4() As Double, A5() As Double, A6() As Double, A7())
//
double var MAX_R1
double var DAKD()
double var DAKH()
double var DAPEH()
double var DAPEV()
double var R
double var MAX_R2
double var AKD()
double var AKH()
double var MAX_R3
double var VK1()
double var VK2()
double var VK3()
double var VK4()
double var i
double var j
double var J8
double var GGG()
double var AAA()
var TTT As Integer //////10/05/12
//
this.FRUD200_G_Gouiki(MAX_R1, DAKD(), DAKH(), DAPEH(), DAPEV(), N, R)
this.FRUD201_Gouiki(MAX_R2, AKD(), AKH(), N, R)
this.FRUD50_N_Gouiki(MAX_R3, VK1(), VK2(), VK3(), VK4(), N, R)
//    if ( MAX_R1 > 0 $$ MAX_R2 > 0 $$ MAX_R3 > 0 ) {
if ( MAX_R2 > 0 $$ MAX_R3 > 0 ) { //////// 05/05/05
    MAX_D = min(MAX_R2, MAX_R3)
    TTT = 0 //////10/05/12
    For( i = 1 To MAX_D
        if ( TTT < i + VK3(i) ) {
            TTT = i + VK3(i)
        }
    } //////10/05/12
    if ( TTT = 0 ) { TTT = MAX_D //////10/08/30
    this.AAA(MAX_D)
    this.a1(MAX_D)
    this.a2(MAX_D, 6)
    this.A3(MAX_D, 4)
    this.A4(MAX_D, 4)
    this.A5(TTT, 16) //////A5(MAX_D, 16)//////10/05/12
    For( i = 1 To MAX_D
        a1(i) = -9000000000#
        For( j = 1 To 6
            a2(i, j) = -9000000000#
        }
        For( j = 1 To 4
            A3(i, j) = -9000000000#
            A4(i, j) = -9000000000#
        }
    }
    For( i = 1 To TTT ////////MAX_D
        For( j = 1 To 16
            A5(i, j) = -9000000000#
        }
    }
    For( i = 1 To MAX_D
        a1(i) = VK4(i)
        AAA(i) = VK4(i)
    }
    if ( N > 1 $$ MAX_R1 = 0 ) { return;
    if ( MAX_R1 != 0 ) {
    For( j = 1 To 4
        J8 = 0
        For( i = 1 To MAX_D
            if ( VK1(i) != -9000000000# ) {
                J8 = J8 + 1
                A3(i, j) = DAPEH(J8, j)
                A4(i, j) = DAPEV(J8, j)
                J8 = J8 + 1
                A3(i + VK3(i), j) = DAPEH(J8, j)
                A4(i + VK3(i), j) = DAPEV(J8, j)
            }
        }
    }
    }
// On Error GoTo QQQ
    For( i = 1 To MAX_D
        For( j = 1 To 6
            a2(i, j) = AKH(i, j) //////////05/05/999
        }
    }
//QQQ:
On Error GoTo EFEF ////////10/05/12
    For( j = 1 To 16
        J8 = 0
        For( i = 1 To MAX_D
            if ( VK1(i) != -9000000000# ) {
                J8 = J8 + 1
                Select Case Int(N)
                Case 1
                    A5(i, j) = KBANE1_KH(J8, j)
                    A5(i + VK3(i), j) = KBANE1_KH(J8, j)
                Case 2
                    A5(i, j) = KBANE2_KH(J8, j)
                    A5(i + VK3(i), j) = KBANE2_KH(J8, j)
                Case 3
                    A5(i, j) = KBANE3_KH(J8, j)
                    A5(i + VK3(i), j) = KBANE3_KH(J8, j)
                Case 4
                    A5(i, j) = KBANE4_KH(J8, j)
                    A5(i + VK3(i), j) = KBANE4_KH(J8, j)
                Case 5
                    A5(i, j) = KBANE5_KH(J8, j)
                    A5(i + VK3(i), j) = KBANE5_KH(J8, j)
                Case 6
                    A5(i, j) = KBANE6_KH(J8, j)
                    A5(i + VK3(i), j) = KBANE6_KH(J8, j)
                Case 7
                    A5(i, j) = KBANE7_KH(J8, j)
                    A5(i + VK3(i), j) = KBANE7_KH(J8, j)
                Case 8
                    A5(i, j) = KBANE8_KH(J8, j)
                    A5(i + VK3(i), j) = KBANE8_KH(J8, j)
                Case 9
                    A5(i, j) = KBANE9_KH(J8, j)
                    A5(i + VK3(i), j) = KBANE9_KH(J8, j)
                Case 10
                    A5(i, j) = KBANE10_KH(J8, j)
                    A5(i + VK3(i), j) = KBANE10_KH(J8, j)
                Case } else {
                    A5(i, j) = KBANE1_KH(J8, j)
                    A5(i + VK3(i), j) = KBANE1_KH(J8, j)
                End Select
            }
        }
    }
    For( j = 1 To 4
        if ( A3(1, j) > -9000000000# ) {
            this.GGG(MAX_D)
            For( i = 1 To MAX_D
                GGG(i) = A3(i, j)
            }
            this.HOKAN9_N(MAX_D, AAA(), GGG(), 2)
            For( i = 1 To MAX_D
                A3(i, j) = GGG(i)
            }
        }
        if ( A4(1, j) > -9000000000# ) {
            this.GGG(MAX_D)
            For( i = 1 To MAX_D
                GGG(i) = A4(i, j)
            }
            this.HOKAN9_N(MAX_D, AAA(), GGG(), 2)
            For( i = 1 To MAX_D
                A4(i, j) = GGG(i)
            }
        }
    }
    For( j = 1 To 6
        if ( a2(1, j) > -9000000000# ) {
            this.GGG(MAX_D)
            For( i = 1 To MAX_D
                GGG(i) = a2(i, j)
            }
            this.HOKAN9_N(MAX_D, AAA(), GGG(), 5)
            For( i = 1 To MAX_D
                a2(i, j) = GGG(i)
            }
        }
    }
    For( j = 1 To 16
        if ( A5(1, j) > -9000000000# ) {
            this.GGG(MAX_D)
            For( i = 1 To MAX_D
                GGG(i) = A5(i, j)
            }
            this.HOKAN9_N(MAX_D, AAA(), GGG(), 0)
            For( i = 1 To MAX_D
                A5(i, j) = GGG(i)
            }
        }
    }
} else {
    MAX_D = 0
    this.a1(1)
    this.a2(1, 6)
    this.A3(1, 6)
    this.A4(1, 6)
    this.A5(1, 6)
    this.A6(1, 6)
    this.A7(1, 6)
}
//
EFEF: ////////10/05/12
}

private void KuiDataSet_G()   // Frame_Gouiki用
//
double var i
double var MAX_D
//
i = 1
this.PickGouikiKuiData(i, MAX_D, G1_AA1(), G1_AA2(), G1_AA3(), G1_AA4(), G1_AA5(), G1_AA6(), G1_AA7())
G_KuiDD(i) = MAX_D
i = i + 1
this.PickGouikiKuiData(i, MAX_D, G2_AA1(), G2_AA2(), G2_AA3(), G2_AA4(), G2_AA5(), G2_AA6(), G2_AA7())
G_KuiDD(i) = MAX_D
i = i + 1
this.PickGouikiKuiData(i, MAX_D, G3_AA1(), G3_AA2(), G3_AA3(), G3_AA4(), G3_AA5(), G3_AA6(), G3_AA7())
G_KuiDD(i) = MAX_D
i = i + 1
this.PickGouikiKuiData(i, MAX_D, G4_AA1(), G4_AA2(), G4_AA3(), G4_AA4(), G4_AA5(), G4_AA6(), G4_AA7())
G_KuiDD(i) = MAX_D
i = i + 1
this.PickGouikiKuiData(i, MAX_D, G5_AA1(), G5_AA2(), G5_AA3(), G5_AA4(), G5_AA5(), G5_AA6(), G5_AA7())
G_KuiDD(i) = MAX_D
i = i + 1
this.PickGouikiKuiData(i, MAX_D, G6_AA1(), G6_AA2(), G6_AA3(), G6_AA4(), G6_AA5(), G6_AA6(), G6_AA7())
G_KuiDD(i) = MAX_D
i = i + 1
this.PickGouikiKuiData(i, MAX_D, G7_AA1(), G7_AA2(), G7_AA3(), G7_AA4(), G7_AA5(), G7_AA6(), G7_AA7())
G_KuiDD(i) = MAX_D
i = i + 1
this.PickGouikiKuiData(i, MAX_D, G8_AA1(), G8_AA2(), G8_AA3(), G8_AA4(), G8_AA5(), G8_AA6(), G8_AA7())
G_KuiDD(i) = MAX_D
i = i + 1
this.PickGouikiKuiData(i, MAX_D, G9_AA1(), G9_AA2(), G9_AA3(), G9_AA4(), G9_AA5(), G9_AA6(), G9_AA7())
G_KuiDD(i) = MAX_D
i = i + 1
this.PickGouikiKuiData(i, MAX_D, G10_AA1(), G10_AA2(), G10_AA3(), G10_AA4(), G10_AA5(), G10_AA6(), G10_AA7())
G_KuiDD(i) = MAX_D
//
}

private void KuiDataSet_N_Sub1(N1_AAA() As Double, N1_QOT8() As Double, N1_QOT9() As Double, N1_QOT() As Double, N1_QQH() As Double, N1_QQV() As Double, N1_QOT2() As Double, N1_QQH2() As Double, N1_QQV2())
//
this.N1_AAA(1000)
this.N1_QOT8(1000)
this.N1_QOT9(1000)
this.N1_QOT(1000)
this.N1_QQH(1000)
this.N1_QQV(1000)
this.N1_QOT2(1000)
this.N1_QQH2(1000)
this.N1_QQV2(1000)
//
}

private void KuiDataSet_N_Sub2(KuiDD As Double, N1_AAA() As Double, N1_QOT8() As Double, N1_QOT9() As Double, N1_QOT() As Double, N1_QQH() As Double, N1_QQV() As Double, N1_QOT2() As Double, N1_QQH2() As Double, N1_QQV2())
//
this.Preserve N1_AAA(KuiDD)
this.Preserve N1_QOT8(KuiDD)
this.Preserve N1_QOT9(KuiDD)
this.Preserve N1_QOT(KuiDD)
this.Preserve N1_QQH(KuiDD)
this.Preserve N1_QQV(KuiDD)
this.Preserve N1_QOT2(KuiDD)
this.Preserve N1_QQH2(KuiDD)
this.Preserve N1_QQV2(KuiDD)
//
}

private void KuiDataSet_N_Sub3(KuiDD As Double, N1_QOT8() As Double, N1_QOT9() As Double, N1_AAA() As Double, N1_QOT() As Double, N1_QOT2() As Double, N1_QQH() As Double, N1_QQV() As Double, N1_QQH2() As Double, N1_QQV2())
//
this.MatSetLetNum(N1_QOT8(), N1_QOT())
this.MatSetLetNum(N1_QOT9(), N1_QOT2())
if ( N1_QOT(1) != -9000000000# ) {
    this.HOKAN9_N(KuiDD, N1_AAA(), N1_QOT(), 5)
}
if ( N1_QOT2(1) != -9000000000# ) {
    this.HOKAN9_N(KuiDD, N1_AAA(), N1_QOT2(), 5)
}
if ( N1_QQH(1) != -9000000000# ) {
    this.HOKAN9_N(KuiDD, N1_AAA(), N1_QQH(), 5)
}
if ( N1_QQV(1) != -9000000000# ) {
    this.HOKAN9_N(KuiDD, N1_AAA(), N1_QQV(), 5)
}
if ( N1_QQH2(1) != -9000000000# ) {
    this.HOKAN9_N(KuiDD, N1_AAA(), N1_QQH2(), 5)
}
if ( N1_QQV2(1) != -9000000000# ) {
    this.HOKAN9_N(KuiDD, N1_AAA(), N1_QQV2(), 5)
}
//
}

private void KuiDataSet_N()   // Frame用
//
double var KuiDD
double var i
double var R
double var MaxQ
//
For( i = 1 To 10
    N_KuiDD(i) = 0
}
i = 1
this.KuiDataSet_N_Sub1(N1_AAA(), N1_QOT8(), N1_QOT9(), N1_QOT(), N1_QQH(), N1_QQV(), N1_QOT2(), N1_QQH2(), N1_QQV2())
MaxQ = 0
this.FRUD150_Normal(MaxQ, N1_AAA(), N1_QOT(), N1_QQH(), N1_QQV(), N1_QOT2(), N1_QQH2(), N1_QQV2(), i, R)
KuiDD = MaxQ
this.KuiDataSet_N_Sub2(KuiDD, N1_AAA(), N1_QOT8(), N1_QOT9(), N1_QOT(), N1_QQH(), N1_QQV(), N1_QOT2(), N1_QQH2(), N1_QQV2())
N_KuiDD(i) = KuiDD
if ( KuiDD > 0 ) {
    this.KuiDataSet_N_Sub3(KuiDD, N1_QOT8(), N1_QOT9(), N1_AAA(), N1_QOT(), N1_QOT2(), N1_QQH(), N1_QQV(), N1_QQH2(), N1_QQV2())
}
//
i = i + 1
this.KuiDataSet_N_Sub1(N2_AAA(), N2_QOT8(), N2_QOT9(), N2_QOT(), N2_QQH(), N2_QQV(), N2_QOT2(), N2_QQH2(), N2_QQV2())
MaxQ = 0
this.FRUD150_Normal(MaxQ, N2_AAA(), N2_QOT(), N2_QQH(), N2_QQV(), N2_QOT2(), N2_QQH2(), N2_QQV2(), i, R)
KuiDD = MaxQ
this.KuiDataSet_N_Sub2(KuiDD, N2_AAA(), N2_QOT8(), N2_QOT9(), N2_QOT(), N2_QQH(), N2_QQV(), N2_QOT2(), N2_QQH2(), N2_QQV2())
N_KuiDD(i) = KuiDD
if ( KuiDD > 0 ) {
    this.KuiDataSet_N_Sub3(KuiDD, N2_QOT8(), N2_QOT9(), N2_AAA(), N2_QOT(), N2_QOT2(), N2_QQH(), N2_QQV(), N2_QQH2(), N2_QQV2())
}
//
i = i + 1
this.KuiDataSet_N_Sub1(N3_AAA(), N3_QOT8(), N3_QOT9(), N3_QOT(), N3_QQH(), N3_QQV(), N3_QOT2(), N3_QQH2(), N3_QQV2())
MaxQ = 0
this.FRUD150_Normal(MaxQ, N3_AAA(), N3_QOT(), N3_QQH(), N3_QQV(), N3_QOT2(), N3_QQH2(), N3_QQV2(), i, R)
KuiDD = MaxQ
this.KuiDataSet_N_Sub2(KuiDD, N3_AAA(), N3_QOT8(), N3_QOT9(), N3_QOT(), N3_QQH(), N3_QQV(), N3_QOT2(), N3_QQH2(), N3_QQV2())
N_KuiDD(i) = KuiDD
if ( KuiDD > 0 ) {
    this.KuiDataSet_N_Sub3(KuiDD, N3_QOT8(), N3_QOT9(), N3_AAA(), N3_QOT(), N3_QOT2(), N3_QQH(), N3_QQV(), N3_QQH2(), N3_QQV2())
}
//
i = i + 1
this.KuiDataSet_N_Sub1(N4_AAA(), N4_QOT8(), N4_QOT9(), N4_QOT(), N4_QQH(), N4_QQV(), N4_QOT2(), N4_QQH2(), N4_QQV2())
MaxQ = 0
this.FRUD150_Normal(MaxQ, N4_AAA(), N4_QOT(), N4_QQH(), N4_QQV(), N4_QOT2(), N4_QQH2(), N4_QQV2(), i, R)
KuiDD = MaxQ
this.KuiDataSet_N_Sub2(KuiDD, N4_AAA(), N4_QOT8(), N4_QOT9(), N4_QOT(), N4_QQH(), N4_QQV(), N4_QOT2(), N4_QQH2(), N4_QQV2())
N_KuiDD(i) = KuiDD
if ( KuiDD > 0 ) {
    this.KuiDataSet_N_Sub3(KuiDD, N4_QOT8(), N4_QOT9(), N4_AAA(), N4_QOT(), N4_QOT2(), N4_QQH(), N4_QQV(), N4_QQH2(), N4_QQV2())
}
//
i = i + 1
this.KuiDataSet_N_Sub1(N5_AAA(), N5_QOT8(), N5_QOT9(), N5_QOT(), N5_QQH(), N5_QQV(), N5_QOT2(), N5_QQH2(), N5_QQV2())
MaxQ = 0
this.FRUD150_Normal(MaxQ, N5_AAA(), N5_QOT(), N5_QQH(), N5_QQV(), N5_QOT2(), N5_QQH2(), N5_QQV2(), i, R)
KuiDD = MaxQ
this.KuiDataSet_N_Sub2(KuiDD, N5_AAA(), N5_QOT8(), N5_QOT9(), N5_QOT(), N5_QQH(), N5_QQV(), N5_QOT2(), N5_QQH2(), N5_QQV2())
N_KuiDD(i) = KuiDD
if ( KuiDD > 0 ) {
    this.KuiDataSet_N_Sub3(KuiDD, N5_QOT8(), N5_QOT9(), N5_AAA(), N5_QOT(), N5_QOT2(), N5_QQH(), N5_QQV(), N5_QQH2(), N5_QQV2())
}
//
i = i + 1
this.KuiDataSet_N_Sub1(N6_AAA(), N6_QOT8(), N6_QOT9(), N6_QOT(), N6_QQH(), N6_QQV(), N6_QOT2(), N6_QQH2(), N6_QQV2())
MaxQ = 0
this.FRUD150_Normal(MaxQ, N6_AAA(), N6_QOT(), N6_QQH(), N6_QQV(), N6_QOT2(), N6_QQH2(), N6_QQV2(), i, R)
KuiDD = MaxQ
this.KuiDataSet_N_Sub2(KuiDD, N6_AAA(), N6_QOT8(), N6_QOT9(), N6_QOT(), N6_QQH(), N6_QQV(), N6_QOT2(), N6_QQH2(), N6_QQV2())
N_KuiDD(i) = KuiDD
if ( KuiDD > 0 ) {
    this.KuiDataSet_N_Sub3(KuiDD, N6_QOT8(), N6_QOT9(), N6_AAA(), N6_QOT(), N6_QOT2(), N6_QQH(), N6_QQV(), N6_QQH2(), N6_QQV2())
}
//
i = i + 1
this.KuiDataSet_N_Sub1(N7_AAA(), N7_QOT8(), N7_QOT9(), N7_QOT(), N7_QQH(), N7_QQV(), N7_QOT2(), N7_QQH2(), N7_QQV2())
MaxQ = 0
this.FRUD150_Normal(MaxQ, N7_AAA(), N7_QOT(), N7_QQH(), N7_QQV(), N7_QOT2(), N7_QQH2(), N7_QQV2(), i, R)
KuiDD = MaxQ
this.KuiDataSet_N_Sub2(KuiDD, N7_AAA(), N7_QOT8(), N7_QOT9(), N7_QOT(), N7_QQH(), N7_QQV(), N7_QOT2(), N7_QQH2(), N7_QQV2())
N_KuiDD(i) = KuiDD
if ( KuiDD > 0 ) {
    this.KuiDataSet_N_Sub3(KuiDD, N7_QOT8(), N7_QOT9(), N7_AAA(), N7_QOT(), N7_QOT2(), N7_QQH(), N7_QQV(), N7_QQH2(), N7_QQV2())
}
//
i = i + 1
this.KuiDataSet_N_Sub1(N8_AAA(), N8_QOT8(), N8_QOT9(), N8_QOT(), N8_QQH(), N8_QQV(), N8_QOT2(), N8_QQH2(), N8_QQV2())
MaxQ = 0
this.FRUD150_Normal(MaxQ, N8_AAA(), N8_QOT(), N8_QQH(), N8_QQV(), N8_QOT2(), N8_QQH2(), N8_QQV2(), i, R)
KuiDD = MaxQ
this.KuiDataSet_N_Sub2(KuiDD, N8_AAA(), N8_QOT8(), N8_QOT9(), N8_QOT(), N8_QQH(), N8_QQV(), N8_QOT2(), N8_QQH2(), N8_QQV2())
N_KuiDD(i) = KuiDD
if ( KuiDD > 0 ) {
    this.KuiDataSet_N_Sub3(KuiDD, N8_QOT8(), N8_QOT9(), N8_AAA(), N8_QOT(), N8_QOT2(), N8_QQH(), N8_QQV(), N8_QQH2(), N8_QQV2())
}
//
i = i + 1
this.KuiDataSet_N_Sub1(N9_AAA(), N9_QOT8(), N9_QOT9(), N9_QOT(), N9_QQH(), N9_QQV(), N9_QOT2(), N9_QQH2(), N9_QQV2())
MaxQ = 0
this.FRUD150_Normal(MaxQ, N9_AAA(), N9_QOT(), N9_QQH(), N9_QQV(), N9_QOT2(), N9_QQH2(), N9_QQV2(), i, R)
KuiDD = MaxQ
this.KuiDataSet_N_Sub2(KuiDD, N9_AAA(), N9_QOT8(), N9_QOT9(), N9_QOT(), N9_QQH(), N9_QQV(), N9_QOT2(), N9_QQH2(), N9_QQV2())
N_KuiDD(i) = KuiDD
if ( KuiDD > 0 ) {
    this.KuiDataSet_N_Sub3(KuiDD, N9_QOT8(), N9_QOT9(), N9_AAA(), N9_QOT(), N9_QOT2(), N9_QQH(), N9_QQV(), N9_QQH2(), N9_QQV2())
}
//
i = i + 1
this.KuiDataSet_N_Sub1(N10_AAA(), N10_QOT8(), N10_QOT9(), N10_QOT(), N10_QQH(), N10_QQV(), N10_QOT2(), N10_QQH2(), N10_QQV2())
MaxQ = 0
this.FRUD150_Normal(MaxQ, N10_AAA(), N10_QOT(), N10_QQH(), N10_QQV(), N10_QOT2(), N10_QQH2(), N10_QQV2(), i, R)
KuiDD = MaxQ
this.KuiDataSet_N_Sub2(KuiDD, N10_AAA(), N10_QOT8(), N10_QOT9(), N10_QOT(), N10_QQH(), N10_QQV(), N10_QOT2(), N10_QQH2(), N10_QQV2())
N_KuiDD(i) = KuiDD
if ( KuiDD > 0 ) {
    this.KuiDataSet_N_Sub3(KuiDD, N1_QOT8(), N1_QOT9(), N1_AAA(), N1_QOT(), N1_QOT2(), N1_QQH(), N1_QQV(), N1_QQH2(), N1_QQV2())
}
if ( N_KuiDD(1) > 0 ) {
    this.KuiDataSet_N_Sub(N_KuiDD(1), 1, N1_AAA(), N1_BANE())    // Frame用
}
if ( N_KuiDD(2) > 0 ) {
    this.KuiDataSet_N_Sub(N_KuiDD(2), 2, N2_AAA(), N2_BANE())    // Frame用
}
if ( N_KuiDD(3) > 0 ) {
    this.KuiDataSet_N_Sub(N_KuiDD(3), 3, N3_AAA(), N3_BANE())    // Frame用
}
if ( N_KuiDD(4) > 0 ) {
    this.KuiDataSet_N_Sub(N_KuiDD(4), 4, N4_AAA(), N4_BANE())    // Frame用
}
if ( N_KuiDD(5) > 0 ) {
    this.KuiDataSet_N_Sub(N_KuiDD(5), 5, N5_AAA(), N5_BANE())    // Frame用
}
if ( N_KuiDD(6) > 0 ) {
    this.KuiDataSet_N_Sub(N_KuiDD(6), 6, N6_AAA(), N6_BANE())    // Frame用
}
if ( N_KuiDD(7) > 0 ) {
    this.KuiDataSet_N_Sub(N_KuiDD(7), 7, N7_AAA(), N7_BANE())    // Frame用
}
if ( N_KuiDD(8) > 0 ) {
    this.KuiDataSet_N_Sub(N_KuiDD(8), 8, N8_AAA(), N8_BANE())    // Frame用
}
if ( N_KuiDD(9) > 0 ) {
    this.KuiDataSet_N_Sub(N_KuiDD(9), 9, N9_AAA(), N9_BANE())    // Frame用
}
if ( N_KuiDD(10) > 0 ) {
    this.KuiDataSet_N_Sub(N_KuiDD(10), 10, N10_AAA(), N10_BANE())    // Frame用
}
//
}

private void KuiDataSet_N_Sub(MAX_D As Double, N As Double, AAA() As Double, A5())  // Frame用
//
double var i
double var j
double var L88
double var N88
double var GGG()
//
this.A5(MAX_D, 16)
For( j = 1 To 16
    L88 = 0
    N88 = 0
    For( i = 1 To MAX_D
        if ( L88 = AAA(i) ) {
            N88 = N88 + 1
            A5(i, j) = KBANE1_KH(N88, j)
        } else {
            A5(i, j) = KBANE1_KH(N88, j)
        }
        L88 = AAA(i)
    }
}
For( j = 1 To 16
    if ( A5(1, j) > -9000000000# ) {
        this.GGG(MAX_D)
        For( i = 1 To MAX_D
            GGG(i) = A5(i, j)
        }
        this.HOKAN9_N(MAX_D, AAA(), GGG(), 0)
        For( i = 1 To MAX_D
            A5(i, j) = GGG(i)
        }
    }
}
//
}

private void SETINIT_DD(OutouKui())
//
double var i
double var MaxS
//
MaxS = UBound(OutouKui(), 1)
For( i = 1 To MaxS
    OutouKui(i) = -9000000000#
}
//
}

private void RESET_07()
//
this.OutouKui1(1000)
this.OutouKui2(1000)
this.OutouKui3(1000)
this.OutouKui4(1000)
this.OutouKui5(1000)
this.OutouKui6(1000)
this.OutouKui7(1000)
this.OutouKui8(1000)
this.OutouKui9(1000)
this.OutouKui10(1000)
this.XOutouKui1(1000)
this.XOutouKui2(1000)
this.XOutouKui3(1000)
this.XOutouKui4(1000)
this.XOutouKui5(1000)
this.XOutouKui6(1000)
this.XOutouKui7(1000)
this.XOutouKui8(1000)
this.XOutouKui9(1000)
this.XOutouKui10(1000)
this.SETINIT_DD(OutouKui1())
this.SETINIT_DD(OutouKui2())
this.SETINIT_DD(OutouKui3())
this.SETINIT_DD(OutouKui4())
this.SETINIT_DD(OutouKui5())
this.SETINIT_DD(OutouKui6())
this.SETINIT_DD(OutouKui7())
this.SETINIT_DD(OutouKui8())
this.SETINIT_DD(OutouKui9())
this.SETINIT_DD(OutouKui10())
this.SETINIT_DD(XOutouKui1())
this.SETINIT_DD(XOutouKui2())
this.SETINIT_DD(XOutouKui3())
this.SETINIT_DD(XOutouKui4())
this.SETINIT_DD(XOutouKui5())
this.SETINIT_DD(XOutouKui6())
this.SETINIT_DD(XOutouKui7())
this.SETINIT_DD(XOutouKui8())
this.SETINIT_DD(XOutouKui9())
this.SETINIT_DD(XOutouKui10())
CheckIn1 = 0
XKui1 = 0
XKui2 = 0
XKui3 = 0
XKui4 = 0
XKui5 = 0
XKui6 = 0
XKui7 = 0
XKui8 = 0
XKui9 = 0
XKui10 = 0
F7MAX_R = 0
this.F7ML1(0)
this.F7ML2(0)
this.F7ML3(0)
this.F7ML(0)
this.F7ML31(0)
this.F7ML4(0)
this.F7ML5(0)
this.F7ML6(0)
this.F7OUTOU(0)
this.F7BANE(0)
this.KBANE1_L(0)
this.KBANE1_KH(0)
this.KBANE1_KSV(0)
this.KBANE2_L(0)
this.KBANE2_KH(0)
this.KBANE2_KSV(0)
this.KBANE3_L(0)
this.KBANE3_KH(0)
this.KBANE3_KSV(0)
this.KBANE4_L(0)
this.KBANE4_KH(0)
this.KBANE4_KSV(0)
this.KBANE5_L(0)
this.KBANE5_KH(0)
this.KBANE5_KSV(0)
this.KBANE6_L(0)
this.KBANE6_KH(0)
this.KBANE6_KSV(0)
this.KBANE7_L(0)
this.KBANE7_KH(0)
this.KBANE7_KSV(0)
this.KBANE8_L(0)
this.KBANE8_KH(0)
this.KBANE8_KSV(0)
this.KBANE9_L(0)
this.KBANE9_KH(0)
this.KBANE9_KSV(0)
this.KBANE10_L(0)
this.KBANE10_KH(0)
this.KBANE10_KSV(0)
//
}

private void RESET_07_1()
//
this.KBANE1_L(0)
this.KBANE1_KH(0)
this.KBANE1_KSV(0)
this.KBANE2_L(0)
this.KBANE2_KH(0)
this.KBANE2_KSV(0)
this.KBANE3_L(0)
this.KBANE3_KH(0)
this.KBANE3_KSV(0)
this.KBANE4_L(0)
this.KBANE4_KH(0)
this.KBANE4_KSV(0)
this.KBANE5_L(0)
this.KBANE5_KH(0)
this.KBANE5_KSV(0)
this.KBANE6_L(0)
this.KBANE6_KH(0)
this.KBANE6_KSV(0)
this.KBANE7_L(0)
this.KBANE7_KH(0)
this.KBANE7_KSV(0)
this.KBANE8_L(0)
this.KBANE8_KH(0)
this.KBANE8_KSV(0)
this.KBANE9_L(0)
this.KBANE9_KH(0)
this.KBANE9_KSV(0)
this.KBANE10_L(0)
this.KBANE10_KH(0)
this.KBANE10_KSV(0)
//
}

private void RESET_07_2()
//
this.OutouKui1(0)
this.OutouKui2(0)
this.OutouKui3(0)
this.OutouKui4(0)
this.OutouKui5(0)
this.OutouKui6(0)
this.OutouKui7(0)
this.OutouKui8(0)
this.OutouKui9(0)
this.OutouKui10(0)
this.XOutouKui1(0)
this.XOutouKui2(0)
this.XOutouKui3(0)
this.XOutouKui4(0)
this.XOutouKui5(0)
this.XOutouKui6(0)
this.XOutouKui7(0)
this.XOutouKui8(0)
this.XOutouKui9(0)
this.XOutouKui10(0)
//
}

private void RESET_OUTOU_Gouiki()
//
this.G1_AA1(0)    // For( Gouiki
this.G1_AA2(0)    // For( Gouiki
this.G1_AA3(0)    // For( Gouiki
this.G1_AA4(0)    // For( Gouiki
this.G1_AA5(0)    // For( Gouiki
this.G1_AA6(0)    // For( Gouiki
this.G1_AA7(0)    // For( Gouiki
this.G2_AA1(0)    // For( Gouiki
this.G2_AA2(0)    // For( Gouiki
this.G2_AA3(0)    // For( Gouiki
this.G2_AA4(0)    // For( Gouiki
this.G2_AA5(0)    // For( Gouiki
this.G2_AA6(0)    // For( Gouiki
this.G2_AA7(0)    // For( Gouiki
this.G3_AA1(0)    // For( Gouiki
this.G3_AA2(0)    // For( Gouiki
this.G3_AA3(0)    // For( Gouiki
this.G3_AA4(0)    // For( Gouiki
this.G3_AA5(0)    // For( Gouiki
this.G3_AA6(0)    // For( Gouiki
this.G3_AA7(0)    // For( Gouiki
this.G4_AA1(0)    // For( Gouiki
this.G4_AA2(0)    // For( Gouiki
this.G4_AA3(0)    // For( Gouiki
this.G4_AA4(0)    // For( Gouiki
this.G4_AA5(0)    // For( Gouiki
this.G4_AA6(0)    // For( Gouiki
this.G4_AA7(0)    // For( Gouiki
this.G5_AA1(0)    // For( Gouiki
this.G5_AA2(0)    // For( Gouiki
this.G5_AA3(0)    // For( Gouiki
this.G5_AA4(0)    // For( Gouiki
this.G5_AA5(0)    // For( Gouiki
this.G5_AA6(0)    // For( Gouiki
this.G5_AA7(0)    // For( Gouiki
this.G6_AA1(0)    // For( Gouiki
this.G6_AA2(0)    // For( Gouiki
this.G6_AA3(0)    // For( Gouiki
this.G6_AA4(0)    // For( Gouiki
this.G6_AA5(0)    // For( Gouiki
this.G6_AA6(0)    // For( Gouiki
this.G6_AA7(0)    // For( Gouiki
this.G7_AA1(0)    // For( Gouiki
this.G7_AA2(0)    // For( Gouiki
this.G7_AA3(0)    // For( Gouiki
this.G7_AA4(0)    // For( Gouiki
this.G7_AA5(0)    // For( Gouiki
this.G7_AA6(0)    // For( Gouiki
this.G7_AA7(0)    // For( Gouiki
this.G8_AA1(0)    // For( Gouiki
this.G8_AA2(0)    // For( Gouiki
this.G8_AA3(0)    // For( Gouiki
this.G8_AA4(0)    // For( Gouiki
this.G8_AA5(0)    // For( Gouiki
this.G8_AA6(0)    // For( Gouiki
this.G8_AA7(0)    // For( Gouiki
this.G9_AA1(0)    // For( Gouiki
this.G9_AA2(0)    // For( Gouiki
this.G9_AA3(0)    // For( Gouiki
this.G9_AA4(0)    // For( Gouiki
this.G9_AA5(0)    // For( Gouiki
this.G9_AA6(0)    // For( Gouiki
this.G9_AA7(0)    // For( Gouiki
this.G10_AA1(0)   // For( Gouiki
this.G10_AA2(0)   // For( Gouiki
this.G10_AA3(0)   // For( Gouiki
this.G10_AA4(0)   // For( Gouiki
this.G10_AA5(0)   // For( Gouiki
this.G10_AA6(0)   // For( Gouiki
this.G10_AA7(0)   // For( Gouiki
//
}

private void RESET_OUTOU_Normal()
//
this.N1_BANE(0)
this.N2_BANE(0)
this.N3_BANE(0)
this.N4_BANE(0)
this.N5_BANE(0)
this.N6_BANE(0)
this.N7_BANE(0)
this.N8_BANE(0)
this.N9_BANE(0)
this.N10_BANE(0)
this.N1_AAA(0)                // Normal Frame
this.N1_QOT8(0)               // Normal Frame
this.N1_QOT9(0)               // Normal Frame
this.N1_QOT(0)                // Normal Frame
this.N1_QQH(0)                // Normal Frame
this.N1_QQV(0)                // Normal Frame
this.N1_QOT2(0)               // Normal Frame
this.N1_QQH2(0)               // Normal Frame
this.N1_QQV2(0)               // Normal Frame
this.N2_AAA(0)                // Normal Frame
this.N2_QOT8(0)               // Normal Frame
this.N2_QOT9(0)               // Normal Frame
this.N2_QOT(0)                // Normal Frame
this.N2_QQH(0)                // Normal Frame
this.N2_QQV(0)                // Normal Frame
this.N2_QOT2(0)               // Normal Frame
this.N2_QQH2(0)               // Normal Frame
this.N2_QQV2(0)               // Normal Frame
this.N3_AAA(0)                // Normal Frame
this.N3_QOT8(0)               // Normal Frame
this.N3_QOT9(0)               // Normal Frame
this.N3_QOT(0)                // Normal Frame
this.N3_QQH(0)                // Normal Frame
this.N3_QQV(0)                // Normal Frame
this.N3_QOT2(0)               // Normal Frame
this.N3_QQH2(0)               // Normal Frame
this.N3_QQV2(0)               // Normal Frame
this.N4_AAA(0)                // Normal Frame
this.N4_QOT8(0)               // Normal Frame
this.N4_QOT9(0)               // Normal Frame
this.N4_QOT(0)                // Normal Frame
this.N4_QQH(0)                // Normal Frame
this.N4_QQV(0)                // Normal Frame
this.N4_QOT2(0)               // Normal Frame
this.N4_QQH2(0)               // Normal Frame
this.N4_QQV2(0)               // Normal Frame
this.N5_AAA(0)                // Normal Frame
this.N5_QOT8(0)               // Normal Frame
this.N5_QOT9(0)               // Normal Frame
this.N5_QOT(0)                // Normal Frame
this.N5_QQH(0)                // Normal Frame
this.N5_QQV(0)                // Normal Frame
this.N5_QOT2(0)               // Normal Frame
this.N5_QQH2(0)               // Normal Frame
this.N5_QQV2(0)               // Normal Frame
this.N6_AAA(0)                // Normal Frame
this.N6_QOT8(0)               // Normal Frame
this.N6_QOT9(0)               // Normal Frame
this.N6_QOT(0)                // Normal Frame
this.N6_QQH(0)                // Normal Frame
this.N6_QQV(0)                // Normal Frame
this.N6_QOT2(0)               // Normal Frame
this.N6_QQH2(0)               // Normal Frame
this.N6_QQV2(0)               // Normal Frame
this.N7_AAA(0)                // Normal Frame
this.N7_QOT8(0)               // Normal Frame
this.N7_QOT9(0)               // Normal Frame
this.N7_QOT(0)                // Normal Frame
this.N7_QQH(0)                // Normal Frame
this.N7_QQV(0)                // Normal Frame
this.N7_QOT2(0)               // Normal Frame
this.N7_QQH2(0)               // Normal Frame
this.N7_QQV2(0)               // Normal Frame
this.N8_AAA(0)                // Normal Frame
this.N8_QOT8(0)               // Normal Frame
this.N8_QOT9(0)               // Normal Frame
this.N8_QOT(0)                // Normal Frame
this.N8_QQH(0)                // Normal Frame
this.N8_QQV(0)                // Normal Frame
this.N8_QOT2(0)               // Normal Frame
this.N8_QQH2(0)               // Normal Frame
this.N8_QQV2(0)               // Normal Frame
this.N9_AAA(0)                // Normal Frame
this.N9_QOT8(0)               // Normal Frame
this.N9_QOT9(0)               // Normal Frame
this.N9_QOT(0)                // Normal Frame
this.N9_QQH(0)                // Normal Frame
this.N9_QQV(0)                // Normal Frame
this.N9_QOT2(0)               // Normal Frame
this.N9_QQH2(0)               // Normal Frame
this.N9_QQV2(0)               // Normal Frame
this.N10_AAA(0)               // Normal Frame
this.N10_QOT8(0)              // Normal Frame
this.N10_QOT9(0)              // Normal Frame
this.N10_QOT(0)               // Normal Frame
this.N10_QQH(0)               // Normal Frame
this.N10_QQV(0)               // Normal Frame
this.N10_QOT2(0)              // Normal Frame
this.N10_QQH2(0)              // Normal Frame
this.N10_QQV2(0)              // Normal Frame
//
}

private Function SMAX(Param1 As Double, Param2)
//
if ( Param1 > Param2 ) {
    SMAX = Param1
} else {
    if ( Param1 < Param2 ) {
        SMAX = Param2
    } else {
        SMAX = Param1
    }
}
//
}

private Function SMin(Param1 As Double, Param2 As Double)
//
if ( Param1 > Param2 ) {
    SMin = Param2
} else {
    if ( Param1 < Param2 ) {
        SMin = Param1
    } else {
        SMin = Param1
    }
}
//
}

private void ReadData147()
//
double var i
double var MAX_R
double var R
//
this.KBANEMAX(10)
For( i = 1 To 10
    KBANEMAX(i) = 0
}
i = 1
this.FRUD147_BBB(MAX_R, KBANE1_L(), KBANE1_KH(), KBANE1_KSV(), i, R)
KBANEMAX(i) = MAX_R
i = i + 1
this.FRUD147_BBB(MAX_R, KBANE2_L(), KBANE2_KH(), KBANE2_KSV(), i, R)
KBANEMAX(i) = MAX_R
i = i + 1
this.FRUD147_BBB(MAX_R, KBANE3_L(), KBANE3_KH(), KBANE3_KSV(), i, R)
KBANEMAX(i) = MAX_R
i = i + 1
this.FRUD147_BBB(MAX_R, KBANE4_L(), KBANE4_KH(), KBANE4_KSV(), i, R)
KBANEMAX(i) = MAX_R
i = i + 1
this.FRUD147_BBB(MAX_R, KBANE5_L(), KBANE5_KH(), KBANE5_KSV(), i, R)
KBANEMAX(i) = MAX_R
i = i + 1
this.FRUD147_BBB(MAX_R, KBANE6_L(), KBANE6_KH(), KBANE6_KSV(), i, R)
KBANEMAX(i) = MAX_R
i = i + 1
this.FRUD147_BBB(MAX_R, KBANE7_L(), KBANE7_KH(), KBANE7_KSV(), i, R)
KBANEMAX(i) = MAX_R
i = i + 1
this.FRUD147_BBB(MAX_R, KBANE8_L(), KBANE8_KH(), KBANE8_KSV(), i, R)
KBANEMAX(i) = MAX_R
i = i + 1
this.FRUD147_BBB(MAX_R, KBANE9_L(), KBANE9_KH(), KBANE9_KSV(), i, R)
KBANEMAX(i) = MAX_R
i = i + 1
this.FRUD147_BBB(MAX_R, KBANE10_L(), KBANE10_KH(), KBANE10_KSV(), i, R)
KBANEMAX(i) = MAX_R
//
}

private void Reset_KajuuZu()
//
double var i
//
//    AttaG = 0
if ( gouikidddd = 1 $$ AttaG = 1 ) {
    For( i = 1 To 1000
        WAWAWA(i) = -9000000000#
        ITAN1(i) = -9000000000#
        JTAN1(i) = -9000000000#
        iiii(i) = -9000000000#
        JJJJ(i) = -9000000000#
        YYYY1(i) = -9000000000#
        YYYY2(i) = -9000000000#
        XXXX1(i) = -9000000000#
        XXXX2(i) = -9000000000#
    }
    For( i = 1 To 2000
        WAXX(i) = -9000000000#
        WAYY(i) = -9000000000#
    }
}
//
}

private void Buzai_HEN()
//
var GOSA                    As Single
double var i
double var ZX1()
double var ZY1()
double var ZX2()
double var ZY2()
double var ZZZ1
//
GOSA = 10
this.ZX1(部材_max)
this.ZY1(部材_max)
this.ZX2(部材_max)
this.ZY2(部材_max)
For( i = 1 To 部材_max
    if ( ZZBuzaiBai(i) != 0 ) {
    ZX1(i) = XXXX1(i)
    ZX2(i) = XXXX2(i)
    ZY1(i) = YYYY1(i)
    ZY2(i) = YYYY2(i)
    if ( ZX1(i) = ZX2(i) ) {
        BuzaiH(i) = 1
    } else {
        if ( ZY1(i) = ZY2(i) ) {
            BuzaiH(i) = 2
        } else {
            ZZZ1 = Int(CheckLineXXX1(ZX1(i), ZX2(i), ZY1(i), ZY2(i)))
            if ( ZZZ1 > 0 - GOSA $$ ZZZ1 < 0 + GOSA ) {
                BuzaiH(i) = 2
            } else {
                if ( ZZZ1 > 90 - GOSA $$ ZZZ1 < 90 + GOSA ) {
                    BuzaiH(i) = 1
                } else {
                    BuzaiH(i) = 0
                }
            }
        }
    }
    }
}
//
}

private void Out_OuTou_N(HH As Integer)      // Frame
//
double var N
double var CA
double var KuiMaxX
//
CA = Int(F7ML5(HH))
if ( CA < 1 || CA > 16 ) {
    return;
}
CheckIn1 = CheckIn1 + 1
KuiMaxX = 99999999
LeftKuibuzaiNumber = 0
For( N = 1 To 部材_max
    if ( ZZBuzaiBai(N) != 0 ) {
    if ( InStr(Trim(部材名(N)), "杭") > 0 ) {
        if ( KuiBuzaiX(1, N) > -9000000000# $$ KuiBuzaiX(2, N) > -9000000000# ) {
            if ( KuiBuzaiX(1, N) < KuiMaxX || KuiBuzaiX(2, N) < KuiMaxX ) {
                LeftKuibuzaiNumber = N
                KuiMaxX = SMin(KuiBuzaiX(1, N), KuiMaxX)
                KuiMaxX = SMin(KuiBuzaiX(2, N), KuiMaxX)
            }
        }
    }
    }
Next N
For( N = 1 To 部材_max
    if ( ZZBuzaiBai(N) != 0 ) {
    if ( InStr(Trim(部材名(N)), "杭") > 0 ) {
        this.Out_OuTou_N1(N, CA)
    }
    }
Next N
//
}

private Function PickOutouN(KuiNN As Double, i As Double, CA As Double)
//
double var temp
//
Select Case CA
Case 3
    Select Case KuiNN
    Case 1
        temp = N1_QOT(i)
    Case 2
        temp = N2_QOT(i)
    Case 3
        temp = N3_QOT(i)
    Case 4
        temp = N4_QOT(i)
    Case 5
        temp = N5_QOT(i)
    Case 6
        temp = N6_QOT(i)
    Case 7
        temp = N7_QOT(i)
    Case 8
        temp = N8_QOT(i)
    Case 9
        temp = N9_QOT(i)
    Case 10
        temp = N10_QOT(i)
    Case } else {
        temp = N1_QOT(i)
    End Select
Case 4
    Select Case KuiNN
    Case 1
        temp = N1_QOT2(i)
    Case 2
        temp = N2_QOT2(i)
    Case 3
        temp = N3_QOT2(i)
    Case 4
        temp = N4_QOT2(i)
    Case 5
        temp = N5_QOT2(i)
    Case 6
        temp = N6_QOT2(i)
    Case 7
        temp = N7_QOT2(i)
    Case 8
        temp = N8_QOT2(i)
    Case 9
        temp = N9_QOT2(i)
    Case 10
        temp = N10_QOT2(i)
    Case } else {
        temp = N1_QOT2(i)
    End Select
Case } else {
    Select Case KuiNN
    Case 1
        temp = N1_QOT(i)
    Case 2
        temp = N2_QOT(i)
    Case 3
        temp = N3_QOT(i)
    Case 4
        temp = N4_QOT(i)
    Case 5
        temp = N5_QOT(i)
    Case 6
        temp = N6_QOT(i)
    Case 7
        temp = N7_QOT(i)
    Case 8
        temp = N8_QOT(i)
    Case 9
        temp = N9_QOT(i)
    Case 10
        temp = N10_QOT(i)
    Case } else {
        temp = N1_QOT(i)
    End Select
End Select
PickOutouN = temp
//
}

private Function PickBaneN(KuiNN As Double, i As Double, CA As Double)
//
double var temp
//
//    Select Case CA
//    Case 3
//        Select Case KuiNN
//        Case 1
//            temp = N1_BANE(i, 3)
//        Case 2
//            temp = N2_BANE(i, 3)
//        Case 3
//            temp = N3_BANE(i, 3)
//        Case 4
//            temp = N4_BANE(i, 3)
//        Case 5
//            temp = N5_BANE(i, 3)
//        Case 6
//            temp = N6_BANE(i, 3)
//        Case 7
//            temp = N7_BANE(i, 3)
//        Case 8
//            temp = N8_BANE(i, 3)
//        Case 9
//            temp = N9_BANE(i, 3)
//        Case 10
//            temp = N10_BANE(i, 3)
//        Case } else {
//            temp = N1_BANE(i, 3)
//        End Select
//    Case 4
//        Select Case KuiNN
//        Case 1
//            temp = N1_BANE(i, 4)
//        Case 2
//            temp = N2_BANE(i, 4)
//        Case 3
//            temp = N3_BANE(i, 4)
//        Case 4
//            temp = N4_BANE(i, 4)
//        Case 5
//            temp = N5_BANE(i, 4)
//        Case 6
//            temp = N6_BANE(i, 4)
//        Case 7
//            temp = N7_BANE(i, 4)
//        Case 8
//            temp = N8_BANE(i, 4)
//        Case 9
//            temp = N9_BANE(i, 4)
//        Case 10
//            temp = N10_BANE(i, 4)
//        Case } else {
//            temp = N1_BANE(i, 4)
//        End Select
//    Case } else {
    Select Case KuiNN ////////////////////////////////////////////////05/05/27
    Case 1
        temp = N1_BANE(i, CA)
    Case 2
        temp = N2_BANE(i, CA)
    Case 3
        temp = N3_BANE(i, CA)
    Case 4
        temp = N4_BANE(i, CA)
    Case 5
        temp = N5_BANE(i, CA)
    Case 6
        temp = N6_BANE(i, CA)
    Case 7
        temp = N7_BANE(i, CA)
    Case 8
        temp = N8_BANE(i, CA)
    Case 9
        temp = N9_BANE(i, CA)
    Case 10
        temp = N10_BANE(i, CA)
    Case } else {
        temp = N1_BANE(i, CA)
    End Select
//    End Select
PickBaneN = temp
//
}

private Function PickAAA_N(KuiNN As Double, i As Double)
//
double var temp
//
Select Case KuiNN
Case 1
    temp = N1_AAA(i)
Case 2
    temp = N2_AAA(i)
Case 3
    temp = N3_AAA(i)
Case 4
    temp = N4_AAA(i)
Case 5
    temp = N5_AAA(i)
Case 6
    temp = N6_AAA(i)
Case 7
    temp = N7_AAA(i)
Case 8
    temp = N8_AAA(i)
Case 9
    temp = N9_AAA(i)
Case 10
    temp = N10_AAA(i)
Case } else {
    temp = N1_AAA(i)
End Select
PickAAA_N = temp
//
}

private void Out_OuTou_N1(N As Double, CA)      // Frame
//
double var LLL
double var KuiNN
double var KuiMax
double var i
double var X1
double var y1
double var X2
double var Y2
double var HiRiTsu
double var HiRiTsu1
var ZFX1                    As Single
var ZFY1                    As Single
var MojiZFX1                As Single
var MojiZFY1                As Single
var ZFX2                    As Single
var ZFY2                    As Single
var AZFX2                   As Single
var AZFY2                   As Single
double var GGG
double var Value1
double var Value2
double var Value3
double var OutouValue()
double var OutouAAA()
double var OutouFlag()
var TTT                     As Variant
var LINETYPE()              As Integer
double var FFStartX
double var FFStartY
double var UpXXX
double var DownXXX
double var YYYYY1
double var YYYYY2
double var HHH
var HH1                     As Single
double var SouMax
double var HHHZ1()
var HHHZ2()                 As Single
double var j
double var MeterAtari
double var FFKuiMaxLen
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
var QWX1                    As Single
var QWY1                    As Single
double Const OutouXXBai            = 0.8
double Const Add5                  = 5
//
if ( SuiheiBaneEqual = 1 ) {
    this.Out_OuTou_N2(N, CA)        // Frame
    return;
}
HiRiTsu = 1
HiRiTsu1 = 10
LLL = 0
if ( Len(Trim(部材名(N))) = 1 ) {
    KuiNN = 1
} else {
    KuiNN = val(Mid(Trim(部材名(N)), 2, Len(Trim(部材名(N))) - 1))
}
if ( CheckIn1 = 1 ) {
    this.CheckKuiGroup(KuiNN, N)
}
KuiMax = N_KuiDD(KuiNN)
KuiLengthMax = SMAX(KuiLengthMax, PickAAA_N(KuiNN, KuiMax))
this.LINETYPE(KuiMax)
this.OutouValue(KuiMax)
this.OutouFlag(KuiMax)
this.OutouAAA(KuiMax)
this.HHHZ1(KuiMax)
this.HHHZ2(KuiMax)
GGG = BuzaiH(N)
MaxKuiOuTouLen = 0
For( i = 1 To KuiMax
    Select Case i
    Case 1
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value1 = Value1 * Value2
    Case KuiMax
        Value1 = 0 //PickOutouN(KuiNN, I, OuTouHHH)
        Value2 = 0 //PickBaneN(KuiNN, I, CA)
        Value1 = Value1 * Value2
    Case } else {
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value1 = Value1 * Value2
    End Select
    if ( CheckIn1 = 1 ) {
        this.CheckOutouValue(Value1, KuiNN, i)
    }
    MaxKuiOuTouLen = SMAX(MaxKuiOuTouLen, Value1)
    OutouAAA(i) = PickAAA_N(KuiNN, i)
    LINETYPE(i) = 0
    HHHZ1(i) = -9000000000#
    HHHZ2(i) = -9000000000#
    OutouValue(i) = Value1
    OutouFlag(i) = -9000000000#
}
For( i = 1 To KuiMax
    Select Case i
    Case 1
        OutouFlag(i) = -1
        LINETYPE(i) = 1
    Case KuiMax
        OutouFlag(i) = 1
        LINETYPE(i) = 1
        j = j + 1
        HHHZ1(j) = OutouAAA(i)
        if ( j > 1 ) {
            HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
        } else {
            HHHZ2(j) = OutouAAA(i)
        }
    Case } else {
        if ( OutouAAA(i) = OutouAAA(i - 1) ) {
            if ( RoundS(OutouValue(i), 3) = RoundS(OutouValue(i - 1), 3) ) {
                OutouFlag(i - 1) = -9000000000#
                OutouFlag(i) = 0
                LINETYPE(i - 1) = 0
                LINETYPE(i) = 1
            } else {
                OutouFlag(i - 1) = 1
                OutouFlag(i) = -1
                LINETYPE(i - 1) = 0
                LINETYPE(i) = 1
            }
            j = j + 1
            HHHZ1(j) = OutouAAA(i)
            if ( j > 1 ) {
                HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
            } else {
                HHHZ2(j) = OutouAAA(i)
            }
        } else {
            OutouFlag(i) = -9000000000#
            LINETYPE(i) = 2
        }
    End Select
}
//
if ( OoutouHeniConst1 = 1 || j = 0 ) {  // 寸法線を書かない場合はここで終了。
} else {
    if ( LeftKuibuzaiNumber = N ) {
        SouMax = j
        HHHZ2(SouMax + 1) = 0
        For( i = 1 To SouMax
            HHHZ2(SouMax + 1) = HHHZ2(SouMax + 1) + HHHZ2(i)
        }
        FFKuiMaxLen = (HEN_Y(CSng(YYYY2(N))) - HEN_Y(CSng(YYYY1(N) * BuzaiBai(N)))) / OuTouBai
        HH1 = PickAAA_N(KuiNN, KuiMax)
        HHH = HH1 / FFKuiLengthMax
        MeterAtari = FFKuiMaxLen * HHH * OuTouBai / HH1
        FFStartX = HEN_X(CSng(XXXX1(N)))
        FFStartY = HEN_Y(CSng(YYYY1(N)))
    }
}
//
For( i = 1 To KuiMax
    Select Case i
    Case 1
        LLL = PickAAA_N(KuiNN, i)
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_X(CSng(XXXX1(N)))
        AZFY2 = HEN_Y(CSng(YYYY1(N)))
        if ( GGG = 1 ) {
            ZFX2 = HEN_X(CSng(XXXX1(N))) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxOuTouLen2 * OutouXXBai
            ZFY2 = HEN_Y(CSng(YYYY1(N) * BuzaiBai(N)))
        } else {
            ZFX2 = HEN_X(CSng(XXXX1(N)))
            ZFY2 = HEN_Y(CSng(YYYY1(N))) + Value3 * HiRiTsu1
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        if ( SouatrsuValuePrint = 1 ) {      // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    MojiZFY1 = ZFY2 - SouatsuMojiHight * 18
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case KuiMax
        OutouFlag(i) = 0
        LLL = PickAAA_N(KuiNN, i)
        Value1 = 0 //PickOutouN(KuiNN, I, OuTouHHH)
        Value2 = 0 //PickBaneN(KuiNN, I, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_X(CSng(XXXX1(N)))
        AZFY2 = HEN_Y(CSng((YYYY1(N) - LLL * ZZBuzaiBai(N)) * BuzaiBai(N)))
        ZFX2 = HEN_X(CSng(XXXX1(N))) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxOuTouLen2 * OutouXXBai
        ZFY2 = HEN_Y(CSng((YYYY1(N) - LLL * ZZBuzaiBai(N)) * BuzaiBai(N)))
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        if ( SouatrsuValuePrint = 1 ) {      // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case } else {
        LLL = PickAAA_N(KuiNN, i)
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value3 = Value1 * Value2
        if ( GGG = 1 ) {
            AZFX2 = HEN_X(CSng(XXXX1(N)))
            AZFY2 = HEN_Y(CSng((YYYY1(N) - LLL * ZZBuzaiBai(N)) * BuzaiBai(N)))
            ZFX2 = HEN_X(CSng(XXXX1(N))) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxOuTouLen2 * OutouXXBai
            ZFY2 = HEN_Y(CSng((YYYY1(N) - LLL * ZZBuzaiBai(N)) * BuzaiBai(N)))
        } else {
            AZFX2 = HEN_X(CSng(XXXX1(N) + LLL * ZZBuzaiBai(N)))
            AZFY2 = HEN_Y(CSng(YYYY1(N)))
            ZFX2 = HEN_X(CSng(XXXX1(N) + LLL * ZZBuzaiBai(N)))
            ZFY2 = HEN_Y(CSng(YYYY1(N))) + Value3 * HiRiTsu1
        }
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            if ( OutouCase6 = 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add5
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE(i) > 1 ) {
                    if ( OutouCase1 = 1 ) {
                        if ( ZFX1 < ZFX2 ) {
                            this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX1), CDbl(ZFY1), CInt(LINETYPE(i)))
                        } else {
                            this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                        }
                    }
                } else {
                    if ( ZFX1 < ZFX2 ) {
                        DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX1, ZFY1
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX1), CSng(ZFY1))
                        }
                    } else {
                        DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                        }
                    }
                }
            } else {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE(i) > 1 ) {
                    if ( OutouCase1 = 1 ) {
                        this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                    }
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
        }
        if ( SouatrsuValuePrint = 1 ) {      // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    End Select
}
//
if ( OoutouHeniConst1 = 1 || SouMax = 0 ) {  // 寸法線を書かない場合はここで終了。
} else {
    if ( LeftKuibuzaiNumber = N ) {
        FFSunPouStartX3 = -0 * OuTouBai
        FFSunPouStartX2 = (-4 - 2) * OuTouBai
        FFSunPouStartX1 = (-7 - 2) * OuTouBai
        ZFX1 = FFStartX
        ZFY1 = FFStartY
        ZFX2 = FFStartX + FFSunPouStartX1
        ZFY2 = FFStartY
        frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        ZFX1 = FFStartX
        ZFY1 = FFStartY + HHHZ2(SouMax + 1) * MeterAtari
        ZFX2 = FFStartX + FFSunPouStartX1
        ZFY2 = FFStartY + HHHZ2(SouMax + 1) * MeterAtari
        frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        ZFX1 = FFStartX + FFSunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
        ZFY1 = FFStartY
        ZFX2 = FFStartX + FFSunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
        ZFY2 = FFStartY + HHHZ2(SouMax + 1) * MeterAtari
        this.OuTouYajirushi_ForOutou(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
        this.OuTouPrintUp1(1, SunPouMojiSize1, HH1, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2)) // 杭長の印字
        UpXXX = -9000000000#
        DownXXX = -9000000000#
        YYYYY1 = 0
        YYYYY2 = 0
        For( i = 1 To SouMax
            YYYYY1 = YYYYY1 + HHHZ2(i) * MeterAtari
            frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( HHHZ2(i) > 0 ) {
                ZFX1 = FFStartX
                ZFY1 = FFStartY + YYYYY1
                ZFX2 = FFStartX + FFSunPouStartX2
                ZFY2 = FFStartY + YYYYY1
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
                ZFX1 = FFStartX + FFSunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
                ZFY1 = FFStartY + YYYYY2
                ZFX2 = FFStartX + FFSunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
                ZFY2 = FFStartY + YYYYY1
                this.OuTouYajirushi_ForOutou(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                this.OuTouPrintUp2(SunPouMojiSize2, HHHZ2(i), CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXX, DownXXX) // 杭長の印字
            }
            YYYYY2 = YYYYY1
        }
    }
}
//
}

private void Out_OuTou_G2(N As Double, CA As Double, OU As Double, gTotal) ////////////08/06/04     // For( Gouiki
//
double var LLL
double var KuiNN
double var KuiMax
double var i
double var X1
double var y1
double var X2
double var Y2
double var HiRiTsu
double var HiRiTsu1
var ZFX1                    As Single
var ZFY1                    As Single
var MojiZFX1                As Single
var MojiZFY1                As Single
var ZFX2                    As Single
var ZFY2                    As Single
var AZFX2                   As Single
var AZFY2                   As Single
double var GGG
double var Value1
double var Value2
double var Value3
double var OutouValue()
double var OutouAAA()
double var OutouFlag()
var TTT                     As Variant
double var OuTouN
var LINETYPE()              As Integer
double var FFStartX
double var FFStartY
double var UpXXX
double var DownXXX
double var YYYYY1
double var YYYYY2
double var HHH
var HH1                     As Single
double var SouMax
var HHHZ2()                 As Single
var Bane2()                 As Single
double var j
double var MeterAtari
double var FFKuiMaxLen
double Const OutouXXBai            = 0.8
double Const Add5                  = 5
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
var QWX1                    As Single
var QWY1                    As Single
//
gTotal = 0 ////////////08/06/04
OuTouN = OU
HiRiTsu = 1
HiRiTsu1 = 10
LLL = 0
if ( InStr(部材名(N), "杭") > 0 ) { //////////////////08/08/31
    if ( Len(Trim(部材名(N))) = 1 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 2, Len(Trim(部材名(N)))))
    }
    if ( CheckIn1 = 1 ) {
        this.CheckKuiGroup(KuiNN, N)
    }
} else { ////////////////////////側壁
    if ( Len(Trim(部材名(N))) = 2 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 3, Len(Trim(部材名(N)))))
    }
    if ( CheckIn1 = 1 ) {
        this.CheckKuiGroup(KuiNN, N)
    }
}
KuiMax = G_KuiDD(KuiNN)
this.HHHZ1(KuiMax)
this.HHHZ2(KuiMax)
this.LINETYPE(KuiMax)
this.OutouValue(KuiMax)
this.OutouFlag(KuiMax)
this.OutouAAA(KuiMax)
this.Bane2(KuiMax)
GGG = BuzaiH(N)
MaxKuiOuTouLen = 0
KuiLengthMax = SMAX(KuiLengthMax, PickAAA_G(KuiNN, KuiMax))
FFKuiLengthMax = SMAX(FFKuiLengthMax, PickAAA_G(KuiNN, KuiMax)) ////////09/03/10
//////
KuiMaxLen = Round(枠縦幅 * 0.7, -1) ////////=200 //////08/09/03
KuiMaxLen = min(KuiMaxLen, KuiLengthMax * 10 * 2)
//////
For( i = 1 To KuiMax
    Select Case i
    Case 1
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value1 = Value1 * Value2
    Case KuiMax
        Value1 = 0 //PickOutouG(KuiNN, I)
        Value2 = 0 //PickBaneG(KuiNN, I, CA)
        Value1 = Value1 * Value2
    Case } else {
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value1 = Value1 * Value2
    End Select
    if ( CheckIn1 = 1 ) {
        this.CheckOutouValue(Value1, KuiNN, i)
    }
    MaxKuiOuTouLen = SMAX(MaxKuiOuTouLen, Value1)
    LINETYPE(i) = 0
    Bane2(i) = Value2
    HHHZ1(i) = -9000000000#
    HHHZ2(i) = -9000000000#
    OutouAAA(i) = PickAAA_G(KuiNN, i)
    OutouValue(i) = Value1
    OutouFlag(i) = -9000000000#
    gTotal = gTotal + Value1 ////////////08/06/04
}
if ( gTotal = 0 ) { return; ////////////08/06/04
For( i = 1 To KuiMax
    Select Case i
    Case 1
        OutouFlag(i) = -1
        LINETYPE(i) = 1
    Case KuiMax
        OutouFlag(i) = 1
        LINETYPE(i) = 1
        j = j + 1
        HHHZ1(j) = OutouAAA(i)
        if ( j > 1 ) {
            HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
        } else {
            HHHZ2(j) = OutouAAA(i)
        }
    Case } else {
        if ( RoundS(OutouAAA(i), 3) = RoundS(OutouAAA(i - 1), 3) ) {
            if ( Int(Bane2(i)) != Int(Bane2(i - 1)) ) {
                if ( RoundS(OutouValue(i), 3) = RoundS(OutouValue(i - 1), 3) ) {
                    OutouFlag(i - 1) = -9000000000#
                    OutouFlag(i) = 0
                    LINETYPE(i - 1) = 0
                    LINETYPE(i) = 1
                } else {
                    OutouFlag(i - 1) = 1
                    OutouFlag(i) = -1
                    LINETYPE(i - 1) = 0
                    LINETYPE(i) = 1
                }
            }
            if ( Int(Bane2(i)) = Int(Bane2(i - 1)) ) {
            } else {
                j = j + 1
                HHHZ1(j) = OutouAAA(i)
                if ( j > 1 ) {
                    HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
                } else {
                    HHHZ2(j) = OutouAAA(i)
                }
            }
        } else {
            OutouFlag(i) = -9000000000#
            LINETYPE(i) = 2
        }
    End Select
}
//
if ( OoutouHeniConst1 = 1 || j = 0 ) {  // 寸法線を書かない場合はここで終了。
} else {
    if ( LeftKuibuzaiNumber = N ) {
        SouMax = j
        HHHZ2(SouMax + 1) = 0
        For( i = 1 To SouMax
            HHHZ2(SouMax + 1) = HHHZ2(SouMax + 1) + HHHZ2(i)
        }
        FFKuiMaxLen = (HEN_Y(CSng(YYYY2(N))) - HEN_Y(CSng(YYYY1(N) * BuzaiBai(N)))) / OuTouBai
        HH1 = PickAAA_G(KuiNN, KuiMax)
        HHH = HH1 / FFKuiLengthMax
        MeterAtari = FFKuiMaxLen * HHH * OuTouBai / HH1
        FFStartX = HEN_X(CSng(XXXX1(N)))
        FFStartY = HEN_Y(CSng(YYYY1(N)))
    }
}
//
For( i = 1 To KuiMax
    Select Case i
    Case 1
        LLL = PickAAA_G(KuiNN, i)
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_X(CSng(XXXX1(N)))
        AZFY2 = HEN_Y(CSng(YYYY1(N) * BuzaiBai(N)))
        if ( GGG = 1 $$ MaxKuiOuTouLen != 0 ) {
            ZFX2 = HEN_X(CSng(XXXX1(N))) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxOuTouLen2 * OutouXXBai
            ZFY2 = HEN_Y(CSng(YYYY1(N) * BuzaiBai(N)))
        } else {
            ZFX2 = HEN_X(CSng(XXXX1(N)))
            ZFY2 = HEN_Y(CSng(YYYY1(N) * BuzaiBai(N))) + Value3 * HiRiTsu1
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        if ( SouatrsuValuePrint = 1 ) {      // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    MojiZFY1 = ZFY2 - SouatsuMojiHight * 18
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                    if ( i = 1 ) { TTT = TTT & "kN/m"
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case KuiMax
        OutouFlag(i) = 0
        LLL = PickAAA_G(KuiNN, i)
        Value1 = 0 //PickOutouG(KuiNN, I)
        Value2 = 0 //PickBaneG(KuiNN, I, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_X(CSng(XXXX1(N)))
        AZFY2 = HEN_Y(CSng((YYYY1(N) - LLL * ZZBuzaiBai(N)) * BuzaiBai(N)))
        if ( MaxKuiOuTouLen = 0 ) {
        ZFX2 = 1
        } else {
        ZFX2 = HEN_X(CSng(XXXX1(N))) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxOuTouLen2 * OutouXXBai
        }
        ZFY2 = HEN_Y(CSng((YYYY1(N) - LLL * ZZBuzaiBai(N)) * BuzaiBai(N)))
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        if ( SouatrsuValuePrint = 1 ) {      // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case } else {
        LLL = PickAAA_G(KuiNN, i)
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value3 = Value1 * Value2
        if ( GGG = 1 $$ MaxKuiOuTouLen != 0 ) {
            AZFX2 = HEN_X(CSng(XXXX1(N)))
            AZFY2 = HEN_Y(CSng((YYYY1(N) - LLL * ZZBuzaiBai(N)) * BuzaiBai(N)))
            ZFX2 = HEN_X(CSng(XXXX1(N))) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxOuTouLen2 * OutouXXBai
            ZFY2 = HEN_Y(CSng((YYYY1(N) - LLL * ZZBuzaiBai(N)) * BuzaiBai(N)))
        } else {
            AZFX2 = HEN_X(CSng(XXXX1(N) + LLL * ZZBuzaiBai(N)))
            AZFY2 = HEN_Y(CSng(YYYY1(N)))
            ZFX2 = HEN_X(CSng(XXXX1(N) + LLL * ZZBuzaiBai(N)))
            ZFY2 = HEN_Y(CSng(YYYY1(N))) + Value3 * HiRiTsu1
        }
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            if ( OutouCase6 = 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add5
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE(i) > 1 ) {
                    if ( OutouCase1 = 1 ) {
                        if ( ZFX1 < ZFX2 ) {
                            this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX1), CDbl(ZFY1), CInt(LINETYPE(i)))
                        } else {
                            this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                        }
                    }
                } else {
                    if ( ZFX1 < ZFX2 ) {
                        DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX1, ZFY1
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                        }
                    } else {
                        DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                        }
                    }
                }
            } else {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE(i) > 1 ) {
                    if ( OutouCase1 = 1 ) {
                        this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                    }
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
        }
        frmPrint.vsPrt1.PenStyle = psSolid
        if ( SouatrsuValuePrint = 1 ) {      // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    End Select
}
//
if ( OoutouHeniConst1 = 1 || SouMax = 0 ) {  // 寸法線を書かない場合はここで終了。
} else {
    if ( LeftKuibuzaiNumber = N ) {
        FFSunPouStartX3 = -0 * OuTouBai
        FFSunPouStartX2 = (-4 - 2) * OuTouBai
        FFSunPouStartX1 = (-7 - 2) * OuTouBai
        ZFX1 = FFStartX
        ZFY1 = FFStartY
        ZFX2 = FFStartX + FFSunPouStartX1
        ZFY2 = FFStartY
        frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        ZFX1 = FFStartX
        ZFY1 = FFStartY + HHHZ2(SouMax + 1) * MeterAtari
        ZFX2 = FFStartX + FFSunPouStartX1
        ZFY2 = FFStartY + HHHZ2(SouMax + 1) * MeterAtari
        frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        ZFX1 = FFStartX + FFSunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
        ZFY1 = FFStartY
        ZFX2 = FFStartX + FFSunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
        ZFY2 = FFStartY + HHHZ2(SouMax + 1) * MeterAtari
        this.OuTouYajirushi_ForOutou(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
        this.OuTouPrintUp1(1, SunPouMojiSize1, HH1, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2)) // 杭長の印字
//            UpXXX = -9000000000# //////////////////////////////////07/06/17 コメントにした
//            DownXXX = -9000000000#
//            YYYYY1 = 0
//            YYYYY2 = 0
//            For( I = 1 To SouMax
//                YYYYY1 = YYYYY1 + HHHZ2(I) * MeterAtari
//                frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
//                if ( CreateDxfFlag = 1 ) {
//                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
//                }
//                ZFX1 = FFStartX
//                ZFY1 = FFStartY + YYYYY1
//                ZFX2 = FFStartX + FFSunPouStartX2
//                ZFY2 = FFStartY + YYYYY1
//                if ( HHHZ2(I) > 0 ) {
//                    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
//                    if ( CreateDxfFlag = 1 ) {
//                        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
//                    }
//                    ZFX1 = FFStartX + FFSunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
//                    ZFY1 = FFStartY + YYYYY2
//                    ZFX2 = FFStartX + FFSunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
//                    ZFY2 = FFStartY + YYYYY1
//                    this.OuTouYajirushi_ForOutou(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
//                    this.OuTouPrintUp2(SunPouMojiSize2, HHHZ2(I), CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXX, DownXXX) // 杭長の印字
//                }
//                YYYYY2 = YYYYY1
//            }
    }
}
//
}

private void Out_OuTou_N2(N As Double, CA)      // Frame
//
var Bane2()                 As Single
double var LLL
double var KuiNN
double var KuiMax
double var i
double var X1
double var y1
double var X2
double var Y2
double var HiRiTsu
double var HiRiTsu1
var ZFX1                    As Single
var ZFY1                    As Single
var MojiZFX1                As Single
var MojiZFY1                As Single
var ZFX2                    As Single
var ZFY2                    As Single
var AZFX2                   As Single
var AZFY2                   As Single
double var GGG
double var Value1
double var Value2
double var Value3
double var OutouValue()
double var OutouAAA()
double var OutouFlag()
var TTT                     As Variant
var LINETYPE()              As Integer
double var FFStartX
double var FFStartY
double var UpXXX
double var DownXXX
double var YYYYY1
double var YYYYY2
double var HHH
var HH1                     As Single
double var SouMax
double var HHHZ1()
var HHHZ2()                 As Single
double var j
double var MeterAtari
double var FFKuiMaxLen
double Const OutouXXBai            = 0.8
double Const Add5                  = 5
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
var QWX1                    As Single
var QWY1                    As Single
//
HiRiTsu = 1
HiRiTsu1 = 10
LLL = 0
if ( Len(Trim(部材名(N))) = 1 ) {
    KuiNN = 1
} else {
    KuiNN = val(Mid(Trim(部材名(N)), 2, Len(Trim(部材名(N))) - 1))
}
if ( CheckIn1 = 1 ) {
    this.CheckKuiGroup(KuiNN, N)
}
KuiMax = N_KuiDD(KuiNN)
KuiLengthMax = SMAX(KuiLengthMax, PickAAA_N(KuiNN, KuiMax))
//////
KuiMaxLen = Round(枠縦幅 * 0.7, -1) ////////=200 //////08/09/03
KuiMaxLen = min(KuiMaxLen, KuiLengthMax * 10 * 2)
//////
this.LINETYPE(KuiMax)
this.OutouValue(KuiMax)
this.OutouFlag(KuiMax)
this.OutouAAA(KuiMax)
this.HHHZ1(KuiMax)
this.HHHZ2(KuiMax)
this.Bane2(KuiMax)
GGG = BuzaiH(N)
MaxKuiOuTouLen = 0
For( i = 1 To KuiMax
    Select Case i
    Case 1
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value1 = Value1 * Value2
    Case KuiMax
        Value1 = 0 //PickOutouN(KuiNN, I, OuTouHHH)
        Value2 = 0 //PickBaneN(KuiNN, I, OuTouHHH)
        Value1 = Value1 * Value2
    Case } else {
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value1 = Value1 * Value2
    End Select
    if ( CheckIn1 = 1 ) {
        this.CheckOutouValue(Value1, KuiNN, i)
    }
    MaxKuiOuTouLen = SMAX(MaxKuiOuTouLen, Value1)
    OutouAAA(i) = PickAAA_N(KuiNN, i)
    LINETYPE(i) = 0
    HHHZ1(i) = -9000000000#
    HHHZ2(i) = -9000000000#
    OutouValue(i) = Value1
    Bane2(i) = Value2
    OutouFlag(i) = -9000000000#
}
For( i = 1 To KuiMax
    Select Case i
    Case 1
        OutouFlag(i) = -1
        LINETYPE(i) = 1
    Case KuiMax
        OutouFlag(i) = 1
        LINETYPE(i) = 1
        j = j + 1
        HHHZ1(j) = OutouAAA(i)
        if ( j > 1 ) {
            HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
        } else {
            HHHZ2(j) = OutouAAA(i)
        }
    Case } else {
        if ( OutouAAA(i) = OutouAAA(i - 1) ) {
            if ( Int(Bane2(i)) != Int(Bane2(i - 1)) ) {
                if ( RoundS(OutouValue(i), 3) = RoundS(OutouValue(i - 1), 3) ) {
                    OutouFlag(i - 1) = -9000000000#
                    OutouFlag(i) = 0
                    LINETYPE(i - 1) = 0
                    LINETYPE(i) = 1
                } else {
                    OutouFlag(i - 1) = 1
                    OutouFlag(i) = -1
                    LINETYPE(i - 1) = 0
                    LINETYPE(i) = 1
                }
            }
            if ( Int(Bane2(i)) = Int(Bane2(i - 1)) ) {
            } else {
                j = j + 1
                HHHZ1(j) = OutouAAA(i)
                if ( j > 1 ) {
                    HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
                } else {
                    HHHZ2(j) = OutouAAA(i)
                }
            }
        } else {
            OutouFlag(i) = -9000000000#
            LINETYPE(i) = 2
        }
    End Select
}
//
if ( OoutouHeniConst1 = 1 ) {     // 寸法線を書かない場合はここで終了。
} else {
    if ( LeftKuibuzaiNumber = N ) {
        SouMax = j
        HHHZ2(SouMax + 1) = 0
        For( i = 1 To SouMax
            HHHZ2(SouMax + 1) = HHHZ2(SouMax + 1) + HHHZ2(i)
        }
        FFKuiMaxLen = (HEN_Y(CSng(YYYY2(N))) - HEN_Y(CSng(YYYY1(N) * BuzaiBai(N)))) / OuTouBai
//            FFKuiMaxLen = 100 //////////////////////////////05/05/24
        HH1 = PickAAA_N(KuiNN, KuiMax)
        HHH = HH1 / FFKuiLengthMax
        MeterAtari = FFKuiMaxLen * HHH * OuTouBai / HH1
        FFStartX = HEN_X(CSng(XXXX1(N)))
        FFStartY = HEN_Y(CSng(YYYY1(N)))
    }
}
//
For( i = 1 To KuiMax
    Select Case i
    Case 1
        LLL = PickAAA_N(KuiNN, i)
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_X(CSng(XXXX1(N)))
        AZFY2 = HEN_Y(CSng(YYYY1(N)))
        if ( GGG = 1 $$ MaxKuiOuTouLen != 0 ) {
            ZFX2 = HEN_X(CSng(XXXX1(N))) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxOuTouLen2 * OutouXXBai
            ZFY2 = HEN_Y(CSng(YYYY1(N) * BuzaiBai(N)))
        } else {
            ZFX2 = HEN_X(CSng(XXXX1(N)))
            ZFY2 = HEN_Y(CSng(YYYY1(N))) + Value3 * HiRiTsu1
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        if ( SouatrsuValuePrint = 1 ) {      // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    MojiZFY1 = ZFY2 - SouatsuMojiHight * 18
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case KuiMax
        ZFX2 = 0
        OutouFlag(i) = 0
        LLL = PickAAA_N(KuiNN, i)
        Value1 = 0 //PickOutouN(KuiNN, I, OuTouHHH)
        Value2 = 0 //PickBaneN(KuiNN, I, OuTouHHH)
        Value3 = Value1 * Value2
        AZFX2 = HEN_X(CSng(XXXX1(N)))
        AZFY2 = HEN_Y(CSng((YYYY1(N) - LLL * ZZBuzaiBai(N)) * BuzaiBai(N)))
        if ( (Value3 * HiRiTsu) = 0 ) { //////////05/05/27
        ZFX2 = HEN_X(CSng(XXXX1(N)))
        } else {
        ZFX2 = HEN_X(CSng(XXXX1(N))) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxOuTouLen2 * OutouXXBai
        }
        ZFY2 = HEN_Y(CSng((YYYY1(N) - LLL * ZZBuzaiBai(N)) * BuzaiBai(N)))
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        if ( SouatrsuValuePrint = 1 ) {      // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case } else {
        LLL = PickAAA_N(KuiNN, i)
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value3 = Value1 * Value2
        if ( GGG = 1 $$ MaxKuiOuTouLen != 0 ) {
            AZFX2 = HEN_X(CSng(XXXX1(N)))
            AZFY2 = HEN_Y(CSng((YYYY1(N) - LLL * ZZBuzaiBai(N)) * BuzaiBai(N)))
            ZFX2 = HEN_X(CSng(XXXX1(N))) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxOuTouLen2 * OutouXXBai
            ZFY2 = HEN_Y(CSng((YYYY1(N) - LLL * ZZBuzaiBai(N)) * BuzaiBai(N)))
        } else {
            AZFX2 = HEN_X(CSng(XXXX1(N) + LLL * ZZBuzaiBai(N)))
            AZFY2 = HEN_Y(CSng(YYYY1(N)))
            ZFX2 = HEN_X(CSng(XXXX1(N) + LLL * ZZBuzaiBai(N)))
            ZFY2 = HEN_Y(CSng(YYYY1(N))) + Value3 * HiRiTsu1
        }
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            if ( OutouCase6 = 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add5
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE(i) > 1 ) {
                    if ( OutouCase1 = 1 ) {
                        if ( ZFX1 < ZFX2 ) {
                            this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX1), CDbl(ZFY1), CInt(LINETYPE(i)))
                        } else {
                            this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                        }
                    }
                } else {
                    if ( ZFX1 < ZFX2 ) {
                        DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX1, ZFY1
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                        }
                    } else {
                        DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                        }
                    }
                }
            } else {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE(i) > 1 ) {
                    if ( OutouCase1 = 1 ) {
                        this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                    }
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
        }
        if ( SouatrsuValuePrint = 1 ) {      // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    End Select
}
//
if ( OoutouHeniConst1 = 1 ) {     // 寸法線を書かない場合はここで終了。
} else {
    if ( LeftKuibuzaiNumber = N ) {
        FFSunPouStartX3 = -0 * OuTouBai
        FFSunPouStartX2 = (-4 - 2) * OuTouBai
        FFSunPouStartX1 = (-7 - 2) * OuTouBai
        ZFX1 = FFStartX
        ZFY1 = FFStartY
        ZFX2 = FFStartX + FFSunPouStartX1
        ZFY2 = FFStartY
        frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        ZFX1 = FFStartX
        ZFY1 = FFStartY + HHHZ2(SouMax + 1) * MeterAtari
        ZFX2 = FFStartX + FFSunPouStartX1
        ZFY2 = FFStartY + HHHZ2(SouMax + 1) * MeterAtari
        frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        ZFX1 = FFStartX + FFSunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
        ZFY1 = FFStartY
        ZFX2 = FFStartX + FFSunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
        ZFY2 = FFStartY + HHHZ2(SouMax + 1) * MeterAtari
        this.OuTouYajirushi_ForOutou(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
        this.OuTouPrintUp1(1, SunPouMojiSize1, HH1, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2)) // 杭長の印字
        UpXXX = -9000000000#
        DownXXX = -9000000000#
        YYYYY1 = 0
        YYYYY2 = 0
        For( i = 1 To SouMax
            YYYYY1 = YYYYY1 + HHHZ2(i) * MeterAtari
            frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( HHHZ2(i) > 0 ) {
                ZFX1 = FFStartX
                ZFY1 = FFStartY + YYYYY1
                ZFX2 = FFStartX + FFSunPouStartX2
                ZFY2 = FFStartY + YYYYY1
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
                ZFX1 = FFStartX + FFSunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
                ZFY1 = FFStartY + YYYYY2
                ZFX2 = FFStartX + FFSunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
                ZFY2 = FFStartY + YYYYY1
                this.OuTouYajirushi_ForOutou(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                this.OuTouPrintUp2(SunPouMojiSize2, HHHZ2(i), CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXX, DownXXX) // 杭長の印字
            }
            YYYYY2 = YYYYY1
        }
    }
}
//
}

private void Out_OuTou_G(HH As Integer)       // For( Gouiki
//
double var N
double var CA
double var OU
double var KuiMaxX
//
CA = Int(F7ML5(HH))
if ( CA < 1 || CA > 16 ) {
    return;
}
OU = OuTouHHH
CheckIn1 = CheckIn1 + 1
KuiMaxX = 9999999
LeftKuibuzaiNumber = 0
For( N = 1 To 部材_max
    if ( ZZBuzaiBai(N) != 0 ) {
    if ( InStr(Trim(部材名(N)), "杭") > 0 ) {
        if ( KuiBuzaiX(1, N) > -9000000000# $$ KuiBuzaiX(2, N) > -9000000000# ) {
            if ( KuiBuzaiX(1, N) < KuiMaxX || KuiBuzaiX(2, N) < KuiMaxX ) {
                LeftKuibuzaiNumber = N
                KuiMaxX = SMin(KuiBuzaiX(1, N), KuiMaxX)
                KuiMaxX = SMin(KuiBuzaiX(2, N), KuiMaxX)
            }
        }
    }
    }
Next N
For( N = 1 To 部材_max
    if ( ZZBuzaiBai(N) != 0 ) {
    if ( InStr(Trim(部材名(N)), "杭") > 0 || InStr(Trim(部材名(N)), "側壁") > 0 ) { //////08/08/31
        this.Out_OuTou_G1(N, CA, OU)
    }
    }
Next N
//
}

private Function PickAAA_G(KuiNN As Double, i As Double)
//
double var temp
//
Select Case KuiNN
Case 1
    temp = G1_AA1(i)
Case 2
    temp = G2_AA1(i)
Case 3
    temp = G3_AA1(i)
Case 4
    temp = G4_AA1(i)
Case 5
    temp = G5_AA1(i)
Case 6
    temp = G6_AA1(i)
Case 7
    temp = G7_AA1(i)
Case 8
    temp = G8_AA1(i)
Case 9
    temp = G9_AA1(i)
Case 10
    temp = G10_AA1(i)
Case } else {
    temp = G1_AA1(i)
End Select
PickAAA_G = temp
//
}

private Function PickBaneG(KuiNN As Double, i As Double, CA As Double)    // For( Gouiki
//
double var temp
//
if ( CA > 0 $$ CA <= 16 ) {
    Select Case KuiNN
    Case 1
        temp = G1_AA5(i, CA)
    Case 2
        temp = G2_AA5(i, CA)
    Case 3
        temp = G3_AA5(i, CA)
    Case 4
        temp = G4_AA5(i, CA)
    Case 5
        temp = G5_AA5(i, CA)
    Case 6
        temp = G6_AA5(i, CA)
    Case 7
        temp = G7_AA5(i, CA)
    Case 8
        temp = G8_AA5(i, CA)
    Case 9
        temp = G9_AA5(i, CA)
    Case 10
        temp = G10_AA5(i, CA)
    Case } else {
        temp = G1_AA5(i, CA)
    End Select
} else {
    Select Case KuiNN
    Case 1
        temp = G1_AA5(i, 1)
    Case 2
        temp = G2_AA5(i, 1)
    Case 3
        temp = G3_AA5(i, 1)
    Case 4
        temp = G4_AA5(i, 1)
    Case 5
        temp = G5_AA5(i, 1)
    Case 6
        temp = G6_AA5(i, 1)
    Case 7
        temp = G7_AA5(i, 1)
    Case 8
        temp = G8_AA5(i, 1)
    Case 9
        temp = G9_AA5(i, 1)
    Case 10
        temp = G10_AA5(i, 1)
    Case } else {
        temp = G1_AA5(i, 1)
    End Select
}
PickBaneG = temp
//
}

private Function PickOutouG(KuiNN As Double, i As Double)     // For( Gouiki
//
double var temp
if ( i = 0 ) { i = 1
//
if ( OuTouHHH > 0 $$ OuTouHHH <= 6 ) {
    Select Case KuiNN
    Case 1
        temp = G1_AA2(i, OuTouHHH)
    Case 2
        temp = G2_AA2(i, OuTouHHH)
    Case 3
        temp = G3_AA2(i, OuTouHHH)
    Case 4
        temp = G4_AA2(i, OuTouHHH)
    Case 5
        temp = G5_AA2(i, OuTouHHH)
    Case 6
        temp = G6_AA2(i, OuTouHHH)
    Case 7
        temp = G7_AA2(i, OuTouHHH)
    Case 8
        temp = G8_AA2(i, OuTouHHH)
    Case 9
        temp = G9_AA2(i, OuTouHHH)
    Case 10
        temp = G10_AA2(i, OuTouHHH)
    Case } else {
        temp = G1_AA2(i, OuTouHHH)
    End Select
} else {
    Select Case KuiNN
    Case 1
        temp = G1_AA2(i, 1)
    Case 2
        temp = G2_AA2(i, 1)
    Case 3
        temp = G3_AA2(i, 1)
    Case 4
        temp = G4_AA2(i, 1)
    Case 5
        temp = G5_AA2(i, 1)
    Case 6
        temp = G6_AA2(i, 1)
    Case 7
        temp = G7_AA2(i, 1)
    Case 8
        temp = G8_AA2(i, 1)
    Case 9
        temp = G9_AA2(i, 1)
    Case 10
        temp = G10_AA2(i, 1)
    Case } else {
        temp = G1_AA2(i, 1)
    End Select
}
PickOutouG = temp
//
}

private void Out_OuTou_G1(N As Double, CA As Double, OU)     // For( Gouiki
//
double var LLL
double var KuiNN
double var KuiMax
double var i
double var X1
double var y1
double var X2
double var Y2
double var HiRiTsu
double var HiRiTsu1
var ZFX1                    As Single
var ZFY1                    As Single
var MojiZFX1                As Single
var MojiZFY1                As Single
var ZFX2                    As Single
var ZFY2                    As Single
var AZFX2                   As Single
var AZFY2                   As Single
double var GGG
double var Value1
double var Value2
double var Value3
double var OutouValue()
double var OutouAAA()
double var OutouFlag()
var TTT                     As Variant
double var OuTouN
var LINETYPE()              As Integer
double var FFStartX
double var FFStartY
double var UpXXX
double var DownXXX
double var YYYYY1
double var YYYYY2
double var HHH
var HH1                     As Single
double var SouMax
var HHHZ2()                 As Single
double var j
double var MeterAtari
double var FFKuiMaxLen
double Const OutouXXBai            = 0.8
double Const Add5                  = 5
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
var QWX1                    As Single
var QWY1                    As Single
double var Total ////////08/06/04
//
if ( SuiheiBaneEqual = 1 ) {
    this.Out_OuTou_G2(N, CA, OU, Total) ////////08/06/04  // For( Gouiki
    if ( Total = 0 ) { ////////08/06/04
    return;
    }
}
OuTouN = OU
HiRiTsu = 1
HiRiTsu1 = 10
LLL = 0
if ( InStr(部材名(N), "杭") > 0 ) { //////////////////08/08/31
    if ( Len(Trim(部材名(N))) = 1 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 2, Len(Trim(部材名(N)))))
    }
} else { ////////////////////////側壁
    if ( Len(Trim(部材名(N))) = 2 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 3, Len(Trim(部材名(N)))))
    }
}
if ( CheckIn1 = 1 ) {
    this.CheckKuiGroup(KuiNN, N)
}
KuiMax = G_KuiDD(KuiNN)
this.HHHZ1(KuiMax)
this.HHHZ2(KuiMax)
this.LINETYPE(KuiMax)
this.OutouValue(KuiMax)
this.OutouFlag(KuiMax)
this.OutouAAA(KuiMax)
GGG = BuzaiH(N)
MaxKuiOuTouLen = 0
KuiLengthMax = SMAX(KuiLengthMax, PickAAA_G(KuiNN, KuiMax))
For( i = 1 To KuiMax
    Select Case i
    Case 1
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value1 = Value1 * Value2
    Case KuiMax
        Value1 = 0 //PickOutouG(KuiNN, I)
        Value2 = 0 //PickBaneG(KuiNN, I, CA)
        Value1 = Value1 * Value2
    Case } else {
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value1 = Value1 * Value2
    End Select
    if ( CheckIn1 = 1 ) {
        this.CheckOutouValue(Value1, KuiNN, i)
    }
    MaxKuiOuTouLen = SMAX(MaxKuiOuTouLen, Value1)
    LINETYPE(i) = 0
    HHHZ1(i) = -9000000000#
    HHHZ2(i) = -9000000000#
    OutouAAA(i) = PickAAA_G(KuiNN, i)
    OutouValue(i) = Value1
    OutouFlag(i) = -9000000000#
}
For( i = 1 To KuiMax
    Select Case i
    Case 1
        OutouFlag(i) = -1
        LINETYPE(i) = 1
    Case KuiMax
        OutouFlag(i) = 1
        LINETYPE(i) = 1
        j = j + 1
        HHHZ1(j) = OutouAAA(i)
        if ( j > 1 ) {
            HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
        } else {
            HHHZ2(j) = OutouAAA(i)
        }
    Case } else {
        if ( RoundS(OutouAAA(i), 3) = RoundS(OutouAAA(i - 1), 3) ) {
            if ( RoundS(OutouValue(i), 3) = RoundS(OutouValue(i - 1), 3) ) {
                OutouFlag(i - 1) = -9000000000#
                OutouFlag(i) = 0
                LINETYPE(i - 1) = 0
                LINETYPE(i) = 1
            } else {
                OutouFlag(i - 1) = 1
                OutouFlag(i) = -1
                LINETYPE(i - 1) = 0
                LINETYPE(i) = 1
            }
            j = j + 1
            HHHZ1(j) = OutouAAA(i)
            if ( j > 1 ) {
                HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
            } else {
                HHHZ2(j) = OutouAAA(i)
            }
        } else {
            OutouFlag(i) = -9000000000#
            LINETYPE(i) = 2
        }
    End Select
}
//
if ( OoutouHeniConst1 = 1 ) {     // 寸法線を書かない場合はここで終了。
} else {
    if ( LeftKuibuzaiNumber = N ) {
        SouMax = j
        HHHZ2(SouMax + 1) = 0
        For( i = 1 To SouMax
            HHHZ2(SouMax + 1) = HHHZ2(SouMax + 1) + HHHZ2(i)
        }
        FFKuiMaxLen = (HEN_Y(CSng(YYYY2(N))) - HEN_Y(CSng(YYYY1(N) * BuzaiBai(N)))) / OuTouBai
        HH1 = PickAAA_G(KuiNN, KuiMax)
        HHH = HH1 / FFKuiLengthMax
        MeterAtari = FFKuiMaxLen * HHH * OuTouBai / HH1
        FFStartX = HEN_X(CSng(XXXX1(N)))
        FFStartY = HEN_Y(CSng(YYYY1(N)))
    }
}
//
For( i = 1 To KuiMax
    Select Case i
    Case 1
        LLL = PickAAA_G(KuiNN, i)
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_X(CSng(XXXX1(N)))
        AZFY2 = HEN_Y(CSng(YYYY1(N) * BuzaiBai(N)))
        if ( GGG = 1 $$ MaxKuiOuTouLen != 0 ) {
            ZFX2 = HEN_X(CSng(XXXX1(N))) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxOuTouLen2 * OutouXXBai
            ZFY2 = HEN_Y(CSng(YYYY1(N) * BuzaiBai(N)))
        } else {
            ZFX2 = HEN_X(CSng(XXXX1(N)))
            ZFY2 = HEN_Y(CSng(YYYY1(N) * BuzaiBai(N))) + Value3 * HiRiTsu1
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        if ( SouatrsuValuePrint = 1 ) {      // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    MojiZFY1 = ZFY2 - SouatsuMojiHight * 18
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case KuiMax
        OutouFlag(i) = 0
        LLL = PickAAA_G(KuiNN, i)
        Value1 = 0 //PickOutouG(KuiNN, I)
        Value2 = 0 //PickBaneG(KuiNN, I, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_X(CSng(XXXX1(N)))
        AZFY2 = HEN_Y(CSng((YYYY1(N) - LLL * ZZBuzaiBai(N)) * BuzaiBai(N)))
        if ( (Value3 * HiRiTsu) = 0 ) { //////////////////////05/05/28
        ZFX2 = HEN_X(CSng(XXXX1(N)))
        } else {
        ZFX2 = HEN_X(CSng(XXXX1(N))) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxOuTouLen2 * OutouXXBai
        }
        ZFY2 = HEN_Y(CSng((YYYY1(N) - LLL * ZZBuzaiBai(N)) * BuzaiBai(N)))
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        if ( SouatrsuValuePrint = 1 ) {      // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case } else {
        LLL = PickAAA_G(KuiNN, i)
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value3 = Value1 * Value2
        if ( GGG = 1 $$ MaxKuiOuTouLen != 0 ) {
            AZFX2 = HEN_X(CSng(XXXX1(N)))
            AZFY2 = HEN_Y(CSng((YYYY1(N) - LLL * ZZBuzaiBai(N)) * BuzaiBai(N)))
            ZFX2 = HEN_X(CSng(XXXX1(N))) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxOuTouLen2 * OutouXXBai
            ZFY2 = HEN_Y(CSng((YYYY1(N) - LLL * ZZBuzaiBai(N)) * BuzaiBai(N)))
        } else {
            AZFX2 = HEN_X(CSng(XXXX1(N) + LLL * ZZBuzaiBai(N)))
            AZFY2 = HEN_Y(CSng(YYYY1(N)))
            ZFX2 = HEN_X(CSng(XXXX1(N) + LLL * ZZBuzaiBai(N)))
            ZFY2 = HEN_Y(CSng(YYYY1(N))) + Value3 * HiRiTsu1
        }
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            if ( OutouCase6 = 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add5
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE(i) > 1 ) {
                    if ( OutouCase1 = 1 ) {
                        if ( ZFX1 < ZFX2 ) {
                            this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX1), CDbl(ZFY1), CInt(LINETYPE(i)))
                        } else {
                            this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                        }
                    }
                } else {
                    if ( ZFX1 < ZFX2 ) {
                        DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX1, ZFY1
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                        }
                    } else {
                        DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                        }
                    }
                }
            } else {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE(i) > 1 ) {
                    if ( OutouCase1 = 1 ) {
                        this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                    }
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
        }
        frmPrint.vsPrt1.PenStyle = psSolid
        if ( SouatrsuValuePrint = 1 ) {      // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    End Select
}
//
if ( OoutouHeniConst1 = 1 ) {     // 寸法線を書かない場合はここで終了。
} else {
    if ( LeftKuibuzaiNumber = N ) {
            FFSunPouStartX3 = -0 * OuTouBai
            FFSunPouStartX2 = (-4 - 2) * OuTouBai
            FFSunPouStartX1 = (-7 - 2) * OuTouBai
        ZFX1 = FFStartX
        ZFY1 = FFStartY
        ZFX2 = FFStartX + FFSunPouStartX1
        ZFY2 = FFStartY
        frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        ZFX1 = FFStartX
        ZFY1 = FFStartY + HHHZ2(SouMax + 1) * MeterAtari
        ZFX2 = FFStartX + FFSunPouStartX1
        ZFY2 = FFStartY + HHHZ2(SouMax + 1) * MeterAtari
        frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
//            ZFX1 = FFStartX + FFSunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10////////////07/06/17 コメントにした
//            ZFY1 = FFStartY
//            ZFX2 = FFStartX + FFSunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
//            ZFY2 = FFStartY + HHHZ2(SouMax + 1) * MeterAtari
//            this.OuTouYajirushi_ForOutou(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
//            this.OuTouPrintUp1(1, SunPouMojiSize1, HH1, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2)) // 杭長の印字
        UpXXX = -9000000000#
        DownXXX = -9000000000#
        YYYYY1 = 0
        YYYYY2 = 0
        For( i = 1 To SouMax
            YYYYY1 = YYYYY1 + HHHZ2(i) * MeterAtari
            frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            ZFX1 = FFStartX
            ZFY1 = FFStartY + YYYYY1
            ZFX2 = FFStartX + FFSunPouStartX2
            ZFY2 = FFStartY + YYYYY1
            if ( HHHZ2(i) > 0 ) {
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
                ZFX1 = FFStartX + FFSunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
                ZFY1 = FFStartY + YYYYY2
                ZFX2 = FFStartX + FFSunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
                ZFY2 = FFStartY + YYYYY1
                this.OuTouYajirushi_ForOutou(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                this.OuTouPrintUp2(SunPouMojiSize2, HHHZ2(i), CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXX, DownXXX) // 杭長の印字
            }
            YYYYY2 = YYYYY1
        }
    }
}
//
}

private void Out_BuzaiNameSingle(N)
//
double var ff
var TTT
double var MojiZFX1
double var MojiZFY1
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
var QWX1                    As Single
var QWY1                    As Single
//
ff = 1
MojiZFX1 = OuTouBai * 40
if ( A3FLAG = 0 ) {
    MojiZFY1 = OuTouBai * ((ff - 1) * SouatsuMojiHight * 0.75 + 30)
} else {
    MojiZFY1 = OuTouBai * ((ff - 1) * SouatsuMojiHight * 0.75 + 30) * 1.1
}
frmPrint.vsPrt1.TextAngle = 0 * 10
frmPrint.vsPrt1.FontSize = SouatsuMojiHight * 1.2     // * 1.5 ////////// nagase
MyCurrentX = Int(CSng(MojiZFX1))
MyCurrentY = Int(CSng(MojiZFY1))
TTT = "　　　部材番号：" & Trim(str(N)) & " (部材名：" & Trim(部材名(N)) & ")"
MyCurrentY = MyCurrentY + 100
QWX1 = MyCurrentX
QWY1 = MyCurrentY
PrintoutPrt frmPrint.vsPrt1, TTT
if ( CreateDxfFlag = 1 ) {
    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
    ParamXPoint = QWX1
    ParamYpoint = QWY1
    ParamText = TTT
    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
}
//
}

private void Out_BuzaiNameMulti(i)
//
double var N
double var h
double var ff
var TTT
double var MojiZFX1
double var MojiZFY1
double var XKUIM
double var MAX3
double var ZZZ
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
var QWX1                    As Single
var QWY1                    As Single
//
MAX3 = 4
Select Case i
Case 1
    XKUIM = XKui1
Case 2
    XKUIM = XKui2
Case 3
    XKUIM = XKui3
Case 4
    XKUIM = XKui4
Case 5
    XKUIM = XKui5
Case 6
    XKUIM = XKui6
Case 7
    XKUIM = XKui7
Case 8
    XKUIM = XKui8
Case 9
    XKUIM = XKui9
Case 10
    XKUIM = XKui10
Case } else {
    XKUIM = XKui1
End Select
frmPrint.vsPrt1.TextAngle = 0 * 10
frmPrint.vsPrt1.FontSize = SouatsuMojiHight * 1.5 //1.25
if ( XKUIM <= MAX3 ) {
    For( N = 1 To XKUIM
        ff = N
        MojiZFX1 = OuTouBai * 40
        if ( A3FLAG = 1 ) {
            MojiZFY1 = OuTouBai * ((ff - 1) * SouatsuMojiHight * 0.5 + 30) * 1.1
        } else {
            MojiZFY1 = OuTouBai * ((ff - 1) * SouatsuMojiHight * 0.5 + 30)
        }
        MyCurrentX = Int(CSng(MojiZFX1))
        MyCurrentY = Int(CSng(MojiZFY1))
        Select Case i
        Case 1
            h = XOutouKui1(N)
        Case 2
            h = XOutouKui2(N)
        Case 3
            h = XOutouKui3(N)
        Case 4
            h = XOutouKui4(N)
        Case 5
            h = XOutouKui5(N)
        Case 6
            h = XOutouKui6(N)
        Case 7
            h = XOutouKui7(N)
        Case 8
            h = XOutouKui8(N)
        Case 9
            h = XOutouKui9(N)
        Case 10
            h = XOutouKui10(N)
        Case } else {
            h = XOutouKui1(N)
        End Select
        TTT = "　　　部材番号：" & Trim(str(h)) & " (部材名：" & Trim(部材名(h)) & ")"
        MyCurrentY = MyCurrentY + 100
        QWX1 = MyCurrentX
        QWY1 = MyCurrentY
        PrintoutPrt frmPrint.vsPrt1, TTT
        if ( CreateDxfFlag = 1 ) {
            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
            ParamXPoint = QWX1
            ParamYpoint = QWY1
            ParamText = TTT
            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
        }
    Next N
} else {
    For( N = 1 To XKUIM
        ff = N
        ZZZ = (N - 1) Mod MAX3
        MojiZFX1 = OuTouBai * 50 * (Int((N - 1) / MAX3) + 1) - 25 * OuTouBai
        if ( A3FLAG = 1 ) {
            MojiZFY1 = OuTouBai * (ZZZ * SouatsuMojiHight * 0.75 + 30) * 1.1
        } else {
            MojiZFY1 = OuTouBai * (ZZZ * SouatsuMojiHight * 0.75 + 30)
        }
        MyCurrentX = Int(CSng(MojiZFX1))
        MyCurrentY = Int(CSng(MojiZFY1))
        Select Case i
        Case 1
            h = XOutouKui1(N)
        Case 2
            h = XOutouKui2(N)
        Case 3
            h = XOutouKui3(N)
        Case 4
            h = XOutouKui4(N)
        Case 5
            h = XOutouKui5(N)
        Case 6
            h = XOutouKui6(N)
        Case 7
            h = XOutouKui7(N)
        Case 8
            h = XOutouKui8(N)
        Case 9
            h = XOutouKui9(N)
        Case 10
            h = XOutouKui10(N)
        Case } else {
            h = XOutouKui1(N)
        End Select
        TTT = "　　　部材番号：" & Trim(str(h)) & " (部材名：" & Trim(部材名(h)) & ")"
        MyCurrentY = MyCurrentY + 100
        QWX1 = MyCurrentX
        QWY1 = MyCurrentY
        PrintoutPrt frmPrint.vsPrt1, TTT
        if ( CreateDxfFlag = 1 ) {
            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
            ParamXPoint = QWX1
            ParamYpoint = QWY1
            ParamText = TTT
            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
        }
    Next N
}
//
}

private void Out_OuTouHeniZu_N(HH As Integer, bTitle As Boolean)      // Frame（杭の応答変位図）
//
double var N
double var CA
double var i
double var j
//    var NAME1
//    var OF1
//
CA = Int(F7ML5(HH))
if ( CA < 1 || CA > 16 ) {
    return;
}
if ( GibanHeniX1 = 1 ) {     // 応答変位量の印字のみ
    if ( EqualKui = 0 ) {
        For( N = 1 To 部材_max
            if ( ZZBuzaiBai(N) != 0 ) {
            if ( (InStr(Trim(部材名(N)), "杭") > 0 || InStr(部材名(N), "側壁") != 0) ) {
                NewPagePrt frmPrint.vsPrt1
                if ( CreateDxfFlag = 1 ) {
                    this.PLOT00(2, NAME1, OF1)
                    this.PLOT00(1, NAME1, OF1)
                }
                this.OUT_枠(HH, bTitle)
                this.Out_BuzaiNameSingle(N)
                this.Out_OuTouHeniZu_N1(N, CA)
            }
            }
        Next N
    } else {
        For( i = 1 To 10
            Select Case i
            Case 1
                if ( XKui1 > 0 ) {
                    N = XOutouKui1(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(1)
                    this.Out_OuTouHeniZu_N1(N, CA)
                }
            Case 2
                if ( XKui2 > 0 ) {
                    N = XOutouKui2(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(2)
                    this.Out_OuTouHeniZu_N1(N, CA)
                }
            Case 3
                if ( XKui3 > 0 ) {
                    N = XOutouKui3(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(3)
                    this.Out_OuTouHeniZu_N1(N, CA)
                }
            Case 4
                if ( XKui4 > 0 ) {
                    N = XOutouKui4(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(4)
                    this.Out_OuTouHeniZu_N1(N, CA)
                }
            Case 5
                if ( XKui5 > 0 ) {
                    N = XOutouKui5(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(5)
                    this.Out_OuTouHeniZu_N1(N, CA)
                }
            Case 6
                if ( XKui6 > 0 ) {
                    N = XOutouKui6(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(6)
                    this.Out_OuTouHeniZu_N1(N, CA)
                }
            Case 7
                if ( XKui7 > 0 ) {
                    N = XOutouKui7(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(7)
                    this.Out_OuTouHeniZu_N1(N, CA)
                }
            Case 8
                if ( XKui8 > 0 ) {
                    N = XOutouKui8(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(8)
                    this.Out_OuTouHeniZu_N1(N, CA)
                }
            Case 9
                if ( XKui9 > 0 ) {
                    N = XOutouKui9(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(9)
                    this.Out_OuTouHeniZu_N1(N, CA)
                }
            Case 10
                if ( XKui10 > 0 ) {
                    N = XOutouKui10(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(10)
                    this.Out_OuTouHeniZu_N1(N, CA)
                }
            Case } else {
                if ( XKui1 > 0 ) {
                    N = XOutouKui1(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(1)
                    this.Out_OuTouHeniZu_N1(N, CA)
                }
            End Select
        }
    }
} else {
    if ( EqualKui = 0 ) {
        For( N = 1 To 部材_max
            if ( ZZBuzaiBai(N) != 0 ) {
            if ( (InStr(Trim(部材名(N)), "杭") > 0 || InStr(部材名(N), "側壁") != 0) ) {
                NewPagePrt frmPrint.vsPrt1
                if ( CreateDxfFlag = 1 ) {
                    this.PLOT00(2, NAME1, OF1)
                    this.PLOT00(1, NAME1, OF1)
                }
                this.OUT_枠(HH, bTitle)
                this.Out_BuzaiNameSingle(N)
                this.Out_OuTouHeniZu_N1_JibanHeni_SuiHeiBane(N, CA)
            }
            }
        Next N
    } else {
        For( i = 1 To 10
            Select Case i
            Case 1
                if ( XKui1 > 0 ) {
                    N = XOutouKui1(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(1)
                    this.Out_OuTouHeniZu_N1_JibanHeni_SuiHeiBane(N, CA)
                }
            Case 2
                if ( XKui2 > 0 ) {
                    N = XOutouKui2(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(2)
                    this.Out_OuTouHeniZu_N1_JibanHeni_SuiHeiBane(N, CA)
                }
            Case 3
                if ( XKui3 > 0 ) {
                    N = XOutouKui3(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(3)
                    this.Out_OuTouHeniZu_N1_JibanHeni_SuiHeiBane(N, CA)
                }
            Case 4
                if ( XKui4 > 0 ) {
                    N = XOutouKui4(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(4)
                    this.Out_OuTouHeniZu_N1_JibanHeni_SuiHeiBane(N, CA)
                }
            Case 5
                if ( XKui5 > 0 ) {
                    N = XOutouKui5(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(5)
                    this.Out_OuTouHeniZu_N1_JibanHeni_SuiHeiBane(N, CA)
                }
            Case 6
                if ( XKui6 > 0 ) {
                    N = XOutouKui6(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(6)
                    this.Out_OuTouHeniZu_N1_JibanHeni_SuiHeiBane(N, CA)
                }
            Case 7
                if ( XKui7 > 0 ) {
                    N = XOutouKui7(1)
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    NewPagePrt frmPrint.vsPrt1
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(7)
                    this.Out_OuTouHeniZu_N1_JibanHeni_SuiHeiBane(N, CA)
                }
            Case 8
                if ( XKui8 > 0 ) {
                    N = XOutouKui8(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(8)
                    this.Out_OuTouHeniZu_N1_JibanHeni_SuiHeiBane(N, CA)
                }
            Case 9
                if ( XKui9 > 0 ) {
                    N = XOutouKui9(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(9)
                    this.Out_OuTouHeniZu_N1_JibanHeni_SuiHeiBane(N, CA)
                }
            Case 10
                if ( XKui10 > 0 ) {
                    N = XOutouKui10(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(10)
                    this.Out_OuTouHeniZu_N1_JibanHeni_SuiHeiBane(N, CA)
                }
            Case } else {
                if ( XKui1 > 0 ) {
                    N = XOutouKui1(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(1)
                    this.Out_OuTouHeniZu_N1_JibanHeni_SuiHeiBane(N, CA)
                }
            End Select
        }
    }
}
//
}

private void Out_OuTouHeniZu_N1(N As Double, CA)      // Frame（杭の応答変位図）
//
double var YYYYY1
double var YYYYY2
double var YYYYY3
double var UpXXX
double var DownXXX
double var UpXXXTyakuMokuTen
double var DownXXXTyakuMokuTen
var FFF1                    As Single
double var FFF2
double var FFF3
double var FFF4
var TEMP1                   As Single
double var LLL
double var KuiNN
double var KuiMax
double var i
double var X1
double var y1
double var X2
double var Y2
double var HiRiTsu
double var HiRiTsu1
var ZFX1                    As Single
var ZFY1                    As Single
var MojiZFX1                As Single
var MojiZFY1                As Single
var ZFX2                    As Single
var ZFY2                    As Single
var AZFX2                   As Single
var AZFY2                   As Single
double var GGG
double var Value1
double var Value2
double var Value3
double var OutouValue()
double var OutouAAA()
double var OutouFlag()
var TTT                     As Variant
var TTT2                    As Variant
var LINETYPE()              As Integer
double var HHH
var HH1                     As Single
double var j
double var HHHZ1()
var HHHZ2()                 As Single
double var SouMax
double var MeterAtari
double var AAAA()
double var BBBB
double var CCCC()
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
var QWX1                    As Single
var QWY1                    As Single
double Const OutouXXBai            = 0.8
double Const Add5                  = 5
//
if ( SuiheiBaneEqual = 1 ) {
    this.Out_OuTouHeniZu_N2(N, CA)        // Frame（杭の応答変位図）
    return;
}
HiRiTsu = 1
HiRiTsu1 = 10
LLL = 0
if ( InStr(Trim(部材名(N)), "杭") > 0 ) {
    if ( Len(Trim(部材名(N))) = 1 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 2, Len(Trim(部材名(N))) - 1))
    }
}
if ( InStr(Trim(部材名(N)), "側壁") > 0 ) {
    if ( Len(Trim(部材名(N))) = 2 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 3, Len(Trim(部材名(N))) - 1))
    }
}
KuiMax = N_KuiDD(KuiNN)
this.LINETYPE(KuiMax)
this.OutouValue(KuiMax)
this.OutouFlag(KuiMax)
this.OutouAAA(KuiMax)
this.HHHZ1(KuiMax)
this.HHHZ2(KuiMax)
GGG = BuzaiH(N)
this.AAAA(KuiMax)
this.CCCC(KuiMax)
BBBB = 0
MaxKuiOuTouLen = 0
For( i = 1 To KuiMax
    Select Case i
    Case 1
        Value1 = SMAX(PickOutouN(KuiNN, i, CA) - PickOutouN(KuiNN, KuiMax, CA), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value1 = Value1 * Value2
    Case KuiMax
        Value1 = 0 //PickOutouN(KuiNN, I, CA)
        Value2 = 0 //PickBaneN(KuiNN, I, CA)
        Value1 = Value1 * Value2
    Case } else {
        Value1 = SMAX(PickOutouN(KuiNN, i, CA) - PickOutouN(KuiNN, KuiMax, CA), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value1 = Value1 * Value2
    End Select
    MaxKuiOuTouLen = SMAX(MaxKuiOuTouLen, Value1)
    OutouAAA(i) = PickAAA_N(KuiNN, i)
    if ( i > 1 ) {
        if ( BBBB = RoundS(OutouAAA(i), 3) ) {
            AAAA(i - 1) = 1
        }
    }
    LINETYPE(i) = 0
    OutouValue(i) = Value1
    OutouFlag(i) = -9000000000#
    HHHZ1(i) = -9000000000#
    HHHZ2(i) = -9000000000#
    if ( i > 1 ) {
        CCCC(i) = RoundS(OutouAAA(i), 3) - BBBB
    }
    BBBB = RoundS(PickAAA_N(KuiNN, i), 3)
}
AAAA(KuiMax) = 1
j = 0
For( i = 1 To KuiMax
    Select Case i
    Case 1
        OutouFlag(i) = -1
        LINETYPE(i) = 1
    Case KuiMax
        OutouFlag(i) = 1
        LINETYPE(i) = 1
        j = j + 1
        HHHZ1(j) = OutouAAA(i)
        if ( j > 1 ) {
            HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
        } else {
            HHHZ2(j) = OutouAAA(i)
        }
    Case } else {
        if ( OutouAAA(i) = OutouAAA(i - 1) ) {
            if ( RoundS(OutouValue(i), 3) = RoundS(OutouValue(i - 1), 3) ) {
                OutouFlag(i - 1) = -9000000000#
                OutouFlag(i) = 0
                LINETYPE(i - 1) = 0
                LINETYPE(i) = 1
            } else {
                OutouFlag(i - 1) = 1
                OutouFlag(i) = -1
                LINETYPE(i - 1) = 0
                LINETYPE(i) = 1
            }
            j = j + 1
            HHHZ1(j) = OutouAAA(i)
            if ( j > 1 ) {
                HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
            } else {
                HHHZ2(j) = OutouAAA(i)
            }
        } else {
            OutouFlag(i) = 0
            LINETYPE(i) = 2
        }
    End Select
}
SouMax = j
HH1 = PickAAA_N(KuiNN, KuiMax)
HHH = HH1 / KuiLengthMax
TEMP1 = frmPrint.vsPrt1.PenWidth
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
this.DrawLineZZ(0, 0, 0, KuiMaxLen * HHH * OuTouBai)
frmPrint.vsPrt1.PenWidth = TEMP1
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
MeterAtari = KuiMaxLen * HHH * OuTouBai / HH1
// グラフの上に応答変位荷重を印字
if ( fMainForm.SICheck = True ) { //SI単位チェック
    TTT = "　　　　　　　　　　　 　応答変位荷重 (kN/m)"
} else {
    TTT = "　　　　　　　　　　　 　応答変位荷重 (tf/m)"
}
frmPrint.vsPrt1.TextAngle = 0 * 10
frmPrint.vsPrt1.FontSize = GraphTitleMojiSize * 1.5 //1.25  nagase
MojiZFX1 = OutouStartX - CON_X(frmPrint.vsPrt1.FontSize * FFLen(TTT) / 2)
MojiZFY1 = OutouStartY - CON_Y(frmPrint.vsPrt1.FontSize) * 2 - OuTouBai

MyCurrentX = Int(CSng(MojiZFX1))
MyCurrentY = Int(CSng(MojiZFY1))
QWX1 = MyCurrentX
QWY1 = MyCurrentY
PrintoutPrt frmPrint.vsPrt1, TTT
if ( CreateDxfFlag = 1 ) {
    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
    ParamXPoint = QWX1
    ParamYpoint = QWY1
    ParamText = TTT
    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
}
//
For( i = 1 To KuiMax
    Select Case i
    Case 1
        LLL = PickAAA_N(KuiNN, i)
        Value1 = SMAX(PickOutouN(KuiNN, i, CA) - PickOutouN(KuiNN, KuiMax, CA), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
        AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
        if ( MaxKuiOuTouLen != 0 ) {
        if ( GGG = 1 ) {
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N)) + Value3 * HiRiTsu / MaxKuiOuTouLen * MaxKuiOuTou * OutouXXBai
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
        } else {
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N)) + Value3 * HiRiTsu1 / MaxKuiOuTouLen * MaxKuiOuTou
        }
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1, 2       // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    MojiZFY1 = ZFY2 - SouatsuMojiHight * 18
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case KuiMax
        LLL = PickAAA_N(KuiNN, i)
        Value1 = 0 //PickOutouN(KuiNN, I, CA)
        Value2 = 0 //PickBaneN(KuiNN, I, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N))
        AZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N))
        if ( MaxKuiOuTouLen != 0 ) {
        if ( GGG = 1 ) {
            ZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N)) + Value3 * HiRiTsu / MaxKuiOuTouLen * MaxKuiOuTou * OutouXXBai
            ZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N) - LLL)
        } else {
            ZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N))
            ZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N) - LLL) + Value3 * HiRiTsu1 / MaxKuiOuTouLen * MaxKuiOuTou
        }
        }
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1, 2   // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case } else {
        LLL = PickAAA_N(KuiNN, i)
        Value1 = SMAX(PickOutouN(KuiNN, i, CA) - PickOutouN(KuiNN, KuiMax, CA), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value3 = Value1 * Value2
        if ( MaxKuiOuTouLen != 0 ) {
        if ( GGG = 1 ) {
            AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
            AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N) - LLL)
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N)) + Value3 * HiRiTsu / MaxKuiOuTouLen * MaxKuiOuTou * OutouXXBai
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N) - LLL)
        } else {
            AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N) + LLL)
            AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N) + LLL)
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N)) + Value3 * HiRiTsu1 / MaxKuiOuTouLen * MaxKuiOuTou
        }
        }
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( OutouCase7 = 0 ) {
            if ( LINETYPE(i) > 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add5
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE(i) > 1 ) {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
        } else {
            if ( LINETYPE(i) > 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE(i) > 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1
            if ( LINETYPE(i) = 1 || (LINETYPE(i) != 2 $$ LINETYPE(i + 1) = 1) ) {
                if ( OutouFlag(i) != -9000000000# ) {
                    if ( GGG = 1 ) {
                        MojiZFX1 = ZFX2 + SouatsuMojiHight
                        this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                    } else {
                        MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                        this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                    }
                    this.Outou_KakuSub4(GGG)
                    frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                    if ( GGG = 1 ) {
                        this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                    } else {
                        TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                        MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                    }
                    MyCurrentX = Int(CSng(MojiZFX1))
                    MyCurrentY = Int(CSng(MojiZFY1))
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, TTT
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = TTT
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                }
            }
        Case 2      // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    End Select
}
//
if ( SunPouSenX1 = 1 ) {     // 寸法線を書かない場合はここで終了。
    return;
}
//
ZFX1 = OutouStartX
ZFY1 = OutouStartY
ZFX2 = OutouStartX + SunPouStartX1
ZFY2 = OutouStartY
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX
ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
ZFX2 = OutouStartX + SunPouStartX1
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX + SunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
ZFY1 = OutouStartY
ZFX2 = OutouStartX + SunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
this.OuTouPrintUp1(1, SunPouMojiSize1, HH1, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2)) // 杭長の印字
UpXXX = -9000000000#
DownXXX = -9000000000#
YYYYY1 = 0
YYYYY2 = 0
For( i = 1 To SouMax
    YYYYY1 = YYYYY1 + HHHZ2(i) * MeterAtari
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    ZFX1 = OutouStartX
    ZFY1 = OutouStartY + YYYYY1
    ZFX2 = OutouStartX + SunPouStartX2
    ZFY2 = OutouStartY + YYYYY1
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = OutouStartX + SunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
    ZFY1 = OutouStartY + YYYYY2
    ZFX2 = OutouStartX + SunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
    ZFY2 = OutouStartY + YYYYY1
    this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
    this.OuTouPrintUp2(SunPouMojiSize2, HHHZ2(i), CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXX, DownXXX) // 杭長の印字
    YYYYY2 = YYYYY1
}
//
if ( SunPouSenX2 = 1 ) {     // 着目点単位の寸法線を書かない場合はここで終了。
    return;
}
//
YYYYY1 = 0
YYYYY2 = 0
YYYYY3 = 0
FFF1 = 0
FFF2 = 0
FFF3 = 0
FFF4 = 0
UpXXXTyakuMokuTen = -9000000000#
DownXXXTyakuMokuTen = -9000000000#
For( i = 2 To KuiMax
    FFF3 = PickAAA_N(KuiNN, i)
    if ( AAAA(i) = 1 ) {
        if ( FFF1 = 0 ) {
            if ( i = 2 ) {
                FFF1 = FFF3
            } else {
                FFF1 = FFF3 - PickAAA_N(KuiNN, i - 1)
            }
            FFF2 = 1
            YYYYY1 = FFF3 * MeterAtari
            frmPrint.vsPrt1.PenWidth = SunPouPenWidth
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            ZFX1 = OutouStartX
            ZFY1 = OutouStartY + YYYYY1
            ZFX2 = OutouStartX + SunPouStartX3
            ZFY2 = OutouStartY + YYYYY1
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
            ZFY1 = OutouStartY + YYYYY2
            ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
            ZFY2 = OutouStartY + YYYYY1
            this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
            this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
            YYYYY2 = YYYYY1
            FFF1 = 0
            FFF2 = 0
            FFF4 = FFF3
        } else {
            if ( RoundS(FFF1, 3) = RoundS(CCCC(i), 3) ) {
                FFF2 = FFF2 + 1
                YYYYY1 = FFF3 * MeterAtari
                frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                ZFX1 = OutouStartX
                ZFY1 = OutouStartY + YYYYY1
                ZFX2 = OutouStartX + SunPouStartX3
                ZFY2 = OutouStartY + YYYYY1
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
                ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY1 = OutouStartY + YYYYY2
                ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY2 = OutouStartY + YYYYY1
                this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                YYYYY2 = YYYYY1
                FFF1 = 0
                FFF2 = 0
                FFF4 = FFF3
            } else {
                YYYYY1 = FFF4 * MeterAtari
                frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                ZFX1 = OutouStartX
                ZFY1 = OutouStartY + YYYYY1
                ZFX2 = OutouStartX + SunPouStartX3
                ZFY2 = OutouStartY + YYYYY1
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
                ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY1 = OutouStartY + YYYYY2
                ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY2 = OutouStartY + YYYYY1
                this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                YYYYY2 = YYYYY1
                FFF1 = FFF3 - FFF4
                FFF2 = 1
                YYYYY1 = FFF3 * MeterAtari
                frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                ZFX1 = OutouStartX
                ZFY1 = OutouStartY + YYYYY1
                ZFX2 = OutouStartX + SunPouStartX3
                ZFY2 = OutouStartY + YYYYY1
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
                ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY1 = OutouStartY + YYYYY2
                ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY2 = OutouStartY + YYYYY1
                this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                YYYYY2 = YYYYY1
                FFF1 = 0
                FFF2 = 0
                FFF4 = FFF3
            }
        }
    } else {
        if ( i = 2 ) {
            FFF1 = CCCC(i)
            FFF2 = 1
        } else {
            if ( CCCC(i) = 0 ) {
                FFF1 = 0
                FFF2 = 0
            } else {
                if ( FFF1 = 0 ) {
                    FFF1 = CCCC(i)
                    FFF2 = 1
                } else {
                    if ( RoundS(FFF1, 3) = RoundS(CCCC(i), 3) ) {
                        FFF2 = FFF2 + 1
                    } else {
                        YYYYY1 = FFF4 * MeterAtari
                        frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                        if ( CreateDxfFlag = 1 ) {
                            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                        }
                        ZFX1 = OutouStartX
                        ZFY1 = OutouStartY + YYYYY1
                        ZFX2 = OutouStartX + SunPouStartX3
                        ZFY2 = OutouStartY + YYYYY1
                        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                        }
                        ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY1 = OutouStartY + YYYYY2
                        ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY2 = OutouStartY + YYYYY1
                        this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                        this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                        YYYYY2 = YYYYY1
                        FFF1 = FFF3 - FFF4
                        FFF2 = 1
                        FFF4 = FFF3
                    }
                }
            }
        }
    }
    FFF4 = FFF3
}
//
}

private void Out_OuTouHeniZu_G2(N As Double, CA As Double, OU As Double, Total) //////08/06/04     // For( Gouiki（杭の応答変位図）
//
double var YYYYY1
double var YYYYY2
double var YYYYY3
double var UpXXX
double var DownXXX
double var UpXXXTyakuMokuTen
double var DownXXXTyakuMokuTen
var FFF1                    As Single
double var FFF2
double var FFF3
double var FFF4
double var LLL
double var KuiNN
double var KuiMax
double var i
double var X1
double var y1
double var X2
double var Y2
double var HiRiTsu
double var HiRiTsu1
var ZFX1                    As Single
var ZFY1                    As Single
var MojiZFX1                As Single
var MojiZFY1                As Single
var ZFX2                    As Single
var ZFY2                    As Single
var AZFX2                   As Single
var AZFY2                   As Single
double var GGG
double var Value1
double var Value2
double var Value3
double var OutouValue()
double var OutouAAA()
double var OutouFlag()
var TTT                     As Variant
var TTT2                    As Variant
double var OuTouN
var LINETYPE()              As Integer
double var HHH
var HH1                     As Single
var TEMP1                   As Single
double var j
double var HHHZ1()
var HHHZ2()                 As Single
var Bane2()                 As Single
var SuujiP()                As Single
double var SouMax
double var MeterAtari
double var AAAA()
double var BBBB
double var CCCC()
double Const OutouXXBai            = 0.8
double Const Add5                  = 5
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
var QWX1                    As Single
var QWY1                    As Single
double var Flg //////08/06/04
//
Flg = Total //////08/06/04
Total = 0
OuTouN = OU
HiRiTsu = 1
HiRiTsu1 = 10
LLL = 0
if ( InStr(Trim(部材名(N)), "杭") > 0 ) {
    if ( Len(Trim(部材名(N))) = 1 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 2, Len(Trim(部材名(N))) - 1))
    }
}
if ( InStr(Trim(部材名(N)), "側壁") > 0 ) {
    if ( Len(Trim(部材名(N))) = 2 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 3, Len(Trim(部材名(N))) - 1))
    }
}
KuiMax = G_KuiDD(KuiNN)
this.LINETYPE(KuiMax)
this.OutouValue(KuiMax)
this.OutouFlag(KuiMax)
this.OutouAAA(KuiMax)
this.HHHZ1(KuiMax)
this.HHHZ2(KuiMax)
GGG = BuzaiH(N)
this.AAAA(KuiMax)
this.CCCC(KuiMax)
this.Bane2(KuiMax)
this.SuujiP(KuiMax)
MaxKuiOuTouLen = 0
For( i = 1 To KuiMax
    Select Case i
    Case 1
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value1 = Value1 * Value2
    Case KuiMax
        Value1 = 0 //PickOutouG(KuiNN, I)
        Value2 = 0 //PickBaneG(KuiNN, I, CA)
        Value1 = Value1 * Value2
    Case } else {
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value1 = Value1 * Value2
    End Select
    LINETYPE(i) = 0
    OutouAAA(i) = PickAAA_G(KuiNN, i)
    if ( i > 1 ) {
        if ( BBBB = RoundS(OutouAAA(i), 3) ) {
            AAAA(i - 1) = 1
        }
    }
    MaxKuiOuTouLen = SMAX(MaxKuiOuTouLen, Value1)
    OutouValue(i) = Value1
    Bane2(i) = Value2
    OutouFlag(i) = -9000000000#
    HHHZ1(i) = -9000000000#
    HHHZ2(i) = -9000000000#
    SuujiP(i) = 0
    if ( i > 1 ) {
        CCCC(i) = RoundS(OutouAAA(i), 3) - BBBB
    }
    BBBB = RoundS(PickAAA_G(KuiNN, i), 3)
    Total = Total + Value1 //////////08/06/04
}
if ( Total = 0 || Flg = 9 ) { return; //////////08/06/04
AAAA(KuiMax) = 1
j = 0
For( i = 1 To KuiMax
    Select Case i
    Case 1
        OutouFlag(i) = 0
        LINETYPE(i) = 1
    Case KuiMax
        OutouFlag(i) = 0
        LINETYPE(i) = 1
        j = j + 1
        HHHZ1(j) = OutouAAA(i)
        if ( j > 1 ) {
            HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
        } else {
            HHHZ2(j) = OutouAAA(i)
        }
    Case } else {
        if ( RoundS(OutouAAA(i), 3) = RoundS(OutouAAA(i - 1), 3) ) {
            if ( RoundS(OutouValue(i), 3) = RoundS(OutouValue(i - 1), 3) ) {
                OutouFlag(i - 1) = -9000000000#
                OutouFlag(i) = 0
                LINETYPE(i - 1) = 0
                LINETYPE(i) = 1
            } else {
                OutouFlag(i - 1) = 1
                OutouFlag(i) = -1
                LINETYPE(i - 1) = 0
                LINETYPE(i) = 1
            }
            if ( SouatrsuValuePrintA = 1 ) {
                if ( Int(Bane2(i)) = Int(Bane2(i - 1)) ) {
                    SuujiP(i) = 1
                    SuujiP(i - 1) = 1
                }
            }
            if ( Int(Bane2(i)) = Int(Bane2(i - 1)) ) {
            } else {
                j = j + 1
                HHHZ1(j) = OutouAAA(i)
                if ( j > 1 ) {
                    HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
                } else {
                    HHHZ2(j) = OutouAAA(i)
                }
            }
        } else {
            OutouFlag(i) = 0
            LINETYPE(i) = 2
        }
    End Select
}
SouMax = j
HH1 = PickAAA_G(KuiNN, KuiMax)
HHH = HH1 / KuiLengthMax
TEMP1 = frmPrint.vsPrt1.PenWidth
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
this.DrawLineZZ(0, 0, 0, KuiMaxLen * HHH * OuTouBai)
MeterAtari = KuiMaxLen * HHH * OuTouBai / HH1
frmPrint.vsPrt1.PenWidth = TEMP1
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
// グラフの上に応答変位荷重を印字
if ( fMainForm.SICheck = True ) { //SI単位チェック
    TTT = "　　　　　　　　　　 応答変位荷重 (kN/m)"
} else {
    TTT = "　　　　　　　　　　 応答変位荷重 (tf/m)"
}
frmPrint.vsPrt1.TextAngle = 0 * 10
frmPrint.vsPrt1.FontSize = GraphTitleMojiSize * 1.5 //1.25 nagase
MojiZFX1 = OutouStartX - CON_X(frmPrint.vsPrt1.FontSize * FFLen(TTT) / 2)
MojiZFY1 = OutouStartY - CON_Y(frmPrint.vsPrt1.FontSize) * 2 - OuTouBai

MyCurrentX = Int(CSng(MojiZFX1))
MyCurrentY = Int(CSng(MojiZFY1))
QWX1 = MyCurrentX
QWY1 = MyCurrentY
PrintoutPrt frmPrint.vsPrt1, TTT
if ( CreateDxfFlag = 1 ) {
    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
    ParamXPoint = QWX1
    ParamYpoint = QWY1
    ParamText = TTT
    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
}
//
For( i = 1 To KuiMax
    Select Case i
    Case 1
        LLL = PickAAA_G(KuiNN, i)
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
        AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
        if ( GGG = 1 $$ MaxKuiOuTouLen != 0 ) {
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N)) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxKuiOuTou * OutouXXBai
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
        } else {
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N)) + Value3 * HiRiTsu1
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1, 2     // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    MojiZFY1 = ZFY2 - SouatsuMojiHight * 18
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case KuiMax
        LLL = PickAAA_G(KuiNN, i)
        Value1 = 0 //PickOutouG(KuiNN, I)
        Value2 = 0 //PickBaneG(KuiNN, I, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N))
        AZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N))
        if ( GGG = 1 $$ MaxKuiOuTouLen != 0 ) {
            ZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N)) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxKuiOuTou * OutouXXBai
            ZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N) - LLL)
        } else {
            ZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N))
            ZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N) - LLL) + Value3 * HiRiTsu1
        }
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1, 2     // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case } else {
        LLL = PickAAA_G(KuiNN, i)
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value3 = Value1 * Value2
        if ( GGG = 1 $$ MaxKuiOuTouLen != 0 ) {
            AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
            AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N) - LLL)
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N)) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxKuiOuTou * OutouXXBai
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N) - LLL)
        } else {
            AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N) + LLL)
            AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N) + LLL)
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N)) + Value3 * HiRiTsu1
        }
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            if ( OutouCase7 = 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add5
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE(i) > 1 ) {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            } else {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE(i) > 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1
            if ( LINETYPE(i) = 1 || (LINETYPE(i) != 2 $$ LINETYPE(i + 1) = 1) ) {
                if ( OutouFlag(i) != -9000000000# ) {
                    if ( SuujiP(i) = 0 ) {
                        if ( GGG = 1 ) {
                            MojiZFX1 = ZFX2 + SouatsuMojiHight
                            this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                        } else {
                            MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                            this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                        }
                        this.Outou_KakuSub4(GGG)
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        if ( GGG = 1 ) {
                            this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                        } else {
                            TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                            MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                        }
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                    }
                }
            }
        Case 2      // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    End Select
}
//
if ( SunPouSenX1 = 1 ) {     // 寸法線を書かない場合はここで終了。
    return;
}
//
ZFX1 = OutouStartX
ZFY1 = OutouStartY
ZFX2 = OutouStartX + SunPouStartX1
ZFY2 = OutouStartY
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX
ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
ZFX2 = OutouStartX + SunPouStartX1
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX + SunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
ZFY1 = OutouStartY
ZFX2 = OutouStartX + SunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
this.OuTouPrintUp1(1, SunPouMojiSize1, HH1, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2)) // 杭長の印字
UpXXX = -9000000000#
DownXXX = -9000000000#
YYYYY1 = 0
YYYYY2 = 0
For( i = 1 To SouMax
    YYYYY1 = YYYYY1 + HHHZ2(i) * MeterAtari
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    ZFX1 = OutouStartX
    ZFY1 = OutouStartY + YYYYY1
    ZFX2 = OutouStartX + SunPouStartX2
    ZFY2 = OutouStartY + YYYYY1
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = OutouStartX + SunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
    ZFY1 = OutouStartY + YYYYY2
    ZFX2 = OutouStartX + SunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
    ZFY2 = OutouStartY + YYYYY1
    this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
    this.OuTouPrintUp2(SunPouMojiSize2, HHHZ2(i), CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXX, DownXXX) // 杭長の印字
    YYYYY2 = YYYYY1
}
//
if ( SunPouSenX2 = 1 ) {     // 着目点単位の寸法線を書かない場合はここで終了。
    return;
}
//
YYYYY1 = 0
YYYYY2 = 0
YYYYY3 = 0
FFF1 = 0
FFF2 = 0
FFF3 = 0
FFF4 = 0
UpXXXTyakuMokuTen = -9000000000#
DownXXXTyakuMokuTen = -9000000000#
For( i = 2 To KuiMax
    FFF3 = PickAAA_G(KuiNN, i)
    if ( AAAA(i) = 1 ) {
        if ( FFF1 = 0 ) {
            if ( i = 2 ) {
                FFF1 = FFF3
            } else {
                FFF1 = FFF3 - PickAAA_G(KuiNN, i - 1)
            }
            FFF2 = 1
            YYYYY1 = FFF3 * MeterAtari
            frmPrint.vsPrt1.PenWidth = SunPouPenWidth
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            ZFX1 = OutouStartX
            ZFY1 = OutouStartY + YYYYY1
            ZFX2 = OutouStartX + SunPouStartX3
            ZFY2 = OutouStartY + YYYYY1
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
            ZFY1 = OutouStartY + YYYYY2
            ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
            ZFY2 = OutouStartY + YYYYY1
            this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
            this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
            YYYYY2 = YYYYY1
            FFF1 = 0
            FFF2 = 0
            FFF4 = FFF3
        } else {
            if ( RoundS(FFF1, 3) = RoundS(CCCC(i), 3) ) {
                FFF2 = FFF2 + 1
                YYYYY1 = FFF3 * MeterAtari
                frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                ZFX1 = OutouStartX
                ZFY1 = OutouStartY + YYYYY1
                ZFX2 = OutouStartX + SunPouStartX3
                ZFY2 = OutouStartY + YYYYY1
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
                ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY1 = OutouStartY + YYYYY2
                ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY2 = OutouStartY + YYYYY1
                this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                YYYYY2 = YYYYY1
                FFF1 = 0
                FFF2 = 0
                FFF4 = FFF3
            } else {
                YYYYY1 = FFF4 * MeterAtari
                frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                ZFX1 = OutouStartX
                ZFY1 = OutouStartY + YYYYY1
                ZFX2 = OutouStartX + SunPouStartX3
                ZFY2 = OutouStartY + YYYYY1
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
                ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY1 = OutouStartY + YYYYY2
                ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY2 = OutouStartY + YYYYY1
                this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                YYYYY2 = YYYYY1
                FFF1 = FFF3 - FFF4
                FFF2 = 1
                YYYYY1 = FFF3 * MeterAtari
                frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                ZFX1 = OutouStartX
                ZFY1 = OutouStartY + YYYYY1
                ZFX2 = OutouStartX + SunPouStartX3
                ZFY2 = OutouStartY + YYYYY1
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
                ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY1 = OutouStartY + YYYYY2
                ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY2 = OutouStartY + YYYYY1
                this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                YYYYY2 = YYYYY1
                FFF1 = 0
                FFF2 = 0
                FFF4 = FFF3
            }
        }
    } else {
        if ( i = 2 ) {
            FFF1 = CCCC(i)
            FFF2 = 1
        } else {
            if ( CCCC(i) = 0 ) {
                FFF1 = 0
                FFF2 = 0
            } else {
                if ( FFF1 = 0 ) {
                    FFF1 = CCCC(i)
                    FFF2 = 1
                } else {
                    if ( RoundS(FFF1, 3) = RoundS(CCCC(i), 3) ) {
                        FFF2 = FFF2 + 1
                    } else {
                        YYYYY1 = FFF4 * MeterAtari
                        frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                        if ( CreateDxfFlag = 1 ) {
                            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                        }
                        ZFX1 = OutouStartX
                        ZFY1 = OutouStartY + YYYYY1
                        ZFX2 = OutouStartX + SunPouStartX3
                        ZFY2 = OutouStartY + YYYYY1
                        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                        }
                        ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY1 = OutouStartY + YYYYY2
                        ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY2 = OutouStartY + YYYYY1
                        this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                        this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                        YYYYY2 = YYYYY1
                        FFF1 = FFF3 - FFF4
                        FFF2 = 1
                        FFF4 = FFF3
                    }
                }
            }
        }
    }
    FFF4 = FFF3
}
//
}

private void Out_OuTouHeniZu_N2(N As Double, CA)      // Frame（杭の応答変位図）
//
double var YYYYY1
double var YYYYY2
double var YYYYY3
double var UpXXX
double var DownXXX
double var UpXXXTyakuMokuTen
double var DownXXXTyakuMokuTen
var FFF1                    As Single
double var FFF2
double var FFF3
double var FFF4
var TEMP1                   As Single
double var LLL
double var KuiNN
double var KuiMax
double var i
double var X1
double var y1
double var X2
double var Y2
double var HiRiTsu
double var HiRiTsu1
var ZFX1                    As Single
var ZFY1                    As Single
var MojiZFX1                As Single
var MojiZFY1                As Single
var ZFX2                    As Single
var ZFY2                    As Single
var AZFX2                   As Single
var AZFY2                   As Single
double var GGG
double var Value1
double var Value2
double var Value3
double var OutouValue()
double var OutouAAA()
double var OutouFlag()
var TTT                     As Variant
var TTT2                    As Variant
var LINETYPE()              As Integer
double var HHH
var HH1                     As Single
var SuujiP()                As Single
double var j
double var HHHZ1()
var HHHZ2()                 As Single
double var SouMax
double var MeterAtari
var Bane2()                 As Single
double var AAAA()
double var BBBB
double var CCCC()
double Const OutouXXBai            = 0.8
double Const Add5                  = 5
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
var QWX1                    As Single
var QWY1                    As Single
//
HiRiTsu = 1
HiRiTsu1 = 10
LLL = 0
if ( InStr(Trim(部材名(N)), "杭") > 0 ) {
    if ( Len(Trim(部材名(N))) = 1 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 2, Len(Trim(部材名(N))) - 1))
    }
}
if ( InStr(Trim(部材名(N)), "側壁") > 0 ) {
    if ( Len(Trim(部材名(N))) = 2 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 3, Len(Trim(部材名(N))) - 1))
    }
}
KuiMax = N_KuiDD(KuiNN)
this.LINETYPE(KuiMax)
this.OutouValue(KuiMax)
this.OutouFlag(KuiMax)
this.OutouAAA(KuiMax)
this.HHHZ1(KuiMax)
this.HHHZ2(KuiMax)
GGG = BuzaiH(N)
this.AAAA(KuiMax)
this.Bane2(KuiMax)
this.CCCC(KuiMax)
this.SuujiP(KuiMax)
BBBB = 0
MaxKuiOuTouLen = 0
For( i = 1 To KuiMax
    Select Case i
    Case 1
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value1 = Value1 * Value2
    Case KuiMax
        Value1 = 0 //PickOutouN(KuiNN, I, OuTouHHH)
        Value2 = 0 //PickBaneN(KuiNN, I, CA)
        Value1 = Value1 * Value2
    Case } else {
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value1 = Value1 * Value2
    End Select
    MaxKuiOuTouLen = SMAX(MaxKuiOuTouLen, Value1)
    OutouAAA(i) = PickAAA_N(KuiNN, i)
    if ( i > 1 ) {
        if ( BBBB = RoundS(OutouAAA(i), 3) ) {
            AAAA(i - 1) = 1
        }
    }
    LINETYPE(i) = 0
    OutouValue(i) = Value1
    OutouFlag(i) = -9000000000#
    HHHZ1(i) = -9000000000#
    HHHZ2(i) = -9000000000#
    Bane2(i) = Value2
    SuujiP(i) = 0
    if ( i > 1 ) {
        CCCC(i) = RoundS(OutouAAA(i), 3) - BBBB
    }
    BBBB = RoundS(PickAAA_N(KuiNN, i), 3)
}
AAAA(KuiMax) = 1
j = 0
For( i = 1 To KuiMax
    Select Case i
    Case 1
        OutouFlag(i) = -1
        LINETYPE(i) = 1
    Case KuiMax
        OutouFlag(i) = 1
        LINETYPE(i) = 1
        j = j + 1
        HHHZ1(j) = OutouAAA(i)
        if ( j > 1 ) {
            HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
        } else {
            HHHZ2(j) = OutouAAA(i)
        }
    Case } else {
        if ( OutouAAA(i) = OutouAAA(i - 1) ) {
            if ( RoundS(OutouValue(i), 3) = RoundS(OutouValue(i - 1), 3) ) {
                OutouFlag(i - 1) = -9000000000#
                OutouFlag(i) = 0
                LINETYPE(i - 1) = 0
                LINETYPE(i) = 1
            } else {
                OutouFlag(i - 1) = 1
                OutouFlag(i) = -1
                LINETYPE(i - 1) = 0
                LINETYPE(i) = 1
            }
            if ( SouatrsuValuePrintA = 1 ) {
                if ( Int(Bane2(i)) = Int(Bane2(i - 1)) ) {
                    SuujiP(i) = 1
                    SuujiP(i - 1) = 1
                }
            }
            if ( Int(Bane2(i)) = Int(Bane2(i - 1)) ) {
            } else {
                j = j + 1
                HHHZ1(j) = OutouAAA(i)
                if ( j > 1 ) {
                    HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
                } else {
                    HHHZ2(j) = OutouAAA(i)
                }
            }
        } else {
            OutouFlag(i) = 0
            LINETYPE(i) = 2
        }
    End Select
}
SouMax = j
HH1 = PickAAA_N(KuiNN, KuiMax)
HHH = HH1 / KuiLengthMax
TEMP1 = frmPrint.vsPrt1.PenWidth
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
this.DrawLineZZ(0, 0, 0, KuiMaxLen * HHH * OuTouBai)
frmPrint.vsPrt1.PenWidth = TEMP1
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
MeterAtari = KuiMaxLen * HHH * OuTouBai / HH1
// グラフの上に応答変位荷重を印字
if ( fMainForm.SICheck = True ) { //SI単位チェック
    TTT = "　　　　　　　　　　　 　応答変位荷重 (kN/m)"
} else {
    TTT = "　　　　　　　　　　　 　応答変位荷重 (tf/m)"
}
frmPrint.vsPrt1.TextAngle = 0 * 10
frmPrint.vsPrt1.FontSize = GraphTitleMojiSize * 1.5 //1.25  nagase
MojiZFX1 = OutouStartX - CON_X(frmPrint.vsPrt1.FontSize * FFLen(TTT) / 2)
MojiZFY1 = OutouStartY - CON_Y(frmPrint.vsPrt1.FontSize) * 2 - OuTouBai

MyCurrentX = Int(CSng(MojiZFX1))
MyCurrentY = Int(CSng(MojiZFY1))
QWX1 = MyCurrentX
QWY1 = MyCurrentY
PrintoutPrt frmPrint.vsPrt1, TTT
if ( CreateDxfFlag = 1 ) {
    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
    ParamXPoint = QWX1
    ParamYpoint = QWY1
    ParamText = TTT
    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
}
//
For( i = 1 To KuiMax
    Select Case i
    Case 1
        LLL = PickAAA_N(KuiNN, i)
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
        AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
        if ( MaxKuiOuTouLen != 0 ) {
        if ( GGG = 1 ) {
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N)) + Value3 * HiRiTsu / MaxKuiOuTouLen * MaxKuiOuTou * OutouXXBai
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
        } else {
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N)) + Value3 * HiRiTsu1 / MaxKuiOuTouLen * MaxKuiOuTou
        }
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1, 2       // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    MojiZFY1 = ZFY2 - SouatsuMojiHight * 18
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case KuiMax
        LLL = PickAAA_N(KuiNN, i)
        Value1 = 0 //PickOutouN(KuiNN, I, OuTouHHH)
        Value2 = 0 //PickBaneN(KuiNN, I, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N))
        AZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N))
        if ( MaxKuiOuTouLen != 0 ) {
        if ( GGG = 1 ) {
            ZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N)) + Value3 * HiRiTsu / MaxKuiOuTouLen * MaxKuiOuTou * OutouXXBai
            ZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N) - LLL)
        } else {
            ZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N))
            ZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N) - LLL) + Value3 * HiRiTsu1 / MaxKuiOuTouLen * MaxKuiOuTou
        }
        }
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1, 2   // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case } else {
        LLL = PickAAA_N(KuiNN, i)
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value3 = Value1 * Value2
        if ( MaxKuiOuTouLen != 0 ) {
        if ( GGG = 1 ) {
            AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
            AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N) - LLL)
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N)) + Value3 * HiRiTsu / MaxKuiOuTouLen * MaxKuiOuTou * OutouXXBai
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N) - LLL)
        } else {
            AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N) + LLL)
            AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N) + LLL)
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N)) + Value3 * HiRiTsu1 / MaxKuiOuTouLen * MaxKuiOuTou
        }
        }
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( OutouCase7 = 0 ) {
            if ( LINETYPE(i) > 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add5
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE(i) > 1 ) {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
        } else {
            if ( LINETYPE(i) > 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE(i) > 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1
            if ( LINETYPE(i) = 1 || (LINETYPE(i) != 2 $$ LINETYPE(i + 1) = 1) ) {
                if ( OutouFlag(i) != -9000000000# ) {
                    if ( SuujiP(i) = 0 ) {
                        if ( GGG = 1 ) {
                            MojiZFX1 = ZFX2 + SouatsuMojiHight
                            this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                        } else {
                            MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                            this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                        }
                        this.Outou_KakuSub4(GGG)
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        if ( GGG = 1 ) {
                            this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                        } else {
                            TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                            MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                        }
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                    }
                }
            }
        Case 2      // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    End Select
}
//
if ( SunPouSenX1 = 1 ) {     // 寸法線を書かない場合はここで終了。
    return;
}
//
ZFX1 = OutouStartX
ZFY1 = OutouStartY
ZFX2 = OutouStartX + SunPouStartX1
ZFY2 = OutouStartY
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX
ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
ZFX2 = OutouStartX + SunPouStartX1
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX + SunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
ZFY1 = OutouStartY
ZFX2 = OutouStartX + SunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
this.OuTouPrintUp1(1, SunPouMojiSize1, HH1, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2)) // 杭長の印字
UpXXX = -9000000000#
DownXXX = -9000000000#
YYYYY1 = 0
YYYYY2 = 0
For( i = 1 To SouMax
    YYYYY1 = YYYYY1 + HHHZ2(i) * MeterAtari
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    ZFX1 = OutouStartX
    ZFY1 = OutouStartY + YYYYY1
    ZFX2 = OutouStartX + SunPouStartX2
    ZFY2 = OutouStartY + YYYYY1
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = OutouStartX + SunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
    ZFY1 = OutouStartY + YYYYY2
    ZFX2 = OutouStartX + SunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
    ZFY2 = OutouStartY + YYYYY1
    this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
    this.OuTouPrintUp2(SunPouMojiSize2, HHHZ2(i), CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXX, DownXXX) // 杭長の印字
    YYYYY2 = YYYYY1
}
//
if ( SunPouSenX2 = 1 ) {     // 着目点単位の寸法線を書かない場合はここで終了。
    return;
}
//
YYYYY1 = 0
YYYYY2 = 0
YYYYY3 = 0
FFF1 = 0
FFF2 = 0
FFF3 = 0
FFF4 = 0
UpXXXTyakuMokuTen = -9000000000#
DownXXXTyakuMokuTen = -9000000000#
For( i = 2 To KuiMax
    FFF3 = PickAAA_N(KuiNN, i)
    if ( AAAA(i) = 1 ) {
        if ( FFF1 = 0 ) {
            if ( i = 2 ) {
                FFF1 = FFF3
            } else {
                FFF1 = FFF3 - PickAAA_N(KuiNN, i - 1)
            }
            FFF2 = 1
            YYYYY1 = FFF3 * MeterAtari
            frmPrint.vsPrt1.PenWidth = SunPouPenWidth
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            ZFX1 = OutouStartX
            ZFY1 = OutouStartY + YYYYY1
            ZFX2 = OutouStartX + SunPouStartX3
            ZFY2 = OutouStartY + YYYYY1
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
            ZFY1 = OutouStartY + YYYYY2
            ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
            ZFY2 = OutouStartY + YYYYY1
            this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
            this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
            YYYYY2 = YYYYY1
            FFF1 = 0
            FFF2 = 0
            FFF4 = FFF3
        } else {
            if ( RoundS(FFF1, 3) = RoundS(CCCC(i), 3) ) {
                FFF2 = FFF2 + 1
                YYYYY1 = FFF3 * MeterAtari
                frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                ZFX1 = OutouStartX
                ZFY1 = OutouStartY + YYYYY1
                ZFX2 = OutouStartX + SunPouStartX3
                ZFY2 = OutouStartY + YYYYY1
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
                ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY1 = OutouStartY + YYYYY2
                ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY2 = OutouStartY + YYYYY1
                this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                YYYYY2 = YYYYY1
                FFF1 = 0
                FFF2 = 0
                FFF4 = FFF3
            } else {
                YYYYY1 = FFF4 * MeterAtari
                frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                ZFX1 = OutouStartX
                ZFY1 = OutouStartY + YYYYY1
                ZFX2 = OutouStartX + SunPouStartX3
                ZFY2 = OutouStartY + YYYYY1
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
                ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY1 = OutouStartY + YYYYY2
                ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY2 = OutouStartY + YYYYY1
                this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                YYYYY2 = YYYYY1
                FFF1 = FFF3 - FFF4
                FFF2 = 1
                YYYYY1 = FFF3 * MeterAtari
                frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                ZFX1 = OutouStartX
                ZFY1 = OutouStartY + YYYYY1
                ZFX2 = OutouStartX + SunPouStartX3
                ZFY2 = OutouStartY + YYYYY1
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
                ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY1 = OutouStartY + YYYYY2
                ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY2 = OutouStartY + YYYYY1
                this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                YYYYY2 = YYYYY1
                FFF1 = 0
                FFF2 = 0
                FFF4 = FFF3
            }
        }
    } else {
        if ( i = 2 ) {
            FFF1 = CCCC(i)
            FFF2 = 1
        } else {
            if ( CCCC(i) = 0 ) {
                FFF1 = 0
                FFF2 = 0
            } else {
                if ( FFF1 = 0 ) {
                    FFF1 = CCCC(i)
                    FFF2 = 1
                } else {
                    if ( RoundS(FFF1, 3) = RoundS(CCCC(i), 3) ) {
                        FFF2 = FFF2 + 1
                    } else {
                        YYYYY1 = FFF4 * MeterAtari
                        frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                        if ( CreateDxfFlag = 1 ) {
                            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                        }
                        ZFX1 = OutouStartX
                        ZFY1 = OutouStartY + YYYYY1
                        ZFX2 = OutouStartX + SunPouStartX3
                        ZFY2 = OutouStartY + YYYYY1
                        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                        }
                        ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY1 = OutouStartY + YYYYY2
                        ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY2 = OutouStartY + YYYYY1
                        this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                        this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                        YYYYY2 = YYYYY1
                        FFF1 = FFF3 - FFF4
                        FFF2 = 1
                        FFF4 = FFF3
                    }
                }
            }
        }
    }
    FFF4 = FFF3
}
//
}

private void Out_OuTouHeniZu_G(HH As Integer, bTitle As Boolean)       // For( Gouiki（杭の応答変位図）
//
double var N
double var CA
double var OU
double var i
double var Total As Double, yKui As Integer, ii //////08/06/04
//    var NAME1
//    var OF1
//
CA = Int(F7ML5(HH))
if ( CA < 1 || CA > 16 ) {
    return;
}
OU = OuTouHHH
if ( GibanHeniX1 = 1 ) {     // 応答変位量の印字のみ
    if ( EqualKui = 0 ) {
        For( N = 1 To 部材_max
            if ( ZZBuzaiBai(N) != 0 ) {
            if ( (InStr(Trim(部材名(N)), "杭") > 0 || InStr(部材名(N), "側壁") != 0) ) {
                NewPagePrt frmPrint.vsPrt1
                if ( CreateDxfFlag = 1 ) {
                    this.PLOT00(2, NAME1, OF1)
                    this.PLOT00(1, NAME1, OF1)
                }
                this.OUT_枠(HH, bTitle)
                this.Out_BuzaiNameSingle(N)
                this.Out_OuTouHeniZu_G1(N, CA, OU)
            }
            }
        Next N
    } else {
        For( i = 1 To 10
            Total = 9 //////08/06/04
            Select Case i
            Case 1
                    N = XOutouKui1(1)
                    yKui = XKui1
                    ii = 1
//                    if ( XKui1 > 0 ) {
//                        n = XOutouKui1(1)
//                        NewPagePrt frmPrint.vsPrt1
//                        if ( CreateDxfFlag = 1 ) {
//                            this.PLOT00(2, NAME1, OF1)
//                            this.PLOT00(1, NAME1, OF1)
//                        }
//                        this.OUT_枠(HH, bTitle)
//                        this.Out_BuzaiNameMulti(1)
//                        this.Out_OuTouHeniZu_G1(n, CA, OU)
//                    }
            Case 2
                    N = XOutouKui2(1)
                    yKui = XKui2
                    ii = 2
//                    if ( XKui2 > 0 ) {
//                        n = XOutouKui2(1)
//                        NewPagePrt frmPrint.vsPrt1
//                        if ( CreateDxfFlag = 1 ) {
//                            this.PLOT00(2, NAME1, OF1)
//                            this.PLOT00(1, NAME1, OF1)
//                        }
//                        this.OUT_枠(HH, bTitle)
//                        this.Out_BuzaiNameMulti(2)
//                        this.Out_OuTouHeniZu_G1(n, CA, OU)
//                    }
            Case 3
                    N = XOutouKui3(1)
                    yKui = XKui3
                    ii = 3
//                    if ( XKui3 > 0 ) {
//                        n = XOutouKui3(1)
//                        NewPagePrt frmPrint.vsPrt1
//                        if ( CreateDxfFlag = 1 ) {
//                            this.PLOT00(2, NAME1, OF1)
//                            this.PLOT00(1, NAME1, OF1)
//                        }
//                        this.OUT_枠(HH, bTitle)
//                        this.Out_BuzaiNameMulti(3)
//                        this.Out_OuTouHeniZu_G1(n, CA, OU)
//                    }
            Case 4
                    N = XOutouKui4(1)
                    yKui = XKui4
                    ii = 4
//                    if ( XKui4 > 0 ) {
//                        n = XOutouKui4(1)
//                        NewPagePrt frmPrint.vsPrt1
//                        if ( CreateDxfFlag = 1 ) {
//                            this.PLOT00(2, NAME1, OF1)
//                            this.PLOT00(1, NAME1, OF1)
//                        }
//                        this.OUT_枠(HH, bTitle)
//                        this.Out_BuzaiNameMulti(4)
//                        this.Out_OuTouHeniZu_G1(n, CA, OU)
//                    }
            Case 5
                    N = XOutouKui5(1)
                    yKui = XKui5
                    ii = 5
//                    if ( XKui5 > 0 ) {
//                        n = XOutouKui5(1)
//                        NewPagePrt frmPrint.vsPrt1
//                        if ( CreateDxfFlag = 1 ) {
//                            this.PLOT00(2, NAME1, OF1)
//                            this.PLOT00(1, NAME1, OF1)
//                        }
//                        this.OUT_枠(HH, bTitle)
//                        this.Out_BuzaiNameMulti(5)
//                        this.Out_OuTouHeniZu_G1(n, CA, OU)
//                    }
            Case 6
                    N = XOutouKui6(1)
                    yKui = XKui6
                    ii = 6
//                    if ( XKui6 > 0 ) {
//                        n = XOutouKui6(1)
//                        NewPagePrt frmPrint.vsPrt1
//                        if ( CreateDxfFlag = 1 ) {
//                            this.PLOT00(2, NAME1, OF1)
//                            this.PLOT00(1, NAME1, OF1)
//                        }
//                        this.OUT_枠(HH, bTitle)
//                        this.Out_BuzaiNameMulti(6)
//                        this.Out_OuTouHeniZu_G1(n, CA, OU)
//                    }
            Case 7
                    N = XOutouKui7(1)
                    yKui = XKui7
                    ii = 7
//                    if ( XKui7 > 0 ) {
//                        n = XOutouKui7(1)
//                        NewPagePrt frmPrint.vsPrt1
//                        if ( CreateDxfFlag = 1 ) {
//                            this.PLOT00(2, NAME1, OF1)
//                            this.PLOT00(1, NAME1, OF1)
//                        }
//                        this.OUT_枠(HH, bTitle)
//                        this.Out_BuzaiNameMulti(7)
//                        this.Out_OuTouHeniZu_G1(n, CA, OU)
//                    }
            Case 8
                    N = XOutouKui8(1)
                    yKui = XKui8
                    ii = 8
//                    if ( XKui8 > 0 ) {
//                        n = XOutouKui8(1)
//                        NewPagePrt frmPrint.vsPrt1
//                        if ( CreateDxfFlag = 1 ) {
//                            this.PLOT00(2, NAME1, OF1)
//                            this.PLOT00(1, NAME1, OF1)
//                        }
//                        this.OUT_枠(HH, bTitle)
//                        this.Out_BuzaiNameMulti(8)
//                        this.Out_OuTouHeniZu_G1(n, CA, OU)
//                    }
            Case 9
                    N = XOutouKui9(1)
                    yKui = XKui9
                    ii = 9
//                    if ( XKui9 > 0 ) {
//                        n = XOutouKui9(1)
//                        NewPagePrt frmPrint.vsPrt1
//                        if ( CreateDxfFlag = 1 ) {
//                            this.PLOT00(2, NAME1, OF1)
//                            this.PLOT00(1, NAME1, OF1)
//                        }
//                        this.OUT_枠(HH, bTitle)
//                        this.Out_BuzaiNameMulti(9)
//                        this.Out_OuTouHeniZu_G1(n, CA, OU)
//                    }
            Case 10
                    N = XOutouKui10(1)
                    yKui = XKui10
                    ii = 10
//                    if ( XKui10 > 0 ) {
//                        n = XOutouKui10(1)
//                        NewPagePrt frmPrint.vsPrt1
//                        if ( CreateDxfFlag = 1 ) {
//                            this.PLOT00(2, NAME1, OF1)
//                            this.PLOT00(1, NAME1, OF1)
//                        }
//                        this.OUT_枠(HH, bTitle)
//                        this.Out_BuzaiNameMulti(10)
//                        this.Out_OuTouHeniZu_G1(n, CA, OU)
//                    }
            Case } else {
                    N = XOutouKui1(1)
                    yKui = XKui1
                    ii = 1
//                    if ( XKui1 > 0 ) {
//                        n = XOutouKui1(1)
//                        NewPagePrt frmPrint.vsPrt1
//                        if ( CreateDxfFlag = 1 ) {
//                            this.PLOT00(2, NAME1, OF1)
//                            this.PLOT00(1, NAME1, OF1)
//                        }
//                        this.OUT_枠(HH, bTitle)
//                        this.Out_BuzaiNameMulti(1)
//                        this.Out_OuTouHeniZu_G1(n, CA, OU)
//                    }
            End Select
            if ( yKui > 0 ) {
                this.Out_OuTouHeniZu_G1(N, CA, OU, Total)
                if ( Total != 0 ) {
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(ii)
                    this.Out_OuTouHeniZu_G1(N, CA, OU)
                }
            }
        }
    }
} else {
    if ( EqualKui = 0 ) {
        For( N = 1 To 部材_max
            if ( ZZBuzaiBai(N) != 0 ) {
            if ( (InStr(Trim(部材名(N)), "杭") > 0 || InStr(部材名(N), "側壁") != 0) ) {
                NewPagePrt frmPrint.vsPrt1
                if ( CreateDxfFlag = 1 ) {
                    this.PLOT00(2, NAME1, OF1)
                    this.PLOT00(1, NAME1, OF1)
                }
                this.OUT_枠(HH, bTitle)
                this.Out_BuzaiNameSingle(N)
                this.Out_OuTouHeniZu_G1_JibanHeni_SuiHeiBane(N, CA, OU)
            }
            }
        Next N
    } else {
        For( i = 1 To 10
            Select Case i
            Case 1
                if ( XKui1 > 0 ) {
                    N = XOutouKui1(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(1)
                    this.Out_OuTouHeniZu_G1_JibanHeni_SuiHeiBane(N, CA, OU)
                }
            Case 2
                if ( XKui2 > 0 ) {
                    N = XOutouKui2(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(2)
                    this.Out_OuTouHeniZu_G1_JibanHeni_SuiHeiBane(N, CA, OU)
                }
            Case 3
                if ( XKui3 > 0 ) {
                    N = XOutouKui3(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(3)
                    this.Out_OuTouHeniZu_G1_JibanHeni_SuiHeiBane(N, CA, OU)
                }
            Case 4
                if ( XKui4 > 0 ) {
                    N = XOutouKui4(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(4)
                    this.Out_OuTouHeniZu_G1_JibanHeni_SuiHeiBane(N, CA, OU)
                }
            Case 5
                if ( XKui5 > 0 ) {
                    N = XOutouKui5(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(5)
                    this.Out_OuTouHeniZu_G1_JibanHeni_SuiHeiBane(N, CA, OU)
                }
            Case 6
                if ( XKui6 > 0 ) {
                    N = XOutouKui6(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(6)
                    this.Out_OuTouHeniZu_G1_JibanHeni_SuiHeiBane(N, CA, OU)
                }
            Case 7
                if ( XKui7 > 0 ) {
                    N = XOutouKui7(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(7)
                    this.Out_OuTouHeniZu_G1_JibanHeni_SuiHeiBane(N, CA, OU)
                }
            Case 8
                if ( XKui8 > 0 ) {
                    N = XOutouKui8(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(8)
                    this.Out_OuTouHeniZu_G1_JibanHeni_SuiHeiBane(N, CA, OU)
                }
            Case 9
                if ( XKui9 > 0 ) {
                    N = XOutouKui9(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(9)
                    this.Out_OuTouHeniZu_G1_JibanHeni_SuiHeiBane(N, CA, OU)
                }
            Case 10
                if ( XKui10 > 0 ) {
                    N = XOutouKui10(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(10)
                    this.Out_OuTouHeniZu_G1_JibanHeni_SuiHeiBane(N, CA, OU)
                }
            Case } else {
                if ( XKui1 > 0 ) {
                    N = XOutouKui1(1)
                    NewPagePrt frmPrint.vsPrt1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOT00(2, NAME1, OF1)
                        this.PLOT00(1, NAME1, OF1)
                    }
                    this.OUT_枠(HH, bTitle)
                    this.Out_BuzaiNameMulti(1)
                    this.Out_OuTouHeniZu_G1_JibanHeni_SuiHeiBane(N, CA, OU)
                }
            End Select
        }
    }
}
//
}

private void Out_OuTouHeniZu_G1(N As Double, CA As Double, OU As Double, Optional gTotal = 0) //////08/06/04   // For( Gouiki（杭の応答変位図）
//
double var YYYYY1
double var YYYYY2
double var YYYYY3
double var UpXXX
double var DownXXX
double var UpXXXTyakuMokuTen
double var DownXXXTyakuMokuTen
var FFF1                    As Single
double var FFF2
double var FFF3
double var FFF4
double var LLL
double var KuiNN
double var KuiMax
double var i
double var X1
double var y1
double var X2
double var Y2
double var HiRiTsu
double var HiRiTsu1
var ZFX1                    As Single
var ZFY1                    As Single
var MojiZFX1                As Single
var MojiZFY1                As Single
var ZFX2                    As Single
var ZFY2                    As Single
var AZFX2                   As Single
var AZFY2                   As Single
double var GGG
double var Value1
double var Value2
double var Value3
double var OutouValue()
double var OutouAAA()
double var OutouFlag()
var TTT                     As Variant
var TTT2                    As Variant
double var OuTouN
var LINETYPE()              As Integer
double var HHH
var HH1                     As Single
var TEMP1                   As Single
double var j
double var HHHZ1()
var HHHZ2()                 As Single
double var SouMax
double var MeterAtari
double var AAAA()
double var BBBB
double var CCCC()
double Const OutouXXBai            = 0.8
double Const Add5                  = 5
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
var QWX1                    As Single
var QWY1                    As Single
//
if ( SuiheiBaneEqual = 1 ) {
    this.Out_OuTouHeniZu_G2(N, CA, OU, gTotal) //08/06/04      // For( Gouiki（杭の応答変位図）
    return;
}
OuTouN = OU
HiRiTsu = 1
HiRiTsu1 = 10
LLL = 0
if ( InStr(Trim(部材名(N)), "杭") > 0 ) {
    if ( Len(Trim(部材名(N))) = 1 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 2, Len(Trim(部材名(N))) - 1))
    }
}
if ( InStr(Trim(部材名(N)), "側壁") > 0 ) {
    if ( Len(Trim(部材名(N))) = 2 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 3, Len(Trim(部材名(N))) - 1))
    }
}
KuiMax = G_KuiDD(KuiNN)
this.LINETYPE(KuiMax)
this.OutouValue(KuiMax)
this.OutouFlag(KuiMax)
this.OutouAAA(KuiMax)
this.HHHZ1(KuiMax)
this.HHHZ2(KuiMax)
GGG = BuzaiH(N)
this.AAAA(KuiMax)
this.CCCC(KuiMax)
MaxKuiOuTouLen = 0
For( i = 1 To KuiMax
    Select Case i
    Case 1
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value1 = Value1 * Value2
    Case KuiMax
        Value1 = 0 //PickOutouG(KuiNN, I)
        Value2 = 0 //PickBaneG(KuiNN, I, CA)
        Value1 = Value1 * Value2
    Case } else {
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value1 = Value1 * Value2
    End Select
    LINETYPE(i) = 0
    OutouAAA(i) = PickAAA_G(KuiNN, i)
    if ( i > 1 ) {
        if ( BBBB = RoundS(OutouAAA(i), 3) ) {
            AAAA(i - 1) = 1
        }
    }
    MaxKuiOuTouLen = SMAX(MaxKuiOuTouLen, Value1)
    OutouValue(i) = Value1
    OutouFlag(i) = -9000000000#
    HHHZ1(i) = -9000000000#
    HHHZ2(i) = -9000000000#
    if ( i > 1 ) {
        CCCC(i) = RoundS(OutouAAA(i), 3) - BBBB
    }
    BBBB = RoundS(PickAAA_G(KuiNN, i), 3)
}
AAAA(KuiMax) = 1
j = 0
For( i = 1 To KuiMax
    Select Case i
    Case 1
        OutouFlag(i) = 0
        LINETYPE(i) = 1
    Case KuiMax
        OutouFlag(i) = 0
        LINETYPE(i) = 1
        j = j + 1
        HHHZ1(j) = OutouAAA(i)
        if ( j > 1 ) {
            HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
        } else {
            HHHZ2(j) = OutouAAA(i)
        }
    Case } else {
        if ( RoundS(OutouAAA(i), 3) = RoundS(OutouAAA(i - 1), 3) ) {
            if ( RoundS(OutouValue(i), 3) = RoundS(OutouValue(i - 1), 3) ) {
                OutouFlag(i - 1) = -9000000000#
                OutouFlag(i) = 0
                LINETYPE(i - 1) = 0
                LINETYPE(i) = 1
            } else {
                OutouFlag(i - 1) = 1
                OutouFlag(i) = -1
                LINETYPE(i - 1) = 0
                LINETYPE(i) = 1
            }
            j = j + 1
            HHHZ1(j) = OutouAAA(i)
            if ( j > 1 ) {
                HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
            } else {
                HHHZ2(j) = OutouAAA(i)
            }
        } else {
            OutouFlag(i) = 0
            LINETYPE(i) = 2
        }
    End Select
}
SouMax = j
HH1 = PickAAA_G(KuiNN, KuiMax)
HHH = HH1 / KuiLengthMax
TEMP1 = frmPrint.vsPrt1.PenWidth
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
this.DrawLineZZ(0, 0, 0, KuiMaxLen * HHH * OuTouBai)
MeterAtari = KuiMaxLen * HHH * OuTouBai / HH1
frmPrint.vsPrt1.PenWidth = TEMP1
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
// グラフの上に応答変位荷重を印字
if ( fMainForm.SICheck = True ) { //SI単位チェック
    TTT = "　　　　　　　　　　 応答変位荷重 (kN/m)"
} else {
    TTT = "　　　　　　　　　　 応答変位荷重 (tf/m)"
}
frmPrint.vsPrt1.TextAngle = 0 * 10
frmPrint.vsPrt1.FontSize = GraphTitleMojiSize * 1.5 //1.25 nagase
MojiZFX1 = OutouStartX - CON_X(frmPrint.vsPrt1.FontSize * FFLen(TTT) / 2)
MojiZFY1 = OutouStartY - CON_Y(frmPrint.vsPrt1.FontSize) * 2 - OuTouBai

MyCurrentX = Int(CSng(MojiZFX1))
MyCurrentY = Int(CSng(MojiZFY1))
QWX1 = MyCurrentX
QWY1 = MyCurrentY
PrintoutPrt frmPrint.vsPrt1, TTT
if ( CreateDxfFlag = 1 ) {
    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
    ParamXPoint = QWX1
    ParamYpoint = QWY1
    ParamText = TTT
    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
}
//
For( i = 1 To KuiMax
    Select Case i
    Case 1
        LLL = PickAAA_G(KuiNN, i)
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
        AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
        if ( GGG = 1 $$ MaxKuiOuTouLen != 0 ) {
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N)) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxKuiOuTou * OutouXXBai
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
        } else {
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N)) + Value3 * HiRiTsu1
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1, 2     // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    MojiZFY1 = ZFY2 - SouatsuMojiHight * 18
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case KuiMax
        LLL = PickAAA_G(KuiNN, i)
        Value1 = 0 //PickOutouG(KuiNN, I)
        Value2 = 0 //PickBaneG(KuiNN, I, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N))
        AZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N))
        if ( GGG = 1 $$ MaxKuiOuTouLen != 0 ) {
            ZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N)) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxKuiOuTou * OutouXXBai
            ZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N) - LLL)
        } else {
            ZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N))
            ZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N) - LLL) + Value3 * HiRiTsu1
        }
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1, 2     // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case } else {
        LLL = PickAAA_G(KuiNN, i)
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value3 = Value1 * Value2
        if ( GGG = 1 $$ MaxKuiOuTouLen != 0 ) {
            AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
            AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N) - LLL)
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N)) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxKuiOuTou * OutouXXBai
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N) - LLL)
        } else {
            AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N) + LLL)
            AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N) + LLL)
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N)) + Value3 * HiRiTsu1
        }
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            if ( OutouCase7 = 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add5
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE(i) > 1 ) {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            } else {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE(i) > 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1
            if ( LINETYPE(i) = 1 || (LINETYPE(i) != 2 $$ LINETYPE(i + 1) = 1) ) {
                if ( OutouFlag(i) != -9000000000# ) {
                    if ( GGG = 1 ) {
                        MojiZFX1 = ZFX2 + SouatsuMojiHight
                        this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                    } else {
                        MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                        this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                    }
                    this.Outou_KakuSub4(GGG)
                    frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                    if ( GGG = 1 ) {
                        this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                    } else {
                        TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                        MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                    }
                    MyCurrentX = Int(CSng(MojiZFX1))
                    MyCurrentY = Int(CSng(MojiZFY1))
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, TTT
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = TTT
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                }
            }
        Case 2      // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    End Select
}
//
if ( SunPouSenX1 = 1 ) {     // 寸法線を書かない場合はここで終了。
    return;
}
//
ZFX1 = OutouStartX
ZFY1 = OutouStartY
ZFX2 = OutouStartX + SunPouStartX1
ZFY2 = OutouStartY
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX
ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
ZFX2 = OutouStartX + SunPouStartX1
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX + SunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
ZFY1 = OutouStartY
ZFX2 = OutouStartX + SunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
this.OuTouPrintUp1(1, SunPouMojiSize1, HH1, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2)) // 杭長の印字
UpXXX = -9000000000#
DownXXX = -9000000000#
YYYYY1 = 0
YYYYY2 = 0
For( i = 1 To SouMax
    YYYYY1 = YYYYY1 + HHHZ2(i) * MeterAtari
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    ZFX1 = OutouStartX
    ZFY1 = OutouStartY + YYYYY1
    ZFX2 = OutouStartX + SunPouStartX2
    ZFY2 = OutouStartY + YYYYY1
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = OutouStartX + SunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
    ZFY1 = OutouStartY + YYYYY2
    ZFX2 = OutouStartX + SunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
    ZFY2 = OutouStartY + YYYYY1
    this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
    this.OuTouPrintUp2(SunPouMojiSize2, HHHZ2(i), CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXX, DownXXX) // 杭長の印字
    YYYYY2 = YYYYY1
}
//
if ( SunPouSenX2 = 1 ) {     // 着目点単位の寸法線を書かない場合はここで終了。
    return;
}
//
YYYYY1 = 0
YYYYY2 = 0
YYYYY3 = 0
FFF1 = 0
FFF2 = 0
FFF3 = 0
FFF4 = 0
UpXXXTyakuMokuTen = -9000000000#
DownXXXTyakuMokuTen = -9000000000#
For( i = 2 To KuiMax
    FFF3 = PickAAA_G(KuiNN, i)
    if ( AAAA(i) = 1 ) {
        if ( FFF1 = 0 ) {
            if ( i = 2 ) {
                FFF1 = FFF3
            } else {
                FFF1 = FFF3 - PickAAA_G(KuiNN, i - 1)
            }
            FFF2 = 1
            YYYYY1 = FFF3 * MeterAtari
            frmPrint.vsPrt1.PenWidth = SunPouPenWidth
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            ZFX1 = OutouStartX
            ZFY1 = OutouStartY + YYYYY1
            ZFX2 = OutouStartX + SunPouStartX3
            ZFY2 = OutouStartY + YYYYY1
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
            ZFY1 = OutouStartY + YYYYY2
            ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
            ZFY2 = OutouStartY + YYYYY1
            this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
            this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
            YYYYY2 = YYYYY1
            FFF1 = 0
            FFF2 = 0
            FFF4 = FFF3
        } else {
            if ( RoundS(FFF1, 3) = RoundS(CCCC(i), 3) ) {
                FFF2 = FFF2 + 1
                YYYYY1 = FFF3 * MeterAtari
                frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                ZFX1 = OutouStartX
                ZFY1 = OutouStartY + YYYYY1
                ZFX2 = OutouStartX + SunPouStartX3
                ZFY2 = OutouStartY + YYYYY1
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
                ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY1 = OutouStartY + YYYYY2
                ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY2 = OutouStartY + YYYYY1
                this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                YYYYY2 = YYYYY1
                FFF1 = 0
                FFF2 = 0
                FFF4 = FFF3
            } else {
                YYYYY1 = FFF4 * MeterAtari
                frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                ZFX1 = OutouStartX
                ZFY1 = OutouStartY + YYYYY1
                ZFX2 = OutouStartX + SunPouStartX3
                ZFY2 = OutouStartY + YYYYY1
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
                ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY1 = OutouStartY + YYYYY2
                ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY2 = OutouStartY + YYYYY1
                this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                YYYYY2 = YYYYY1
                FFF1 = FFF3 - FFF4
                FFF2 = 1
                YYYYY1 = FFF3 * MeterAtari
                frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                ZFX1 = OutouStartX
                ZFY1 = OutouStartY + YYYYY1
                ZFX2 = OutouStartX + SunPouStartX3
                ZFY2 = OutouStartY + YYYYY1
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
                ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY1 = OutouStartY + YYYYY2
                ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                ZFY2 = OutouStartY + YYYYY1
                this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                YYYYY2 = YYYYY1
                FFF1 = 0
                FFF2 = 0
                FFF4 = FFF3
            }
        }
    } else {
        if ( i = 2 ) {
            FFF1 = CCCC(i)
            FFF2 = 1
        } else {
            if ( CCCC(i) = 0 ) {
                FFF1 = 0
                FFF2 = 0
            } else {
                if ( FFF1 = 0 ) {
                    FFF1 = CCCC(i)
                    FFF2 = 1
                } else {
                    if ( RoundS(FFF1, 3) = RoundS(CCCC(i), 3) ) {
                        FFF2 = FFF2 + 1
                    } else {
                        YYYYY1 = FFF4 * MeterAtari
                        frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                        if ( CreateDxfFlag = 1 ) {
                            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                        }
                        ZFX1 = OutouStartX
                        ZFY1 = OutouStartY + YYYYY1
                        ZFX2 = OutouStartX + SunPouStartX3
                        ZFY2 = OutouStartY + YYYYY1
                        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                        }
                        ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY1 = OutouStartY + YYYYY2
                        ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY2 = OutouStartY + YYYYY1
                        this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                        this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                        YYYYY2 = YYYYY1
                        FFF1 = FFF3 - FFF4
                        FFF2 = 1
                        FFF4 = FFF3
                    }
                }
            }
        }
    }
    FFF4 = FFF3
}
//
}

private void OuTouPrintUp3(MojiSize As Double, TT1 As Single, TT2 As Double, X1 As Double, y1 As Double, X2 As Double, Y2 As Double, UpXXX As Double, DownXXX)
//
var TTT
var TTT1
double var MojiZFX1
double var MojiZFY1
double var TTTLen
double var Atta
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
var QWX1                    As Single
var QWY1                    As Single
//
if ( Int((TT1 + 0.0001) * 100) = TT1 * 100 ) {
    TTT = Format(TT1, "0.00")
} else {
    TTT = Format(TT1, "0.000")
}
if ( Mid(TTT, Len(TTT)) = "0" ) {
    TTT = Format(TT1, "0.00")
}
TTTLen = Len(TTT)
if ( TT2 > 0 ) {
    Select Case TT2
    Case 1
        MojiZFX1 = X1 - MojiSize * OuTouBai * 0.325 - OuTouBai * 0.5
        MojiZFY1 = y1 + (Y2 - y1) / 2 + (TTTLen * MojiSize / 2 * OuTouBai * 0.2)
        this.CheckArea2(MojiZFY1, TTTLen, UpXXX, MojiSize, Atta)
        if ( Atta = 1 ) {
            frmPrint.vsPrt1.TextAngle = 90 * 10
            frmPrint.vsPrt1.FontSize = MojiSize
            MyCurrentX = Int(CSng(MojiZFX1))
            MyCurrentY = Int(CSng(MojiZFY1))
            QWX1 = MyCurrentX
            QWY1 = MyCurrentY
            PrintoutPrt frmPrint.vsPrt1, TTT
            if ( CreateDxfFlag = 1 ) {
                ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                ParamXPoint = QWX1
                ParamYpoint = QWY1
                ParamText = TTT
                this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
            }
            UpXXX = MojiZFY1
        } else {
            MojiZFX1 = X1 - MojiSize * 2.5 + OuTouBai * 0.5 //////////nagase
            MojiZFY1 = y1 + (Y2 - y1) / 2 + (TTTLen * MojiSize / 2 * OuTouBai * 0.2)
            this.CheckArea2(MojiZFY1, TTTLen, DownXXX, MojiSize, Atta)
            if ( Atta = 1 ) {
                frmPrint.vsPrt1.TextAngle = 90 * 10
                frmPrint.vsPrt1.FontSize = MojiSize
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
                DownXXX = MojiZFY1
            } else {
                MojiZFX1 = X1 - MojiSize * OuTouBai * 0.325 - OuTouBai * 0.5
                MojiZFY1 = y1 + (Y2 - y1) / 2 + (TTTLen * MojiSize / 2 * OuTouBai * 0.2)
                MojiZFY1 = MojiZFY1 + (UpXXX - (MojiZFY1 - (TTTLen * MojiSize * OuTouBai * 0.2)))
                frmPrint.vsPrt1.TextAngle = 90 * 10
                frmPrint.vsPrt1.FontSize = MojiSize
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
                UpXXX = MojiZFY1
            }
        }
    Case } else {
        if ( TT1 * TT2 < 4 ) {
        TTT = Trim(str(TT2)) & "x" & TTT & "=" & Format(TT1 * TT2, IIf(Int(TT1 * TT2 * 100) = TT1 * TT2 * 100, "0.00", "0.000"))
        } else {
        TTT = Trim(str(TT2)) & " x " & TTT & " = " & Format(TT1 * TT2, IIf(Int(TT1 * TT2 * 100) = TT1 * TT2 * 100, "0.00", "0.000"))
        }
        TTTLen = Len(TTT)
        MojiZFX1 = X1 - MojiSize * OuTouBai * 0.325 - OuTouBai * 0.5
        MojiZFY1 = y1 + (Y2 - y1) / 2 + (TTTLen * MojiSize / 2 * OuTouBai * 0.2)
        if ( CheckArea44(y1, Y2, MojiSize, TTT, TTTLen) = 1 ) {
            this.CheckArea2(MojiZFY1, TTTLen, UpXXX, MojiSize, Atta)
            if ( Atta = 1 ) {
                frmPrint.vsPrt1.TextAngle = 90 * 10
                frmPrint.vsPrt1.FontSize = MojiSize
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
                UpXXX = MojiZFY1
            } else {
                MojiZFX1 = X1 - MojiSize * 2.5 + OuTouBai * 0.5
                MojiZFY1 = y1 + (Y2 - y1) / 2 + (TTTLen * MojiSize / 2 * OuTouBai * 0.2)
                this.CheckArea2(MojiZFY1, TTTLen, DownXXX, MojiSize, Atta)
                if ( Atta = 1 ) {
                    frmPrint.vsPrt1.TextAngle = 90 * 10
                    frmPrint.vsPrt1.FontSize = MojiSize
                    MyCurrentX = Int(CSng(MojiZFX1))
                    MyCurrentY = Int(CSng(MojiZFY1))
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, TTT
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = TTT
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                    DownXXX = MojiZFY1
                } else {
                    MojiZFX1 = X1 - MojiSize * OuTouBai * 0.325 - OuTouBai * 0.5
                    MojiZFY1 = y1 + (Y2 - y1) / 2 + (TTTLen * MojiSize / 2 * OuTouBai * 0.2)
                    MojiZFY1 = MojiZFY1 + (UpXXX - (MojiZFY1 - (TTTLen * MojiSize * OuTouBai * 0.2)))
                    frmPrint.vsPrt1.TextAngle = 90 * 10
                    frmPrint.vsPrt1.FontSize = MojiSize
                    MyCurrentX = Int(CSng(MojiZFX1))
                    MyCurrentY = Int(CSng(MojiZFY1))
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, TTT
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = TTT
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                    UpXXX = MojiZFY1
                }
            }
        } else {
            TTT = Trim(str(TT2)) & "x" & Format(TT1, IIf(Int(TT1 * 100) = TT1 * 100, "0.00", "0.000"))
            TTT1 = " =" & Format(TT1 * TT2, IIf(Int(TT1 * TT2 * 100) = TT1 * TT2 * 100, "0.00", "0.000"))
            TTTLen = Len(TTT)
            MojiZFX1 = X1 - MojiSize * OuTouBai * 0.325 - OuTouBai * 0.5
            MojiZFY1 = y1 + (Y2 - y1) / 2 + (TTTLen * MojiSize / 2 * OuTouBai * 0.2)
            this.CheckArea2(MojiZFY1, TTTLen, UpXXX, MojiSize, Atta)
            if ( Atta = 1 ) {
                frmPrint.vsPrt1.TextAngle = 90 * 10
                frmPrint.vsPrt1.FontSize = MojiSize
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
                UpXXX = MojiZFY1
                DownXXX = MojiZFY1
                MojiZFX1 = X1 - MojiSize * 2.5 + OuTouBai * 0.5
                frmPrint.vsPrt1.TextAngle = 90 * 10
                frmPrint.vsPrt1.FontSize = MojiSize
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT1
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            } else {
                MojiZFY1 = MojiZFY1 + (UpXXX - (MojiZFY1 - (TTTLen * MojiSize * OuTouBai * 0.2)))
                frmPrint.vsPrt1.TextAngle = 90 * 10
                frmPrint.vsPrt1.FontSize = MojiSize
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
                UpXXX = MojiZFY1
                DownXXX = MojiZFY1
                MojiZFX1 = X1 - MojiSize * 2.5 + OuTouBai * 0.5
                frmPrint.vsPrt1.TextAngle = 90 * 10
                frmPrint.vsPrt1.FontSize = MojiSize
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT1
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        }
    End Select
}
//
}

private Function CheckArea44(y1 As Double, Y2 As Double, MojiSize As Double, TTT, TTTLen As Double)
//
double var YY
double var YY1
//
YY = Y2 - y1
YY1 = (TTTLen * MojiSize * OuTouBai * 0.2)
if ( YY * 0.8 > YY1 ) {
    CheckArea44 = 1
} else {
    CheckArea44 = 0
}
//
}

private void CheckArea3(MojiZFY1 As Double, TTTLen As Double, XXX As Double, XXX1 As Double, MojiSize As Double, Atta)
//
double var SSS
double var SSS1
double var SSS2
double var SSS3
//
if ( XXX <= 0 ) {
    Atta = 1
    return;
}
SSS = (XXX - (MojiZFY1 - (TTTLen * MojiSize * OuTouBai * 0.2)))
if ( SSS < 0 ) {
    Atta = 1
    return;
}
SSS1 = (XXX - (MojiZFY1 - (TTTLen * MojiSize * OuTouBai * 0.2))) * 0.6
SSS3 = (XXX1 - (MojiZFY1 - (TTTLen * MojiSize * OuTouBai * 0.2))) * 0.6
SSS2 = TTTLen * MojiSize * OuTouBai * 0.2
if ( SSS1 / SSS2 < 0.15 ) {
    if ( SSS1 / SSS3 >= 1 ) {
    }
    MojiZFY1 = MojiZFY1 + SSS
    Atta = 1
} else {
    Atta = 0
}
//
}

private void CheckArea2(MojiZFY1 As Double, TTTLen As Double, XXX As Double, MojiSize As Double, Atta)
//
double var SSS
double var SSS1
double var SSS2
//
if ( XXX <= 0 ) {
    Atta = 1
    return;
}
SSS = (XXX - (MojiZFY1 - (TTTLen * MojiSize * OuTouBai * 0.2)))
if ( SSS < 0 ) {
    Atta = 1
    return;
}
SSS1 = (XXX - (MojiZFY1 - (TTTLen * MojiSize * OuTouBai * 0.2))) * 0.6
SSS2 = TTTLen * MojiSize * OuTouBai * 0.2
if ( SSS1 / SSS2 < 0.15 ) {
    MojiZFY1 = MojiZFY1 + SSS
    Atta = 1
} else {
    Atta = 0
}
//
}

private void OuTouPrintUp2(MojiSize As Double, TT1 As Single, X1 As Double, y1 As Double, X2 As Double, Y2 As Double, UpXXX As Double, DownXXX)
//
var TTT
double var MojiZFX1
double var MojiZFY1
double var TTTLen
double var Atta
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
var QWX1                    As Single
var QWY1                    As Single
//
if ( Int((TT1 + 0.0001) * 100) = TT1 * 100 ) {
    TTT = Format(TT1, "0.00")
} else {
    TTT = Format(TT1, "0.000")
}
TTTLen = Len(TTT)
MojiZFX1 = X1 - MojiSize * OuTouBai * 0.325 - OuTouBai * 0.5
MojiZFY1 = y1 + (Y2 - y1) / 2 + (TTTLen * MojiSize / 2 * OuTouBai * 0.2)
this.CheckArea1(MojiZFY1, TTTLen, UpXXX, MojiSize, Atta)
if ( Atta = 1 ) {
    frmPrint.vsPrt1.TextAngle = 90 * 10
    frmPrint.vsPrt1.FontSize = MojiSize
    MyCurrentX = Int(CSng(MojiZFX1))
    MyCurrentY = Int(CSng(MojiZFY1))
    QWX1 = MyCurrentX
    QWY1 = MyCurrentY
    PrintoutPrt frmPrint.vsPrt1, TTT
    if ( CreateDxfFlag = 1 ) {
        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
        ParamXPoint = QWX1
        ParamYpoint = QWY1
        ParamText = TTT
        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
    }
    UpXXX = MojiZFY1
} else {
    MojiZFX1 = X1 - MojiSize * 2.5 + OuTouBai * 0.5
    MojiZFY1 = y1 + (Y2 - y1) / 2 + (TTTLen * MojiSize / 2 * OuTouBai * 0.2)
    this.CheckArea1(MojiZFY1, TTTLen, DownXXX, MojiSize, Atta)
    if ( Atta = 1 ) {
        frmPrint.vsPrt1.TextAngle = 90 * 10
        frmPrint.vsPrt1.FontSize = MojiSize
        MyCurrentX = Int(CSng(MojiZFX1))
        MyCurrentY = Int(CSng(MojiZFY1))
        QWX1 = MyCurrentX
        QWY1 = MyCurrentY
        PrintoutPrt frmPrint.vsPrt1, TTT
        if ( CreateDxfFlag = 1 ) {
            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
            ParamXPoint = QWX1
            ParamYpoint = QWY1
            ParamText = TTT
            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
        }
        DownXXX = MojiZFY1
    } else {
        MojiZFX1 = X1 - MojiSize * OuTouBai * 0.325 - OuTouBai * 0.5
        MojiZFY1 = y1 + (Y2 - y1) / 2 + (TTTLen * MojiSize / 2 * OuTouBai * 0.2)
        MojiZFY1 = MojiZFY1 + (UpXXX - (MojiZFY1 - (TTTLen * MojiSize * OuTouBai * 0.2)))
        frmPrint.vsPrt1.TextAngle = 90 * 10
        frmPrint.vsPrt1.FontSize = MojiSize
        MyCurrentX = Int(CSng(MojiZFX1))
        MyCurrentY = Int(CSng(MojiZFY1))
        QWX1 = MyCurrentX
        QWY1 = MyCurrentY
        PrintoutPrt frmPrint.vsPrt1, TTT
        if ( CreateDxfFlag = 1 ) {
            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
            ParamXPoint = QWX1
            ParamYpoint = QWY1
            ParamText = TTT
            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
        }
        UpXXX = MojiZFY1
    }
}
//
}

private void OuTouPrintUp2Yoko(MojiSize As Double, TT1 As Single, X1 As Double, y1 As Double, X2 As Double, Y2 As Double, UpXXX As Double, DownXXX)
//
var TTT
double var MojiZFX1
double var MojiZFY1
double var TTTLen
double var Atta
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
var QWX1                    As Single
var QWY1                    As Single
//
if ( Int((TT1 + 0.0001) * 100) = TT1 * 100 ) {
    TTT = Format(TT1, "0.00")
} else {
    TTT = Format(TT1, "0.000")
}
TTTLen = Len(TTT)
MojiZFX1 = X1 - TTTLen * MojiSize * 2.5 * 4.25
MojiZFY1 = y1 + (Y2 - y1) / 2 + (MojiSize / 2 * OuTouBai * 0.2)
this.CheckArea1(MojiZFY1, "1", UpXXX, MojiSize, Atta)
if ( Atta = 1 ) {
    frmPrint.vsPrt1.TextAngle = 0 * 10
    frmPrint.vsPrt1.FontSize = MojiSize
    MyCurrentX = Int(CSng(MojiZFX1))
    MyCurrentY = Int(CSng(MojiZFY1 - MojiSize * OuTouBai * 0.25))
    QWX1 = MyCurrentX
    QWY1 = MyCurrentY
    PrintoutPrt frmPrint.vsPrt1, TTT
    if ( CreateDxfFlag = 1 ) {
        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
        ParamXPoint = QWX1
        ParamYpoint = QWY1
        ParamText = TTT
        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
    }
    UpXXX = MojiZFY1
} else {
    MojiZFX1 = X1 - TTTLen * MojiSize * 2.5 * 4.25
    MojiZFY1 = y1 + (Y2 - y1) / 2 + (MojiSize / 2 * OuTouBai * 0.2)
    this.CheckArea1(MojiZFY1, "1", DownXXX, MojiSize, Atta)
    if ( Atta = 1 ) {
        frmPrint.vsPrt1.TextAngle = 0 * 10
        frmPrint.vsPrt1.FontSize = MojiSize
        MyCurrentX = Int(CSng(MojiZFX1))
        MyCurrentY = Int(CSng(MojiZFY1 - MojiSize * OuTouBai * 0.25))
        QWX1 = MyCurrentX
        QWY1 = MyCurrentY
        PrintoutPrt frmPrint.vsPrt1, TTT
        if ( CreateDxfFlag = 1 ) {
            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
            ParamXPoint = QWX1
            ParamYpoint = QWY1
            ParamText = TTT
            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
        }
        DownXXX = MojiZFY1
    } else {
        MojiZFX1 = X1 - TTTLen * MojiSize * 2.5 * 4.25
        MojiZFY1 = y1 + (Y2 - y1) / 2 + (MojiSize / 2 * OuTouBai * 0.2)
        MojiZFY1 = MojiZFY1 + (UpXXX - (MojiZFY1 - (MojiSize * OuTouBai * 0.2)))
        frmPrint.vsPrt1.TextAngle = 0 * 10
        frmPrint.vsPrt1.FontSize = MojiSize
        MyCurrentX = Int(CSng(MojiZFX1))
        MyCurrentY = Int(CSng(MojiZFY1 - MojiSize * OuTouBai * 0.25))
        QWX1 = MyCurrentX
        QWY1 = MyCurrentY
        PrintoutPrt frmPrint.vsPrt1, TTT
        if ( CreateDxfFlag = 1 ) {
            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
            ParamXPoint = QWX1
            ParamYpoint = QWY1
            ParamText = TTT
            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
        }
        UpXXX = MojiZFY1
    }
}
//
}

private void CheckArea1(MojiZFY1 As Double, TTTLen As Double, XXX As Double, MojiSize As Double, Atta)
//
double var SSS
double var SSS1
double var SSS2
//
if ( XXX <= 0 ) {
    Atta = 1
    return;
}
SSS = (XXX - (MojiZFY1 - (TTTLen * MojiSize * OuTouBai * 0.2)))
if ( SSS < 0 ) {
    Atta = 1
    return;
}
SSS1 = (XXX - (MojiZFY1 - (TTTLen * MojiSize * OuTouBai * 0.2))) * 0.6
SSS2 = TTTLen * MojiSize * OuTouBai * 0.2
if ( SSS1 / SSS2 < 0.25 ) {
    MojiZFY1 = MojiZFY1 + SSS
    Atta = 1
} else {
    Atta = 0
}
//
}

private void OuTouPrintUp1(Mode1 As Double, MojiSize As Double, TT1 As Single, X1 As Double, y1 As Double, X2 As Double, Y2)
//
var TTT
double var MojiZFX1
double var MojiZFY1
double var TTTLen
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
var QWX1                    As Single
var QWY1                    As Single
//
if ( Int((TT1 + 0.0001) * 100) = TT1 * 100 ) {
    TTT = Format(TT1, "0.00")
} else {
    TTT = Format(TT1, "0.000")
}
TTTLen = Len(TTT)

Select Case Mode1
Case 1
    MojiZFX1 = X1 - MojiSize * OuTouBai * 0.325 - OuTouBai * 0.5
    MojiZFY1 = y1 + (Y2 - y1) / 2 + (TTTLen * MojiSize / 2 * OuTouBai * 0.2)
    frmPrint.vsPrt1.TextAngle = 90 * 10
    frmPrint.vsPrt1.FontSize = MojiSize
    MyCurrentX = Int(CSng(MojiZFX1))
    MyCurrentY = Int(CSng(MojiZFY1))
    QWX1 = MyCurrentX
    QWY1 = MyCurrentY
    PrintoutPrt frmPrint.vsPrt1, TTT
    if ( CreateDxfFlag = 1 ) {
        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
        ParamXPoint = QWX1
        ParamYpoint = QWY1
        ParamText = TTT
        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
    }
Case 2
    MojiZFX1 = X1 - MojiSize * 2.5 + OuTouBai * 0.5
    MojiZFY1 = y1 + (Y2 - y1) / 2 + (TTTLen * MojiSize / 2 * OuTouBai * 0.2)
    frmPrint.vsPrt1.TextAngle = 90 * 10
    frmPrint.vsPrt1.FontSize = MojiSize
    MyCurrentX = Int(CSng(MojiZFX1))
    MyCurrentY = Int(CSng(MojiZFY1))
    QWX1 = MyCurrentX
    QWY1 = MyCurrentY
    PrintoutPrt frmPrint.vsPrt1, TTT
    if ( CreateDxfFlag = 1 ) {
        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
        ParamXPoint = QWX1
        ParamYpoint = QWY1
        ParamText = TTT
        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
    }
Case } else {
End Select
//
}

private void OuTouPrintUp1Yoko(Mode1 As Double, MojiSize As Double, TT1 As Single, X1 As Double, y1 As Double, X2 As Double, Y2)
//
var TTT
double var MojiZFX1
double var MojiZFY1
double var TTTLen
double Const Add5 = 5
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
var QWX1                    As Single
var QWY1                    As Single
//
if ( Int((TT1 + 0.0001) * 100) = TT1 * 100 ) {
    TTT = Format(TT1, "0.00")
} else {
    TTT = Format(TT1, "0.000")
}
TTTLen = Len(TTT)

Select Case Mode1
Case 1
    MojiZFX1 = X1 - TTTLen * MojiSize * 2.5 * 4.25
    MojiZFY1 = y1 + (Y2 - y1) / 2 + (MojiSize / 2 * OuTouBai * 0.2)
    frmPrint.vsPrt1.TextAngle = 0
    frmPrint.vsPrt1.FontSize = MojiSize
    MyCurrentX = Int(CSng(MojiZFX1))
    MyCurrentY = Int(CSng(MojiZFY1 + OuTouBai * 0.25))
    QWX1 = MyCurrentX
    QWY1 = MyCurrentY
    PrintoutPrt frmPrint.vsPrt1, TTT
    if ( CreateDxfFlag = 1 ) {
        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
        ParamXPoint = QWX1
        ParamYpoint = QWY1
        ParamText = TTT
        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
    }
Case 2
    MojiZFX1 = X1 - TTTLen * MojiSize * 2.5
    MojiZFY1 = y1 + (Y2 - y1) / 2 + (MojiSize / 2 * OuTouBai * 0.2)
    frmPrint.vsPrt1.TextAngle = 0 * 10
    frmPrint.vsPrt1.FontSize = MojiSize
    MyCurrentX = Int(CSng(MojiZFX1))
    MyCurrentY = Int(CSng(MojiZFY1 + OuTouBai * 0.25))
    QWX1 = MyCurrentX
    QWY1 = MyCurrentY
    PrintoutPrt frmPrint.vsPrt1, TTT
    if ( CreateDxfFlag = 1 ) {
        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
        ParamXPoint = QWX1
        ParamYpoint = QWY1
        ParamText = TTT
        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
    }
Case } else {
End Select
//
}

private void OuTouPrintUp1_Y(Mode1 As Double, MojiSize As Double, TT1 As Single, X1 As Double, y1 As Double, X2 As Double, Y2)
//
var TTT
double var MojiZFX1
double var MojiZFY1
double var TTTLen
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
var QWX1                    As Single
var QWY1                    As Single
//
Select Case Mode1
Case 1
    if ( Int((TT1 + 0.0001) * 100) = TT1 * 100 ) {
        TTT = Format(TT1, "0.00")
    } else {
        TTT = Format(TT1, "0.000")
    }
    TTTLen = Len(TTT)
    MojiZFY1 = y1 - MojiSize * OuTouBai * 0.325
    MojiZFX1 = X1 + (X2 - X1) / 2 - (TTTLen * MojiSize / 2 * OuTouBai * 0.2)
    frmPrint.vsPrt1.TextAngle = 0
    frmPrint.vsPrt1.FontSize = MojiSize
    MyCurrentX = Int(CSng(MojiZFX1))
    MyCurrentY = Int(CSng(MojiZFY1))
    QWX1 = MyCurrentX
    QWY1 = MyCurrentY
    PrintoutPrt frmPrint.vsPrt1, TTT
    if ( CreateDxfFlag = 1 ) {
        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
        ParamXPoint = QWX1
        ParamYpoint = QWY1
        ParamText = TTT
        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
    }
Case 2
Case } else {
End Select
//
}

private void OuTouPrintUp1_Y5(Mode1 As Double, MojiSize As Double, TT1 As Single, X1 As Double, y1 As Double, X2 As Double, Y2)
//
var TTT
double var MojiZFX1
double var MojiZFY1
double var TTTLen
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
var QWX1                    As Single
var QWY1                    As Single
//
Select Case Mode1
Case 1
    TTT = Trim(Format(TT1, "0.00000"))
    TTTLen = Len(TTT)
    MojiZFY1 = y1 - MojiSize * OuTouBai * 0.325
    MojiZFX1 = X1 + (X2 - X1) / 2 - (TTTLen * MojiSize / 2 * OuTouBai * 0.2)
    frmPrint.vsPrt1.TextAngle = 0
    frmPrint.vsPrt1.FontSize = MojiSize
    MyCurrentX = Int(CSng(MojiZFX1))
    MyCurrentY = Int(CSng(MojiZFY1))
    QWX1 = MyCurrentX
    QWY1 = MyCurrentY
    PrintoutPrt frmPrint.vsPrt1, TTT
    if ( CreateDxfFlag = 1 ) {
        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
        ParamXPoint = QWX1
        ParamYpoint = QWY1
        ParamText = TTT
        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
    }
Case 2
Case } else {
End Select
//
}

private void OuTouYajirushi(YajirushiSize As Double, X1 As Double, y1 As Double, X2 As Double, Y2)
//
double var ZFX1
double var ZFY1
double var ZFX2
double var ZFY2
double Const Yajirushi_Bai         = 0.5
//
if ( Int(X1) = Int(X2) ) {
    ZFX1 = X1
    ZFY1 = y1
    ZFX2 = X2
    ZFY2 = Y2
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = X1
    ZFY1 = y1
    ZFX2 = X1 - OuTouBai * 0.5 * Yajirushi_Bai
    ZFY2 = y1 + OuTouBai * 2 * Yajirushi_Bai
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = X1
    ZFY1 = y1 + OuTouBai * 1.5 * Yajirushi_Bai
    ZFX2 = X1 - OuTouBai * 0.5 * Yajirushi_Bai
    ZFY2 = y1 + OuTouBai * 2 * Yajirushi_Bai
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = X2
    ZFY1 = Y2
    ZFX2 = X2 - OuTouBai * 0.5 * Yajirushi_Bai
    ZFY2 = Y2 - OuTouBai * 2 * Yajirushi_Bai
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = X2
    ZFY1 = Y2 - OuTouBai * 1.5 * Yajirushi_Bai
    ZFX2 = X2 - OuTouBai * 0.5 * Yajirushi_Bai
    ZFY2 = Y2 - OuTouBai * 2 * Yajirushi_Bai
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
} else {
    ZFX1 = X1
    ZFY1 = y1
    ZFX2 = X2
    ZFY2 = Y2
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = X1
    ZFY1 = y1
    ZFX2 = X1 + OuTouBai * 2 * Yajirushi_Bai
    ZFY2 = y1 - OuTouBai * 0.5 * Yajirushi_Bai
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = X1 + OuTouBai * 2 * Yajirushi_Bai
    ZFY1 = y1 - OuTouBai * 0.5 * Yajirushi_Bai
    ZFX2 = X1 + OuTouBai * 1.5 * Yajirushi_Bai
    ZFY2 = y1
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = X2
    ZFY1 = Y2
    ZFX2 = X2 - OuTouBai * 2 * Yajirushi_Bai
    ZFY2 = Y2 - OuTouBai * 0.5 * Yajirushi_Bai
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = X2 - OuTouBai * 1.5 * Yajirushi_Bai
    ZFY1 = Y2
    ZFX2 = X2 - OuTouBai * 2 * Yajirushi_Bai
    ZFY2 = Y2 - OuTouBai * 0.5 * Yajirushi_Bai
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
}
//
}

private void OuTouYajirushi_ForOutou(YajirushiSize As Double, X1 As Double, y1 As Double, X2 As Double, Y2)
//
double var ZFX1
double var ZFY1
double var ZFX2
double var ZFY2
double Const Yajirushi_Bai         = 0.5
double Const Add5                  = 5
//
if ( Int(X1) = Int(X2) ) {
    ZFX1 = X1
    ZFY1 = y1
    ZFX2 = X2
    ZFY2 = Y2
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = X1
    ZFY1 = y1
    ZFX2 = X1 - OuTouBai * 0.5 * Yajirushi_Bai
    ZFY2 = y1 + OuTouBai * 2 * Yajirushi_Bai
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = X1
    ZFY1 = y1 + OuTouBai * 1.5 * Yajirushi_Bai
    ZFX2 = X1 - OuTouBai * 0.5 * Yajirushi_Bai
    ZFY2 = y1 + OuTouBai * 2 * Yajirushi_Bai
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = X2
    ZFY1 = Y2
    ZFX2 = X2 - OuTouBai * 0.5 * Yajirushi_Bai
    ZFY2 = Y2 - OuTouBai * 2 * Yajirushi_Bai
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = X2
    ZFY1 = Y2 - OuTouBai * 1.5 * Yajirushi_Bai
    ZFX2 = X2 - OuTouBai * 0.5 * Yajirushi_Bai
    ZFY2 = Y2 - OuTouBai * 2 * Yajirushi_Bai
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
} else {
    ZFX1 = X1
    ZFY1 = y1
    ZFX2 = X2
    ZFY2 = Y2
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = X1
    ZFY1 = y1
    ZFX2 = X1 + OuTouBai * 2 * Yajirushi_Bai
    ZFY2 = y1 - OuTouBai * 0.5 * Yajirushi_Bai
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = X1 + OuTouBai * 2 * Yajirushi_Bai
    ZFY1 = y1 - OuTouBai * 0.5 * Yajirushi_Bai
    ZFX2 = X1 + OuTouBai * 1.5 * Yajirushi_Bai
    ZFY2 = y1
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = X2
    ZFY1 = Y2
    ZFX2 = X2 - OuTouBai * 2 * Yajirushi_Bai
    ZFY2 = Y2 - OuTouBai * 0.5 * Yajirushi_Bai
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = X2 - OuTouBai * 1.5 * Yajirushi_Bai
    ZFY1 = Y2
    ZFX2 = X2 - OuTouBai * 2 * Yajirushi_Bai
    ZFY2 = Y2 - OuTouBai * 0.5 * Yajirushi_Bai
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth - Add5
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
}
//
}

private void CheckKuiGroup(KuiNN As Double, N)
//
Select Case KuiNN
Case 1
    XKui1 = XKui1 + 1
    XOutouKui1(XKui1) = N
Case 2
    XKui2 = XKui2 + 1
    XOutouKui2(XKui2) = N
Case 3
    XKui3 = XKui3 + 1
    XOutouKui3(XKui3) = N
Case 4
    XKui4 = XKui4 + 1
    XOutouKui4(XKui4) = N
Case 5
    XKui5 = XKui5 + 1
    XOutouKui5(XKui5) = N
Case 6
    XKui6 = XKui6 + 1
    XOutouKui6(XKui6) = N
Case 7
    XKui7 = XKui7 + 1
    XOutouKui7(XKui7) = N
Case 8
    XKui8 = XKui8 + 1
    XOutouKui8(XKui8) = N
Case 9
    XKui9 = XKui9 + 1
    XOutouKui9(XKui9) = N
Case 10
    XKui10 = XKui10 + 1
    XOutouKui10(XKui10) = N
Case } else {
    XKui1 = XKui1 + 1
    XOutouKui1(XKui1) = N
End Select
//
}

private void CheckOutouValue(Value1 As Double, KuiNN As Double, i)
//
if ( EqualKui = 0 ) {
    Select Case KuiNN
    Case 1
        if ( OutouKui1(i) = -9000000000# ) {
            OutouKui1(i) = Value1
        } else {
            if ( RoundS(OutouKui1(i), 3) = RoundS(Value1, 3) ) {
                EqualKui = 1
            }
        }
    Case 2
        if ( OutouKui2(i) = -9000000000# ) {
            OutouKui2(i) = Value1
        } else {
            if ( RoundS(OutouKui2(i), 3) = RoundS(Value1, 3) ) {
                EqualKui = 1
            }
        }
    Case 3
        if ( OutouKui3(i) = -9000000000# ) {
            OutouKui3(i) = Value1
        } else {
            if ( RoundS(OutouKui3(i), 3) = RoundS(Value1, 3) ) {
                EqualKui = 1
            }
        }
    Case 4
        if ( OutouKui4(i) = -9000000000# ) {
            OutouKui4(i) = Value1
        } else {
            if ( RoundS(OutouKui4(i), 3) = RoundS(Value1, 3) ) {
                EqualKui = 1
            }
        }
    Case 5
        if ( OutouKui5(i) = -9000000000# ) {
            OutouKui5(i) = Value1
        } else {
            if ( RoundS(OutouKui5(i), 3) = RoundS(Value1, 3) ) {
                EqualKui = 1
            }
        }
    Case 6
        if ( OutouKui6(i) = -9000000000# ) {
            OutouKui6(i) = Value1
        } else {
            if ( RoundS(OutouKui6(i), 3) = RoundS(Value1, 3) ) {
                EqualKui = 1
            }
        }
    Case 7
        if ( OutouKui7(i) = -9000000000# ) {
            OutouKui7(i) = Value1
        } else {
            if ( RoundS(OutouKui7(i), 3) = RoundS(Value1, 3) ) {
                EqualKui = 1
            }
        }
    Case 8
        if ( OutouKui8(i) = -9000000000# ) {
            OutouKui8(i) = Value1
        } else {
            if ( RoundS(OutouKui8(i), 3) = RoundS(Value1, 3) ) {
                EqualKui = 1
            }
        }
    Case 9
        if ( OutouKui9(i) = -9000000000# ) {
            OutouKui9(i) = Value1
        } else {
            if ( RoundS(OutouKui9(i), 3) = RoundS(Value1, 3) ) {
                EqualKui = 1
            }
        }
    Case 10
        if ( OutouKui10(i) = -9000000000# ) {
            OutouKui10(i) = Value1
        } else {
            if ( RoundS(OutouKui10(i), 3) = RoundS(Value1, 3) ) {
                EqualKui = 1
            }
        }
    Case } else {
        if ( OutouKui1(i) = -9000000000# ) {
            OutouKui1(i) = Value1
        } else {
            if ( RoundS(OutouKui1(i), 3) = RoundS(Value1, 3) ) {
                EqualKui = 1
            }
        }
    End Select
}
//
}

private void Out_OuTouHeniZu_N1_JibanHeni_SuiHeiBane(N As Double, CA)
// Frame（杭の応答変位図で・地震変位量・水平バネつき）
//
double var EndSuihei
double var StartX11
double var StartY11
double var X11
double var JibanMojiEnd()
double var MaeValue
double var FaFaXxx(100)
double var FaFaYyy(100)
double var FaFaLineType(100)
double var Counter
double var StartXXX1
double var YYYYY1
double var YYYYY2
double var YYYYY3
double var UpXXX
double var DownXXX
double var UpXXXTyakuMokuTen
double var DownXXXTyakuMokuTen
var FFF1                    As Single
double var FFF2
double var FFF3
double var FFF4
var TEMP1                   As Single
double var LLL
double var KuiNN
double var KuiMax
double var i
double var X1
double var y1
double var X2
double var Y2
double var HiRiTsu
double var HiRiTsu1
var ZFX1                    As Single
var ZFY1                    As Single
var MojiZFX1                As Single
var MojiZFY1                As Single
var ZFX2                    As Single
var ZFY2                    As Single
var AZFX2                   As Single
var AZFY2                   As Single
double var GGG
double var Value1
double var Value2
double var Value3
double var OutouValue()
double var OutouAAA()
double var OutouFlag()
double var OutouFlag1()
double var OutouFlag2()
var TTT                     As Variant
var TTT2                    As Variant
var LINETYPE()              As Integer
var LINETYPE1()             As Integer
var LINETYPE2()             As Integer
var LINETYPE3()             As Integer
double var HHH
var HH1                     As Single
double var j
double var HHHZ1()
var HHHZ2()                 As Single
double var SouMax
double var MeterAtari
double var MeterAtari1
double var MeterAtari2
double var AAAA()
double var BBBB
double var CCCC()
double var Endp
double var Maxjiban
double var MaxBane
var JibanValue()            As Single
double var BaneValue()
double var FDFDFD()
double var Add1
double var PMax
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
var QWX1                    As Single
var QWY1                    As Single
//
if ( SuiheiBaneEqual = 1 ) {
    this.Out_OuTouHeniZu_N2_JibanHeni_SuiHeiBane(N, CA)
    return;
}
EndSuihei = 0
Add1 = 5
HiRiTsu = 1
HiRiTsu1 = 10
LLL = 0
if ( InStr(Trim(部材名(N)), "杭") > 0 ) {
    if ( Len(Trim(部材名(N))) = 1 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 2, Len(Trim(部材名(N))) - 1))
    }
}
if ( InStr(Trim(部材名(N)), "側壁") > 0 ) {
    if ( Len(Trim(部材名(N))) = 2 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 3, Len(Trim(部材名(N))) - 1))
    }
}
KuiMax = N_KuiDD(KuiNN)
this.FDFDFD(KuiMax)
this.LINETYPE(KuiMax)
this.LINETYPE1(KuiMax)
this.LINETYPE2(KuiMax)
this.LINETYPE3(KuiMax)
this.OutouValue(KuiMax)
this.OutouFlag(KuiMax)
this.OutouFlag1(KuiMax)
this.OutouFlag2(KuiMax)
this.OutouAAA(KuiMax)
this.HHHZ1(KuiMax)
this.HHHZ2(KuiMax)
GGG = BuzaiH(N)
this.AAAA(KuiMax)
this.CCCC(KuiMax)
this.JibanValue(KuiMax)
this.BaneValue(KuiMax)
this.JibanMojiEnd(KuiMax)
MaxBane = 0
Maxjiban = 0
PMax = 0
BBBB = 0
Endp = PickOutouN(KuiNN, KuiMax, CA)
MaxKuiOuTouLen = 0
For( i = 1 To KuiMax
    Select Case i
    Case 1
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value1 = Value1 * Value2
    Case KuiMax
        Value1 = 0 //PickOutouN(KuiNN, I, OuTouHHH)
        Value2 = 0 //PickBaneN(KuiNN, I, CA)
        Value1 = Value1 * Value2
    Case } else {
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value1 = Value1 * Value2
    End Select
    OutouAAA(i) = PickAAA_N(KuiNN, i)
    if ( i > 1 ) {
        if ( BBBB = RoundS(OutouAAA(i), 3) ) {
            AAAA(i - 1) = 1
        }
    }
    MaxKuiOuTouLen = SMAX(MaxKuiOuTouLen, Value1)
    JibanValue(i) = PickOutouN(KuiNN, i, OuTouHHH)
    BaneValue(i) = PickBaneN(KuiNN, i, CA)
    PMax = SMAX(PMax, BaneValue(i))
    Maxjiban = SMAX(Maxjiban, JibanValue(i))
    MaxBane = SMAX(MaxBane, BaneValue(i))
    LINETYPE(i) = 0
    LINETYPE3(i) = 0
    LINETYPE2(i) = 0
    LINETYPE1(i) = 0
    FDFDFD(i) = -9000000000#
    OutouValue(i) = Value1
    OutouFlag(i) = -9000000000#
    OutouFlag2(i) = -9000000000#
    OutouFlag1(i) = -9000000000#
    JibanMojiEnd(i) = -9000000000#
    HHHZ1(i) = -9000000000#
    HHHZ2(i) = -9000000000#
    if ( i > 1 ) {
        CCCC(i) = RoundS(OutouAAA(i), 3) - BBBB
    }
    BBBB = RoundS(PickAAA_N(KuiNN, i), 3)
}
AAAA(KuiMax) = 1
j = 0
For( i = 1 To KuiMax
    Select Case i
    Case 1
        OutouFlag(i) = -1
        LINETYPE(i) = 1
        OutouFlag2(i) = -1
        LINETYPE2(i) = 1
        OutouFlag1(i) = -1
        LINETYPE1(i) = 1
        LINETYPE3(i) = 1
    Case KuiMax
        OutouFlag(i) = 1
        LINETYPE(i) = 1
        OutouFlag2(i) = 1
        LINETYPE2(i) = 1
        OutouFlag1(i) = 1
        LINETYPE1(i) = 1
        LINETYPE3(i) = 1
        j = j + 1
        HHHZ1(j) = OutouAAA(i)
        if ( j > 1 ) {
            HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
        } else {
            HHHZ2(j) = OutouAAA(i)
        }
    Case } else {
        if ( OutouAAA(i) = OutouAAA(i - 1) ) {
            if ( RoundS(OutouValue(i), 3) = RoundS(OutouValue(i - 1), 3) ) {
                OutouFlag(i - 1) = -9000000000#
                OutouFlag(i) = 0
                LINETYPE(i - 1) = 0
                LINETYPE(i) = 1
            } else {
                OutouFlag(i - 1) = 1
                OutouFlag(i) = -1
                LINETYPE(i - 1) = 0
                LINETYPE(i) = 1
            }
            if ( RoundS(JibanValue(i), 5) = RoundS(JibanValue(i - 1), 5) ) {
                OutouFlag1(i - 1) = -9000000000#
                OutouFlag1(i) = 0
                LINETYPE1(i - 1) = 0
                LINETYPE1(i) = 1
            } else {
                OutouFlag1(i - 1) = 1
                OutouFlag1(i) = -1
                LINETYPE1(i - 1) = 0
                LINETYPE1(i) = 1
            }
            if ( RoundS(BaneValue(i), 3) = RoundS(BaneValue(i - 1), 3) ) {
                OutouFlag2(i - 1) = -9000000000#
                OutouFlag2(i) = 0
                LINETYPE2(i - 1) = 0
                LINETYPE2(i) = 1
            } else {
                OutouFlag2(i - 1) = 1
                OutouFlag2(i) = -1
                LINETYPE2(i - 1) = 0
                LINETYPE2(i) = 1
            }
            if ( RoundS(BaneValue(i), 3) != RoundS(BaneValue(i - 1), 3) ) {
                FDFDFD(i) = BaneValue(i - 1)
                FDFDFD(i - 1) = -9000000000#
                LINETYPE3(i) = 1
                LINETYPE3(i - 1) = 1
            } else {
                if ( SuiheiBaneEqual = 2 ) {
                    FDFDFD(i) = BaneValue(i)
                    FDFDFD(i - 1) = -9000000000#
                    LINETYPE3(i) = 1
                    LINETYPE3(i - 1) = 1
                }
            }
            j = j + 1
            HHHZ1(j) = OutouAAA(i)
            if ( j > 1 ) {
                HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
            } else {
                HHHZ2(j) = OutouAAA(i)
            }
        } else {
            OutouFlag(i) = 0
            LINETYPE(i) = 2
            OutouFlag1(i) = 0
            LINETYPE1(i) = 2
        }
    End Select
}
SouMax = j
HH1 = PickAAA_N(KuiNN, KuiMax)
HHH = HH1 / KuiLengthMax
frmPrint.vsPrt1.TextAngle = 0 * 10
frmPrint.vsPrt1.FontSize = GraphTitleMojiSize * 1.25 ////////////////// nagase

TEMP1 = frmPrint.vsPrt1.PenWidth
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
this.DrawLineZZ(0, 0, 0, KuiMaxLen * HHH * OuTouBai)
frmPrint.vsPrt1.PenWidth = TEMP1
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
MeterAtari = KuiMaxLen * HHH * OuTouBai / HH1
// グラフの上に応答変位荷重を印字
if ( fMainForm.SICheck = True ) { //SI単位チェック
    TTT = "応答変位荷重 (kN/m)"
} else {
    TTT = "応答変位荷重 (tf/m)"
}
MojiZFX1 = OutouStartX
MojiZFY1 = OutouStartY - CON_Y(frmPrint.vsPrt1.FontSize) * 2.5
MyCurrentX = Int(CSng(MojiZFX1))
MyCurrentY = Int(CSng(MojiZFY1))
QWX1 = MyCurrentX
QWY1 = MyCurrentY
PrintoutPrt frmPrint.vsPrt1, TTT
if ( CreateDxfFlag = 1 ) {
    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
    ParamXPoint = QWX1
    ParamYpoint = QWY1
    ParamText = TTT
    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
}
// グラフの上に地盤変位量を印字
TTT = "応答変位量 (m)"
MojiZFX1 = OutouStartX1 + CON_X(frmPrint.vsPrt1.FontSize)
MojiZFY1 = OutouStartY - CON_Y(frmPrint.vsPrt1.FontSize) * 2.5
MyCurrentX = Int(CSng(MojiZFX1))
MyCurrentY = Int(CSng(MojiZFY1))
QWX1 = MyCurrentX
QWY1 = MyCurrentY
PrintoutPrt frmPrint.vsPrt1, TTT
if ( CreateDxfFlag = 1 ) {
    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
    ParamXPoint = QWX1
    ParamYpoint = QWY1
    ParamText = TTT
    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
}
// グラフの上に水平バネ係数を印字
if ( fMainForm.SICheck = True ) { //SI単位チェック
    TTT = "水平バネ定数 (kN/m2)"
} else {
    TTT = "水平バネ定数 (tf/m2)"
}
MojiZFX1 = OutouStartX2 - CON_X(frmPrint.vsPrt1.FontSize * 2)
MojiZFY1 = OutouStartY - CON_Y(frmPrint.vsPrt1.FontSize) * 2.5
MyCurrentX = Int(CSng(MojiZFX1))
MyCurrentY = Int(CSng(MojiZFY1))
QWX1 = MyCurrentX
QWY1 = MyCurrentY
PrintoutPrt frmPrint.vsPrt1, TTT
if ( CreateDxfFlag = 1 ) {
    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
    ParamXPoint = QWX1
    ParamYpoint = QWY1
    ParamText = TTT
    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
}
//
frmPrint.vsPrt1.FontSize = GraphTitleMojiSize
For( i = 1 To KuiMax
    Select Case i
    Case 1
        LLL = PickAAA_N(KuiNN, i)
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
        AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
        if ( MaxKuiOuTouLen != 0 ) {
        if ( GGG = 1 ) {
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N)) + Value3 * HiRiTsu / MaxKuiOuTouLen * MaxKuiOuTou
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
        } else {
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N)) + Value3 * HiRiTsu1 / MaxKuiOuTouLen * MaxKuiOuTou
        }
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                if ( OutouCase2 = 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                } else {
                    frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1, 2       // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    MojiZFY1 = ZFY2 - SouatsuMojiHight * 18
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case KuiMax
        LLL = PickAAA_N(KuiNN, i)
        Value1 = 0 //PickOutouN(KuiNN, I, OuTouHHH)
        Value2 = 0 //PickBaneN(KuiNN, I, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N))
        AZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N))
        if ( MaxKuiOuTouLen != 0 ) {
        if ( GGG = 1 ) {
            ZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N)) + Value3 * HiRiTsu / MaxKuiOuTouLen * MaxKuiOuTou
            ZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N) - LLL)
        } else {
            ZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N))
            ZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N) - LLL) + Value3 * HiRiTsu1 / MaxKuiOuTouLen * MaxKuiOuTou
        }
        }
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2 + Add1
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2 + Add1))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                if ( OutouCase2 = 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                } else {
                    frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1, 2   // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case } else {
        LLL = PickAAA_N(KuiNN, i)
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value3 = Value1 * Value2
        if ( MaxKuiOuTouLen != 0 ) {
        if ( GGG = 1 ) {
            AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
            AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N) - LLL)
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N)) + Value3 * HiRiTsu / MaxKuiOuTouLen * MaxKuiOuTou
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N) - LLL)
        } else {
            AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N) + LLL)
            AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N) + LLL)
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N)) + Value3 * HiRiTsu1 / MaxKuiOuTouLen * MaxKuiOuTou
        }
        }
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                if ( OutouCase2 = 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                } else {
                    frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1
            if ( LINETYPE(i) = 1 || (LINETYPE(i) != 2 $$ LINETYPE(i + 1) = 1) ) {
                if ( OutouFlag(i) != -9000000000# ) {
                    if ( GGG = 1 ) {
                        MojiZFX1 = ZFX2 + SouatsuMojiHight
                        this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                    } else {
                        MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                        this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                    }
                    this.Outou_KakuSub4(GGG)
                    frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                    if ( GGG = 1 ) {
                        this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                    } else {
                        TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                        MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                    }
                    MyCurrentX = Int(CSng(MojiZFX1))
                    MyCurrentY = Int(CSng(MojiZFY1))
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, TTT
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = TTT
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                }
            }
        Case 2      // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    End Select
}
//
if ( SunPouSenX1 = 1 ) {     // 寸法線を書かない場合はここで終了。
} else {
    ZFX1 = OutouStartX
    ZFY1 = OutouStartY
    ZFX2 = OutouStartX + SunPouStartX1
    ZFY2 = OutouStartY
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = OutouStartX
    ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
    ZFX2 = OutouStartX + SunPouStartX1
    ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = OutouStartX + SunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
    ZFY1 = OutouStartY
    ZFX2 = OutouStartX + SunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
    ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
    this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
    this.OuTouPrintUp1(1, SunPouMojiSize1, HH1, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2)) // 杭長の印字
    UpXXX = -9000000000#
    DownXXX = -9000000000#
    YYYYY1 = 0
    YYYYY2 = 0
    For( i = 1 To SouMax
        YYYYY1 = YYYYY1 + HHHZ2(i) * MeterAtari
        frmPrint.vsPrt1.PenWidth = SunPouPenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        ZFX1 = OutouStartX
        ZFY1 = OutouStartY + YYYYY1
        ZFX2 = OutouStartX + SunPouStartX2
        ZFY2 = OutouStartY + YYYYY1
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        ZFX1 = OutouStartX + SunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
        ZFY1 = OutouStartY + YYYYY2
        ZFX2 = OutouStartX + SunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
        ZFY2 = OutouStartY + YYYYY1
        this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
        this.OuTouPrintUp2(SunPouMojiSize2, HHHZ2(i), CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXX, DownXXX) // 杭長の印字
        YYYYY2 = YYYYY1
    }
    if ( SunPouSenX2 = 1 ) {     // 着目点単位の寸法線を書かない場合はここで終了。
    } else {
        YYYYY1 = 0
        YYYYY2 = 0
        YYYYY3 = 0
        FFF1 = 0
        FFF2 = 0
        FFF3 = 0
        FFF4 = 0
        UpXXXTyakuMokuTen = -9000000000#
        DownXXXTyakuMokuTen = -9000000000#
        For( i = 2 To KuiMax
            FFF3 = PickAAA_N(KuiNN, i)
            if ( AAAA(i) = 1 ) {
                if ( FFF1 = 0 ) {
                    if ( i = 2 ) {
                        FFF1 = FFF3
                    } else {
                        FFF1 = FFF3 - PickAAA_N(KuiNN, i - 1)
                    }
                    FFF2 = 1
                    YYYYY1 = FFF3 * MeterAtari
                    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    ZFX1 = OutouStartX
                    ZFY1 = OutouStartY + YYYYY1
                    ZFX2 = OutouStartX + SunPouStartX3
                    ZFY2 = OutouStartY + YYYYY1
                    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                    }
                    ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                    ZFY1 = OutouStartY + YYYYY2
                    ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                    ZFY2 = OutouStartY + YYYYY1
                    this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                    this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                    YYYYY2 = YYYYY1
                    FFF1 = 0
                    FFF2 = 0
                    FFF4 = FFF3
                } else {
                    if ( RoundS(FFF1, 3) = RoundS(CCCC(i), 3) ) {
                        FFF2 = FFF2 + 1
                        YYYYY1 = FFF3 * MeterAtari
                        frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                        if ( CreateDxfFlag = 1 ) {
                            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                        }
                        ZFX1 = OutouStartX
                        ZFY1 = OutouStartY + YYYYY1
                        ZFX2 = OutouStartX + SunPouStartX3
                        ZFY2 = OutouStartY + YYYYY1
                        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                        }
                        ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY1 = OutouStartY + YYYYY2
                        ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY2 = OutouStartY + YYYYY1
                        this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                        this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                        YYYYY2 = YYYYY1
                        FFF1 = 0
                        FFF2 = 0
                        FFF4 = FFF3
                    } else {
                        YYYYY1 = FFF4 * MeterAtari
                        frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                        if ( CreateDxfFlag = 1 ) {
                            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                        }
                        ZFX1 = OutouStartX
                        ZFY1 = OutouStartY + YYYYY1
                        ZFX2 = OutouStartX + SunPouStartX3
                        ZFY2 = OutouStartY + YYYYY1
                        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                        }
                        ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY1 = OutouStartY + YYYYY2
                        ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY2 = OutouStartY + YYYYY1
                        this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                        this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                        YYYYY2 = YYYYY1
                        FFF1 = FFF3 - FFF4
                        FFF2 = 1
                        YYYYY1 = FFF3 * MeterAtari
                        frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                        if ( CreateDxfFlag = 1 ) {
                            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                        }
                        ZFX1 = OutouStartX
                        ZFY1 = OutouStartY + YYYYY1
                        ZFX2 = OutouStartX + SunPouStartX3
                        ZFY2 = OutouStartY + YYYYY1
                        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                        }
                        ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY1 = OutouStartY + YYYYY2
                        ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY2 = OutouStartY + YYYYY1
                        this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                        this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                        YYYYY2 = YYYYY1
                        FFF1 = 0
                        FFF2 = 0
                        FFF4 = FFF3
                    }
                }
            } else {
                if ( i = 2 ) {
                    FFF1 = CCCC(i)
                    FFF2 = 1
                } else {
                    if ( CCCC(i) = 0 ) {
                        FFF1 = 0
                        FFF2 = 0
                    } else {
                        if ( FFF1 = 0 ) {
                            FFF1 = CCCC(i)
                            FFF2 = 1
                        } else {
                            if ( RoundS(FFF1, 3) = RoundS(CCCC(i), 3) ) {
                                FFF2 = FFF2 + 1
                            } else {
                                YYYYY1 = FFF4 * MeterAtari
                                frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                                if ( CreateDxfFlag = 1 ) {
                                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                                }
                                ZFX1 = OutouStartX
                                ZFY1 = OutouStartY + YYYYY1
                                ZFX2 = OutouStartX + SunPouStartX3
                                ZFY2 = OutouStartY + YYYYY1
                                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                                if ( CreateDxfFlag = 1 ) {
                                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                                }
                                ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                                ZFY1 = OutouStartY + YYYYY2
                                ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                                ZFY2 = OutouStartY + YYYYY1
                                this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                                this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                                YYYYY2 = YYYYY1
                                FFF1 = FFF3 - FFF4
                                FFF2 = 1
                                FFF4 = FFF3
                            }
                        }
                    }
                }
            }
            FFF4 = FFF3
        }
    }
}
//
if ( GibanHeniX1 = 1 ) {     // 応答変位量の印字のみ
    return;
}
//
ZFX1 = OutouStartX1
ZFY1 = OutouStartY
ZFX2 = OutouStartX1
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1 - KuiAtsu
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 - KuiAtsu
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 - KuiAtsu
ZFY2 = OutouStartY
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1 - KuiAtsu
ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
ZFX2 = OutouStartX1
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX2
ZFY1 = OutouStartY
ZFX2 = OutouStartX2
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = SunPouPenWidth + 5 + 5
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 + Teisuu1
ZFY2 = OutouStartY
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 + Teisuu3
ZFY2 = OutouStartY
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1
ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
ZFX2 = OutouStartX1 + Teisuu3
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1 + Teisuu2
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 + Teisuu2
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
this.OuTouPrintUp1(1, SunPouMojiSize1, HH1, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2)) // 杭長の印字
MeterAtari1 = Teisuu4 / (Maxjiban * 1000)
MeterAtari2 = Teisuu5 / MaxBane
ZFX1 = OutouStartX1 + MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 + MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenStyle = psSolid
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
this.PlotLine1(CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), 2)
if ( JibanValue(KuiMax) > 0 ) {
    EndSuihei = 1
    ZFX1 = OutouStartX1 + MeterAtari1 * 0 * 1000 * JibanYoko
    ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
    ZFX2 = OutouStartX1 + MeterAtari1 * 0 * 1000 * JibanYoko + SyitaX
    ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai + SyitaY
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = OutouStartX1 + MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko
    ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
    ZFX2 = OutouStartX1 + MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko + SyitaX
    ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai + SyitaY
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = OutouStartX1 + SyitaX1
    ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai + SyitaY1
    ZFX2 = OutouStartX1 + MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko + SyitaX1
    ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai + SyitaY1
    this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
    this.OuTouPrintUp1_Y5(1, SunPouMojiSize1, JibanValue(KuiMax), CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2)) // 杭長の印字
}
//
StartXXX1 = MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko
For( i = 1 To KuiMax
    Select Case i
    Case 1
        LLL = PickAAA_N(KuiNN, i)
        Value1 = PickOutouN(KuiNN, i, OuTouHHH)
        Value3 = Value1
        AZFX2 = OutouStartX1 + StartXXX1
        AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        ZFX2 = OutouStartX1 + (Value3 * HiRiTsu * 1000) * MeterAtari1 * JibanYoko
        ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        ZFX1 = ZFX2
        ZFY1 = ZFY2
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE1(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE1(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE1(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case GibanHeniX2
        Case 2
            if ( LINETYPE1(i) = 1 || (LINETYPE1(i) != 2 $$ LINETYPE1(i + 1) = 1) ) {
                if ( OutouFlag1(i) != -9000000000# ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    MojiZFY1 = ZFY2 - SouatsuMojiHight * 18
                    frmPrint.vsPrt1.TextAngle = 0 * 10
                    frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                    this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                    JibanMojiEnd(i) = MojiZFX1 + CON_X(SouatsuMojiHight * Len(TTT) / 2)
                    MyCurrentX = Int(CSng(MojiZFX1))
                    MyCurrentY = Int(CSng(MojiZFY1))
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, TTT
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = TTT
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                }
            }
        Case 3      // 変位荷重数値印刷
            if ( OutouFlag1(i) != -9000000000# ) {
                MojiZFX1 = ZFX2 + SouatsuMojiHight
                MojiZFY1 = ZFY2 - SouatsuMojiHight * 18
                frmPrint.vsPrt1.TextAngle = 0 * 10
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                JibanMojiEnd(i) = MojiZFX1 + CON_X(SouatsuMojiHight * Len(TTT) / 2)
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case KuiMax
        LLL = PickAAA_N(KuiNN, i)
        Value1 = PickOutouN(KuiNN, i, OuTouHHH)
        Value3 = Value1
        AZFX2 = OutouStartX1 + StartXXX1
        AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        ZFX2 = OutouStartX1 + (Value3 * HiRiTsu * 1000) * MeterAtari1 * JibanYoko
        ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE1(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE1(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE1(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case GibanHeniX2
        Case 2
            if ( LINETYPE1(i) = 1 ) {
                if ( OutouFlag1(i) != -9000000000# ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag1(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                    frmPrint.vsPrt1.TextAngle = 0 * 10
                    frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                    this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                    JibanMojiEnd(i) = MojiZFX1 + CON_X(SouatsuMojiHight * Len(TTT) / 2)
                    MyCurrentX = Int(CSng(MojiZFX1))
                    MyCurrentY = Int(CSng(MojiZFY1))
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, TTT
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = TTT
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                }
            }
        Case 3      // 変位荷重数値印刷
            if ( OutouFlag1(i) != -9000000000# ) {
                MojiZFX1 = ZFX2 + SouatsuMojiHight
                this.Outou_KakuSub3(OutouFlag1(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                frmPrint.vsPrt1.TextAngle = 0 * 10
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                JibanMojiEnd(i) = MojiZFX1 + CON_X(SouatsuMojiHight * Len(TTT) / 2)
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case } else {
        LLL = PickAAA_N(KuiNN, i)
        Value1 = PickOutouN(KuiNN, i, OuTouHHH)
        Value3 = Value1
        AZFX2 = OutouStartX1 + StartXXX1
        AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        ZFX2 = OutouStartX1 + (Value3 * HiRiTsu * 1000) * MeterAtari1 * JibanYoko
        ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE1(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE1(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE1(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case GibanHeniX2
        Case 2
            if ( LINETYPE1(i) = 1 || (LINETYPE1(i) != 2 $$ LINETYPE1(i + 1) = 1) ) {
                if ( OutouFlag1(i) != -9000000000# ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag1(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                    frmPrint.vsPrt1.TextAngle = 0 * 10
                    frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                    this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                    JibanMojiEnd(i) = MojiZFX1 + CON_X(SouatsuMojiHight * Len(TTT) / 2)
                    MyCurrentX = Int(CSng(MojiZFX1))
                    MyCurrentY = Int(CSng(MojiZFY1))
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, TTT
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = TTT
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                }
            }
        Case 3      // 変位荷重数値印刷
            if ( OutouFlag1(i) != -9000000000# ) {
                MojiZFX1 = ZFX2 + SouatsuMojiHight
                this.Outou_KakuSub3(OutouFlag1(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                frmPrint.vsPrt1.TextAngle = 0 * 10
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                JibanMojiEnd(i) = MojiZFX1 + CON_X(SouatsuMojiHight * Len(TTT) / 2)
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    End Select
}
//
For( i = 1 To 100
    FaFaXxx(i) = -9000000000#
    FaFaYyy(i) = -9000000000#
    FaFaLineType(i) = -9000000000#
}
//
Select Case Int(SuiheiBaneX3)
Case 1
    X11 = 0
    Counter = 0
    For( i = 1 To KuiMax
        Select Case i
        Case 1
            LLL = PickAAA_N(KuiNN, i)
            Value1 = PickBaneN(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            X11 = 1
            StartX11 = ZFX2
            StartY11 = ZFY2
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            if ( LINETYPE2(i) > 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE1(i) > 1 ) {
                    if ( OutouCase4 = 1 ) {
                        this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE2(i)))
                    } else {
                        DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                        }
                    }
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
            Counter = Counter + 1
            FaFaXxx(Counter) = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            FaFaLineType(Counter) = 1
            MaeValue = Value3
            ZFX1 = ZFX2
            ZFY1 = ZFY2
        Case KuiMax
            LLL = PickAAA_N(KuiNN, i)
            Value1 = PickBaneN(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            Counter = Counter + 1
            FaFaXxx(Counter) = OutouStartX2
            FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            FaFaLineType(Counter) = 2
            if ( LINETYPE2(i) > 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE1(i) > 1 ) {
                    if ( OutouCase4 = 1 ) {
                        this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE2(i)))
                    } else {
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                        }
                        DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    }
                } else {
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                }
            }
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
                if ( LINETYPE3(i) > 0 ) {
                    this.Outou_KakuSub6(Value3, OutouCase5, TTT)
                    if ( X11 = 1 ) {
                        if ( (ZFX2 - AZFX2) / 2 > CON_X2(SouatsuMojiHight * FFLen(TTT) / 2) / 2 ) {
                            MojiZFX1 = AZFX2 + (ZFX2 - AZFX2) / 2 - CON_X2(SouatsuMojiHight * FFLen(TTT) / 2) / 2
                        } else {
                            MojiZFX1 = ZFX2 + SouatsuMojiHight
                        }
                        MojiZFY1 = StartY11 + (ZFY2 - StartY11) / 2 - CON_Y(SouatsuMojiHight) / 2
                        frmPrint.vsPrt1.TextAngle = 0
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub5(Value3, OutouCase5, TTT)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                        X11 = 0
                    } else {
                        if ( X11 = 0 ) {
                            X11 = 1
                            StartX11 = ZFX2
                            StartY11 = ZFY2
                        }
                    }
                }
            }
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            MaeValue = Value3
        Case } else {
            LLL = PickAAA_N(KuiNN, i)
            Value1 = PickBaneN(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            if ( FDFDFD(i) >= 0 ) {
                Counter = Counter + 1
                FaFaXxx(Counter) = OutouStartX2 + BaneBairitsuHosei((FDFDFD(i) * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
                FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
                FaFaLineType(Counter) = 2
            }
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
                if ( LINETYPE3(i) > 0 ) {
                    this.Outou_KakuSub6(Value3, OutouCase5, TTT)
                    if ( X11 = 1 ) {
                        if ( (ZFX2 - AZFX2) / 2 > CON_X2(SouatsuMojiHight * FFLen(TTT) / 2) / 2 ) {
                            MojiZFX1 = AZFX2 + (ZFX2 - AZFX2) / 2 - CON_X2(SouatsuMojiHight * FFLen(TTT) / 2) / 2
                        } else {
                            MojiZFX1 = ZFX2 + SouatsuMojiHight
                        }
                        MojiZFY1 = StartY11 + (ZFY2 - StartY11) / 2 - CON_Y(SouatsuMojiHight) / 2
                        frmPrint.vsPrt1.TextAngle = 0
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub5(Value3, OutouCase5, TTT)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                        X11 = 0
                    } else {
                        if ( X11 = 0 ) {
                            X11 = 1
                            StartX11 = ZFX2
                            StartY11 = ZFY2
                        }
                    }
                }
            }
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            MaeValue = Value3
        End Select
    }
Case 2
    Counter = 0
    For( i = 1 To KuiMax
        Select Case i
        Case 1
            LLL = PickAAA_N(KuiNN, i)
            Value1 = PickBaneN(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            if ( LINETYPE2(i) > 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE1(i) > 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE2(i)))
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
            Counter = Counter + 1
            FaFaXxx(Counter) = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            FaFaLineType(Counter) = 1
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
                if ( LINETYPE2(i) = 1 || (LINETYPE2(i) != 2 $$ LINETYPE2(i + 1) = 1) ) {
                    if ( OutouFlag2(i) != -9000000000# ) {
                        MojiZFX1 = ZFX2 + SouatsuMojiHight
                        this.Outou_KakuSub3(OutouFlag2(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                        frmPrint.vsPrt1.TextAngle = 0 * 10
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub5(Value3, OutouCase5, TTT)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                    }
                }
            }
            MaeValue = Value3
            ZFX1 = ZFX2
            ZFY1 = ZFY2
        Case KuiMax
            LLL = PickAAA_N(KuiNN, i)
            Value1 = PickBaneN(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            Counter = Counter + 1
            FaFaXxx(Counter) = OutouStartX2
            FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            FaFaLineType(Counter) = 2
            if ( LINETYPE2(i) > 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE2(i) > 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE2(i)))
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
                if ( LINETYPE2(i) = 1 ) {
                    if ( OutouFlag2(i) != -9000000000# ) {
                        MojiZFX1 = ZFX2 + SouatsuMojiHight
                        this.Outou_KakuSub3(OutouFlag2(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                        frmPrint.vsPrt1.TextAngle = 0 * 10
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub5(Value3, OutouCase5, TTT)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                    }
                }
            }
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            MaeValue = Value3
        Case } else {
            LLL = PickAAA_N(KuiNN, i)
            Value1 = PickBaneN(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
            }
            if ( FDFDFD(i) >= 0 ) {
                Counter = Counter + 1
                FaFaXxx(Counter) = OutouStartX2 + BaneBairitsuHosei((FDFDFD(i) * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
                FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
                FaFaLineType(Counter) = 2
            }
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
                if ( LINETYPE2(i) = 1 || (LINETYPE2(i) != 2 $$ LINETYPE2(i + 1) = 1) ) {
                    if ( OutouFlag2(i) != -9000000000# ) {
                        MojiZFX1 = ZFX2 + SouatsuMojiHight
                        this.Outou_KakuSub3(OutouFlag2(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                        frmPrint.vsPrt1.TextAngle = 0
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub5(Value3, OutouCase5, TTT)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                    }
                }
            }
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            MaeValue = Value3
        End Select
    }
Case } else {
End Select
//
if ( Counter > 0 ) {
    For( i = 1 To Counter
        ZFX1 = OutouStartX1
        ZFY1 = FaFaYyy(i)
        ZFX2 = OutouStartX1 + StartXXX1
        ZFY2 = FaFaYyy(i)
        frmPrint.vsPrt1.PenStyle = psSolid
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        if ( FaFaLineType(i) > 1 ) {
            if ( OutouCase4 = 1 ) {
                this.PlotLine1(CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), CInt(FaFaLineType(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
            }
        } else {
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
        }
        ZFX1 = FaFaXxx(i)
        ZFY1 = FaFaYyy(i)
        ZFX2 = OutouStartX2
        ZFY2 = FaFaYyy(i)
        frmPrint.vsPrt1.PenStyle = psSolid
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        if ( FaFaLineType(i) > 1 ) {
            if ( OutouCase4 = 1 ) {
                this.PlotLine1(CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), CInt(FaFaLineType(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
            }
        } else {
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
        }
    }
}
//
}

private void Out_OuTouHeniZu_G1_JibanHeni_SuiHeiBane(N As Double, CA As Double, OU)
// For( Gouiki（杭の応答変位図で・地震変位量・水平バネつき）
//
double var EndSuihei
double var StartX11
double var StartY11
double var X11
double var JibanMojiEnd()
double var MaeValue
double var FaFaXxx(100)
double var FaFaYyy(100)
double var FaFaLineType(100)
double var Counter
double var StartXXX1
double var YYYYY1
double var YYYYY2
double var YYYYY3
double var UpXXX
double var DownXXX
double var UpXXXTyakuMokuTen
double var DownXXXTyakuMokuTen
var FFF1                    As Single
double var FFF2
double var FFF3
double var FFF4
double var LLL
double var KuiNN
double var KuiMax
double var i
double var X1
double var y1
double var X2
double var Y2
double var HiRiTsu
double var HiRiTsu1
var ZFX1                    As Single
var ZFY1                    As Single
var MojiZFX1                As Single
var MojiZFY1                As Single
var ZFX2                    As Single
var ZFY2                    As Single
var AZFX2                   As Single
var AZFY2                   As Single
double var GGG
double var Value1
double var Value2
double var Value3
double var OutouValue()
double var OutouAAA()
double var OutouFlag()
double var OutouFlag1()
double var OutouFlag2()
var TTT                     As Variant
var TTT2                    As Variant
double var OuTouN
var LINETYPE()              As Integer
var LINETYPE2()             As Integer
var LINETYPE3()             As Integer
double var HHH
var HH1                     As Single
var TEMP1                   As Single
double var j
double var HHHZ1()
var HHHZ2()                 As Single
double var SouMax
double var MeterAtari
double var MeterAtari1
double var MeterAtari2
double var AAAA()
double var BBBB
double var CCCC()
double var Endp
double var Maxjiban
double var MaxBane
var JibanValue()            As Single
double var BaneValue()
double var FDFDFD()
double var Add1
double var PMax
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
var QWX1                    As Single
var QWY1                    As Single
//
if ( SuiheiBaneEqual = 1 ) {
    this.Out_OuTouHeniZu_G2_JibanHeni_SuiHeiBane(N, CA, OU)
    return;
}
PMax = 0
EndSuihei = 0
Add1 = 5
OuTouN = OU
HiRiTsu = 1
HiRiTsu1 = 10
LLL = 0
if ( InStr(Trim(部材名(N)), "杭") > 0 ) {
    if ( Len(Trim(部材名(N))) = 1 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 2, Len(Trim(部材名(N))) - 1))
    }
}
if ( InStr(Trim(部材名(N)), "側壁") > 0 ) {
    if ( Len(Trim(部材名(N))) = 2 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 3, Len(Trim(部材名(N))) - 1))
    }
}
Endp = PickOutouG(KuiNN, KuiMax)
KuiMax = G_KuiDD(KuiNN)
this.FDFDFD(KuiMax)
this.LINETYPE(KuiMax)
this.LINETYPE1(KuiMax)
this.LINETYPE2(KuiMax)
this.LINETYPE3(KuiMax)
this.OutouValue(KuiMax)
this.OutouFlag(KuiMax)
this.OutouFlag1(KuiMax)
this.OutouFlag2(KuiMax)
this.OutouAAA(KuiMax)
this.HHHZ1(KuiMax)
this.HHHZ2(KuiMax)
GGG = BuzaiH(N)
this.AAAA(KuiMax)
this.CCCC(KuiMax)
this.JibanValue(KuiMax)
this.BaneValue(KuiMax)
this.JibanMojiEnd(KuiMax)
MaxBane = 0
Maxjiban = 0
MaxKuiOuTouLen = 0
For( i = 1 To KuiMax
    Select Case i
    Case 1
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value1 = Value1 * Value2
    Case KuiMax
        Value1 = 0 //PickOutouG(KuiNN, I)
        Value2 = 0 //PickBaneG(KuiNN, I, CA)
        Value1 = Value1 * Value2
    Case } else {
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value1 = Value1 * Value2
    End Select
    MaxKuiOuTouLen = SMAX(MaxKuiOuTouLen, Value1)
    JibanValue(i) = PickOutouG(KuiNN, i)
    BaneValue(i) = PickBaneG(KuiNN, i, CA)
    PMax = SMAX(PMax, BaneValue(i))
    Maxjiban = SMAX(Maxjiban, JibanValue(i))
    MaxBane = SMAX(MaxBane, BaneValue(i))
    LINETYPE(i) = 0
    LINETYPE1(i) = 0
    LINETYPE2(i) = 0
    LINETYPE3(i) = 0
    FDFDFD(i) = -9000000000#
    OutouAAA(i) = PickAAA_G(KuiNN, i)
    if ( i > 1 ) {
        if ( BBBB = RoundS(OutouAAA(i), 3) ) {
            AAAA(i - 1) = 1
        }
    }
    JibanMojiEnd(i) = -9000000000#
    OutouValue(i) = Value1
    OutouFlag(i) = -9000000000#
    OutouFlag1(i) = -9000000000#
    OutouFlag2(i) = -9000000000#
    HHHZ1(i) = -9000000000#
    HHHZ2(i) = -9000000000#
    if ( i > 1 ) {
        CCCC(i) = RoundS(OutouAAA(i), 3) - BBBB
    }
    BBBB = RoundS(PickAAA_G(KuiNN, i), 3)
}
AAAA(KuiMax) = 1
j = 0
For( i = 1 To KuiMax
    Select Case i
    Case 1
        OutouFlag(i) = -1
        LINETYPE(i) = 1
        OutouFlag1(i) = -1
        LINETYPE1(i) = 1
        OutouFlag2(i) = -1
        LINETYPE2(i) = 1
        LINETYPE3(i) = 1
    Case KuiMax
        OutouFlag(i) = 1
        LINETYPE(i) = 1
        OutouFlag1(i) = 1
        LINETYPE1(i) = 1
        OutouFlag2(i) = 1
        LINETYPE2(i) = 1
        LINETYPE3(i) = 1
        j = j + 1
        HHHZ1(j) = OutouAAA(i)
        if ( j > 1 ) {
            HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
        } else {
            HHHZ2(j) = OutouAAA(i)
        }
    Case } else {
        if ( RoundS(OutouAAA(i), 3) = RoundS(OutouAAA(i - 1), 3) ) {
            if ( RoundS(OutouValue(i), 3) = RoundS(OutouValue(i - 1), 3) ) {
                OutouFlag(i - 1) = -9000000000#
                OutouFlag(i) = 0
                LINETYPE(i - 1) = 0
                LINETYPE(i) = 1
            } else {
                OutouFlag(i - 1) = 1
                OutouFlag(i) = -1
                LINETYPE(i - 1) = 0
                LINETYPE(i) = 1
            }
            if ( RoundS(JibanValue(i), 3) = RoundS(JibanValue(i - 1), 3) ) {
                OutouFlag1(i - 1) = -9000000000#
                OutouFlag1(i) = 0
                LINETYPE1(i - 1) = 0
                LINETYPE1(i) = 1
            } else {
                OutouFlag1(i - 1) = 1
                OutouFlag1(i) = -1
                LINETYPE1(i - 1) = 0
                LINETYPE1(i) = 1
            }
            if ( RoundS(BaneValue(i), 3) = RoundS(BaneValue(i - 1), 3) ) {
                OutouFlag2(i - 1) = -9000000000#
                OutouFlag2(i) = 0
                LINETYPE2(i - 1) = 0
                LINETYPE2(i) = 1
            } else {
                OutouFlag2(i - 1) = 1
                OutouFlag2(i) = -1
                LINETYPE2(i - 1) = 0
                LINETYPE2(i) = 1
            }
            if ( RoundS(BaneValue(i), 3) != RoundS(BaneValue(i - 1), 3) ) {
                FDFDFD(i) = BaneValue(i - 1)
                FDFDFD(i - 1) = -9000000000#
                LINETYPE3(i) = 1
                LINETYPE3(i - 1) = 1
            } else {
                if ( SuiheiBaneEqual = 2 ) {
                    FDFDFD(i) = BaneValue(i)
                    FDFDFD(i - 1) = -9000000000#
                    LINETYPE3(i) = 1
                    LINETYPE3(i - 1) = 1
                }
            }
            j = j + 1
            HHHZ1(j) = OutouAAA(i)
            if ( j > 1 ) {
                HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
            } else {
                HHHZ2(j) = OutouAAA(i)
            }
        } else {
            OutouFlag(i) = 0
            LINETYPE(i) = 2
            OutouFlag1(i) = 0
            LINETYPE1(i) = 2
        }
    End Select
}
SouMax = j
HH1 = PickAAA_G(KuiNN, KuiMax)
HHH = HH1 / KuiLengthMax
TEMP1 = frmPrint.vsPrt1.PenWidth
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
this.DrawLineZZ(0, 0, 0, KuiMaxLen * HHH * OuTouBai)
MeterAtari = KuiMaxLen * HHH * OuTouBai / HH1
frmPrint.vsPrt1.PenWidth = TEMP1
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
Endp = PickOutouG(KuiNN, KuiMax)

frmPrint.vsPrt1.TextAngle = 0 * 10
frmPrint.vsPrt1.FontSize = GraphTitleMojiSize // * 1.25 //////////////// nagase

// グラフの上に応答変位荷重を印字
if ( fMainForm.SICheck = True ) { //SI単位チェック
    TTT = "応答変位荷重 (kN/m)"
} else {
    TTT = "応答変位荷重 (tf/m)"
}
MojiZFX1 = OutouStartX //- CON_X(frmPrint.vsPrt1.FontSize * FFLen(TTT) / 4)
MojiZFY1 = OutouStartY - CON_Y(frmPrint.vsPrt1.FontSize) * 2.5
MyCurrentX = Int(CSng(MojiZFX1))
MyCurrentY = Int(CSng(MojiZFY1))
QWX1 = MyCurrentX
QWY1 = MyCurrentY
PrintoutPrt frmPrint.vsPrt1, TTT
if ( CreateDxfFlag = 1 ) {
    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
    ParamXPoint = QWX1
    ParamYpoint = QWY1
    ParamText = TTT
    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
}
// グラフの上に地盤変位量を印字
TTT = "応答変位量 (m)"
MojiZFX1 = OutouStartX1 + CON_X(frmPrint.vsPrt1.FontSize)
MojiZFY1 = OutouStartY - CON_Y(frmPrint.vsPrt1.FontSize) * 2.5
MyCurrentX = Int(CSng(MojiZFX1))
MyCurrentY = Int(CSng(MojiZFY1))
QWX1 = MyCurrentX
QWY1 = MyCurrentY
PrintoutPrt frmPrint.vsPrt1, TTT
if ( CreateDxfFlag = 1 ) {
    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
    ParamXPoint = QWX1
    ParamYpoint = QWY1
    ParamText = TTT
    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
}
// グラフの上に水平バネ係数を印字
if ( fMainForm.SICheck = True ) { //SI単位チェック
    TTT = "水平バネ定数 (kN/m2)"
} else {
    TTT = "水平バネ定数 (tf/m2)"
}
MojiZFX1 = OutouStartX2 - CON_X(frmPrint.vsPrt1.FontSize * 2)
MojiZFY1 = OutouStartY - CON_Y(frmPrint.vsPrt1.FontSize) * 2.5
MyCurrentX = Int(CSng(MojiZFX1))
MyCurrentY = Int(CSng(MojiZFY1))
QWX1 = MyCurrentX
QWY1 = MyCurrentY
PrintoutPrt frmPrint.vsPrt1, TTT
if ( CreateDxfFlag = 1 ) {
    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
    ParamXPoint = QWX1
    ParamYpoint = QWY1
    ParamText = TTT
    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
}
//
frmPrint.vsPrt1.FontSize = GraphTitleMojiSize
For( i = 1 To KuiMax
    Select Case i
    Case 1
        LLL = PickAAA_G(KuiNN, i)
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
        AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
        if ( GGG = 1 $$ MaxKuiOuTouLen != 0 ) {
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N)) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxKuiOuTou
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
        } else {
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N)) + Value3 * HiRiTsu1
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2 + Add1
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2 + Add1))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                if ( OutouCase2 = 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                } else {
                    frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1, 2     // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    MojiZFY1 = ZFY2 - SouatsuMojiHight * 18
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    Select Case OoutouHeniKetaSuu
                    Case 0
                        TTT = " " & str(Int(SMAX(OutouValue(i), 0)))
                    Case 1
                        TTT = " " & Format(SMAX(OutouValue(i), 0), "0.0")
                    Case 2
                        TTT = " " & Format(SMAX(OutouValue(i), 0), "0.00")
                    Case 3
                        TTT = " " & Format(SMAX(OutouValue(i), 0), "0.000")
                    Case } else {
                        TTT = " " & Format(SMAX(OutouValue(i), 0), "0.000")
                    End Select
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case KuiMax
        LLL = PickAAA_G(KuiNN, i)
        Value1 = 0 //PickOutouG(KuiNN, I)
        Value2 = 0 //PickBaneG(KuiNN, I, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N))
        AZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N))
        if ( GGG = 1 $$ MaxKuiOuTouLen != 0 ) {
            ZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N)) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxKuiOuTou
            ZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N) - LLL)
        } else {
            ZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N))
            ZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N) - LLL) + Value3 * HiRiTsu1
        }
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                if ( OutouCase2 = 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                } else {
                    frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1, 2     // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case } else {
        LLL = PickAAA_G(KuiNN, i)
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value3 = Value1 * Value2
        if ( GGG = 1 $$ MaxKuiOuTouLen != 0 ) {
            AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
            AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N) - LLL)
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N)) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxKuiOuTou
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N) - LLL)
        } else {
            AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N) + LLL)
            AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N) + LLL)
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N)) + Value3 * HiRiTsu1
        }
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
       if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                if ( OutouCase2 = 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                } else {
                    frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1
            if ( LINETYPE(i) = 1 || (LINETYPE(i) != 2 $$ LINETYPE(i + 1) = 1) ) {
                if ( OutouFlag(i) != -9000000000# ) {
                    if ( GGG = 1 ) {
                        MojiZFX1 = ZFX2 + SouatsuMojiHight
                        this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                    } else {
                        MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                        this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                    }
                    this.Outou_KakuSub4(GGG)
                    frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                    if ( GGG = 1 ) {
                        this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                    } else {
                        TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                        MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                    }
                    MyCurrentX = Int(CSng(MojiZFX1))
                    MyCurrentY = Int(CSng(MojiZFY1))
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, TTT
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = TTT
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                }
            }
        Case 2      // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    End Select
}
//
if ( SunPouSenX1 = 1 ) {     // 寸法線を書かない場合はここで終了。
} else {
    ZFX1 = OutouStartX
    ZFY1 = OutouStartY
    ZFX2 = OutouStartX + SunPouStartX1
    ZFY2 = OutouStartY
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = OutouStartX
    ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
    ZFX2 = OutouStartX + SunPouStartX1
    ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = OutouStartX + SunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
    ZFY1 = OutouStartY
    ZFX2 = OutouStartX + SunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
    ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
    this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
    this.OuTouPrintUp1(1, SunPouMojiSize1, HH1, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2)) // 杭長の印字
    UpXXX = -9000000000#
    DownXXX = -9000000000#
    YYYYY1 = 0
    YYYYY2 = 0
    For( i = 1 To SouMax
        YYYYY1 = YYYYY1 + HHHZ2(i) * MeterAtari
        frmPrint.vsPrt1.PenWidth = SunPouPenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        ZFX1 = OutouStartX
        ZFY1 = OutouStartY + YYYYY1
        ZFX2 = OutouStartX + SunPouStartX2
        ZFY2 = OutouStartY + YYYYY1
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        ZFX1 = OutouStartX + SunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
        ZFY1 = OutouStartY + YYYYY2
        ZFX2 = OutouStartX + SunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
        ZFY2 = OutouStartY + YYYYY1
        this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
        this.OuTouPrintUp2(SunPouMojiSize2, HHHZ2(i), CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXX, DownXXX) // 杭長の印字
        YYYYY2 = YYYYY1
    }
    //
    if ( SunPouSenX2 = 1 ) {     // 着目点単位の寸法線を書かない場合はここで終了。
    } else {
        YYYYY1 = 0
        YYYYY2 = 0
        YYYYY3 = 0
        FFF1 = 0
        FFF2 = 0
        FFF3 = 0
        FFF4 = 0
        UpXXXTyakuMokuTen = -9000000000#
        DownXXXTyakuMokuTen = -9000000000#
        For( i = 2 To KuiMax
            FFF3 = PickAAA_G(KuiNN, i)
            if ( AAAA(i) = 1 ) {
                if ( FFF1 = 0 ) {
                    if ( i = 2 ) {
                        FFF1 = FFF3
                    } else {
                        FFF1 = FFF3 - PickAAA_G(KuiNN, i - 1)
                    }
                    FFF2 = 1
                    YYYYY1 = FFF3 * MeterAtari
                    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    ZFX1 = OutouStartX
                    ZFY1 = OutouStartY + YYYYY1
                    ZFX2 = OutouStartX + SunPouStartX3
                    ZFY2 = OutouStartY + YYYYY1
                    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                    }
                    ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                    ZFY1 = OutouStartY + YYYYY2
                    ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                    ZFY2 = OutouStartY + YYYYY1
                    this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                    this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                    YYYYY2 = YYYYY1
                    FFF1 = 0
                    FFF2 = 0
                    FFF4 = FFF3
                } else {
                    if ( RoundS(FFF1, 3) = RoundS(CCCC(i), 3) ) {
                        FFF2 = FFF2 + 1
                        YYYYY1 = FFF3 * MeterAtari
                        frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                        if ( CreateDxfFlag = 1 ) {
                            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                        }
                        ZFX1 = OutouStartX
                        ZFY1 = OutouStartY + YYYYY1
                        ZFX2 = OutouStartX + SunPouStartX3
                        ZFY2 = OutouStartY + YYYYY1
                        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                        }
                        ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY1 = OutouStartY + YYYYY2
                        ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY2 = OutouStartY + YYYYY1
                        this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                        this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                        YYYYY2 = YYYYY1
                        FFF1 = 0
                        FFF2 = 0
                        FFF4 = FFF3
                    } else {
                        YYYYY1 = FFF4 * MeterAtari
                        frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                        if ( CreateDxfFlag = 1 ) {
                            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                        }
                        ZFX1 = OutouStartX
                        ZFY1 = OutouStartY + YYYYY1
                        ZFX2 = OutouStartX + SunPouStartX3
                        ZFY2 = OutouStartY + YYYYY1
                        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                        }
                        ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY1 = OutouStartY + YYYYY2
                        ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY2 = OutouStartY + YYYYY1
                        this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                        this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                        YYYYY2 = YYYYY1
                        FFF1 = FFF3 - FFF4
                        FFF2 = 1
                        YYYYY1 = FFF3 * MeterAtari
                        frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                        if ( CreateDxfFlag = 1 ) {
                            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                        }
                        ZFX1 = OutouStartX
                        ZFY1 = OutouStartY + YYYYY1
                        ZFX2 = OutouStartX + SunPouStartX3
                        ZFY2 = OutouStartY + YYYYY1
                        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                        }
                        ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY1 = OutouStartY + YYYYY2
                        ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY2 = OutouStartY + YYYYY1
                        this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                        this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                        YYYYY2 = YYYYY1
                        FFF1 = 0
                        FFF2 = 0
                        FFF4 = FFF3
                    }
                }
            } else {
                if ( i = 2 ) {
                    FFF1 = CCCC(i)
                    FFF2 = 1
                } else {
                    if ( CCCC(i) = 0 ) {
                        FFF1 = 0
                        FFF2 = 0
                    } else {
                        if ( FFF1 = 0 ) {
                            FFF1 = CCCC(i)
                            FFF2 = 1
                        } else {
                            if ( RoundS(FFF1, 3) = RoundS(CCCC(i), 3) ) {
                                FFF2 = FFF2 + 1
                            } else {
                                YYYYY1 = FFF4 * MeterAtari
                                frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                                if ( CreateDxfFlag = 1 ) {
                                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                                }
                                ZFX1 = OutouStartX
                                ZFY1 = OutouStartY + YYYYY1
                                ZFX2 = OutouStartX + SunPouStartX3
                                ZFY2 = OutouStartY + YYYYY1
                                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                                if ( CreateDxfFlag = 1 ) {
                                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                                }
                                ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                                ZFY1 = OutouStartY + YYYYY2
                                ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                                ZFY2 = OutouStartY + YYYYY1
                                this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                                this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                                YYYYY2 = YYYYY1
                                FFF1 = FFF3 - FFF4
                                FFF2 = 1
                                FFF4 = FFF3
                            }
                        }
                    }
                }
            }
            FFF4 = FFF3
        }
    }
}
//
if ( GibanHeniX1 = 1 ) {     // 応答変位量の印字のみ
    return;
}
//
ZFX1 = OutouStartX1
ZFY1 = OutouStartY
ZFX2 = OutouStartX1
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1 - KuiAtsu
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 - KuiAtsu
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 - KuiAtsu
ZFY2 = OutouStartY
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1 - KuiAtsu
ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
ZFX2 = OutouStartX1
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX2
ZFY1 = OutouStartY
ZFX2 = OutouStartX2
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = SunPouPenWidth + 5 + 5
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 + Teisuu1
ZFY2 = OutouStartY
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 + Teisuu3
ZFY2 = OutouStartY
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1
ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
ZFX2 = OutouStartX1 + Teisuu3
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1 + Teisuu2
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 + Teisuu2
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
this.OuTouPrintUp1(1, SunPouMojiSize1, HH1, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2)) // 杭長の印字
MeterAtari1 = Teisuu4 / (Maxjiban * 1000)
MeterAtari2 = Teisuu5 / MaxBane
ZFX1 = OutouStartX1 + MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 + MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenStyle = psSolid
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
this.PlotLine1(CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), 2)
if ( JibanValue(KuiMax) > 0 ) {
    EndSuihei = 1
    ZFX1 = OutouStartX1 + MeterAtari1 * 0 * 1000 * JibanYoko
    ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
    ZFX2 = OutouStartX1 + MeterAtari1 * 0 * 1000 * JibanYoko + SyitaX
    ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai + SyitaY
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = OutouStartX1 + MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko
    ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
    ZFX2 = OutouStartX1 + MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko + SyitaX
    ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai + SyitaY
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = OutouStartX1 + SyitaX1
    ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai + SyitaY1
    ZFX2 = OutouStartX1 + MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko + SyitaX1
    ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai + SyitaY1
    this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
    this.OuTouPrintUp1_Y5(1, SunPouMojiSize1, JibanValue(KuiMax), CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2)) // 杭長の印字
}
//
StartXXX1 = MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko
For( i = 1 To KuiMax
    Select Case i
    Case 1
        LLL = PickAAA_G(KuiNN, i)
        Value1 = PickOutouG(KuiNN, i)
        Value3 = Value1
        AZFX2 = OutouStartX1 + StartXXX1
        AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        ZFX2 = OutouStartX1 + (Value3 * HiRiTsu * 1000) * MeterAtari1 * JibanYoko
        ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        ZFX1 = ZFX2
        ZFY1 = ZFY2
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE1(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE1(i) > 1 ) {
                if ( OutouCase3 = 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE1(i)))
                } else {
                    frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case GibanHeniX2
        Case 2
            if ( LINETYPE1(i) = 1 || (LINETYPE1(i) != 2 $$ LINETYPE1(i + 1) = 1) ) {
                if ( OutouFlag1(i) != -9000000000# ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    MojiZFY1 = ZFY2 - SouatsuMojiHight * 18
                    frmPrint.vsPrt1.TextAngle = 0 * 10
                    frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                    this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                    MyCurrentX = Int(CSng(MojiZFX1))
                    MyCurrentY = Int(CSng(MojiZFY1))
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, TTT
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = TTT
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                }
            }
        Case 3      // 変位荷重数値印刷
            if ( OutouFlag1(i) != -9000000000# ) {
                MojiZFX1 = ZFX2 + SouatsuMojiHight
                MojiZFY1 = ZFY2 - SouatsuMojiHight * 18
                frmPrint.vsPrt1.TextAngle = 0 * 10
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case KuiMax
        LLL = PickAAA_G(KuiNN, i)
        Value1 = PickOutouG(KuiNN, i)
        Value3 = Value1
        AZFX2 = OutouStartX1 + StartXXX1
        AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        ZFX2 = OutouStartX1 + (Value3 * HiRiTsu * 1000) * MeterAtari1 * JibanYoko
        ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE1(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE1(i) > 1 ) {
                if ( OutouCase3 = 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE1(i)))
                } else {
                    frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case GibanHeniX2
        Case 2
            if ( LINETYPE1(i) = 1 ) {
                if ( OutouFlag1(i) != -9000000000# ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag1(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                    frmPrint.vsPrt1.TextAngle = 0 * 10
                    frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                    this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                    MyCurrentX = Int(CSng(MojiZFX1))
                    MyCurrentY = Int(CSng(MojiZFY1))
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, TTT
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = TTT
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                }
            }
        Case 3      // 変位荷重数値印刷
            if ( OutouFlag1(i) != -9000000000# ) {
                MojiZFX1 = ZFX2 + SouatsuMojiHight
                this.Outou_KakuSub3(OutouFlag1(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                frmPrint.vsPrt1.TextAngle = 0 * 10
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case } else {
        LLL = PickAAA_G(KuiNN, i)
        Value1 = PickOutouG(KuiNN, i)
        Value3 = Value1
        AZFX2 = OutouStartX1 + StartXXX1
        AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        ZFX2 = OutouStartX1 + (Value3 * HiRiTsu * 1000) * MeterAtari1 * JibanYoko
        ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE1(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE1(i) > 1 ) {
                if ( OutouCase3 = 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE1(i)))
                } else {
                    frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case GibanHeniX2
        Case 2
            if ( LINETYPE1(i) = 1 || (LINETYPE1(i) != 2 $$ LINETYPE1(i + 1) = 1) ) {
                if ( OutouFlag1(i) != -9000000000# ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag1(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                    frmPrint.vsPrt1.TextAngle = 0 * 10
                    frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                    this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                    MyCurrentX = Int(CSng(MojiZFX1))
                    MyCurrentY = Int(CSng(MojiZFY1))
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, TTT
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = TTT
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                }
            }
        Case 3      // 変位荷重数値印刷
            if ( OutouFlag1(i) != -9000000000# ) {
                MojiZFX1 = ZFX2 + SouatsuMojiHight
                this.Outou_KakuSub3(OutouFlag1(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                frmPrint.vsPrt1.TextAngle = 0 * 10
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    End Select
}
//
For( i = 1 To 100
    FaFaXxx(i) = -9000000000#
    FaFaYyy(i) = -9000000000#
    FaFaLineType(i) = -9000000000#
}
//
Select Case Int(SuiheiBaneX3)
Case 1
    X11 = 0
    Counter = 0
    For( i = 1 To KuiMax
        Select Case i
        Case 1
            LLL = PickAAA_G(KuiNN, i)
            Value1 = PickBaneG(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            X11 = 1
            StartX11 = ZFX2
            StartY11 = ZFY2
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            if ( LINETYPE2(i) > 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE1(i) > 1 ) {
                    if ( OutouCase4 = 1 ) {
                        this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE2(i)))
                    } else {
                        DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                        }
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                        }
                    }
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
            Counter = Counter + 1
            FaFaXxx(Counter) = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            FaFaLineType(Counter) = 1
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
            }
            MaeValue = Value3
            ZFX1 = ZFX2
            ZFY1 = ZFY2
        Case KuiMax
            LLL = PickAAA_G(KuiNN, i)
            Value1 = PickBaneG(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            Counter = Counter + 1
            FaFaXxx(Counter) = OutouStartX2
            FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            FaFaLineType(Counter) = 2
            if ( LINETYPE2(i) > 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE1(i) > 1 ) {
                    if ( OutouCase4 = 1 ) {
                        this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE2(i)))
                    } else {
                        DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                        }
                    }
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
                if ( LINETYPE3(i) > 0 ) {
                    this.Outou_KakuSub6(Value3, OutouCase5, TTT)
                    if ( X11 = 1 ) {
                        if ( (ZFX2 - AZFX2) / 2 > CON_X2(SouatsuMojiHight * FFLen(TTT) / 2) / 2 ) {
                            MojiZFX1 = AZFX2 + (ZFX2 - AZFX2) / 2 - CON_X2(SouatsuMojiHight * FFLen(TTT) / 2) / 2
                        } else {
                            MojiZFX1 = ZFX2 + SouatsuMojiHight
                        }
                        MojiZFY1 = StartY11 + (ZFY2 - StartY11) / 2 - CON_Y(SouatsuMojiHight) / 2
                        frmPrint.vsPrt1.TextAngle = 0
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub5(Value3, OutouCase5, TTT)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                        X11 = 0
                    } else {
                        if ( X11 = 0 ) {
                            X11 = 1
                            StartX11 = ZFX2
                            StartY11 = ZFY2
                        }
                    }
                }
            }
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            MaeValue = Value3
        Case } else {
            LLL = PickAAA_G(KuiNN, i)
            Value1 = PickBaneG(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            if ( FDFDFD(i) >= 0 ) {
                Counter = Counter + 1
                FaFaXxx(Counter) = OutouStartX2 + BaneBairitsuHosei((FDFDFD(i) * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
                FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
                FaFaLineType(Counter) = 2
            }
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
                if ( LINETYPE3(i) > 0 ) {
                    this.Outou_KakuSub6(Value3, OutouCase5, TTT)
                    if ( X11 = 1 ) {
                        if ( (ZFX2 - AZFX2) / 2 > CON_X2(SouatsuMojiHight * FFLen(TTT) / 2) / 2 ) {
                            MojiZFX1 = AZFX2 + (ZFX2 - AZFX2) / 2 - CON_X2(SouatsuMojiHight * FFLen(TTT) / 2) / 2
                        } else {
                            MojiZFX1 = ZFX2 + SouatsuMojiHight
                        }
                        MojiZFY1 = StartY11 + (ZFY2 - StartY11) / 2 - CON_Y(SouatsuMojiHight) / 2
                        frmPrint.vsPrt1.TextAngle = 0
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub5(Value3, OutouCase5, TTT)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                        X11 = 0
                    } else {
                        if ( X11 = 0 ) {
                            X11 = 1
                            StartX11 = ZFX2
                            StartY11 = ZFY2
                        }
                    }
                }
            }
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            MaeValue = Value3
        End Select
    }
Case 2
    Counter = 0
    For( i = 1 To KuiMax
        Select Case i
        Case 1
            LLL = PickAAA_G(KuiNN, i)
            Value1 = PickBaneG(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            if ( LINETYPE2(i) > 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE1(i) > 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE2(i)))
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
            Counter = Counter + 1
            FaFaXxx(Counter) = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            FaFaLineType(Counter) = 1
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
                if ( LINETYPE2(i) = 1 || (LINETYPE2(i) != 2 $$ LINETYPE2(i + 1) = 1) ) {
                    if ( OutouFlag2(i) != -9000000000# ) {
                        MojiZFX1 = ZFX2 + SouatsuMojiHight
                        this.Outou_KakuSub3(OutouFlag2(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                        frmPrint.vsPrt1.TextAngle = 0 * 10
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub5(Value3, OutouCase5, TTT)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                    }
                }
            }
            MaeValue = Value3
            ZFX1 = ZFX2
            ZFY1 = ZFY2
        Case KuiMax
            LLL = PickAAA_G(KuiNN, i)
            Value1 = PickBaneG(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            Counter = Counter + 1
            FaFaXxx(Counter) = OutouStartX2
            FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            FaFaLineType(Counter) = 2
            if ( LINETYPE2(i) > 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
                if ( LINETYPE1(i) > 1 ) {
                    if ( OutouCase4 = 1 ) {
                        this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE2(i)))
                    } else {
                        DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                        }
                    }
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
                if ( LINETYPE2(i) = 1 ) {
                    if ( OutouFlag2(i) != -9000000000# ) {
                        MojiZFX1 = ZFX2 + SouatsuMojiHight
                        this.Outou_KakuSub3(OutouFlag2(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                        frmPrint.vsPrt1.TextAngle = 0 * 10
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub5(Value3, OutouCase5, TTT)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                    }
                }
            }
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            MaeValue = Value3
        Case } else {
            LLL = PickAAA_G(KuiNN, i)
            Value1 = PickBaneG(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            if ( FDFDFD(i) >= 0 ) {
                Counter = Counter + 1
                FaFaXxx(Counter) = OutouStartX2 + BaneBairitsuHosei((FDFDFD(i) * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
                FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
                FaFaLineType(Counter) = 2
            }
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
                if ( LINETYPE2(i) = 1 || (LINETYPE2(i) != 2 $$ LINETYPE2(i + 1) = 1) ) {
                    if ( OutouFlag2(i) != -9000000000# ) {
                        MojiZFX1 = ZFX2 + SouatsuMojiHight
                        this.Outou_KakuSub3(OutouFlag2(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                        frmPrint.vsPrt1.TextAngle = 0
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub5(Value3, OutouCase5, TTT)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                    }
                }
            }
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            MaeValue = Value3
        End Select
    }
End Select
if ( Counter > 0 ) {
    For( i = 1 To Counter
        ZFX1 = OutouStartX1
        ZFY1 = FaFaYyy(i)
        ZFX2 = OutouStartX1 + StartXXX1
        ZFY2 = FaFaYyy(i)
        frmPrint.vsPrt1.PenStyle = psSolid
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( FaFaLineType(i) > 1 ) {
            if ( OutouCase4 = 1 ) {
                this.PlotLine1(CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), CInt(FaFaLineType(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
            }
        } else {
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
        }
        ZFX1 = FaFaXxx(i)
        ZFY1 = FaFaYyy(i)
        ZFX2 = OutouStartX2
        ZFY2 = FaFaYyy(i)
        frmPrint.vsPrt1.PenStyle = psSolid
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( FaFaLineType(i) > 1 ) {
            if ( OutouCase4 = 1 ) {
                this.PlotLine1(CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), CInt(FaFaLineType(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
            }
        } else {
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
        }
    }
}
//
}

private Function BaneBairitsuHosei(k As Double, PMax As Double)
//
if ( k = 0 ) { ////////////////////////////////////////////////// 04/05/11 nagase
    BaneBairitsuHosei = 1
} else {
    BaneBairitsuHosei = k * (PMax / k) ^ 0.5
}
//
}

private void Out_OuTouHeniZu_G2_JibanHeni_SuiHeiBane(N As Double, CA As Double, OU)
// For( Gouiki（杭の応答変位図で・地震変位量・水平バネつき）
//
double var EndSuihei
double var StartX11
double var StartY11
double var X11
double var JibanMojiEnd()
double var MaeValue
double var FaFaXxx(100)
double var FaFaYyy(100)
double var FaFaLineType(100)
double var Counter
double var StartXXX1
double var YYYYY1
double var YYYYY2
double var YYYYY3
double var UpXXX
double var DownXXX
double var UpXXXTyakuMokuTen
double var DownXXXTyakuMokuTen
var FFF1                    As Single
double var FFF2
double var FFF3
double var FFF4
double var LLL
double var KuiNN
double var KuiMax
double var i
double var X1
double var y1
double var X2
double var Y2
double var HiRiTsu
double var HiRiTsu1
var ZFX1                    As Single
var ZFY1                    As Single
var MojiZFX1                As Single
var MojiZFY1                As Single
var ZFX2                    As Single
var ZFY2                    As Single
var AZFX2                   As Single
var AZFY2                   As Single
double var GGG
double var Value1
double var Value2
double var Value3
double var OutouValue()
double var OutouAAA()
double var OutouFlag()
double var OutouFlag1()
double var OutouFlag2()
var TTT                     As Variant
var TTT2                    As Variant
double var OuTouN
var LINETYPE()              As Integer
var LINETYPE2()             As Integer
var LINETYPE3()             As Integer
double var HHH
var HH1                     As Single
var TEMP1                   As Single
double var j
double var HHHZ1()
var HHHZ2()                 As Single
double var SouMax
double var MeterAtari
double var MeterAtari1
double var MeterAtari2
double var AAAA()
double var BBBB
double var CCCC()
double var Endp
double var Maxjiban
double var MaxBane
var JibanValue()            As Single
double var BaneValue()
double var FDFDFD()
double var Add1
var SuujiP()                As Single
var Bane2()                 As Single
double var PMax
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
var QWX1                    As Single
var QWY1                    As Single
//
PMax = 0
EndSuihei = 0
Add1 = 5
OuTouN = OU
HiRiTsu = 1
HiRiTsu1 = 10
LLL = 0
//    KuiLengthMax * KuiMaxLen ////KuiMaxLen = 200
if ( InStr(Trim(部材名(N)), "杭") > 0 ) {
    if ( Len(Trim(部材名(N))) = 1 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 2, Len(Trim(部材名(N))) - 1))
    }
}
if ( InStr(Trim(部材名(N)), "側壁") > 0 ) {
    if ( Len(Trim(部材名(N))) = 2 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 3, Len(Trim(部材名(N))) - 1))
    }
}
Endp = PickOutouG(KuiNN, KuiMax)
KuiMax = G_KuiDD(KuiNN)
this.FDFDFD(KuiMax)
this.LINETYPE(KuiMax)
this.LINETYPE1(KuiMax)
this.LINETYPE2(KuiMax)
this.LINETYPE3(KuiMax)
this.OutouValue(KuiMax)
this.OutouFlag(KuiMax)
this.OutouFlag1(KuiMax)
this.OutouFlag2(KuiMax)
this.OutouAAA(KuiMax)
this.HHHZ1(KuiMax)
this.HHHZ2(KuiMax)
GGG = BuzaiH(N)
this.AAAA(KuiMax)
this.CCCC(KuiMax)
this.JibanValue(KuiMax)
this.BaneValue(KuiMax)
this.JibanMojiEnd(KuiMax)
this.Bane2(KuiMax)
this.SuujiP(KuiMax)
MaxBane = 0
Maxjiban = 0
MaxKuiOuTouLen = 0
For( i = 1 To KuiMax
    Select Case i
    Case 1
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value1 = Value1 * Value2
    Case KuiMax
        Value1 = 0 //PickOutouG(KuiNN, I)
        Value2 = 0 //PickBaneG(KuiNN, I, CA)
        Value1 = Value1 * Value2
    Case } else {
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value1 = Value1 * Value2
    End Select
    MaxKuiOuTouLen = SMAX(MaxKuiOuTouLen, Value1)
    JibanValue(i) = PickOutouG(KuiNN, i)
    BaneValue(i) = PickBaneG(KuiNN, i, CA)
    PMax = SMAX(PMax, BaneValue(i))
    Maxjiban = SMAX(Maxjiban, JibanValue(i))
    MaxBane = SMAX(MaxBane, BaneValue(i))
    LINETYPE(i) = 0
    LINETYPE1(i) = 0
    LINETYPE2(i) = 0
    LINETYPE3(i) = 0
    SuujiP(i) = 0
    Bane2(i) = Value2
    FDFDFD(i) = -9000000000#
    OutouAAA(i) = PickAAA_G(KuiNN, i)
    if ( i > 1 ) {
        if ( BBBB = RoundS(OutouAAA(i), 3) ) {
            AAAA(i - 1) = 1
        }
    }
    JibanMojiEnd(i) = -9000000000#
    OutouValue(i) = Value1
    OutouFlag(i) = -9000000000#
    OutouFlag1(i) = -9000000000#
    OutouFlag2(i) = -9000000000#
    HHHZ1(i) = -9000000000#
    HHHZ2(i) = -9000000000#
    if ( i > 1 ) {
        CCCC(i) = RoundS(OutouAAA(i), 3) - BBBB
    }
    BBBB = RoundS(PickAAA_G(KuiNN, i), 3)
}
AAAA(KuiMax) = 1
j = 0
For( i = 1 To KuiMax
    Select Case i
    Case 1
        OutouFlag(i) = -1
        LINETYPE(i) = 1
        OutouFlag1(i) = -1
        LINETYPE1(i) = 1
        OutouFlag2(i) = -1
        LINETYPE2(i) = 1
        LINETYPE3(i) = 1
    Case KuiMax
        OutouFlag(i) = 1
        LINETYPE(i) = 1
        OutouFlag1(i) = 1
        LINETYPE1(i) = 1
        OutouFlag2(i) = 1
        LINETYPE2(i) = 1
        LINETYPE3(i) = 1
        j = j + 1
        HHHZ1(j) = OutouAAA(i)
        if ( j > 1 ) {
            HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
        } else {
            HHHZ2(j) = OutouAAA(i)
        }
    Case } else {
        if ( RoundS(OutouAAA(i), 3) = RoundS(OutouAAA(i - 1), 3) ) {
            if ( RoundS(OutouValue(i), 3) = RoundS(OutouValue(i - 1), 3) ) {
                OutouFlag(i - 1) = -9000000000#
                OutouFlag(i) = 0
                LINETYPE(i - 1) = 0
                LINETYPE(i) = 1
            } else {
                OutouFlag(i - 1) = 1
                OutouFlag(i) = -1
                LINETYPE(i - 1) = 0
                LINETYPE(i) = 1
            }
            if ( RoundS(JibanValue(i), 3) = RoundS(JibanValue(i - 1), 3) ) {
                OutouFlag1(i - 1) = -9000000000#
                OutouFlag1(i) = 0
                LINETYPE1(i - 1) = 0
                LINETYPE1(i) = 1
            } else {
                OutouFlag1(i - 1) = 1
                OutouFlag1(i) = -1
                LINETYPE1(i - 1) = 0
                LINETYPE1(i) = 1
            }
            if ( RoundS(BaneValue(i), 3) = RoundS(BaneValue(i - 1), 3) ) {
                OutouFlag2(i - 1) = -9000000000#
                OutouFlag2(i) = 0
                LINETYPE2(i - 1) = 0
                LINETYPE2(i) = 1
            } else {
                OutouFlag2(i - 1) = 1
                OutouFlag2(i) = -1
                LINETYPE2(i - 1) = 0
                LINETYPE2(i) = 1
            }
            if ( RoundS(BaneValue(i), 3) != RoundS(BaneValue(i - 1), 3) ) {
                FDFDFD(i) = BaneValue(i - 1)
                FDFDFD(i - 1) = -9000000000#
                LINETYPE3(i) = 1
                LINETYPE3(i - 1) = 1
            } else {
                if ( SuiheiBaneEqual = 2 ) {
                    FDFDFD(i) = BaneValue(i)
                    FDFDFD(i - 1) = -9000000000#
                    LINETYPE3(i) = 1
                    LINETYPE3(i - 1) = 1
                }
            }
            if ( SouatrsuValuePrintA = 1 ) {
                if ( Int(Bane2(i)) = Int(Bane2(i - 1)) ) {
                    SuujiP(i) = 1
                    SuujiP(i - 1) = 1
                }
            }
            if ( Int(Bane2(i)) = Int(Bane2(i - 1)) ) {
            } else {
                j = j + 1
                HHHZ1(j) = OutouAAA(i)
                if ( j > 1 ) {
                    HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
                } else {
                    HHHZ2(j) = OutouAAA(i)
                }
            }
        } else {
            OutouFlag(i) = 0
            LINETYPE(i) = 2
            OutouFlag1(i) = 0
            LINETYPE1(i) = 2
        }
    End Select
}
if ( j = 0 ) { return; ////////////////////////////////////////////////04/11/11
SouMax = j
HH1 = PickAAA_G(KuiNN, KuiMax)
HHH = HH1 / KuiLengthMax
TEMP1 = frmPrint.vsPrt1.PenWidth
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
this.DrawLineZZ(0, 0, 0, KuiMaxLen * HHH * OuTouBai)
MeterAtari = KuiMaxLen * HHH * OuTouBai / HH1
frmPrint.vsPrt1.PenWidth = TEMP1
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
Endp = PickOutouG(KuiNN, KuiMax)

frmPrint.vsPrt1.TextAngle = 0 * 10
frmPrint.vsPrt1.FontSize = GraphTitleMojiSize // * 1.25 //////////////// nagase

// グラフの上に応答変位荷重を印字
if ( fMainForm.SICheck = True ) { //SI単位チェック
    TTT = "応答変位荷重 (kN/m)"
} else {
    TTT = "応答変位荷重 (tf/m)"
}
MojiZFX1 = OutouStartX
MojiZFY1 = OutouStartY - CON_Y(frmPrint.vsPrt1.FontSize) * 2.5
MyCurrentX = Int(CSng(MojiZFX1))
MyCurrentY = Int(CSng(MojiZFY1))
QWX1 = MyCurrentX
QWY1 = MyCurrentY
PrintoutPrt frmPrint.vsPrt1, TTT
if ( CreateDxfFlag = 1 ) {
    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
    ParamXPoint = QWX1
    ParamYpoint = QWY1
    ParamText = TTT
    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
}
// グラフの上に地盤変位量を印字
TTT = "応答変位量 (m)"
MojiZFX1 = OutouStartX1 + CON_X(frmPrint.vsPrt1.FontSize)
MojiZFY1 = OutouStartY - CON_Y(frmPrint.vsPrt1.FontSize) * 2.5
MyCurrentX = Int(CSng(MojiZFX1))
MyCurrentY = Int(CSng(MojiZFY1))
QWX1 = MyCurrentX
QWY1 = MyCurrentY
PrintoutPrt frmPrint.vsPrt1, TTT
if ( CreateDxfFlag = 1 ) {
    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
    ParamXPoint = QWX1
    ParamYpoint = QWY1
    ParamText = TTT
    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
}
// グラフの上に水平バネ係数を印字
if ( fMainForm.SICheck = True ) { //SI単位チェック
    TTT = "水平バネ定数 (kN/m2)"
} else {
    TTT = "水平バネ定数 (tf/m2)"
}
MojiZFX1 = OutouStartX2 - CON_X(frmPrint.vsPrt1.FontSize * 2)
MojiZFY1 = OutouStartY - CON_Y(frmPrint.vsPrt1.FontSize) * 2.5
MyCurrentX = Int(CSng(MojiZFX1))
MyCurrentY = Int(CSng(MojiZFY1))
QWX1 = MyCurrentX
QWY1 = MyCurrentY
PrintoutPrt frmPrint.vsPrt1, TTT
if ( CreateDxfFlag = 1 ) {
    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
    ParamXPoint = QWX1
    ParamYpoint = QWY1
    ParamText = TTT
    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
}
//
frmPrint.vsPrt1.FontSize = GraphTitleMojiSize
For( i = 1 To KuiMax
    Select Case i
    Case 1
        LLL = PickAAA_G(KuiNN, i)
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
        AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
        if ( GGG = 1 $$ MaxKuiOuTouLen != 0 ) {
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N)) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxKuiOuTou
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
        } else {
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N)) + Value3 * HiRiTsu1
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2 + Add1
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( LINETYPE(i) > 1 ) {
                if ( OutouCase2 = 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                } else {
                    frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1, 2     // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    MojiZFY1 = ZFY2 - SouatsuMojiHight * 18
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                if ( GGG = 1 ) {
                    frmPrint.vsPrt1.TextAngle = 0 * 10
                } else {
                    frmPrint.vsPrt1.TextAngle = 90 * 10
                }
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case KuiMax
        LLL = PickAAA_G(KuiNN, i)
        Value1 = 0 //PickOutouG(KuiNN, I)
        Value2 = 0 //PickBaneG(KuiNN, I, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N))
        AZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N))
        if ( GGG = 1 $$ MaxKuiOuTouLen != 0 ) {
            ZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N)) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxKuiOuTou
            ZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N) - LLL)
        } else {
            ZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N))
            ZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N) - LLL) + Value3 * HiRiTsu1
        }
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                if ( OutouCase2 = 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                } else {
                    frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1, 2     // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case } else {
        LLL = PickAAA_G(KuiNN, i)
        Value1 = SMAX(PickOutouG(KuiNN, i) - PickOutouG(KuiNN, KuiMax), 0)
        Value2 = PickBaneG(KuiNN, i, CA)
        Value3 = Value1 * Value2
        if ( GGG = 1 $$ MaxKuiOuTouLen != 0 ) {
            AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
            AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N) - LLL)
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N)) + (Value3 * HiRiTsu) / MaxKuiOuTouLen * MaxKuiOuTou
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N) - LLL)
        } else {
            AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N) + LLL)
            AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N) + LLL)
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N)) + Value3 * HiRiTsu1
        }
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                if ( OutouCase2 = 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                } else {
                    frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1
            if ( LINETYPE(i) = 1 || (LINETYPE(i) != 2 $$ LINETYPE(i + 1) = 1) ) {
                if ( OutouFlag(i) != -9000000000# ) {
                    if ( SuujiP(i) = 0 ) {
                        if ( GGG = 1 ) {
                            MojiZFX1 = ZFX2 + SouatsuMojiHight
                            this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                        } else {
                            MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                            this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                        }
                        this.Outou_KakuSub4(GGG)
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        if ( GGG = 1 ) {
                            this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                        } else {
                            TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                            MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                        }
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                    }
                }
            }
        Case 2      // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    End Select
}
//
if ( SunPouSenX1 = 1 ) {     // 寸法線を書かない場合はここで終了。
} else {
    ZFX1 = OutouStartX
    ZFY1 = OutouStartY
    ZFX2 = OutouStartX + SunPouStartX1
    ZFY2 = OutouStartY
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = OutouStartX
    ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
    ZFX2 = OutouStartX + SunPouStartX1
    ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = OutouStartX + SunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
    ZFY1 = OutouStartY
    ZFX2 = OutouStartX + SunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
    ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
    this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
    this.OuTouPrintUp1(1, SunPouMojiSize1, HH1, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2)) // 杭長の印字
    UpXXX = -9000000000#
    DownXXX = -9000000000#
    YYYYY1 = 0
    YYYYY2 = 0
    For( i = 1 To SouMax
        YYYYY1 = YYYYY1 + HHHZ2(i) * MeterAtari
        frmPrint.vsPrt1.PenWidth = SunPouPenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        ZFX1 = OutouStartX
        ZFY1 = OutouStartY + YYYYY1
        ZFX2 = OutouStartX + SunPouStartX2
        ZFY2 = OutouStartY + YYYYY1
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        ZFX1 = OutouStartX + SunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
        ZFY1 = OutouStartY + YYYYY2
        ZFX2 = OutouStartX + SunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
        ZFY2 = OutouStartY + YYYYY1
        this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
        this.OuTouPrintUp2(SunPouMojiSize2, HHHZ2(i), CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXX, DownXXX) // 杭長の印字
        YYYYY2 = YYYYY1
    }
    //
    if ( SunPouSenX2 = 1 ) {     // 着目点単位の寸法線を書かない場合はここで終了。
    } else {
        YYYYY1 = 0
        YYYYY2 = 0
        YYYYY3 = 0
        FFF1 = 0
        FFF2 = 0
        FFF3 = 0
        FFF4 = 0
        UpXXXTyakuMokuTen = -9000000000#
        DownXXXTyakuMokuTen = -9000000000#
        For( i = 2 To KuiMax
            FFF3 = PickAAA_G(KuiNN, i)
            if ( AAAA(i) = 1 ) {
                if ( FFF1 = 0 ) {
                    if ( i = 2 ) {
                        FFF1 = FFF3
                    } else {
                        FFF1 = FFF3 - PickAAA_G(KuiNN, i - 1)
                    }
                    FFF2 = 1
                    YYYYY1 = FFF3 * MeterAtari
                    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    ZFX1 = OutouStartX
                    ZFY1 = OutouStartY + YYYYY1
                    ZFX2 = OutouStartX + SunPouStartX3
                    ZFY2 = OutouStartY + YYYYY1
                    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                    }
                    ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                    ZFY1 = OutouStartY + YYYYY2
                    ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                    ZFY2 = OutouStartY + YYYYY1
                    this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                    this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                    YYYYY2 = YYYYY1
                    FFF1 = 0
                    FFF2 = 0
                    FFF4 = FFF3
                } else {
                    if ( RoundS(FFF1, 3) = RoundS(CCCC(i), 3) ) {
                        FFF2 = FFF2 + 1
                        YYYYY1 = FFF3 * MeterAtari
                        frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                        if ( CreateDxfFlag = 1 ) {
                            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                        }
                        ZFX1 = OutouStartX
                        ZFY1 = OutouStartY + YYYYY1
                        ZFX2 = OutouStartX + SunPouStartX3
                        ZFY2 = OutouStartY + YYYYY1
                        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                        }
                        ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY1 = OutouStartY + YYYYY2
                        ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY2 = OutouStartY + YYYYY1
                        this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                        this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                        YYYYY2 = YYYYY1
                        FFF1 = 0
                        FFF2 = 0
                        FFF4 = FFF3
                    } else {
                        YYYYY1 = FFF4 * MeterAtari
                        frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                        if ( CreateDxfFlag = 1 ) {
                            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                        }
                        ZFX1 = OutouStartX
                        ZFY1 = OutouStartY + YYYYY1
                        ZFX2 = OutouStartX + SunPouStartX3
                        ZFY2 = OutouStartY + YYYYY1
                        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                        }
                        ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY1 = OutouStartY + YYYYY2
                        ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY2 = OutouStartY + YYYYY1
                        this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                        this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                        YYYYY2 = YYYYY1
                        FFF1 = FFF3 - FFF4
                        FFF2 = 1
                        YYYYY1 = FFF3 * MeterAtari
                        frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                        if ( CreateDxfFlag = 1 ) {
                            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                        }
                        ZFX1 = OutouStartX
                        ZFY1 = OutouStartY + YYYYY1
                        ZFX2 = OutouStartX + SunPouStartX3
                        ZFY2 = OutouStartY + YYYYY1
                        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                        }
                        ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY1 = OutouStartY + YYYYY2
                        ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY2 = OutouStartY + YYYYY1
                        this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                        this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                        YYYYY2 = YYYYY1
                        FFF1 = 0
                        FFF2 = 0
                        FFF4 = FFF3
                    }
                }
            } else {
                if ( i = 2 ) {
                    FFF1 = CCCC(i)
                    FFF2 = 1
                } else {
                    if ( CCCC(i) = 0 ) {
                        FFF1 = 0
                        FFF2 = 0
                    } else {
                        if ( FFF1 = 0 ) {
                            FFF1 = CCCC(i)
                            FFF2 = 1
                        } else {
                            if ( RoundS(FFF1, 3) = RoundS(CCCC(i), 3) ) {
                                FFF2 = FFF2 + 1
                            } else {
                                YYYYY1 = FFF4 * MeterAtari
                                frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                                if ( CreateDxfFlag = 1 ) {
                                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                                }
                                ZFX1 = OutouStartX
                                ZFY1 = OutouStartY + YYYYY1
                                ZFX2 = OutouStartX + SunPouStartX3
                                ZFY2 = OutouStartY + YYYYY1
                                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                                if ( CreateDxfFlag = 1 ) {
                                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                                }
                                ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                                ZFY1 = OutouStartY + YYYYY2
                                ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                                ZFY2 = OutouStartY + YYYYY1
                                this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                                this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                                YYYYY2 = YYYYY1
                                FFF1 = FFF3 - FFF4
                                FFF2 = 1
                                FFF4 = FFF3
                            }
                        }
                    }
                }
            }
            FFF4 = FFF3
        }
    }
}
//
if ( GibanHeniX1 = 1 ) {     // 応答変位量の印字のみ
    return;
}
//
ZFX1 = OutouStartX1
ZFY1 = OutouStartY
ZFX2 = OutouStartX1
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1 - KuiAtsu
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 - KuiAtsu
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 - KuiAtsu
ZFY2 = OutouStartY
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1 - KuiAtsu
ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
ZFX2 = OutouStartX1
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX2
ZFY1 = OutouStartY
ZFX2 = OutouStartX2
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = SunPouPenWidth + 5 + 5
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 + Teisuu1
ZFY2 = OutouStartY
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 + Teisuu3
ZFY2 = OutouStartY
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1
ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
ZFX2 = OutouStartX1 + Teisuu3
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1 + Teisuu2
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 + Teisuu2
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
this.OuTouPrintUp1(1, SunPouMojiSize1, HH1, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2)) // 杭長の印字
if ( Maxjiban != 0 ) { MeterAtari1 = Teisuu4 / (Maxjiban * 1000)
MeterAtari2 = 0.1
if ( MaxBane != 0 ) { MeterAtari2 = Teisuu5 / MaxBane
ZFX1 = OutouStartX1 + MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 + MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenStyle = psSolid
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
this.PlotLine1(CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), 2)
if ( JibanValue(KuiMax) > 0 ) {
    EndSuihei = 1
    ZFX1 = OutouStartX1 + MeterAtari1 * 0 * 1000 * JibanYoko
    ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
    ZFX2 = OutouStartX1 + MeterAtari1 * 0 * 1000 * JibanYoko + SyitaX
    ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai + SyitaY
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = OutouStartX1 + MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko
    ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
    ZFX2 = OutouStartX1 + MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko + SyitaX
    ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai + SyitaY
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = OutouStartX1 + SyitaX1
    ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai + SyitaY1
    ZFX2 = OutouStartX1 + MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko + SyitaX1
    ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai + SyitaY1
    this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
    this.OuTouPrintUp1_Y5(1, SunPouMojiSize1, JibanValue(KuiMax), CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2)) // 杭長の印字
}
//
StartXXX1 = MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko
For( i = 1 To KuiMax
    Select Case i
    Case 1
        LLL = PickAAA_G(KuiNN, i)
        Value1 = PickOutouG(KuiNN, i)
        Value3 = Value1
        AZFX2 = OutouStartX1 + StartXXX1
        AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        ZFX2 = OutouStartX1 + (Value3 * HiRiTsu * 1000) * MeterAtari1 * JibanYoko
        ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        ZFX1 = ZFX2
        ZFY1 = ZFY2
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE1(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE1(i) > 1 ) {
                if ( OutouCase3 = 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE1(i)))
                } else {
                    frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case GibanHeniX2
        Case 2
            if ( LINETYPE1(i) = 1 || (LINETYPE1(i) != 2 $$ LINETYPE1(i + 1) = 1) ) {
                if ( OutouFlag1(i) != -9000000000# ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    MojiZFY1 = ZFY2 - SouatsuMojiHight * 18
                    frmPrint.vsPrt1.TextAngle = 0 * 10
                    frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                    this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                    MyCurrentX = Int(CSng(MojiZFX1))
                    MyCurrentY = Int(CSng(MojiZFY1))
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, TTT
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = TTT
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                }
            }
        Case 3      // 変位荷重数値印刷
            if ( OutouFlag1(i) != -9000000000# ) {
                MojiZFX1 = ZFX2 + SouatsuMojiHight
                MojiZFY1 = ZFY2 - SouatsuMojiHight * 18
                frmPrint.vsPrt1.TextAngle = 0 * 10
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case KuiMax
        LLL = PickAAA_G(KuiNN, i)
        Value1 = PickOutouG(KuiNN, i)
        Value3 = Value1
        AZFX2 = OutouStartX1 + StartXXX1
        AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        ZFX2 = OutouStartX1 + (Value3 * HiRiTsu * 1000) * MeterAtari1 * JibanYoko
        ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE1(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE1(i) > 1 ) {
                if ( OutouCase3 = 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE1(i)))
                } else {
                    frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case GibanHeniX2
        Case 2
            if ( LINETYPE1(i) = 1 ) {
                if ( OutouFlag1(i) != -9000000000# ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag1(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                    frmPrint.vsPrt1.TextAngle = 0 * 10
                    frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                    this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                    MyCurrentX = Int(CSng(MojiZFX1))
                    MyCurrentY = Int(CSng(MojiZFY1))
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, TTT
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = TTT
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                }
            }
        Case 3      // 変位荷重数値印刷
            if ( OutouFlag1(i) != -9000000000# ) {
                MojiZFX1 = ZFX2 + SouatsuMojiHight
                this.Outou_KakuSub3(OutouFlag1(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                frmPrint.vsPrt1.TextAngle = 0 * 10
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case } else {
        LLL = PickAAA_G(KuiNN, i)
        Value1 = PickOutouG(KuiNN, i)
        Value3 = Value1
        AZFX2 = OutouStartX1 + StartXXX1
        AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        ZFX2 = OutouStartX1 + (Value3 * HiRiTsu * 1000) * MeterAtari1 * JibanYoko
        ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE1(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE1(i) > 1 ) {
                if ( OutouCase3 = 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE1(i)))
                } else {
                    frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case GibanHeniX2
        Case 2
            if ( LINETYPE1(i) = 1 || (LINETYPE1(i) != 2 $$ LINETYPE1(i + 1) = 1) ) {
                if ( OutouFlag1(i) != -9000000000# ) {
                    if ( SuujiP(i) = 0 ) {
                        MojiZFX1 = ZFX2 + SouatsuMojiHight
                        this.Outou_KakuSub3(OutouFlag1(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                        frmPrint.vsPrt1.TextAngle = 0 * 10
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                    }
                }
            }
        Case 3      // 変位荷重数値印刷
            if ( OutouFlag1(i) != -9000000000# ) {
                MojiZFX1 = ZFX2 + SouatsuMojiHight
                this.Outou_KakuSub3(OutouFlag1(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                frmPrint.vsPrt1.TextAngle = 0 * 10
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    End Select
}
//
For( i = 1 To 100
    FaFaXxx(i) = -9000000000#
    FaFaYyy(i) = -9000000000#
    FaFaLineType(i) = -9000000000#
}
//
Select Case Int(SuiheiBaneX3)
Case 1
    X11 = 0
    Counter = 0
    For( i = 1 To KuiMax
        Select Case i
        Case 1
            LLL = PickAAA_G(KuiNN, i)
            Value1 = PickBaneG(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            X11 = 1
            StartX11 = ZFX2
            StartY11 = ZFY2
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            if ( LINETYPE2(i) > 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE1(i) > 1 ) {
                    if ( OutouCase4 = 1 ) {
                        this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE2(i)))
                    } else {
                        DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                        }
                    }
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
            Counter = Counter + 1
            FaFaXxx(Counter) = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            FaFaLineType(Counter) = 1
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
            }
            MaeValue = Value3
            ZFX1 = ZFX2
            ZFY1 = ZFY2
        Case KuiMax
            LLL = PickAAA_G(KuiNN, i)
            Value1 = PickBaneG(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            Counter = Counter + 1
            FaFaXxx(Counter) = OutouStartX2
            FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            FaFaLineType(Counter) = 2
            if ( LINETYPE2(i) > 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE1(i) > 1 ) {
                    if ( OutouCase4 = 1 ) {
                        this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE2(i)))
                    } else {
                        DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                        }
                    }
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
                if ( LINETYPE3(i) > 0 ) {
                    this.Outou_KakuSub6(Value3, OutouCase5, TTT)
                    if ( X11 = 1 ) {
                        if ( (ZFX2 - AZFX2) / 2 > CON_X2(SouatsuMojiHight * FFLen(TTT) / 2) / 2 ) {
                            MojiZFX1 = AZFX2 + (ZFX2 - AZFX2) / 2 - CON_X2(SouatsuMojiHight * FFLen(TTT) / 2) / 2
                        } else {
                            MojiZFX1 = ZFX2 + SouatsuMojiHight
                        }
                        MojiZFY1 = StartY11 + (ZFY2 - StartY11) / 2 - CON_Y(SouatsuMojiHight) / 2
                        frmPrint.vsPrt1.TextAngle = 0
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub5(Value3, OutouCase5, TTT)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                        X11 = 0
                    } else {
                        if ( X11 = 0 ) {
                            X11 = 1
                            StartX11 = ZFX2
                            StartY11 = ZFY2
                        }
                    }
                }
            }
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            MaeValue = Value3
        Case } else {
            LLL = PickAAA_G(KuiNN, i)
            Value1 = PickBaneG(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            if ( FDFDFD(i) >= 0 ) {
                Counter = Counter + 1
                FaFaXxx(Counter) = OutouStartX2 + BaneBairitsuHosei((FDFDFD(i) * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
                FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
                FaFaLineType(Counter) = 2
            }
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
                if ( LINETYPE3(i) > 0 ) {
                    this.Outou_KakuSub6(Value3, OutouCase5, TTT)
                    if ( X11 = 1 ) {
                        if ( (ZFX2 - AZFX2) / 2 > CON_X2(SouatsuMojiHight * FFLen(TTT) / 2) / 2 ) {
                            MojiZFX1 = AZFX2 + (ZFX2 - AZFX2) / 2 - CON_X2(SouatsuMojiHight * FFLen(TTT) / 2) / 2
                        } else {
                            MojiZFX1 = ZFX2 + SouatsuMojiHight
                        }
                        MojiZFY1 = StartY11 + (ZFY2 - StartY11) / 2 - CON_Y(SouatsuMojiHight) / 2
                        frmPrint.vsPrt1.TextAngle = 0
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub5(Value3, OutouCase5, TTT)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                        X11 = 0
                    } else {
                        if ( X11 = 0 ) {
                            X11 = 1
                            StartX11 = ZFX2
                            StartY11 = ZFY2
                        }
                    }
                }
            }
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            MaeValue = Value3
        End Select
    }
Case 2
    Counter = 0
    For( i = 1 To KuiMax
        Select Case i
        Case 1
            LLL = PickAAA_G(KuiNN, i)
            Value1 = PickBaneG(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            if ( LINETYPE2(i) > 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE1(i) > 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE2(i)))
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
            Counter = Counter + 1
            FaFaXxx(Counter) = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            FaFaLineType(Counter) = 1
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
                if ( LINETYPE2(i) = 1 || (LINETYPE2(i) != 2 $$ LINETYPE2(i + 1) = 1) ) {
                    if ( OutouFlag2(i) != -9000000000# ) {
                        MojiZFX1 = ZFX2 + SouatsuMojiHight
                        this.Outou_KakuSub3(OutouFlag2(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                        frmPrint.vsPrt1.TextAngle = 0 * 10
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub5(Value3, OutouCase5, TTT)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                    }
                }
            }
            MaeValue = Value3
            ZFX1 = ZFX2
            ZFY1 = ZFY2
        Case KuiMax
            LLL = PickAAA_G(KuiNN, i)
            Value1 = PickBaneG(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            Counter = Counter + 1
            FaFaXxx(Counter) = OutouStartX2
            FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            FaFaLineType(Counter) = 2
            if ( LINETYPE2(i) > 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE1(i) > 1 ) {
                    if ( OutouCase4 = 1 ) {
                        this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE2(i)))
                    } else {
                        DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                        }
                    }
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
                if ( LINETYPE2(i) = 1 ) {
                    if ( OutouFlag2(i) != -9000000000# ) {
                        MojiZFX1 = ZFX2 + SouatsuMojiHight
                        this.Outou_KakuSub3(OutouFlag2(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                        frmPrint.vsPrt1.TextAngle = 0 * 10
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub5(Value3, OutouCase5, TTT)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                    }
                }
            }
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            MaeValue = Value3
        Case } else {
            LLL = PickAAA_G(KuiNN, i)
            Value1 = PickBaneG(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            if ( FDFDFD(i) >= 0 ) {
                Counter = Counter + 1
                FaFaXxx(Counter) = OutouStartX2 + BaneBairitsuHosei((FDFDFD(i) * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
                FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
                FaFaLineType(Counter) = 2
            }
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
                if ( LINETYPE2(i) = 1 || (LINETYPE2(i) != 2 $$ LINETYPE2(i + 1) = 1) ) {
                    if ( OutouFlag2(i) != -9000000000# ) {
                        MojiZFX1 = ZFX2 + SouatsuMojiHight
                        this.Outou_KakuSub3(OutouFlag2(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                        frmPrint.vsPrt1.TextAngle = 0
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub5(Value3, OutouCase5, TTT)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                    }
                }
            }
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            MaeValue = Value3
        End Select
    }
End Select
if ( Counter > 0 ) {
    For( i = 1 To Counter
        ZFX1 = OutouStartX1
        ZFY1 = FaFaYyy(i)
        ZFX2 = OutouStartX1 + StartXXX1
        ZFY2 = FaFaYyy(i)
        frmPrint.vsPrt1.PenStyle = psSolid
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        if ( FaFaLineType(i) > 1 ) {
            if ( OutouCase4 = 1 ) {
                this.PlotLine1(CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), CInt(FaFaLineType(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
            }
        } else {
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
        }
        ZFX1 = FaFaXxx(i)
        ZFY1 = FaFaYyy(i)
        ZFX2 = OutouStartX2
        ZFY2 = FaFaYyy(i)
        frmPrint.vsPrt1.PenStyle = psSolid
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        if ( FaFaLineType(i) > 1 ) {
            if ( OutouCase4 = 1 ) {
                this.PlotLine1(CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), CInt(FaFaLineType(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
            }
        } else {
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
        }
    }
}
//
}

private void Out_OuTouHeniZu_N2_JibanHeni_SuiHeiBane(N As Double, CA)
// Frame（杭の応答変位図で・地震変位量・水平バネつき）
//
double var EndSuihei
double var StartX11
double var StartY11
double var X11
double var JibanMojiEnd()
double var MaeValue
double var FaFaXxx(100)
double var FaFaYyy(100)
double var FaFaLineType(100)
double var Counter
double var StartXXX1
double var YYYYY1
double var YYYYY2
double var YYYYY3
double var UpXXX
double var DownXXX
double var UpXXXTyakuMokuTen
double var DownXXXTyakuMokuTen
var FFF1                    As Single
double var FFF2
double var FFF3
double var FFF4
var TEMP1                   As Single
double var LLL
double var KuiNN
double var KuiMax
double var i
double var X1
double var y1
double var X2
double var Y2
double var HiRiTsu
double var HiRiTsu1
var ZFX1                    As Single
var ZFY1                    As Single
var MojiZFX1                As Single
var MojiZFY1                As Single
var ZFX2                    As Single
var ZFY2                    As Single
var AZFX2                   As Single
var AZFY2                   As Single
double var GGG
double var Value1
double var Value2
double var Value3
double var OutouValue()
double var OutouAAA()
double var OutouFlag()
double var OutouFlag1()
double var OutouFlag2()
var TTT                     As Variant
var TTT2                    As Variant
var LINETYPE()              As Integer
var LINETYPE1()             As Integer
var LINETYPE2()             As Integer
var LINETYPE3()             As Integer
double var HHH
var HH1                     As Single
double var j
double var HHHZ1()
var HHHZ2()                 As Single
double var SouMax
double var MeterAtari
double var MeterAtari1
double var MeterAtari2
double var AAAA()
double var BBBB
double var CCCC()
double var Endp
double var Maxjiban
double var MaxBane
var JibanValue()            As Single
var Bane2()                 As Single
double var BaneValue()
double var FDFDFD()
double var Add1
double var PMax
var SuujiP()                As Single
var ParamAngle              As Single
var ParamFontSize           As Single
var ParamXPoint             As Single
var ParamYpoint             As Single
var ParamText
var QWX1                    As Single
var QWY1                    As Single
//
EndSuihei = 0
Add1 = 5
HiRiTsu = 1
HiRiTsu1 = 10
LLL = 0
if ( InStr(Trim(部材名(N)), "杭") > 0 ) {
    if ( Len(Trim(部材名(N))) = 1 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 2, Len(Trim(部材名(N))) - 1))
    }
}
if ( InStr(Trim(部材名(N)), "側壁") > 0 ) {
    if ( Len(Trim(部材名(N))) = 2 ) {
        KuiNN = 1
    } else {
        KuiNN = val(Mid(Trim(部材名(N)), 3, Len(Trim(部材名(N))) - 1))
    }
}
KuiMax = N_KuiDD(KuiNN)
this.FDFDFD(KuiMax)
this.LINETYPE(KuiMax)
this.LINETYPE1(KuiMax)
this.LINETYPE2(KuiMax)
this.LINETYPE3(KuiMax)
this.OutouValue(KuiMax)
this.OutouFlag(KuiMax)
this.OutouFlag1(KuiMax)
this.OutouFlag2(KuiMax)
this.OutouAAA(KuiMax)
this.HHHZ1(KuiMax)
this.HHHZ2(KuiMax)
GGG = BuzaiH(N)
this.AAAA(KuiMax)
this.CCCC(KuiMax)
this.JibanValue(KuiMax)
this.BaneValue(KuiMax)
this.JibanMojiEnd(KuiMax)
this.Bane2(KuiMax)
this.SuujiP(KuiMax)
MaxBane = 0
Maxjiban = 0
PMax = 0
BBBB = 0
Endp = PickOutouN(KuiNN, KuiMax, OuTouHHH)
MaxKuiOuTouLen = 0
For( i = 1 To KuiMax
    Select Case i
    Case 1
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value1 = Value1 * Value2
    Case KuiMax
        Value1 = 0 //PickOutouN(KuiNN, I, OuTouHHH)
        Value2 = 0 //PickBaneN(KuiNN, I, CA)
        Value1 = Value1 * Value2
    Case } else {
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value1 = Value1 * Value2
    End Select
    OutouAAA(i) = PickAAA_N(KuiNN, i)
    if ( i > 1 ) {
        if ( BBBB = RoundS(OutouAAA(i), 3) ) {
            AAAA(i - 1) = 1
        }
    }
    MaxKuiOuTouLen = SMAX(MaxKuiOuTouLen, Value1)
    JibanValue(i) = PickOutouN(KuiNN, i, OuTouHHH)
    BaneValue(i) = PickBaneN(KuiNN, i, CA)
    PMax = SMAX(PMax, BaneValue(i))
    Maxjiban = SMAX(Maxjiban, JibanValue(i))
    MaxBane = SMAX(MaxBane, BaneValue(i))
    LINETYPE(i) = 0
    LINETYPE3(i) = 0
    LINETYPE2(i) = 0
    LINETYPE1(i) = 0
    SuujiP(i) = 0
    Bane2(i) = Value2
    FDFDFD(i) = -9000000000#
    OutouValue(i) = Value1
    OutouFlag(i) = -9000000000#
    OutouFlag2(i) = -9000000000#
    OutouFlag1(i) = -9000000000#
    JibanMojiEnd(i) = -9000000000#
    HHHZ1(i) = -9000000000#
    HHHZ2(i) = -9000000000#
    if ( i > 1 ) {
        CCCC(i) = RoundS(OutouAAA(i), 3) - BBBB
    }
    BBBB = RoundS(PickAAA_N(KuiNN, i), 3)
}
AAAA(KuiMax) = 1
j = 0
For( i = 1 To KuiMax
    Select Case i
    Case 1
        OutouFlag(i) = -1
        LINETYPE(i) = 1
        OutouFlag2(i) = -1
        LINETYPE2(i) = 1
        OutouFlag1(i) = -1
        LINETYPE1(i) = 1
        LINETYPE3(i) = 1
    Case KuiMax
        OutouFlag(i) = 1
        LINETYPE(i) = 1
        OutouFlag2(i) = 1
        LINETYPE2(i) = 1
        OutouFlag1(i) = 1
        LINETYPE1(i) = 1
        LINETYPE3(i) = 1
        j = j + 1
        HHHZ1(j) = OutouAAA(i)
        if ( j > 1 ) {
            HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
        } else {
            HHHZ2(j) = OutouAAA(i)
        }
    Case } else {
        if ( OutouAAA(i) = OutouAAA(i - 1) ) {
            if ( RoundS(OutouValue(i), 3) = RoundS(OutouValue(i - 1), 3) ) {
                OutouFlag(i - 1) = -9000000000#
                OutouFlag(i) = 0
                LINETYPE(i - 1) = 0
                LINETYPE(i) = 1
            } else {
                OutouFlag(i - 1) = 1
                OutouFlag(i) = -1
                LINETYPE(i - 1) = 0
                LINETYPE(i) = 1
            }
            if ( RoundS(JibanValue(i), 5) = RoundS(JibanValue(i - 1), 5) ) {
                OutouFlag1(i - 1) = -9000000000#
                OutouFlag1(i) = 0
                LINETYPE1(i - 1) = 0
                LINETYPE1(i) = 1
            } else {
                OutouFlag1(i - 1) = 1
                OutouFlag1(i) = -1
                LINETYPE1(i - 1) = 0
                LINETYPE1(i) = 1
            }
            if ( RoundS(BaneValue(i), 3) = RoundS(BaneValue(i - 1), 3) ) {
                OutouFlag2(i - 1) = -9000000000#
                OutouFlag2(i) = 0
                LINETYPE2(i - 1) = 0
                LINETYPE2(i) = 1
            } else {
                OutouFlag2(i - 1) = 1
                OutouFlag2(i) = -1
                LINETYPE2(i - 1) = 0
                LINETYPE2(i) = 1
            }
            if ( RoundS(BaneValue(i), 3) != RoundS(BaneValue(i - 1), 3) ) {
                FDFDFD(i) = BaneValue(i - 1)
                FDFDFD(i - 1) = -9000000000#
                LINETYPE3(i) = 1
                LINETYPE3(i - 1) = 1
            } else {
                if ( SuiheiBaneEqual = 2 ) {
                    FDFDFD(i) = BaneValue(i)
                    FDFDFD(i - 1) = -9000000000#
                    LINETYPE3(i) = 1
                    LINETYPE3(i - 1) = 1
                }
            }
            if ( SouatrsuValuePrintA = 1 ) {
                if ( Int(Bane2(i)) = Int(Bane2(i - 1)) ) {
                    SuujiP(i) = 1
                    SuujiP(i - 1) = 1
                }
            }
            if ( Int(Bane2(i)) = Int(Bane2(i - 1)) ) {
            } else {
                j = j + 1
                HHHZ1(j) = OutouAAA(i)
                if ( j > 1 ) {
                    HHHZ2(j) = OutouAAA(i) - HHHZ1(j - 1)
                } else {
                    HHHZ2(j) = OutouAAA(i)
                }
            }
        } else {
            OutouFlag(i) = 0
            LINETYPE(i) = 2
            OutouFlag1(i) = 0
            LINETYPE1(i) = 2
        }
    End Select
}
SouMax = j
HH1 = PickAAA_N(KuiNN, KuiMax)
HHH = HH1 / KuiLengthMax
frmPrint.vsPrt1.TextAngle = 0 * 10
frmPrint.vsPrt1.FontSize = GraphTitleMojiSize * 1.25 ////////////////// nagase

TEMP1 = frmPrint.vsPrt1.PenWidth
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
this.DrawLineZZ(0, 0, 0, KuiMaxLen * HHH * OuTouBai)
frmPrint.vsPrt1.PenWidth = TEMP1
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
MeterAtari = KuiMaxLen * HHH * OuTouBai / HH1
// グラフの上に応答変位荷重を印字
if ( fMainForm.SICheck = True ) { //SI単位チェック
    TTT = "応答変位荷重 (kN/m)"
} else {
    TTT = "応答変位荷重 (tf/m)"
}
MojiZFX1 = OutouStartX //- CON_X(rmPrint.vsPrt1.FontSize * FFLen(TTT) / 2)
MojiZFY1 = OutouStartY - CON_Y(frmPrint.vsPrt1.FontSize) * 2.5
MyCurrentX = Int(CSng(MojiZFX1))
MyCurrentY = Int(CSng(MojiZFY1))
QWX1 = MyCurrentX
QWY1 = MyCurrentY
PrintoutPrt frmPrint.vsPrt1, TTT
if ( CreateDxfFlag = 1 ) {
    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
    ParamXPoint = QWX1
    ParamYpoint = QWY1
    ParamText = TTT
    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
}
// グラフの上に地盤変位量を印字
TTT = "応答変位量 (m)"
MojiZFX1 = OutouStartX1 + CON_X(frmPrint.vsPrt1.FontSize)
MojiZFY1 = OutouStartY - CON_Y(frmPrint.vsPrt1.FontSize) * 2.5
MyCurrentX = Int(CSng(MojiZFX1))
MyCurrentY = Int(CSng(MojiZFY1))
QWX1 = MyCurrentX
QWY1 = MyCurrentY
PrintoutPrt frmPrint.vsPrt1, TTT
if ( CreateDxfFlag = 1 ) {
    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
    ParamXPoint = QWX1
    ParamYpoint = QWY1
    ParamText = TTT
    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
}
// グラフの上に水平バネ係数を印字
if ( fMainForm.SICheck = True ) { //SI単位チェック
    TTT = "水平バネ定数 (kN/m2)"
} else {
    TTT = "水平バネ定数 (tf/m2)"
}
MojiZFX1 = OutouStartX2 - CON_X(frmPrint.vsPrt1.FontSize * 2)
MojiZFY1 = OutouStartY - CON_Y(frmPrint.vsPrt1.FontSize) * 2.5
MyCurrentX = Int(CSng(MojiZFX1))
MyCurrentY = Int(CSng(MojiZFY1))
QWX1 = MyCurrentX
QWY1 = MyCurrentY
PrintoutPrt frmPrint.vsPrt1, TTT
if ( CreateDxfFlag = 1 ) {
    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
    ParamXPoint = QWX1
    ParamYpoint = QWY1
    ParamText = TTT
    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
}
//
frmPrint.vsPrt1.FontSize = GraphTitleMojiSize
For( i = 1 To KuiMax
    Select Case i
    Case 1
        LLL = PickAAA_N(KuiNN, i)
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
        AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
        if ( MaxKuiOuTouLen != 0 ) {
        if ( GGG = 1 ) {
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N)) + Value3 * HiRiTsu / MaxKuiOuTouLen * MaxKuiOuTou
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
        } else {
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N)) + Value3 * HiRiTsu1 / MaxKuiOuTouLen * MaxKuiOuTou
        }
        }
        ZFX1 = ZFX2
        ZFY1 = ZFY2
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                if ( OutouCase2 = 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                } else {
                    frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1, 2       // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    MojiZFY1 = ZFY2 - SouatsuMojiHight * 18
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case KuiMax
        LLL = PickAAA_N(KuiNN, i)
        Value1 = 0 //PickOutouN(KuiNN, I, OuTouHHH)
        Value2 = 0 //PickBaneN(KuiNN, I, CA)
        Value3 = Value1 * Value2
        AZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N))
        AZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N))
        if ( MaxKuiOuTouLen != 0 ) {
        if ( GGG = 1 ) {
            ZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N)) + Value3 * HiRiTsu / MaxKuiOuTouLen * MaxKuiOuTou
            ZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N) - LLL)
        } else {
            ZFX2 = HEN_ZX(XXXX2(N) - XXXX2(N))
            ZFY2 = HEN_ZY(YYYY2(N) - YYYY2(N) - LLL) + Value3 * HiRiTsu1 / MaxKuiOuTouLen * MaxKuiOuTou
        }
        }
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2 + Add1
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                if ( OutouCase2 = 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                } else {
                    frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1, 2   // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case } else {
        LLL = PickAAA_N(KuiNN, i)
        Value1 = SMAX(PickOutouN(KuiNN, i, OuTouHHH) - PickOutouN(KuiNN, KuiMax, OuTouHHH), 0)
        Value2 = PickBaneN(KuiNN, i, CA)
        Value3 = Value1 * Value2
        if ( MaxKuiOuTouLen != 0 ) {
        if ( GGG = 1 ) {
            AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N))
            AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N) - LLL)
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N)) + Value3 * HiRiTsu / MaxKuiOuTouLen * MaxKuiOuTou
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N) - LLL)
        } else {
            AZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N) + LLL)
            AZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N))
            ZFX2 = HEN_ZX(XXXX1(N) - XXXX1(N) + LLL)
            ZFY2 = HEN_ZY(YYYY1(N) - YYYY1(N)) + Value3 * HiRiTsu1 / MaxKuiOuTouLen * MaxKuiOuTou
        }
        }
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE(i) > 1 ) {
                if ( OutouCase2 = 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE(i)))
                } else {
                    frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case SouatrsuValuePrintA
        Case 1
            if ( LINETYPE(i) = 1 || (LINETYPE(i) != 2 $$ LINETYPE(i + 1) = 1) ) {
                if ( OutouFlag(i) != -9000000000# ) {
                    if ( SuujiP(i) = 0 ) {
                        if ( GGG = 1 ) {
                            MojiZFX1 = ZFX2 + SouatsuMojiHight
                            this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                        } else {
                            MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                            this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                        }
                        this.Outou_KakuSub4(GGG)
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        if ( GGG = 1 ) {
                            this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                        } else {
                            TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                            MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                        }
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                    }
                }
            }
        Case 2      // 変位荷重数値印刷
            if ( OutouFlag(i) != -9000000000# ) {
                if ( GGG = 1 ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                } else {
                    MojiZFY1 = ZFY2 + SouatsuMojiHight / 2
                    this.Outou_KakuSub2(OutouFlag(i), MojiZFX1, SouatsuMojiHight, ZFX2)
                }
                this.Outou_KakuSub4(GGG)
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                if ( GGG = 1 ) {
                    this.Outou_KakuSub1(OoutouHeniKetaSuu, OutouValue(i), TTT)
                } else {
                    TTT = Format(SMAX(OutouValue(i), 0), "0.000") & " "
                    MojiZFY1 = MojiZFY1 + SouatsuMojiHight * (Len(TTT)) * 10
                }
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    End Select
}
//
if ( SunPouSenX1 = 1 ) {     // 寸法線を書かない場合はここで終了。
} else {
    ZFX1 = OutouStartX
    ZFY1 = OutouStartY
    ZFX2 = OutouStartX + SunPouStartX1
    ZFY2 = OutouStartY
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = OutouStartX
    ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
    ZFX2 = OutouStartX + SunPouStartX1
    ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = OutouStartX + SunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
    ZFY1 = OutouStartY
    ZFX2 = OutouStartX + SunPouStartX1 + SunPouMojiSize1 * OuTouBai / 10
    ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
    this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
    this.OuTouPrintUp1(1, SunPouMojiSize1, HH1, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2)) // 杭長の印字
    UpXXX = -9000000000#
    DownXXX = -9000000000#
    YYYYY1 = 0
    YYYYY2 = 0
    For( i = 1 To SouMax
        YYYYY1 = YYYYY1 + HHHZ2(i) * MeterAtari
        frmPrint.vsPrt1.PenWidth = SunPouPenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        ZFX1 = OutouStartX
        ZFY1 = OutouStartY + YYYYY1
        ZFX2 = OutouStartX + SunPouStartX2
        ZFY2 = OutouStartY + YYYYY1
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        ZFX1 = OutouStartX + SunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
        ZFY1 = OutouStartY + YYYYY2
        ZFX2 = OutouStartX + SunPouStartX2 + SunPouMojiSize1 * OuTouBai / 10
        ZFY2 = OutouStartY + YYYYY1
        this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
        this.OuTouPrintUp2(SunPouMojiSize2, HHHZ2(i), CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXX, DownXXX) // 杭長の印字
        YYYYY2 = YYYYY1
    }
    if ( SunPouSenX2 = 1 ) {     // 着目点単位の寸法線を書かない場合はここで終了。
    } else {
        YYYYY1 = 0
        YYYYY2 = 0
        YYYYY3 = 0
        FFF1 = 0
        FFF2 = 0
        FFF3 = 0
        FFF4 = 0
        UpXXXTyakuMokuTen = -9000000000#
        DownXXXTyakuMokuTen = -9000000000#
        For( i = 2 To KuiMax
            FFF3 = PickAAA_N(KuiNN, i)
            if ( AAAA(i) = 1 ) {
                if ( FFF1 = 0 ) {
                    if ( i = 2 ) {
                        FFF1 = FFF3
                    } else {
                        FFF1 = FFF3 - PickAAA_N(KuiNN, i - 1)
                    }
                    FFF2 = 1
                    YYYYY1 = FFF3 * MeterAtari
                    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                    if ( CreateDxfFlag = 1 ) {
                        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                    }
                    ZFX1 = OutouStartX
                    ZFY1 = OutouStartY + YYYYY1
                    ZFX2 = OutouStartX + SunPouStartX3
                    ZFY2 = OutouStartY + YYYYY1
                    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                    }
                    ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                    ZFY1 = OutouStartY + YYYYY2
                    ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                    ZFY2 = OutouStartY + YYYYY1
                    this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                    this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                    YYYYY2 = YYYYY1
                    FFF1 = 0
                    FFF2 = 0
                    FFF4 = FFF3
                } else {
                    if ( RoundS(FFF1, 3) = RoundS(CCCC(i), 3) ) {
                        FFF2 = FFF2 + 1
                        YYYYY1 = FFF3 * MeterAtari
                        frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                        if ( CreateDxfFlag = 1 ) {
                            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                        }
                        ZFX1 = OutouStartX
                        ZFY1 = OutouStartY + YYYYY1
                        ZFX2 = OutouStartX + SunPouStartX3
                        ZFY2 = OutouStartY + YYYYY1
                        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                        }
                        ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY1 = OutouStartY + YYYYY2
                        ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY2 = OutouStartY + YYYYY1
                        this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                        this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                        YYYYY2 = YYYYY1
                        FFF1 = 0
                        FFF2 = 0
                        FFF4 = FFF3
                    } else {
                        YYYYY1 = FFF4 * MeterAtari
                        frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                        if ( CreateDxfFlag = 1 ) {
                            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                        }
                        ZFX1 = OutouStartX
                        ZFY1 = OutouStartY + YYYYY1
                        ZFX2 = OutouStartX + SunPouStartX3
                        ZFY2 = OutouStartY + YYYYY1
                        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                        }
                        ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY1 = OutouStartY + YYYYY2
                        ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY2 = OutouStartY + YYYYY1
                        this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                        this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                        YYYYY2 = YYYYY1
                        FFF1 = FFF3 - FFF4
                        FFF2 = 1
                        YYYYY1 = FFF3 * MeterAtari
                        frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                        if ( CreateDxfFlag = 1 ) {
                            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                        }
                        ZFX1 = OutouStartX
                        ZFY1 = OutouStartY + YYYYY1
                        ZFX2 = OutouStartX + SunPouStartX3
                        ZFY2 = OutouStartY + YYYYY1
                        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                        }
                        ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY1 = OutouStartY + YYYYY2
                        ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                        ZFY2 = OutouStartY + YYYYY1
                        this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                        this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                        YYYYY2 = YYYYY1
                        FFF1 = 0
                        FFF2 = 0
                        FFF4 = FFF3
                    }
                }
            } else {
                if ( i = 2 ) {
                    FFF1 = CCCC(i)
                    FFF2 = 1
                } else {
                    if ( CCCC(i) = 0 ) {
                        FFF1 = 0
                        FFF2 = 0
                    } else {
                        if ( FFF1 = 0 ) {
                            FFF1 = CCCC(i)
                            FFF2 = 1
                        } else {
                            if ( RoundS(FFF1, 3) = RoundS(CCCC(i), 3) ) {
                                FFF2 = FFF2 + 1
                            } else {
                                YYYYY1 = FFF4 * MeterAtari
                                frmPrint.vsPrt1.PenWidth = SunPouPenWidth
                                if ( CreateDxfFlag = 1 ) {
                                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                                }
                                ZFX1 = OutouStartX
                                ZFY1 = OutouStartY + YYYYY1
                                ZFX2 = OutouStartX + SunPouStartX3
                                ZFY2 = OutouStartY + YYYYY1
                                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                                if ( CreateDxfFlag = 1 ) {
                                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                                }
                                ZFX1 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                                ZFY1 = OutouStartY + YYYYY2
                                ZFX2 = OutouStartX + SunPouStartX3 + SunPouMojiSize1 * OuTouBai / 10
                                ZFY2 = OutouStartY + YYYYY1
                                this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
                                this.OuTouPrintUp3(SunPouMojiSize3, FFF1, FFF2, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), UpXXXTyakuMokuTen, DownXXXTyakuMokuTen) // 杭長の印字
                                YYYYY2 = YYYYY1
                                FFF1 = FFF3 - FFF4
                                FFF2 = 1
                                FFF4 = FFF3
                            }
                        }
                    }
                }
            }
            FFF4 = FFF3
        }
    }
}
//
if ( GibanHeniX1 = 1 ) {     // 応答変位量の印字のみ
    return;
}
//
ZFX1 = OutouStartX1
ZFY1 = OutouStartY
ZFX2 = OutouStartX1
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1 - KuiAtsu
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 - KuiAtsu
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 - KuiAtsu
ZFY2 = OutouStartY
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1 - KuiAtsu
ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
ZFX2 = OutouStartX1
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = 部材Pen幅
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX2
ZFY1 = OutouStartY
ZFX2 = OutouStartX2
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = SunPouPenWidth + 5 + 5
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 + Teisuu1
ZFY2 = OutouStartY
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 + Teisuu3
ZFY2 = OutouStartY
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1
ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
ZFX2 = OutouStartX1 + Teisuu3
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
if ( CreateDxfFlag = 1 ) {
    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
}
ZFX1 = OutouStartX1 + Teisuu2
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 + Teisuu2
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
this.OuTouPrintUp1(1, SunPouMojiSize1, HH1, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2)) // 杭長の印字
if ( Maxjiban = 0 ) {
MeterAtari1 = 0
} else {
MeterAtari1 = Teisuu4 / (Maxjiban * 1000)
}
MeterAtari2 = Teisuu5 / MaxBane
ZFX1 = OutouStartX1 + MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko
ZFY1 = OutouStartY
ZFX2 = OutouStartX1 + MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko
ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai
frmPrint.vsPrt1.PenStyle = psSolid
frmPrint.vsPrt1.PenWidth = SunPouPenWidth
if ( CreateDxfFlag = 1 ) {
    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
}
this.PlotLine1(CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), 2)
if ( JibanValue(KuiMax) > 0 ) {
    EndSuihei = 1
    ZFX1 = OutouStartX1 + MeterAtari1 * 0 * 1000 * JibanYoko
    ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
    ZFX2 = OutouStartX1 + MeterAtari1 * 0 * 1000 * JibanYoko + SyitaX
    ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai + SyitaY
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = OutouStartX1 + MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko
    ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai
    ZFX2 = OutouStartX1 + MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko + SyitaX
    ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai + SyitaY
    frmPrint.vsPrt1.PenWidth = SunPouPenWidth
    if ( CreateDxfFlag = 1 ) {
        this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
    }
    DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
    if ( CreateDxfFlag = 1 ) {
        this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
    }
    ZFX1 = OutouStartX1 + SyitaX1
    ZFY1 = OutouStartY + KuiMaxLen * HHH * OuTouBai + SyitaY1
    ZFX2 = OutouStartX1 + MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko + SyitaX1
    ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai + SyitaY1
    this.OuTouYajirushi(YajirushiSize * OuTouBai, CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2))   // 矢印の印字
    this.OuTouPrintUp1_Y5(1, SunPouMojiSize1, JibanValue(KuiMax), CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2)) // 杭長の印字
}
//
StartXXX1 = MeterAtari1 * JibanValue(KuiMax) * 1000 * JibanYoko
For( i = 1 To KuiMax
    Select Case i
    Case 1
        LLL = PickAAA_N(KuiNN, i)
        Value1 = PickOutouN(KuiNN, i, OuTouHHH)
        Value3 = Value1
        AZFX2 = OutouStartX1 + StartXXX1
        AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        ZFX2 = OutouStartX1 + (Value3 * HiRiTsu * 1000) * MeterAtari1 * JibanYoko
        ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        ZFX1 = ZFX2
        ZFY1 = ZFY2
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE1(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE1(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE1(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case GibanHeniX2
        Case 2
            if ( LINETYPE1(i) = 1 || (LINETYPE1(i) != 2 $$ LINETYPE1(i + 1) = 1) ) {
                if ( OutouFlag1(i) != -9000000000# ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    MojiZFY1 = ZFY2 - SouatsuMojiHight * 18
                    frmPrint.vsPrt1.TextAngle = 0 * 10
                    frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                    this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                    JibanMojiEnd(i) = MojiZFX1 + CON_X(SouatsuMojiHight * Len(TTT) / 2)
                    MyCurrentX = Int(CSng(MojiZFX1))
                    MyCurrentY = Int(CSng(MojiZFY1))
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, TTT
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = TTT
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                }
            }
        Case 3      // 変位荷重数値印刷
            if ( OutouFlag1(i) != -9000000000# ) {
                MojiZFX1 = ZFX2 + SouatsuMojiHight
                MojiZFY1 = ZFY2 - SouatsuMojiHight * 18
                frmPrint.vsPrt1.TextAngle = 0 * 10
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                JibanMojiEnd(i) = MojiZFX1 + CON_X(SouatsuMojiHight * Len(TTT) / 2)
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case KuiMax
        LLL = PickAAA_N(KuiNN, i)
        Value1 = PickOutouN(KuiNN, i, OuTouHHH)
        Value3 = Value1
        AZFX2 = OutouStartX1 + StartXXX1
        AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        ZFX2 = OutouStartX1 + (Value3 * HiRiTsu * 1000) * MeterAtari1 * JibanYoko
        ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE1(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE1(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE1(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case GibanHeniX2
        Case 2
            if ( LINETYPE1(i) = 1 ) {
                if ( OutouFlag1(i) != -9000000000# ) {
                    MojiZFX1 = ZFX2 + SouatsuMojiHight
                    this.Outou_KakuSub3(OutouFlag1(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                    frmPrint.vsPrt1.TextAngle = 0 * 10
                    frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                    this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                    JibanMojiEnd(i) = MojiZFX1 + CON_X(SouatsuMojiHight * Len(TTT) / 2)
                    MyCurrentX = Int(CSng(MojiZFX1))
                    MyCurrentY = Int(CSng(MojiZFY1))
                    QWX1 = MyCurrentX
                    QWY1 = MyCurrentY
                    PrintoutPrt frmPrint.vsPrt1, TTT
                    if ( CreateDxfFlag = 1 ) {
                        ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                        ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                        ParamXPoint = QWX1
                        ParamYpoint = QWY1
                        ParamText = TTT
                        this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                    }
                }
            }
        Case 3      // 変位荷重数値印刷
            if ( OutouFlag1(i) != -9000000000# ) {
                MojiZFX1 = ZFX2 + SouatsuMojiHight
                this.Outou_KakuSub3(OutouFlag1(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                frmPrint.vsPrt1.TextAngle = 0 * 10
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                JibanMojiEnd(i) = MojiZFX1 + CON_X(SouatsuMojiHight * Len(TTT) / 2)
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    Case } else {
        LLL = PickAAA_N(KuiNN, i)
        Value1 = PickOutouN(KuiNN, i, OuTouHHH)
        Value3 = Value1
        AZFX2 = OutouStartX1 + StartXXX1
        AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        ZFX2 = OutouStartX1 + (Value3 * HiRiTsu * 1000) * MeterAtari1 * JibanYoko
        ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
        if ( CreateDxfFlag = 1 ) {
            this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
        }
        if ( LINETYPE1(i) > 0 ) {
            frmPrint.vsPrt1.PenStyle = psSolid
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth - Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            if ( LINETYPE1(i) > 1 ) {
                this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE1(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                }
            }
        }
        Select Case GibanHeniX2
        Case 2
            if ( LINETYPE1(i) = 1 || (LINETYPE1(i) != 2 $$ LINETYPE1(i + 1) = 1) ) {
                if ( OutouFlag1(i) != -9000000000# ) {
                    if ( SuujiP(i) = 0 ) {
                        MojiZFX1 = ZFX2 + SouatsuMojiHight
                        this.Outou_KakuSub3(OutouFlag1(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                        frmPrint.vsPrt1.TextAngle = 0 * 10
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                        JibanMojiEnd(i) = MojiZFX1 + CON_X(SouatsuMojiHight * Len(TTT) / 2)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                    }
                }
            }
        Case 3      // 変位荷重数値印刷
            if ( OutouFlag1(i) != -9000000000# ) {
                MojiZFX1 = ZFX2 + SouatsuMojiHight
                this.Outou_KakuSub3(OutouFlag1(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                frmPrint.vsPrt1.TextAngle = 0 * 10
                frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                this.Outou_KakuSub7(Value1, JibanSuuchiKakkoSuuji, Endp, EndSuihei, TTT)
                JibanMojiEnd(i) = MojiZFX1 + CON_X(SouatsuMojiHight * Len(TTT) / 2)
                MyCurrentX = Int(CSng(MojiZFX1))
                MyCurrentY = Int(CSng(MojiZFY1))
                QWX1 = MyCurrentX
                QWY1 = MyCurrentY
                PrintoutPrt frmPrint.vsPrt1, TTT
                if ( CreateDxfFlag = 1 ) {
                    ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                    ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                    ParamXPoint = QWX1
                    ParamYpoint = QWY1
                    ParamText = TTT
                    this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                }
            }
        Case } else {
        End Select
        ZFX1 = ZFX2
        ZFY1 = ZFY2
    End Select
}
//
For( i = 1 To 100
    FaFaXxx(i) = -9000000000#
    FaFaYyy(i) = -9000000000#
    FaFaLineType(i) = -9000000000#
}
//
Select Case Int(SuiheiBaneX3)
Case 1
    X11 = 0
    Counter = 0
    For( i = 1 To KuiMax
        Select Case i
        Case 1
            LLL = PickAAA_N(KuiNN, i)
            Value1 = PickBaneN(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            X11 = 1
            StartX11 = ZFX2
            StartY11 = ZFY2
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            if ( LINETYPE2(i) > 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE1(i) > 1 ) {
                    if ( OutouCase4 = 1 ) {
                        this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE2(i)))
                    } else {
                        DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                        }
                    }
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
            Counter = Counter + 1
            FaFaXxx(Counter) = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            FaFaLineType(Counter) = 1
            MaeValue = Value3
            ZFX1 = ZFX2
            ZFY1 = ZFY2
        Case KuiMax
            LLL = PickAAA_N(KuiNN, i)
            Value1 = PickBaneN(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            Counter = Counter + 1
            FaFaXxx(Counter) = OutouStartX2
            FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            FaFaLineType(Counter) = 2
            if ( LINETYPE2(i) > 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE1(i) > 1 ) {
                    if ( OutouCase4 = 1 ) {
                        this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE2(i)))
                    } else {
                        DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                        if ( CreateDxfFlag = 1 ) {
                            this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                        }
                    }
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
                if ( LINETYPE3(i) > 0 ) {
                    this.Outou_KakuSub6(Value3, OutouCase5, TTT)
                    if ( X11 = 1 ) {
                        if ( (ZFX2 - AZFX2) / 2 > CON_X2(SouatsuMojiHight * FFLen(TTT) / 2) / 2 ) {
                            MojiZFX1 = AZFX2 + (ZFX2 - AZFX2) / 2 - CON_X2(SouatsuMojiHight * FFLen(TTT) / 2) / 2
                        } else {
                            MojiZFX1 = ZFX2 + SouatsuMojiHight
                        }
                        MojiZFY1 = StartY11 + (ZFY2 - StartY11) / 2 - CON_Y(SouatsuMojiHight) / 2
                        frmPrint.vsPrt1.TextAngle = 0
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub5(Value3, OutouCase5, TTT)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                        X11 = 0
                    } else {
                        if ( X11 = 0 ) {
                            X11 = 1
                            StartX11 = ZFX2
                            StartY11 = ZFY2
                        }
                    }
                }
            }
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            MaeValue = Value3
        Case } else {
            LLL = PickAAA_N(KuiNN, i)
            Value1 = PickBaneN(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            if ( FDFDFD(i) >= 0 ) {
                Counter = Counter + 1
                FaFaXxx(Counter) = OutouStartX2 + BaneBairitsuHosei((FDFDFD(i) * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
                FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
                FaFaLineType(Counter) = 2
            }
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
                if ( LINETYPE3(i) > 0 ) {
                    this.Outou_KakuSub6(Value3, OutouCase5, TTT)
                    if ( X11 = 1 ) {
                        if ( (ZFX2 - AZFX2) / 2 > CON_X2(SouatsuMojiHight * FFLen(TTT) / 2) / 2 ) {
                            MojiZFX1 = AZFX2 + (ZFX2 - AZFX2) / 2 - CON_X2(SouatsuMojiHight * FFLen(TTT) / 2) / 2
                        } else {
                            MojiZFX1 = ZFX2 + SouatsuMojiHight
                        }
                        MojiZFY1 = StartY11 + (ZFY2 - StartY11) / 2 - CON_Y(SouatsuMojiHight) / 2
                        frmPrint.vsPrt1.TextAngle = 0
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub5(Value3, OutouCase5, TTT)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                        X11 = 0
                    } else {
                        if ( X11 = 0 ) {
                            X11 = 1
                            StartX11 = ZFX2
                            StartY11 = ZFY2
                        }
                    }
                }
            }
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            MaeValue = Value3
        End Select
    }
Case 2
    Counter = 0
    For( i = 1 To KuiMax
        Select Case i
        Case 1
            LLL = PickAAA_N(KuiNN, i)
            Value1 = PickBaneN(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            if ( LINETYPE2(i) > 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE1(i) > 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE2(i)))
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
            Counter = Counter + 1
            FaFaXxx(Counter) = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            FaFaLineType(Counter) = 1
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
                if ( LINETYPE2(i) = 1 || (LINETYPE2(i) != 2 $$ LINETYPE2(i + 1) = 1) ) {
                    if ( OutouFlag2(i) != -9000000000# ) {
                        MojiZFX1 = ZFX2 + SouatsuMojiHight
                        this.Outou_KakuSub3(OutouFlag2(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                        frmPrint.vsPrt1.TextAngle = 0 * 10
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub5(Value3, OutouCase5, TTT)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                    }
                }
            }
            MaeValue = Value3
            ZFX1 = ZFX2
            ZFY1 = ZFY2
        Case KuiMax
            LLL = PickAAA_N(KuiNN, i)
            Value1 = PickBaneN(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            Counter = Counter + 1
            FaFaXxx(Counter) = OutouStartX2
            FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            FaFaLineType(Counter) = 2
            if ( LINETYPE2(i) > 0 ) {
                frmPrint.vsPrt1.PenStyle = psSolid
                frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
                if ( CreateDxfFlag = 1 ) {
                    this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
                }
                if ( LINETYPE2(i) > 1 ) {
                    this.PlotLine1(CDbl(AZFX2), CDbl(AZFY2), CDbl(ZFX2), CDbl(ZFY2), CInt(LINETYPE2(i)))
                } else {
                    DrawLinePrt frmPrint.vsPrt1, AZFX2, AZFY2, ZFX2, ZFY2
                    if ( CreateDxfFlag = 1 ) {
                        this.LINEOUT(CSng(AZFX2), CSng(AZFY2), CSng(ZFX2), CSng(ZFY2))
                    }
                }
            }
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
                if ( LINETYPE2(i) = 1 ) {
                    if ( OutouFlag2(i) != -9000000000# ) {
                        MojiZFX1 = ZFX2 + SouatsuMojiHight
                        this.Outou_KakuSub3(OutouFlag2(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                        frmPrint.vsPrt1.TextAngle = 0 * 10
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub5(Value3, OutouCase5, TTT)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                    }
                }
            }
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            MaeValue = Value3
        Case } else {
            LLL = PickAAA_N(KuiNN, i)
            Value1 = PickBaneN(KuiNN, i, CA)
            Value3 = Value1
            AZFX2 = OutouStartX2
            AZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            ZFX2 = OutouStartX2 + BaneBairitsuHosei((Value3 * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
            ZFY2 = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
            frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth + Add1
            if ( CreateDxfFlag = 1 ) {
                this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
            }
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
            if ( FDFDFD(i) >= 0 ) {
                Counter = Counter + 1
                FaFaXxx(Counter) = OutouStartX2 + BaneBairitsuHosei((FDFDFD(i) * HiRiTsu) * MeterAtari2, (PMax * HiRiTsu) * MeterAtari2)
                FaFaYyy(Counter) = OutouStartY + KuiMaxLen * HHH * OuTouBai * (LLL / HH1)
                FaFaLineType(Counter) = 2
            }
            if ( SuiheiBaneX1 = 2 ) {    // 水平バネ係数の印字（各層圧の起点と終点の数字を印字）
                if ( LINETYPE2(i) = 1 || (LINETYPE2(i) != 2 $$ LINETYPE2(i + 1) = 1) ) {
                    if ( OutouFlag2(i) != -9000000000# ) {
                        MojiZFX1 = ZFX2 + SouatsuMojiHight
                        this.Outou_KakuSub3(OutouFlag2(i), MojiZFY1, SouatsuMojiHight, ZFY2)
                        frmPrint.vsPrt1.TextAngle = 0
                        frmPrint.vsPrt1.FontSize = SouatsuMojiHight
                        this.Outou_KakuSub5(Value3, OutouCase5, TTT)
                        MyCurrentX = Int(CSng(MojiZFX1))
                        MyCurrentY = Int(CSng(MojiZFY1))
                        QWX1 = MyCurrentX
                        QWY1 = MyCurrentY
                        PrintoutPrt frmPrint.vsPrt1, TTT
                        if ( CreateDxfFlag = 1 ) {
                            ParamAngle = frmPrint.vsPrt1.TextAngle / 10
                            ParamFontSize = frmPrint.vsPrt1.FontSize / 5
                            ParamXPoint = QWX1
                            ParamYpoint = QWY1
                            ParamText = TTT
                            this.PLOTSYMBOL(ParamXPoint, ParamYpoint, ParamFontSize, ParamText, 0, ParamAngle, 0, 0)
                        }
                    }
                }
            }
            ZFX1 = ZFX2
            ZFY1 = ZFY2
            MaeValue = Value3
        End Select
    }
Case } else {
End Select
//
if ( Counter > 0 ) {
    For( i = 1 To Counter
        ZFX1 = OutouStartX1
        ZFY1 = FaFaYyy(i)
        ZFX2 = OutouStartX1 + StartXXX1
        ZFY2 = FaFaYyy(i)
        frmPrint.vsPrt1.PenStyle = psSolid
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        if ( FaFaLineType(i) > 1 ) {
            if ( OutouCase4 = 1 ) {
                this.PlotLine1(CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), CInt(FaFaLineType(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
            }
        } else {
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
        }
        ZFX1 = FaFaXxx(i)
        ZFY1 = FaFaYyy(i)
        ZFX2 = OutouStartX2
        ZFY2 = FaFaYyy(i)
        frmPrint.vsPrt1.PenStyle = psSolid
        frmPrint.vsPrt1.PenWidth = SouatsuHajimePenWidth
        if ( CreateDxfFlag = 1 ) {
            this.PLOTPEN(CSng(frmPrint.vsPrt1.PenWidth))
        }
        if ( FaFaLineType(i) > 1 ) {
            if ( OutouCase4 = 1 ) {
                this.PlotLine1(CDbl(ZFX1), CDbl(ZFY1), CDbl(ZFX2), CDbl(ZFY2), CInt(FaFaLineType(i)))
            } else {
                DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
                if ( CreateDxfFlag = 1 ) {
                    this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
                }
            }
        } else {
            DrawLinePrt frmPrint.vsPrt1, ZFX1, ZFY1, ZFX2, ZFY2
            if ( CreateDxfFlag = 1 ) {
                this.LINEOUT(CSng(ZFX1), CSng(ZFY1), CSng(ZFX2), CSng(ZFY2))
            }
        }
    }
}
//
}

private void Outou_KakuSub1(Outou As Double, OutouV, TTT As Variant)
//
Select Case Outou
Case 0
    TTT = " " & str(Int(SMAX(OutouV, 0)))
Case 1
    TTT = " " & Format(SMAX(OutouV, 0), "0.0")
Case 2
    TTT = " " & Format(SMAX(OutouV, 0), "0.00")
Case 3
    TTT = " " & Format(SMAX(OutouV, 0), "0.000")
Case } else {
    TTT = " " & Format(SMAX(OutouV, 0), "0.000")
End Select
//
}

private void Outou_KakuSub2(OutouFlag As Double, MojiZFX1 As Single, SouatsuMojiHight, ZFX2 As Single)
//
Select Case Int(OutouFlag)
Case -1
    MojiZFX1 = ZFX2 + SouatsuMojiHight * 1.2
Case 0
    MojiZFX1 = ZFX2 - SouatsuMojiHight * 12
Case 1
    MojiZFX1 = ZFX2 - SouatsuMojiHight * 18
Case } else {
End Select
//
}

private void Outou_KakuSub3(OutouFlag As Double, MojiZFY1 As Single, SouatsuMojiHight, ZFY2 As Single)
//
Select Case Int(OutouFlag)
Case -1
    MojiZFY1 = ZFY2 + SouatsuMojiHight * 1.2
Case 0
    MojiZFY1 = ZFY2 - SouatsuMojiHight * 6
Case 1
    MojiZFY1 = ZFY2 - SouatsuMojiHight * 18
Case } else {
End Select
//
}

private void Outou_KakuSub4(GGG)
//
if ( GGG = 1 ) {
    frmPrint.vsPrt1.TextAngle = 0 * 10
} else {
    frmPrint.vsPrt1.TextAngle = 90 * 10
}
//
}

private void Outou_KakuSub5(Value3 As Double, OutouCase, TTT)
//
Select Case Int(OutouCase)
Case 0
    TTT = " " & Trim(Format(Value3, "0"))
Case 1
    TTT = " " & Trim(Format(Value3, "0.0"))
Case 2
    TTT = " " & Trim(Format(Value3, "0.00"))
Case } else {
    TTT = " " & Trim(Format(Value3, "0"))
End Select
//
}

private void Outou_KakuSub6(Value3 As Double, OutouCase, TTT)
//
Select Case Int(OutouCase)
Case 0
    TTT = "   " & Trim(Format(Value3, "0")) & " "
Case 1
    TTT = "  " & Trim(Format(Value3, "0.0")) & " "
Case 2
    TTT = " " & Trim(Format(Value3, "0.00")) & " "
Case } else {
    TTT = "   " & Trim(Format(Value3, "0")) & " "
End Select
//
}

private void Outou_KakuSub7(Value1 As Double, JibanSuuchiKakkoSuuji As Double, Endp As Double, EndSuihei, TTT)
//
if ( JibanSuuchiKakkoSuuji = 2 ) {
    if ( EndSuihei = 1 ) {
        TTT = " " & Trim(Format(Value1 - Endp, "0.00000")) & " (" & Trim(Format(Value1, "0.00000")) & ")"
    } else {
        TTT = " " & Trim(Format(Value1 - Endp, "0.00000"))
    }
} else {
    TTT = " " & Trim(Format(Value1 - Endp, "0.00000"))
}
//
}

private Function AskSettenData()
//
var FN1
var D
var DA
var er1
var fno                     As Integer
//
fno = FreeFile
FN1 = FOLU & "1.txt"
On Error GoTo NG1
    Open FN1 For( Input As #fno
    Input #fno, D
    AskSettenData = val(D)
    Close fno
    Exit Function
NG1:
Close fno
AskSettenData = 0
//
}

private Function AskBuzaiData()
//
var FN1
var D
var DA
var er1
var fno                     As Integer
//
fno = FreeFile
FN1 = FOLU & "Buzai.txt"
On Error GoTo NG1
    Open FN1 For( Input As #fno
    Input #fno, D
    AskBuzaiData = val(D)
    Close fno
    Exit Function
NG1:
Close fno
AskBuzaiData = 0
//
}

private void EEE1(y部材名()) //////////////////////////////////////////05/05/23 杭先端の座標を元に戻す//////////08/08/199
var i9 As Integer
var i1 As Integer, I2 As Integer
var X1 As Single, X2 As Single, y1 As Single, Y2 As Single, LY As Single
if ( 縦スケール != 0 ) { return; //////08/08/31
//
For( i9 = 1 To 部材_max
//        WWBuzaiBai(i9) = ZZBuzaiBai(i9) ////////08/07/08
    if ( (InStr(部材名(i9), "杭") = 1 || InStr(部材名(i9), "側壁") != 0) || _
       (InStr(y部材名(i9), "杭") = 1 || InStr(y部材名(i9), "側壁") != 0) ) { ////////////08/08/199
        if ( ZZBuzaiBai(i9) != 1 $$ ZZBuzaiBai(i9) != 0 ) {
            i1 = 部I(i9)
            I2 = 部J(i9)
            X1 = 節X(i1)
            y1 = 節Y(i1)
            X2 = 節X(I2)
            Y2 = 節Y(I2)
            LY = Y2 - y1
            ZZBuzaiBai(i9) = 1 ////WWBuzaiBai(i9) ////Round(WWBuzaiBai(i9) ^ 0.5, 2)////////////////08/06/244
            節Y(I2) = y1 + Round(LY / WWBuzaiBai(i9) * ZZBuzaiBai(i9), 3)
        }
    } ////////////////////////////////////////////////////////////////////////////////////////05/03/13
}9
this.SETBuzaiDtata ////////////////////05/05/24
if ( k杭長 != F杭長 ) { ////////08/11/11
図Y_SCALE = 図Y_SCALE / (((YYMAX + k杭長) / (YYMAX + F杭長)) ^ 0.7) ////////08/11/11
}
}

private void EEE2(y部材名()) //////////////////////////////////////////05/05/23 杭先端の座標を元の元に戻す//////////08/08/199
var i9 As Integer
var i1 As Integer, I2 As Integer
var X1 As Single, X2 As Single, y1 As Single, Y2 As Single, LY As Single
if ( 縦スケール != 0 ) { return; //////08/08/31
//
For( i9 = 1 To 部材_max
    if ( (InStr(部材名(i9), "杭") = 1 || InStr(部材名(i9), "側壁") != 0) || _
       (InStr(y部材名(i9), "杭") = 1 || InStr(y部材名(i9), "側壁") != 0) ) { ////////////08/08/199
//            ZZBuzaiBai(i9) = WWBuzaiBai(i9)
        if ( WWBuzaiBai(i9) != 1 ) { //////////////08/07/06////08/08/199
            i1 = 部I(i9)
            I2 = 部J(i9)
            X1 = 節X(i1)
            y1 = 節Y(i1)
            X2 = 節X(I2)
            Y2 = 節Y(I2)
            LY = Y2 - y1
            節Y(I2) = y1 + Round(LY / ZZBuzaiBai(i9) * WWBuzaiBai(i9), 3)
            ZZBuzaiBai(i9) = WWBuzaiBai(i9)
        }
    } ////////////////////////////////////////////////////////////////////////////////////////05/03/13
}9
this.SETBuzaiDtata ////////////////////08/11/11
}

private void Check_BuzaiXXXX(STARTP As Integer, ENDdd As Integer, 部材_max As Integer, _
        部I() As Integer, 部J() As Integer, BuzaiFF As Integer, GGGGG() As Integer, _
        k角度一連 As Boolean, str方向 As String, Optional FLG8 As Integer = 0) //////10/03/07
//09/10/14
var i                       As Integer
var j                       As Integer
var k                       As Integer
var HH[]                    As Integer
var ii()                    As Integer
var KK()                    As Integer
var CheckP                  As Integer
var Atta                    As Integer
var GOSA                    As Single
var SS                      As Integer
var AA                      As Integer
var BB                      As Integer
var Endp                    As Integer
var 前BUZAI_No              As Integer
var 角度1 As Single, 角度2 As Single, 角度3 As Single
var Dummy As Integer
//
k角度一連 = True //////////////////////////09/10/20
Endp = ENDdd
BuzaiFF = 0
if ( STARTP = Abs(Endp) ) { return;
//
BB = 0
    For( i = STARTP To ENDdd - 1
        if ( 部J(i) = 部I(i + 1) ) {
            BB = BB + 1
        }
    }

if ( BB = 0 ) { //////////////////////////////////////////////////14/11/177
    if ( 部J(STARTP) = 部I(ENDdd) ) {
        GGGGG(1) = STARTP
        GGGGG(2) = ENDdd
        BuzaiFF = 2
        return;
    }
}
AA = 0
    角度1 = SuiHeiAngX(STARTP)
    For( i = STARTP To ENDdd
        角度2 = SuiHeiAngX(i)
        if ( Abs(角度1 - 角度2) > 0.6 ) { //////////09/10/20
            k角度一連 = False //////////09/10/20
            Exit For
        }
        角度1 = 角度2
        AA = AA + 1
    }
    if ( FLG8 = 0 ) { //////17/10/07
    if ( ENDdd - STARTP = BB $$ ENDdd - STARTP + 1 = AA ) {
//        if ( Not (ENDdd - STARTP = BB $$ ENDdd - STARTP + 1 = AA) ) { //////12/02/15
        BuzaiFF = 0
        return;
    }
    }
GOSA = 25
前BUZAI_No = STARTP
BB = 0 ////////////////////////////////10/03/07
if ( str方向 = "V" ) {
if ( 節X(部I(STARTP)) > 節X(部I(ENDdd)) || 節X(部I(STARTP)) > 節X(部I(Int((STARTP + ENDdd) / 2))) ) { //////10/03/07
//        STARTP = ENDdd
//        ENDdd = 前BUZAI_No
    前BUZAI_No = STARTP
//        BB = 1
}
}
this.HH[部材_max]
this.ii(部材_max)
this.KK(部材_max)
    For( i = 1 To 部材_max
        HH[i] = 0
        ii(i) = 0
    }
j = 1
SS = STARTP
HH[j] = STARTP
//    if ( MaeBuzaiNumber(SS) > 0 ) {
//        SS = MaeBuzaiNumber(SS)
//        HH[J] = SS
//    }
ii(SS) = 1
//    if ( AtoBuzaiNumber(Abs(ENDP)) > 0 ) {
//        ENDP = AtoBuzaiNumber(Abs(ENDP))
//    }
Dummy = 0
Do
    Dummy = Dummy + 1
    CheckP = SS
    Atta = 0
    For( i = 1 To 部材_max
        KK(i) = 0
    }
    For( i = 1 To 部材_max
        if ( CheckP != i $$ ii(i) = 0 ) {
            if ( BB = 0 ) {
                if ( 部J(CheckP) = 部I(i) ) {
                    Atta = Atta + 1
                    KK(Atta) = i
                    ii(i) = 1
                }
            } else {
                if ( 部I(CheckP) = 部J(i) ) {
                    Atta = Atta + 1
                    KK(Atta) = i
                    ii(i) = 1
                }
            }
        }
    }
    if ( Atta = 0 ) {
        BuzaiFF = -1
        return;
    } else {
        if ( Atta = 1 ) {
            Atta = KK(1)
        } else {
            角度1 = SuiHeiAngX(CheckP)
            if ( 角度1 >= 270 ) {
                角度1 = 360 - 角度1
            } else {if ( 角度1 >= 180 ) {
                角度1 = 角度1 - 90
            }
            角度3 = 9999
            k = Atta
            For( i = 1 To k //////////////複数の場合　ここで角度チェック 09/10/15
                AA = KK(i)
                角度2 = SuiHeiAngX(AA)
                if ( 角度2 >= 270 ) {
                    角度2 = 360 - 角度2
                } else {if ( 角度2 >= 180 ) {
                    角度2 = 角度2 - 90
                }
                if ( 角度3 > Abs(角度1 - 角度2) ) {
                    Atta = AA
                    角度3 = 角度2
                }
            }
        }
        j = j + 1
        HH[j] = Atta
//            II(J) = 1
        SS = Atta
        if ( Atta = Abs(Endp) || Dummy > (部材_max ^ 2) ) { Exit Do
        前BUZAI_No = Atta
    }
Loop
//
if ( Atta != Abs(Endp) ) {
    BuzaiFF = -1
    return;
}
//    BuzaiFF = 1
//    For( I = 1 To J - 1 ////////////////////////////////////////////////////////////////////////////繋がりが有るか
//        if ( HHShiten2(HH[I)) != HHShiten1(HH[I + 1)] ] {
//            BuzaiFF = 0
//            return;
//        }
//    }
BB = 0
CheckP = HH[1]
For( i = 1 To j
    BB = BB + 1
    GGGGG(BB) = HH[i]
}
BuzaiFF = BB
//
k角度一連 = True ////////10/03/07
角度1 = SuiHeiAngX(HH[1)] ////////09/10/20
For( i = 1 To j
    角度2 = SuiHeiAngX(HH[i)]
    if ( Abs(角度1 - 角度2) > 0.6 ) {
        k角度一連 = False
        Exit For
    }
    角度1 = 角度2
}

}

private void KAJYU_CHK2(GN As Integer)
var strG As String
//
strG = "* 実荷重データに誤りが有ります。" & vbCrLf & vbCrLf & "データＮｏ " & Trim(str(GN)) & " の部材に繋がりがありません。　　"
//
MsgBox strG, vbOKOnly, ""
//
//    Unload frmMain
//    this.MessClose
}

private Function 英語名(日本語名 As String, Optional FLG略語 As Integer = 0) As String

if ( 英語Mod = 0 ) {
    英語名 = 日本語名
    Exit Function
}

var i As Integer
var Pon As Integer

Pon = 1 //:翻訳あり
//スペースのみの行の場合翻訳をしない フラグ Pon = 0
if ( Pon > 0 ) {
    if ( Len(Trim(日本語名)) = 0 ) {
        Pon = -1 //:翻訳なし
    }
}

if ( Pon > 0 ) {
    Pon = -1
    var chOne As String
    For( i = 1 To Len(日本語名)
        chOne = Mid(日本語名, i, 1)
        //日本語が混ざっていれば
        if ( Asc(chOne) > 160 || Asc(chOne) < 0 ) {
            Pon = 1
            Exit For
        }
    }
}

if ( Pon > 0 ) {
    英語名 = Dictionary(日本語名, FLG略語)
} else {
    英語名 = 日本語名
}
}

private Function Dictionary(ByVal 日本語名 As String, Optional FLG略語 As Integer = 0) As String

    var tmp As String
    tmp = Replace(日本語名, "　", "dummy_string")   // 全角スペースを変換しないための処理1
    tmp = StrConv(日本語名, vbNarrow)               // すべて半角文字に変換
    tmp = Replace(日本語名, "dummy_string", "　")   // 全角スペースを変換しないための処理2
    tmp = fKanaHan2Zen(tmp)                         // カタカナのみ全角に変換

//////////20180409追加
////// インド

    //○着目点 ○算出点
    tmp = Replace(tmp, "左支点", IIf(FLG略語 = 0, "Left Supporting Point", "L-Supp.-P"))
    tmp = Replace(tmp, "右支点", IIf(FLG略語 = 0, "Right Supporting Point", "R-Supp.-P"))
    tmp = Replace(tmp, "左剛域端", IIf(FLG略語 = 0, "Left End of Rigid Area", "L-EP-RA"))
    tmp = Replace(tmp, "右剛域端", IIf(FLG略語 = 0, "Right End of Rigid Area", "R-EP-RA"))
    tmp = Replace(tmp, "剛域端", IIf(FLG略語 = 0, "the End of Rigid Area", "EP-RA"))
    tmp = Replace(tmp, "左柱前面", IIf(FLG略語 = 0, "Supporting Point of Left Column top front", "L-Ctf-Supp.-P"))
    tmp = Replace(tmp, "右柱前面", IIf(FLG略語 = 0, "Supporting Point of Right Column top front", "R-Ctf-Supp.-P"))
    tmp = Replace(tmp, "柱前面", IIf(FLG略語 = 0, "Supporting Point of Column top front", "Ctf-Supp.-P"))
    tmp = Replace(tmp, "左ハンチ始点", IIf(FLG略語 = 0, "Beginning Point of Left Haunch", "L-Haunch-BP"))
    tmp = Replace(tmp, "右ハンチ始点", IIf(FLG略語 = 0, "Beginning Point of Right Haunch", "R-Haunch-BP"))
    tmp = Replace(tmp, "スパン中央", IIf(FLG略語 = 0, "the Center of Span", "Span Center"))
    tmp = Replace(tmp, "上端", IIf(FLG略語 = 0, "Upper End", "Upper End"))
    tmp = Replace(tmp, "下端", IIf(FLG略語 = 0, "Lower End", "Lower End"))
    tmp = Replace(tmp, "杭頭", IIf(FLG略語 = 0, "Pile Head", "Pile Head"))
    tmp = Replace(tmp, "地中部", IIf(FLG略語 = 0, "Underground Part", "Underground"))
    tmp = Replace(tmp, "左H/2点", IIf(FLG略語 = 0, "Left Point of H/2", "L-H/2-P"))
    tmp = Replace(tmp, "右H/2点", IIf(FLG略語 = 0, "Right Point of H/2", "R-H/2-P"))
    tmp = Replace(tmp, "上H/2点", IIf(FLG略語 = 0, "Upper Point of H/2", "Up-H/2-P"))
    tmp = Replace(tmp, "下H/2点", IIf(FLG略語 = 0, "Left Point of 1.5H", "Low-H/2-P"))
    tmp = Replace(tmp, "H/2点", IIf(FLG略語 = 0, "the Point of H/2", "H/2-P"))
    tmp = Replace(tmp, "左1.5H点", IIf(FLG略語 = 0, "Left Point of 1.5H", "L-1.5H-P"))
    tmp = Replace(tmp, "右1.5H点", IIf(FLG略語 = 0, "Right Point of 1.5H", "R-1.5H-P"))
    tmp = Replace(tmp, "上2D区間", IIf(FLG略語 = 0, "Upper 2D Area", "Up-2D Area"))
    tmp = Replace(tmp, "下2D区間", IIf(FLG略語 = 0, "Lower 2D Arear", "Low-2D Area"))
    tmp = Replace(tmp, "集中荷重点", IIf(FLG略語 = 0, "the Point of Concentrated load", "CL-P"))
    tmp = Replace(tmp, "梁下面", IIf(FLG略語 = 0, "bottom of beam", "Beam-Bottom-P"))
    tmp = Replace(tmp, "梁上面", IIf(FLG略語 = 0, "top of beam", "Beam-Top-P"))
    tmp = Replace(tmp, "杭受台前面", IIf(FLG略語 = 0, "supporting point at front of Pile Cap", "PileCap-P"))
    tmp = Replace(tmp, "梁前面", IIf(FLG略語 = 0, "supporting point at front of beam", "Beam-Supp.-P"))

// 20180521 追加分
    tmp = Replace(tmp, "断面諸元", "Sectional Data of Members") // 20180521 追加分
    tmp = Replace(tmp, "剛域データ", "Rigid Area Data")         // 20180521 追加分
    tmp = Replace(tmp, "車両種別", "Train Type")            // 20180521 追加分
    tmp = Replace(tmp, "P標準活荷重", "P Train Load")       // 20180521 追加分
    tmp = Replace(tmp, "編成数", "Train Set")               // 20180521 追加分
    tmp = Replace(tmp, "計算ピッチ", "Calculation Pitch")   // 20180521 追加分
    tmp = Replace(tmp, "車両軸重", "Axel Load ")            // 20180521 追加分
    tmp = Replace(tmp, "先頭車両", "Front Car")             // 20180521 追加分
    tmp = Replace(tmp, "中間車両", "Middle Car")            // 20180521 追加分
    tmp = Replace(tmp, "後尾車両", "Rear End Car")          // 20180521 追加分
    tmp = Replace(tmp, "車両全長", "Length of the Car")     // 20180521 追加分
    tmp = Replace(tmp, "軸距(a連結部）", "Axial Length (Connector)")  // 20180521 追加分
    // 20180521 追加分
    var sp As Integer, ep As Integer, ep1 As Integer, tmp_string As String
    sp = InStr(tmp, "軸距")
    if ( sp ) {
        ep = InStr(sp, tmp, "(")
        if ( ep ) {
            ep1 = InStr(ep, tmp, ")")
            if ( ep1 ) { ep = ep1
            tmp_string = Mid(tmp, sp, ep - sp + 1)
        } else {
            tmp_string = "軸距"
        }
        tmp = Replace(tmp, tmp_string, "Axial Length")
    }

    tmp = Replace(tmp, "", "")

    //○部材名
    tmp = Replace(tmp, "上層梁", "Upper Beam")
    tmp = Replace(tmp, "中層梁", "Middle Layer Beam")
    tmp = Replace(tmp, "地中梁", IIf(FLG略語 = 0, "Underground Beam", "Unde-Beam"))     // 20180524 変更分
    tmp = Replace(tmp, "縦小梁", "Longitudinal Collar Beam")    // 20180521 追加分
    tmp = Replace(tmp, "梁", "Beam")
    tmp = Replace(tmp, "柱", "Column")
    tmp = Replace(tmp, "フーチング（直接基礎の場合）", "Footing (Spread Foundation)")
    tmp = Replace(tmp, "フーチング（杭基礎の場合）", "Pile Cap")
    tmp = Replace(tmp, "杭", "Pile")
    tmp = Replace(tmp, "剛域", "Rigid Area")
    tmp = Replace(tmp, "壁", "Wall")
    tmp = Replace(tmp, "埋込部", "Embedded part")

    //○荷重名称

    tmp = Replace(tmp, "固定死荷重", "Fixed Dead Load")
    tmp = Replace(tmp, "付加死荷重", "Additional Dead Load")
    tmp = Replace(tmp, "ロングレール縦荷重", "Long Rail Longitudinal Load")
    tmp = Replace(tmp, "制動荷重", "Braking Load")
    tmp = Replace(tmp, "始動荷重", "Traction Load")
    tmp = Replace(tmp, "遠心荷重", "Centrifugal Load")
    tmp = Replace(tmp, "車両横荷重", "Rolling Stock Lateral Load")
    tmp = Replace(tmp, "群衆荷重", "Crowd Load")
    tmp = Replace(tmp, "主たる風荷重", "Wind Load（Primary）")
    tmp = Replace(tmp, "従たる風荷重", "Wind Load（Secondary）")
    tmp = Replace(tmp, "風荷重", "Wind Load ")                  // 20180410 追加
    tmp = Replace(tmp, "従たる変動荷重時", "Secondary")         // 20180521 追加分
    tmp = Replace(tmp, "主たる変動荷重時", "Primary")           // 20180521 追加分
    tmp = Replace(tmp, "風", "Wind")                            // 20180410 追加
    tmp = Replace(tmp, "死荷重地震", "Dead Load (Seismic)")
    tmp = Replace(tmp, "列車荷重地震時　鉛直", "Train Load（Seismic:vertical）")
    tmp = Replace(tmp, "列車荷重地震時　水平", "Train Load（Seismic:horizontal）")
    tmp = Replace(tmp, "列車荷重地震時", "Train Load（Seismic）")
    tmp = Replace(tmp, "列車荷重地震", "Train Load（Seismic）")         // 20180409 追加
    tmp = Replace(tmp, "連行荷重", "Travelling Load")                   // 20180521 追加分
    tmp = Replace(tmp, "列車荷重+衝撃", "Train Load + Impact Load")     // 20180521 追加分
    tmp = Replace(tmp, "列車荷重", "Train Load")
    tmp = Replace(tmp, "衝撃荷重", "Impact Load")
    tmp = Replace(tmp, "温度変化", "Change Of Temperature")
    tmp = Replace(tmp, "乾燥収縮", "Drying Shrinkage")
    tmp = Replace(tmp, "浮力（高水位）", "Buoyancy（High Water Level）")
    tmp = Replace(tmp, "浮力（平水位）", "Buoyancy（Normal Water Level）")
    tmp = Replace(tmp, "浮力（低水位）", "Buoyancy（Low Water Level）")
    tmp = Replace(tmp, "電柱荷重", "Power Pole Load")
    tmp = Replace(tmp, "建築上屋荷重地震時", "Platform Shed Load（Seismic）")
    tmp = Replace(tmp, "建築上屋荷重地震", "Platform Shed Load（Seismic）") // 20180410 追加
    tmp = Replace(tmp, "建築上屋荷重", "Platform Shed Load")
    tmp = Replace(tmp, "上屋荷重", "Platform Shed Load")                    // 20180410 追加
    tmp = Replace(tmp, "上屋", "Platform Shed Load")                        // 20180410 追加
    tmp = Replace(tmp, "鉛直群集荷重（地震時）", "Crowd Load (Seismic:vertical)")
    tmp = Replace(tmp, "水平群集荷重（地震時）", "Crowd Load (Seismic:horizontal)")
    tmp = Replace(tmp, "全断面剛性", "Full Stiffness")
    tmp = Replace(tmp, "全線", "All Lines")
    tmp = Replace(tmp, "複線", "Double Track")
    tmp = Replace(tmp, "単線", "Single Track")
    tmp = Replace(tmp, "待避線", "Storage Line")
    tmp = Replace(tmp, "下り副本線", "Loop Line(Down Line)")
    tmp = Replace(tmp, "下り本線", "Main Line(Down Line)")
    tmp = Replace(tmp, "上り本線", "Main Line(Up Line)")
    tmp = Replace(tmp, "上り副本線", "Loop Line(Up Line)")
    //○組合せ荷重名称

    tmp = Replace(tmp, "公衆安全性", "Public Safety")                                           // 20180521 追加分
    tmp = Replace(tmp, "安全性", "Safety")
    tmp = Replace(tmp, "使用性", "Serviceability")
    tmp = Replace(tmp, "復旧性", "Restorability")
    tmp = Replace(tmp, "耐久性", "Durability")
    tmp = Replace(tmp, "疲労破壊", "Fatigue Failure")
    tmp = Replace(tmp, "破壊", "Failure")
    tmp = Replace(tmp, "走行安全性", "Running Safty")
    tmp = Replace(tmp, "外観", "Aesthetic Appearance")
    tmp = Replace(tmp, "損傷（地震時以外）", "Damage(Nonseismic)")
    tmp = Replace(tmp, "損傷（地震時）", "Damage(Seismic)")
    tmp = Replace(tmp, "損傷", "Damage")                                                        // 20180521 追加分
    tmp = Replace(tmp, "長期支持性能", "Long Term Bearing Capacity")
    tmp = Replace(tmp, "短期支持性能", "Short Term Bearing Capacity")
    tmp = Replace(tmp, "列車荷重最大", "Case : Train Road is Max.")
    tmp = Replace(tmp, "列車最大", "Case : Train Road is Max.")                                 // 20180521 追加分
    tmp = Replace(tmp, "制動荷重最大", "Case : Braking Road is max.")
    tmp = Replace(tmp, "制動最大", "Case : Braking Road is Max.")                               // 20180521 追加分
    tmp = Replace(tmp, "ロングレール縦荷重最大", "Case : Long Rail Longitudinal Load is Max.")
    tmp = Replace(tmp, "ロングレール最大", "Case : Long Rail Longitudinal Load is Max.")        // 20180521 追加分
    tmp = Replace(tmp, "群衆荷重最大", "Case : Crowd Load is Max")
    tmp = Replace(tmp, "群集最大", "Case : Crowd Load is Max")                                  // 20180521 追加分
    tmp = Replace(tmp, "縁応力度", "Extreme Fiber Stress")                                      // 20180521 変更分
    tmp = Replace(tmp, "永久荷重", "Permanent Load")
    tmp = Replace(tmp, "変動荷重", "Variable Load")
    tmp = Replace(tmp, "永久+変動", "Permanent Load + Variable Load")   // 20180521 追加分
    tmp = Replace(tmp, "安定計算", "Verification of Stability")
    //○断面形状
    tmp = Replace(tmp, "矩形", "Rectanglar Section")
    tmp = Replace(tmp, "Ｔ形", "T Section")
    tmp = Replace(tmp, "円形", "Circular Cross Section")
    tmp = Replace(tmp, "台形", "Trapezoidale Section")
    tmp = Replace(tmp, "小判", "Oval Section")
    //○環境条件
    tmp = Replace(tmp, "一般", "Moderate")
    tmp = Replace(tmp, "腐食性", "Severe")
    tmp = Replace(tmp, "とくに厳しい環境", "Extreme")

    tmp = Replace(tmp, "長期sprg", "Long Term sprg")                                            // 20180521 追加分
    tmp = Replace(tmp, "短期sprg", "Short Term sprg")                                           // 20180521 追加分
    tmp = Replace(tmp, "地震時sprg", "Seismic sprg")                                            // 20180521 追加分

    tmp = Replace(tmp, "軸 線 図", "Frame model")
    tmp = Replace(tmp, "衝撃", "Impact load")
    tmp = Replace(tmp, "使用", "Serviceability")
    tmp = Replace(tmp, "疲労", "Fatigue Failure")
    tmp = Replace(tmp, "従たる", "Secondary ")
    tmp = Replace(tmp, "主たる", "Primary ")
    tmp = Replace(tmp, "温度上昇", "Change Of Temperature")
    tmp = Replace(tmp, "地震時以外", "Nonseismic")
    tmp = Replace(tmp, "常時", "Nonseismic")
    tmp = Replace(tmp, "地震時", "Seismic")
    tmp = Replace(tmp, "その", "")
    tmp = Replace(tmp, "時", "")

    sp = InStr(tmp, "浮")
    if ( sp ) {
        ep = InStr(sp, tmp, "力")
        tmp_string = Mid(tmp, sp, ep - sp + 1)
        tmp = Replace(tmp, tmp_string, "Buoyancy")
    }

//////////応力図
    tmp = Replace(tmp, "　曲げモーメント図", "  Bending Moment")
    tmp = Replace(tmp, "　せん断力図", "  Shear force")
    tmp = Replace(tmp, "　軸　力　図", "  Axial force")
    tmp = Replace(tmp, "　変　位　図  (㎜)", "Displacement (㎜)")
    tmp = Replace(tmp, "　変　位　図", "  Displacement")
    //
    tmp = Replace(tmp, "荷 重 図", "Diagram of load conditions")
    tmp = Replace(tmp, "車両載荷状態図", "Diagram of load conditions")
    tmp = Replace(tmp, "構造物のモデル化", "Frame model")
    tmp = Replace(tmp, "骨 組 図", "Frame model")
//////////入力
    tmp = Replace(tmp, "SI単位系", "SI Unit")

    tmp = Replace(tmp, "杭頭 弾性反力 上限値", "Bearing capacity at head", , , vbTextCompare) //"Bearing capacity at head of single pile")
    tmp = Replace(tmp, "杭先端 弾性反力 上限値", "Bearing capacity at toe", , , vbTextCompare) //"Bearing capacity at toe of single pile")
    tmp = Replace(tmp, "押込み力", "Pushing Force")                                             // 20180521 変更分
    tmp = Replace(tmp, "引抜き力", "Pulling Force")                                             // 20180521 変更分
    tmp = Replace(tmp, "鉛直バネ", "Vertical")
    tmp = Replace(tmp, "せん断バネ", "Horizontal")
    tmp = Replace(tmp, "回転バネ", "Rotation")
//////////変位
    tmp = Replace(tmp, "杭 の 変位量 弾性反力", "Displacement $$ reaction of pile")
    tmp = Replace(tmp, "変  位  量", "Displacement")
    tmp = Replace(tmp, "塑性域", "Plastic") //"Plastic zone"
    tmp = Replace(tmp, "位  置", "Depth")
    tmp = Replace(tmp, "水 平 方 向", "Horizonal direction")
    tmp = Replace(tmp, "鉛 直 方 向", "Vertical direction")
    tmp = Replace(tmp, "水平変位量", "Displacement")
    tmp = Replace(tmp, "地盤バネ", "Spring")
    tmp = Replace(tmp, "弾性反力", "Reaction") //"Elastic reaction")
    tmp = Replace(tmp, "鉛直変位量", "Displacement")

    tmp = Replace(tmp, "上部工反力", "Reaction to loads from superstructure")
    tmp = Replace(tmp, "A支点最大", "Maximum reaction at support A")
    tmp = Replace(tmp, "B支点最大", "Maximum reaction at support B")
    tmp = Replace(tmp, "C支点最大", "Maximum reaction at support C")
    tmp = Replace(tmp, "D支点最大", "Maximum reaction at support D")
    tmp = Replace(tmp, "地震時列車荷重", "Seismic train load ")
    tmp = Replace(tmp, "全載荷", "All-track loading")

    tmp = Replace(tmp, "荷 重 状 態", "Name of Load")
    tmp = Replace(tmp, "杭先端バネ", "Spring constant at toe")
    tmp = Replace(tmp, "杭周囲バネ", "Spring constant")
    tmp = Replace(tmp, "地盤水平バネ", "Spring") //"Design spring constant in horizontal direction")
    tmp = Replace(tmp, "有効抵抗土圧", IIf(FLG略語 = 0, "Effective resistance earth pressure", "Limit"))
    tmp = Replace(tmp, "1本当り", "Per one")
    tmp = Replace(tmp, "１本当り", "Per one")
    tmp = Replace(tmp, "地層", "Stratum")
    tmp = Replace(tmp, "層 厚", "Thickness")
    tmp = Replace(tmp, "長期使用以外", "Except LTSLS") //"Limit states except long term serviceability limit state")
    tmp = Replace(tmp, "一　時", "Except LTSLS")
    tmp = Replace(tmp, "長期使用", "LTSLS") //"Long term serviceability limit state")
    tmp = Replace(tmp, "常　時", "LTSLS")
    tmp = Replace(tmp, "層 厚", "Thickness")
    tmp = Replace(tmp, "応答変位", "Displacement") //"Horizontal displacement"
    tmp = Replace(tmp, "変位荷重", "Displacement")

//        tmp = Replace(tmp, "ﾏｰｸ", "Mark")
//        tmp = Replace(tmp, "断面二次ﾓｰﾒﾝﾄ", "Inertia") //Moment of inertia
    tmp = Replace(tmp, "マーク", "Mark")
    tmp = Replace(tmp, "断面二次モーメント", "Inertia") //Moment of inertia
    tmp = Replace(tmp, "断 面 積", "Area")
    tmp = Replace(tmp, "膨張係数", "CTE") //Coefficient of Thermal Expansion
    tmp = Replace(tmp, "弾性係数", "Elastic") //Elastic modulus
//
    if ( InStr(日本語名, "部材直角方向") != 0 || InStr(日本語名, "部材軸方向") != 0 ) {
        tmp = "": GoTo GRF5
    }
    if ( InStr(日本語名, "剛 域 デ ー タ") != 0 ) {
        tmp = "<< Rigid zone >>": GoTo GRF5
    }
    if ( InStr(日本語名, "剛域部材長") != 0 ) {
        tmp = "Distance (m)": GoTo GRF5
    }
    if ( InStr(日本語名, "I端側") != 0 ) {
        tmp = " I-side": GoTo GRF5
    }
    if ( InStr(日本語名, "J端側") != 0 ) {
        tmp = " J-side": GoTo GRF5
    }

    tmp = Replace(tmp, "非線形解析", "Nonlinear")
    tmp = Replace(tmp, "合成荷重", "Composite Load")

    tmp = Replace(tmp, "荷 重 名 称", "Name of Load")
    tmp = Replace(tmp, "荷　重　名　称", "Name of Load")
    tmp = Replace(tmp, "構造系条件", "Structural Condition")
    tmp = Replace(tmp, "割増係数", "C.F") //Compensation factor
//        tmp = Replace(tmp, "ｽﾀｰﾄ", "First")
//        tmp = Replace(tmp, "ｴﾝﾄﾞ", "Last")
    tmp = Replace(tmp, "スタート", "First")
    tmp = Replace(tmp, "エンド", "Last")
    tmp = Replace(tmp, "部材番号", "Member No")
    tmp = Replace(tmp, "部材荷重", "Member Load")
    tmp = Replace(tmp, "節点番号", "Joint No")
    tmp = Replace(tmp, "節点荷重", "Joint Load")
    tmp = Replace(tmp, "基本荷重", "Basic Load")
    tmp = Replace(tmp, "実荷重", "Loads")
    tmp = Replace(tmp, "タイプ", "TYPE")

    tmp = Replace(tmp, "地 盤", "Spring") //"Modeling of ground")
    tmp = Replace(tmp, "バネ", "Sprg")
    tmp = Replace(tmp, "断面", "Sect")
    tmp = Replace(tmp, "支点", "Suprt")
    tmp = Replace(tmp, "結合", "Joi")

    tmp = Replace(tmp, "記号", "Symbol")
    tmp = Replace(tmp, "合成", "Comp")

    tmp = Replace(tmp, "変化点", "Point")
    tmp = Replace(tmp, "着目点", "Location")

    tmp = Replace(tmp, "格点番号", "Joint No")
    tmp = Replace(tmp, "格 点", "Joint")
    tmp = Replace(tmp, "格点", "Joint")

    tmp = Replace(tmp, "部材数", "Nunbers")
    tmp = Replace(tmp, "部材名", "Name")
    tmp = Replace(tmp, "部材長", "Distance")
    tmp = Replace(tmp, "部 材", "Member")
    tmp = Replace(tmp, "部材", "Member")

    tmp = Replace(tmp, "線路直角方向", "Transverse direction")
    tmp = Replace(tmp, "線路方向", "Longitudinal direction")
    tmp = Replace(tmp, "直角方向", "Transverse")
    tmp = Replace(tmp, "線路", "Lg")
    tmp = Replace(tmp, "直角", "Tr")

    tmp = Replace(tmp, "上層梁", IIf(FLG略語 = 0, "Upper Beam", "Up-Beam"))
    tmp = Replace(tmp, "中層梁", IIf(FLG略語 = 0, "Int. Beam", "Md-Beam"))
    tmp = Replace(tmp, "梁", "Beam")
    tmp = Replace(tmp, "上床版", IIf(FLG略語 = 0, "Upper Slab", "Up-Slab"))
    tmp = Replace(tmp, "中床版", IIf(FLG略語 = 0, "Int. Slab", "Md-Slab")) //"Middle Slab", "Md-Slab"))
    tmp = Replace(tmp, "下床版", IIf(FLG略語 = 0, "Lower Slab", "Bt-Slab")) ////////Bottom

    tmp = Replace(tmp, "フーチング", "Footing")
    tmp = Replace(tmp, "杭頭", "Pile head")
    tmp = Replace(tmp, "矩形", IIf(FLG略語 = 0, "Rectangle", "Rect"))

    tmp = Replace(tmp, "埋込み", "Rigid zone of Pile head")

    tmp = Replace(tmp, "RC連壁", "D-wall") // "Diaphragm wall") ////IIf(FLG略語 = 0, "Wall in Underground", "Unde-Wall"))
    tmp = Replace(tmp, "連壁", "D-wall") //////"Diaphragm wall") //
    tmp = Replace(tmp, "RC中壁", "Int. wall")
//        TMP = Replace(TMP, "中壁", "Middle wall")

    tmp = Replace(tmp, "く体", "Column")
    tmp = Replace(tmp, "ＲＣ柱", "Column")
    tmp = Replace(tmp, "RC柱", "Column")
    tmp = Replace(tmp, "柱", "Column")
    tmp = Replace(tmp, "剛域", IIf(FLG略語 = 0, "Rigid", "Rigid")) ////"Rigid zone",
    tmp = Replace(tmp, "杭", "Pile")

    tmp = Replace(tmp, "分割数", "Number")
    tmp = Replace(tmp, "深 度", "Depth")
    tmp = Replace(tmp, "位 置", "Depth")
    tmp = Replace(tmp, "水 平", "Horizonal")
    tmp = Replace(tmp, "鉛 直", "Vertical")

    tmp = Replace(tmp, "名 　　称", "Name of Load")
    tmp = Replace(tmp, "節 点 荷 重", "Joint Load")
    tmp = Replace(tmp, "弾塑", "Nonlinear")
    tmp = Replace(tmp, "荷 重", "Load")
    tmp = Replace(tmp, "節点", "Joint")
    tmp = Replace(tmp, "番号", "No.")

    tmp = Replace(tmp, "層", "Stratum")

////着目点名
    tmp = Replace(tmp, "集中", "CL-P")  //""
    tmp = Replace(tmp, "スパン中央", "C-Span") //"Center")
    if ( InStr(日本語名, "ﾊﾝﾁ") != 0 || InStr(日本語名, "ハンチ") != 0 ) {
        tmp = "Haunch": GoTo GRF5 //////"hunt"
    }
    tmp = Replace(tmp, "上h/2", "Up-h/2") //////Upper
    tmp = Replace(tmp, "中h/2", "Ce-h/2")
    tmp = Replace(tmp, "下h/2", "Dw-h/2")

    tmp = Replace(tmp, "左h/2", "L-h/2") //////Left
    tmp = Replace(tmp, "右h/2", "R-h/2") //////Right

    tmp = Replace(tmp, "側壁前面", "Front") //////"Side wall")
    tmp = Replace(tmp, "中壁前面", "Front") //////"Wall")
    tmp = Replace(tmp, "中前面", "Front") //////"Ce-wall")
    tmp = Replace(tmp, "壁前面", "Front") //////"Front wall")
    tmp = Replace(tmp, "前面", "Front") //////"Front column"
    tmp = Replace(tmp, "中壁", "Int. wall") ////"Middle wall")
    tmp = Replace(tmp, "側壁", "Side wall")

    tmp = Replace(tmp, "基礎上面", "Bottom") //////"Bottom of column")

    tmp = Replace(tmp, "左", "L-")
    tmp = Replace(tmp, "右", "R-")

////反力
    tmp = Replace(tmp, "反  力", "Reaction")
//
//13/05/20
        if ( InStr(日本語名, "固定死荷重") != 0 ) {
            tmp = Replace(tmp, "固定死荷重", "Fixed dead load ")
//                GoTo GRF5
        }
        if ( InStr(日本語名, "付加死荷重") != 0 ) {
            tmp = Replace(tmp, "付加死荷重", "Additional dead load ")
            GoTo GRF5
        }
        if ( InStr(日本語名, "死荷重") != 0 ) {
            tmp = Replace(tmp, "死荷重", "Dead load ")
            GoTo GRF5
        }
        tmp = Replace(tmp, "建物荷重", "Polarized earth pressure of building load ")
//            if ( InStr(日本語名, "鉛直土圧") != 0 $$ InStr(日本語名, "永久") != 0 ) {
//                tmp = "Earth Vertical Pressure as permanent loads": GoTo GRF5
//            }
        tmp = Replace(tmp, "鉛直土圧（永久荷重）", "Earth Vertical Pressure as permanent loads ")

//            if ( InStr(日本語名, "水平土圧") != 0 $$ InStr(日本語名, "永久") != 0 ) {
//                tmp = "Earth Lateral Pressure as permanent loads": GoTo GRF5
//            }
        tmp = Replace(tmp, "水平土圧（永久荷重）", "Earth Lateral Pressure as permanent loads ")
        //
//            if ( InStr(日本語名, "変動荷重による鉛直荷重") != 0 ) {
//                TMP = "Earth Vertical Pressure as variable loads ": GoTo GRF5
//            }
        tmp = Replace(tmp, "変動荷重による鉛直荷重", "Earth Vertical Pressure as variable loads ")
//            if ( InStr(日本語名, "変動荷重による水平荷重") != 0 ) {
//                TMP = "Earth Lateral Lateral as variable loads ": GoTo GRF5
//            }
        tmp = Replace(tmp, "変動荷重による水平荷重", "Earth Lateral Lateral as variable loads ")
//            if ( InStr(日本語名, "列車") != 0 $$ InStr(日本語名, "衝撃") != 0 ) {
//                TMP = "Train load $$ impact load": GoTo GRF5
//            }
        tmp = Replace(tmp, "列車荷重衝撃", "Train load $$ impact load ")
        if ( InStr(日本語名, "ロング") != 0 $$ InStr(日本語名, "制動") != 0 ) {
//                TMP = "Long rail load $$ Braking load ": GoTo GRF5
            tmp = Replace(tmp, "ロングレール縦荷重+制動荷重", "Long rail load $$ Braking load ")
            tmp = Replace(tmp, "ロングレール縦荷重＋制動荷重", "Long rail load $$ Braking load ")
        }
        tmp = Replace(tmp, "ロングレール縦荷重", "Long rail load ")
        tmp = Replace(tmp, "制動縦荷重", "Long rail load ")

        tmp = Replace(tmp, "プレストレス力", "Prestressing ") //12/06/244
        tmp = Replace(tmp, "プレストレス", "Prestressing ") //12/06/244
//            tmp = Replace(tmp, "ﾌﾟﾚｽﾄﾚｽ力", "Prestressing ")
//            tmp = Replace(tmp, "ﾌﾟﾚｽﾄﾚｽ", "Prestressing ")

        tmp = Replace(tmp, "地震時慣性力", "Seismic inertial force ")
        tmp = Replace(tmp, "地震時列車荷重（鉛直力）", "Earthguake train load  Vertical force ")
        tmp = Replace(tmp, "地震時列車荷重（水平力）", "Earthguake train load  Horizontal force ")
        tmp = Replace(tmp, "周面せん断力", "Peripheral surface shear force ")
        if ( InStr(日本語名, "地盤変位荷重") != 0 ) {
//            tmp = Replace(tmp, "地盤変位荷重", "Ground displacement load")
            tmp = "Ground displacement load"
        }
//            tmp = Replace(tmp, "列車荷重", "Train load ")
//            tmp = Replace(tmp, "衝撃荷重", "Impact load ")
            tmp = Replace(tmp, "永久荷重", "permanent action ")
            tmp = Replace(tmp, "変動荷重", "Variable action ")
            tmp = Replace(tmp, "群集荷重", "Crowd load ") //////////////11/11/16
            tmp = Replace(tmp, "電柱荷重", "Pole load ")
            tmp = Replace(tmp, "列車荷重", "Train load ")
            tmp = Replace(tmp, "鉛直荷重", "Vertical load ")
            tmp = Replace(tmp, "衝撃荷重", "Impact load ")
            tmp = Replace(tmp, "始動荷重", "Starting load ")
            tmp = Replace(tmp, "動輪荷重", "Axial load ")
            tmp = Replace(tmp, "制動荷重", "Braking load ")
            tmp = Replace(tmp, "上載荷重", "Load on Substructure ")
            tmp = Replace(tmp, "遠心荷重", "Centrifugal load")
            tmp = Replace(tmp, "車両横荷重", "Rolling stock lateral load ")
            tmp = Replace(tmp, "分布荷重", "Distributed load ")
            tmp = Replace(tmp, "水平荷重", "Horizontal load ")

        tmp = Replace(tmp, "風荷重 列車有り", "Wind load while train running ")
        tmp = Replace(tmp, "風荷重 列車なし", "Wind load while no train running ")
        tmp = Replace(tmp, "風荷重", "Wind load")
        tmp = Replace(tmp, "列車有り", " while train running ")
        tmp = Replace(tmp, "列車有", " while train running ")
        tmp = Replace(tmp, "列車載荷", " while train running ")
        tmp = Replace(tmp, "列車なし", " while no train running ")
        tmp = Replace(tmp, "列車無し", " while no train running ")
        tmp = Replace(tmp, "列車無", " while no train running ")
        tmp = Replace(tmp, "列車", "Train")

//            if ( InStr(日本語名, "水") != 0 $$ InStr(日本語名, "圧") != 0 ) {
//                if ( InStr(日本語名, "低水位") != 0 ) {
//                    TMP = "Water pressure (Low water level) ": GoTo GRF5
//                } else {if ( InStr(日本語名, "高水位") != 0 ) {
//                    if ( InStr(日本語名, "高高水位") != 0 ) {
//                        TMP = "Water pressure (HHigh water level) "
//                    } else {
//                        TMP = "Water pressure (High water level) "
//                    }
//                    GoTo GRF5
//                } else {if ( InStr(日本語名, "平水位") != 0 ) {
//                    TMP = "Water pressure (ordinary water level) ": GoTo GRF5
//                } else {
//                    tmp = "Water pressure"
                tmp = Replace(tmp, "水圧", "Water pressure ")
//                }
//                GoTo GRF5
//            }
//            if ( InStr(日本語名, "浮") != 0 $$ InStr(日本語名, "力") != 0 ) {
//                if ( InStr(日本語名, "低水位") != 0 ) {
//                    TMP = "Buoyancy (L.G.W.L.)"
//                } else {if ( InStr(日本語名, "高水位") != 0 ) {
//                    if ( InStr(日本語名, "高高水位") != 0 ) {
//                        TMP = "Buoyancy (H.H.G.W.L.) "
//                    } else {
//                        TMP = "Buoyancy (H.G.W.L.) "
//                    }
//                } else {if ( InStr(日本語名, "平水位") != 0 ) {
//                    TMP = "Buoyancy (M.G.W.L.) "
//                } else {
//                    TMP = "Buoyancy (G.W.L.) "
//                }
//                GoTo GRF5
//            }
        tmp = Replace(tmp, "低水位", "Low water level ")
        tmp = Replace(tmp, "高水位", "High water level ")
        tmp = Replace(tmp, "高高水位", "HHigh water level ")
        tmp = Replace(tmp, "平水位", "ordinary water level ")
        sp = InStr(tmp, "平")
        if ( sp ) {
            if ( InStr(sp, tmp, "water level") ) { tmp = Replace(tmp, "平", "ordinary water level ")
        }
        tmp = Replace(tmp, "鉛直", "Vertical")
        tmp = Replace(tmp, "水平", "Horizontal")

//            tmp = Replace(tmp, "(低水位)", " (Low water level) ")
//            tmp = Replace(tmp, "(高水位)", " (High water level) ")
//            tmp = Replace(tmp, "(高高水位)", " (HHigh water level) ")
//            tmp = Replace(tmp, "(平水位)", " (ordinary water level) ")
        //
//            tmp = Replace(tmp, "（低水位）", " (Low water level) ")
//            tmp = Replace(tmp, "（高水位）", " (High water level) ")
//            tmp = Replace(tmp, "（高高水位）", " (HHigh water level) ")
//            tmp = Replace(tmp, "（平水位）", " (ordinary water level) ")
//            tmp = Replace(tmp, "高高水位", "Buoyancy (H.H.G.W.L.) ")
//
//            tmp = Replace(tmp, "高水位", "Buoyancy (H.G.W.L.) ")
//            tmp = Replace(tmp, "低水位", "Buoyancy (L.G.W.L.) ")
//            tmp = Replace(tmp, "平水位", "Buoyancy (M.G.W.L.) ")

        tmp = Replace(tmp, "長期使用", "Long term serviceability")
        if ( InStr(日本語名, "安全性") != 0 $$ InStr(日本語名, "疲労") != 0 ) {
            tmp = "Safety for( fatigue failure": GoTo GRF5
        }
        if ( InStr(日本語名, "安全性") != 0 $$ InStr(日本語名, "破壊") != 0 ) {
            tmp = "Safety for( failure": GoTo GRF5
        }
        if ( InStr(日本語名, "使用性") != 0 $$ InStr(日本語名, "縁") != 0 ) {
            tmp = "Serviceability for( stress of concrete": GoTo GRF5 //////"Serviceability Extreme fiber stress"
        }
        if ( InStr(日本語名, "使用性") != 0 $$ InStr(日本語名, "永久") != 0 ) {
            tmp = "Serviceability permanent loads": GoTo GRF5 ////////(PA)
        }
        if ( InStr(日本語名, "使用性") != 0 $$ InStr(日本語名, "変動") != 0 ) {
            tmp = "Serviceability variable loads": GoTo GRF5 ////////(PA)
        }
        if ( InStr(日本語名, "使用性") != 0 $$ InStr(日本語名, "鉛直支持") != 0 ) {
            tmp = "Serviceability vertical bearing": GoTo GRF5
        }
        tmp = Replace(tmp, "(疲労破壊)", "for( fatigue")

        if ( InStr(日本語名, "復旧性") != 0 $$ InStr(日本語名, "損傷常時") != 0 ) {
            tmp = "Restorability damage permanent": GoTo GRF5 ////////(PA) "Restorability (usual)"
        }
        if ( InStr(日本語名, "復旧性") != 0 $$ InStr(日本語名, "地震") != 0 ) {
            tmp = "Seismic": GoTo GRF5 ////////(PA)
        }
        tmp = Replace(tmp, "耐震検討", "Seismic design")

//        if ( tmp = 日本語名 ) {
//            tmp = ベトナム(日本語名, FLG略語)
//        }
GRF5:
    Dictionary = tmp

}

Public Function Replace _
(ByVal PsExpression As String, _
ByVal PsFind As String, ByVal PsReplaceWith As String, _
Optional ByVal PlStart As Long = 1, _
Optional ByVal PlCount As Long = -1, _
Optional ByVal PlCompare As VbCompareMethod = -1) As String

var lExpLen As Long         // 置換元の文字列の長さ
var lFindLen As Long        // 検索文字列の長さ
var lRepLen As Long         // 置換文字列の長さ
var lFindPos As Long        // 検索開始位置
var lRet As Long            // 検索文字列の発見位置
var sReplaced As String     // 置換後の文字列格納用文字列
var lRealCount As Long      // 実際の置換回数
var lDiffLen                // 検索文字列、置換文字列の長さの差分

// 置換元の文字列、検索文字列、置換文字列の長さを求めておく
lExpLen = Len(PsExpression)
lFindLen = Len(PsFind)
lRepLen = Len(PsReplaceWith)

// 入力チェック
if ( PlStart < 1 ) { Err.Raise 5
if ( lExpLen = 0 || PlStart > lExpLen ) { Replace = "": Exit Function
if ( lFindLen = 0 || PlCount = 0 ) { Replace = PsExpression: Exit Function
if ( PsFind = PsReplaceWith ) { Replace = PsExpression: Exit Function

// カウントが-1のときは全置換なので、Longの最大値を入れる
if ( PlCount = -1 ) { PlCount = 2147483647

// 検索開始位置をスタートに、実際のカウント回数を0に初期化
lFindPos = PlStart
lRealCount = 0

// 置換文字列、検索文字列の長さの差分を取る
lDiffLen = lRepLen - lFindLen

// 置換後の文字列を入れるためにメモリを確保
if ( lDiffLen > 0 ) {    // 置換文字列の方が長い場合
     sReplaced = Space(lExpLen + lDiffLen * (lExpLen \ lFindLen + 1))
} else {
     sReplaced = Space(lExpLen)
}

// 開始文字位置までの文字列を置換後の文字列に挿入
if ( PlStart > 1 ) {
    Mid(sReplaced, 1, PlStart - 1) = Left(PsExpression, PlStart - 1)
}

///////////////////////////////////////////////////////////////////////////////////
//// 比較モードをVB6からの指定方法vbUseCompareOption -1に対応するためにifで分ける
///////////////////////////////////////////////////////////////////////////////////
if ( PlCompare = -1 ) {  // 文字列の比較モードをOption Compareステートメントの設定で行う

    Do
        lRet = InStr(lFindPos, PsExpression, PsFind) // 検索文字列を検索
        if ( lRet = 0 ) { Exit Do    // ---------------- 見つからなければループを抜ける

        // 検索文字列までを置換後文字列に挿入 (*)左辺はMidステートメント、右はMid関数です。
        Mid(sReplaced, lFindPos + lRealCount * lDiffLen, lRet - lFindPos) _
          = Mid(PsExpression, lFindPos, lRet - lFindPos)
        // 置換文字列を置換後文字列に挿入
        Mid(sReplaced, lRet + lRealCount * lDiffLen, lRepLen) = PsReplaceWith

        //検索開始位置を見つかった検索文字列の後ろに修正
        lFindPos = lRet + lFindLen

        //置換回数をカウントアップ
        lRealCount = lRealCount + 1

    Loop While PlCount > lRealCount     // 置換回数が制限回数を越えるまでループ
                                        // 検索文字列がない場合は途中で抜けます。
                                        // 上のInStrの直後のExit Do

} else {    // ---------------- 文字列の比較モードをPlCompareで指定された設定で行う

    // --- PlCompare=-1の場合とほとんど同じなのでコメントは省略
    Do
        // PlCompareを指定してる部分だけ上と違う
        lRet = InStr(lFindPos, PsExpression, PsFind, PlCompare)
        if ( lRet = 0 ) { Exit Do

        Mid(sReplaced, lFindPos + lRealCount * lDiffLen, lRet - lFindPos) _
          = Mid(PsExpression, lFindPos, lRet - lFindPos)
        Mid(sReplaced, lRet + lRealCount * lDiffLen, lRepLen) = PsReplaceWith

        lFindPos = lRet + lFindLen

        lRealCount = lRealCount + 1

    Loop While PlCount > lRealCount

}
// 最後に見つかった検索文字列以降の文字列を置換後の文字列に挿入
if ( lFindPos <= lExpLen ) {
    Mid(sReplaced, lFindPos + lRealCount * lDiffLen, lExpLen - lFindPos + 1) _
        = Mid(PsExpression, lFindPos, lExpLen - lFindPos + 1)
}

// 最後に後ろの無駄な空白を除去。
// RTrimでできるが、必要な文字数がわかっているので、速度面でLeft関数を使用
sReplaced = Left(sReplaced, lExpLen + lRealCount * lDiffLen)

Replace = sReplaced

}

//=================================================
//半角カナだけを全角カナ変換する関数 fKanaHan2Zen (http://hanatyan.sakura.ne.jp/vb6/string03.htm)
//=================================================
// result = fKanaHan2Zen(myString)
// 引数　myString :変換元の文字列
// 戻値　result　 :変換後の文字列　　　 ゆう(U)さん投稿分
//-------------------------------------------------
private Function fKanaHan2Zen(ByRef myString As String) As String
var i       As Long
var strTemp As String
var strKana As String
var chrKana As String

For( i = 1& To Len(myString)
    chrKana = Mid(myString, i, 1&)
    Select Case Asc(chrKana)
        Case 166 To 223
            //半角が続いたら文字をつなぐ
            strKana = strKana & chrKana
        Case } else {
        //全角文字になったら半角の未処理文字を全部全角
        //に変換これにより濁点処理等が不要
            if ( Len(strKana) > 0& ) {
                strTemp = strTemp & StrConv(strKana, vbWide)
                strKana = vbNullString
            }
            strTemp = strTemp & chrKana
    End Select
}
//最後の文字が半角の場合の処理
if ( Len(strKana) > 0& ) {
    strTemp = strTemp & StrConv(strKana, vbWide)
}
fKanaHan2Zen = strTemp
}






}
}
*/